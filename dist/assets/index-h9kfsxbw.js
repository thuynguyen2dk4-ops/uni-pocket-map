function HI(t,e){for(var r=0;r<e.length;r++){const l=e[r];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in t)){const m=Object.getOwnPropertyDescriptor(l,u);m&&Object.defineProperty(t,u,m.get?m:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const m of u)if(m.type==="childList")for(const v of m.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&l(v)}).observe(document,{childList:!0,subtree:!0});function r(u){const m={};return u.integrity&&(m.integrity=u.integrity),u.referrerPolicy&&(m.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?m.credentials="include":u.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(u){if(u.ep)return;u.ep=!0;const m=r(u);fetch(u.href,m)}})();function wb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var a1={exports:{}},ty={},l1={exports:{}},hr={};var ZE;function ij(){if(ZE)return hr;ZE=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),v=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),L=Symbol.iterator;function z(fe){return fe===null||typeof fe!="object"?null:(fe=L&&fe[L]||fe["@@iterator"],typeof fe=="function"?fe:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,H={};function Z(fe,Fe,lt){this.props=fe,this.context=Fe,this.refs=H,this.updater=lt||O}Z.prototype.isReactComponent={},Z.prototype.setState=function(fe,Fe){if(typeof fe!="object"&&typeof fe!="function"&&fe!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,fe,Fe,"setState")},Z.prototype.forceUpdate=function(fe){this.updater.enqueueForceUpdate(this,fe,"forceUpdate")};function Y(){}Y.prototype=Z.prototype;function ee(fe,Fe,lt){this.props=fe,this.context=Fe,this.refs=H,this.updater=lt||O}var ie=ee.prototype=new Y;ie.constructor=ee,K(ie,Z.prototype),ie.isPureReactComponent=!0;var pe=Array.isArray,xe=Object.prototype.hasOwnProperty,Ce={current:null},je={key:!0,ref:!0,__self:!0,__source:!0};function Ue(fe,Fe,lt){var Tt,Kt={},sn=null,xt=null;if(Fe!=null)for(Tt in Fe.ref!==void 0&&(xt=Fe.ref),Fe.key!==void 0&&(sn=""+Fe.key),Fe)xe.call(Fe,Tt)&&!je.hasOwnProperty(Tt)&&(Kt[Tt]=Fe[Tt]);var Zt=arguments.length-2;if(Zt===1)Kt.children=lt;else if(1<Zt){for(var vn=Array(Zt),on=0;on<Zt;on++)vn[on]=arguments[on+2];Kt.children=vn}if(fe&&fe.defaultProps)for(Tt in Zt=fe.defaultProps,Zt)Kt[Tt]===void 0&&(Kt[Tt]=Zt[Tt]);return{$$typeof:t,type:fe,key:sn,ref:xt,props:Kt,_owner:Ce.current}}function et(fe,Fe){return{$$typeof:t,type:fe.type,key:Fe,ref:fe.ref,props:fe.props,_owner:fe._owner}}function Ie(fe){return typeof fe=="object"&&fe!==null&&fe.$$typeof===t}function ot(fe){var Fe={"=":"=0",":":"=2"};return"$"+fe.replace(/[=:]/g,function(lt){return Fe[lt]})}var ut=/\/+/g;function gt(fe,Fe){return typeof fe=="object"&&fe!==null&&fe.key!=null?ot(""+fe.key):Fe.toString(36)}function ft(fe,Fe,lt,Tt,Kt){var sn=typeof fe;(sn==="undefined"||sn==="boolean")&&(fe=null);var xt=!1;if(fe===null)xt=!0;else switch(sn){case"string":case"number":xt=!0;break;case"object":switch(fe.$$typeof){case t:case e:xt=!0}}if(xt)return xt=fe,Kt=Kt(xt),fe=Tt===""?"."+gt(xt,0):Tt,pe(Kt)?(lt="",fe!=null&&(lt=fe.replace(ut,"$&/")+"/"),ft(Kt,Fe,lt,"",function(on){return on})):Kt!=null&&(Ie(Kt)&&(Kt=et(Kt,lt+(!Kt.key||xt&&xt.key===Kt.key?"":(""+Kt.key).replace(ut,"$&/")+"/")+fe)),Fe.push(Kt)),1;if(xt=0,Tt=Tt===""?".":Tt+":",pe(fe))for(var Zt=0;Zt<fe.length;Zt++){sn=fe[Zt];var vn=Tt+gt(sn,Zt);xt+=ft(sn,Fe,lt,vn,Kt)}else if(vn=z(fe),typeof vn=="function")for(fe=vn.call(fe),Zt=0;!(sn=fe.next()).done;)sn=sn.value,vn=Tt+gt(sn,Zt++),xt+=ft(sn,Fe,lt,vn,Kt);else if(sn==="object")throw Fe=String(fe),Error("Objects are not valid as a React child (found: "+(Fe==="[object Object]"?"object with keys {"+Object.keys(fe).join(", ")+"}":Fe)+"). If you meant to render a collection of children, use an array instead.");return xt}function vt(fe,Fe,lt){if(fe==null)return fe;var Tt=[],Kt=0;return ft(fe,Tt,"","",function(sn){return Fe.call(lt,sn,Kt++)}),Tt}function st(fe){if(fe._status===-1){var Fe=fe._result;Fe=Fe(),Fe.then(function(lt){(fe._status===0||fe._status===-1)&&(fe._status=1,fe._result=lt)},function(lt){(fe._status===0||fe._status===-1)&&(fe._status=2,fe._result=lt)}),fe._status===-1&&(fe._status=0,fe._result=Fe)}if(fe._status===1)return fe._result.default;throw fe._result}var nt={current:null},ze={transition:null},Se={ReactCurrentDispatcher:nt,ReactCurrentBatchConfig:ze,ReactCurrentOwner:Ce};function We(){throw Error("act(...) is not supported in production builds of React.")}return hr.Children={map:vt,forEach:function(fe,Fe,lt){vt(fe,function(){Fe.apply(this,arguments)},lt)},count:function(fe){var Fe=0;return vt(fe,function(){Fe++}),Fe},toArray:function(fe){return vt(fe,function(Fe){return Fe})||[]},only:function(fe){if(!Ie(fe))throw Error("React.Children.only expected to receive a single React element child.");return fe}},hr.Component=Z,hr.Fragment=r,hr.Profiler=u,hr.PureComponent=ee,hr.StrictMode=l,hr.Suspense=a,hr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Se,hr.act=We,hr.cloneElement=function(fe,Fe,lt){if(fe==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+fe+".");var Tt=K({},fe.props),Kt=fe.key,sn=fe.ref,xt=fe._owner;if(Fe!=null){if(Fe.ref!==void 0&&(sn=Fe.ref,xt=Ce.current),Fe.key!==void 0&&(Kt=""+Fe.key),fe.type&&fe.type.defaultProps)var Zt=fe.type.defaultProps;for(vn in Fe)xe.call(Fe,vn)&&!je.hasOwnProperty(vn)&&(Tt[vn]=Fe[vn]===void 0&&Zt!==void 0?Zt[vn]:Fe[vn])}var vn=arguments.length-2;if(vn===1)Tt.children=lt;else if(1<vn){Zt=Array(vn);for(var on=0;on<vn;on++)Zt[on]=arguments[on+2];Tt.children=Zt}return{$$typeof:t,type:fe.type,key:Kt,ref:sn,props:Tt,_owner:xt}},hr.createContext=function(fe){return fe={$$typeof:v,_currentValue:fe,_currentValue2:fe,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},fe.Provider={$$typeof:m,_context:fe},fe.Consumer=fe},hr.createElement=Ue,hr.createFactory=function(fe){var Fe=Ue.bind(null,fe);return Fe.type=fe,Fe},hr.createRef=function(){return{current:null}},hr.forwardRef=function(fe){return{$$typeof:b,render:fe}},hr.isValidElement=Ie,hr.lazy=function(fe){return{$$typeof:M,_payload:{_status:-1,_result:fe},_init:st}},hr.memo=function(fe,Fe){return{$$typeof:k,type:fe,compare:Fe===void 0?null:Fe}},hr.startTransition=function(fe){var Fe=ze.transition;ze.transition={};try{fe()}finally{ze.transition=Fe}},hr.unstable_act=We,hr.useCallback=function(fe,Fe){return nt.current.useCallback(fe,Fe)},hr.useContext=function(fe){return nt.current.useContext(fe)},hr.useDebugValue=function(){},hr.useDeferredValue=function(fe){return nt.current.useDeferredValue(fe)},hr.useEffect=function(fe,Fe){return nt.current.useEffect(fe,Fe)},hr.useId=function(){return nt.current.useId()},hr.useImperativeHandle=function(fe,Fe,lt){return nt.current.useImperativeHandle(fe,Fe,lt)},hr.useInsertionEffect=function(fe,Fe){return nt.current.useInsertionEffect(fe,Fe)},hr.useLayoutEffect=function(fe,Fe){return nt.current.useLayoutEffect(fe,Fe)},hr.useMemo=function(fe,Fe){return nt.current.useMemo(fe,Fe)},hr.useReducer=function(fe,Fe,lt){return nt.current.useReducer(fe,Fe,lt)},hr.useRef=function(fe){return nt.current.useRef(fe)},hr.useState=function(fe){return nt.current.useState(fe)},hr.useSyncExternalStore=function(fe,Fe,lt){return nt.current.useSyncExternalStore(fe,Fe,lt)},hr.useTransition=function(){return nt.current.useTransition()},hr.version="18.3.1",hr}var XE;function Sv(){return XE||(XE=1,l1.exports=ij()),l1.exports}var KE;function sj(){if(KE)return ty;KE=1;var t=Sv(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,u=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function v(b,a,k){var M,L={},z=null,O=null;k!==void 0&&(z=""+k),a.key!==void 0&&(z=""+a.key),a.ref!==void 0&&(O=a.ref);for(M in a)l.call(a,M)&&!m.hasOwnProperty(M)&&(L[M]=a[M]);if(b&&b.defaultProps)for(M in a=b.defaultProps,a)L[M]===void 0&&(L[M]=a[M]);return{$$typeof:e,type:b,key:z,ref:O,props:L,_owner:u.current}}return ty.Fragment=r,ty.jsx=v,ty.jsxs=v,ty}var YE;function oj(){return YE||(YE=1,a1.exports=sj()),a1.exports}var _=oj(),lx={},c1={exports:{}},na={},u1={exports:{}},d1={};var JE;function aj(){return JE||(JE=1,(function(t){function e(ze,Se){var We=ze.length;ze.push(Se);e:for(;0<We;){var fe=We-1>>>1,Fe=ze[fe];if(0<u(Fe,Se))ze[fe]=Se,ze[We]=Fe,We=fe;else break e}}function r(ze){return ze.length===0?null:ze[0]}function l(ze){if(ze.length===0)return null;var Se=ze[0],We=ze.pop();if(We!==Se){ze[0]=We;e:for(var fe=0,Fe=ze.length,lt=Fe>>>1;fe<lt;){var Tt=2*(fe+1)-1,Kt=ze[Tt],sn=Tt+1,xt=ze[sn];if(0>u(Kt,We))sn<Fe&&0>u(xt,Kt)?(ze[fe]=xt,ze[sn]=We,fe=sn):(ze[fe]=Kt,ze[Tt]=We,fe=Tt);else if(sn<Fe&&0>u(xt,We))ze[fe]=xt,ze[sn]=We,fe=sn;else break e}}return Se}function u(ze,Se){var We=ze.sortIndex-Se.sortIndex;return We!==0?We:ze.id-Se.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;t.unstable_now=function(){return m.now()}}else{var v=Date,b=v.now();t.unstable_now=function(){return v.now()-b}}var a=[],k=[],M=1,L=null,z=3,O=!1,K=!1,H=!1,Z=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(ze){for(var Se=r(k);Se!==null;){if(Se.callback===null)l(k);else if(Se.startTime<=ze)l(k),Se.sortIndex=Se.expirationTime,e(a,Se);else break;Se=r(k)}}function pe(ze){if(H=!1,ie(ze),!K)if(r(a)!==null)K=!0,st(xe);else{var Se=r(k);Se!==null&&nt(pe,Se.startTime-ze)}}function xe(ze,Se){K=!1,H&&(H=!1,Y(Ue),Ue=-1),O=!0;var We=z;try{for(ie(Se),L=r(a);L!==null&&(!(L.expirationTime>Se)||ze&&!ot());){var fe=L.callback;if(typeof fe=="function"){L.callback=null,z=L.priorityLevel;var Fe=fe(L.expirationTime<=Se);Se=t.unstable_now(),typeof Fe=="function"?L.callback=Fe:L===r(a)&&l(a),ie(Se)}else l(a);L=r(a)}if(L!==null)var lt=!0;else{var Tt=r(k);Tt!==null&&nt(pe,Tt.startTime-Se),lt=!1}return lt}finally{L=null,z=We,O=!1}}var Ce=!1,je=null,Ue=-1,et=5,Ie=-1;function ot(){return!(t.unstable_now()-Ie<et)}function ut(){if(je!==null){var ze=t.unstable_now();Ie=ze;var Se=!0;try{Se=je(!0,ze)}finally{Se?gt():(Ce=!1,je=null)}}else Ce=!1}var gt;if(typeof ee=="function")gt=function(){ee(ut)};else if(typeof MessageChannel<"u"){var ft=new MessageChannel,vt=ft.port2;ft.port1.onmessage=ut,gt=function(){vt.postMessage(null)}}else gt=function(){Z(ut,0)};function st(ze){je=ze,Ce||(Ce=!0,gt())}function nt(ze,Se){Ue=Z(function(){ze(t.unstable_now())},Se)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ze){ze.callback=null},t.unstable_continueExecution=function(){K||O||(K=!0,st(xe))},t.unstable_forceFrameRate=function(ze){0>ze||125<ze?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):et=0<ze?Math.floor(1e3/ze):5},t.unstable_getCurrentPriorityLevel=function(){return z},t.unstable_getFirstCallbackNode=function(){return r(a)},t.unstable_next=function(ze){switch(z){case 1:case 2:case 3:var Se=3;break;default:Se=z}var We=z;z=Se;try{return ze()}finally{z=We}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(ze,Se){switch(ze){case 1:case 2:case 3:case 4:case 5:break;default:ze=3}var We=z;z=ze;try{return Se()}finally{z=We}},t.unstable_scheduleCallback=function(ze,Se,We){var fe=t.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?fe+We:fe):We=fe,ze){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=We+Fe,ze={id:M++,callback:Se,priorityLevel:ze,startTime:We,expirationTime:Fe,sortIndex:-1},We>fe?(ze.sortIndex=We,e(k,ze),r(a)===null&&ze===r(k)&&(H?(Y(Ue),Ue=-1):H=!0,nt(pe,We-fe))):(ze.sortIndex=Fe,e(a,ze),K||O||(K=!0,st(xe))),ze},t.unstable_shouldYield=ot,t.unstable_wrapCallback=function(ze){var Se=z;return function(){var We=z;z=Se;try{return ze.apply(this,arguments)}finally{z=We}}}})(d1)),d1}var QE;function lj(){return QE||(QE=1,u1.exports=aj()),u1.exports}var eC;function cj(){if(eC)return na;eC=1;var t=Sv(),e=lj();function r(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,S=1;S<arguments.length;S++)p+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,u={};function m(d,p){v(d,p),v(d+"Capture",p)}function v(d,p){for(u[d]=p,d=0;d<p.length;d++)l.add(p[d])}var b=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M={},L={};function z(d){return a.call(L,d)?!0:a.call(M,d)?!1:k.test(d)?L[d]=!0:(M[d]=!0,!1)}function O(d,p,S,N){if(S!==null&&S.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return N?!1:S!==null?!S.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function K(d,p,S,N){if(p===null||typeof p>"u"||O(d,p,S,N))return!0;if(N)return!1;if(S!==null)switch(S.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function H(d,p,S,N,F,W,se){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=N,this.attributeNamespace=F,this.mustUseProperty=S,this.propertyName=d,this.type=p,this.sanitizeURL=W,this.removeEmptyString=se}var Z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){Z[d]=new H(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];Z[p]=new H(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){Z[d]=new H(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){Z[d]=new H(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){Z[d]=new H(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){Z[d]=new H(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){Z[d]=new H(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){Z[d]=new H(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){Z[d]=new H(d,5,!1,d.toLowerCase(),null,!1,!1)});var Y=/[\-:]([a-z])/g;function ee(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){Z[d]=new H(d,1,!1,d.toLowerCase(),null,!1,!1)}),Z.xlinkHref=new H("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){Z[d]=new H(d,1,!1,d.toLowerCase(),null,!0,!0)});function ie(d,p,S,N){var F=Z.hasOwnProperty(p)?Z[p]:null;(F!==null?F.type!==0:N||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(K(p,S,F,N)&&(S=null),N||F===null?z(p)&&(S===null?d.removeAttribute(p):d.setAttribute(p,""+S)):F.mustUseProperty?d[F.propertyName]=S===null?F.type===3?!1:"":S:(p=F.attributeName,N=F.attributeNamespace,S===null?d.removeAttribute(p):(F=F.type,S=F===3||F===4&&S===!0?"":""+S,N?d.setAttributeNS(N,p,S):d.setAttribute(p,S))))}var pe=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,xe=Symbol.for("react.element"),Ce=Symbol.for("react.portal"),je=Symbol.for("react.fragment"),Ue=Symbol.for("react.strict_mode"),et=Symbol.for("react.profiler"),Ie=Symbol.for("react.provider"),ot=Symbol.for("react.context"),ut=Symbol.for("react.forward_ref"),gt=Symbol.for("react.suspense"),ft=Symbol.for("react.suspense_list"),vt=Symbol.for("react.memo"),st=Symbol.for("react.lazy"),nt=Symbol.for("react.offscreen"),ze=Symbol.iterator;function Se(d){return d===null||typeof d!="object"?null:(d=ze&&d[ze]||d["@@iterator"],typeof d=="function"?d:null)}var We=Object.assign,fe;function Fe(d){if(fe===void 0)try{throw Error()}catch(S){var p=S.stack.trim().match(/\n( *(at )?)/);fe=p&&p[1]||""}return`
`+fe+d}var lt=!1;function Tt(d,p){if(!d||lt)return"";lt=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(at){var N=at}Reflect.construct(d,[],p)}else{try{p.call()}catch(at){N=at}d.call(p.prototype)}else{try{throw Error()}catch(at){N=at}d()}}catch(at){if(at&&N&&typeof at.stack=="string"){for(var F=at.stack.split(`
`),W=N.stack.split(`
`),se=F.length-1,Ae=W.length-1;1<=se&&0<=Ae&&F[se]!==W[Ae];)Ae--;for(;1<=se&&0<=Ae;se--,Ae--)if(F[se]!==W[Ae]){if(se!==1||Ae!==1)do if(se--,Ae--,0>Ae||F[se]!==W[Ae]){var Ve=`
`+F[se].replace(" at new "," at ");return d.displayName&&Ve.includes("<anonymous>")&&(Ve=Ve.replace("<anonymous>",d.displayName)),Ve}while(1<=se&&0<=Ae);break}}}finally{lt=!1,Error.prepareStackTrace=S}return(d=d?d.displayName||d.name:"")?Fe(d):""}function Kt(d){switch(d.tag){case 5:return Fe(d.type);case 16:return Fe("Lazy");case 13:return Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 2:case 15:return d=Tt(d.type,!1),d;case 11:return d=Tt(d.type.render,!1),d;case 1:return d=Tt(d.type,!0),d;default:return""}}function sn(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case je:return"Fragment";case Ce:return"Portal";case et:return"Profiler";case Ue:return"StrictMode";case gt:return"Suspense";case ft:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case ot:return(d.displayName||"Context")+".Consumer";case Ie:return(d._context.displayName||"Context")+".Provider";case ut:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case vt:return p=d.displayName||null,p!==null?p:sn(d.type)||"Memo";case st:p=d._payload,d=d._init;try{return sn(d(p))}catch{}}return null}function xt(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return sn(p);case 8:return p===Ue?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Zt(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function vn(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function on(d){var p=vn(d)?"checked":"value",S=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),N=""+d[p];if(!d.hasOwnProperty(p)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var F=S.get,W=S.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return F.call(this)},set:function(se){N=""+se,W.call(this,se)}}),Object.defineProperty(d,p,{enumerable:S.enumerable}),{getValue:function(){return N},setValue:function(se){N=""+se},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function Sn(d){d._valueTracker||(d._valueTracker=on(d))}function Yt(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var S=p.getValue(),N="";return d&&(N=vn(d)?d.checked?"true":"false":d.value),d=N,d!==S?(p.setValue(d),!0):!1}function nr(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function Xn(d,p){var S=p.checked;return We({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??d._wrapperState.initialChecked})}function _i(d,p){var S=p.defaultValue==null?"":p.defaultValue,N=p.checked!=null?p.checked:p.defaultChecked;S=Zt(p.value!=null?p.value:S),d._wrapperState={initialChecked:N,initialValue:S,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Kn(d,p){p=p.checked,p!=null&&ie(d,"checked",p,!1)}function Er(d,p){Kn(d,p);var S=Zt(p.value),N=p.type;if(S!=null)N==="number"?(S===0&&d.value===""||d.value!=S)&&(d.value=""+S):d.value!==""+S&&(d.value=""+S);else if(N==="submit"||N==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?xi(d,p.type,S):p.hasOwnProperty("defaultValue")&&xi(d,p.type,Zt(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function Ks(d,p,S){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var N=p.type;if(!(N!=="submit"&&N!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,S||p===d.value||(d.value=p),d.defaultValue=p}S=d.name,S!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,S!==""&&(d.name=S)}function xi(d,p,S){(p!=="number"||nr(d.ownerDocument)!==d)&&(S==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+S&&(d.defaultValue=""+S))}var Zr=Array.isArray;function ti(d,p,S,N){if(d=d.options,p){p={};for(var F=0;F<S.length;F++)p["$"+S[F]]=!0;for(S=0;S<d.length;S++)F=p.hasOwnProperty("$"+d[S].value),d[S].selected!==F&&(d[S].selected=F),F&&N&&(d[S].defaultSelected=!0)}else{for(S=""+Zt(S),p=null,F=0;F<d.length;F++){if(d[F].value===S){d[F].selected=!0,N&&(d[F].defaultSelected=!0);return}p!==null||d[F].disabled||(p=d[F])}p!==null&&(p.selected=!0)}}function is(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return We({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function qi(d,p){var S=p.value;if(S==null){if(S=p.children,p=p.defaultValue,S!=null){if(p!=null)throw Error(r(92));if(Zr(S)){if(1<S.length)throw Error(r(93));S=S[0]}p=S}p==null&&(p=""),S=p}d._wrapperState={initialValue:Zt(S)}}function Ns(d,p){var S=Zt(p.value),N=Zt(p.defaultValue);S!=null&&(S=""+S,S!==d.value&&(d.value=S),p.defaultValue==null&&d.defaultValue!==S&&(d.defaultValue=S)),N!=null&&(d.defaultValue=""+N)}function xs(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function Vr(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ss(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?Vr(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var vi,Rs=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,S,N,F){MSApp.execUnsafeLocalFunction(function(){return d(p,S,N,F)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(vi=vi||document.createElement("div"),vi.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=vi.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function Zi(d,p){if(p){var S=d.firstChild;if(S&&S===d.lastChild&&S.nodeType===3){S.nodeValue=p;return}}d.textContent=p}var Ii={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xo=["Webkit","ms","Moz","O"];Object.keys(Ii).forEach(function(d){xo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),Ii[p]=Ii[d]})});function Ys(d,p,S){return p==null||typeof p=="boolean"||p===""?"":S||typeof p!="number"||p===0||Ii.hasOwnProperty(d)&&Ii[d]?(""+p).trim():p+"px"}function Mi(d,p){d=d.style;for(var S in p)if(p.hasOwnProperty(S)){var N=S.indexOf("--")===0,F=Ys(S,p[S],N);S==="float"&&(S="cssFloat"),N?d.setProperty(S,F):d[S]=F}}var os=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ni(d,p){if(p){if(os[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Ds(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Js=null;function vo(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var be=null,ne=null,re=null;function ue(d){if(d=xc(d)){if(typeof be!="function")throw Error(r(280));var p=d.stateNode;p&&(p=wd(p),be(d.stateNode,d.type,p))}}function Te(d){ne?re?re.push(d):re=[d]:ne=d}function we(){if(ne){var d=ne,p=re;if(re=ne=null,ue(d),p)for(d=0;d<p.length;d++)ue(p[d])}}function Oe(d,p){return d(p)}function Be(){}var Le=!1;function Ze(d,p,S){if(Le)return d(p,S);Le=!0;try{return Oe(d,p,S)}finally{Le=!1,(ne!==null||re!==null)&&(Be(),we())}}function Et(d,p){var S=d.stateNode;if(S===null)return null;var N=wd(S);if(N===null)return null;S=N[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(N=!N.disabled)||(d=d.type,N=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!N;break e;default:d=!1}if(d)return null;if(S&&typeof S!="function")throw Error(r(231,p,typeof S));return S}var Rt=!1;if(b)try{var bt={};Object.defineProperty(bt,"passive",{get:function(){Rt=!0}}),window.addEventListener("test",bt,bt),window.removeEventListener("test",bt,bt)}catch{Rt=!1}function wn(d,p,S,N,F,W,se,Ae,Ve){var at=Array.prototype.slice.call(arguments,3);try{p.apply(S,at)}catch(Lt){this.onError(Lt)}}var An=!1,kn=null,Pn=!1,$n=null,jr={onError:function(d){An=!0,kn=d}};function ri(d,p,S,N,F,W,se,Ae,Ve){An=!1,kn=null,wn.apply(jr,arguments)}function Xi(d,p,S,N,F,W,se,Ae,Ve){if(ri.apply(this,arguments),An){if(An){var at=kn;An=!1,kn=null}else throw Error(r(198));Pn||(Pn=!0,$n=at)}}function Nr(d){var p=d,S=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(S=p.return),d=p.return;while(d)}return p.tag===3?S:null}function wo(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function wi(d){if(Nr(d)!==d)throw Error(r(188))}function as(d){var p=d.alternate;if(!p){if(p=Nr(d),p===null)throw Error(r(188));return p!==d?null:d}for(var S=d,N=p;;){var F=S.return;if(F===null)break;var W=F.alternate;if(W===null){if(N=F.return,N!==null){S=N;continue}break}if(F.child===W.child){for(W=F.child;W;){if(W===S)return wi(F),d;if(W===N)return wi(F),p;W=W.sibling}throw Error(r(188))}if(S.return!==N.return)S=F,N=W;else{for(var se=!1,Ae=F.child;Ae;){if(Ae===S){se=!0,S=F,N=W;break}if(Ae===N){se=!0,N=F,S=W;break}Ae=Ae.sibling}if(!se){for(Ae=W.child;Ae;){if(Ae===S){se=!0,S=W,N=F;break}if(Ae===N){se=!0,N=W,S=F;break}Ae=Ae.sibling}if(!se)throw Error(r(189))}}if(S.alternate!==N)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?d:p}function ll(d){return d=as(d),d!==null?dp(d):null}function dp(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=dp(d);if(p!==null)return p;d=d.sibling}return null}var Ah=e.unstable_scheduleCallback,ir=e.unstable_cancelCallback,Ih=e.unstable_shouldYield,Qc=e.unstable_requestPaint,Ur=e.unstable_now,nd=e.unstable_getCurrentPriorityLevel,Qs=e.unstable_ImmediatePriority,Fo=e.unstable_UserBlockingPriority,Zl=e.unstable_NormalPriority,Mh=e.unstable_LowPriority,ka=e.unstable_IdlePriority,eo=null,vs=null;function pt(d){if(vs&&typeof vs.onCommitFiberRoot=="function")try{vs.onCommitFiberRoot(eo,d,void 0,(d.current.flags&128)===128)}catch{}}var bi=Math.clz32?Math.clz32:hp,ii=Math.log,Pi=Math.LN2;function hp(d){return d>>>=0,d===0?32:31-(ii(d)/Pi|0)|0}var Ls=64,Xl=4194304;function Kl(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function sa(d,p){var S=d.pendingLanes;if(S===0)return 0;var N=0,F=d.suspendedLanes,W=d.pingedLanes,se=S&268435455;if(se!==0){var Ae=se&~F;Ae!==0?N=Kl(Ae):(W&=se,W!==0&&(N=Kl(W)))}else se=S&~F,se!==0?N=Kl(se):W!==0&&(N=Kl(W));if(N===0)return 0;if(p!==0&&p!==N&&(p&F)===0&&(F=N&-N,W=p&-p,F>=W||F===16&&(W&4194240)!==0))return p;if((N&4)!==0&&(N|=S&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=N;0<p;)S=31-bi(p),F=1<<S,N|=d[S],p&=~F;return N}function Ut(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hn(d,p){for(var S=d.suspendedLanes,N=d.pingedLanes,F=d.expirationTimes,W=d.pendingLanes;0<W;){var se=31-bi(W),Ae=1<<se,Ve=F[se];Ve===-1?((Ae&S)===0||(Ae&N)!==0)&&(F[se]=Ut(Ae,p)):Ve<=p&&(d.expiredLanes|=Ae),W&=~Ae}}function Bn(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function ws(){var d=Ls;return Ls<<=1,(Ls&4194240)===0&&(Ls=64),d}function js(d){for(var p=[],S=0;31>S;S++)p.push(d);return p}function Nn(d,p,S){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-bi(p),d[p]=S}function Os(d,p){var S=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var N=d.eventTimes;for(d=d.expirationTimes;0<S;){var F=31-bi(S),W=1<<F;p[F]=0,N[F]=-1,d[F]=-1,S&=~W}}function cl(d,p){var S=d.entangledLanes|=p;for(d=d.entanglements;S;){var N=31-bi(S),F=1<<N;F&p|d[N]&p&&(d[N]|=p),S&=~F}}var sr=0;function zs(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Cr,rd,Vo,Yl,Jl,eu=!1,tu=[],to=null,no=null,bo=null,Uo=new Map,Ni=new Map,_r=[],Ph="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function id(d,p){switch(d){case"focusin":case"focusout":to=null;break;case"dragenter":case"dragleave":no=null;break;case"mouseover":case"mouseout":bo=null;break;case"pointerover":case"pointerout":Uo.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ni.delete(p.pointerId)}}function Ri(d,p,S,N,F,W){return d===null||d.nativeEvent!==W?(d={blockedOn:p,domEventName:S,eventSystemFlags:N,nativeEvent:W,targetContainers:[F]},p!==null&&(p=xc(p),p!==null&&rd(p)),d):(d.eventSystemFlags|=N,p=d.targetContainers,F!==null&&p.indexOf(F)===-1&&p.push(F),d)}function ro(d,p,S,N,F){switch(p){case"focusin":return to=Ri(to,d,p,S,N,F),!0;case"dragenter":return no=Ri(no,d,p,S,N,F),!0;case"mouseover":return bo=Ri(bo,d,p,S,N,F),!0;case"pointerover":var W=F.pointerId;return Uo.set(W,Ri(Uo.get(W)||null,d,p,S,N,F)),!0;case"gotpointercapture":return W=F.pointerId,Ni.set(W,Ri(Ni.get(W)||null,d,p,S,N,F)),!0}return!1}function Nh(d){var p=Cs(d.target);if(p!==null){var S=Nr(p);if(S!==null){if(p=S.tag,p===13){if(p=wo(S),p!==null){d.blockedOn=p,Jl(d.priority,function(){Vo(S)});return}}else if(p===3&&S.stateNode.current.memoizedState.isDehydrated){d.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Aa(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var S=Dh(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(S===null){S=d.nativeEvent;var N=new S.constructor(S.type,S);Js=N,S.target.dispatchEvent(N),Js=null}else return p=xc(S),p!==null&&rd(p),d.blockedOn=S,!1;p.shift()}return!0}function Br(d,p,S){Aa(d)&&S.delete(p)}function nu(){eu=!1,to!==null&&Aa(to)&&(to=null),no!==null&&Aa(no)&&(no=null),bo!==null&&Aa(bo)&&(bo=null),Uo.forEach(Br),Ni.forEach(Br)}function ul(d,p){d.blockedOn===p&&(d.blockedOn=null,eu||(eu=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,nu)))}function To(d){function p(F){return ul(F,d)}if(0<tu.length){ul(tu[0],d);for(var S=1;S<tu.length;S++){var N=tu[S];N.blockedOn===d&&(N.blockedOn=null)}}for(to!==null&&ul(to,d),no!==null&&ul(no,d),bo!==null&&ul(bo,d),Uo.forEach(p),Ni.forEach(p),S=0;S<_r.length;S++)N=_r[S],N.blockedOn===d&&(N.blockedOn=null);for(;0<_r.length&&(S=_r[0],S.blockedOn===null);)Nh(S),S.blockedOn===null&&_r.shift()}var Xr=pe.ReactCurrentBatchConfig,Ql=!0;function Rh(d,p,S,N){var F=sr,W=Xr.transition;Xr.transition=null;try{sr=1,$o(d,p,S,N)}finally{sr=F,Xr.transition=W}}function oa(d,p,S,N){var F=sr,W=Xr.transition;Xr.transition=null;try{sr=4,$o(d,p,S,N)}finally{sr=F,Xr.transition=W}}function $o(d,p,S,N){if(Ql){var F=Dh(d,p,S,N);if(F===null)hc(d,p,N,dl,S),id(d,N);else if(ro(F,d,p,S,N))N.stopPropagation();else if(id(d,N),p&4&&-1<Ph.indexOf(d)){for(;F!==null;){var W=xc(F);if(W!==null&&Cr(W),W=Dh(d,p,S,N),W===null&&hc(d,p,N,dl,S),W===F)break;F=W}F!==null&&N.stopPropagation()}else hc(d,p,N,null,S)}}var dl=null;function Dh(d,p,S,N){if(dl=null,d=vo(N),d=Cs(d),d!==null)if(p=Nr(d),p===null)d=null;else if(S=p.tag,S===13){if(d=wo(p),d!==null)return d;d=null}else if(S===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return dl=d,null}function sd(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nd()){case Qs:return 1;case Fo:return 4;case Zl:case Mh:return 16;case ka:return 536870912;default:return 16}default:return 16}}var Bs=null,io=null,ec=null;function Ia(){if(ec)return ec;var d,p=io,S=p.length,N,F="value"in Bs?Bs.value:Bs.textContent,W=F.length;for(d=0;d<S&&p[d]===F[d];d++);var se=S-d;for(N=1;N<=se&&p[S-N]===F[W-N];N++);return ec=F.slice(d,1<N?1-N:void 0)}function so(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Ma(){return!0}function Go(){return!1}function Ki(d){function p(S,N,F,W,se){this._reactName=S,this._targetInst=F,this.type=N,this.nativeEvent=W,this.target=se,this.currentTarget=null;for(var Ae in d)d.hasOwnProperty(Ae)&&(S=d[Ae],this[Ae]=S?S(W):W[Ae]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?Ma:Go,this.isPropagationStopped=Go,this}return We(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=Ma)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=Ma)},persist:function(){},isPersistent:Ma}),p}var So={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hl=Ki(So),tc=We({},So,{view:0,detail:0}),od=Ki(tc),ru,iu,Ho,Jn=We({},tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ou,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Ho&&(Ho&&d.type==="mousemove"?(ru=d.screenX-Ho.screenX,iu=d.screenY-Ho.screenY):iu=ru=0,Ho=d),ru)},movementY:function(d){return"movementY"in d?d.movementY:iu}}),fp=Ki(Jn),Lh=We({},Jn,{dataTransfer:0}),pp=Ki(Lh),jh=We({},tc,{relatedTarget:0}),ad=Ki(jh),Oh=We({},So,{animationName:0,elapsedTime:0,pseudoElement:0}),nc=Ki(Oh),ld=We({},So,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),rc=Ki(ld),aa=We({},So,{data:0}),Pa=Ki(aa),cd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},mp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},su={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function zh(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=su[d])?!!p[d]:!1}function ou(){return zh}var ud=We({},tc,{key:function(d){if(d.key){var p=cd[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=so(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?mp[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ou,charCode:function(d){return d.type==="keypress"?so(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?so(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),dd=Ki(ud),Bh=We({},Jn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Yn=Ki(Bh),au=We({},tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ou}),gp=Ki(au),Fh=We({},So,{propertyName:0,elapsedTime:0,pseudoElement:0}),yp=Ki(Fh),fl=We({},Jn,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Vh=Ki(fl),sg=[9,13,27,32],Uh=b&&"CompositionEvent"in window,lu=null;b&&"documentMode"in document&&(lu=document.documentMode);var $h=b&&"TextEvent"in window&&!lu,hd=b&&(!Uh||lu&&8<lu&&11>=lu),fd=" ",cu=!1;function Gh(d,p){switch(d){case"keyup":return sg.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Hh(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var ic=!1;function uu(d,p){switch(d){case"compositionend":return Hh(p);case"keypress":return p.which!==32?null:(cu=!0,fd);case"textInput":return d=p.data,d===fd&&cu?null:d;default:return null}}function sc(d,p){if(ic)return d==="compositionend"||!Uh&&Gh(d,p)?(d=Ia(),ec=io=Bs=null,ic=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return hd&&p.locale!=="ko"?null:p.data;default:return null}}var Wh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oc(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!Wh[d.type]:p==="textarea"}function pd(d,p,S,N){Te(N),p=Ss(p,"onChange"),0<p.length&&(S=new hl("onChange","change",null,S,N),d.push({event:S,listeners:p}))}var bs=null,Na=null;function qh(d){_l(d,0)}function pl(d){var p=wl(d);if(Yt(p))return d}function _p(d,p){if(d==="change")return p}var md=!1;if(b){var Zh;if(b){var du="oninput"in document;if(!du){var hu=document.createElement("div");hu.setAttribute("oninput","return;"),du=typeof hu.oninput=="function"}Zh=du}else Zh=!1;md=Zh&&(!document.documentMode||9<document.documentMode)}function ac(){bs&&(bs.detachEvent("onpropertychange",Xh),Na=bs=null)}function Xh(d){if(d.propertyName==="value"&&pl(Na)){var p=[];pd(p,Na,d,vo(d)),Ze(qh,p)}}function Kh(d,p,S){d==="focusin"?(ac(),bs=p,Na=S,bs.attachEvent("onpropertychange",Xh)):d==="focusout"&&ac()}function og(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return pl(Na)}function Yh(d,p){if(d==="click")return pl(p)}function xp(d,p){if(d==="input"||d==="change")return pl(p)}function fu(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var oo=typeof Object.is=="function"?Object.is:fu;function Ra(d,p){if(oo(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var S=Object.keys(d),N=Object.keys(p);if(S.length!==N.length)return!1;for(N=0;N<S.length;N++){var F=S[N];if(!a.call(p,F)||!oo(d[F],p[F]))return!1}return!0}function Jh(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function ml(d,p){var S=Jh(d);d=0;for(var N;S;){if(S.nodeType===3){if(N=d+S.textContent.length,d<=p&&N>=p)return{node:S,offset:p-d};d=N}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=Jh(S)}}function vp(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?vp(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function wp(){for(var d=window,p=nr();p instanceof d.HTMLIFrameElement;){try{var S=typeof p.contentWindow.location.href=="string"}catch{S=!1}if(S)d=p.contentWindow;else break;p=nr(d.document)}return p}function Qh(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function ag(d){var p=wp(),S=d.focusedElem,N=d.selectionRange;if(p!==S&&S&&S.ownerDocument&&vp(S.ownerDocument.documentElement,S)){if(N!==null&&Qh(S)){if(p=N.start,d=N.end,d===void 0&&(d=p),"selectionStart"in S)S.selectionStart=p,S.selectionEnd=Math.min(d,S.value.length);else if(d=(p=S.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var F=S.textContent.length,W=Math.min(N.start,F);N=N.end===void 0?W:Math.min(N.end,F),!d.extend&&W>N&&(F=N,N=W,W=F),F=ml(S,W);var se=ml(S,N);F&&se&&(d.rangeCount!==1||d.anchorNode!==F.node||d.anchorOffset!==F.offset||d.focusNode!==se.node||d.focusOffset!==se.offset)&&(p=p.createRange(),p.setStart(F.node,F.offset),d.removeAllRanges(),W>N?(d.addRange(p),d.extend(se.node,se.offset)):(p.setEnd(se.node,se.offset),d.addRange(p)))}}for(p=[],d=S;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<p.length;S++)d=p[S],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var lg=b&&"documentMode"in document&&11>=document.documentMode,gl=null,lc=null,Wo=null,gd=!1;function ef(d,p,S){var N=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;gd||gl==null||gl!==nr(N)||(N=gl,"selectionStart"in N&&Qh(N)?N={start:N.selectionStart,end:N.selectionEnd}:(N=(N.ownerDocument&&N.ownerDocument.defaultView||window).getSelection(),N={anchorNode:N.anchorNode,anchorOffset:N.anchorOffset,focusNode:N.focusNode,focusOffset:N.focusOffset}),Wo&&Ra(Wo,N)||(Wo=N,N=Ss(lc,"onSelect"),0<N.length&&(p=new hl("onSelect","select",null,p,S),d.push({event:p,listeners:N}),p.target=gl)))}function ao(d,p){var S={};return S[d.toLowerCase()]=p.toLowerCase(),S["Webkit"+d]="webkit"+p,S["Moz"+d]="moz"+p,S}var la={animationend:ao("Animation","AnimationEnd"),animationiteration:ao("Animation","AnimationIteration"),animationstart:ao("Animation","AnimationStart"),transitionend:ao("Transition","TransitionEnd")},Ts={},cc={};b&&(cc=document.createElement("div").style,"AnimationEvent"in window||(delete la.animationend.animation,delete la.animationiteration.animation,delete la.animationstart.animation),"TransitionEvent"in window||delete la.transitionend.transition);function pu(d){if(Ts[d])return Ts[d];if(!la[d])return d;var p=la[d],S;for(S in p)if(p.hasOwnProperty(S)&&S in cc)return Ts[d]=p[S];return d}var Da=pu("animationend"),yl=pu("animationiteration"),mu=pu("animationstart"),gu=pu("transitionend"),Qn=new Map,uc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ca(d,p){Qn.set(d,p),m(p,[d])}for(var dc=0;dc<uc.length;dc++){var La=uc[dc],bp=La.toLowerCase(),yd=La[0].toUpperCase()+La.slice(1);ca(bp,"on"+yd)}ca(Da,"onAnimationEnd"),ca(yl,"onAnimationIteration"),ca(mu,"onAnimationStart"),ca("dblclick","onDoubleClick"),ca("focusin","onFocus"),ca("focusout","onBlur"),ca(gu,"onTransitionEnd"),v("onMouseEnter",["mouseout","mouseover"]),v("onMouseLeave",["mouseout","mouseover"]),v("onPointerEnter",["pointerout","pointerover"]),v("onPointerLeave",["pointerout","pointerover"]),m("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),m("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),m("onBeforeInput",["compositionend","keypress","textInput","paste"]),m("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Fs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Tp=new Set("cancel close invalid load scroll toggle".split(" ").concat(Fs));function yu(d,p,S){var N=d.type||"unknown-event";d.currentTarget=S,Xi(N,p,void 0,d),d.currentTarget=null}function _l(d,p){p=(p&4)!==0;for(var S=0;S<d.length;S++){var N=d[S],F=N.event;N=N.listeners;e:{var W=void 0;if(p)for(var se=N.length-1;0<=se;se--){var Ae=N[se],Ve=Ae.instance,at=Ae.currentTarget;if(Ae=Ae.listener,Ve!==W&&F.isPropagationStopped())break e;yu(F,Ae,at),W=Ve}else for(se=0;se<N.length;se++){if(Ae=N[se],Ve=Ae.instance,at=Ae.currentTarget,Ae=Ae.listener,Ve!==W&&F.isPropagationStopped())break e;yu(F,Ae,at),W=Ve}}}if(Pn)throw d=$n,Pn=!1,$n=null,d}function gr(d,p){var S=p[vd];S===void 0&&(S=p[vd]=new Set);var N=d+"__bubble";S.has(N)||(xu(p,d,2,!1),S.add(N))}function _u(d,p,S){var N=0;p&&(N|=4),xu(S,d,N,p)}var ja="_reactListening"+Math.random().toString(36).slice(2);function ua(d){if(!d[ja]){d[ja]=!0,l.forEach(function(S){S!=="selectionchange"&&(Tp.has(S)||_u(S,!1,d),_u(S,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[ja]||(p[ja]=!0,_u("selectionchange",!1,p))}}function xu(d,p,S,N){switch(sd(p)){case 1:var F=Rh;break;case 4:F=oa;break;default:F=$o}S=F.bind(null,p,S,d),F=void 0,!Rt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(F=!0),N?F!==void 0?d.addEventListener(p,S,{capture:!0,passive:F}):d.addEventListener(p,S,!0):F!==void 0?d.addEventListener(p,S,{passive:F}):d.addEventListener(p,S,!1)}function hc(d,p,S,N,F){var W=N;if((p&1)===0&&(p&2)===0&&N!==null)e:for(;;){if(N===null)return;var se=N.tag;if(se===3||se===4){var Ae=N.stateNode.containerInfo;if(Ae===F||Ae.nodeType===8&&Ae.parentNode===F)break;if(se===4)for(se=N.return;se!==null;){var Ve=se.tag;if((Ve===3||Ve===4)&&(Ve=se.stateNode.containerInfo,Ve===F||Ve.nodeType===8&&Ve.parentNode===F))return;se=se.return}for(;Ae!==null;){if(se=Cs(Ae),se===null)return;if(Ve=se.tag,Ve===5||Ve===6){N=W=se;continue e}Ae=Ae.parentNode}}N=N.return}Ze(function(){var at=W,Lt=vo(S),jt=[];e:{var Pt=Qn.get(d);if(Pt!==void 0){var rn=hl,fn=d;switch(d){case"keypress":if(so(S)===0)break e;case"keydown":case"keyup":rn=dd;break;case"focusin":fn="focus",rn=ad;break;case"focusout":fn="blur",rn=ad;break;case"beforeblur":case"afterblur":rn=ad;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":rn=fp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":rn=pp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":rn=gp;break;case Da:case yl:case mu:rn=nc;break;case gu:rn=yp;break;case"scroll":rn=od;break;case"wheel":rn=Vh;break;case"copy":case"cut":case"paste":rn=rc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":rn=Yn}var mn=(p&4)!==0,gi=!mn&&d==="scroll",tt=mn?Pt!==null?Pt+"Capture":null:Pt;mn=[];for(var He=at,it;He!==null;){it=He;var Vt=it.stateNode;if(it.tag===5&&Vt!==null&&(it=Vt,tt!==null&&(Vt=Et(He,tt),Vt!=null&&mn.push(zt(He,Vt,it)))),gi)break;He=He.return}0<mn.length&&(Pt=new rn(Pt,fn,null,S,Lt),jt.push({event:Pt,listeners:mn}))}}if((p&7)===0){e:{if(Pt=d==="mouseover"||d==="pointerover",rn=d==="mouseout"||d==="pointerout",Pt&&S!==Js&&(fn=S.relatedTarget||S.fromElement)&&(Cs(fn)||fn[Eo]))break e;if((rn||Pt)&&(Pt=Lt.window===Lt?Lt:(Pt=Lt.ownerDocument)?Pt.defaultView||Pt.parentWindow:window,rn?(fn=S.relatedTarget||S.toElement,rn=at,fn=fn?Cs(fn):null,fn!==null&&(gi=Nr(fn),fn!==gi||fn.tag!==5&&fn.tag!==6)&&(fn=null)):(rn=null,fn=at),rn!==fn)){if(mn=fp,Vt="onMouseLeave",tt="onMouseEnter",He="mouse",(d==="pointerout"||d==="pointerover")&&(mn=Yn,Vt="onPointerLeave",tt="onPointerEnter",He="pointer"),gi=rn==null?Pt:wl(rn),it=fn==null?Pt:wl(fn),Pt=new mn(Vt,He+"leave",rn,S,Lt),Pt.target=gi,Pt.relatedTarget=it,Vt=null,Cs(Lt)===at&&(mn=new mn(tt,He+"enter",fn,S,Lt),mn.target=it,mn.relatedTarget=gi,Vt=mn),gi=Vt,rn&&fn)t:{for(mn=rn,tt=fn,He=0,it=mn;it;it=xl(it))He++;for(it=0,Vt=tt;Vt;Vt=xl(Vt))it++;for(;0<He-it;)mn=xl(mn),He--;for(;0<it-He;)tt=xl(tt),it--;for(;He--;){if(mn===tt||tt!==null&&mn===tt.alternate)break t;mn=xl(mn),tt=xl(tt)}mn=null}else mn=null;rn!==null&&fc(jt,Pt,rn,mn,!1),fn!==null&&gi!==null&&fc(jt,gi,fn,mn,!0)}}e:{if(Pt=at?wl(at):window,rn=Pt.nodeName&&Pt.nodeName.toLowerCase(),rn==="select"||rn==="input"&&Pt.type==="file")var gn=_p;else if(oc(Pt))if(md)gn=xp;else{gn=og;var En=Kh}else(rn=Pt.nodeName)&&rn.toLowerCase()==="input"&&(Pt.type==="checkbox"||Pt.type==="radio")&&(gn=Yh);if(gn&&(gn=gn(d,at))){pd(jt,gn,S,Lt);break e}En&&En(d,Pt,at),d==="focusout"&&(En=Pt._wrapperState)&&En.controlled&&Pt.type==="number"&&xi(Pt,"number",Pt.value)}switch(En=at?wl(at):window,d){case"focusin":(oc(En)||En.contentEditable==="true")&&(gl=En,lc=at,Wo=null);break;case"focusout":Wo=lc=gl=null;break;case"mousedown":gd=!0;break;case"contextmenu":case"mouseup":case"dragend":gd=!1,ef(jt,S,Lt);break;case"selectionchange":if(lg)break;case"keydown":case"keyup":ef(jt,S,Lt)}var Cn;if(Uh)e:{switch(d){case"compositionstart":var Vn="onCompositionStart";break e;case"compositionend":Vn="onCompositionEnd";break e;case"compositionupdate":Vn="onCompositionUpdate";break e}Vn=void 0}else ic?Gh(d,S)&&(Vn="onCompositionEnd"):d==="keydown"&&S.keyCode===229&&(Vn="onCompositionStart");Vn&&(hd&&S.locale!=="ko"&&(ic||Vn!=="onCompositionStart"?Vn==="onCompositionEnd"&&ic&&(Cn=Ia()):(Bs=Lt,io="value"in Bs?Bs.value:Bs.textContent,ic=!0)),En=Ss(at,Vn),0<En.length&&(Vn=new Pa(Vn,d,null,S,Lt),jt.push({event:Vn,listeners:En}),Cn?Vn.data=Cn:(Cn=Hh(S),Cn!==null&&(Vn.data=Cn)))),(Cn=$h?uu(d,S):sc(d,S))&&(at=Ss(at,"onBeforeInput"),0<at.length&&(Lt=new Pa("onBeforeInput","beforeinput",null,S,Lt),jt.push({event:Lt,listeners:at}),Lt.data=Cn))}_l(jt,p)})}function zt(d,p,S){return{instance:d,listener:p,currentTarget:S}}function Ss(d,p){for(var S=p+"Capture",N=[];d!==null;){var F=d,W=F.stateNode;F.tag===5&&W!==null&&(F=W,W=Et(d,S),W!=null&&N.unshift(zt(d,W,F)),W=Et(d,p),W!=null&&N.push(zt(d,W,F))),d=d.return}return N}function xl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function fc(d,p,S,N,F){for(var W=p._reactName,se=[];S!==null&&S!==N;){var Ae=S,Ve=Ae.alternate,at=Ae.stateNode;if(Ve!==null&&Ve===N)break;Ae.tag===5&&at!==null&&(Ae=at,F?(Ve=Et(S,W),Ve!=null&&se.unshift(zt(S,Ve,Ae))):F||(Ve=Et(S,W),Ve!=null&&se.push(zt(S,Ve,Ae)))),S=S.return}se.length!==0&&d.push({event:p,listeners:se})}var vu=/\r\n?/g,Di=/\u0000|\uFFFD/g;function pc(d){return(typeof d=="string"?d:""+d).replace(vu,`
`).replace(Di,"")}function vl(d,p,S){if(p=pc(p),pc(d)!==p&&S)throw Error(r(425))}function mc(){}var gc=null,_d=null;function yc(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Oa=typeof setTimeout=="function"?setTimeout:void 0,tf=typeof clearTimeout=="function"?clearTimeout:void 0,Sp=typeof Promise=="function"?Promise:void 0,Ep=typeof queueMicrotask=="function"?queueMicrotask:typeof Sp<"u"?function(d){return Sp.resolve(null).then(d).catch(_c)}:Oa;function _c(d){setTimeout(function(){throw d})}function wu(d,p){var S=p,N=0;do{var F=S.nextSibling;if(d.removeChild(S),F&&F.nodeType===8)if(S=F.data,S==="/$"){if(N===0){d.removeChild(F),To(p);return}N--}else S!=="$"&&S!=="$?"&&S!=="$!"||N++;S=F}while(S);To(p)}function qo(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function xd(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="$"||S==="$!"||S==="$?"){if(p===0)return d;p--}else S==="/$"&&p++}d=d.previousSibling}return null}var da=Math.random().toString(36).slice(2),Es="__reactFiber$"+da,ha="__reactProps$"+da,Eo="__reactContainer$"+da,vd="__reactEvents$"+da,nf="__reactListeners$"+da,Cp="__reactHandles$"+da;function Cs(d){var p=d[Es];if(p)return p;for(var S=d.parentNode;S;){if(p=S[Eo]||S[Es]){if(S=p.alternate,p.child!==null||S!==null&&S.child!==null)for(d=xd(d);d!==null;){if(S=d[Es])return S;d=xd(d)}return p}d=S,S=d.parentNode}return null}function xc(d){return d=d[Es]||d[Eo],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function wl(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function wd(d){return d[ha]||null}var bd=[],za=-1;function fa(d){return{current:d}}function Rr(d){0>za||(d.current=bd[za],bd[za]=null,za--)}function Wn(d,p){za++,bd[za]=d.current,d.current=p}var Ba={},$i=fa(Ba),ks=fa(!1),bl=Ba;function Gi(d,p){var S=d.type.contextTypes;if(!S)return Ba;var N=d.stateNode;if(N&&N.__reactInternalMemoizedUnmaskedChildContext===p)return N.__reactInternalMemoizedMaskedChildContext;var F={},W;for(W in S)F[W]=p[W];return N&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=F),F}function ls(d){return d=d.childContextTypes,d!=null}function Td(){Rr(ks),Rr($i)}function lo(d,p,S){if($i.current!==Ba)throw Error(r(168));Wn($i,p),Wn(ks,S)}function Co(d,p,S){var N=d.stateNode;if(p=p.childContextTypes,typeof N.getChildContext!="function")return S;N=N.getChildContext();for(var F in N)if(!(F in p))throw Error(r(108,xt(d)||"Unknown",F));return We({},S,N)}function Zo(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Ba,bl=$i.current,Wn($i,d),Wn(ks,ks.current),!0}function bu(d,p,S){var N=d.stateNode;if(!N)throw Error(r(169));S?(d=Co(d,p,bl),N.__reactInternalMemoizedMergedChildContext=d,Rr(ks),Rr($i),Wn($i,d)):Rr(ks),Wn(ks,S)}var Ft=null,vc=!1,Tu=!1;function Tl(d){Ft===null?Ft=[d]:Ft.push(d)}function Sl(d){vc=!0,Tl(d)}function Ot(){if(!Tu&&Ft!==null){Tu=!0;var d=0,p=sr;try{var S=Ft;for(sr=1;d<S.length;d++){var N=S[d];do N=N(!0);while(N!==null)}Ft=null,vc=!1}catch(F){throw Ft!==null&&(Ft=Ft.slice(d+1)),Ah(Qs,Ot),F}finally{sr=p,Tu=!1}}return null}var Fa=[],wc=0,Su=null,bc=0,Vs=[],Us=0,El=null,pa=1,ko="";function ma(d,p){Fa[wc++]=bc,Fa[wc++]=Su,Su=d,bc=p}function Sd(d,p,S){Vs[Us++]=pa,Vs[Us++]=ko,Vs[Us++]=El,El=d;var N=pa;d=ko;var F=32-bi(N)-1;N&=~(1<<F),S+=1;var W=32-bi(p)+F;if(30<W){var se=F-F%5;W=(N&(1<<se)-1).toString(32),N>>=se,F-=se,pa=1<<32-bi(p)+F|S<<F|N,ko=W+d}else pa=1<<W|S<<F|N,ko=d}function Va(d){d.return!==null&&(ma(d,1),Sd(d,1,0))}function g(d){for(;d===Su;)Su=Fa[--wc],Fa[wc]=null,bc=Fa[--wc],Fa[wc]=null;for(;d===El;)El=Vs[--Us],Vs[Us]=null,ko=Vs[--Us],Vs[Us]=null,pa=Vs[--Us],Vs[Us]=null}var o=null,h=null,x=!1,T=null;function C(d,p){var S=Qi(5,null,null,0);S.elementType="DELETED",S.stateNode=p,S.return=d,p=d.deletions,p===null?(d.deletions=[S],d.flags|=16):p.push(S)}function R(d,p){switch(d.tag){case 5:var S=d.type;return p=p.nodeType!==1||S.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,o=d,h=qo(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,o=d,h=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(S=El!==null?{id:pa,overflow:ko}:null,d.memoizedState={dehydrated:p,treeContext:S,retryLane:1073741824},S=Qi(18,null,null,0),S.stateNode=p,S.return=d,d.child=S,o=d,h=null,!0):!1;default:return!1}}function D(d){return(d.mode&1)!==0&&(d.flags&128)===0}function B(d){if(x){var p=h;if(p){var S=p;if(!R(d,p)){if(D(d))throw Error(r(418));p=qo(S.nextSibling);var N=o;p&&R(d,p)?C(N,S):(d.flags=d.flags&-4097|2,x=!1,o=d)}}else{if(D(d))throw Error(r(418));d.flags=d.flags&-4097|2,x=!1,o=d}}}function G(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;o=d}function $(d){if(d!==o)return!1;if(!x)return G(d),x=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!yc(d.type,d.memoizedProps)),p&&(p=h)){if(D(d))throw J(),Error(r(418));for(;p;)C(d,p),p=qo(p.nextSibling)}if(G(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="/$"){if(p===0){h=qo(d.nextSibling);break e}p--}else S!=="$"&&S!=="$!"&&S!=="$?"||p++}d=d.nextSibling}h=null}}else h=o?qo(d.stateNode.nextSibling):null;return!0}function J(){for(var d=h;d;)d=qo(d.nextSibling)}function oe(){h=o=null,x=!1}function ce(d){T===null?T=[d]:T.push(d)}var he=pe.ReactCurrentBatchConfig;function de(d,p,S){if(d=S.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(r(309));var N=S.stateNode}if(!N)throw Error(r(147,d));var F=N,W=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===W?p.ref:(p=function(se){var Ae=F.refs;se===null?delete Ae[W]:Ae[W]=se},p._stringRef=W,p)}if(typeof d!="string")throw Error(r(284));if(!S._owner)throw Error(r(290,d))}return d}function me(d,p){throw d=Object.prototype.toString.call(p),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Q(d){var p=d._init;return p(d._payload)}function le(d){function p(tt,He){if(d){var it=tt.deletions;it===null?(tt.deletions=[He],tt.flags|=16):it.push(He)}}function S(tt,He){if(!d)return null;for(;He!==null;)p(tt,He),He=He.sibling;return null}function N(tt,He){for(tt=new Map;He!==null;)He.key!==null?tt.set(He.key,He):tt.set(He.index,He),He=He.sibling;return tt}function F(tt,He){return tt=Rc(tt,He),tt.index=0,tt.sibling=null,tt}function W(tt,He,it){return tt.index=it,d?(it=tt.alternate,it!==null?(it=it.index,it<He?(tt.flags|=2,He):it):(tt.flags|=2,He)):(tt.flags|=1048576,He)}function se(tt){return d&&tt.alternate===null&&(tt.flags|=2),tt}function Ae(tt,He,it,Vt){return He===null||He.tag!==6?(He=Ng(it,tt.mode,Vt),He.return=tt,He):(He=F(He,it),He.return=tt,He)}function Ve(tt,He,it,Vt){var gn=it.type;return gn===je?Lt(tt,He,it.props.children,Vt,it.key):He!==null&&(He.elementType===gn||typeof gn=="object"&&gn!==null&&gn.$$typeof===st&&Q(gn)===He.type)?(Vt=F(He,it.props),Vt.ref=de(tt,He,it),Vt.return=tt,Vt):(Vt=Zp(it.type,it.key,it.props,null,tt.mode,Vt),Vt.ref=de(tt,He,it),Vt.return=tt,Vt)}function at(tt,He,it,Vt){return He===null||He.tag!==4||He.stateNode.containerInfo!==it.containerInfo||He.stateNode.implementation!==it.implementation?(He=Rg(it,tt.mode,Vt),He.return=tt,He):(He=F(He,it.children||[]),He.return=tt,He)}function Lt(tt,He,it,Vt,gn){return He===null||He.tag!==7?(He=Ou(it,tt.mode,Vt,gn),He.return=tt,He):(He=F(He,it),He.return=tt,He)}function jt(tt,He,it){if(typeof He=="string"&&He!==""||typeof He=="number")return He=Ng(""+He,tt.mode,it),He.return=tt,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case xe:return it=Zp(He.type,He.key,He.props,null,tt.mode,it),it.ref=de(tt,null,He),it.return=tt,it;case Ce:return He=Rg(He,tt.mode,it),He.return=tt,He;case st:var Vt=He._init;return jt(tt,Vt(He._payload),it)}if(Zr(He)||Se(He))return He=Ou(He,tt.mode,it,null),He.return=tt,He;me(tt,He)}return null}function Pt(tt,He,it,Vt){var gn=He!==null?He.key:null;if(typeof it=="string"&&it!==""||typeof it=="number")return gn!==null?null:Ae(tt,He,""+it,Vt);if(typeof it=="object"&&it!==null){switch(it.$$typeof){case xe:return it.key===gn?Ve(tt,He,it,Vt):null;case Ce:return it.key===gn?at(tt,He,it,Vt):null;case st:return gn=it._init,Pt(tt,He,gn(it._payload),Vt)}if(Zr(it)||Se(it))return gn!==null?null:Lt(tt,He,it,Vt,null);me(tt,it)}return null}function rn(tt,He,it,Vt,gn){if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number")return tt=tt.get(it)||null,Ae(He,tt,""+Vt,gn);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case xe:return tt=tt.get(Vt.key===null?it:Vt.key)||null,Ve(He,tt,Vt,gn);case Ce:return tt=tt.get(Vt.key===null?it:Vt.key)||null,at(He,tt,Vt,gn);case st:var En=Vt._init;return rn(tt,He,it,En(Vt._payload),gn)}if(Zr(Vt)||Se(Vt))return tt=tt.get(it)||null,Lt(He,tt,Vt,gn,null);me(He,Vt)}return null}function fn(tt,He,it,Vt){for(var gn=null,En=null,Cn=He,Vn=He=0,es=null;Cn!==null&&Vn<it.length;Vn++){Cn.index>Vn?(es=Cn,Cn=null):es=Cn.sibling;var ur=Pt(tt,Cn,it[Vn],Vt);if(ur===null){Cn===null&&(Cn=es);break}d&&Cn&&ur.alternate===null&&p(tt,Cn),He=W(ur,He,Vn),En===null?gn=ur:En.sibling=ur,En=ur,Cn=es}if(Vn===it.length)return S(tt,Cn),x&&ma(tt,Vn),gn;if(Cn===null){for(;Vn<it.length;Vn++)Cn=jt(tt,it[Vn],Vt),Cn!==null&&(He=W(Cn,He,Vn),En===null?gn=Cn:En.sibling=Cn,En=Cn);return x&&ma(tt,Vn),gn}for(Cn=N(tt,Cn);Vn<it.length;Vn++)es=rn(Cn,tt,Vn,it[Vn],Vt),es!==null&&(d&&es.alternate!==null&&Cn.delete(es.key===null?Vn:es.key),He=W(es,He,Vn),En===null?gn=es:En.sibling=es,En=es);return d&&Cn.forEach(function(Qo){return p(tt,Qo)}),x&&ma(tt,Vn),gn}function mn(tt,He,it,Vt){var gn=Se(it);if(typeof gn!="function")throw Error(r(150));if(it=gn.call(it),it==null)throw Error(r(151));for(var En=gn=null,Cn=He,Vn=He=0,es=null,ur=it.next();Cn!==null&&!ur.done;Vn++,ur=it.next()){Cn.index>Vn?(es=Cn,Cn=null):es=Cn.sibling;var Qo=Pt(tt,Cn,ur.value,Vt);if(Qo===null){Cn===null&&(Cn=es);break}d&&Cn&&Qo.alternate===null&&p(tt,Cn),He=W(Qo,He,Vn),En===null?gn=Qo:En.sibling=Qo,En=Qo,Cn=es}if(ur.done)return S(tt,Cn),x&&ma(tt,Vn),gn;if(Cn===null){for(;!ur.done;Vn++,ur=it.next())ur=jt(tt,ur.value,Vt),ur!==null&&(He=W(ur,He,Vn),En===null?gn=ur:En.sibling=ur,En=ur);return x&&ma(tt,Vn),gn}for(Cn=N(tt,Cn);!ur.done;Vn++,ur=it.next())ur=rn(Cn,tt,Vn,ur.value,Vt),ur!==null&&(d&&ur.alternate!==null&&Cn.delete(ur.key===null?Vn:ur.key),He=W(ur,He,Vn),En===null?gn=ur:En.sibling=ur,En=ur);return d&&Cn.forEach(function(U_){return p(tt,U_)}),x&&ma(tt,Vn),gn}function gi(tt,He,it,Vt){if(typeof it=="object"&&it!==null&&it.type===je&&it.key===null&&(it=it.props.children),typeof it=="object"&&it!==null){switch(it.$$typeof){case xe:e:{for(var gn=it.key,En=He;En!==null;){if(En.key===gn){if(gn=it.type,gn===je){if(En.tag===7){S(tt,En.sibling),He=F(En,it.props.children),He.return=tt,tt=He;break e}}else if(En.elementType===gn||typeof gn=="object"&&gn!==null&&gn.$$typeof===st&&Q(gn)===En.type){S(tt,En.sibling),He=F(En,it.props),He.ref=de(tt,En,it),He.return=tt,tt=He;break e}S(tt,En);break}else p(tt,En);En=En.sibling}it.type===je?(He=Ou(it.props.children,tt.mode,Vt,it.key),He.return=tt,tt=He):(Vt=Zp(it.type,it.key,it.props,null,tt.mode,Vt),Vt.ref=de(tt,He,it),Vt.return=tt,tt=Vt)}return se(tt);case Ce:e:{for(En=it.key;He!==null;){if(He.key===En)if(He.tag===4&&He.stateNode.containerInfo===it.containerInfo&&He.stateNode.implementation===it.implementation){S(tt,He.sibling),He=F(He,it.children||[]),He.return=tt,tt=He;break e}else{S(tt,He);break}else p(tt,He);He=He.sibling}He=Rg(it,tt.mode,Vt),He.return=tt,tt=He}return se(tt);case st:return En=it._init,gi(tt,He,En(it._payload),Vt)}if(Zr(it))return fn(tt,He,it,Vt);if(Se(it))return mn(tt,He,it,Vt);me(tt,it)}return typeof it=="string"&&it!==""||typeof it=="number"?(it=""+it,He!==null&&He.tag===6?(S(tt,He.sibling),He=F(He,it),He.return=tt,tt=He):(S(tt,He),He=Ng(it,tt.mode,Vt),He.return=tt,tt=He),se(tt)):S(tt,He)}return gi}var _e=le(!0),ve=le(!1),Ne=fa(null),De=null,Re=null,Ge=null;function $e(){Ge=Re=De=null}function Ye(d){var p=Ne.current;Rr(Ne),d._currentValue=p}function At(d,p,S){for(;d!==null;){var N=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,N!==null&&(N.childLanes|=p)):N!==null&&(N.childLanes&p)!==p&&(N.childLanes|=p),d===S)break;d=d.return}}function qe(d,p){De=d,Ge=Re=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Yi=!0),d.firstContext=null)}function ct(d){var p=d._currentValue;if(Ge!==d)if(d={context:d,memoizedValue:p,next:null},Re===null){if(De===null)throw Error(r(308));Re=d,De.dependencies={lanes:0,firstContext:d}}else Re=Re.next=d;return p}var Je=null;function Ct(d){Je===null?Je=[d]:Je.push(d)}function Ke(d,p,S,N){var F=p.interleaved;return F===null?(S.next=S,Ct(p)):(S.next=F.next,F.next=S),p.interleaved=S,dt(d,N)}function dt(d,p){d.lanes|=p;var S=d.alternate;for(S!==null&&(S.lanes|=p),S=d,d=d.return;d!==null;)d.childLanes|=p,S=d.alternate,S!==null&&(S.childLanes|=p),S=d,d=d.return;return S.tag===3?S.stateNode:null}var St=!1;function wt(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function It(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function en(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function _n(d,p,S){var N=d.updateQueue;if(N===null)return null;if(N=N.shared,(hn&2)!==0){var F=N.pending;return F===null?p.next=p:(p.next=F.next,F.next=p),N.pending=p,dt(d,S)}return F=N.interleaved,F===null?(p.next=p,Ct(N)):(p.next=F.next,F.next=p),N.interleaved=p,dt(d,S)}function Wt(d,p,S){if(p=p.updateQueue,p!==null&&(p=p.shared,(S&4194240)!==0)){var N=p.lanes;N&=d.pendingLanes,S|=N,p.lanes=S,cl(d,S)}}function dn(d,p){var S=d.updateQueue,N=d.alternate;if(N!==null&&(N=N.updateQueue,S===N)){var F=null,W=null;if(S=S.firstBaseUpdate,S!==null){do{var se={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};W===null?F=W=se:W=W.next=se,S=S.next}while(S!==null);W===null?F=W=p:W=W.next=p}else F=W=p;S={baseState:N.baseState,firstBaseUpdate:F,lastBaseUpdate:W,shared:N.shared,effects:N.effects},d.updateQueue=S;return}d=S.lastBaseUpdate,d===null?S.firstBaseUpdate=p:d.next=p,S.lastBaseUpdate=p}function jn(d,p,S,N){var F=d.updateQueue;St=!1;var W=F.firstBaseUpdate,se=F.lastBaseUpdate,Ae=F.shared.pending;if(Ae!==null){F.shared.pending=null;var Ve=Ae,at=Ve.next;Ve.next=null,se===null?W=at:se.next=at,se=Ve;var Lt=d.alternate;Lt!==null&&(Lt=Lt.updateQueue,Ae=Lt.lastBaseUpdate,Ae!==se&&(Ae===null?Lt.firstBaseUpdate=at:Ae.next=at,Lt.lastBaseUpdate=Ve))}if(W!==null){var jt=F.baseState;se=0,Lt=at=Ve=null,Ae=W;do{var Pt=Ae.lane,rn=Ae.eventTime;if((N&Pt)===Pt){Lt!==null&&(Lt=Lt.next={eventTime:rn,lane:0,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null});e:{var fn=d,mn=Ae;switch(Pt=p,rn=S,mn.tag){case 1:if(fn=mn.payload,typeof fn=="function"){jt=fn.call(rn,jt,Pt);break e}jt=fn;break e;case 3:fn.flags=fn.flags&-65537|128;case 0:if(fn=mn.payload,Pt=typeof fn=="function"?fn.call(rn,jt,Pt):fn,Pt==null)break e;jt=We({},jt,Pt);break e;case 2:St=!0}}Ae.callback!==null&&Ae.lane!==0&&(d.flags|=64,Pt=F.effects,Pt===null?F.effects=[Ae]:Pt.push(Ae))}else rn={eventTime:rn,lane:Pt,tag:Ae.tag,payload:Ae.payload,callback:Ae.callback,next:null},Lt===null?(at=Lt=rn,Ve=jt):Lt=Lt.next=rn,se|=Pt;if(Ae=Ae.next,Ae===null){if(Ae=F.shared.pending,Ae===null)break;Pt=Ae,Ae=Pt.next,Pt.next=null,F.lastBaseUpdate=Pt,F.shared.pending=null}}while(!0);if(Lt===null&&(Ve=jt),F.baseState=Ve,F.firstBaseUpdate=at,F.lastBaseUpdate=Lt,p=F.shared.interleaved,p!==null){F=p;do se|=F.lane,F=F.next;while(F!==p)}else W===null&&(F.shared.lanes=0);Yr|=se,d.lanes=se,d.memoizedState=jt}}function Fn(d,p,S){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var N=d[p],F=N.callback;if(F!==null){if(N.callback=null,N=S,typeof F!="function")throw Error(r(191,F));F.call(N)}}}var tn={},Gn=fa(tn),ar=fa(tn),lr=fa(tn);function rr(d){if(d===tn)throw Error(r(174));return d}function Li(d,p){switch(Wn(lr,p),Wn(ar,d),Wn(Gn,tn),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:ss(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=ss(p,d)}Rr(Gn),Wn(Gn,p)}function $r(){Rr(Gn),Rr(ar),Rr(lr)}function $s(d){rr(lr.current);var p=rr(Gn.current),S=ss(p,d.type);p!==S&&(Wn(ar,d),Wn(Gn,S))}function co(d){ar.current===d&&(Rr(Gn),Rr(ar))}var In=fa(0);function pr(d){for(var p=d;p!==null;){if(p.tag===13){var S=p.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var er=[];function Gr(){for(var d=0;d<er.length;d++)er[d]._workInProgressVersionPrimary=null;er.length=0}var ji=pe.ReactCurrentDispatcher,xr=pe.ReactCurrentBatchConfig,hi=0,Dr=null,Or=null,Kr=null,uo=!1,ho=!1,Ao=0,Ed=0;function fi(){throw Error(r(321))}function Eu(d,p){if(p===null)return!1;for(var S=0;S<p.length&&S<d.length;S++)if(!oo(d[S],p[S]))return!1;return!0}function kp(d,p,S,N,F,W){if(hi=W,Dr=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,ji.current=d===null||d.memoizedState===null?A_:I_,d=S(N,F),ho){W=0;do{if(ho=!1,Ao=0,25<=W)throw Error(r(301));W+=1,Kr=Or=null,p.updateQueue=null,ji.current=ya,d=S(N,F)}while(ho)}if(ji.current=cs,p=Or!==null&&Or.next!==null,hi=0,Kr=Or=Dr=null,uo=!1,p)throw Error(r(300));return d}function Ap(){var d=Ao!==0;return Ao=0,d}function Ua(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?Dr.memoizedState=Kr=d:Kr=Kr.next=d,Kr}function fo(){if(Or===null){var d=Dr.alternate;d=d!==null?d.memoizedState:null}else d=Or.next;var p=Kr===null?Dr.memoizedState:Kr.next;if(p!==null)Kr=p,Or=d;else{if(d===null)throw Error(r(310));Or=d,d={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Kr===null?Dr.memoizedState=Kr=d:Kr=Kr.next=d}return Kr}function Tc(d,p){return typeof p=="function"?p(d):p}function Ip(d){var p=fo(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var N=Or,F=N.baseQueue,W=S.pending;if(W!==null){if(F!==null){var se=F.next;F.next=W.next,W.next=se}N.baseQueue=F=W,S.pending=null}if(F!==null){W=F.next,N=N.baseState;var Ae=se=null,Ve=null,at=W;do{var Lt=at.lane;if((hi&Lt)===Lt)Ve!==null&&(Ve=Ve.next={lane:0,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null}),N=at.hasEagerState?at.eagerState:d(N,at.action);else{var jt={lane:Lt,action:at.action,hasEagerState:at.hasEagerState,eagerState:at.eagerState,next:null};Ve===null?(Ae=Ve=jt,se=N):Ve=Ve.next=jt,Dr.lanes|=Lt,Yr|=Lt}at=at.next}while(at!==null&&at!==W);Ve===null?se=N:Ve.next=Ae,oo(N,p.memoizedState)||(Yi=!0),p.memoizedState=N,p.baseState=se,p.baseQueue=Ve,S.lastRenderedState=N}if(d=S.interleaved,d!==null){F=d;do W=F.lane,Dr.lanes|=W,Yr|=W,F=F.next;while(F!==d)}else F===null&&(S.lanes=0);return[p.memoizedState,S.dispatch]}function rf(d){var p=fo(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var N=S.dispatch,F=S.pending,W=p.memoizedState;if(F!==null){S.pending=null;var se=F=F.next;do W=d(W,se.action),se=se.next;while(se!==F);oo(W,p.memoizedState)||(Yi=!0),p.memoizedState=W,p.baseQueue===null&&(p.baseState=W),S.lastRenderedState=W}return[W,N]}function sf(){}function $a(d,p){var S=Dr,N=fo(),F=p(),W=!oo(N.memoizedState,F);if(W&&(N.memoizedState=F,Yi=!0),N=N.queue,Ga(ug.bind(null,S,N,d),[d]),N.getSnapshot!==p||W||Kr!==null&&Kr.memoizedState.tag&1){if(S.flags|=2048,Cu(9,cg.bind(null,S,N,F,p),void 0,null),zi===null)throw Error(r(349));(hi&30)!==0||of(S,p,F)}return F}function of(d,p,S){d.flags|=16384,d={getSnapshot:p,value:S},p=Dr.updateQueue,p===null?(p={lastEffect:null,stores:null},Dr.updateQueue=p,p.stores=[d]):(S=p.stores,S===null?p.stores=[d]:S.push(d))}function cg(d,p,S,N){p.value=S,p.getSnapshot=N,w_(p)&&b_(d)}function ug(d,p,S){return S(function(){w_(p)&&b_(d)})}function w_(d){var p=d.getSnapshot;d=d.value;try{var S=p();return!oo(d,S)}catch{return!0}}function b_(d){var p=dt(d,1);p!==null&&wa(p,d,1,-1)}function T_(d){var p=Ua();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tc,lastRenderedState:d},p.queue=d,d=d.dispatch=si.bind(null,Dr,d),[p.memoizedState,d]}function Cu(d,p,S,N){return d={tag:d,create:p,destroy:S,deps:N,next:null},p=Dr.updateQueue,p===null?(p={lastEffect:null,stores:null},Dr.updateQueue=p,p.lastEffect=d.next=d):(S=p.lastEffect,S===null?p.lastEffect=d.next=d:(N=S.next,S.next=d,d.next=N,p.lastEffect=d)),d}function Cd(){return fo().memoizedState}function Cl(d,p,S,N){var F=Ua();Dr.flags|=d,F.memoizedState=Cu(1|p,S,void 0,N===void 0?null:N)}function Xo(d,p,S,N){var F=fo();N=N===void 0?null:N;var W=void 0;if(Or!==null){var se=Or.memoizedState;if(W=se.destroy,N!==null&&Eu(N,se.deps)){F.memoizedState=Cu(p,S,W,N);return}}Dr.flags|=d,F.memoizedState=Cu(1|p,S,W,N)}function Ko(d,p){return Cl(8390656,8,d,p)}function Ga(d,p){return Xo(2048,8,d,p)}function kl(d,p){return Xo(4,2,d,p)}function Sc(d,p){return Xo(4,4,d,p)}function S_(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function E_(d,p,S){return S=S!=null?S.concat([d]):null,Xo(4,4,S_.bind(null,p,d),S)}function dg(){}function C_(d,p){var S=fo();p=p===void 0?null:p;var N=S.memoizedState;return N!==null&&p!==null&&Eu(p,N[1])?N[0]:(S.memoizedState=[d,p],d)}function hg(d,p){var S=fo();p=p===void 0?null:p;var N=S.memoizedState;return N!==null&&p!==null&&Eu(p,N[1])?N[0]:(d=d(),S.memoizedState=[d,p],d)}function fg(d,p,S){return(hi&21)===0?(d.baseState&&(d.baseState=!1,Yi=!0),d.memoizedState=S):(oo(S,p)||(S=ws(),Dr.lanes|=S,Yr|=S,d.baseState=!0),p)}function ga(d,p){var S=sr;sr=S!==0&&4>S?S:4,d(!0);var N=xr.transition;xr.transition={};try{d(!1),p()}finally{sr=S,xr.transition=N}}function k_(){return fo().memoizedState}function w0(d,p,S){var N=Ka(d);if(S={lane:N,action:S,hasEagerState:!1,eagerState:null,next:null},ln(d))Al(p,S);else if(S=Ke(d,p,S,N),S!==null){var F=Ws();wa(S,d,N,F),af(S,p,N)}}function si(d,p,S){var N=Ka(d),F={lane:N,action:S,hasEagerState:!1,eagerState:null,next:null};if(ln(d))Al(p,F);else{var W=d.alternate;if(d.lanes===0&&(W===null||W.lanes===0)&&(W=p.lastRenderedReducer,W!==null))try{var se=p.lastRenderedState,Ae=W(se,S);if(F.hasEagerState=!0,F.eagerState=Ae,oo(Ae,se)){var Ve=p.interleaved;Ve===null?(F.next=F,Ct(p)):(F.next=Ve.next,Ve.next=F),p.interleaved=F;return}}catch{}S=Ke(d,p,F,N),S!==null&&(F=Ws(),wa(S,d,N,F),af(S,p,N))}}function ln(d){var p=d.alternate;return d===Dr||p!==null&&p===Dr}function Al(d,p){ho=uo=!0;var S=d.pending;S===null?p.next=p:(p.next=S.next,S.next=p),d.pending=p}function af(d,p,S){if((S&4194240)!==0){var N=p.lanes;N&=d.pendingLanes,S|=N,p.lanes=S,cl(d,S)}}var cs={readContext:ct,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},A_={readContext:ct,useCallback:function(d,p){return Ua().memoizedState=[d,p===void 0?null:p],d},useContext:ct,useEffect:Ko,useImperativeHandle:function(d,p,S){return S=S!=null?S.concat([d]):null,Cl(4194308,4,S_.bind(null,p,d),S)},useLayoutEffect:function(d,p){return Cl(4194308,4,d,p)},useInsertionEffect:function(d,p){return Cl(4,2,d,p)},useMemo:function(d,p){var S=Ua();return p=p===void 0?null:p,d=d(),S.memoizedState=[d,p],d},useReducer:function(d,p,S){var N=Ua();return p=S!==void 0?S(p):p,N.memoizedState=N.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},N.queue=d,d=d.dispatch=w0.bind(null,Dr,d),[N.memoizedState,d]},useRef:function(d){var p=Ua();return d={current:d},p.memoizedState=d},useState:T_,useDebugValue:dg,useDeferredValue:function(d){return Ua().memoizedState=d},useTransition:function(){var d=T_(!1),p=d[0];return d=ga.bind(null,d[1]),Ua().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,S){var N=Dr,F=Ua();if(x){if(S===void 0)throw Error(r(407));S=S()}else{if(S=p(),zi===null)throw Error(r(349));(hi&30)!==0||of(N,p,S)}F.memoizedState=S;var W={value:S,getSnapshot:p};return F.queue=W,Ko(ug.bind(null,N,W,d),[d]),N.flags|=2048,Cu(9,cg.bind(null,N,W,S,p),void 0,null),S},useId:function(){var d=Ua(),p=zi.identifierPrefix;if(x){var S=ko,N=pa;S=(N&~(1<<32-bi(N)-1)).toString(32)+S,p=":"+p+"R"+S,S=Ao++,0<S&&(p+="H"+S.toString(32)),p+=":"}else S=Ed++,p=":"+p+"r"+S.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},I_={readContext:ct,useCallback:C_,useContext:ct,useEffect:Ga,useImperativeHandle:E_,useInsertionEffect:kl,useLayoutEffect:Sc,useMemo:hg,useReducer:Ip,useRef:Cd,useState:function(){return Ip(Tc)},useDebugValue:dg,useDeferredValue:function(d){var p=fo();return fg(p,Or.memoizedState,d)},useTransition:function(){var d=Ip(Tc)[0],p=fo().memoizedState;return[d,p]},useMutableSource:sf,useSyncExternalStore:$a,useId:k_,unstable_isNewReconciler:!1},ya={readContext:ct,useCallback:C_,useContext:ct,useEffect:Ga,useImperativeHandle:E_,useInsertionEffect:kl,useLayoutEffect:Sc,useMemo:hg,useReducer:rf,useRef:Cd,useState:function(){return rf(Tc)},useDebugValue:dg,useDeferredValue:function(d){var p=fo();return Or===null?p.memoizedState=d:fg(p,Or.memoizedState,d)},useTransition:function(){var d=rf(Tc)[0],p=fo().memoizedState;return[d,p]},useMutableSource:sf,useSyncExternalStore:$a,useId:k_,unstable_isNewReconciler:!1};function Io(d,p){if(d&&d.defaultProps){p=We({},p),d=d.defaultProps;for(var S in d)p[S]===void 0&&(p[S]=d[S]);return p}return p}function Il(d,p,S,N){p=d.memoizedState,S=S(N,p),S=S==null?p:We({},p,S),d.memoizedState=S,d.lanes===0&&(d.updateQueue.baseState=S)}var Ec={isMounted:function(d){return(d=d._reactInternals)?Nr(d)===d:!1},enqueueSetState:function(d,p,S){d=d._reactInternals;var N=Ws(),F=Ka(d),W=en(N,F);W.payload=p,S!=null&&(W.callback=S),p=_n(d,W,F),p!==null&&(wa(p,d,F,N),Wt(p,d,F))},enqueueReplaceState:function(d,p,S){d=d._reactInternals;var N=Ws(),F=Ka(d),W=en(N,F);W.tag=1,W.payload=p,S!=null&&(W.callback=S),p=_n(d,W,F),p!==null&&(wa(p,d,F,N),Wt(p,d,F))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var S=Ws(),N=Ka(d),F=en(S,N);F.tag=2,p!=null&&(F.callback=p),p=_n(d,F,N),p!==null&&(wa(p,d,N,S),Wt(p,d,N))}};function Cc(d,p,S,N,F,W,se){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(N,W,se):p.prototype&&p.prototype.isPureReactComponent?!Ra(S,N)||!Ra(F,W):!0}function Mp(d,p,S){var N=!1,F=Ba,W=p.contextType;return typeof W=="object"&&W!==null?W=ct(W):(F=ls(p)?bl:$i.current,N=p.contextTypes,W=(N=N!=null)?Gi(d,F):Ba),p=new p(S,W),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Ec,d.stateNode=p,p._reactInternals=d,N&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=F,d.__reactInternalMemoizedMaskedChildContext=W),p}function lf(d,p,S,N){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(S,N),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(S,N),p.state!==d&&Ec.enqueueReplaceState(p,p.state,null)}function Pp(d,p,S,N){var F=d.stateNode;F.props=S,F.state=d.memoizedState,F.refs={},wt(d);var W=p.contextType;typeof W=="object"&&W!==null?F.context=ct(W):(W=ls(p)?bl:$i.current,F.context=Gi(d,W)),F.state=d.memoizedState,W=p.getDerivedStateFromProps,typeof W=="function"&&(Il(d,p,W,S),F.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(p=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),p!==F.state&&Ec.enqueueReplaceState(F,F.state,null),jn(d,S,F,N),F.state=d.memoizedState),typeof F.componentDidMount=="function"&&(d.flags|=4194308)}function ku(d,p){try{var S="",N=p;do S+=Kt(N),N=N.return;while(N);var F=S}catch(W){F=`
Error generating stack: `+W.message+`
`+W.stack}return{value:d,source:p,stack:F,digest:null}}function pg(d,p,S){return{value:d,source:null,stack:S??null,digest:p??null}}function cf(d,p){try{console.error(p.value)}catch(S){setTimeout(function(){throw S})}}var M_=typeof WeakMap=="function"?WeakMap:Map;function kd(d,p,S){S=en(-1,S),S.tag=3,S.payload={element:null};var N=p.value;return S.callback=function(){xf||(xf=!0,Sg=N),cf(d,p)},S}function Au(d,p,S){S=en(-1,S),S.tag=3;var N=d.type.getDerivedStateFromError;if(typeof N=="function"){var F=p.value;S.payload=function(){return N(F)},S.callback=function(){cf(d,p)}}var W=d.stateNode;return W!==null&&typeof W.componentDidCatch=="function"&&(S.callback=function(){cf(d,p),typeof N!="function"&&(Is===null?Is=new Set([this]):Is.add(this));var se=p.stack;this.componentDidCatch(p.value,{componentStack:se!==null?se:""})}),S}function Ha(d,p,S){var N=d.pingCache;if(N===null){N=d.pingCache=new M_;var F=new Set;N.set(p,F)}else F=N.get(p),F===void 0&&(F=new Set,N.set(p,F));F.has(S)||(F.add(S),d=Pg.bind(null,d,p,S),p.then(d,d))}function Np(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function mg(d,p,S,N,F){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(p=en(-1,1),p.tag=2,_n(S,p,1))),S.lanes|=1),d):(d.flags|=65536,d.lanes=F,d)}var uf=pe.ReactCurrentOwner,Yi=!1;function zr(d,p,S,N){p.child=d===null?ve(p,null,S,N):_e(p,d.child,S,N)}function Ad(d,p,S,N,F){S=S.render;var W=p.ref;return qe(p,F),N=kp(d,p,S,N,W,F),S=Ap(),d!==null&&!Yi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~F,Wa(d,p,F)):(x&&S&&Va(p),p.flags|=1,zr(d,p,N,F),p.child)}function us(d,p,S,N,F){if(d===null){var W=S.type;return typeof W=="function"&&!ju(W)&&W.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(p.tag=15,p.type=W,Mo(d,p,W,N,F)):(d=Zp(S.type,null,N,p,p.mode,F),d.ref=p.ref,d.return=p,p.child=d)}if(W=d.child,(d.lanes&F)===0){var se=W.memoizedProps;if(S=S.compare,S=S!==null?S:Ra,S(se,N)&&d.ref===p.ref)return Wa(d,p,F)}return p.flags|=1,d=Rc(W,N),d.ref=p.ref,d.return=p,p.child=d}function Mo(d,p,S,N,F){if(d!==null){var W=d.memoizedProps;if(Ra(W,N)&&d.ref===p.ref)if(Yi=!1,p.pendingProps=N=W,(d.lanes&F)!==0)(d.flags&131072)!==0&&(Yi=!0);else return p.lanes=d.lanes,Wa(d,p,F)}return Dp(d,p,S,N,F)}function Rp(d,p,S){var N=p.pendingProps,F=N.children,W=d!==null?d.memoizedState:null;if(N.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(Ji,oi),oi|=S;else{if((S&1073741824)===0)return d=W!==null?W.baseLanes|S:S,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,Wn(Ji,oi),oi|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},N=W!==null?W.baseLanes:S,Wn(Ji,oi),oi|=N}else W!==null?(N=W.baseLanes|S,p.memoizedState=null):N=S,Wn(Ji,oi),oi|=N;return zr(d,p,F,S),p.child}function Hr(d,p){var S=p.ref;(d===null&&S!==null||d!==null&&d.ref!==S)&&(p.flags|=512,p.flags|=2097152)}function Dp(d,p,S,N,F){var W=ls(S)?bl:$i.current;return W=Gi(p,W),qe(p,F),S=kp(d,p,S,N,W,F),N=Ap(),d!==null&&!Yi?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~F,Wa(d,p,F)):(x&&N&&Va(p),p.flags|=1,zr(d,p,S,F),p.child)}function Id(d,p,S,N,F){if(ls(S)){var W=!0;Zo(p)}else W=!1;if(qe(p,F),p.stateNode===null)hf(d,p),Mp(p,S,N),Pp(p,S,N,F),N=!0;else if(d===null){var se=p.stateNode,Ae=p.memoizedProps;se.props=Ae;var Ve=se.context,at=S.contextType;typeof at=="object"&&at!==null?at=ct(at):(at=ls(S)?bl:$i.current,at=Gi(p,at));var Lt=S.getDerivedStateFromProps,jt=typeof Lt=="function"||typeof se.getSnapshotBeforeUpdate=="function";jt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Ae!==N||Ve!==at)&&lf(p,se,N,at),St=!1;var Pt=p.memoizedState;se.state=Pt,jn(p,N,se,F),Ve=p.memoizedState,Ae!==N||Pt!==Ve||ks.current||St?(typeof Lt=="function"&&(Il(p,S,Lt,N),Ve=p.memoizedState),(Ae=St||Cc(p,S,Ae,N,Pt,Ve,at))?(jt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(p.flags|=4194308)):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=N,p.memoizedState=Ve),se.props=N,se.state=Ve,se.context=at,N=Ae):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),N=!1)}else{se=p.stateNode,It(d,p),Ae=p.memoizedProps,at=p.type===p.elementType?Ae:Io(p.type,Ae),se.props=at,jt=p.pendingProps,Pt=se.context,Ve=S.contextType,typeof Ve=="object"&&Ve!==null?Ve=ct(Ve):(Ve=ls(S)?bl:$i.current,Ve=Gi(p,Ve));var rn=S.getDerivedStateFromProps;(Lt=typeof rn=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Ae!==jt||Pt!==Ve)&&lf(p,se,N,Ve),St=!1,Pt=p.memoizedState,se.state=Pt,jn(p,N,se,F);var fn=p.memoizedState;Ae!==jt||Pt!==fn||ks.current||St?(typeof rn=="function"&&(Il(p,S,rn,N),fn=p.memoizedState),(at=St||Cc(p,S,at,N,Pt,fn,Ve)||!1)?(Lt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(N,fn,Ve),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(N,fn,Ve)),typeof se.componentDidUpdate=="function"&&(p.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof se.componentDidUpdate!="function"||Ae===d.memoizedProps&&Pt===d.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Ae===d.memoizedProps&&Pt===d.memoizedState||(p.flags|=1024),p.memoizedProps=N,p.memoizedState=fn),se.props=N,se.state=fn,se.context=Ve,N=at):(typeof se.componentDidUpdate!="function"||Ae===d.memoizedProps&&Pt===d.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Ae===d.memoizedProps&&Pt===d.memoizedState||(p.flags|=1024),N=!1)}return Po(d,p,S,N,W,F)}function Po(d,p,S,N,F,W){Hr(d,p);var se=(p.flags&128)!==0;if(!N&&!se)return F&&bu(p,S,!1),Wa(d,p,W);N=p.stateNode,uf.current=p;var Ae=se&&typeof S.getDerivedStateFromError!="function"?null:N.render();return p.flags|=1,d!==null&&se?(p.child=_e(p,d.child,null,W),p.child=_e(p,null,Ae,W)):zr(d,p,Ae,W),p.memoizedState=N.state,F&&bu(p,S,!0),p.child}function P_(d){var p=d.stateNode;p.pendingContext?lo(d,p.pendingContext,p.pendingContext!==p.context):p.context&&lo(d,p.context,!1),Li(d,p.containerInfo)}function N_(d,p,S,N,F){return oe(),ce(F),p.flags|=256,zr(d,p,S,N),p.child}var Lp={dehydrated:null,treeContext:null,retryLane:0};function jp(d){return{baseLanes:d,cachePool:null,transitions:null}}function kc(d,p,S){var N=p.pendingProps,F=In.current,W=!1,se=(p.flags&128)!==0,Ae;if((Ae=se)||(Ae=d!==null&&d.memoizedState===null?!1:(F&2)!==0),Ae?(W=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(F|=1),Wn(In,F&1),d===null)return B(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(se=N.children,d=N.fallback,W?(N=p.mode,W=p.child,se={mode:"hidden",children:se},(N&1)===0&&W!==null?(W.childLanes=0,W.pendingProps=se):W=Xp(se,N,0,null),d=Ou(d,N,S,null),W.return=p,d.return=p,W.sibling=d,p.child=W,p.child.memoizedState=jp(S),p.memoizedState=Lp,d):Op(p,se));if(F=d.memoizedState,F!==null&&(Ae=F.dehydrated,Ae!==null))return R_(d,p,se,N,Ae,F,S);if(W){W=N.fallback,se=p.mode,F=d.child,Ae=F.sibling;var Ve={mode:"hidden",children:N.children};return(se&1)===0&&p.child!==F?(N=p.child,N.childLanes=0,N.pendingProps=Ve,p.deletions=null):(N=Rc(F,Ve),N.subtreeFlags=F.subtreeFlags&14680064),Ae!==null?W=Rc(Ae,W):(W=Ou(W,se,S,null),W.flags|=2),W.return=p,N.return=p,N.sibling=W,p.child=N,N=W,W=p.child,se=d.child.memoizedState,se=se===null?jp(S):{baseLanes:se.baseLanes|S,cachePool:null,transitions:se.transitions},W.memoizedState=se,W.childLanes=d.childLanes&~S,p.memoizedState=Lp,N}return W=d.child,d=W.sibling,N=Rc(W,{mode:"visible",children:N.children}),(p.mode&1)===0&&(N.lanes=S),N.return=p,N.sibling=null,d!==null&&(S=p.deletions,S===null?(p.deletions=[d],p.flags|=16):S.push(d)),p.child=N,p.memoizedState=null,N}function Op(d,p){return p=Xp({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function df(d,p,S,N){return N!==null&&ce(N),_e(p,d.child,null,S),d=Op(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function R_(d,p,S,N,F,W,se){if(S)return p.flags&256?(p.flags&=-257,N=pg(Error(r(422))),df(d,p,se,N)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(W=N.fallback,F=p.mode,N=Xp({mode:"visible",children:N.children},F,0,null),W=Ou(W,F,se,null),W.flags|=2,N.return=p,W.return=p,N.sibling=W,p.child=N,(p.mode&1)!==0&&_e(p,d.child,null,se),p.child.memoizedState=jp(se),p.memoizedState=Lp,W);if((p.mode&1)===0)return df(d,p,se,null);if(F.data==="$!"){if(N=F.nextSibling&&F.nextSibling.dataset,N)var Ae=N.dgst;return N=Ae,W=Error(r(419)),N=pg(W,N,void 0),df(d,p,se,N)}if(Ae=(se&d.childLanes)!==0,Yi||Ae){if(N=zi,N!==null){switch(se&-se){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=(F&(N.suspendedLanes|se))!==0?0:F,F!==0&&F!==W.retryLane&&(W.retryLane=F,dt(d,F),wa(N,d,F,-1))}return kg(),N=pg(Error(r(421))),df(d,p,se,N)}return F.data==="$?"?(p.flags|=128,p.child=d.child,p=k0.bind(null,d),F._reactRetry=p,null):(d=W.treeContext,h=qo(F.nextSibling),o=p,x=!0,T=null,d!==null&&(Vs[Us++]=pa,Vs[Us++]=ko,Vs[Us++]=El,pa=d.id,ko=d.overflow,El=p),p=Op(p,N.children),p.flags|=4096,p)}function gg(d,p,S){d.lanes|=p;var N=d.alternate;N!==null&&(N.lanes|=p),At(d.return,p,S)}function yg(d,p,S,N,F){var W=d.memoizedState;W===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:N,tail:S,tailMode:F}:(W.isBackwards=p,W.rendering=null,W.renderingStartTime=0,W.last=N,W.tail=S,W.tailMode=F)}function D_(d,p,S){var N=p.pendingProps,F=N.revealOrder,W=N.tail;if(zr(d,p,N.children,S),N=In.current,(N&2)!==0)N=N&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&gg(d,S,p);else if(d.tag===19)gg(d,S,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}N&=1}if(Wn(In,N),(p.mode&1)===0)p.memoizedState=null;else switch(F){case"forwards":for(S=p.child,F=null;S!==null;)d=S.alternate,d!==null&&pr(d)===null&&(F=S),S=S.sibling;S=F,S===null?(F=p.child,p.child=null):(F=S.sibling,S.sibling=null),yg(p,!1,F,S,W);break;case"backwards":for(S=null,F=p.child,p.child=null;F!==null;){if(d=F.alternate,d!==null&&pr(d)===null){p.child=F;break}d=F.sibling,F.sibling=S,S=F,F=d}yg(p,!0,S,null,W);break;case"together":yg(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function hf(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function Wa(d,p,S){if(d!==null&&(p.dependencies=d.dependencies),Yr|=p.lanes,(S&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(r(153));if(p.child!==null){for(d=p.child,S=Rc(d,d.pendingProps),p.child=S,S.return=p;d.sibling!==null;)d=d.sibling,S=S.sibling=Rc(d,d.pendingProps),S.return=p;S.sibling=null}return p.child}function ff(d,p,S){switch(p.tag){case 3:P_(p),oe();break;case 5:$s(p);break;case 1:ls(p.type)&&Zo(p);break;case 4:Li(p,p.stateNode.containerInfo);break;case 10:var N=p.type._context,F=p.memoizedProps.value;Wn(Ne,N._currentValue),N._currentValue=F;break;case 13:if(N=p.memoizedState,N!==null)return N.dehydrated!==null?(Wn(In,In.current&1),p.flags|=128,null):(S&p.child.childLanes)!==0?kc(d,p,S):(Wn(In,In.current&1),d=Wa(d,p,S),d!==null?d.sibling:null);Wn(In,In.current&1);break;case 19:if(N=(S&p.childLanes)!==0,(d.flags&128)!==0){if(N)return D_(d,p,S);p.flags|=128}if(F=p.memoizedState,F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Wn(In,In.current),N)break;return null;case 22:case 23:return p.lanes=0,Rp(d,p,S)}return Wa(d,p,S)}var zp,pf,Bp,ds;zp=function(d,p){for(var S=p.child;S!==null;){if(S.tag===5||S.tag===6)d.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===p)break;for(;S.sibling===null;){if(S.return===null||S.return===p)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},pf=function(){},Bp=function(d,p,S,N){var F=d.memoizedProps;if(F!==N){d=p.stateNode,rr(Gn.current);var W=null;switch(S){case"input":F=Xn(d,F),N=Xn(d,N),W=[];break;case"select":F=We({},F,{value:void 0}),N=We({},N,{value:void 0}),W=[];break;case"textarea":F=is(d,F),N=is(d,N),W=[];break;default:typeof F.onClick!="function"&&typeof N.onClick=="function"&&(d.onclick=mc)}ni(S,N);var se;S=null;for(at in F)if(!N.hasOwnProperty(at)&&F.hasOwnProperty(at)&&F[at]!=null)if(at==="style"){var Ae=F[at];for(se in Ae)Ae.hasOwnProperty(se)&&(S||(S={}),S[se]="")}else at!=="dangerouslySetInnerHTML"&&at!=="children"&&at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&at!=="autoFocus"&&(u.hasOwnProperty(at)?W||(W=[]):(W=W||[]).push(at,null));for(at in N){var Ve=N[at];if(Ae=F?.[at],N.hasOwnProperty(at)&&Ve!==Ae&&(Ve!=null||Ae!=null))if(at==="style")if(Ae){for(se in Ae)!Ae.hasOwnProperty(se)||Ve&&Ve.hasOwnProperty(se)||(S||(S={}),S[se]="");for(se in Ve)Ve.hasOwnProperty(se)&&Ae[se]!==Ve[se]&&(S||(S={}),S[se]=Ve[se])}else S||(W||(W=[]),W.push(at,S)),S=Ve;else at==="dangerouslySetInnerHTML"?(Ve=Ve?Ve.__html:void 0,Ae=Ae?Ae.__html:void 0,Ve!=null&&Ae!==Ve&&(W=W||[]).push(at,Ve)):at==="children"?typeof Ve!="string"&&typeof Ve!="number"||(W=W||[]).push(at,""+Ve):at!=="suppressContentEditableWarning"&&at!=="suppressHydrationWarning"&&(u.hasOwnProperty(at)?(Ve!=null&&at==="onScroll"&&gr("scroll",d),W||Ae===Ve||(W=[])):(W=W||[]).push(at,Ve))}S&&(W=W||[]).push("style",S);var at=W;(p.updateQueue=at)&&(p.flags|=4)}},ds=function(d,p,S,N){S!==N&&(p.flags|=4)};function Iu(d,p){if(!x)switch(d.tailMode){case"hidden":p=d.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?d.tail=null:S.sibling=null;break;case"collapsed":S=d.tail;for(var N=null;S!==null;)S.alternate!==null&&(N=S),S=S.sibling;N===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:N.sibling=null}}function hs(d){var p=d.alternate!==null&&d.alternate.child===d.child,S=0,N=0;if(p)for(var F=d.child;F!==null;)S|=F.lanes|F.childLanes,N|=F.subtreeFlags&14680064,N|=F.flags&14680064,F.return=d,F=F.sibling;else for(F=d.child;F!==null;)S|=F.lanes|F.childLanes,N|=F.subtreeFlags,N|=F.flags,F.return=d,F=F.sibling;return d.subtreeFlags|=N,d.childLanes=S,p}function qa(d,p,S){var N=p.pendingProps;switch(g(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return hs(p),null;case 1:return ls(p.type)&&Td(),hs(p),null;case 3:return N=p.stateNode,$r(),Rr(ks),Rr($i),Gr(),N.pendingContext&&(N.context=N.pendingContext,N.pendingContext=null),(d===null||d.child===null)&&($(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,T!==null&&(Pl(T),T=null))),pf(d,p),hs(p),null;case 5:co(p);var F=rr(lr.current);if(S=p.type,d!==null&&p.stateNode!=null)Bp(d,p,S,N,F),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!N){if(p.stateNode===null)throw Error(r(166));return hs(p),null}if(d=rr(Gn.current),$(p)){N=p.stateNode,S=p.type;var W=p.memoizedProps;switch(N[Es]=p,N[ha]=W,d=(p.mode&1)!==0,S){case"dialog":gr("cancel",N),gr("close",N);break;case"iframe":case"object":case"embed":gr("load",N);break;case"video":case"audio":for(F=0;F<Fs.length;F++)gr(Fs[F],N);break;case"source":gr("error",N);break;case"img":case"image":case"link":gr("error",N),gr("load",N);break;case"details":gr("toggle",N);break;case"input":_i(N,W),gr("invalid",N);break;case"select":N._wrapperState={wasMultiple:!!W.multiple},gr("invalid",N);break;case"textarea":qi(N,W),gr("invalid",N)}ni(S,W),F=null;for(var se in W)if(W.hasOwnProperty(se)){var Ae=W[se];se==="children"?typeof Ae=="string"?N.textContent!==Ae&&(W.suppressHydrationWarning!==!0&&vl(N.textContent,Ae,d),F=["children",Ae]):typeof Ae=="number"&&N.textContent!==""+Ae&&(W.suppressHydrationWarning!==!0&&vl(N.textContent,Ae,d),F=["children",""+Ae]):u.hasOwnProperty(se)&&Ae!=null&&se==="onScroll"&&gr("scroll",N)}switch(S){case"input":Sn(N),Ks(N,W,!0);break;case"textarea":Sn(N),xs(N);break;case"select":case"option":break;default:typeof W.onClick=="function"&&(N.onclick=mc)}N=F,p.updateQueue=N,N!==null&&(p.flags|=4)}else{se=F.nodeType===9?F:F.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Vr(S)),d==="http://www.w3.org/1999/xhtml"?S==="script"?(d=se.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof N.is=="string"?d=se.createElement(S,{is:N.is}):(d=se.createElement(S),S==="select"&&(se=d,N.multiple?se.multiple=!0:N.size&&(se.size=N.size))):d=se.createElementNS(d,S),d[Es]=p,d[ha]=N,zp(d,p,!1,!1),p.stateNode=d;e:{switch(se=Ds(S,N),S){case"dialog":gr("cancel",d),gr("close",d),F=N;break;case"iframe":case"object":case"embed":gr("load",d),F=N;break;case"video":case"audio":for(F=0;F<Fs.length;F++)gr(Fs[F],d);F=N;break;case"source":gr("error",d),F=N;break;case"img":case"image":case"link":gr("error",d),gr("load",d),F=N;break;case"details":gr("toggle",d),F=N;break;case"input":_i(d,N),F=Xn(d,N),gr("invalid",d);break;case"option":F=N;break;case"select":d._wrapperState={wasMultiple:!!N.multiple},F=We({},N,{value:void 0}),gr("invalid",d);break;case"textarea":qi(d,N),F=is(d,N),gr("invalid",d);break;default:F=N}ni(S,F),Ae=F;for(W in Ae)if(Ae.hasOwnProperty(W)){var Ve=Ae[W];W==="style"?Mi(d,Ve):W==="dangerouslySetInnerHTML"?(Ve=Ve?Ve.__html:void 0,Ve!=null&&Rs(d,Ve)):W==="children"?typeof Ve=="string"?(S!=="textarea"||Ve!=="")&&Zi(d,Ve):typeof Ve=="number"&&Zi(d,""+Ve):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(u.hasOwnProperty(W)?Ve!=null&&W==="onScroll"&&gr("scroll",d):Ve!=null&&ie(d,W,Ve,se))}switch(S){case"input":Sn(d),Ks(d,N,!1);break;case"textarea":Sn(d),xs(d);break;case"option":N.value!=null&&d.setAttribute("value",""+Zt(N.value));break;case"select":d.multiple=!!N.multiple,W=N.value,W!=null?ti(d,!!N.multiple,W,!1):N.defaultValue!=null&&ti(d,!!N.multiple,N.defaultValue,!0);break;default:typeof F.onClick=="function"&&(d.onclick=mc)}switch(S){case"button":case"input":case"select":case"textarea":N=!!N.autoFocus;break e;case"img":N=!0;break e;default:N=!1}}N&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return hs(p),null;case 6:if(d&&p.stateNode!=null)ds(d,p,d.memoizedProps,N);else{if(typeof N!="string"&&p.stateNode===null)throw Error(r(166));if(S=rr(lr.current),rr(Gn.current),$(p)){if(N=p.stateNode,S=p.memoizedProps,N[Es]=p,(W=N.nodeValue!==S)&&(d=o,d!==null))switch(d.tag){case 3:vl(N.nodeValue,S,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&vl(N.nodeValue,S,(d.mode&1)!==0)}W&&(p.flags|=4)}else N=(S.nodeType===9?S:S.ownerDocument).createTextNode(N),N[Es]=p,p.stateNode=N}return hs(p),null;case 13:if(Rr(In),N=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(x&&h!==null&&(p.mode&1)!==0&&(p.flags&128)===0)J(),oe(),p.flags|=98560,W=!1;else if(W=$(p),N!==null&&N.dehydrated!==null){if(d===null){if(!W)throw Error(r(318));if(W=p.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(r(317));W[Es]=p}else oe(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;hs(p),W=!1}else T!==null&&(Pl(T),T=null),W=!0;if(!W)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=S,p):(N=N!==null,N!==(d!==null&&d.memoizedState!==null)&&N&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(In.current&1)!==0?cr===0&&(cr=3):kg())),p.updateQueue!==null&&(p.flags|=4),hs(p),null);case 4:return $r(),pf(d,p),d===null&&ua(p.stateNode.containerInfo),hs(p),null;case 10:return Ye(p.type._context),hs(p),null;case 17:return ls(p.type)&&Td(),hs(p),null;case 19:if(Rr(In),W=p.memoizedState,W===null)return hs(p),null;if(N=(p.flags&128)!==0,se=W.rendering,se===null)if(N)Iu(W,!1);else{if(cr!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(se=pr(d),se!==null){for(p.flags|=128,Iu(W,!1),N=se.updateQueue,N!==null&&(p.updateQueue=N,p.flags|=4),p.subtreeFlags=0,N=S,S=p.child;S!==null;)W=S,d=N,W.flags&=14680066,se=W.alternate,se===null?(W.childLanes=0,W.lanes=d,W.child=null,W.subtreeFlags=0,W.memoizedProps=null,W.memoizedState=null,W.updateQueue=null,W.dependencies=null,W.stateNode=null):(W.childLanes=se.childLanes,W.lanes=se.lanes,W.child=se.child,W.subtreeFlags=0,W.deletions=null,W.memoizedProps=se.memoizedProps,W.memoizedState=se.memoizedState,W.updateQueue=se.updateQueue,W.type=se.type,d=se.dependencies,W.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),S=S.sibling;return Wn(In,In.current&1|2),p.child}d=d.sibling}W.tail!==null&&Ur()>Ld&&(p.flags|=128,N=!0,Iu(W,!1),p.lanes=4194304)}else{if(!N)if(d=pr(se),d!==null){if(p.flags|=128,N=!0,S=d.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),Iu(W,!0),W.tail===null&&W.tailMode==="hidden"&&!se.alternate&&!x)return hs(p),null}else 2*Ur()-W.renderingStartTime>Ld&&S!==1073741824&&(p.flags|=128,N=!0,Iu(W,!1),p.lanes=4194304);W.isBackwards?(se.sibling=p.child,p.child=se):(S=W.last,S!==null?S.sibling=se:p.child=se,W.last=se)}return W.tail!==null?(p=W.tail,W.rendering=p,W.tail=p.sibling,W.renderingStartTime=Ur(),p.sibling=null,S=In.current,Wn(In,N?S&1|2:S&1),p):(hs(p),null);case 22:case 23:return Wp(),N=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==N&&(p.flags|=8192),N&&(p.mode&1)!==0?(oi&1073741824)!==0&&(hs(p),p.subtreeFlags&6&&(p.flags|=8192)):hs(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function b0(d,p){switch(g(p),p.tag){case 1:return ls(p.type)&&Td(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return $r(),Rr(ks),Rr($i),Gr(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return co(p),null;case 13:if(Rr(In),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(r(340));oe()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return Rr(In),null;case 4:return $r(),null;case 10:return Ye(p.type._context),null;case 22:case 23:return Wp(),null;case 24:return null;default:return null}}var Za=!1,Oi=!1,Yo=typeof WeakSet=="function"?WeakSet:Set,Jt=null;function Md(d,p){var S=d.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(N){mi(d,p,N)}else S.current=null}function Pd(d,p,S){try{S()}catch(N){mi(d,p,N)}}var _g=!1;function T0(d,p){if(gc=Ql,d=wp(),Qh(d)){if("selectionStart"in d)var S={start:d.selectionStart,end:d.selectionEnd};else e:{S=(S=d.ownerDocument)&&S.defaultView||window;var N=S.getSelection&&S.getSelection();if(N&&N.rangeCount!==0){S=N.anchorNode;var F=N.anchorOffset,W=N.focusNode;N=N.focusOffset;try{S.nodeType,W.nodeType}catch{S=null;break e}var se=0,Ae=-1,Ve=-1,at=0,Lt=0,jt=d,Pt=null;t:for(;;){for(var rn;jt!==S||F!==0&&jt.nodeType!==3||(Ae=se+F),jt!==W||N!==0&&jt.nodeType!==3||(Ve=se+N),jt.nodeType===3&&(se+=jt.nodeValue.length),(rn=jt.firstChild)!==null;)Pt=jt,jt=rn;for(;;){if(jt===d)break t;if(Pt===S&&++at===F&&(Ae=se),Pt===W&&++Lt===N&&(Ve=se),(rn=jt.nextSibling)!==null)break;jt=Pt,Pt=jt.parentNode}jt=rn}S=Ae===-1||Ve===-1?null:{start:Ae,end:Ve}}else S=null}S=S||{start:0,end:0}}else S=null;for(_d={focusedElem:d,selectionRange:S},Ql=!1,Jt=p;Jt!==null;)if(p=Jt,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,Jt=d;else for(;Jt!==null;){p=Jt;try{var fn=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(fn!==null){var mn=fn.memoizedProps,gi=fn.memoizedState,tt=p.stateNode,He=tt.getSnapshotBeforeUpdate(p.elementType===p.type?mn:Io(p.type,mn),gi);tt.__reactInternalSnapshotBeforeUpdate=He}break;case 3:var it=p.stateNode.containerInfo;it.nodeType===1?it.textContent="":it.nodeType===9&&it.documentElement&&it.removeChild(it.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Vt){mi(p,p.return,Vt)}if(d=p.sibling,d!==null){d.return=p.return,Jt=d;break}Jt=p.return}return fn=_g,_g=!1,fn}function Mu(d,p,S){var N=p.updateQueue;if(N=N!==null?N.lastEffect:null,N!==null){var F=N=N.next;do{if((F.tag&d)===d){var W=F.destroy;F.destroy=void 0,W!==void 0&&Pd(p,S,W)}F=F.next}while(F!==N)}}function No(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var S=p=p.next;do{if((S.tag&d)===d){var N=S.create;S.destroy=N()}S=S.next}while(S!==p)}}function Ml(d){var p=d.ref;if(p!==null){var S=d.stateNode;d.tag,d=S,typeof p=="function"?p(d):p.current=d}}function xg(d){var p=d.alternate;p!==null&&(d.alternate=null,xg(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Es],delete p[ha],delete p[vd],delete p[nf],delete p[Cp])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function vg(d){return d.tag===5||d.tag===3||d.tag===4}function L_(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||vg(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function Nd(d,p,S){var N=d.tag;if(N===5||N===6)d=d.stateNode,p?S.nodeType===8?S.parentNode.insertBefore(d,p):S.insertBefore(d,p):(S.nodeType===8?(p=S.parentNode,p.insertBefore(d,S)):(p=S,p.appendChild(d)),S=S._reactRootContainer,S!=null||p.onclick!==null||(p.onclick=mc));else if(N!==4&&(d=d.child,d!==null))for(Nd(d,p,S),d=d.sibling;d!==null;)Nd(d,p,S),d=d.sibling}function mf(d,p,S){var N=d.tag;if(N===5||N===6)d=d.stateNode,p?S.insertBefore(d,p):S.appendChild(d);else if(N!==4&&(d=d.child,d!==null))for(mf(d,p,S),d=d.sibling;d!==null;)mf(d,p,S),d=d.sibling}var pi=null,As=!1;function Jo(d,p,S){for(S=S.child;S!==null;)gf(d,p,S),S=S.sibling}function gf(d,p,S){if(vs&&typeof vs.onCommitFiberUnmount=="function")try{vs.onCommitFiberUnmount(eo,S)}catch{}switch(S.tag){case 5:Oi||Md(S,p);case 6:var N=pi,F=As;pi=null,Jo(d,p,S),pi=N,As=F,pi!==null&&(As?(d=pi,S=S.stateNode,d.nodeType===8?d.parentNode.removeChild(S):d.removeChild(S)):pi.removeChild(S.stateNode));break;case 18:pi!==null&&(As?(d=pi,S=S.stateNode,d.nodeType===8?wu(d.parentNode,S):d.nodeType===1&&wu(d,S),To(d)):wu(pi,S.stateNode));break;case 4:N=pi,F=As,pi=S.stateNode.containerInfo,As=!0,Jo(d,p,S),pi=N,As=F;break;case 0:case 11:case 14:case 15:if(!Oi&&(N=S.updateQueue,N!==null&&(N=N.lastEffect,N!==null))){F=N=N.next;do{var W=F,se=W.destroy;W=W.tag,se!==void 0&&((W&2)!==0||(W&4)!==0)&&Pd(S,p,se),F=F.next}while(F!==N)}Jo(d,p,S);break;case 1:if(!Oi&&(Md(S,p),N=S.stateNode,typeof N.componentWillUnmount=="function"))try{N.props=S.memoizedProps,N.state=S.memoizedState,N.componentWillUnmount()}catch(Ae){mi(S,p,Ae)}Jo(d,p,S);break;case 21:Jo(d,p,S);break;case 22:S.mode&1?(Oi=(N=Oi)||S.memoizedState!==null,Jo(d,p,S),Oi=N):Jo(d,p,S);break;default:Jo(d,p,S)}}function wg(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var S=d.stateNode;S===null&&(S=d.stateNode=new Yo),p.forEach(function(N){var F=A0.bind(null,d,N);S.has(N)||(S.add(N),N.then(F,F))})}}function Gs(d,p){var S=p.deletions;if(S!==null)for(var N=0;N<S.length;N++){var F=S[N];try{var W=d,se=p,Ae=se;e:for(;Ae!==null;){switch(Ae.tag){case 5:pi=Ae.stateNode,As=!1;break e;case 3:pi=Ae.stateNode.containerInfo,As=!0;break e;case 4:pi=Ae.stateNode.containerInfo,As=!0;break e}Ae=Ae.return}if(pi===null)throw Error(r(160));gf(W,se,F),pi=null,As=!1;var Ve=F.alternate;Ve!==null&&(Ve.return=null),F.return=null}catch(at){mi(F,p,at)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)Fp(p,d),p=p.sibling}function Fp(d,p){var S=d.alternate,N=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Gs(p,d),_a(d),N&4){try{Mu(3,d,d.return),No(3,d)}catch(mn){mi(d,d.return,mn)}try{Mu(5,d,d.return)}catch(mn){mi(d,d.return,mn)}}break;case 1:Gs(p,d),_a(d),N&512&&S!==null&&Md(S,S.return);break;case 5:if(Gs(p,d),_a(d),N&512&&S!==null&&Md(S,S.return),d.flags&32){var F=d.stateNode;try{Zi(F,"")}catch(mn){mi(d,d.return,mn)}}if(N&4&&(F=d.stateNode,F!=null)){var W=d.memoizedProps,se=S!==null?S.memoizedProps:W,Ae=d.type,Ve=d.updateQueue;if(d.updateQueue=null,Ve!==null)try{Ae==="input"&&W.type==="radio"&&W.name!=null&&Kn(F,W),Ds(Ae,se);var at=Ds(Ae,W);for(se=0;se<Ve.length;se+=2){var Lt=Ve[se],jt=Ve[se+1];Lt==="style"?Mi(F,jt):Lt==="dangerouslySetInnerHTML"?Rs(F,jt):Lt==="children"?Zi(F,jt):ie(F,Lt,jt,at)}switch(Ae){case"input":Er(F,W);break;case"textarea":Ns(F,W);break;case"select":var Pt=F._wrapperState.wasMultiple;F._wrapperState.wasMultiple=!!W.multiple;var rn=W.value;rn!=null?ti(F,!!W.multiple,rn,!1):Pt!==!!W.multiple&&(W.defaultValue!=null?ti(F,!!W.multiple,W.defaultValue,!0):ti(F,!!W.multiple,W.multiple?[]:"",!1))}F[ha]=W}catch(mn){mi(d,d.return,mn)}}break;case 6:if(Gs(p,d),_a(d),N&4){if(d.stateNode===null)throw Error(r(162));F=d.stateNode,W=d.memoizedProps;try{F.nodeValue=W}catch(mn){mi(d,d.return,mn)}}break;case 3:if(Gs(p,d),_a(d),N&4&&S!==null&&S.memoizedState.isDehydrated)try{To(p.containerInfo)}catch(mn){mi(d,d.return,mn)}break;case 4:Gs(p,d),_a(d);break;case 13:Gs(p,d),_a(d),F=d.child,F.flags&8192&&(W=F.memoizedState!==null,F.stateNode.isHidden=W,!W||F.alternate!==null&&F.alternate.memoizedState!==null||(_f=Ur())),N&4&&wg(d);break;case 22:if(Lt=S!==null&&S.memoizedState!==null,d.mode&1?(Oi=(at=Oi)||Lt,Gs(p,d),Oi=at):Gs(p,d),_a(d),N&8192){if(at=d.memoizedState!==null,(d.stateNode.isHidden=at)&&!Lt&&(d.mode&1)!==0)for(Jt=d,Lt=d.child;Lt!==null;){for(jt=Jt=Lt;Jt!==null;){switch(Pt=Jt,rn=Pt.child,Pt.tag){case 0:case 11:case 14:case 15:Mu(4,Pt,Pt.return);break;case 1:Md(Pt,Pt.return);var fn=Pt.stateNode;if(typeof fn.componentWillUnmount=="function"){N=Pt,S=Pt.return;try{p=N,fn.props=p.memoizedProps,fn.state=p.memoizedState,fn.componentWillUnmount()}catch(mn){mi(N,S,mn)}}break;case 5:Md(Pt,Pt.return);break;case 22:if(Pt.memoizedState!==null){Tg(jt);continue}}rn!==null?(rn.return=Pt,Jt=rn):Tg(jt)}Lt=Lt.sibling}e:for(Lt=null,jt=d;;){if(jt.tag===5){if(Lt===null){Lt=jt;try{F=jt.stateNode,at?(W=F.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none"):(Ae=jt.stateNode,Ve=jt.memoizedProps.style,se=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null,Ae.style.display=Ys("display",se))}catch(mn){mi(d,d.return,mn)}}}else if(jt.tag===6){if(Lt===null)try{jt.stateNode.nodeValue=at?"":jt.memoizedProps}catch(mn){mi(d,d.return,mn)}}else if((jt.tag!==22&&jt.tag!==23||jt.memoizedState===null||jt===d)&&jt.child!==null){jt.child.return=jt,jt=jt.child;continue}if(jt===d)break e;for(;jt.sibling===null;){if(jt.return===null||jt.return===d)break e;Lt===jt&&(Lt=null),jt=jt.return}Lt===jt&&(Lt=null),jt.sibling.return=jt.return,jt=jt.sibling}}break;case 19:Gs(p,d),_a(d),N&4&&wg(d);break;case 21:break;default:Gs(p,d),_a(d)}}function _a(d){var p=d.flags;if(p&2){try{e:{for(var S=d.return;S!==null;){if(vg(S)){var N=S;break e}S=S.return}throw Error(r(160))}switch(N.tag){case 5:var F=N.stateNode;N.flags&32&&(Zi(F,""),N.flags&=-33);var W=L_(d);mf(d,W,F);break;case 3:case 4:var se=N.stateNode.containerInfo,Ae=L_(d);Nd(d,Ae,se);break;default:throw Error(r(161))}}catch(Ve){mi(d,d.return,Ve)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function Rd(d,p,S){Jt=d,bg(d)}function bg(d,p,S){for(var N=(d.mode&1)!==0;Jt!==null;){var F=Jt,W=F.child;if(F.tag===22&&N){var se=F.memoizedState!==null||Za;if(!se){var Ae=F.alternate,Ve=Ae!==null&&Ae.memoizedState!==null||Oi;Ae=Za;var at=Oi;if(Za=se,(Oi=Ve)&&!at)for(Jt=F;Jt!==null;)se=Jt,Ve=se.child,se.tag===22&&se.memoizedState!==null?j_(F):Ve!==null?(Ve.return=se,Jt=Ve):j_(F);for(;W!==null;)Jt=W,bg(W),W=W.sibling;Jt=F,Za=Ae,Oi=at}Vp(d)}else(F.subtreeFlags&8772)!==0&&W!==null?(W.return=F,Jt=W):Vp(d)}}function Vp(d){for(;Jt!==null;){var p=Jt;if((p.flags&8772)!==0){var S=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Oi||No(5,p);break;case 1:var N=p.stateNode;if(p.flags&4&&!Oi)if(S===null)N.componentDidMount();else{var F=p.elementType===p.type?S.memoizedProps:Io(p.type,S.memoizedProps);N.componentDidUpdate(F,S.memoizedState,N.__reactInternalSnapshotBeforeUpdate)}var W=p.updateQueue;W!==null&&Fn(p,W,N);break;case 3:var se=p.updateQueue;if(se!==null){if(S=null,p.child!==null)switch(p.child.tag){case 5:S=p.child.stateNode;break;case 1:S=p.child.stateNode}Fn(p,se,S)}break;case 5:var Ae=p.stateNode;if(S===null&&p.flags&4){S=Ae;var Ve=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Ve.autoFocus&&S.focus();break;case"img":Ve.src&&(S.src=Ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var at=p.alternate;if(at!==null){var Lt=at.memoizedState;if(Lt!==null){var jt=Lt.dehydrated;jt!==null&&To(jt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Oi||p.flags&512&&Ml(p)}catch(Pt){mi(p,p.return,Pt)}}if(p===d){Jt=null;break}if(S=p.sibling,S!==null){S.return=p.return,Jt=S;break}Jt=p.return}}function Tg(d){for(;Jt!==null;){var p=Jt;if(p===d){Jt=null;break}var S=p.sibling;if(S!==null){S.return=p.return,Jt=S;break}Jt=p.return}}function j_(d){for(;Jt!==null;){var p=Jt;try{switch(p.tag){case 0:case 11:case 15:var S=p.return;try{No(4,p)}catch(Ve){mi(p,S,Ve)}break;case 1:var N=p.stateNode;if(typeof N.componentDidMount=="function"){var F=p.return;try{N.componentDidMount()}catch(Ve){mi(p,F,Ve)}}var W=p.return;try{Ml(p)}catch(Ve){mi(p,W,Ve)}break;case 5:var se=p.return;try{Ml(p)}catch(Ve){mi(p,se,Ve)}}}catch(Ve){mi(p,p.return,Ve)}if(p===d){Jt=null;break}var Ae=p.sibling;if(Ae!==null){Ae.return=p.return,Jt=Ae;break}Jt=p.return}}var S0=Math.ceil,Ac=pe.ReactCurrentDispatcher,Up=pe.ReactCurrentOwner,Hi=pe.ReactCurrentBatchConfig,hn=0,zi=null,kr=null,Fr=0,oi=0,Ji=fa(0),cr=0,Dd=null,Yr=0,yf=0,Ic=0,Pu=null,Hs=null,_f=0,Ld=1/0,xa=null,xf=!1,Sg=null,Is=null,Xa=!1,va=null,Nu=0,Ru=0,$p=null,Gp=-1,vf=0;function Ws(){return(hn&6)!==0?Ur():Gp!==-1?Gp:Gp=Ur()}function Ka(d){return(d.mode&1)===0?1:(hn&2)!==0&&Fr!==0?Fr&-Fr:he.transition!==null?(vf===0&&(vf=ws()),vf):(d=sr,d!==0||(d=window.event,d=d===void 0?16:sd(d.type)),d)}function wa(d,p,S,N){if(50<Ru)throw Ru=0,$p=null,Error(r(185));Nn(d,S,N),((hn&2)===0||d!==zi)&&(d===zi&&((hn&2)===0&&(yf|=S),cr===4&&Mc(d,Fr)),Ms(d,N),S===1&&hn===0&&(p.mode&1)===0&&(Ld=Ur()+500,vc&&Ot()))}function Ms(d,p){var S=d.callbackNode;Hn(d,p);var N=sa(d,d===zi?Fr:0);if(N===0)S!==null&&ir(S),d.callbackNode=null,d.callbackPriority=0;else if(p=N&-N,d.callbackPriority!==p){if(S!=null&&ir(S),p===1)d.tag===0?Sl(Du.bind(null,d)):Tl(Du.bind(null,d)),Ep(function(){(hn&6)===0&&Ot()}),S=null;else{switch(zs(N)){case 1:S=Qs;break;case 4:S=Fo;break;case 16:S=Zl;break;case 536870912:S=ka;break;default:S=Zl}S=bf(S,Eg.bind(null,d))}d.callbackPriority=p,d.callbackNode=S}}function Eg(d,p){if(Gp=-1,vf=0,(hn&6)!==0)throw Error(r(327));var S=d.callbackNode;if(po()&&d.callbackNode!==S)return null;var N=sa(d,d===zi?Fr:0);if(N===0)return null;if((N&30)!==0||(N&d.expiredLanes)!==0||p)p=wf(d,N);else{p=N;var F=hn;hn|=2;var W=Cg();(zi!==d||Fr!==p)&&(xa=null,Ld=Ur()+500,Lu(d,p));do try{C0();break}catch(Ae){z_(d,Ae)}while(!0);$e(),Ac.current=W,hn=F,kr!==null?p=0:(zi=null,Fr=0,p=cr)}if(p!==0){if(p===2&&(F=Bn(d),F!==0&&(N=F,p=Hp(d,F))),p===1)throw S=Dd,Lu(d,0),Mc(d,N),Ms(d,Ur()),S;if(p===6)Mc(d,N);else{if(F=d.current.alternate,(N&30)===0&&!O_(F)&&(p=wf(d,N),p===2&&(W=Bn(d),W!==0&&(N=W,p=Hp(d,W))),p===1))throw S=Dd,Lu(d,0),Mc(d,N),Ms(d,Ur()),S;switch(d.finishedWork=F,d.finishedLanes=N,p){case 0:case 1:throw Error(r(345));case 2:Nc(d,Hs,xa);break;case 3:if(Mc(d,N),(N&130023424)===N&&(p=_f+500-Ur(),10<p)){if(sa(d,0)!==0)break;if(F=d.suspendedLanes,(F&N)!==N){Ws(),d.pingedLanes|=d.suspendedLanes&F;break}d.timeoutHandle=Oa(Nc.bind(null,d,Hs,xa),p);break}Nc(d,Hs,xa);break;case 4:if(Mc(d,N),(N&4194240)===N)break;for(p=d.eventTimes,F=-1;0<N;){var se=31-bi(N);W=1<<se,se=p[se],se>F&&(F=se),N&=~W}if(N=F,N=Ur()-N,N=(120>N?120:480>N?480:1080>N?1080:1920>N?1920:3e3>N?3e3:4320>N?4320:1960*S0(N/1960))-N,10<N){d.timeoutHandle=Oa(Nc.bind(null,d,Hs,xa),N);break}Nc(d,Hs,xa);break;case 5:Nc(d,Hs,xa);break;default:throw Error(r(329))}}}return Ms(d,Ur()),d.callbackNode===S?Eg.bind(null,d):null}function Hp(d,p){var S=Pu;return d.current.memoizedState.isDehydrated&&(Lu(d,p).flags|=256),d=wf(d,p),d!==2&&(p=Hs,Hs=S,p!==null&&Pl(p)),d}function Pl(d){Hs===null?Hs=d:Hs.push.apply(Hs,d)}function O_(d){for(var p=d;;){if(p.flags&16384){var S=p.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var N=0;N<S.length;N++){var F=S[N],W=F.getSnapshot;F=F.value;try{if(!oo(W(),F))return!1}catch{return!1}}}if(S=p.child,p.subtreeFlags&16384&&S!==null)S.return=p,p=S;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Mc(d,p){for(p&=~Ic,p&=~yf,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var S=31-bi(p),N=1<<S;d[S]=-1,p&=~N}}function Du(d){if((hn&6)!==0)throw Error(r(327));po();var p=sa(d,0);if((p&1)===0)return Ms(d,Ur()),null;var S=wf(d,p);if(d.tag!==0&&S===2){var N=Bn(d);N!==0&&(p=N,S=Hp(d,N))}if(S===1)throw S=Dd,Lu(d,0),Mc(d,p),Ms(d,Ur()),S;if(S===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,Nc(d,Hs,xa),Ms(d,Ur()),null}function jd(d,p){var S=hn;hn|=1;try{return d(p)}finally{hn=S,hn===0&&(Ld=Ur()+500,vc&&Ot())}}function Pc(d){va!==null&&va.tag===0&&(hn&6)===0&&po();var p=hn;hn|=1;var S=Hi.transition,N=sr;try{if(Hi.transition=null,sr=1,d)return d()}finally{sr=N,Hi.transition=S,hn=p,(hn&6)===0&&Ot()}}function Wp(){oi=Ji.current,Rr(Ji)}function Lu(d,p){d.finishedWork=null,d.finishedLanes=0;var S=d.timeoutHandle;if(S!==-1&&(d.timeoutHandle=-1,tf(S)),kr!==null)for(S=kr.return;S!==null;){var N=S;switch(g(N),N.tag){case 1:N=N.type.childContextTypes,N!=null&&Td();break;case 3:$r(),Rr(ks),Rr($i),Gr();break;case 5:co(N);break;case 4:$r();break;case 13:Rr(In);break;case 19:Rr(In);break;case 10:Ye(N.type._context);break;case 22:case 23:Wp()}S=S.return}if(zi=d,kr=d=Rc(d.current,null),Fr=oi=p,cr=0,Dd=null,Ic=yf=Yr=0,Hs=Pu=null,Je!==null){for(p=0;p<Je.length;p++)if(S=Je[p],N=S.interleaved,N!==null){S.interleaved=null;var F=N.next,W=S.pending;if(W!==null){var se=W.next;W.next=F,N.next=se}S.pending=N}Je=null}return d}function z_(d,p){do{var S=kr;try{if($e(),ji.current=cs,uo){for(var N=Dr.memoizedState;N!==null;){var F=N.queue;F!==null&&(F.pending=null),N=N.next}uo=!1}if(hi=0,Kr=Or=Dr=null,ho=!1,Ao=0,Up.current=null,S===null||S.return===null){cr=1,Dd=p,kr=null;break}e:{var W=d,se=S.return,Ae=S,Ve=p;if(p=Fr,Ae.flags|=32768,Ve!==null&&typeof Ve=="object"&&typeof Ve.then=="function"){var at=Ve,Lt=Ae,jt=Lt.tag;if((Lt.mode&1)===0&&(jt===0||jt===11||jt===15)){var Pt=Lt.alternate;Pt?(Lt.updateQueue=Pt.updateQueue,Lt.memoizedState=Pt.memoizedState,Lt.lanes=Pt.lanes):(Lt.updateQueue=null,Lt.memoizedState=null)}var rn=Np(se);if(rn!==null){rn.flags&=-257,mg(rn,se,Ae,W,p),rn.mode&1&&Ha(W,at,p),p=rn,Ve=at;var fn=p.updateQueue;if(fn===null){var mn=new Set;mn.add(Ve),p.updateQueue=mn}else fn.add(Ve);break e}else{if((p&1)===0){Ha(W,at,p),kg();break e}Ve=Error(r(426))}}else if(x&&Ae.mode&1){var gi=Np(se);if(gi!==null){(gi.flags&65536)===0&&(gi.flags|=256),mg(gi,se,Ae,W,p),ce(ku(Ve,Ae));break e}}W=Ve=ku(Ve,Ae),cr!==4&&(cr=2),Pu===null?Pu=[W]:Pu.push(W),W=se;do{switch(W.tag){case 3:W.flags|=65536,p&=-p,W.lanes|=p;var tt=kd(W,Ve,p);dn(W,tt);break e;case 1:Ae=Ve;var He=W.type,it=W.stateNode;if((W.flags&128)===0&&(typeof He.getDerivedStateFromError=="function"||it!==null&&typeof it.componentDidCatch=="function"&&(Is===null||!Is.has(it)))){W.flags|=65536,p&=-p,W.lanes|=p;var Vt=Au(W,Ae,p);dn(W,Vt);break e}}W=W.return}while(W!==null)}Ig(S)}catch(gn){p=gn,kr===S&&S!==null&&(kr=S=S.return);continue}break}while(!0)}function Cg(){var d=Ac.current;return Ac.current=cs,d===null?cs:d}function kg(){(cr===0||cr===3||cr===2)&&(cr=4),zi===null||(Yr&268435455)===0&&(yf&268435455)===0||Mc(zi,Fr)}function wf(d,p){var S=hn;hn|=2;var N=Cg();(zi!==d||Fr!==p)&&(xa=null,Lu(d,p));do try{E0();break}catch(F){z_(d,F)}while(!0);if($e(),hn=S,Ac.current=N,kr!==null)throw Error(r(261));return zi=null,Fr=0,cr}function E0(){for(;kr!==null;)Ag(kr)}function C0(){for(;kr!==null&&!Ih();)Ag(kr)}function Ag(d){var p=qp(d.alternate,d,oi);d.memoizedProps=d.pendingProps,p===null?Ig(d):kr=p,Up.current=null}function Ig(d){var p=d;do{var S=p.alternate;if(d=p.return,(p.flags&32768)===0){if(S=qa(S,p,oi),S!==null){kr=S;return}}else{if(S=b0(S,p),S!==null){S.flags&=32767,kr=S;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{cr=6,kr=null;return}}if(p=p.sibling,p!==null){kr=p;return}kr=p=d}while(p!==null);cr===0&&(cr=5)}function Nc(d,p,S){var N=sr,F=Hi.transition;try{Hi.transition=null,sr=1,Mg(d,p,S,N)}finally{Hi.transition=F,sr=N}return null}function Mg(d,p,S,N){do po();while(va!==null);if((hn&6)!==0)throw Error(r(327));S=d.finishedWork;var F=d.finishedLanes;if(S===null)return null;if(d.finishedWork=null,d.finishedLanes=0,S===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var W=S.lanes|S.childLanes;if(Os(d,W),d===zi&&(kr=zi=null,Fr=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Xa||(Xa=!0,bf(Zl,function(){return po(),null})),W=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||W){W=Hi.transition,Hi.transition=null;var se=sr;sr=1;var Ae=hn;hn|=4,Up.current=null,T0(d,S),Fp(S,d),ag(_d),Ql=!!gc,_d=gc=null,d.current=S,Rd(S),Qc(),hn=Ae,sr=se,Hi.transition=W}else d.current=S;if(Xa&&(Xa=!1,va=d,Nu=F),W=d.pendingLanes,W===0&&(Is=null),pt(S.stateNode),Ms(d,Ur()),p!==null)for(N=d.onRecoverableError,S=0;S<p.length;S++)F=p[S],N(F.value,{componentStack:F.stack,digest:F.digest});if(xf)throw xf=!1,d=Sg,Sg=null,d;return(Nu&1)!==0&&d.tag!==0&&po(),W=d.pendingLanes,(W&1)!==0?d===$p?Ru++:(Ru=0,$p=d):Ru=0,Ot(),null}function po(){if(va!==null){var d=zs(Nu),p=Hi.transition,S=sr;try{if(Hi.transition=null,sr=16>d?16:d,va===null)var N=!1;else{if(d=va,va=null,Nu=0,(hn&6)!==0)throw Error(r(331));var F=hn;for(hn|=4,Jt=d.current;Jt!==null;){var W=Jt,se=W.child;if((Jt.flags&16)!==0){var Ae=W.deletions;if(Ae!==null){for(var Ve=0;Ve<Ae.length;Ve++){var at=Ae[Ve];for(Jt=at;Jt!==null;){var Lt=Jt;switch(Lt.tag){case 0:case 11:case 15:Mu(8,Lt,W)}var jt=Lt.child;if(jt!==null)jt.return=Lt,Jt=jt;else for(;Jt!==null;){Lt=Jt;var Pt=Lt.sibling,rn=Lt.return;if(xg(Lt),Lt===at){Jt=null;break}if(Pt!==null){Pt.return=rn,Jt=Pt;break}Jt=rn}}}var fn=W.alternate;if(fn!==null){var mn=fn.child;if(mn!==null){fn.child=null;do{var gi=mn.sibling;mn.sibling=null,mn=gi}while(mn!==null)}}Jt=W}}if((W.subtreeFlags&2064)!==0&&se!==null)se.return=W,Jt=se;else e:for(;Jt!==null;){if(W=Jt,(W.flags&2048)!==0)switch(W.tag){case 0:case 11:case 15:Mu(9,W,W.return)}var tt=W.sibling;if(tt!==null){tt.return=W.return,Jt=tt;break e}Jt=W.return}}var He=d.current;for(Jt=He;Jt!==null;){se=Jt;var it=se.child;if((se.subtreeFlags&2064)!==0&&it!==null)it.return=se,Jt=it;else e:for(se=He;Jt!==null;){if(Ae=Jt,(Ae.flags&2048)!==0)try{switch(Ae.tag){case 0:case 11:case 15:No(9,Ae)}}catch(gn){mi(Ae,Ae.return,gn)}if(Ae===se){Jt=null;break e}var Vt=Ae.sibling;if(Vt!==null){Vt.return=Ae.return,Jt=Vt;break e}Jt=Ae.return}}if(hn=F,Ot(),vs&&typeof vs.onPostCommitFiberRoot=="function")try{vs.onPostCommitFiberRoot(eo,d)}catch{}N=!0}return N}finally{sr=S,Hi.transition=p}}return!1}function qs(d,p,S){p=ku(S,p),p=kd(d,p,1),d=_n(d,p,1),p=Ws(),d!==null&&(Nn(d,1,p),Ms(d,p))}function mi(d,p,S){if(d.tag===3)qs(d,d,S);else for(;p!==null;){if(p.tag===3){qs(p,d,S);break}else if(p.tag===1){var N=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof N.componentDidCatch=="function"&&(Is===null||!Is.has(N))){d=ku(S,d),d=Au(p,d,1),p=_n(p,d,1),d=Ws(),p!==null&&(Nn(p,1,d),Ms(p,d));break}}p=p.return}}function Pg(d,p,S){var N=d.pingCache;N!==null&&N.delete(p),p=Ws(),d.pingedLanes|=d.suspendedLanes&S,zi===d&&(Fr&S)===S&&(cr===4||cr===3&&(Fr&130023424)===Fr&&500>Ur()-_f?Lu(d,0):Ic|=S),Ms(d,p)}function B_(d,p){p===0&&((d.mode&1)===0?p=1:(p=Xl,Xl<<=1,(Xl&130023424)===0&&(Xl=4194304)));var S=Ws();d=dt(d,p),d!==null&&(Nn(d,p,S),Ms(d,S))}function k0(d){var p=d.memoizedState,S=0;p!==null&&(S=p.retryLane),B_(d,S)}function A0(d,p){var S=0;switch(d.tag){case 13:var N=d.stateNode,F=d.memoizedState;F!==null&&(S=F.retryLane);break;case 19:N=d.stateNode;break;default:throw Error(r(314))}N!==null&&N.delete(p),B_(d,S)}var qp;qp=function(d,p,S){if(d!==null)if(d.memoizedProps!==p.pendingProps||ks.current)Yi=!0;else{if((d.lanes&S)===0&&(p.flags&128)===0)return Yi=!1,ff(d,p,S);Yi=(d.flags&131072)!==0}else Yi=!1,x&&(p.flags&1048576)!==0&&Sd(p,bc,p.index);switch(p.lanes=0,p.tag){case 2:var N=p.type;hf(d,p),d=p.pendingProps;var F=Gi(p,$i.current);qe(p,S),F=kp(null,p,N,d,F,S);var W=Ap();return p.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,ls(N)?(W=!0,Zo(p)):W=!1,p.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,wt(p),F.updater=Ec,p.stateNode=F,F._reactInternals=p,Pp(p,N,d,S),p=Po(null,p,N,!0,W,S)):(p.tag=0,x&&W&&Va(p),zr(null,p,F,S),p=p.child),p;case 16:N=p.elementType;e:{switch(hf(d,p),d=p.pendingProps,F=N._init,N=F(N._payload),p.type=N,F=p.tag=I0(N),d=Io(N,d),F){case 0:p=Dp(null,p,N,d,S);break e;case 1:p=Id(null,p,N,d,S);break e;case 11:p=Ad(null,p,N,d,S);break e;case 14:p=us(null,p,N,Io(N.type,d),S);break e}throw Error(r(306,N,""))}return p;case 0:return N=p.type,F=p.pendingProps,F=p.elementType===N?F:Io(N,F),Dp(d,p,N,F,S);case 1:return N=p.type,F=p.pendingProps,F=p.elementType===N?F:Io(N,F),Id(d,p,N,F,S);case 3:e:{if(P_(p),d===null)throw Error(r(387));N=p.pendingProps,W=p.memoizedState,F=W.element,It(d,p),jn(p,N,null,S);var se=p.memoizedState;if(N=se.element,W.isDehydrated)if(W={element:N,isDehydrated:!1,cache:se.cache,pendingSuspenseBoundaries:se.pendingSuspenseBoundaries,transitions:se.transitions},p.updateQueue.baseState=W,p.memoizedState=W,p.flags&256){F=ku(Error(r(423)),p),p=N_(d,p,N,S,F);break e}else if(N!==F){F=ku(Error(r(424)),p),p=N_(d,p,N,S,F);break e}else for(h=qo(p.stateNode.containerInfo.firstChild),o=p,x=!0,T=null,S=ve(p,null,N,S),p.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(oe(),N===F){p=Wa(d,p,S);break e}zr(d,p,N,S)}p=p.child}return p;case 5:return $s(p),d===null&&B(p),N=p.type,F=p.pendingProps,W=d!==null?d.memoizedProps:null,se=F.children,yc(N,F)?se=null:W!==null&&yc(N,W)&&(p.flags|=32),Hr(d,p),zr(d,p,se,S),p.child;case 6:return d===null&&B(p),null;case 13:return kc(d,p,S);case 4:return Li(p,p.stateNode.containerInfo),N=p.pendingProps,d===null?p.child=_e(p,null,N,S):zr(d,p,N,S),p.child;case 11:return N=p.type,F=p.pendingProps,F=p.elementType===N?F:Io(N,F),Ad(d,p,N,F,S);case 7:return zr(d,p,p.pendingProps,S),p.child;case 8:return zr(d,p,p.pendingProps.children,S),p.child;case 12:return zr(d,p,p.pendingProps.children,S),p.child;case 10:e:{if(N=p.type._context,F=p.pendingProps,W=p.memoizedProps,se=F.value,Wn(Ne,N._currentValue),N._currentValue=se,W!==null)if(oo(W.value,se)){if(W.children===F.children&&!ks.current){p=Wa(d,p,S);break e}}else for(W=p.child,W!==null&&(W.return=p);W!==null;){var Ae=W.dependencies;if(Ae!==null){se=W.child;for(var Ve=Ae.firstContext;Ve!==null;){if(Ve.context===N){if(W.tag===1){Ve=en(-1,S&-S),Ve.tag=2;var at=W.updateQueue;if(at!==null){at=at.shared;var Lt=at.pending;Lt===null?Ve.next=Ve:(Ve.next=Lt.next,Lt.next=Ve),at.pending=Ve}}W.lanes|=S,Ve=W.alternate,Ve!==null&&(Ve.lanes|=S),At(W.return,S,p),Ae.lanes|=S;break}Ve=Ve.next}}else if(W.tag===10)se=W.type===p.type?null:W.child;else if(W.tag===18){if(se=W.return,se===null)throw Error(r(341));se.lanes|=S,Ae=se.alternate,Ae!==null&&(Ae.lanes|=S),At(se,S,p),se=W.sibling}else se=W.child;if(se!==null)se.return=W;else for(se=W;se!==null;){if(se===p){se=null;break}if(W=se.sibling,W!==null){W.return=se.return,se=W;break}se=se.return}W=se}zr(d,p,F.children,S),p=p.child}return p;case 9:return F=p.type,N=p.pendingProps.children,qe(p,S),F=ct(F),N=N(F),p.flags|=1,zr(d,p,N,S),p.child;case 14:return N=p.type,F=Io(N,p.pendingProps),F=Io(N.type,F),us(d,p,N,F,S);case 15:return Mo(d,p,p.type,p.pendingProps,S);case 17:return N=p.type,F=p.pendingProps,F=p.elementType===N?F:Io(N,F),hf(d,p),p.tag=1,ls(N)?(d=!0,Zo(p)):d=!1,qe(p,S),Mp(p,N,F),Pp(p,N,F,S),Po(null,p,N,!0,d,S);case 19:return D_(d,p,S);case 22:return Rp(d,p,S)}throw Error(r(156,p.tag))};function bf(d,p){return Ah(d,p)}function F_(d,p,S,N){this.tag=d,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=N,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Qi(d,p,S,N){return new F_(d,p,S,N)}function ju(d){return d=d.prototype,!(!d||!d.isReactComponent)}function I0(d){if(typeof d=="function")return ju(d)?1:0;if(d!=null){if(d=d.$$typeof,d===ut)return 11;if(d===vt)return 14}return 2}function Rc(d,p){var S=d.alternate;return S===null?(S=Qi(d.tag,p,d.key,d.mode),S.elementType=d.elementType,S.type=d.type,S.stateNode=d.stateNode,S.alternate=d,d.alternate=S):(S.pendingProps=p,S.type=d.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=d.flags&14680064,S.childLanes=d.childLanes,S.lanes=d.lanes,S.child=d.child,S.memoizedProps=d.memoizedProps,S.memoizedState=d.memoizedState,S.updateQueue=d.updateQueue,p=d.dependencies,S.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},S.sibling=d.sibling,S.index=d.index,S.ref=d.ref,S}function Zp(d,p,S,N,F,W){var se=2;if(N=d,typeof d=="function")ju(d)&&(se=1);else if(typeof d=="string")se=5;else e:switch(d){case je:return Ou(S.children,F,W,p);case Ue:se=8,F|=8;break;case et:return d=Qi(12,S,p,F|2),d.elementType=et,d.lanes=W,d;case gt:return d=Qi(13,S,p,F),d.elementType=gt,d.lanes=W,d;case ft:return d=Qi(19,S,p,F),d.elementType=ft,d.lanes=W,d;case nt:return Xp(S,F,W,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case Ie:se=10;break e;case ot:se=9;break e;case ut:se=11;break e;case vt:se=14;break e;case st:se=16,N=null;break e}throw Error(r(130,d==null?d:typeof d,""))}return p=Qi(se,S,p,F),p.elementType=d,p.type=N,p.lanes=W,p}function Ou(d,p,S,N){return d=Qi(7,d,N,p),d.lanes=S,d}function Xp(d,p,S,N){return d=Qi(22,d,N,p),d.elementType=nt,d.lanes=S,d.stateNode={isHidden:!1},d}function Ng(d,p,S){return d=Qi(6,d,null,p),d.lanes=S,d}function Rg(d,p,S){return p=Qi(4,d.children!==null?d.children:[],d.key,p),p.lanes=S,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function Dg(d,p,S,N,F){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=js(0),this.expirationTimes=js(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=js(0),this.identifierPrefix=N,this.onRecoverableError=F,this.mutableSourceEagerHydrationData=null}function Lg(d,p,S,N,F,W,se,Ae,Ve){return d=new Dg(d,p,S,Ae,Ve),p===1?(p=1,W===!0&&(p|=8)):p=0,W=Qi(3,null,null,p),d.current=W,W.stateNode=d,W.memoizedState={element:N,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},wt(W),d}function Od(d,p,S){var N=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Ce,key:N==null?null:""+N,children:d,containerInfo:p,implementation:S}}function V_(d){if(!d)return Ba;d=d._reactInternals;e:{if(Nr(d)!==d||d.tag!==1)throw Error(r(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(ls(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(d.tag===1){var S=d.type;if(ls(S))return Co(d,S,p)}return p}function Jr(d,p,S,N,F,W,se,Ae,Ve){return d=Lg(S,N,!0,d,F,W,se,Ae,Ve),d.context=V_(null),S=d.current,N=Ws(),F=Ka(S),W=en(N,F),W.callback=p??null,_n(S,W,F),d.current.lanes=F,Nn(d,F,N),Ms(d,N),d}function zu(d,p,S,N){var F=p.current,W=Ws(),se=Ka(F);return S=V_(S),p.context===null?p.context=S:p.pendingContext=S,p=en(W,se),p.payload={element:d},N=N===void 0?null:N,N!==null&&(p.callback=N),d=_n(F,p,se),d!==null&&(wa(d,F,se,W),Wt(d,F,se)),se}function Tf(d){return d=d.current,d.child?(d.child.tag===5,d.child.stateNode):null}function Sf(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var S=d.retryLane;d.retryLane=S!==0&&S<p?S:p}}function zd(d,p){Sf(d,p),(d=d.alternate)&&Sf(d,p)}function Ef(){return null}var jg=typeof reportError=="function"?reportError:function(d){console.error(d)};function Kp(d){this._internalRoot=d}Dc.prototype.render=Kp.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(r(409));zu(d,p,null,null)},Dc.prototype.unmount=Kp.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Pc(function(){zu(null,d,null,null)}),p[Eo]=null}};function Dc(d){this._internalRoot=d}Dc.prototype.unstable_scheduleHydration=function(d){if(d){var p=Yl();d={blockedOn:null,target:d,priority:p};for(var S=0;S<_r.length&&p!==0&&p<_r[S].priority;S++);_r.splice(S,0,d),S===0&&Nh(d)}};function Cf(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Bd(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Yp(){}function M0(d,p,S,N,F){if(F){if(typeof N=="function"){var W=N;N=function(){var at=Tf(se);W.call(at)}}var se=Jr(p,N,d,0,null,!1,!1,"",Yp);return d._reactRootContainer=se,d[Eo]=se.current,ua(d.nodeType===8?d.parentNode:d),Pc(),se}for(;F=d.lastChild;)d.removeChild(F);if(typeof N=="function"){var Ae=N;N=function(){var at=Tf(Ve);Ae.call(at)}}var Ve=Lg(d,0,!1,null,null,!1,!1,"",Yp);return d._reactRootContainer=Ve,d[Eo]=Ve.current,ua(d.nodeType===8?d.parentNode:d),Pc(function(){zu(p,Ve,S,N)}),Ve}function kf(d,p,S,N,F){var W=S._reactRootContainer;if(W){var se=W;if(typeof F=="function"){var Ae=F;F=function(){var Ve=Tf(se);Ae.call(Ve)}}zu(p,se,d,F)}else se=M0(S,p,d,F,N);return Tf(se)}Cr=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var S=Kl(p.pendingLanes);S!==0&&(cl(p,S|1),Ms(p,Ur()),(hn&6)===0&&(Ld=Ur()+500,Ot()))}break;case 13:Pc(function(){var N=dt(d,1);if(N!==null){var F=Ws();wa(N,d,1,F)}}),zd(d,1)}},rd=function(d){if(d.tag===13){var p=dt(d,134217728);if(p!==null){var S=Ws();wa(p,d,134217728,S)}zd(d,134217728)}},Vo=function(d){if(d.tag===13){var p=Ka(d),S=dt(d,p);if(S!==null){var N=Ws();wa(S,d,p,N)}zd(d,p)}},Yl=function(){return sr},Jl=function(d,p){var S=sr;try{return sr=d,p()}finally{sr=S}},be=function(d,p,S){switch(p){case"input":if(Er(d,S),p=S.name,S.type==="radio"&&p!=null){for(S=d;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<S.length;p++){var N=S[p];if(N!==d&&N.form===d.form){var F=wd(N);if(!F)throw Error(r(90));Yt(N),Er(N,F)}}}break;case"textarea":Ns(d,S);break;case"select":p=S.value,p!=null&&ti(d,!!S.multiple,p,!1)}},Oe=jd,Be=Pc;var Af={usingClientEntryPoint:!1,Events:[xc,wl,wd,Te,we,jd]},If={findFiberByHostInstance:Cs,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Og={bundleType:If.bundleType,version:If.version,rendererPackageName:If.rendererPackageName,rendererConfig:If.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pe.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=ll(d),d===null?null:d.stateNode},findFiberByHostInstance:If.findFiberByHostInstance||Ef,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Jp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Jp.isDisabled&&Jp.supportsFiber)try{eo=Jp.inject(Og),vs=Jp}catch{}}return na.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Af,na.createPortal=function(d,p){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Cf(p))throw Error(r(200));return Od(d,p,null,S)},na.createRoot=function(d,p){if(!Cf(d))throw Error(r(299));var S=!1,N="",F=jg;return p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(N=p.identifierPrefix),p.onRecoverableError!==void 0&&(F=p.onRecoverableError)),p=Lg(d,1,!1,null,null,S,!1,N,F),d[Eo]=p.current,ua(d.nodeType===8?d.parentNode:d),new Kp(p)},na.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=ll(p),d=d===null?null:d.stateNode,d},na.flushSync=function(d){return Pc(d)},na.hydrate=function(d,p,S){if(!Bd(p))throw Error(r(200));return kf(null,d,p,!0,S)},na.hydrateRoot=function(d,p,S){if(!Cf(d))throw Error(r(405));var N=S!=null&&S.hydratedSources||null,F=!1,W="",se=jg;if(S!=null&&(S.unstable_strictMode===!0&&(F=!0),S.identifierPrefix!==void 0&&(W=S.identifierPrefix),S.onRecoverableError!==void 0&&(se=S.onRecoverableError)),p=Jr(p,null,d,1,S??null,F,!1,W,se),d[Eo]=p.current,ua(d),N)for(d=0;d<N.length;d++)S=N[d],F=S._getVersion,F=F(S._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[S,F]:p.mutableSourceEagerHydrationData.push(S,F);return new Dc(p)},na.render=function(d,p,S){if(!Bd(p))throw Error(r(200));return kf(null,d,p,!1,S)},na.unmountComponentAtNode=function(d){if(!Bd(d))throw Error(r(40));return d._reactRootContainer?(Pc(function(){kf(null,null,d,!1,function(){d._reactRootContainer=null,d[Eo]=null})}),!0):!1},na.unstable_batchedUpdates=jd,na.unstable_renderSubtreeIntoContainer=function(d,p,S,N){if(!Bd(S))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return kf(d,p,S,!1,N)},na.version="18.3.1-next-f1338f8080-20240426",na}var tC;function WI(){if(tC)return c1.exports;tC=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),c1.exports=cj(),c1.exports}var nC;function uj(){if(nC)return lx;nC=1;var t=WI();return lx.createRoot=t.createRoot,lx.hydrateRoot=t.hydrateRoot,lx}var mm=uj(),P=Sv();const qt=wb(P),Ev=HI({__proto__:null,default:qt},[P]),dj=1,hj=1e6;let h1=0;function fj(){return h1=(h1+1)%Number.MAX_SAFE_INTEGER,h1.toString()}const f1=new Map,rC=t=>{if(f1.has(t))return;const e=setTimeout(()=>{f1.delete(t),_y({type:"REMOVE_TOAST",toastId:t})},hj);f1.set(t,e)},pj=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,dj)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?rC(r):t.toasts.forEach(l=>{rC(l.id)}),{...t,toasts:t.toasts.map(l=>l.id===r||r===void 0?{...l,open:!1}:l)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Ix=[];let Mx={toasts:[]};function _y(t){Mx=pj(Mx,t),Ix.forEach(e=>{e(Mx)})}function mj({...t}){const e=fj(),r=u=>_y({type:"UPDATE_TOAST",toast:{...u,id:e}}),l=()=>_y({type:"DISMISS_TOAST",toastId:e});return _y({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:u=>{u||l()}}}),{id:e,dismiss:l,update:r}}function gj(){const[t,e]=P.useState(Mx);return P.useEffect(()=>(Ix.push(e),()=>{const r=Ix.indexOf(e);r>-1&&Ix.splice(r,1)}),[t]),{...t,toast:mj,dismiss:r=>_y({type:"DISMISS_TOAST",toastId:r})}}var vh=WI();const qI=wb(vh);function Xt(t,e,{checkForDefaultPrevented:r=!0}={}){return function(u){if(t?.(u),r===!1||!u.defaultPrevented)return e?.(u)}}function iC(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ed(...t){return e=>{let r=!1;const l=t.map(u=>{const m=iC(u,e);return!r&&typeof m=="function"&&(r=!0),m});if(r)return()=>{for(let u=0;u<l.length;u++){const m=l[u];typeof m=="function"?m():iC(t[u],null)}}}}function or(...t){return P.useCallback(ed(...t),t)}function yj(t,e){const r=P.createContext(e),l=m=>{const{children:v,...b}=m,a=P.useMemo(()=>b,Object.values(b));return _.jsx(r.Provider,{value:a,children:v})};l.displayName=t+"Provider";function u(m){const v=P.useContext(r);if(v)return v;if(e!==void 0)return e;throw new Error(`\`${m}\` must be used within \`${t}\``)}return[l,u]}function sl(t,e=[]){let r=[];function l(m,v){const b=P.createContext(v),a=r.length;r=[...r,v];const k=L=>{const{scope:z,children:O,...K}=L,H=z?.[t]?.[a]||b,Z=P.useMemo(()=>K,Object.values(K));return _.jsx(H.Provider,{value:Z,children:O})};k.displayName=m+"Provider";function M(L,z){const O=z?.[t]?.[a]||b,K=P.useContext(O);if(K)return K;if(v!==void 0)return v;throw new Error(`\`${L}\` must be used within \`${m}\``)}return[k,M]}const u=()=>{const m=r.map(v=>P.createContext(v));return function(b){const a=b?.[t]||m;return P.useMemo(()=>({[`__scope${t}`]:{...b,[t]:a}}),[b,a])}};return u.scopeName=t,[l,_j(u,...e)]}function _j(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const l=t.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(m){const v=l.reduce((b,{useScope:a,scopeName:k})=>{const L=a(m)[`__scope${k}`];return{...b,...L}},{});return P.useMemo(()=>({[`__scope${e.scopeName}`]:v}),[v])}};return r.scopeName=e.scopeName,r}function sC(t){const e=xj(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(wj);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function xj(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=Tj(u),b=bj(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var vj=Symbol("radix.slottable");function wj(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===vj}function bj(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function Tj(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function Cv(t){const e=t+"CollectionProvider",[r,l]=sl(e),[u,m]=r(e,{collectionRef:{current:null},itemMap:new Map}),v=H=>{const{scope:Z,children:Y}=H,ee=qt.useRef(null),ie=qt.useRef(new Map).current;return _.jsx(u,{scope:Z,itemMap:ie,collectionRef:ee,children:Y})};v.displayName=e;const b=t+"CollectionSlot",a=sC(b),k=qt.forwardRef((H,Z)=>{const{scope:Y,children:ee}=H,ie=m(b,Y),pe=or(Z,ie.collectionRef);return _.jsx(a,{ref:pe,children:ee})});k.displayName=b;const M=t+"CollectionItemSlot",L="data-radix-collection-item",z=sC(M),O=qt.forwardRef((H,Z)=>{const{scope:Y,children:ee,...ie}=H,pe=qt.useRef(null),xe=or(Z,pe),Ce=m(M,Y);return qt.useEffect(()=>(Ce.itemMap.set(pe,{ref:pe,...ie}),()=>{Ce.itemMap.delete(pe)})),_.jsx(z,{[L]:"",ref:xe,children:ee})});O.displayName=M;function K(H){const Z=m(t+"CollectionConsumer",H);return qt.useCallback(()=>{const ee=Z.collectionRef.current;if(!ee)return[];const ie=Array.from(ee.querySelectorAll(`[${L}]`));return Array.from(Z.itemMap.values()).sort((Ce,je)=>ie.indexOf(Ce.ref.current)-ie.indexOf(je.ref.current))},[Z.collectionRef,Z.itemMap])}return[{Provider:v,Slot:k,ItemSlot:O},K,l]}function Sj(t){const e=Ej(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(kj);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function Ej(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=Ij(u),b=Aj(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Cj=Symbol("radix.slottable");function kj(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Cj}function Aj(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function Ij(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Mj=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Mn=Mj.reduce((t,e)=>{const r=Sj(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{});function bb(t,e){t&&vh.flushSync(()=>t.dispatchEvent(e))}function Ui(t){const e=P.useRef(t);return P.useEffect(()=>{e.current=t}),P.useMemo(()=>(...r)=>e.current?.(...r),[])}function Pj(t,e=globalThis?.document){const r=Ui(t);P.useEffect(()=>{const l=u=>{u.key==="Escape"&&r(u)};return e.addEventListener("keydown",l,{capture:!0}),()=>e.removeEventListener("keydown",l,{capture:!0})},[r,e])}var Nj="DismissableLayer",cw="dismissableLayer.update",Rj="dismissableLayer.pointerDownOutside",Dj="dismissableLayer.focusOutside",oC,ZI=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Wm=P.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:m,onInteractOutside:v,onDismiss:b,...a}=t,k=P.useContext(ZI),[M,L]=P.useState(null),z=M?.ownerDocument??globalThis?.document,[,O]=P.useState({}),K=or(e,je=>L(je)),H=Array.from(k.layers),[Z]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),Y=H.indexOf(Z),ee=M?H.indexOf(M):-1,ie=k.layersWithOutsidePointerEventsDisabled.size>0,pe=ee>=Y,xe=jj(je=>{const Ue=je.target,et=[...k.branches].some(Ie=>Ie.contains(Ue));!pe||et||(u?.(je),v?.(je),je.defaultPrevented||b?.())},z),Ce=Oj(je=>{const Ue=je.target;[...k.branches].some(Ie=>Ie.contains(Ue))||(m?.(je),v?.(je),je.defaultPrevented||b?.())},z);return Pj(je=>{ee===k.layers.size-1&&(l?.(je),!je.defaultPrevented&&b&&(je.preventDefault(),b()))},z),P.useEffect(()=>{if(M)return r&&(k.layersWithOutsidePointerEventsDisabled.size===0&&(oC=z.body.style.pointerEvents,z.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(M)),k.layers.add(M),aC(),()=>{r&&k.layersWithOutsidePointerEventsDisabled.size===1&&(z.body.style.pointerEvents=oC)}},[M,z,r,k]),P.useEffect(()=>()=>{M&&(k.layers.delete(M),k.layersWithOutsidePointerEventsDisabled.delete(M),aC())},[M,k]),P.useEffect(()=>{const je=()=>O({});return document.addEventListener(cw,je),()=>document.removeEventListener(cw,je)},[]),_.jsx(Mn.div,{...a,ref:K,style:{pointerEvents:ie?pe?"auto":"none":void 0,...t.style},onFocusCapture:Xt(t.onFocusCapture,Ce.onFocusCapture),onBlurCapture:Xt(t.onBlurCapture,Ce.onBlurCapture),onPointerDownCapture:Xt(t.onPointerDownCapture,xe.onPointerDownCapture)})});Wm.displayName=Nj;var Lj="DismissableLayerBranch",XI=P.forwardRef((t,e)=>{const r=P.useContext(ZI),l=P.useRef(null),u=or(e,l);return P.useEffect(()=>{const m=l.current;if(m)return r.branches.add(m),()=>{r.branches.delete(m)}},[r.branches]),_.jsx(Mn.div,{...t,ref:u})});XI.displayName=Lj;function jj(t,e=globalThis?.document){const r=Ui(t),l=P.useRef(!1),u=P.useRef(()=>{});return P.useEffect(()=>{const m=b=>{if(b.target&&!l.current){let a=function(){KI(Rj,r,k,{discrete:!0})};const k={originalEvent:b};b.pointerType==="touch"?(e.removeEventListener("click",u.current),u.current=a,e.addEventListener("click",u.current,{once:!0})):a()}else e.removeEventListener("click",u.current);l.current=!1},v=window.setTimeout(()=>{e.addEventListener("pointerdown",m)},0);return()=>{window.clearTimeout(v),e.removeEventListener("pointerdown",m),e.removeEventListener("click",u.current)}},[e,r]),{onPointerDownCapture:()=>l.current=!0}}function Oj(t,e=globalThis?.document){const r=Ui(t),l=P.useRef(!1);return P.useEffect(()=>{const u=m=>{m.target&&!l.current&&KI(Dj,r,{originalEvent:m},{discrete:!1})};return e.addEventListener("focusin",u),()=>e.removeEventListener("focusin",u)},[e,r]),{onFocusCapture:()=>l.current=!0,onBlurCapture:()=>l.current=!1}}function aC(){const t=new CustomEvent(cw);document.dispatchEvent(t)}function KI(t,e,r,{discrete:l}){const u=r.originalEvent.target,m=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&u.addEventListener(t,e,{once:!0}),l?bb(u,m):u.dispatchEvent(m)}var zj=Wm,Bj=XI,Wi=globalThis?.document?P.useLayoutEffect:()=>{},Fj="Portal",Yy=P.forwardRef((t,e)=>{const{container:r,...l}=t,[u,m]=P.useState(!1);Wi(()=>m(!0),[]);const v=r||u&&globalThis?.document?.body;return v?qI.createPortal(_.jsx(Mn.div,{...l,ref:e}),v):null});Yy.displayName=Fj;function Vj(t,e){return P.useReducer((r,l)=>e[r][l]??r,t)}var zo=t=>{const{present:e,children:r}=t,l=Uj(e),u=typeof r=="function"?r({present:l.isPresent}):P.Children.only(r),m=or(l.ref,$j(u));return typeof r=="function"||l.isPresent?P.cloneElement(u,{ref:m}):null};zo.displayName="Presence";function Uj(t){const[e,r]=P.useState(),l=P.useRef(null),u=P.useRef(t),m=P.useRef("none"),v=t?"mounted":"unmounted",[b,a]=Vj(v,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const k=cx(l.current);m.current=b==="mounted"?k:"none"},[b]),Wi(()=>{const k=l.current,M=u.current;if(M!==t){const z=m.current,O=cx(k);t?a("MOUNT"):O==="none"||k?.display==="none"?a("UNMOUNT"):a(M&&z!==O?"ANIMATION_OUT":"UNMOUNT"),u.current=t}},[t,a]),Wi(()=>{if(e){let k;const M=e.ownerDocument.defaultView??window,L=O=>{const H=cx(l.current).includes(CSS.escape(O.animationName));if(O.target===e&&H&&(a("ANIMATION_END"),!u.current)){const Z=e.style.animationFillMode;e.style.animationFillMode="forwards",k=M.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=Z)})}},z=O=>{O.target===e&&(m.current=cx(l.current))};return e.addEventListener("animationstart",z),e.addEventListener("animationcancel",L),e.addEventListener("animationend",L),()=>{M.clearTimeout(k),e.removeEventListener("animationstart",z),e.removeEventListener("animationcancel",L),e.removeEventListener("animationend",L)}}else a("ANIMATION_END")},[e,a]),{isPresent:["mounted","unmountSuspended"].includes(b),ref:P.useCallback(k=>{l.current=k?getComputedStyle(k):null,r(k)},[])}}function cx(t){return t?.animationName||"none"}function $j(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Gj=Ev[" useInsertionEffect ".trim().toString()]||Wi;function fh({prop:t,defaultProp:e,onChange:r=()=>{},caller:l}){const[u,m,v]=Hj({defaultProp:e,onChange:r}),b=t!==void 0,a=b?t:u;{const M=P.useRef(t!==void 0);P.useEffect(()=>{const L=M.current;L!==b&&console.warn(`${l} is changing from ${L?"controlled":"uncontrolled"} to ${b?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),M.current=b},[b,l])}const k=P.useCallback(M=>{if(b){const L=Wj(M)?M(t):M;L!==t&&v.current?.(L)}else m(M)},[b,t,m,v]);return[a,k]}function Hj({defaultProp:t,onChange:e}){const[r,l]=P.useState(t),u=P.useRef(r),m=P.useRef(e);return Gj(()=>{m.current=e},[e]),P.useEffect(()=>{u.current!==r&&(m.current?.(r),u.current=r)},[r,u]),[r,l,m]}function Wj(t){return typeof t=="function"}var YI=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),qj="VisuallyHidden",kv=P.forwardRef((t,e)=>_.jsx(Mn.span,{...t,ref:e,style:{...YI,...t.style}}));kv.displayName=qj;var Zj=kv,Tb="ToastProvider",[Sb,Xj,Kj]=Cv("Toast"),[JI]=sl("Toast",[Kj]),[Yj,Av]=JI(Tb),QI=t=>{const{__scopeToast:e,label:r="Notification",duration:l=5e3,swipeDirection:u="right",swipeThreshold:m=50,children:v}=t,[b,a]=P.useState(null),[k,M]=P.useState(0),L=P.useRef(!1),z=P.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${Tb}\`. Expected non-empty \`string\`.`),_.jsx(Sb.Provider,{scope:e,children:_.jsx(Yj,{scope:e,label:r,duration:l,swipeDirection:u,swipeThreshold:m,toastCount:k,viewport:b,onViewportChange:a,onToastAdd:P.useCallback(()=>M(O=>O+1),[]),onToastRemove:P.useCallback(()=>M(O=>O-1),[]),isFocusedToastEscapeKeyDownRef:L,isClosePausedRef:z,children:v})})};QI.displayName=Tb;var eM="ToastViewport",Jj=["F8"],uw="toast.viewportPause",dw="toast.viewportResume",tM=P.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:l=Jj,label:u="Notifications ({hotkey})",...m}=t,v=Av(eM,r),b=Xj(r),a=P.useRef(null),k=P.useRef(null),M=P.useRef(null),L=P.useRef(null),z=or(e,L,v.onViewportChange),O=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=v.toastCount>0;P.useEffect(()=>{const Z=Y=>{l.length!==0&&l.every(ie=>Y[ie]||Y.code===ie)&&L.current?.focus()};return document.addEventListener("keydown",Z),()=>document.removeEventListener("keydown",Z)},[l]),P.useEffect(()=>{const Z=a.current,Y=L.current;if(K&&Z&&Y){const ee=()=>{if(!v.isClosePausedRef.current){const Ce=new CustomEvent(uw);Y.dispatchEvent(Ce),v.isClosePausedRef.current=!0}},ie=()=>{if(v.isClosePausedRef.current){const Ce=new CustomEvent(dw);Y.dispatchEvent(Ce),v.isClosePausedRef.current=!1}},pe=Ce=>{!Z.contains(Ce.relatedTarget)&&ie()},xe=()=>{Z.contains(document.activeElement)||ie()};return Z.addEventListener("focusin",ee),Z.addEventListener("focusout",pe),Z.addEventListener("pointermove",ee),Z.addEventListener("pointerleave",xe),window.addEventListener("blur",ee),window.addEventListener("focus",ie),()=>{Z.removeEventListener("focusin",ee),Z.removeEventListener("focusout",pe),Z.removeEventListener("pointermove",ee),Z.removeEventListener("pointerleave",xe),window.removeEventListener("blur",ee),window.removeEventListener("focus",ie)}}},[K,v.isClosePausedRef]);const H=P.useCallback(({tabbingDirection:Z})=>{const ee=b().map(ie=>{const pe=ie.ref.current,xe=[pe,...dO(pe)];return Z==="forwards"?xe:xe.reverse()});return(Z==="forwards"?ee.reverse():ee).flat()},[b]);return P.useEffect(()=>{const Z=L.current;if(Z){const Y=ee=>{const ie=ee.altKey||ee.ctrlKey||ee.metaKey;if(ee.key==="Tab"&&!ie){const xe=document.activeElement,Ce=ee.shiftKey;if(ee.target===Z&&Ce){k.current?.focus();return}const et=H({tabbingDirection:Ce?"backwards":"forwards"}),Ie=et.findIndex(ot=>ot===xe);p1(et.slice(Ie+1))?ee.preventDefault():Ce?k.current?.focus():M.current?.focus()}};return Z.addEventListener("keydown",Y),()=>Z.removeEventListener("keydown",Y)}},[b,H]),_.jsxs(Bj,{ref:a,role:"region","aria-label":u.replace("{hotkey}",O),tabIndex:-1,style:{pointerEvents:K?void 0:"none"},children:[K&&_.jsx(hw,{ref:k,onFocusFromOutsideViewport:()=>{const Z=H({tabbingDirection:"forwards"});p1(Z)}}),_.jsx(Sb.Slot,{scope:r,children:_.jsx(Mn.ol,{tabIndex:-1,...m,ref:z})}),K&&_.jsx(hw,{ref:M,onFocusFromOutsideViewport:()=>{const Z=H({tabbingDirection:"backwards"});p1(Z)}})]})});tM.displayName=eM;var nM="ToastFocusProxy",hw=P.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:l,...u}=t,m=Av(nM,r);return _.jsx(kv,{tabIndex:0,...u,ref:e,style:{position:"fixed"},onFocus:v=>{const b=v.relatedTarget;!m.viewport?.contains(b)&&l()}})});hw.displayName=nM;var Jy="Toast",Qj="toast.swipeStart",eO="toast.swipeMove",tO="toast.swipeCancel",nO="toast.swipeEnd",rM=P.forwardRef((t,e)=>{const{forceMount:r,open:l,defaultOpen:u,onOpenChange:m,...v}=t,[b,a]=fh({prop:l,defaultProp:u??!0,onChange:m,caller:Jy});return _.jsx(zo,{present:r||b,children:_.jsx(sO,{open:b,...v,ref:e,onClose:()=>a(!1),onPause:Ui(t.onPause),onResume:Ui(t.onResume),onSwipeStart:Xt(t.onSwipeStart,k=>{k.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Xt(t.onSwipeMove,k=>{const{x:M,y:L}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","move"),k.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${M}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${L}px`)}),onSwipeCancel:Xt(t.onSwipeCancel,k=>{k.currentTarget.setAttribute("data-swipe","cancel"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Xt(t.onSwipeEnd,k=>{const{x:M,y:L}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","end"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${M}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${L}px`),a(!1)})})})});rM.displayName=Jy;var[rO,iO]=JI(Jy,{onClose(){}}),sO=P.forwardRef((t,e)=>{const{__scopeToast:r,type:l="foreground",duration:u,open:m,onClose:v,onEscapeKeyDown:b,onPause:a,onResume:k,onSwipeStart:M,onSwipeMove:L,onSwipeCancel:z,onSwipeEnd:O,...K}=t,H=Av(Jy,r),[Z,Y]=P.useState(null),ee=or(e,ft=>Y(ft)),ie=P.useRef(null),pe=P.useRef(null),xe=u||H.duration,Ce=P.useRef(0),je=P.useRef(xe),Ue=P.useRef(0),{onToastAdd:et,onToastRemove:Ie}=H,ot=Ui(()=>{Z?.contains(document.activeElement)&&H.viewport?.focus(),v()}),ut=P.useCallback(ft=>{!ft||ft===1/0||(window.clearTimeout(Ue.current),Ce.current=new Date().getTime(),Ue.current=window.setTimeout(ot,ft))},[ot]);P.useEffect(()=>{const ft=H.viewport;if(ft){const vt=()=>{ut(je.current),k?.()},st=()=>{const nt=new Date().getTime()-Ce.current;je.current=je.current-nt,window.clearTimeout(Ue.current),a?.()};return ft.addEventListener(uw,st),ft.addEventListener(dw,vt),()=>{ft.removeEventListener(uw,st),ft.removeEventListener(dw,vt)}}},[H.viewport,xe,a,k,ut]),P.useEffect(()=>{m&&!H.isClosePausedRef.current&&ut(xe)},[m,xe,H.isClosePausedRef,ut]),P.useEffect(()=>(et(),()=>Ie()),[et,Ie]);const gt=P.useMemo(()=>Z?uM(Z):null,[Z]);return H.viewport?_.jsxs(_.Fragment,{children:[gt&&_.jsx(oO,{__scopeToast:r,role:"status","aria-live":l==="foreground"?"assertive":"polite",children:gt}),_.jsx(rO,{scope:r,onClose:ot,children:vh.createPortal(_.jsx(Sb.ItemSlot,{scope:r,children:_.jsx(zj,{asChild:!0,onEscapeKeyDown:Xt(b,()=>{H.isFocusedToastEscapeKeyDownRef.current||ot(),H.isFocusedToastEscapeKeyDownRef.current=!1}),children:_.jsx(Mn.li,{tabIndex:0,"data-state":m?"open":"closed","data-swipe-direction":H.swipeDirection,...K,ref:ee,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Xt(t.onKeyDown,ft=>{ft.key==="Escape"&&(b?.(ft.nativeEvent),ft.nativeEvent.defaultPrevented||(H.isFocusedToastEscapeKeyDownRef.current=!0,ot()))}),onPointerDown:Xt(t.onPointerDown,ft=>{ft.button===0&&(ie.current={x:ft.clientX,y:ft.clientY})}),onPointerMove:Xt(t.onPointerMove,ft=>{if(!ie.current)return;const vt=ft.clientX-ie.current.x,st=ft.clientY-ie.current.y,nt=!!pe.current,ze=["left","right"].includes(H.swipeDirection),Se=["left","up"].includes(H.swipeDirection)?Math.min:Math.max,We=ze?Se(0,vt):0,fe=ze?0:Se(0,st),Fe=ft.pointerType==="touch"?10:2,lt={x:We,y:fe},Tt={originalEvent:ft,delta:lt};nt?(pe.current=lt,ux(eO,L,Tt,{discrete:!1})):lC(lt,H.swipeDirection,Fe)?(pe.current=lt,ux(Qj,M,Tt,{discrete:!1}),ft.target.setPointerCapture(ft.pointerId)):(Math.abs(vt)>Fe||Math.abs(st)>Fe)&&(ie.current=null)}),onPointerUp:Xt(t.onPointerUp,ft=>{const vt=pe.current,st=ft.target;if(st.hasPointerCapture(ft.pointerId)&&st.releasePointerCapture(ft.pointerId),pe.current=null,ie.current=null,vt){const nt=ft.currentTarget,ze={originalEvent:ft,delta:vt};lC(vt,H.swipeDirection,H.swipeThreshold)?ux(nO,O,ze,{discrete:!0}):ux(tO,z,ze,{discrete:!0}),nt.addEventListener("click",Se=>Se.preventDefault(),{once:!0})}})})})}),H.viewport)})]}):null}),oO=t=>{const{__scopeToast:e,children:r,...l}=t,u=Av(Jy,e),[m,v]=P.useState(!1),[b,a]=P.useState(!1);return cO(()=>v(!0)),P.useEffect(()=>{const k=window.setTimeout(()=>a(!0),1e3);return()=>window.clearTimeout(k)},[]),b?null:_.jsx(Yy,{asChild:!0,children:_.jsx(kv,{...l,children:m&&_.jsxs(_.Fragment,{children:[u.label," ",r]})})})},aO="ToastTitle",iM=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t;return _.jsx(Mn.div,{...l,ref:e})});iM.displayName=aO;var lO="ToastDescription",sM=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t;return _.jsx(Mn.div,{...l,ref:e})});sM.displayName=lO;var oM="ToastAction",aM=P.forwardRef((t,e)=>{const{altText:r,...l}=t;return r.trim()?_.jsx(cM,{altText:r,asChild:!0,children:_.jsx(Eb,{...l,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${oM}\`. Expected non-empty \`string\`.`),null)});aM.displayName=oM;var lM="ToastClose",Eb=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t,u=iO(lM,r);return _.jsx(cM,{asChild:!0,children:_.jsx(Mn.button,{type:"button",...l,ref:e,onClick:Xt(t.onClick,u.onClose)})})});Eb.displayName=lM;var cM=P.forwardRef((t,e)=>{const{__scopeToast:r,altText:l,...u}=t;return _.jsx(Mn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":l||void 0,...u,ref:e})});function uM(t){const e=[];return Array.from(t.childNodes).forEach(l=>{if(l.nodeType===l.TEXT_NODE&&l.textContent&&e.push(l.textContent),uO(l)){const u=l.ariaHidden||l.hidden||l.style.display==="none",m=l.dataset.radixToastAnnounceExclude==="";if(!u)if(m){const v=l.dataset.radixToastAnnounceAlt;v&&e.push(v)}else e.push(...uM(l))}}),e}function ux(t,e,r,{discrete:l}){const u=r.originalEvent.currentTarget,m=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&u.addEventListener(t,e,{once:!0}),l?bb(u,m):u.dispatchEvent(m)}var lC=(t,e,r=0)=>{const l=Math.abs(t.x),u=Math.abs(t.y),m=l>u;return e==="left"||e==="right"?m&&l>r:!m&&u>r};function cO(t=()=>{}){const e=Ui(t);Wi(()=>{let r=0,l=0;return r=window.requestAnimationFrame(()=>l=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(l)}},[e])}function uO(t){return t.nodeType===t.ELEMENT_NODE}function dO(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const u=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||u?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function p1(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var hO=QI,dM=tM,hM=rM,fM=iM,pM=sM,mM=aM,gM=Eb;function yM(t){var e,r,l="";if(typeof t=="string"||typeof t=="number")l+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(e=0;e<u;e++)t[e]&&(r=yM(t[e]))&&(l&&(l+=" "),l+=r)}else for(r in t)t[r]&&(l&&(l+=" "),l+=r);return l}function _M(){for(var t,e,r=0,l="",u=arguments.length;r<u;r++)(t=arguments[r])&&(e=yM(t))&&(l&&(l+=" "),l+=e);return l}const cC=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,uC=_M,Qy=(t,e)=>r=>{var l;if(e?.variants==null)return uC(t,r?.class,r?.className);const{variants:u,defaultVariants:m}=e,v=Object.keys(u).map(k=>{const M=r?.[k],L=m?.[k];if(M===null)return null;const z=cC(M)||cC(L);return u[k][z]}),b=r&&Object.entries(r).reduce((k,M)=>{let[L,z]=M;return z===void 0||(k[L]=z),k},{}),a=e==null||(l=e.compoundVariants)===null||l===void 0?void 0:l.reduce((k,M)=>{let{class:L,className:z,...O}=M;return Object.entries(O).every(K=>{let[H,Z]=K;return Array.isArray(Z)?Z.includes({...m,...b}[H]):{...m,...b}[H]===Z})?[...k,L,z]:k},[]);return uC(t,v,a,r?.class,r?.className)};const fO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),xM=(...t)=>t.filter((e,r,l)=>!!e&&e.trim()!==""&&l.indexOf(e)===r).join(" ").trim();var pO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const mO=P.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:u="",children:m,iconNode:v,...b},a)=>P.createElement("svg",{ref:a,...pO,width:e,height:e,stroke:t,strokeWidth:l?Number(r)*24/Number(e):r,className:xM("lucide",u),...b},[...v.map(([k,M])=>P.createElement(k,M)),...Array.isArray(m)?m:[m]]));const nn=(t,e)=>{const r=P.forwardRef(({className:l,...u},m)=>P.createElement(mO,{ref:m,iconNode:e,className:xM(`lucide-${fO(t)}`,l),...u}));return r.displayName=`${t}`,r};const Iv=nn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Cb=nn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const dC=nn("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const gO=nn("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const vM=nn("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);const oh=nn("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Rm=nn("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const kb=nn("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const yO=nn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const wM=nn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const wh=nn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const qf=nn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const bM=nn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Dm=nn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const _O=nn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const xO=nn("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const vO=nn("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);const wO=nn("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const bO=nn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const Mv=nn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const TO=nn("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const Ab=nn("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);const m1=nn("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);const g1=nn("CornerUpRight",[["polyline",{points:"15 14 20 9 15 4",key:"1tbx3s"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]]);const nl=nn("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const SO=nn("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const EO=nn("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);const CO=nn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const kO=nn("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);const AO=nn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const IO=nn("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);const TM=nn("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);const Ib=nn("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);const MO=nn("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const Mb=nn("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const PO=nn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);const $f=nn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const Pb=nn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const NO=nn("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);const hC=nn("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);const Nb=nn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const Rb=nn("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const ki=nn("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Ay=nn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const fw=nn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const SM=nn("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Ai=nn("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const EM=nn("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const RO=nn("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const Gx=nn("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);const Hx=nn("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const CM=nn("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const y1=nn("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const DO=nn("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);const e_=nn("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const xm=nn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const fC=nn("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const LO=nn("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Pv=nn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const jO=nn("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const OO=nn("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const zO=nn("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const ah=nn("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const Vc=nn("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);const kM=nn("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);const qm=nn("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);const lh=nn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const BO=nn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const AM=nn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Iy=nn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const IM=nn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const FO=nn("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);const t_=nn("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);const di=nn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Db="-",VO=t=>{const e=$O(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:l}=t;return{getClassGroupId:v=>{const b=v.split(Db);return b[0]===""&&b.length!==1&&b.shift(),MM(b,e)||UO(v)},getConflictingClassGroupIds:(v,b)=>{const a=r[v]||[];return b&&l[v]?[...a,...l[v]]:a}}},MM=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],l=e.nextPart.get(r),u=l?MM(t.slice(1),l):void 0;if(u)return u;if(e.validators.length===0)return;const m=t.join(Db);return e.validators.find(({validator:v})=>v(m))?.classGroupId},pC=/^\[(.+)\]$/,UO=t=>{if(pC.test(t)){const e=pC.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},$O=t=>{const{theme:e,prefix:r}=t,l={nextPart:new Map,validators:[]};return HO(Object.entries(t.classGroups),r).forEach(([m,v])=>{pw(v,l,m,e)}),l},pw=(t,e,r,l)=>{t.forEach(u=>{if(typeof u=="string"){const m=u===""?e:mC(e,u);m.classGroupId=r;return}if(typeof u=="function"){if(GO(u)){pw(u(l),e,r,l);return}e.validators.push({validator:u,classGroupId:r});return}Object.entries(u).forEach(([m,v])=>{pw(v,mC(e,m),r,l)})})},mC=(t,e)=>{let r=t;return e.split(Db).forEach(l=>{r.nextPart.has(l)||r.nextPart.set(l,{nextPart:new Map,validators:[]}),r=r.nextPart.get(l)}),r},GO=t=>t.isThemeGetter,HO=(t,e)=>e?t.map(([r,l])=>{const u=l.map(m=>typeof m=="string"?e+m:typeof m=="object"?Object.fromEntries(Object.entries(m).map(([v,b])=>[e+v,b])):m);return[r,u]}):t,WO=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,l=new Map;const u=(m,v)=>{r.set(m,v),e++,e>t&&(e=0,l=r,r=new Map)};return{get(m){let v=r.get(m);if(v!==void 0)return v;if((v=l.get(m))!==void 0)return u(m,v),v},set(m,v){r.has(m)?r.set(m,v):u(m,v)}}},PM="!",qO=t=>{const{separator:e,experimentalParseClassName:r}=t,l=e.length===1,u=e[0],m=e.length,v=b=>{const a=[];let k=0,M=0,L;for(let Z=0;Z<b.length;Z++){let Y=b[Z];if(k===0){if(Y===u&&(l||b.slice(Z,Z+m)===e)){a.push(b.slice(M,Z)),M=Z+m;continue}if(Y==="/"){L=Z;continue}}Y==="["?k++:Y==="]"&&k--}const z=a.length===0?b:b.substring(M),O=z.startsWith(PM),K=O?z.substring(1):z,H=L&&L>M?L-M:void 0;return{modifiers:a,hasImportantModifier:O,baseClassName:K,maybePostfixModifierPosition:H}};return r?b=>r({className:b,parseClassName:v}):v},ZO=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(l=>{l[0]==="["?(e.push(...r.sort(),l),r=[]):r.push(l)}),e.push(...r.sort()),e},XO=t=>({cache:WO(t.cacheSize),parseClassName:qO(t),...VO(t)}),KO=/\s+/,YO=(t,e)=>{const{parseClassName:r,getClassGroupId:l,getConflictingClassGroupIds:u}=e,m=[],v=t.trim().split(KO);let b="";for(let a=v.length-1;a>=0;a-=1){const k=v[a],{modifiers:M,hasImportantModifier:L,baseClassName:z,maybePostfixModifierPosition:O}=r(k);let K=!!O,H=l(K?z.substring(0,O):z);if(!H){if(!K){b=k+(b.length>0?" "+b:b);continue}if(H=l(z),!H){b=k+(b.length>0?" "+b:b);continue}K=!1}const Z=ZO(M).join(":"),Y=L?Z+PM:Z,ee=Y+H;if(m.includes(ee))continue;m.push(ee);const ie=u(H,K);for(let pe=0;pe<ie.length;++pe){const xe=ie[pe];m.push(Y+xe)}b=k+(b.length>0?" "+b:b)}return b};function JO(){let t=0,e,r,l="";for(;t<arguments.length;)(e=arguments[t++])&&(r=NM(e))&&(l&&(l+=" "),l+=r);return l}const NM=t=>{if(typeof t=="string")return t;let e,r="";for(let l=0;l<t.length;l++)t[l]&&(e=NM(t[l]))&&(r&&(r+=" "),r+=e);return r};function QO(t,...e){let r,l,u,m=v;function v(a){const k=e.reduce((M,L)=>L(M),t());return r=XO(k),l=r.cache.get,u=r.cache.set,m=b,b(a)}function b(a){const k=l(a);if(k)return k;const M=YO(a,r);return u(a,M),M}return function(){return m(JO.apply(null,arguments))}}const li=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},RM=/^\[(?:([a-z-]+):)?(.+)\]$/i,ez=/^\d+\/\d+$/,tz=new Set(["px","full","screen"]),nz=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,rz=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,iz=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,sz=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oz=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vu=t=>Em(t)||tz.has(t)||ez.test(t),qd=t=>Zm(t,"length",pz),Em=t=>!!t&&!Number.isNaN(Number(t)),_1=t=>Zm(t,"number",Em),ny=t=>!!t&&Number.isInteger(Number(t)),az=t=>t.endsWith("%")&&Em(t.slice(0,-1)),tr=t=>RM.test(t),Zd=t=>nz.test(t),lz=new Set(["length","size","percentage"]),cz=t=>Zm(t,lz,DM),uz=t=>Zm(t,"position",DM),dz=new Set(["image","url"]),hz=t=>Zm(t,dz,gz),fz=t=>Zm(t,"",mz),ry=()=>!0,Zm=(t,e,r)=>{const l=RM.exec(t);return l?l[1]?typeof e=="string"?l[1]===e:e.has(l[1]):r(l[2]):!1},pz=t=>rz.test(t)&&!iz.test(t),DM=()=>!1,mz=t=>sz.test(t),gz=t=>oz.test(t),yz=()=>{const t=li("colors"),e=li("spacing"),r=li("blur"),l=li("brightness"),u=li("borderColor"),m=li("borderRadius"),v=li("borderSpacing"),b=li("borderWidth"),a=li("contrast"),k=li("grayscale"),M=li("hueRotate"),L=li("invert"),z=li("gap"),O=li("gradientColorStops"),K=li("gradientColorStopPositions"),H=li("inset"),Z=li("margin"),Y=li("opacity"),ee=li("padding"),ie=li("saturate"),pe=li("scale"),xe=li("sepia"),Ce=li("skew"),je=li("space"),Ue=li("translate"),et=()=>["auto","contain","none"],Ie=()=>["auto","hidden","clip","visible","scroll"],ot=()=>["auto",tr,e],ut=()=>[tr,e],gt=()=>["",Vu,qd],ft=()=>["auto",Em,tr],vt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],st=()=>["solid","dashed","dotted","double","none"],nt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],ze=()=>["start","end","center","between","around","evenly","stretch"],Se=()=>["","0",tr],We=()=>["auto","avoid","all","avoid-page","page","left","right","column"],fe=()=>[Em,tr];return{cacheSize:500,separator:":",theme:{colors:[ry],spacing:[Vu,qd],blur:["none","",Zd,tr],brightness:fe(),borderColor:[t],borderRadius:["none","","full",Zd,tr],borderSpacing:ut(),borderWidth:gt(),contrast:fe(),grayscale:Se(),hueRotate:fe(),invert:Se(),gap:ut(),gradientColorStops:[t],gradientColorStopPositions:[az,qd],inset:ot(),margin:ot(),opacity:fe(),padding:ut(),saturate:fe(),scale:fe(),sepia:Se(),skew:fe(),space:ut(),translate:ut()},classGroups:{aspect:[{aspect:["auto","square","video",tr]}],container:["container"],columns:[{columns:[Zd]}],"break-after":[{"break-after":We()}],"break-before":[{"break-before":We()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...vt(),tr]}],overflow:[{overflow:Ie()}],"overflow-x":[{"overflow-x":Ie()}],"overflow-y":[{"overflow-y":Ie()}],overscroll:[{overscroll:et()}],"overscroll-x":[{"overscroll-x":et()}],"overscroll-y":[{"overscroll-y":et()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[H]}],"inset-x":[{"inset-x":[H]}],"inset-y":[{"inset-y":[H]}],start:[{start:[H]}],end:[{end:[H]}],top:[{top:[H]}],right:[{right:[H]}],bottom:[{bottom:[H]}],left:[{left:[H]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",ny,tr]}],basis:[{basis:ot()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",tr]}],grow:[{grow:Se()}],shrink:[{shrink:Se()}],order:[{order:["first","last","none",ny,tr]}],"grid-cols":[{"grid-cols":[ry]}],"col-start-end":[{col:["auto",{span:["full",ny,tr]},tr]}],"col-start":[{"col-start":ft()}],"col-end":[{"col-end":ft()}],"grid-rows":[{"grid-rows":[ry]}],"row-start-end":[{row:["auto",{span:[ny,tr]},tr]}],"row-start":[{"row-start":ft()}],"row-end":[{"row-end":ft()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",tr]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",tr]}],gap:[{gap:[z]}],"gap-x":[{"gap-x":[z]}],"gap-y":[{"gap-y":[z]}],"justify-content":[{justify:["normal",...ze()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...ze(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...ze(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[ee]}],px:[{px:[ee]}],py:[{py:[ee]}],ps:[{ps:[ee]}],pe:[{pe:[ee]}],pt:[{pt:[ee]}],pr:[{pr:[ee]}],pb:[{pb:[ee]}],pl:[{pl:[ee]}],m:[{m:[Z]}],mx:[{mx:[Z]}],my:[{my:[Z]}],ms:[{ms:[Z]}],me:[{me:[Z]}],mt:[{mt:[Z]}],mr:[{mr:[Z]}],mb:[{mb:[Z]}],ml:[{ml:[Z]}],"space-x":[{"space-x":[je]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[je]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",tr,e]}],"min-w":[{"min-w":[tr,e,"min","max","fit"]}],"max-w":[{"max-w":[tr,e,"none","full","min","max","fit","prose",{screen:[Zd]},Zd]}],h:[{h:[tr,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[tr,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[tr,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[tr,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zd,qd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",_1]}],"font-family":[{font:[ry]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",tr]}],"line-clamp":[{"line-clamp":["none",Em,_1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Vu,tr]}],"list-image":[{"list-image":["none",tr]}],"list-style-type":[{list:["none","disc","decimal",tr]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[Y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[Y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...st(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Vu,qd]}],"underline-offset":[{"underline-offset":["auto",Vu,tr]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ut()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",tr]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",tr]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[Y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...vt(),uz]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",cz]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},hz]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[K]}],"gradient-via-pos":[{via:[K]}],"gradient-to-pos":[{to:[K]}],"gradient-from":[{from:[O]}],"gradient-via":[{via:[O]}],"gradient-to":[{to:[O]}],rounded:[{rounded:[m]}],"rounded-s":[{"rounded-s":[m]}],"rounded-e":[{"rounded-e":[m]}],"rounded-t":[{"rounded-t":[m]}],"rounded-r":[{"rounded-r":[m]}],"rounded-b":[{"rounded-b":[m]}],"rounded-l":[{"rounded-l":[m]}],"rounded-ss":[{"rounded-ss":[m]}],"rounded-se":[{"rounded-se":[m]}],"rounded-ee":[{"rounded-ee":[m]}],"rounded-es":[{"rounded-es":[m]}],"rounded-tl":[{"rounded-tl":[m]}],"rounded-tr":[{"rounded-tr":[m]}],"rounded-br":[{"rounded-br":[m]}],"rounded-bl":[{"rounded-bl":[m]}],"border-w":[{border:[b]}],"border-w-x":[{"border-x":[b]}],"border-w-y":[{"border-y":[b]}],"border-w-s":[{"border-s":[b]}],"border-w-e":[{"border-e":[b]}],"border-w-t":[{"border-t":[b]}],"border-w-r":[{"border-r":[b]}],"border-w-b":[{"border-b":[b]}],"border-w-l":[{"border-l":[b]}],"border-opacity":[{"border-opacity":[Y]}],"border-style":[{border:[...st(),"hidden"]}],"divide-x":[{"divide-x":[b]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[b]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[Y]}],"divide-style":[{divide:st()}],"border-color":[{border:[u]}],"border-color-x":[{"border-x":[u]}],"border-color-y":[{"border-y":[u]}],"border-color-s":[{"border-s":[u]}],"border-color-e":[{"border-e":[u]}],"border-color-t":[{"border-t":[u]}],"border-color-r":[{"border-r":[u]}],"border-color-b":[{"border-b":[u]}],"border-color-l":[{"border-l":[u]}],"divide-color":[{divide:[u]}],"outline-style":[{outline:["",...st()]}],"outline-offset":[{"outline-offset":[Vu,tr]}],"outline-w":[{outline:[Vu,qd]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:gt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[Y]}],"ring-offset-w":[{"ring-offset":[Vu,qd]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zd,fz]}],"shadow-color":[{shadow:[ry]}],opacity:[{opacity:[Y]}],"mix-blend":[{"mix-blend":[...nt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":nt()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[l]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",Zd,tr]}],grayscale:[{grayscale:[k]}],"hue-rotate":[{"hue-rotate":[M]}],invert:[{invert:[L]}],saturate:[{saturate:[ie]}],sepia:[{sepia:[xe]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[l]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[k]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[M]}],"backdrop-invert":[{"backdrop-invert":[L]}],"backdrop-opacity":[{"backdrop-opacity":[Y]}],"backdrop-saturate":[{"backdrop-saturate":[ie]}],"backdrop-sepia":[{"backdrop-sepia":[xe]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[v]}],"border-spacing-x":[{"border-spacing-x":[v]}],"border-spacing-y":[{"border-spacing-y":[v]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",tr]}],duration:[{duration:fe()}],ease:[{ease:["linear","in","out","in-out",tr]}],delay:[{delay:fe()}],animate:[{animate:["none","spin","ping","pulse","bounce",tr]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[pe]}],"scale-x":[{"scale-x":[pe]}],"scale-y":[{"scale-y":[pe]}],rotate:[{rotate:[ny,tr]}],"translate-x":[{"translate-x":[Ue]}],"translate-y":[{"translate-y":[Ue]}],"skew-x":[{"skew-x":[Ce]}],"skew-y":[{"skew-y":[Ce]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",tr]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",tr]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ut()}],"scroll-mx":[{"scroll-mx":ut()}],"scroll-my":[{"scroll-my":ut()}],"scroll-ms":[{"scroll-ms":ut()}],"scroll-me":[{"scroll-me":ut()}],"scroll-mt":[{"scroll-mt":ut()}],"scroll-mr":[{"scroll-mr":ut()}],"scroll-mb":[{"scroll-mb":ut()}],"scroll-ml":[{"scroll-ml":ut()}],"scroll-p":[{"scroll-p":ut()}],"scroll-px":[{"scroll-px":ut()}],"scroll-py":[{"scroll-py":ut()}],"scroll-ps":[{"scroll-ps":ut()}],"scroll-pe":[{"scroll-pe":ut()}],"scroll-pt":[{"scroll-pt":ut()}],"scroll-pr":[{"scroll-pr":ut()}],"scroll-pb":[{"scroll-pb":ut()}],"scroll-pl":[{"scroll-pl":ut()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",tr]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Vu,qd,_1]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},_z=QO(yz);function cn(...t){return _z(_M(t))}const xz=hO,LM=P.forwardRef(({className:t,...e},r)=>_.jsx(dM,{ref:r,className:cn("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));LM.displayName=dM.displayName;const vz=Qy("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),jM=P.forwardRef(({className:t,variant:e,...r},l)=>_.jsx(hM,{ref:l,className:cn(vz({variant:e}),t),...r}));jM.displayName=hM.displayName;const wz=P.forwardRef(({className:t,...e},r)=>_.jsx(mM,{ref:r,className:cn("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));wz.displayName=mM.displayName;const OM=P.forwardRef(({className:t,...e},r)=>_.jsx(gM,{ref:r,className:cn("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:_.jsx(di,{className:"h-4 w-4"})}));OM.displayName=gM.displayName;const zM=P.forwardRef(({className:t,...e},r)=>_.jsx(fM,{ref:r,className:cn("text-sm font-semibold",t),...e}));zM.displayName=fM.displayName;const BM=P.forwardRef(({className:t,...e},r)=>_.jsx(pM,{ref:r,className:cn("text-sm opacity-90",t),...e}));BM.displayName=pM.displayName;function bz(){const{toasts:t}=gj();return _.jsxs(xz,{children:[t.map(function({id:e,title:r,description:l,action:u,...m}){const{key:v,...b}=m;return _.jsxs(jM,{...b,children:[" ",_.jsxs("div",{className:"grid gap-1",children:[r&&_.jsx(zM,{children:r}),l&&_.jsx(BM,{children:l})]}),u,_.jsx(OM,{})]},e)}),_.jsx(LM,{})]})}var gC=["light","dark"],Tz="(prefers-color-scheme: dark)",Sz=P.createContext(void 0),Ez={setTheme:t=>{},themes:[]},Cz=()=>{var t;return(t=P.useContext(Sz))!=null?t:Ez};P.memo(({forcedTheme:t,storageKey:e,attribute:r,enableSystem:l,enableColorScheme:u,defaultTheme:m,value:v,attrs:b,nonce:a})=>{let k=m==="system",M=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${b.map(K=>`'${K}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,L=u?gC.includes(m)&&m?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${m}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",z=(K,H=!1,Z=!0)=>{let Y=v?v[K]:K,ee=H?K+"|| ''":`'${Y}'`,ie="";return u&&Z&&!H&&gC.includes(K)&&(ie+=`d.style.colorScheme = '${K}';`),r==="class"?H||Y?ie+=`c.add(${ee})`:ie+="null":Y&&(ie+=`d[s](n,${ee})`),ie},O=t?`!function(){${M}${z(t)}}()`:l?`!function(){try{${M}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${k})){var t='${Tz}',m=window.matchMedia(t);if(m.media!==t||m.matches){${z("dark")}}else{${z("light")}}}else if(e){${v?`var x=${JSON.stringify(v)};`:""}${z(v?"x[e]":"e",!0)}}${k?"":"else{"+z(m,!1,!1)+"}"}${L}}catch(e){}}()`:`!function(){try{${M}var e=localStorage.getItem('${e}');if(e){${v?`var x=${JSON.stringify(v)};`:""}${z(v?"x[e]":"e",!0)}}else{${z(m,!1,!1)};}${L}}catch(t){}}();`;return P.createElement("script",{nonce:a,dangerouslySetInnerHTML:{__html:O}})});var kz=t=>{switch(t){case"success":return Mz;case"info":return Nz;case"warning":return Pz;case"error":return Rz;default:return null}},Az=Array(12).fill(0),Iz=({visible:t,className:e})=>qt.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},qt.createElement("div",{className:"sonner-spinner"},Az.map((r,l)=>qt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${l}`})))),Mz=qt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Pz=qt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},qt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Nz=qt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Rz=qt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},qt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Dz=qt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},qt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),qt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Lz=()=>{let[t,e]=qt.useState(document.hidden);return qt.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},mw=1,jz=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:r,...l}=t,u=typeof t?.id=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:mw++,m=this.toasts.find(b=>b.id===u),v=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(u)&&this.dismissedToasts.delete(u),m?this.toasts=this.toasts.map(b=>b.id===u?(this.publish({...b,...t,id:u,title:r}),{...b,...t,id:u,dismissible:v,title:r}):b):this.addToast({title:r,...l,dismissible:v,id:u}),u},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(e=>{this.subscribers.forEach(r=>r({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let r;e.loading!==void 0&&(r=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let l=t instanceof Promise?t:t(),u=r!==void 0,m,v=l.then(async a=>{if(m=["resolve",a],qt.isValidElement(a))u=!1,this.create({id:r,type:"default",message:a});else if(zz(a)&&!a.ok){u=!1;let k=typeof e.error=="function"?await e.error(`HTTP error! status: ${a.status}`):e.error,M=typeof e.description=="function"?await e.description(`HTTP error! status: ${a.status}`):e.description;this.create({id:r,type:"error",message:k,description:M})}else if(e.success!==void 0){u=!1;let k=typeof e.success=="function"?await e.success(a):e.success,M=typeof e.description=="function"?await e.description(a):e.description;this.create({id:r,type:"success",message:k,description:M})}}).catch(async a=>{if(m=["reject",a],e.error!==void 0){u=!1;let k=typeof e.error=="function"?await e.error(a):e.error,M=typeof e.description=="function"?await e.description(a):e.description;this.create({id:r,type:"error",message:k,description:M})}}).finally(()=>{var a;u&&(this.dismiss(r),r=void 0),(a=e.finally)==null||a.call(e)}),b=()=>new Promise((a,k)=>v.then(()=>m[0]==="reject"?k(m[1]):a(m[1])).catch(k));return typeof r!="string"&&typeof r!="number"?{unwrap:b}:Object.assign(r,{unwrap:b})},this.custom=(t,e)=>{let r=e?.id||mw++;return this.create({jsx:t(r),id:r,...e}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},ra=new jz,Oz=(t,e)=>{let r=e?.id||mw++;return ra.addToast({title:t,...e,id:r}),r},zz=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Bz=Oz,Fz=()=>ra.toasts,Vz=()=>ra.getActiveToasts(),Gt=Object.assign(Bz,{success:ra.success,info:ra.info,warning:ra.warning,error:ra.error,custom:ra.custom,message:ra.message,promise:ra.promise,dismiss:ra.dismiss,loading:ra.loading},{getHistory:Fz,getToasts:Vz});function Uz(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",e==="top"&&r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l),l.styleSheet?l.styleSheet.cssText=t:l.appendChild(document.createTextNode(t))}Uz(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function dx(t){return t.label!==void 0}var $z=3,Gz="32px",Hz="16px",yC=4e3,Wz=356,qz=14,Zz=20,Xz=200;function jl(...t){return t.filter(Boolean).join(" ")}function Kz(t){let[e,r]=t.split("-"),l=[];return e&&l.push(e),r&&l.push(r),l}var Yz=t=>{var e,r,l,u,m,v,b,a,k,M,L;let{invert:z,toast:O,unstyled:K,interacting:H,setHeights:Z,visibleToasts:Y,heights:ee,index:ie,toasts:pe,expanded:xe,removeToast:Ce,defaultRichColors:je,closeButton:Ue,style:et,cancelButtonStyle:Ie,actionButtonStyle:ot,className:ut="",descriptionClassName:gt="",duration:ft,position:vt,gap:st,loadingIcon:nt,expandByDefault:ze,classNames:Se,icons:We,closeButtonAriaLabel:fe="Close toast",pauseWhenPageIsHidden:Fe}=t,[lt,Tt]=qt.useState(null),[Kt,sn]=qt.useState(null),[xt,Zt]=qt.useState(!1),[vn,on]=qt.useState(!1),[Sn,Yt]=qt.useState(!1),[nr,Xn]=qt.useState(!1),[_i,Kn]=qt.useState(!1),[Er,Ks]=qt.useState(0),[xi,Zr]=qt.useState(0),ti=qt.useRef(O.duration||ft||yC),is=qt.useRef(null),qi=qt.useRef(null),Ns=ie===0,xs=ie+1<=Y,Vr=O.type,ss=O.dismissible!==!1,vi=O.className||"",Rs=O.descriptionClassName||"",Zi=qt.useMemo(()=>ee.findIndex(we=>we.toastId===O.id)||0,[ee,O.id]),Ii=qt.useMemo(()=>{var we;return(we=O.closeButton)!=null?we:Ue},[O.closeButton,Ue]),xo=qt.useMemo(()=>O.duration||ft||yC,[O.duration,ft]),Ys=qt.useRef(0),Mi=qt.useRef(0),os=qt.useRef(0),ni=qt.useRef(null),[Ds,Js]=vt.split("-"),vo=qt.useMemo(()=>ee.reduce((we,Oe,Be)=>Be>=Zi?we:we+Oe.height,0),[ee,Zi]),be=Lz(),ne=O.invert||z,re=Vr==="loading";Mi.current=qt.useMemo(()=>Zi*st+vo,[Zi,vo]),qt.useEffect(()=>{ti.current=xo},[xo]),qt.useEffect(()=>{Zt(!0)},[]),qt.useEffect(()=>{let we=qi.current;if(we){let Oe=we.getBoundingClientRect().height;return Zr(Oe),Z(Be=>[{toastId:O.id,height:Oe,position:O.position},...Be]),()=>Z(Be=>Be.filter(Le=>Le.toastId!==O.id))}},[Z,O.id]),qt.useLayoutEffect(()=>{if(!xt)return;let we=qi.current,Oe=we.style.height;we.style.height="auto";let Be=we.getBoundingClientRect().height;we.style.height=Oe,Zr(Be),Z(Le=>Le.find(Ze=>Ze.toastId===O.id)?Le.map(Ze=>Ze.toastId===O.id?{...Ze,height:Be}:Ze):[{toastId:O.id,height:Be,position:O.position},...Le])},[xt,O.title,O.description,Z,O.id]);let ue=qt.useCallback(()=>{on(!0),Ks(Mi.current),Z(we=>we.filter(Oe=>Oe.toastId!==O.id)),setTimeout(()=>{Ce(O)},Xz)},[O,Ce,Z,Mi]);qt.useEffect(()=>{if(O.promise&&Vr==="loading"||O.duration===1/0||O.type==="loading")return;let we;return xe||H||Fe&&be?(()=>{if(os.current<Ys.current){let Oe=new Date().getTime()-Ys.current;ti.current=ti.current-Oe}os.current=new Date().getTime()})():ti.current!==1/0&&(Ys.current=new Date().getTime(),we=setTimeout(()=>{var Oe;(Oe=O.onAutoClose)==null||Oe.call(O,O),ue()},ti.current)),()=>clearTimeout(we)},[xe,H,O,Vr,Fe,be,ue]),qt.useEffect(()=>{O.delete&&ue()},[ue,O.delete]);function Te(){var we,Oe,Be;return We!=null&&We.loading?qt.createElement("div",{className:jl(Se?.loader,(we=O?.classNames)==null?void 0:we.loader,"sonner-loader"),"data-visible":Vr==="loading"},We.loading):nt?qt.createElement("div",{className:jl(Se?.loader,(Oe=O?.classNames)==null?void 0:Oe.loader,"sonner-loader"),"data-visible":Vr==="loading"},nt):qt.createElement(Iz,{className:jl(Se?.loader,(Be=O?.classNames)==null?void 0:Be.loader),visible:Vr==="loading"})}return qt.createElement("li",{tabIndex:0,ref:qi,className:jl(ut,vi,Se?.toast,(e=O?.classNames)==null?void 0:e.toast,Se?.default,Se?.[Vr],(r=O?.classNames)==null?void 0:r[Vr]),"data-sonner-toast":"","data-rich-colors":(l=O.richColors)!=null?l:je,"data-styled":!(O.jsx||O.unstyled||K),"data-mounted":xt,"data-promise":!!O.promise,"data-swiped":_i,"data-removed":vn,"data-visible":xs,"data-y-position":Ds,"data-x-position":Js,"data-index":ie,"data-front":Ns,"data-swiping":Sn,"data-dismissible":ss,"data-type":Vr,"data-invert":ne,"data-swipe-out":nr,"data-swipe-direction":Kt,"data-expanded":!!(xe||ze&&xt),style:{"--index":ie,"--toasts-before":ie,"--z-index":pe.length-ie,"--offset":`${vn?Er:Mi.current}px`,"--initial-height":ze?"auto":`${xi}px`,...et,...O.style},onDragEnd:()=>{Yt(!1),Tt(null),ni.current=null},onPointerDown:we=>{re||!ss||(is.current=new Date,Ks(Mi.current),we.target.setPointerCapture(we.pointerId),we.target.tagName!=="BUTTON"&&(Yt(!0),ni.current={x:we.clientX,y:we.clientY}))},onPointerUp:()=>{var we,Oe,Be,Le;if(nr||!ss)return;ni.current=null;let Ze=Number(((we=qi.current)==null?void 0:we.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Et=Number(((Oe=qi.current)==null?void 0:Oe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Rt=new Date().getTime()-((Be=is.current)==null?void 0:Be.getTime()),bt=lt==="x"?Ze:Et,wn=Math.abs(bt)/Rt;if(Math.abs(bt)>=Zz||wn>.11){Ks(Mi.current),(Le=O.onDismiss)==null||Le.call(O,O),sn(lt==="x"?Ze>0?"right":"left":Et>0?"down":"up"),ue(),Xn(!0),Kn(!1);return}Yt(!1),Tt(null)},onPointerMove:we=>{var Oe,Be,Le,Ze;if(!ni.current||!ss||((Oe=window.getSelection())==null?void 0:Oe.toString().length)>0)return;let Et=we.clientY-ni.current.y,Rt=we.clientX-ni.current.x,bt=(Be=t.swipeDirections)!=null?Be:Kz(vt);!lt&&(Math.abs(Rt)>1||Math.abs(Et)>1)&&Tt(Math.abs(Rt)>Math.abs(Et)?"x":"y");let wn={x:0,y:0};lt==="y"?(bt.includes("top")||bt.includes("bottom"))&&(bt.includes("top")&&Et<0||bt.includes("bottom")&&Et>0)&&(wn.y=Et):lt==="x"&&(bt.includes("left")||bt.includes("right"))&&(bt.includes("left")&&Rt<0||bt.includes("right")&&Rt>0)&&(wn.x=Rt),(Math.abs(wn.x)>0||Math.abs(wn.y)>0)&&Kn(!0),(Le=qi.current)==null||Le.style.setProperty("--swipe-amount-x",`${wn.x}px`),(Ze=qi.current)==null||Ze.style.setProperty("--swipe-amount-y",`${wn.y}px`)}},Ii&&!O.jsx?qt.createElement("button",{"aria-label":fe,"data-disabled":re,"data-close-button":!0,onClick:re||!ss?()=>{}:()=>{var we;ue(),(we=O.onDismiss)==null||we.call(O,O)},className:jl(Se?.closeButton,(u=O?.classNames)==null?void 0:u.closeButton)},(m=We?.close)!=null?m:Dz):null,O.jsx||P.isValidElement(O.title)?O.jsx?O.jsx:typeof O.title=="function"?O.title():O.title:qt.createElement(qt.Fragment,null,Vr||O.icon||O.promise?qt.createElement("div",{"data-icon":"",className:jl(Se?.icon,(v=O?.classNames)==null?void 0:v.icon)},O.promise||O.type==="loading"&&!O.icon?O.icon||Te():null,O.type!=="loading"?O.icon||We?.[Vr]||kz(Vr):null):null,qt.createElement("div",{"data-content":"",className:jl(Se?.content,(b=O?.classNames)==null?void 0:b.content)},qt.createElement("div",{"data-title":"",className:jl(Se?.title,(a=O?.classNames)==null?void 0:a.title)},typeof O.title=="function"?O.title():O.title),O.description?qt.createElement("div",{"data-description":"",className:jl(gt,Rs,Se?.description,(k=O?.classNames)==null?void 0:k.description)},typeof O.description=="function"?O.description():O.description):null),P.isValidElement(O.cancel)?O.cancel:O.cancel&&dx(O.cancel)?qt.createElement("button",{"data-button":!0,"data-cancel":!0,style:O.cancelButtonStyle||Ie,onClick:we=>{var Oe,Be;dx(O.cancel)&&ss&&((Be=(Oe=O.cancel).onClick)==null||Be.call(Oe,we),ue())},className:jl(Se?.cancelButton,(M=O?.classNames)==null?void 0:M.cancelButton)},O.cancel.label):null,P.isValidElement(O.action)?O.action:O.action&&dx(O.action)?qt.createElement("button",{"data-button":!0,"data-action":!0,style:O.actionButtonStyle||ot,onClick:we=>{var Oe,Be;dx(O.action)&&((Be=(Oe=O.action).onClick)==null||Be.call(Oe,we),!we.defaultPrevented&&ue())},className:jl(Se?.actionButton,(L=O?.classNames)==null?void 0:L.actionButton)},O.action.label):null))};function _C(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Jz(t,e){let r={};return[t,e].forEach((l,u)=>{let m=u===1,v=m?"--mobile-offset":"--offset",b=m?Hz:Gz;function a(k){["top","right","bottom","left"].forEach(M=>{r[`${v}-${M}`]=typeof k=="number"?`${k}px`:k})}typeof l=="number"||typeof l=="string"?a(l):typeof l=="object"?["top","right","bottom","left"].forEach(k=>{l[k]===void 0?r[`${v}-${k}`]=b:r[`${v}-${k}`]=typeof l[k]=="number"?`${l[k]}px`:l[k]}):a(b)}),r}var Qz=P.forwardRef(function(t,e){let{invert:r,position:l="bottom-right",hotkey:u=["altKey","KeyT"],expand:m,closeButton:v,className:b,offset:a,mobileOffset:k,theme:M="light",richColors:L,duration:z,style:O,visibleToasts:K=$z,toastOptions:H,dir:Z=_C(),gap:Y=qz,loadingIcon:ee,icons:ie,containerAriaLabel:pe="Notifications",pauseWhenPageIsHidden:xe}=t,[Ce,je]=qt.useState([]),Ue=qt.useMemo(()=>Array.from(new Set([l].concat(Ce.filter(Fe=>Fe.position).map(Fe=>Fe.position)))),[Ce,l]),[et,Ie]=qt.useState([]),[ot,ut]=qt.useState(!1),[gt,ft]=qt.useState(!1),[vt,st]=qt.useState(M!=="system"?M:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),nt=qt.useRef(null),ze=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),Se=qt.useRef(null),We=qt.useRef(!1),fe=qt.useCallback(Fe=>{je(lt=>{var Tt;return(Tt=lt.find(Kt=>Kt.id===Fe.id))!=null&&Tt.delete||ra.dismiss(Fe.id),lt.filter(({id:Kt})=>Kt!==Fe.id)})},[]);return qt.useEffect(()=>ra.subscribe(Fe=>{if(Fe.dismiss){je(lt=>lt.map(Tt=>Tt.id===Fe.id?{...Tt,delete:!0}:Tt));return}setTimeout(()=>{qI.flushSync(()=>{je(lt=>{let Tt=lt.findIndex(Kt=>Kt.id===Fe.id);return Tt!==-1?[...lt.slice(0,Tt),{...lt[Tt],...Fe},...lt.slice(Tt+1)]:[Fe,...lt]})})})}),[]),qt.useEffect(()=>{if(M!=="system"){st(M);return}if(M==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?st("dark"):st("light")),typeof window>"u")return;let Fe=window.matchMedia("(prefers-color-scheme: dark)");try{Fe.addEventListener("change",({matches:lt})=>{st(lt?"dark":"light")})}catch{Fe.addListener(({matches:Tt})=>{try{st(Tt?"dark":"light")}catch(Kt){console.error(Kt)}})}},[M]),qt.useEffect(()=>{Ce.length<=1&&ut(!1)},[Ce]),qt.useEffect(()=>{let Fe=lt=>{var Tt,Kt;u.every(sn=>lt[sn]||lt.code===sn)&&(ut(!0),(Tt=nt.current)==null||Tt.focus()),lt.code==="Escape"&&(document.activeElement===nt.current||(Kt=nt.current)!=null&&Kt.contains(document.activeElement))&&ut(!1)};return document.addEventListener("keydown",Fe),()=>document.removeEventListener("keydown",Fe)},[u]),qt.useEffect(()=>{if(nt.current)return()=>{Se.current&&(Se.current.focus({preventScroll:!0}),Se.current=null,We.current=!1)}},[nt.current]),qt.createElement("section",{ref:e,"aria-label":`${pe} ${ze}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},Ue.map((Fe,lt)=>{var Tt;let[Kt,sn]=Fe.split("-");return Ce.length?qt.createElement("ol",{key:Fe,dir:Z==="auto"?_C():Z,tabIndex:-1,ref:nt,className:b,"data-sonner-toaster":!0,"data-theme":vt,"data-y-position":Kt,"data-lifted":ot&&Ce.length>1&&!m,"data-x-position":sn,style:{"--front-toast-height":`${((Tt=et[0])==null?void 0:Tt.height)||0}px`,"--width":`${Wz}px`,"--gap":`${Y}px`,...O,...Jz(a,k)},onBlur:xt=>{We.current&&!xt.currentTarget.contains(xt.relatedTarget)&&(We.current=!1,Se.current&&(Se.current.focus({preventScroll:!0}),Se.current=null))},onFocus:xt=>{xt.target instanceof HTMLElement&&xt.target.dataset.dismissible==="false"||We.current||(We.current=!0,Se.current=xt.relatedTarget)},onMouseEnter:()=>ut(!0),onMouseMove:()=>ut(!0),onMouseLeave:()=>{gt||ut(!1)},onDragEnd:()=>ut(!1),onPointerDown:xt=>{xt.target instanceof HTMLElement&&xt.target.dataset.dismissible==="false"||ft(!0)},onPointerUp:()=>ft(!1)},Ce.filter(xt=>!xt.position&&lt===0||xt.position===Fe).map((xt,Zt)=>{var vn,on;return qt.createElement(Yz,{key:xt.id,icons:ie,index:Zt,toast:xt,defaultRichColors:L,duration:(vn=H?.duration)!=null?vn:z,className:H?.className,descriptionClassName:H?.descriptionClassName,invert:r,visibleToasts:K,closeButton:(on=H?.closeButton)!=null?on:v,interacting:gt,position:Fe,style:H?.style,unstyled:H?.unstyled,classNames:H?.classNames,cancelButtonStyle:H?.cancelButtonStyle,actionButtonStyle:H?.actionButtonStyle,removeToast:fe,toasts:Ce.filter(Sn=>Sn.position==xt.position),heights:et.filter(Sn=>Sn.position==xt.position),setHeights:Ie,expandByDefault:m,gap:Y,loadingIcon:ee,expanded:ot,pauseWhenPageIsHidden:xe,swipeDirections:t.swipeDirections})})):null}))});const eB=({...t})=>{const{theme:e="system"}=Cz();return _.jsx(Qz,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var tB=Ev[" useId ".trim().toString()]||(()=>{}),nB=0;function $c(t){const[e,r]=P.useState(tB());return Wi(()=>{r(l=>l??String(nB++))},[t]),e?`radix-${e}`:""}const rB=["top","right","bottom","left"],ph=Math.min,Ta=Math.max,Wx=Math.round,hx=Math.floor,Gc=t=>({x:t,y:t}),iB={left:"right",right:"left",bottom:"top",top:"bottom"},sB={start:"end",end:"start"};function gw(t,e,r){return Ta(t,ph(e,r))}function qu(t,e){return typeof t=="function"?t(e):t}function Zu(t){return t.split("-")[0]}function Xm(t){return t.split("-")[1]}function Lb(t){return t==="x"?"y":"x"}function jb(t){return t==="y"?"height":"width"}const oB=new Set(["top","bottom"]);function Uc(t){return oB.has(Zu(t))?"y":"x"}function Ob(t){return Lb(Uc(t))}function aB(t,e,r){r===void 0&&(r=!1);const l=Xm(t),u=Ob(t),m=jb(u);let v=u==="x"?l===(r?"end":"start")?"right":"left":l==="start"?"bottom":"top";return e.reference[m]>e.floating[m]&&(v=qx(v)),[v,qx(v)]}function lB(t){const e=qx(t);return[yw(t),e,yw(e)]}function yw(t){return t.replace(/start|end/g,e=>sB[e])}const xC=["left","right"],vC=["right","left"],cB=["top","bottom"],uB=["bottom","top"];function dB(t,e,r){switch(t){case"top":case"bottom":return r?e?vC:xC:e?xC:vC;case"left":case"right":return e?cB:uB;default:return[]}}function hB(t,e,r,l){const u=Xm(t);let m=dB(Zu(t),r==="start",l);return u&&(m=m.map(v=>v+"-"+u),e&&(m=m.concat(m.map(yw)))),m}function qx(t){return t.replace(/left|right|bottom|top/g,e=>iB[e])}function fB(t){return{top:0,right:0,bottom:0,left:0,...t}}function FM(t){return typeof t!="number"?fB(t):{top:t,right:t,bottom:t,left:t}}function Zx(t){const{x:e,y:r,width:l,height:u}=t;return{width:l,height:u,top:r,left:e,right:e+l,bottom:r+u,x:e,y:r}}function wC(t,e,r){let{reference:l,floating:u}=t;const m=Uc(e),v=Ob(e),b=jb(v),a=Zu(e),k=m==="y",M=l.x+l.width/2-u.width/2,L=l.y+l.height/2-u.height/2,z=l[b]/2-u[b]/2;let O;switch(a){case"top":O={x:M,y:l.y-u.height};break;case"bottom":O={x:M,y:l.y+l.height};break;case"right":O={x:l.x+l.width,y:L};break;case"left":O={x:l.x-u.width,y:L};break;default:O={x:l.x,y:l.y}}switch(Xm(e)){case"start":O[v]-=z*(r&&k?-1:1);break;case"end":O[v]+=z*(r&&k?-1:1);break}return O}const pB=async(t,e,r)=>{const{placement:l="bottom",strategy:u="absolute",middleware:m=[],platform:v}=r,b=m.filter(Boolean),a=await(v.isRTL==null?void 0:v.isRTL(e));let k=await v.getElementRects({reference:t,floating:e,strategy:u}),{x:M,y:L}=wC(k,l,a),z=l,O={},K=0;for(let H=0;H<b.length;H++){const{name:Z,fn:Y}=b[H],{x:ee,y:ie,data:pe,reset:xe}=await Y({x:M,y:L,initialPlacement:l,placement:z,strategy:u,middlewareData:O,rects:k,platform:v,elements:{reference:t,floating:e}});M=ee??M,L=ie??L,O={...O,[Z]:{...O[Z],...pe}},xe&&K<=50&&(K++,typeof xe=="object"&&(xe.placement&&(z=xe.placement),xe.rects&&(k=xe.rects===!0?await v.getElementRects({reference:t,floating:e,strategy:u}):xe.rects),{x:M,y:L}=wC(k,z,a)),H=-1)}return{x:M,y:L,placement:z,strategy:u,middlewareData:O}};async function My(t,e){var r;e===void 0&&(e={});const{x:l,y:u,platform:m,rects:v,elements:b,strategy:a}=t,{boundary:k="clippingAncestors",rootBoundary:M="viewport",elementContext:L="floating",altBoundary:z=!1,padding:O=0}=qu(e,t),K=FM(O),Z=b[z?L==="floating"?"reference":"floating":L],Y=Zx(await m.getClippingRect({element:(r=await(m.isElement==null?void 0:m.isElement(Z)))==null||r?Z:Z.contextElement||await(m.getDocumentElement==null?void 0:m.getDocumentElement(b.floating)),boundary:k,rootBoundary:M,strategy:a})),ee=L==="floating"?{x:l,y:u,width:v.floating.width,height:v.floating.height}:v.reference,ie=await(m.getOffsetParent==null?void 0:m.getOffsetParent(b.floating)),pe=await(m.isElement==null?void 0:m.isElement(ie))?await(m.getScale==null?void 0:m.getScale(ie))||{x:1,y:1}:{x:1,y:1},xe=Zx(m.convertOffsetParentRelativeRectToViewportRelativeRect?await m.convertOffsetParentRelativeRectToViewportRelativeRect({elements:b,rect:ee,offsetParent:ie,strategy:a}):ee);return{top:(Y.top-xe.top+K.top)/pe.y,bottom:(xe.bottom-Y.bottom+K.bottom)/pe.y,left:(Y.left-xe.left+K.left)/pe.x,right:(xe.right-Y.right+K.right)/pe.x}}const mB=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:l,placement:u,rects:m,platform:v,elements:b,middlewareData:a}=e,{element:k,padding:M=0}=qu(t,e)||{};if(k==null)return{};const L=FM(M),z={x:r,y:l},O=Ob(u),K=jb(O),H=await v.getDimensions(k),Z=O==="y",Y=Z?"top":"left",ee=Z?"bottom":"right",ie=Z?"clientHeight":"clientWidth",pe=m.reference[K]+m.reference[O]-z[O]-m.floating[K],xe=z[O]-m.reference[O],Ce=await(v.getOffsetParent==null?void 0:v.getOffsetParent(k));let je=Ce?Ce[ie]:0;(!je||!await(v.isElement==null?void 0:v.isElement(Ce)))&&(je=b.floating[ie]||m.floating[K]);const Ue=pe/2-xe/2,et=je/2-H[K]/2-1,Ie=ph(L[Y],et),ot=ph(L[ee],et),ut=Ie,gt=je-H[K]-ot,ft=je/2-H[K]/2+Ue,vt=gw(ut,ft,gt),st=!a.arrow&&Xm(u)!=null&&ft!==vt&&m.reference[K]/2-(ft<ut?Ie:ot)-H[K]/2<0,nt=st?ft<ut?ft-ut:ft-gt:0;return{[O]:z[O]+nt,data:{[O]:vt,centerOffset:ft-vt-nt,...st&&{alignmentOffset:nt}},reset:st}}}),gB=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,l;const{placement:u,middlewareData:m,rects:v,initialPlacement:b,platform:a,elements:k}=e,{mainAxis:M=!0,crossAxis:L=!0,fallbackPlacements:z,fallbackStrategy:O="bestFit",fallbackAxisSideDirection:K="none",flipAlignment:H=!0,...Z}=qu(t,e);if((r=m.arrow)!=null&&r.alignmentOffset)return{};const Y=Zu(u),ee=Uc(b),ie=Zu(b)===b,pe=await(a.isRTL==null?void 0:a.isRTL(k.floating)),xe=z||(ie||!H?[qx(b)]:lB(b)),Ce=K!=="none";!z&&Ce&&xe.push(...hB(b,H,K,pe));const je=[b,...xe],Ue=await My(e,Z),et=[];let Ie=((l=m.flip)==null?void 0:l.overflows)||[];if(M&&et.push(Ue[Y]),L){const ft=aB(u,v,pe);et.push(Ue[ft[0]],Ue[ft[1]])}if(Ie=[...Ie,{placement:u,overflows:et}],!et.every(ft=>ft<=0)){var ot,ut;const ft=(((ot=m.flip)==null?void 0:ot.index)||0)+1,vt=je[ft];if(vt&&(!(L==="alignment"?ee!==Uc(vt):!1)||Ie.every(ze=>Uc(ze.placement)===ee?ze.overflows[0]>0:!0)))return{data:{index:ft,overflows:Ie},reset:{placement:vt}};let st=(ut=Ie.filter(nt=>nt.overflows[0]<=0).sort((nt,ze)=>nt.overflows[1]-ze.overflows[1])[0])==null?void 0:ut.placement;if(!st)switch(O){case"bestFit":{var gt;const nt=(gt=Ie.filter(ze=>{if(Ce){const Se=Uc(ze.placement);return Se===ee||Se==="y"}return!0}).map(ze=>[ze.placement,ze.overflows.filter(Se=>Se>0).reduce((Se,We)=>Se+We,0)]).sort((ze,Se)=>ze[1]-Se[1])[0])==null?void 0:gt[0];nt&&(st=nt);break}case"initialPlacement":st=b;break}if(u!==st)return{reset:{placement:st}}}return{}}}};function bC(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function TC(t){return rB.some(e=>t[e]>=0)}const yB=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:l="referenceHidden",...u}=qu(t,e);switch(l){case"referenceHidden":{const m=await My(e,{...u,elementContext:"reference"}),v=bC(m,r.reference);return{data:{referenceHiddenOffsets:v,referenceHidden:TC(v)}}}case"escaped":{const m=await My(e,{...u,altBoundary:!0}),v=bC(m,r.floating);return{data:{escapedOffsets:v,escaped:TC(v)}}}default:return{}}}}},VM=new Set(["left","top"]);async function _B(t,e){const{placement:r,platform:l,elements:u}=t,m=await(l.isRTL==null?void 0:l.isRTL(u.floating)),v=Zu(r),b=Xm(r),a=Uc(r)==="y",k=VM.has(v)?-1:1,M=m&&a?-1:1,L=qu(e,t);let{mainAxis:z,crossAxis:O,alignmentAxis:K}=typeof L=="number"?{mainAxis:L,crossAxis:0,alignmentAxis:null}:{mainAxis:L.mainAxis||0,crossAxis:L.crossAxis||0,alignmentAxis:L.alignmentAxis};return b&&typeof K=="number"&&(O=b==="end"?K*-1:K),a?{x:O*M,y:z*k}:{x:z*k,y:O*M}}const xB=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,l;const{x:u,y:m,placement:v,middlewareData:b}=e,a=await _B(e,t);return v===((r=b.offset)==null?void 0:r.placement)&&(l=b.arrow)!=null&&l.alignmentOffset?{}:{x:u+a.x,y:m+a.y,data:{...a,placement:v}}}}},vB=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:l,placement:u}=e,{mainAxis:m=!0,crossAxis:v=!1,limiter:b={fn:Z=>{let{x:Y,y:ee}=Z;return{x:Y,y:ee}}},...a}=qu(t,e),k={x:r,y:l},M=await My(e,a),L=Uc(Zu(u)),z=Lb(L);let O=k[z],K=k[L];if(m){const Z=z==="y"?"top":"left",Y=z==="y"?"bottom":"right",ee=O+M[Z],ie=O-M[Y];O=gw(ee,O,ie)}if(v){const Z=L==="y"?"top":"left",Y=L==="y"?"bottom":"right",ee=K+M[Z],ie=K-M[Y];K=gw(ee,K,ie)}const H=b.fn({...e,[z]:O,[L]:K});return{...H,data:{x:H.x-r,y:H.y-l,enabled:{[z]:m,[L]:v}}}}}},wB=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:l,placement:u,rects:m,middlewareData:v}=e,{offset:b=0,mainAxis:a=!0,crossAxis:k=!0}=qu(t,e),M={x:r,y:l},L=Uc(u),z=Lb(L);let O=M[z],K=M[L];const H=qu(b,e),Z=typeof H=="number"?{mainAxis:H,crossAxis:0}:{mainAxis:0,crossAxis:0,...H};if(a){const ie=z==="y"?"height":"width",pe=m.reference[z]-m.floating[ie]+Z.mainAxis,xe=m.reference[z]+m.reference[ie]-Z.mainAxis;O<pe?O=pe:O>xe&&(O=xe)}if(k){var Y,ee;const ie=z==="y"?"width":"height",pe=VM.has(Zu(u)),xe=m.reference[L]-m.floating[ie]+(pe&&((Y=v.offset)==null?void 0:Y[L])||0)+(pe?0:Z.crossAxis),Ce=m.reference[L]+m.reference[ie]+(pe?0:((ee=v.offset)==null?void 0:ee[L])||0)-(pe?Z.crossAxis:0);K<xe?K=xe:K>Ce&&(K=Ce)}return{[z]:O,[L]:K}}}},bB=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,l;const{placement:u,rects:m,platform:v,elements:b}=e,{apply:a=()=>{},...k}=qu(t,e),M=await My(e,k),L=Zu(u),z=Xm(u),O=Uc(u)==="y",{width:K,height:H}=m.floating;let Z,Y;L==="top"||L==="bottom"?(Z=L,Y=z===(await(v.isRTL==null?void 0:v.isRTL(b.floating))?"start":"end")?"left":"right"):(Y=L,Z=z==="end"?"top":"bottom");const ee=H-M.top-M.bottom,ie=K-M.left-M.right,pe=ph(H-M[Z],ee),xe=ph(K-M[Y],ie),Ce=!e.middlewareData.shift;let je=pe,Ue=xe;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(Ue=ie),(l=e.middlewareData.shift)!=null&&l.enabled.y&&(je=ee),Ce&&!z){const Ie=Ta(M.left,0),ot=Ta(M.right,0),ut=Ta(M.top,0),gt=Ta(M.bottom,0);O?Ue=K-2*(Ie!==0||ot!==0?Ie+ot:Ta(M.left,M.right)):je=H-2*(ut!==0||gt!==0?ut+gt:Ta(M.top,M.bottom))}await a({...e,availableWidth:Ue,availableHeight:je});const et=await v.getDimensions(b.floating);return K!==et.width||H!==et.height?{reset:{rects:!0}}:{}}}};function Nv(){return typeof window<"u"}function Km(t){return UM(t)?(t.nodeName||"").toLowerCase():"#document"}function Ea(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Yc(t){var e;return(e=(UM(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function UM(t){return Nv()?t instanceof Node||t instanceof Ea(t).Node:!1}function Gl(t){return Nv()?t instanceof Element||t instanceof Ea(t).Element:!1}function Xc(t){return Nv()?t instanceof HTMLElement||t instanceof Ea(t).HTMLElement:!1}function SC(t){return!Nv()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ea(t).ShadowRoot}const TB=new Set(["inline","contents"]);function n_(t){const{overflow:e,overflowX:r,overflowY:l,display:u}=Hl(t);return/auto|scroll|overlay|hidden|clip/.test(e+l+r)&&!TB.has(u)}const SB=new Set(["table","td","th"]);function EB(t){return SB.has(Km(t))}const CB=[":popover-open",":modal"];function Rv(t){return CB.some(e=>{try{return t.matches(e)}catch{return!1}})}const kB=["transform","translate","scale","rotate","perspective"],AB=["transform","translate","scale","rotate","perspective","filter"],IB=["paint","layout","strict","content"];function zb(t){const e=Bb(),r=Gl(t)?Hl(t):t;return kB.some(l=>r[l]?r[l]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||AB.some(l=>(r.willChange||"").includes(l))||IB.some(l=>(r.contain||"").includes(l))}function MB(t){let e=mh(t);for(;Xc(e)&&!Lm(e);){if(zb(e))return e;if(Rv(e))return null;e=mh(e)}return null}function Bb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const PB=new Set(["html","body","#document"]);function Lm(t){return PB.has(Km(t))}function Hl(t){return Ea(t).getComputedStyle(t)}function Dv(t){return Gl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function mh(t){if(Km(t)==="html")return t;const e=t.assignedSlot||t.parentNode||SC(t)&&t.host||Yc(t);return SC(e)?e.host:e}function $M(t){const e=mh(t);return Lm(e)?t.ownerDocument?t.ownerDocument.body:t.body:Xc(e)&&n_(e)?e:$M(e)}function Py(t,e,r){var l;e===void 0&&(e=[]),r===void 0&&(r=!0);const u=$M(t),m=u===((l=t.ownerDocument)==null?void 0:l.body),v=Ea(u);if(m){const b=_w(v);return e.concat(v,v.visualViewport||[],n_(u)?u:[],b&&r?Py(b):[])}return e.concat(u,Py(u,[],r))}function _w(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function GM(t){const e=Hl(t);let r=parseFloat(e.width)||0,l=parseFloat(e.height)||0;const u=Xc(t),m=u?t.offsetWidth:r,v=u?t.offsetHeight:l,b=Wx(r)!==m||Wx(l)!==v;return b&&(r=m,l=v),{width:r,height:l,$:b}}function Fb(t){return Gl(t)?t:t.contextElement}function Cm(t){const e=Fb(t);if(!Xc(e))return Gc(1);const r=e.getBoundingClientRect(),{width:l,height:u,$:m}=GM(e);let v=(m?Wx(r.width):r.width)/l,b=(m?Wx(r.height):r.height)/u;return(!v||!Number.isFinite(v))&&(v=1),(!b||!Number.isFinite(b))&&(b=1),{x:v,y:b}}const NB=Gc(0);function HM(t){const e=Ea(t);return!Bb()||!e.visualViewport?NB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function RB(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ea(t)?!1:e}function Zf(t,e,r,l){e===void 0&&(e=!1),r===void 0&&(r=!1);const u=t.getBoundingClientRect(),m=Fb(t);let v=Gc(1);e&&(l?Gl(l)&&(v=Cm(l)):v=Cm(t));const b=RB(m,r,l)?HM(m):Gc(0);let a=(u.left+b.x)/v.x,k=(u.top+b.y)/v.y,M=u.width/v.x,L=u.height/v.y;if(m){const z=Ea(m),O=l&&Gl(l)?Ea(l):l;let K=z,H=_w(K);for(;H&&l&&O!==K;){const Z=Cm(H),Y=H.getBoundingClientRect(),ee=Hl(H),ie=Y.left+(H.clientLeft+parseFloat(ee.paddingLeft))*Z.x,pe=Y.top+(H.clientTop+parseFloat(ee.paddingTop))*Z.y;a*=Z.x,k*=Z.y,M*=Z.x,L*=Z.y,a+=ie,k+=pe,K=Ea(H),H=_w(K)}}return Zx({width:M,height:L,x:a,y:k})}function Lv(t,e){const r=Dv(t).scrollLeft;return e?e.left+r:Zf(Yc(t)).left+r}function WM(t,e){const r=t.getBoundingClientRect(),l=r.left+e.scrollLeft-Lv(t,r),u=r.top+e.scrollTop;return{x:l,y:u}}function DB(t){let{elements:e,rect:r,offsetParent:l,strategy:u}=t;const m=u==="fixed",v=Yc(l),b=e?Rv(e.floating):!1;if(l===v||b&&m)return r;let a={scrollLeft:0,scrollTop:0},k=Gc(1);const M=Gc(0),L=Xc(l);if((L||!L&&!m)&&((Km(l)!=="body"||n_(v))&&(a=Dv(l)),Xc(l))){const O=Zf(l);k=Cm(l),M.x=O.x+l.clientLeft,M.y=O.y+l.clientTop}const z=v&&!L&&!m?WM(v,a):Gc(0);return{width:r.width*k.x,height:r.height*k.y,x:r.x*k.x-a.scrollLeft*k.x+M.x+z.x,y:r.y*k.y-a.scrollTop*k.y+M.y+z.y}}function LB(t){return Array.from(t.getClientRects())}function jB(t){const e=Yc(t),r=Dv(t),l=t.ownerDocument.body,u=Ta(e.scrollWidth,e.clientWidth,l.scrollWidth,l.clientWidth),m=Ta(e.scrollHeight,e.clientHeight,l.scrollHeight,l.clientHeight);let v=-r.scrollLeft+Lv(t);const b=-r.scrollTop;return Hl(l).direction==="rtl"&&(v+=Ta(e.clientWidth,l.clientWidth)-u),{width:u,height:m,x:v,y:b}}const EC=25;function OB(t,e){const r=Ea(t),l=Yc(t),u=r.visualViewport;let m=l.clientWidth,v=l.clientHeight,b=0,a=0;if(u){m=u.width,v=u.height;const M=Bb();(!M||M&&e==="fixed")&&(b=u.offsetLeft,a=u.offsetTop)}const k=Lv(l);if(k<=0){const M=l.ownerDocument,L=M.body,z=getComputedStyle(L),O=M.compatMode==="CSS1Compat"&&parseFloat(z.marginLeft)+parseFloat(z.marginRight)||0,K=Math.abs(l.clientWidth-L.clientWidth-O);K<=EC&&(m-=K)}else k<=EC&&(m+=k);return{width:m,height:v,x:b,y:a}}const zB=new Set(["absolute","fixed"]);function BB(t,e){const r=Zf(t,!0,e==="fixed"),l=r.top+t.clientTop,u=r.left+t.clientLeft,m=Xc(t)?Cm(t):Gc(1),v=t.clientWidth*m.x,b=t.clientHeight*m.y,a=u*m.x,k=l*m.y;return{width:v,height:b,x:a,y:k}}function CC(t,e,r){let l;if(e==="viewport")l=OB(t,r);else if(e==="document")l=jB(Yc(t));else if(Gl(e))l=BB(e,r);else{const u=HM(t);l={x:e.x-u.x,y:e.y-u.y,width:e.width,height:e.height}}return Zx(l)}function qM(t,e){const r=mh(t);return r===e||!Gl(r)||Lm(r)?!1:Hl(r).position==="fixed"||qM(r,e)}function FB(t,e){const r=e.get(t);if(r)return r;let l=Py(t,[],!1).filter(b=>Gl(b)&&Km(b)!=="body"),u=null;const m=Hl(t).position==="fixed";let v=m?mh(t):t;for(;Gl(v)&&!Lm(v);){const b=Hl(v),a=zb(v);!a&&b.position==="fixed"&&(u=null),(m?!a&&!u:!a&&b.position==="static"&&!!u&&zB.has(u.position)||n_(v)&&!a&&qM(t,v))?l=l.filter(M=>M!==v):u=b,v=mh(v)}return e.set(t,l),l}function VB(t){let{element:e,boundary:r,rootBoundary:l,strategy:u}=t;const v=[...r==="clippingAncestors"?Rv(e)?[]:FB(e,this._c):[].concat(r),l],b=v[0],a=v.reduce((k,M)=>{const L=CC(e,M,u);return k.top=Ta(L.top,k.top),k.right=ph(L.right,k.right),k.bottom=ph(L.bottom,k.bottom),k.left=Ta(L.left,k.left),k},CC(e,b,u));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function UB(t){const{width:e,height:r}=GM(t);return{width:e,height:r}}function $B(t,e,r){const l=Xc(e),u=Yc(e),m=r==="fixed",v=Zf(t,!0,m,e);let b={scrollLeft:0,scrollTop:0};const a=Gc(0);function k(){a.x=Lv(u)}if(l||!l&&!m)if((Km(e)!=="body"||n_(u))&&(b=Dv(e)),l){const O=Zf(e,!0,m,e);a.x=O.x+e.clientLeft,a.y=O.y+e.clientTop}else u&&k();m&&!l&&u&&k();const M=u&&!l&&!m?WM(u,b):Gc(0),L=v.left+b.scrollLeft-a.x-M.x,z=v.top+b.scrollTop-a.y-M.y;return{x:L,y:z,width:v.width,height:v.height}}function x1(t){return Hl(t).position==="static"}function kC(t,e){if(!Xc(t)||Hl(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Yc(t)===r&&(r=r.ownerDocument.body),r}function ZM(t,e){const r=Ea(t);if(Rv(t))return r;if(!Xc(t)){let u=mh(t);for(;u&&!Lm(u);){if(Gl(u)&&!x1(u))return u;u=mh(u)}return r}let l=kC(t,e);for(;l&&EB(l)&&x1(l);)l=kC(l,e);return l&&Lm(l)&&x1(l)&&!zb(l)?r:l||MB(t)||r}const GB=async function(t){const e=this.getOffsetParent||ZM,r=this.getDimensions,l=await r(t.floating);return{reference:$B(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:l.width,height:l.height}}};function HB(t){return Hl(t).direction==="rtl"}const WB={convertOffsetParentRelativeRectToViewportRelativeRect:DB,getDocumentElement:Yc,getClippingRect:VB,getOffsetParent:ZM,getElementRects:GB,getClientRects:LB,getDimensions:UB,getScale:Cm,isElement:Gl,isRTL:HB};function XM(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function qB(t,e){let r=null,l;const u=Yc(t);function m(){var b;clearTimeout(l),(b=r)==null||b.disconnect(),r=null}function v(b,a){b===void 0&&(b=!1),a===void 0&&(a=1),m();const k=t.getBoundingClientRect(),{left:M,top:L,width:z,height:O}=k;if(b||e(),!z||!O)return;const K=hx(L),H=hx(u.clientWidth-(M+z)),Z=hx(u.clientHeight-(L+O)),Y=hx(M),ie={rootMargin:-K+"px "+-H+"px "+-Z+"px "+-Y+"px",threshold:Ta(0,ph(1,a))||1};let pe=!0;function xe(Ce){const je=Ce[0].intersectionRatio;if(je!==a){if(!pe)return v();je?v(!1,je):l=setTimeout(()=>{v(!1,1e-7)},1e3)}je===1&&!XM(k,t.getBoundingClientRect())&&v(),pe=!1}try{r=new IntersectionObserver(xe,{...ie,root:u.ownerDocument})}catch{r=new IntersectionObserver(xe,ie)}r.observe(t)}return v(!0),m}function ZB(t,e,r,l){l===void 0&&(l={});const{ancestorScroll:u=!0,ancestorResize:m=!0,elementResize:v=typeof ResizeObserver=="function",layoutShift:b=typeof IntersectionObserver=="function",animationFrame:a=!1}=l,k=Fb(t),M=u||m?[...k?Py(k):[],...Py(e)]:[];M.forEach(Y=>{u&&Y.addEventListener("scroll",r,{passive:!0}),m&&Y.addEventListener("resize",r)});const L=k&&b?qB(k,r):null;let z=-1,O=null;v&&(O=new ResizeObserver(Y=>{let[ee]=Y;ee&&ee.target===k&&O&&(O.unobserve(e),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var ie;(ie=O)==null||ie.observe(e)})),r()}),k&&!a&&O.observe(k),O.observe(e));let K,H=a?Zf(t):null;a&&Z();function Z(){const Y=Zf(t);H&&!XM(H,Y)&&r(),H=Y,K=requestAnimationFrame(Z)}return r(),()=>{var Y;M.forEach(ee=>{u&&ee.removeEventListener("scroll",r),m&&ee.removeEventListener("resize",r)}),L?.(),(Y=O)==null||Y.disconnect(),O=null,a&&cancelAnimationFrame(K)}}const XB=xB,KB=vB,YB=gB,JB=bB,QB=yB,AC=mB,eF=wB,tF=(t,e,r)=>{const l=new Map,u={platform:WB,...r},m={...u.platform,_c:l};return pB(t,e,{...u,platform:m})};var nF=typeof document<"u",rF=function(){},Px=nF?P.useLayoutEffect:rF;function Xx(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,l,u;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(l=r;l--!==0;)if(!Xx(t[l],e[l]))return!1;return!0}if(u=Object.keys(t),r=u.length,r!==Object.keys(e).length)return!1;for(l=r;l--!==0;)if(!{}.hasOwnProperty.call(e,u[l]))return!1;for(l=r;l--!==0;){const m=u[l];if(!(m==="_owner"&&t.$$typeof)&&!Xx(t[m],e[m]))return!1}return!0}return t!==t&&e!==e}function KM(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function IC(t,e){const r=KM(t);return Math.round(e*r)/r}function v1(t){const e=P.useRef(t);return Px(()=>{e.current=t}),e}function iF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:l=[],platform:u,elements:{reference:m,floating:v}={},transform:b=!0,whileElementsMounted:a,open:k}=t,[M,L]=P.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[z,O]=P.useState(l);Xx(z,l)||O(l);const[K,H]=P.useState(null),[Z,Y]=P.useState(null),ee=P.useCallback(ze=>{ze!==Ce.current&&(Ce.current=ze,H(ze))},[]),ie=P.useCallback(ze=>{ze!==je.current&&(je.current=ze,Y(ze))},[]),pe=m||K,xe=v||Z,Ce=P.useRef(null),je=P.useRef(null),Ue=P.useRef(M),et=a!=null,Ie=v1(a),ot=v1(u),ut=v1(k),gt=P.useCallback(()=>{if(!Ce.current||!je.current)return;const ze={placement:e,strategy:r,middleware:z};ot.current&&(ze.platform=ot.current),tF(Ce.current,je.current,ze).then(Se=>{const We={...Se,isPositioned:ut.current!==!1};ft.current&&!Xx(Ue.current,We)&&(Ue.current=We,vh.flushSync(()=>{L(We)}))})},[z,e,r,ot,ut]);Px(()=>{k===!1&&Ue.current.isPositioned&&(Ue.current.isPositioned=!1,L(ze=>({...ze,isPositioned:!1})))},[k]);const ft=P.useRef(!1);Px(()=>(ft.current=!0,()=>{ft.current=!1}),[]),Px(()=>{if(pe&&(Ce.current=pe),xe&&(je.current=xe),pe&&xe){if(Ie.current)return Ie.current(pe,xe,gt);gt()}},[pe,xe,gt,Ie,et]);const vt=P.useMemo(()=>({reference:Ce,floating:je,setReference:ee,setFloating:ie}),[ee,ie]),st=P.useMemo(()=>({reference:pe,floating:xe}),[pe,xe]),nt=P.useMemo(()=>{const ze={position:r,left:0,top:0};if(!st.floating)return ze;const Se=IC(st.floating,M.x),We=IC(st.floating,M.y);return b?{...ze,transform:"translate("+Se+"px, "+We+"px)",...KM(st.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:Se,top:We}},[r,b,st.floating,M.x,M.y]);return P.useMemo(()=>({...M,update:gt,refs:vt,elements:st,floatingStyles:nt}),[M,gt,vt,st,nt])}const sF=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:l,padding:u}=typeof t=="function"?t(r):t;return l&&e(l)?l.current!=null?AC({element:l.current,padding:u}).fn(r):{}:l?AC({element:l,padding:u}).fn(r):{}}}},oF=(t,e)=>({...XB(t),options:[t,e]}),aF=(t,e)=>({...KB(t),options:[t,e]}),lF=(t,e)=>({...eF(t),options:[t,e]}),cF=(t,e)=>({...YB(t),options:[t,e]}),uF=(t,e)=>({...JB(t),options:[t,e]}),dF=(t,e)=>({...QB(t),options:[t,e]}),hF=(t,e)=>({...sF(t),options:[t,e]});var fF="Arrow",YM=P.forwardRef((t,e)=>{const{children:r,width:l=10,height:u=5,...m}=t;return _.jsx(Mn.svg,{...m,ref:e,width:l,height:u,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:_.jsx("polygon",{points:"0,0 30,0 15,10"})})});YM.displayName=fF;var pF=YM;function JM(t){const[e,r]=P.useState(void 0);return Wi(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const l=new ResizeObserver(u=>{if(!Array.isArray(u)||!u.length)return;const m=u[0];let v,b;if("borderBoxSize"in m){const a=m.borderBoxSize,k=Array.isArray(a)?a[0]:a;v=k.inlineSize,b=k.blockSize}else v=t.offsetWidth,b=t.offsetHeight;r({width:v,height:b})});return l.observe(t,{box:"border-box"}),()=>l.unobserve(t)}else r(void 0)},[t]),e}var Vb="Popper",[QM,Ym]=sl(Vb),[mF,eP]=QM(Vb),tP=t=>{const{__scopePopper:e,children:r}=t,[l,u]=P.useState(null);return _.jsx(mF,{scope:e,anchor:l,onAnchorChange:u,children:r})};tP.displayName=Vb;var nP="PopperAnchor",rP=P.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:l,...u}=t,m=eP(nP,r),v=P.useRef(null),b=or(e,v),a=P.useRef(null);return P.useEffect(()=>{const k=a.current;a.current=l?.current||v.current,k!==a.current&&m.onAnchorChange(a.current)}),l?null:_.jsx(Mn.div,{...u,ref:b})});rP.displayName=nP;var Ub="PopperContent",[gF,yF]=QM(Ub),iP=P.forwardRef((t,e)=>{const{__scopePopper:r,side:l="bottom",sideOffset:u=0,align:m="center",alignOffset:v=0,arrowPadding:b=0,avoidCollisions:a=!0,collisionBoundary:k=[],collisionPadding:M=0,sticky:L="partial",hideWhenDetached:z=!1,updatePositionStrategy:O="optimized",onPlaced:K,...H}=t,Z=eP(Ub,r),[Y,ee]=P.useState(null),ie=or(e,xt=>ee(xt)),[pe,xe]=P.useState(null),Ce=JM(pe),je=Ce?.width??0,Ue=Ce?.height??0,et=l+(m!=="center"?"-"+m:""),Ie=typeof M=="number"?M:{top:0,right:0,bottom:0,left:0,...M},ot=Array.isArray(k)?k:[k],ut=ot.length>0,gt={padding:Ie,boundary:ot.filter(xF),altBoundary:ut},{refs:ft,floatingStyles:vt,placement:st,isPositioned:nt,middlewareData:ze}=iF({strategy:"fixed",placement:et,whileElementsMounted:(...xt)=>ZB(...xt,{animationFrame:O==="always"}),elements:{reference:Z.anchor},middleware:[oF({mainAxis:u+Ue,alignmentAxis:v}),a&&aF({mainAxis:!0,crossAxis:!1,limiter:L==="partial"?lF():void 0,...gt}),a&&cF({...gt}),uF({...gt,apply:({elements:xt,rects:Zt,availableWidth:vn,availableHeight:on})=>{const{width:Sn,height:Yt}=Zt.reference,nr=xt.floating.style;nr.setProperty("--radix-popper-available-width",`${vn}px`),nr.setProperty("--radix-popper-available-height",`${on}px`),nr.setProperty("--radix-popper-anchor-width",`${Sn}px`),nr.setProperty("--radix-popper-anchor-height",`${Yt}px`)}}),pe&&hF({element:pe,padding:b}),vF({arrowWidth:je,arrowHeight:Ue}),z&&dF({strategy:"referenceHidden",...gt})]}),[Se,We]=aP(st),fe=Ui(K);Wi(()=>{nt&&fe?.()},[nt,fe]);const Fe=ze.arrow?.x,lt=ze.arrow?.y,Tt=ze.arrow?.centerOffset!==0,[Kt,sn]=P.useState();return Wi(()=>{Y&&sn(window.getComputedStyle(Y).zIndex)},[Y]),_.jsx("div",{ref:ft.setFloating,"data-radix-popper-content-wrapper":"",style:{...vt,transform:nt?vt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Kt,"--radix-popper-transform-origin":[ze.transformOrigin?.x,ze.transformOrigin?.y].join(" "),...ze.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:_.jsx(gF,{scope:r,placedSide:Se,onArrowChange:xe,arrowX:Fe,arrowY:lt,shouldHideArrow:Tt,children:_.jsx(Mn.div,{"data-side":Se,"data-align":We,...H,ref:ie,style:{...H.style,animation:nt?void 0:"none"}})})})});iP.displayName=Ub;var sP="PopperArrow",_F={top:"bottom",right:"left",bottom:"top",left:"right"},oP=P.forwardRef(function(e,r){const{__scopePopper:l,...u}=e,m=yF(sP,l),v=_F[m.placedSide];return _.jsx("span",{ref:m.onArrowChange,style:{position:"absolute",left:m.arrowX,top:m.arrowY,[v]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[m.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[m.placedSide],visibility:m.shouldHideArrow?"hidden":void 0},children:_.jsx(pF,{...u,ref:r,style:{...u.style,display:"block"}})})});oP.displayName=sP;function xF(t){return t!==null}var vF=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:l,middlewareData:u}=e,v=u.arrow?.centerOffset!==0,b=v?0:t.arrowWidth,a=v?0:t.arrowHeight,[k,M]=aP(r),L={start:"0%",center:"50%",end:"100%"}[M],z=(u.arrow?.x??0)+b/2,O=(u.arrow?.y??0)+a/2;let K="",H="";return k==="bottom"?(K=v?L:`${z}px`,H=`${-a}px`):k==="top"?(K=v?L:`${z}px`,H=`${l.floating.height+a}px`):k==="right"?(K=`${-a}px`,H=v?L:`${O}px`):k==="left"&&(K=`${l.floating.width+a}px`,H=v?L:`${O}px`),{data:{x:K,y:H}}}});function aP(t){const[e,r="center"]=t.split("-");return[e,r]}var lP=tP,$b=rP,Gb=iP,Hb=oP,wF=Symbol("radix.slottable");function bF(t){const e=({children:r})=>_.jsx(_.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=wF,e}var[jv]=sl("Tooltip",[Ym]),Wb=Ym(),cP="TooltipProvider",TF=700,MC="tooltip.open",[SF,uP]=jv(cP),dP=t=>{const{__scopeTooltip:e,delayDuration:r=TF,skipDelayDuration:l=300,disableHoverableContent:u=!1,children:m}=t,v=P.useRef(!0),b=P.useRef(!1),a=P.useRef(0);return P.useEffect(()=>{const k=a.current;return()=>window.clearTimeout(k)},[]),_.jsx(SF,{scope:e,isOpenDelayedRef:v,delayDuration:r,onOpen:P.useCallback(()=>{window.clearTimeout(a.current),v.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(()=>v.current=!0,l)},[l]),isPointerInTransitRef:b,onPointerInTransitChange:P.useCallback(k=>{b.current=k},[]),disableHoverableContent:u,children:m})};dP.displayName=cP;var hP="Tooltip",[YJ,Ov]=jv(hP),xw="TooltipTrigger",EF=P.forwardRef((t,e)=>{const{__scopeTooltip:r,...l}=t,u=Ov(xw,r),m=uP(xw,r),v=Wb(r),b=P.useRef(null),a=or(e,b,u.onTriggerChange),k=P.useRef(!1),M=P.useRef(!1),L=P.useCallback(()=>k.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",L),[L]),_.jsx($b,{asChild:!0,...v,children:_.jsx(Mn.button,{"aria-describedby":u.open?u.contentId:void 0,"data-state":u.stateAttribute,...l,ref:a,onPointerMove:Xt(t.onPointerMove,z=>{z.pointerType!=="touch"&&!M.current&&!m.isPointerInTransitRef.current&&(u.onTriggerEnter(),M.current=!0)}),onPointerLeave:Xt(t.onPointerLeave,()=>{u.onTriggerLeave(),M.current=!1}),onPointerDown:Xt(t.onPointerDown,()=>{u.open&&u.onClose(),k.current=!0,document.addEventListener("pointerup",L,{once:!0})}),onFocus:Xt(t.onFocus,()=>{k.current||u.onOpen()}),onBlur:Xt(t.onBlur,u.onClose),onClick:Xt(t.onClick,u.onClose)})})});EF.displayName=xw;var CF="TooltipPortal",[JJ,kF]=jv(CF,{forceMount:void 0}),jm="TooltipContent",fP=P.forwardRef((t,e)=>{const r=kF(jm,t.__scopeTooltip),{forceMount:l=r.forceMount,side:u="top",...m}=t,v=Ov(jm,t.__scopeTooltip);return _.jsx(zo,{present:l||v.open,children:v.disableHoverableContent?_.jsx(pP,{side:u,...m,ref:e}):_.jsx(AF,{side:u,...m,ref:e})})}),AF=P.forwardRef((t,e)=>{const r=Ov(jm,t.__scopeTooltip),l=uP(jm,t.__scopeTooltip),u=P.useRef(null),m=or(e,u),[v,b]=P.useState(null),{trigger:a,onClose:k}=r,M=u.current,{onPointerInTransitChange:L}=l,z=P.useCallback(()=>{b(null),L(!1)},[L]),O=P.useCallback((K,H)=>{const Z=K.currentTarget,Y={x:K.clientX,y:K.clientY},ee=RF(Y,Z.getBoundingClientRect()),ie=DF(Y,ee),pe=LF(H.getBoundingClientRect()),xe=OF([...ie,...pe]);b(xe),L(!0)},[L]);return P.useEffect(()=>()=>z(),[z]),P.useEffect(()=>{if(a&&M){const K=Z=>O(Z,M),H=Z=>O(Z,a);return a.addEventListener("pointerleave",K),M.addEventListener("pointerleave",H),()=>{a.removeEventListener("pointerleave",K),M.removeEventListener("pointerleave",H)}}},[a,M,O,z]),P.useEffect(()=>{if(v){const K=H=>{const Z=H.target,Y={x:H.clientX,y:H.clientY},ee=a?.contains(Z)||M?.contains(Z),ie=!jF(Y,v);ee?z():ie&&(z(),k())};return document.addEventListener("pointermove",K),()=>document.removeEventListener("pointermove",K)}},[a,M,v,k,z]),_.jsx(pP,{...t,ref:m})}),[IF,MF]=jv(hP,{isInside:!1}),PF=bF("TooltipContent"),pP=P.forwardRef((t,e)=>{const{__scopeTooltip:r,children:l,"aria-label":u,onEscapeKeyDown:m,onPointerDownOutside:v,...b}=t,a=Ov(jm,r),k=Wb(r),{onClose:M}=a;return P.useEffect(()=>(document.addEventListener(MC,M),()=>document.removeEventListener(MC,M)),[M]),P.useEffect(()=>{if(a.trigger){const L=z=>{z.target?.contains(a.trigger)&&M()};return window.addEventListener("scroll",L,{capture:!0}),()=>window.removeEventListener("scroll",L,{capture:!0})}},[a.trigger,M]),_.jsx(Wm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:m,onPointerDownOutside:v,onFocusOutside:L=>L.preventDefault(),onDismiss:M,children:_.jsxs(Gb,{"data-state":a.stateAttribute,...k,...b,ref:e,style:{...b.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[_.jsx(PF,{children:l}),_.jsx(IF,{scope:r,isInside:!0,children:_.jsx(Zj,{id:a.contentId,role:"tooltip",children:u||l})})]})})});fP.displayName=jm;var mP="TooltipArrow",NF=P.forwardRef((t,e)=>{const{__scopeTooltip:r,...l}=t,u=Wb(r);return MF(mP,r).isInside?null:_.jsx(Hb,{...u,...l,ref:e})});NF.displayName=mP;function RF(t,e){const r=Math.abs(e.top-t.y),l=Math.abs(e.bottom-t.y),u=Math.abs(e.right-t.x),m=Math.abs(e.left-t.x);switch(Math.min(r,l,u,m)){case m:return"left";case u:return"right";case r:return"top";case l:return"bottom";default:throw new Error("unreachable")}}function DF(t,e,r=5){const l=[];switch(e){case"top":l.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":l.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":l.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":l.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return l}function LF(t){const{top:e,right:r,bottom:l,left:u}=t;return[{x:u,y:e},{x:r,y:e},{x:r,y:l},{x:u,y:l}]}function jF(t,e){const{x:r,y:l}=t;let u=!1;for(let m=0,v=e.length-1;m<e.length;v=m++){const b=e[m],a=e[v],k=b.x,M=b.y,L=a.x,z=a.y;M>l!=z>l&&r<(L-k)*(l-M)/(z-M)+k&&(u=!u)}return u}function OF(t){const e=t.slice();return e.sort((r,l)=>r.x<l.x?-1:r.x>l.x?1:r.y<l.y?-1:r.y>l.y?1:0),zF(e)}function zF(t){if(t.length<=1)return t.slice();const e=[];for(let l=0;l<t.length;l++){const u=t[l];for(;e.length>=2;){const m=e[e.length-1],v=e[e.length-2];if((m.x-v.x)*(u.y-v.y)>=(m.y-v.y)*(u.x-v.x))e.pop();else break}e.push(u)}e.pop();const r=[];for(let l=t.length-1;l>=0;l--){const u=t[l];for(;r.length>=2;){const m=r[r.length-1],v=r[r.length-2];if((m.x-v.x)*(u.y-v.y)>=(m.y-v.y)*(u.x-v.x))r.pop();else break}r.push(u)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var BF=dP,gP=fP;const FF=BF,VF=P.forwardRef(({className:t,sideOffset:e=4,...r},l)=>_.jsx(gP,{ref:l,sideOffset:e,className:cn("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));VF.displayName=gP.displayName;var Jm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},UF={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},$F=class{#e=UF;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Ff=new $F;function GF(t){setTimeout(t,0)}var Xf=typeof window>"u"||"Deno"in globalThis;function Do(){}function HF(t,e){return typeof t=="function"?t(e):t}function vw(t){return typeof t=="number"&&t>=0&&t!==1/0}function yP(t,e){return Math.max(t+(e||0)-Date.now(),0)}function ch(t,e){return typeof t=="function"?t(e):t}function el(t,e){return typeof t=="function"?t(e):t}function PC(t,e){const{type:r="all",exact:l,fetchStatus:u,predicate:m,queryKey:v,stale:b}=t;if(v){if(l){if(e.queryHash!==qb(v,e.options))return!1}else if(!Ny(e.queryKey,v))return!1}if(r!=="all"){const a=e.isActive();if(r==="active"&&!a||r==="inactive"&&a)return!1}return!(typeof b=="boolean"&&e.isStale()!==b||u&&u!==e.state.fetchStatus||m&&!m(e))}function NC(t,e){const{exact:r,status:l,predicate:u,mutationKey:m}=t;if(m){if(!e.options.mutationKey)return!1;if(r){if(Kf(e.options.mutationKey)!==Kf(m))return!1}else if(!Ny(e.options.mutationKey,m))return!1}return!(l&&e.state.status!==l||u&&!u(e))}function qb(t,e){return(e?.queryKeyHashFn||Kf)(t)}function Kf(t){return JSON.stringify(t,(e,r)=>ww(r)?Object.keys(r).sort().reduce((l,u)=>(l[u]=r[u],l),{}):r)}function Ny(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>Ny(t[r],e[r])):!1}var WF=Object.prototype.hasOwnProperty;function _P(t,e,r=0){if(t===e)return t;if(r>500)return e;const l=RC(t)&&RC(e);if(!l&&!(ww(t)&&ww(e)))return e;const m=(l?t:Object.keys(t)).length,v=l?e:Object.keys(e),b=v.length,a=l?new Array(b):{};let k=0;for(let M=0;M<b;M++){const L=l?M:v[M],z=t[L],O=e[L];if(z===O){a[L]=z,(l?M<m:WF.call(t,L))&&k++;continue}if(z===null||O===null||typeof z!="object"||typeof O!="object"){a[L]=O;continue}const K=_P(z,O,r+1);a[L]=K,K===z&&k++}return m===b&&k===m?t:a}function Kx(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function RC(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function ww(t){if(!DC(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!DC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function DC(t){return Object.prototype.toString.call(t)==="[object Object]"}function qF(t){return new Promise(e=>{Ff.setTimeout(e,t)})}function bw(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?_P(t,e):e}function ZF(t,e,r=0){const l=[...t,e];return r&&l.length>r?l.slice(1):l}function XF(t,e,r=0){const l=[e,...t];return r&&l.length>r?l.slice(0,-1):l}var Zb=Symbol();function xP(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Zb?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Xb(t,e){return typeof t=="function"?t(...e):!!t}function KF(t,e,r){let l=!1,u;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(u??=e(),l||(l=!0,u.aborted?r():u.addEventListener("abort",r,{once:!0})),u)}),t}var YF=class extends Jm{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!Xf&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},Kb=new YF;function Tw(){let t,e;const r=new Promise((u,m)=>{t=u,e=m});r.status="pending",r.catch(()=>{});function l(u){Object.assign(r,u),delete r.resolve,delete r.reject}return r.resolve=u=>{l({status:"fulfilled",value:u}),t(u)},r.reject=u=>{l({status:"rejected",reason:u}),e(u)},r}var JF=GF;function QF(){let t=[],e=0,r=b=>{b()},l=b=>{b()},u=JF;const m=b=>{e?t.push(b):u(()=>{r(b)})},v=()=>{const b=t;t=[],b.length&&u(()=>{l(()=>{b.forEach(a=>{r(a)})})})};return{batch:b=>{let a;e++;try{a=b()}finally{e--,e||v()}return a},batchCalls:b=>(...a)=>{m(()=>{b(...a)})},schedule:m,setNotifyFunction:b=>{r=b},setBatchNotifyFunction:b=>{l=b},setScheduler:b=>{u=b}}}var ys=QF(),e6=class extends Jm{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!Xf&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},Yx=new e6;function t6(t){return Math.min(1e3*2**t,3e4)}function vP(t){return(t??"online")==="online"?Yx.isOnline():!0}var Sw=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function wP(t){let e=!1,r=0,l;const u=Tw(),m=()=>u.status!=="pending",v=H=>{if(!m()){const Z=new Sw(H);z(Z),t.onCancel?.(Z)}},b=()=>{e=!0},a=()=>{e=!1},k=()=>Kb.isFocused()&&(t.networkMode==="always"||Yx.isOnline())&&t.canRun(),M=()=>vP(t.networkMode)&&t.canRun(),L=H=>{m()||(l?.(),u.resolve(H))},z=H=>{m()||(l?.(),u.reject(H))},O=()=>new Promise(H=>{l=Z=>{(m()||k())&&H(Z)},t.onPause?.()}).then(()=>{l=void 0,m()||t.onContinue?.()}),K=()=>{if(m())return;let H;const Z=r===0?t.initialPromise:void 0;try{H=Z??t.fn()}catch(Y){H=Promise.reject(Y)}Promise.resolve(H).then(L).catch(Y=>{if(m())return;const ee=t.retry??(Xf?0:3),ie=t.retryDelay??t6,pe=typeof ie=="function"?ie(r,Y):ie,xe=ee===!0||typeof ee=="number"&&r<ee||typeof ee=="function"&&ee(r,Y);if(e||!xe){z(Y);return}r++,t.onFail?.(r,Y),qF(pe).then(()=>k()?void 0:O()).then(()=>{e?z(Y):K()})})};return{promise:u,status:()=>u.status,cancel:v,continue:()=>(l?.(),u),cancelRetry:b,continueRetry:a,canStart:M,start:()=>(M()?K():O().then(K),u)}}var bP=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),vw(this.gcTime)&&(this.#e=Ff.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Xf?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Ff.clearTimeout(this.#e),this.#e=void 0)}},n6=class extends bP{#e;#t;#n;#i;#r;#o;#a;constructor(t){super(),this.#a=!1,this.#o=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#i=t.client,this.#n=this.#i.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=jC(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#o,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=jC(this.options);e.data!==void 0&&(this.setState(LC(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const r=bw(this.state.data,t,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#s({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Do).catch(Do):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>el(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Zb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>ch(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!yP(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#a?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const b=this.observers.find(a=>a.options.queryFn);b&&this.setOptions(b.options)}const r=new AbortController,l=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},u=()=>{const b=xP(this.options,e),k=(()=>{const M={client:this.#i,queryKey:this.queryKey,meta:this.meta};return l(M),M})();return this.#a=!1,this.options.persister?this.options.persister(b,k,this):b(k)},v=(()=>{const b={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:u};return l(b),b})();this.options.behavior?.onFetch(v,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==v.fetchOptions?.meta)&&this.#s({type:"fetch",meta:v.fetchOptions?.meta}),this.#r=wP({initialPromise:e?.initialPromise,fn:v.fetchFn,onCancel:b=>{b instanceof Sw&&b.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(b,a)=>{this.#s({type:"failed",failureCount:b,error:a})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:v.options.retry,retryDelay:v.options.retryDelay,networkMode:v.options.networkMode,canRun:()=>!0});try{const b=await this.#r.start();if(b===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(b),this.#n.config.onSuccess?.(b,this),this.#n.config.onSettled?.(b,this.state.error,this),b}catch(b){if(b instanceof Sw){if(b.silent)return this.#r.promise;if(b.revert){if(this.state.data===void 0)throw b;return this.state.data}}throw this.#s({type:"error",error:b}),this.#n.config.onError?.(b,this),this.#n.config.onSettled?.(this.state.data,b,this),b}finally{this.scheduleGc()}}#s(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...TP(r.data,this.options),fetchMeta:t.meta??null};case"success":const l={...r,...LC(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?l:void 0,l;case"error":const u=t.error;return{...r,error:u,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:u,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),ys.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function TP(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:vP(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function LC(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function jC(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,l=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?l??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var r6=class extends Jm{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#a=Tw(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#o;#a;#s;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),OC(this.#t,this.options)?this.#d():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Ew(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Ew(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof el(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#t.setOptions(this.options),e._defaulted&&!Kx(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const l=this.hasListeners();l&&zC(this.#t,r,this.options,e)&&this.#d(),this.updateResult(),l&&(this.#t!==r||el(this.options.enabled,this.#t)!==el(e.enabled,this.#t)||ch(this.options.staleTime,this.#t)!==ch(e.staleTime,this.#t))&&this.#g();const u=this.#y();l&&(this.#t!==r||el(this.options.enabled,this.#t)!==el(e.enabled,this.#t)||u!==this.#l)&&this.#_(u)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(e,t);return s6(this,r)&&(this.#i=r,this.#o=this.options,this.#r=this.#t.state),r}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(r,l)=>(this.trackProp(l),e?.(l),l==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,l))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#b();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Do)),e}#g(){this.#v();const t=ch(this.options.staleTime,this.#t);if(Xf||this.#i.isStale||!vw(t))return;const r=yP(this.#i.dataUpdatedAt,t)+1;this.#c=Ff.setTimeout(()=>{this.#i.isStale||this.updateResult()},r)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#w(),this.#l=t,!(Xf||el(this.options.enabled,this.#t)===!1||!vw(this.#l)||this.#l===0)&&(this.#u=Ff.setInterval(()=>{(this.options.refetchIntervalInBackground||Kb.isFocused())&&this.#d()},this.#l))}#x(){this.#g(),this.#_(this.#y())}#v(){this.#c&&(Ff.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(Ff.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const r=this.#t,l=this.options,u=this.#i,m=this.#r,v=this.#o,a=t!==r?t.state:this.#n,{state:k}=t;let M={...k},L=!1,z;if(e._optimisticResults){const Ue=this.hasListeners(),et=!Ue&&OC(t,e),Ie=Ue&&zC(t,r,e,l);(et||Ie)&&(M={...M,...TP(k.data,t.options)}),e._optimisticResults==="isRestoring"&&(M.fetchStatus="idle")}let{error:O,errorUpdatedAt:K,status:H}=M;z=M.data;let Z=!1;if(e.placeholderData!==void 0&&z===void 0&&H==="pending"){let Ue;u?.isPlaceholderData&&e.placeholderData===v?.placeholderData?(Ue=u.data,Z=!0):Ue=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,Ue!==void 0&&(H="success",z=bw(u?.data,Ue,e),L=!0)}if(e.select&&z!==void 0&&!Z)if(u&&z===m?.data&&e.select===this.#m)z=this.#h;else try{this.#m=e.select,z=e.select(z),z=bw(u?.data,z,e),this.#h=z,this.#s=null}catch(Ue){this.#s=Ue}this.#s&&(O=this.#s,z=this.#h,K=Date.now(),H="error");const Y=M.fetchStatus==="fetching",ee=H==="pending",ie=H==="error",pe=ee&&Y,xe=z!==void 0,je={status:H,fetchStatus:M.fetchStatus,isPending:ee,isSuccess:H==="success",isError:ie,isInitialLoading:pe,isLoading:pe,data:z,dataUpdatedAt:M.dataUpdatedAt,error:O,errorUpdatedAt:K,failureCount:M.fetchFailureCount,failureReason:M.fetchFailureReason,errorUpdateCount:M.errorUpdateCount,isFetched:M.dataUpdateCount>0||M.errorUpdateCount>0,isFetchedAfterMount:M.dataUpdateCount>a.dataUpdateCount||M.errorUpdateCount>a.errorUpdateCount,isFetching:Y,isRefetching:Y&&!ee,isLoadingError:ie&&!xe,isPaused:M.fetchStatus==="paused",isPlaceholderData:L,isRefetchError:ie&&xe,isStale:Yb(t,e),refetch:this.refetch,promise:this.#a,isEnabled:el(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const Ue=je.data!==void 0,et=je.status==="error"&&!Ue,Ie=gt=>{et?gt.reject(je.error):Ue&&gt.resolve(je.data)},ot=()=>{const gt=this.#a=je.promise=Tw();Ie(gt)},ut=this.#a;switch(ut.status){case"pending":t.queryHash===r.queryHash&&Ie(ut);break;case"fulfilled":(et||je.data!==ut.value)&&ot();break;case"rejected":(!et||je.error!==ut.reason)&&ot();break}}return je}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#o=this.options,this.#r.data!==void 0&&(this.#f=this.#t),Kx(e,t))return;this.#i=e;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,u=typeof l=="function"?l():l;if(u==="all"||!u&&!this.#p.size)return!0;const m=new Set(u??this.#p);return this.options.throwOnError&&m.add("error"),Object.keys(this.#i).some(v=>{const b=v;return this.#i[b]!==t[b]&&m.has(b)})};this.#T({listeners:r()})}#b(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#T(t){ys.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function i6(t,e){return el(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function OC(t,e){return i6(t,e)||t.state.data!==void 0&&Ew(t,e,e.refetchOnMount)}function Ew(t,e,r){if(el(e.enabled,t)!==!1&&ch(e.staleTime,t)!=="static"){const l=typeof r=="function"?r(t):r;return l==="always"||l!==!1&&Yb(t,e)}return!1}function zC(t,e,r,l){return(t!==e||el(l.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Yb(t,r)}function Yb(t,e){return el(e.enabled,t)!==!1&&t.isStaleByTime(ch(e.staleTime,t))}function s6(t,e){return!Kx(t.getCurrentResult(),e)}function BC(t){return{onFetch:(e,r)=>{const l=e.options,u=e.fetchOptions?.meta?.fetchMore?.direction,m=e.state.data?.pages||[],v=e.state.data?.pageParams||[];let b={pages:[],pageParams:[]},a=0;const k=async()=>{let M=!1;const L=K=>{KF(K,()=>e.signal,()=>M=!0)},z=xP(e.options,e.fetchOptions),O=async(K,H,Z)=>{if(M)return Promise.reject();if(H==null&&K.pages.length)return Promise.resolve(K);const ee=(()=>{const Ce={client:e.client,queryKey:e.queryKey,pageParam:H,direction:Z?"backward":"forward",meta:e.options.meta};return L(Ce),Ce})(),ie=await z(ee),{maxPages:pe}=e.options,xe=Z?XF:ZF;return{pages:xe(K.pages,ie,pe),pageParams:xe(K.pageParams,H,pe)}};if(u&&m.length){const K=u==="backward",H=K?o6:FC,Z={pages:m,pageParams:v},Y=H(l,Z);b=await O(Z,Y,K)}else{const K=t??m.length;do{const H=a===0?v[0]??l.initialPageParam:FC(l,b);if(a>0&&H==null)break;b=await O(b,H),a++}while(a<K)}return b};e.options.persister?e.fetchFn=()=>e.options.persister?.(k,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=k}}}function FC(t,{pages:e,pageParams:r}){const l=e.length-1;return e.length>0?t.getNextPageParam(e[l],e,r[l],r):void 0}function o6(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var a6=class extends bP{#e;#t;#n;#i;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||SP(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=wP({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(m,v)=>{this.#r({type:"failed",failureCount:m,error:v})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const l=this.state.status==="pending",u=!this.#i.canStart();try{if(l)e();else{this.#r({type:"pending",variables:t,isPaused:u}),this.#n.config.onMutate&&await this.#n.config.onMutate(t,this,r);const v=await this.options.onMutate?.(t,r);v!==this.state.context&&this.#r({type:"pending",context:v,variables:t,isPaused:u})}const m=await this.#i.start();return await this.#n.config.onSuccess?.(m,t,this.state.context,this,r),await this.options.onSuccess?.(m,t,this.state.context,r),await this.#n.config.onSettled?.(m,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(m,null,t,this.state.context,r),this.#r({type:"success",data:m}),m}catch(m){try{await this.#n.config.onError?.(m,t,this.state.context,this,r)}catch(v){Promise.reject(v)}try{await this.options.onError?.(m,t,this.state.context,r)}catch(v){Promise.reject(v)}try{await this.#n.config.onSettled?.(void 0,m,this.state.variables,this.state.context,this,r)}catch(v){Promise.reject(v)}try{await this.options.onSettled?.(void 0,m,t,this.state.context,r)}catch(v){Promise.reject(v)}throw this.#r({type:"error",error:m}),m}finally{this.#n.runNext(this)}}#r(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),ys.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function SP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var l6=class extends Jm{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,r){const l=new a6({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:r});return this.add(l),l}add(t){this.#e.add(t);const e=fx(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=fx(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const l=r.indexOf(t);l!==-1&&r.splice(l,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=fx(t);if(typeof e=="string"){const l=this.#t.get(e)?.find(u=>u.state.status==="pending");return!l||l===t}else return!0}runNext(t){const e=fx(t);return typeof e=="string"?this.#t.get(e)?.find(l=>l!==t&&l.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){ys.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>NC(e,r))}findAll(t={}){return this.getAll().filter(e=>NC(t,e))}notify(t){ys.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return ys.batch(()=>Promise.all(t.map(e=>e.continue().catch(Do))))}};function fx(t){return t.options.scope?.id}var c6=class extends Jm{#e;#t=void 0;#n;#i;constructor(e,r){super(),this.#e=e,this.setOptions(r),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#e.defaultMutationOptions(e),Kx(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),r?.mutationKey&&this.options.mutationKey&&Kf(r.mutationKey)!==Kf(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#o()}mutate(e,r){return this.#i=r,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??SP();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){ys.batch(()=>{if(this.#i&&this.hasListeners()){const r=this.#t.variables,l=this.#t.context,u={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,r,l,u)}catch(m){Promise.reject(m)}try{this.#i.onSettled?.(e.data,null,r,l,u)}catch(m){Promise.reject(m)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,r,l,u)}catch(m){Promise.reject(m)}try{this.#i.onSettled?.(void 0,e.error,r,l,u)}catch(m){Promise.reject(m)}}}this.listeners.forEach(r=>{r(this.#t)})})}},u6=class extends Jm{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const l=e.queryKey,u=e.queryHash??qb(l,e);let m=this.get(u);return m||(m=new n6({client:t,queryKey:l,queryHash:u,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(l)}),this.add(m)),m}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){ys.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>PC(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>PC(t,r)):e}notify(t){ys.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){ys.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){ys.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},d6=class{#e;#t;#n;#i;#r;#o;#a;#s;constructor(t={}){this.#e=t.queryCache||new u6,this.#t=t.mutationCache||new l6,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=Kb.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Yx.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),l=r.state.data;return l===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(ch(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(l))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const l=r.data;return[e,l]})}setQueryData(t,e,r){const l=this.defaultQueryOptions({queryKey:t}),m=this.#e.get(l.queryHash)?.state.data,v=HF(e,m);if(v!==void 0)return this.#e.build(this,l).setData(v,{...r,manual:!0})}setQueriesData(t,e,r){return ys.batch(()=>this.#e.findAll(t).map(({queryKey:l})=>[l,this.setQueryData(l,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;ys.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return ys.batch(()=>(r.findAll(t).forEach(l=>{l.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},l=ys.batch(()=>this.#e.findAll(t).map(u=>u.cancel(r)));return Promise.all(l).then(Do).catch(Do)}invalidateQueries(t,e={}){return ys.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},l=ys.batch(()=>this.#e.findAll(t).filter(u=>!u.isDisabled()&&!u.isStatic()).map(u=>{let m=u.fetch(void 0,r);return r.throwOnError||(m=m.catch(Do)),u.state.fetchStatus==="paused"?Promise.resolve():m}));return Promise.all(l).then(Do)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(ch(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Do).catch(Do)}fetchInfiniteQuery(t){return t.behavior=BC(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Do).catch(Do)}ensureInfiniteQueryData(t){return t.behavior=BC(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Yx.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Kf(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],r={};return e.forEach(l=>{Ny(t,l.queryKey)&&Object.assign(r,l.defaultOptions)}),r}setMutationDefaults(t,e){this.#r.set(Kf(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],r={};return e.forEach(l=>{Ny(t,l.mutationKey)&&Object.assign(r,l.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=qb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Zb&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},EP=P.createContext(void 0),zv=t=>{const e=P.useContext(EP);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},h6=({client:t,children:e})=>(P.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),_.jsx(EP.Provider,{value:t,children:e})),CP=P.createContext(!1),f6=()=>P.useContext(CP);CP.Provider;function p6(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var m6=P.createContext(p6()),g6=()=>P.useContext(m6),y6=(t,e,r)=>{const l=r?.state.error&&typeof t.throwOnError=="function"?Xb(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||l)&&(e.isReset()||(t.retryOnMount=!1))},_6=t=>{P.useEffect(()=>{t.clearReset()},[t])},x6=({result:t,errorResetBoundary:e,throwOnError:r,query:l,suspense:u})=>t.isError&&!e.isReset()&&!t.isFetching&&l&&(u&&t.data===void 0||Xb(r,[t.error,l])),v6=t=>{if(t.suspense){const r=u=>u==="static"?u:Math.max(u??1e3,1e3),l=t.staleTime;t.staleTime=typeof l=="function"?(...u)=>r(l(...u)):r(l),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},w6=(t,e)=>t.isLoading&&t.isFetching&&!e,b6=(t,e)=>t?.suspense&&e.isPending,VC=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function T6(t,e,r){const l=f6(),u=g6(),m=zv(),v=m.defaultQueryOptions(t);m.getDefaultOptions().queries?._experimental_beforeQuery?.(v);const b=m.getQueryCache().get(v.queryHash);v._optimisticResults=l?"isRestoring":"optimistic",v6(v),y6(v,u,b),_6(u);const a=!m.getQueryCache().get(v.queryHash),[k]=P.useState(()=>new e(m,v)),M=k.getOptimisticResult(v),L=!l&&t.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(z=>{const O=L?k.subscribe(ys.batchCalls(z)):Do;return k.updateResult(),O},[k,L]),()=>k.getCurrentResult(),()=>k.getCurrentResult()),P.useEffect(()=>{k.setOptions(v)},[v,k]),b6(v,M))throw VC(v,k,u);if(x6({result:M,errorResetBoundary:u,throwOnError:v.throwOnError,query:b,suspense:v.suspense}))throw M.error;return m.getDefaultOptions().queries?._experimental_afterQuery?.(v,M),v.experimental_prefetchInRender&&!Xf&&w6(M,l)&&(a?VC(v,k,u):b?.promise)?.catch(Do).finally(()=>{k.updateResult()}),v.notifyOnChangeProps?M:k.trackResult(M)}function Jb(t,e){return T6(t,r6)}function Bl(t,e){const r=zv(),[l]=P.useState(()=>new c6(r,t));P.useEffect(()=>{l.setOptions(t)},[l,t]);const u=P.useSyncExternalStore(P.useCallback(v=>l.subscribe(ys.batchCalls(v)),[l]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),m=P.useCallback((v,b)=>{l.mutate(v,b).catch(Do)},[l]);if(u.error&&Xb(l.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:m,mutateAsync:u.mutate}}function Ry(){return Ry=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Ry.apply(this,arguments)}var rh;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rh||(rh={}));const UC="popstate";function S6(t){t===void 0&&(t={});function e(l,u){let{pathname:m,search:v,hash:b}=l.location;return Cw("",{pathname:m,search:v,hash:b},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function r(l,u){return typeof u=="string"?u:kP(u)}return C6(e,r,null,t)}function _s(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Qb(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function E6(){return Math.random().toString(36).substr(2,8)}function $C(t,e){return{usr:t.state,key:t.key,idx:e}}function Cw(t,e,r,l){return r===void 0&&(r=null),Ry({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Qm(e):e,{state:r,key:e&&e.key||l||E6()})}function kP(t){let{pathname:e="/",search:r="",hash:l=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(e+=l.charAt(0)==="#"?l:"#"+l),e}function Qm(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let l=t.indexOf("?");l>=0&&(e.search=t.substr(l),t=t.substr(0,l)),t&&(e.pathname=t)}return e}function C6(t,e,r,l){l===void 0&&(l={});let{window:u=document.defaultView,v5Compat:m=!1}=l,v=u.history,b=rh.Pop,a=null,k=M();k==null&&(k=0,v.replaceState(Ry({},v.state,{idx:k}),""));function M(){return(v.state||{idx:null}).idx}function L(){b=rh.Pop;let Z=M(),Y=Z==null?null:Z-k;k=Z,a&&a({action:b,location:H.location,delta:Y})}function z(Z,Y){b=rh.Push;let ee=Cw(H.location,Z,Y);k=M()+1;let ie=$C(ee,k),pe=H.createHref(ee);try{v.pushState(ie,"",pe)}catch(xe){if(xe instanceof DOMException&&xe.name==="DataCloneError")throw xe;u.location.assign(pe)}m&&a&&a({action:b,location:H.location,delta:1})}function O(Z,Y){b=rh.Replace;let ee=Cw(H.location,Z,Y);k=M();let ie=$C(ee,k),pe=H.createHref(ee);v.replaceState(ie,"",pe),m&&a&&a({action:b,location:H.location,delta:0})}function K(Z){let Y=u.location.origin!=="null"?u.location.origin:u.location.href,ee=typeof Z=="string"?Z:kP(Z);return ee=ee.replace(/ $/,"%20"),_s(Y,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,Y)}let H={get action(){return b},get location(){return t(u,v)},listen(Z){if(a)throw new Error("A history only accepts one active listener");return u.addEventListener(UC,L),a=Z,()=>{u.removeEventListener(UC,L),a=null}},createHref(Z){return e(u,Z)},createURL:K,encodeLocation(Z){let Y=K(Z);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:z,replace:O,go(Z){return v.go(Z)}};return H}var GC;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(GC||(GC={}));function k6(t,e,r){return r===void 0&&(r="/"),A6(t,e,r)}function A6(t,e,r,l){let u=typeof e=="string"?Qm(e):e,m=MP(u.pathname||"/",r);if(m==null)return null;let v=AP(t);I6(v);let b=null;for(let a=0;b==null&&a<v.length;++a){let k=V6(m);b=z6(v[a],k)}return b}function AP(t,e,r,l){e===void 0&&(e=[]),r===void 0&&(r=[]),l===void 0&&(l="");let u=(m,v,b)=>{let a={relativePath:b===void 0?m.path||"":b,caseSensitive:m.caseSensitive===!0,childrenIndex:v,route:m};a.relativePath.startsWith("/")&&(_s(a.relativePath.startsWith(l),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(l.length));let k=Gf([l,a.relativePath]),M=r.concat(a);m.children&&m.children.length>0&&(_s(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+k+'".')),AP(m.children,e,M,k)),!(m.path==null&&!m.index)&&e.push({path:k,score:j6(k,m.index),routesMeta:M})};return t.forEach((m,v)=>{var b;if(m.path===""||!((b=m.path)!=null&&b.includes("?")))u(m,v);else for(let a of IP(m.path))u(m,v,a)}),e}function IP(t){let e=t.split("/");if(e.length===0)return[];let[r,...l]=e,u=r.endsWith("?"),m=r.replace(/\?$/,"");if(l.length===0)return u?[m,""]:[m];let v=IP(l.join("/")),b=[];return b.push(...v.map(a=>a===""?m:[m,a].join("/"))),u&&b.push(...v),b.map(a=>t.startsWith("/")&&a===""?"/":a)}function I6(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:O6(e.routesMeta.map(l=>l.childrenIndex),r.routesMeta.map(l=>l.childrenIndex)))}const M6=/^:[\w-]+$/,P6=3,N6=2,R6=1,D6=10,L6=-2,HC=t=>t==="*";function j6(t,e){let r=t.split("/"),l=r.length;return r.some(HC)&&(l+=L6),e&&(l+=N6),r.filter(u=>!HC(u)).reduce((u,m)=>u+(M6.test(m)?P6:m===""?R6:D6),l)}function O6(t,e){return t.length===e.length&&t.slice(0,-1).every((l,u)=>l===e[u])?t[t.length-1]-e[e.length-1]:0}function z6(t,e,r){let{routesMeta:l}=t,u={},m="/",v=[];for(let b=0;b<l.length;++b){let a=l[b],k=b===l.length-1,M=m==="/"?e:e.slice(m.length)||"/",L=B6({path:a.relativePath,caseSensitive:a.caseSensitive,end:k},M),z=a.route;if(!L)return null;Object.assign(u,L.params),v.push({params:u,pathname:Gf([m,L.pathname]),pathnameBase:Z6(Gf([m,L.pathnameBase])),route:z}),L.pathnameBase!=="/"&&(m=Gf([m,L.pathnameBase]))}return v}function B6(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,l]=F6(t.path,t.caseSensitive,t.end),u=e.match(r);if(!u)return null;let m=u[0],v=m.replace(/(.)\/+$/,"$1"),b=u.slice(1);return{params:l.reduce((k,M,L)=>{let{paramName:z,isOptional:O}=M;if(z==="*"){let H=b[L]||"";v=m.slice(0,m.length-H.length).replace(/(.)\/+$/,"$1")}const K=b[L];return O&&!K?k[z]=void 0:k[z]=(K||"").replace(/%2F/g,"/"),k},{}),pathname:m,pathnameBase:v,pattern:t}}function F6(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Qb(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let l=[],u="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,b,a)=>(l.push({paramName:b,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(l.push({paramName:"*"}),u+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?u+="\\/*$":t!==""&&t!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,e?void 0:"i"),l]}function V6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Qb(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function MP(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,l=t.charAt(r);return l&&l!=="/"?null:t.slice(r)||"/"}const U6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,$6=t=>U6.test(t);function G6(t,e){e===void 0&&(e="/");let{pathname:r,search:l="",hash:u=""}=typeof t=="string"?Qm(t):t,m;if(r)if($6(r))m=r;else{if(r.includes("//")){let v=r;r=r.replace(/\/\/+/g,"/"),Qb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(v+" -> "+r))}r.startsWith("/")?m=WC(r.substring(1),"/"):m=WC(r,e)}else m=e;return{pathname:m,search:X6(l),hash:K6(u)}}function WC(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(u=>{u===".."?r.length>1&&r.pop():u!=="."&&r.push(u)}),r.length>1?r.join("/"):"/"}function w1(t,e,r,l){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function H6(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function W6(t,e){let r=H6(t);return e?r.map((l,u)=>u===r.length-1?l.pathname:l.pathnameBase):r.map(l=>l.pathnameBase)}function q6(t,e,r,l){l===void 0&&(l=!1);let u;typeof t=="string"?u=Qm(t):(u=Ry({},t),_s(!u.pathname||!u.pathname.includes("?"),w1("?","pathname","search",u)),_s(!u.pathname||!u.pathname.includes("#"),w1("#","pathname","hash",u)),_s(!u.search||!u.search.includes("#"),w1("#","search","hash",u)));let m=t===""||u.pathname==="",v=m?"/":u.pathname,b;if(v==null)b=r;else{let L=e.length-1;if(!l&&v.startsWith("..")){let z=v.split("/");for(;z[0]==="..";)z.shift(),L-=1;u.pathname=z.join("/")}b=L>=0?e[L]:"/"}let a=G6(u,b),k=v&&v!=="/"&&v.endsWith("/"),M=(m||v===".")&&r.endsWith("/");return!a.pathname.endsWith("/")&&(k||M)&&(a.pathname+="/"),a}const Gf=t=>t.join("/").replace(/\/\/+/g,"/"),Z6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),X6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,K6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function Y6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const PP=["post","put","patch","delete"];new Set(PP);const J6=["get",...PP];new Set(J6);function Dy(){return Dy=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Dy.apply(this,arguments)}const eT=P.createContext(null),Q6=P.createContext(null),Bv=P.createContext(null),Fv=P.createContext(null),ip=P.createContext({outlet:null,matches:[],isDataRoute:!1}),NP=P.createContext(null);function Vv(){return P.useContext(Fv)!=null}function Uv(){return Vv()||_s(!1),P.useContext(Fv).location}function RP(t){P.useContext(Bv).static||P.useLayoutEffect(t)}function sp(){let{isDataRoute:t}=P.useContext(ip);return t?fV():eV()}function eV(){Vv()||_s(!1);let t=P.useContext(eT),{basename:e,future:r,navigator:l}=P.useContext(Bv),{matches:u}=P.useContext(ip),{pathname:m}=Uv(),v=JSON.stringify(W6(u,r.v7_relativeSplatPath)),b=P.useRef(!1);return RP(()=>{b.current=!0}),P.useCallback(function(k,M){if(M===void 0&&(M={}),!b.current)return;if(typeof k=="number"){l.go(k);return}let L=q6(k,JSON.parse(v),m,M.relative==="path");t==null&&e!=="/"&&(L.pathname=L.pathname==="/"?e:Gf([e,L.pathname])),(M.replace?l.replace:l.push)(L,M.state,M)},[e,l,v,m,t])}function tV(){let{matches:t}=P.useContext(ip),e=t[t.length-1];return e?e.params:{}}function nV(t,e){return rV(t,e)}function rV(t,e,r,l){Vv()||_s(!1);let{navigator:u}=P.useContext(Bv),{matches:m}=P.useContext(ip),v=m[m.length-1],b=v?v.params:{};v&&v.pathname;let a=v?v.pathnameBase:"/";v&&v.route;let k=Uv(),M;if(e){var L;let Z=typeof e=="string"?Qm(e):e;a==="/"||(L=Z.pathname)!=null&&L.startsWith(a)||_s(!1),M=Z}else M=k;let z=M.pathname||"/",O=z;if(a!=="/"){let Z=a.replace(/^\//,"").split("/");O="/"+z.replace(/^\//,"").split("/").slice(Z.length).join("/")}let K=k6(t,{pathname:O}),H=lV(K&&K.map(Z=>Object.assign({},Z,{params:Object.assign({},b,Z.params),pathname:Gf([a,u.encodeLocation?u.encodeLocation(Z.pathname).pathname:Z.pathname]),pathnameBase:Z.pathnameBase==="/"?a:Gf([a,u.encodeLocation?u.encodeLocation(Z.pathnameBase).pathname:Z.pathnameBase])})),m,r,l);return e&&H?P.createElement(Fv.Provider,{value:{location:Dy({pathname:"/",search:"",hash:"",state:null,key:"default"},M),navigationType:rh.Pop}},H):H}function iV(){let t=hV(),e=Y6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),r?P.createElement("pre",{style:u},r):null,null)}const sV=P.createElement(iV,null);class oV extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?P.createElement(ip.Provider,{value:this.props.routeContext},P.createElement(NP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function aV(t){let{routeContext:e,match:r,children:l}=t,u=P.useContext(eT);return u&&u.static&&u.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=r.route.id),P.createElement(ip.Provider,{value:e},l)}function lV(t,e,r,l){var u;if(e===void 0&&(e=[]),r===void 0&&(r=null),l===void 0&&(l=null),t==null){var m;if(!r)return null;if(r.errors)t=r.matches;else if((m=l)!=null&&m.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let v=t,b=(u=r)==null?void 0:u.errors;if(b!=null){let M=v.findIndex(L=>L.route.id&&b?.[L.route.id]!==void 0);M>=0||_s(!1),v=v.slice(0,Math.min(v.length,M+1))}let a=!1,k=-1;if(r&&l&&l.v7_partialHydration)for(let M=0;M<v.length;M++){let L=v[M];if((L.route.HydrateFallback||L.route.hydrateFallbackElement)&&(k=M),L.route.id){let{loaderData:z,errors:O}=r,K=L.route.loader&&z[L.route.id]===void 0&&(!O||O[L.route.id]===void 0);if(L.route.lazy||K){a=!0,k>=0?v=v.slice(0,k+1):v=[v[0]];break}}}return v.reduceRight((M,L,z)=>{let O,K=!1,H=null,Z=null;r&&(O=b&&L.route.id?b[L.route.id]:void 0,H=L.route.errorElement||sV,a&&(k<0&&z===0?(pV("route-fallback"),K=!0,Z=null):k===z&&(K=!0,Z=L.route.hydrateFallbackElement||null)));let Y=e.concat(v.slice(0,z+1)),ee=()=>{let ie;return O?ie=H:K?ie=Z:L.route.Component?ie=P.createElement(L.route.Component,null):L.route.element?ie=L.route.element:ie=M,P.createElement(aV,{match:L,routeContext:{outlet:M,matches:Y,isDataRoute:r!=null},children:ie})};return r&&(L.route.ErrorBoundary||L.route.errorElement||z===0)?P.createElement(oV,{location:r.location,revalidation:r.revalidation,component:H,error:O,children:ee(),routeContext:{outlet:null,matches:Y,isDataRoute:!0}}):ee()},null)}var DP=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(DP||{}),LP=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(LP||{});function cV(t){let e=P.useContext(eT);return e||_s(!1),e}function uV(t){let e=P.useContext(Q6);return e||_s(!1),e}function dV(t){let e=P.useContext(ip);return e||_s(!1),e}function jP(t){let e=dV(),r=e.matches[e.matches.length-1];return r.route.id||_s(!1),r.route.id}function hV(){var t;let e=P.useContext(NP),r=uV(),l=jP();return e!==void 0?e:(t=r.errors)==null?void 0:t[l]}function fV(){let{router:t}=cV(DP.UseNavigateStable),e=jP(LP.UseNavigateStable),r=P.useRef(!1);return RP(()=>{r.current=!0}),P.useCallback(function(u,m){m===void 0&&(m={}),r.current&&(typeof u=="number"?t.navigate(u):t.navigate(u,Dy({fromRouteId:e},m)))},[t,e])}const qC={};function pV(t,e,r){qC[t]||(qC[t]=!0)}function mV(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function Of(t){_s(!1)}function gV(t){let{basename:e="/",children:r=null,location:l,navigationType:u=rh.Pop,navigator:m,static:v=!1,future:b}=t;Vv()&&_s(!1);let a=e.replace(/^\/*/,"/"),k=P.useMemo(()=>({basename:a,navigator:m,static:v,future:Dy({v7_relativeSplatPath:!1},b)}),[a,b,m,v]);typeof l=="string"&&(l=Qm(l));let{pathname:M="/",search:L="",hash:z="",state:O=null,key:K="default"}=l,H=P.useMemo(()=>{let Z=MP(M,a);return Z==null?null:{location:{pathname:Z,search:L,hash:z,state:O,key:K},navigationType:u}},[a,M,L,z,O,K,u]);return H==null?null:P.createElement(Bv.Provider,{value:k},P.createElement(Fv.Provider,{children:r,value:H}))}function yV(t){let{children:e,location:r}=t;return nV(kw(e),r)}new Promise(()=>{});function kw(t,e){e===void 0&&(e=[]);let r=[];return P.Children.forEach(t,(l,u)=>{if(!P.isValidElement(l))return;let m=[...e,u];if(l.type===P.Fragment){r.push.apply(r,kw(l.props.children,m));return}l.type!==Of&&_s(!1),!l.props.index||!l.props.children||_s(!1);let v={id:l.props.id||m.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(v.children=kw(l.props.children,m)),r.push(v)}),r}const _V="6";try{window.__reactRouterVersion=_V}catch{}const xV="startTransition",ZC=Ev[xV];function vV(t){let{basename:e,children:r,future:l,window:u}=t,m=P.useRef();m.current==null&&(m.current=S6({window:u,v5Compat:!0}));let v=m.current,[b,a]=P.useState({action:v.action,location:v.location}),{v7_startTransition:k}=l||{},M=P.useCallback(L=>{k&&ZC?ZC(()=>a(L)):a(L)},[a,k]);return P.useLayoutEffect(()=>v.listen(M),[v,M]),P.useEffect(()=>mV(l),[l]),P.createElement(gV,{basename:e,children:r,location:b.location,navigationType:b.action,navigator:v,future:l})}var XC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(XC||(XC={}));var KC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(KC||(KC={}));const YC={vi:{appName:"UniPocket",appTagline:"Campus & Lifestyle Map",searchPlaceholder:"Tm phng ban, ta nh, hoc qun ngon...",categoryBuilding:"Ta nh",categoryFood:"n ung",categoryHousing:"Nh tr",categoryJob:"Vic lm",reviews:"nh gi",departments:"Phng ban",floor:"Tng",room:"Phng",roomShort:"P.",seeMore:"Xem thm",directions:"Ch ng",sponsored:"c ti tr",viewNow:"Xem ngay",reviewCount:"{count} nh gi",navigatingTo:"ang ch ng n",calculatingRoute:"ang tnh ton tuyn ng...",hideInstructions:"n hng dn",viewSteps:"Xem {count} bc hng dn",continueStright:"Tip tc i thng",youAreHere:" Bn ang  y",next:"Tip theo:",continue:"Tip tc",accuracy:" chnh xc",remaining:"Cn",multiStopRoute:"L trnh nhiu im",stops:"im dng",addStop:"Thm im dng",selectPointOnMap:"Chn im trn bn ...",total:"Tng cng",startMultiStop:"i nhiu im",walking:"i b",cycling:"Xe my",driving:" t",shortest:"Ngn nht",fastest:"Nhanh nht",minutes:"pht",hours:"gi",meters:"m",kilometers:"km",turnLeft:"R tri",turnRight:"R phi",turnSlightLeft:"R nh sang tri",turnSlightRight:"R nh sang phi",turnSharpLeft:"R gp sang tri",turnSharpRight:"R gp sang phi",continueOn:"Tip tc i",arrive:"n ni",arriveDestination:"Bn  n im ch",depart:"Bt u",straight:"i thng",uturn:"Quay u",roundabout:"i vng xuyn",merge:"Nhp ln",fork:"R ng ba",endOfRoad:"Cui ng",newName:"Tip tc theo",onThe:" pha",left:"tri",right:"phi",locationError:"Khng th ly v tr ca bn. Vui lng cho php truy cp v tr.",browserNoLocation:"Trnh duyt khng h tr nh v",offRouteWarning:"Bn  i lch tuyn ng. ang tnh ton li...",tokenNotConfigured:"Mapbox Token cha c cu hnh",mapboxTokenRequired:"Cn Mapbox Token  xem bn ",mapboxTokenInstructions:"Dn Access Token ca bn (public token)  chy demo ngay.",tokenPlaceholder:"pk.eyJ1Ijoi...",saveTokenAndLoad:"Lu token & ti bn ",tokenSavedInBrowser:"Token s c lu trong trnh duyt (localStorage).",tokenEmptyError:"Vui lng dn Mapbox Access Token",tokenTooShortError:"Token c v cha ng (qu ngn)",language:"Ngn ng",vietnamese:"Ting Vit",english:"English",voucherDiscount20Student:"Gim 20% cho sinh vin",voucherBuy2Get1:"Mua 2 tng 1",voucherDiscount500kFirstMonth:"Gim 500k thng u",voucherFreeDrink:"Tng nc ung",voucherBogo:"Mua 1 tng 1 (T2-T4)",lectureHall:"Ging ng",dormitory:"K tc x",student:"Sinh vin",parking:"Nh xe",gate:"Cng",entrance:"Li vo",security:"Bo v",safetyGuard:"An ninh",sports:"Th thao",health:"Sc khe",medical:"Y t",administration:"Hnh chnh",innovation:"i mi",startup:"Khi nghip",bank:"Ngn hng",atm:"ATM",lake:"H",relaxation:"Th gin",landscape:"Cnh quan",sportsField:"Sn bng",carParking:" xe  t",checkin:"Check-in",lecture_hall:"Ging ng",office:"Vn phng",cafe:"Caf",entertainment:"Vui chi",food:"Qun n",building:"Ta nh",job:"Vic lm",housing:"Nh tr",coffee:"C ph",studySpace:"Khng gian hc tp",wifi:"Wifi",pastry:"Bnh ngt",group:"Nhm",milkTea:"Tr sa",cheap:"Gi r",nearSchool:"Gn trng",aesthetic:"Sng o",safe:"An ninh",partTime:"Part-time",sales:"Bn hng",evening:"Ti",selectCategory:"Chn danh mc",category:"Danh mc",save:"Lu thng tin",cancel:"Hy",premium:"VIP"},en:{lecture_hall:"Lecture Hall",checkin:"Check-in",office:"Office",cafe:"Cafe",entertainment:"Entertainment",food:"Food",building:"Building",job:"Job",appName:"UniPocket",appTagline:"Campus & Lifestyle Map",searchPlaceholder:"Search departments, buildings, or restaurants...",categoryBuilding:"Buildings",categoryFood:"Food & Drink",categoryHousing:"Housing",categoryJob:"Jobs",category:"Category",reviews:"Reviews",departments:"Departments",floor:"Floor",room:"Room",roomShort:"R.",seeMore:"See more",directions:"Directions",sponsored:"Sponsored",viewNow:"View now",reviewCount:"{count} reviews",navigatingTo:"Navigating to",calculatingRoute:"Calculating route...",hideInstructions:"Hide instructions",viewSteps:"View {count} steps",continueStright:"Continue straight",youAreHere:" You are here",next:"Next:",continue:"Continue",accuracy:"Accuracy",remaining:"Remaining",multiStopRoute:"Multi-stop Route",stops:"stops",addStop:"Add stop",selectPointOnMap:"Select point on map...",total:"Total",startMultiStop:"Multi-stop",walking:"Walk",cycling:"Bike",driving:"Drive",shortest:"Shortest",fastest:"Fastest",minutes:"min",hours:"hr",meters:"m",kilometers:"km",turnLeft:"Turn left",turnRight:"Turn right",turnSlightLeft:"Turn slight left",turnSlightRight:"Turn slight right",turnSharpLeft:"Turn sharp left",turnSharpRight:"Turn sharp right",continueOn:"Continue on",arrive:"Arrive",arriveDestination:"You have arrived at your destination",depart:"Depart",straight:"Go straight",uturn:"Make a U-turn",roundabout:"Enter roundabout",merge:"Merge",fork:"Take fork",endOfRoad:"End of road",newName:"Continue onto",onThe:"on the",left:"left",right:"right",locationError:"Unable to get your location. Please allow location access.",browserNoLocation:"Browser does not support geolocation",offRouteWarning:"You are off route. Recalculating...",tokenNotConfigured:"Mapbox Token not configured",mapboxTokenRequired:"Mapbox Token required to view the map",mapboxTokenInstructions:"Paste your Access Token (public token) to run the demo.",tokenPlaceholder:"pk.eyJ1Ijoi...",saveTokenAndLoad:"Save token & load map",tokenSavedInBrowser:"Token will be saved in browser (localStorage).",tokenEmptyError:"Please paste your Mapbox Access Token",tokenTooShortError:"Token seems invalid (too short)",language:"Language",vietnamese:"Ting Vit",english:"English",voucherDiscount20Student:"20% off for students",voucherBuy2Get1:"Buy 2 get 1 free",voucherDiscount500kFirstMonth:"500k off first month",voucherFreeDrink:"Free drink included",voucherBogo:"Buy 1 get 1 free (Mon-Wed)",lectureHall:"Lecture Hall",dormitory:"Dormitory",student:"Student",parking:"Parking",gate:"Gate",entrance:"Entrance",security:"Security",safetyGuard:"Safety Guard",sports:"Sports",health:"Health",medical:"Medical",administration:"Administration",innovation:"Innovation",startup:"Startup",bank:"Bank",atm:"ATM",lake:"Lake",relaxation:"Relaxation",landscape:"Landscape",sportsField:"Sports Field",carParking:"Car Parking",coffee:"Coffee",studySpace:"Study Space",wifi:"WiFi",pastry:"Pastry",group:"Group",milkTea:"Milk Tea",cheap:"Budget-friendly",nearSchool:"Near Campus",aesthetic:"Aesthetic",housing:"Housing",safe:"Safe",partTime:"Part-time",sales:"Sales",evening:"Evening"}},OP=P.createContext(void 0),JC="unipocket-language",wV=({children:t})=>{const[e,r]=P.useState(()=>{if(typeof window<"u"){const m=localStorage.getItem(JC);if(m==="vi"||m==="en")return m}return"vi"}),l=P.useCallback(m=>{r(m),localStorage.setItem(JC,m)},[]),u=P.useCallback((m,v)=>{let b=YC[e][m]||YC.vi[m]||m;return v&&Object.entries(v).forEach(([a,k])=>{b=b.replace(`{${a}}`,String(k))}),b},[e]);return _.jsx(OP.Provider,{value:{language:e,setLanguage:l,t:u},children:t})},ia=()=>{const t=P.useContext(OP);if(t===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return t},bV=()=>{};var QC={};const zP=function(t){const e=[];let r=0;for(let l=0;l<t.length;l++){let u=t.charCodeAt(l);u<128?e[r++]=u:u<2048?(e[r++]=u>>6|192,e[r++]=u&63|128):(u&64512)===55296&&l+1<t.length&&(t.charCodeAt(l+1)&64512)===56320?(u=65536+((u&1023)<<10)+(t.charCodeAt(++l)&1023),e[r++]=u>>18|240,e[r++]=u>>12&63|128,e[r++]=u>>6&63|128,e[r++]=u&63|128):(e[r++]=u>>12|224,e[r++]=u>>6&63|128,e[r++]=u&63|128)}return e},TV=function(t){const e=[];let r=0,l=0;for(;r<t.length;){const u=t[r++];if(u<128)e[l++]=String.fromCharCode(u);else if(u>191&&u<224){const m=t[r++];e[l++]=String.fromCharCode((u&31)<<6|m&63)}else if(u>239&&u<365){const m=t[r++],v=t[r++],b=t[r++],a=((u&7)<<18|(m&63)<<12|(v&63)<<6|b&63)-65536;e[l++]=String.fromCharCode(55296+(a>>10)),e[l++]=String.fromCharCode(56320+(a&1023))}else{const m=t[r++],v=t[r++];e[l++]=String.fromCharCode((u&15)<<12|(m&63)<<6|v&63)}}return e.join("")},BP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,l=[];for(let u=0;u<t.length;u+=3){const m=t[u],v=u+1<t.length,b=v?t[u+1]:0,a=u+2<t.length,k=a?t[u+2]:0,M=m>>2,L=(m&3)<<4|b>>4;let z=(b&15)<<2|k>>6,O=k&63;a||(O=64,v||(z=64)),l.push(r[M],r[L],r[z],r[O])}return l.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(zP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):TV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,l=[];for(let u=0;u<t.length;){const m=r[t.charAt(u++)],b=u<t.length?r[t.charAt(u)]:0;++u;const k=u<t.length?r[t.charAt(u)]:64;++u;const L=u<t.length?r[t.charAt(u)]:64;if(++u,m==null||b==null||k==null||L==null)throw new SV;const z=m<<2|b>>4;if(l.push(z),k!==64){const O=b<<4&240|k>>2;if(l.push(O),L!==64){const K=k<<6&192|L;l.push(K)}}}return l},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class SV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const EV=function(t){const e=zP(t);return BP.encodeByteArray(e,!0)},FP=function(t){return EV(t).replace(/\./g,"")},VP=function(t){try{return BP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function CV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const kV=()=>CV().__FIREBASE_DEFAULTS__,AV=()=>{if(typeof process>"u"||typeof QC>"u")return;const t=QC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},IV=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&VP(t[1]);return e&&JSON.parse(e)},tT=()=>{try{return bV()||kV()||AV()||IV()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},MV=t=>tT()?.emulatorHosts?.[t],UP=()=>tT()?.config,$P=t=>tT()?.[`_${t}`];class PV{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,l)=>{r?this.reject(r):this.resolve(l),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,l))}}}function $v(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function NV(t){return(await fetch(t,{credentials:"include"})).ok}const xy={};function RV(){const t={prod:[],emulator:[]};for(const e of Object.keys(xy))xy[e]?t.emulator.push(e):t.prod.push(e);return t}function DV(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let ek=!1;function LV(t,e){if(typeof window>"u"||typeof document>"u"||!$v(window.location.host)||xy[t]===e||xy[t]||ek)return;xy[t]=e;function r(z){return`__firebase__banner__${z}`}const l="__firebase__banner",m=RV().prod.length>0;function v(){const z=document.getElementById(l);z&&z.remove()}function b(z){z.style.display="flex",z.style.background="#7faaf0",z.style.position="fixed",z.style.bottom="5px",z.style.left="5px",z.style.padding=".5em",z.style.borderRadius="5px",z.style.alignItems="center"}function a(z,O){z.setAttribute("width","24"),z.setAttribute("id",O),z.setAttribute("height","24"),z.setAttribute("viewBox","0 0 24 24"),z.setAttribute("fill","none"),z.style.marginLeft="-6px"}function k(){const z=document.createElement("span");return z.style.cursor="pointer",z.style.marginLeft="16px",z.style.fontSize="24px",z.innerHTML=" &times;",z.onclick=()=>{ek=!0,v()},z}function M(z,O){z.setAttribute("id",O),z.innerText="Learn more",z.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",z.setAttribute("target","__blank"),z.style.paddingLeft="5px",z.style.textDecoration="underline"}function L(){const z=DV(l),O=r("text"),K=document.getElementById(O)||document.createElement("span"),H=r("learnmore"),Z=document.getElementById(H)||document.createElement("a"),Y=r("preprendIcon"),ee=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(z.created){const ie=z.element;b(ie),M(Z,H);const pe=k();a(ee,Y),ie.append(ee,K,Z,pe),document.body.appendChild(ie)}m?(K.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,K.innerText="Preview backend running in this workspace."),K.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",L):L()}function Oo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function jV(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Oo())}function OV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function zV(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function BV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function FV(){const t=Oo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function VV(){try{return typeof indexedDB=="object"}catch{return!1}}function UV(){return new Promise((t,e)=>{try{let r=!0;const l="validate-browser-context-for-indexeddb-analytics-module",u=self.indexedDB.open(l);u.onsuccess=()=>{u.result.close(),r||self.indexedDB.deleteDatabase(l),t(!0)},u.onupgradeneeded=()=>{r=!1},u.onerror=()=>{e(u.error?.message||"")}}catch(r){e(r)}})}const $V="FirebaseError";class bh extends Error{constructor(e,r,l){super(r),this.code=e,this.customData=l,this.name=$V,Object.setPrototypeOf(this,bh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r_.prototype.create)}}class r_{constructor(e,r,l){this.service=e,this.serviceName=r,this.errors=l}create(e,...r){const l=r[0]||{},u=`${this.service}/${e}`,m=this.errors[e],v=m?GV(m,l):"Error",b=`${this.serviceName}: ${v} (${u}).`;return new bh(u,b,l)}}function GV(t,e){return t.replace(HV,(r,l)=>{const u=e[l];return u!=null?String(u):`<${l}?>`})}const HV=/\{\$([^}]+)}/g;function WV(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function Om(t,e){if(t===e)return!0;const r=Object.keys(t),l=Object.keys(e);for(const u of r){if(!l.includes(u))return!1;const m=t[u],v=e[u];if(tk(m)&&tk(v)){if(!Om(m,v))return!1}else if(m!==v)return!1}for(const u of l)if(!r.includes(u))return!1;return!0}function tk(t){return t!==null&&typeof t=="object"}function i_(t){const e=[];for(const[r,l]of Object.entries(t))Array.isArray(l)?l.forEach(u=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(u))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(l));return e.length?"&"+e.join("&"):""}function oy(t){const e={};return t.replace(/^\?/,"").split("&").forEach(l=>{if(l){const[u,m]=l.split("=");e[decodeURIComponent(u)]=decodeURIComponent(m)}}),e}function ay(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function qV(t,e){const r=new ZV(t,e);return r.subscribe.bind(r)}class ZV{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(l=>{this.error(l)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,l){let u;if(e===void 0&&r===void 0&&l===void 0)throw new Error("Missing Observer.");XV(e,["next","error","complete"])?u=e:u={next:e,error:r,complete:l},u.next===void 0&&(u.next=b1),u.error===void 0&&(u.error=b1),u.complete===void 0&&(u.complete=b1);const m=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?u.error(this.finalError):u.complete()}catch{}}),this.observers.push(u),m}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(l){typeof console<"u"&&console.error&&console.error(l)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function XV(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function b1(){}function td(t){return t&&t._delegate?t._delegate:t}class zm{constructor(e,r,l){this.name=e,this.instanceFactory=r,this.type=l,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const zf="[DEFAULT]";class KV{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const l=new PV;if(this.instancesDeferred.set(r,l),this.isInitialized(r)||this.shouldAutoInitialize())try{const u=this.getOrInitializeService({instanceIdentifier:r});u&&l.resolve(u)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),l=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(u){if(l)return null;throw u}else{if(l)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(JV(e))try{this.getOrInitializeService({instanceIdentifier:zf})}catch{}for(const[r,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(r);try{const m=this.getOrInitializeService({instanceIdentifier:u});l.resolve(m)}catch{}}}}clearInstance(e=zf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=zf){return this.instances.has(e)}getOptions(e=zf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,l=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(l))throw Error(`${this.name}(${l}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const u=this.getOrInitializeService({instanceIdentifier:l,options:r});for(const[m,v]of this.instancesDeferred.entries()){const b=this.normalizeInstanceIdentifier(m);l===b&&v.resolve(u)}return u}onInit(e,r){const l=this.normalizeInstanceIdentifier(r),u=this.onInitCallbacks.get(l)??new Set;u.add(e),this.onInitCallbacks.set(l,u);const m=this.instances.get(l);return m&&e(m,l),()=>{u.delete(e)}}invokeOnInitCallbacks(e,r){const l=this.onInitCallbacks.get(r);if(l)for(const u of l)try{u(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let l=this.instances.get(e);if(!l&&this.component&&(l=this.component.instanceFactory(this.container,{instanceIdentifier:YV(e),options:r}),this.instances.set(e,l),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(l,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,l)}catch{}return l||null}normalizeInstanceIdentifier(e=zf){return this.component?this.component.multipleInstances?e:zf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function YV(t){return t===zf?void 0:t}function JV(t){return t.instantiationMode==="EAGER"}class QV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new KV(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var qr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(qr||(qr={}));const e8={debug:qr.DEBUG,verbose:qr.VERBOSE,info:qr.INFO,warn:qr.WARN,error:qr.ERROR,silent:qr.SILENT},t8=qr.INFO,n8={[qr.DEBUG]:"log",[qr.VERBOSE]:"log",[qr.INFO]:"info",[qr.WARN]:"warn",[qr.ERROR]:"error"},r8=(t,e,...r)=>{if(e<t.logLevel)return;const l=new Date().toISOString(),u=n8[e];if(u)console[u](`[${l}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class GP{constructor(e){this.name=e,this._logLevel=t8,this._logHandler=r8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?e8[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qr.DEBUG,...e),this._logHandler(this,qr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qr.VERBOSE,...e),this._logHandler(this,qr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qr.INFO,...e),this._logHandler(this,qr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qr.WARN,...e),this._logHandler(this,qr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qr.ERROR,...e),this._logHandler(this,qr.ERROR,...e)}}const i8=(t,e)=>e.some(r=>t instanceof r);let nk,rk;function s8(){return nk||(nk=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function o8(){return rk||(rk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const HP=new WeakMap,Aw=new WeakMap,WP=new WeakMap,T1=new WeakMap,nT=new WeakMap;function a8(t){const e=new Promise((r,l)=>{const u=()=>{t.removeEventListener("success",m),t.removeEventListener("error",v)},m=()=>{r(uh(t.result)),u()},v=()=>{l(t.error),u()};t.addEventListener("success",m),t.addEventListener("error",v)});return e.then(r=>{r instanceof IDBCursor&&HP.set(r,t)}).catch(()=>{}),nT.set(e,t),e}function l8(t){if(Aw.has(t))return;const e=new Promise((r,l)=>{const u=()=>{t.removeEventListener("complete",m),t.removeEventListener("error",v),t.removeEventListener("abort",v)},m=()=>{r(),u()},v=()=>{l(t.error||new DOMException("AbortError","AbortError")),u()};t.addEventListener("complete",m),t.addEventListener("error",v),t.addEventListener("abort",v)});Aw.set(t,e)}let Iw={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Aw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||WP.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return uh(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function c8(t){Iw=t(Iw)}function u8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const l=t.call(S1(this),e,...r);return WP.set(l,e.sort?e.sort():[e]),uh(l)}:o8().includes(t)?function(...e){return t.apply(S1(this),e),uh(HP.get(this))}:function(...e){return uh(t.apply(S1(this),e))}}function d8(t){return typeof t=="function"?u8(t):(t instanceof IDBTransaction&&l8(t),i8(t,s8())?new Proxy(t,Iw):t)}function uh(t){if(t instanceof IDBRequest)return a8(t);if(T1.has(t))return T1.get(t);const e=d8(t);return e!==t&&(T1.set(t,e),nT.set(e,t)),e}const S1=t=>nT.get(t);function h8(t,e,{blocked:r,upgrade:l,blocking:u,terminated:m}={}){const v=indexedDB.open(t,e),b=uh(v);return l&&v.addEventListener("upgradeneeded",a=>{l(uh(v.result),a.oldVersion,a.newVersion,uh(v.transaction),a)}),r&&v.addEventListener("blocked",a=>r(a.oldVersion,a.newVersion,a)),b.then(a=>{m&&a.addEventListener("close",()=>m()),u&&a.addEventListener("versionchange",k=>u(k.oldVersion,k.newVersion,k))}).catch(()=>{}),b}const f8=["get","getKey","getAll","getAllKeys","count"],p8=["put","add","delete","clear"],E1=new Map;function ik(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(E1.get(e))return E1.get(e);const r=e.replace(/FromIndex$/,""),l=e!==r,u=p8.includes(r);if(!(r in(l?IDBIndex:IDBObjectStore).prototype)||!(u||f8.includes(r)))return;const m=async function(v,...b){const a=this.transaction(v,u?"readwrite":"readonly");let k=a.store;return l&&(k=k.index(b.shift())),(await Promise.all([k[r](...b),u&&a.done]))[0]};return E1.set(e,m),m}c8(t=>({...t,get:(e,r,l)=>ik(e,r)||t.get(e,r,l),has:(e,r)=>!!ik(e,r)||t.has(e,r)}));class m8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(g8(r)){const l=r.getImmediate();return`${l.library}/${l.version}`}else return null}).filter(r=>r).join(" ")}}function g8(t){return t.getComponent()?.type==="VERSION"}const Mw="@firebase/app",sk="0.14.7";const Xu=new GP("@firebase/app"),y8="@firebase/app-compat",_8="@firebase/analytics-compat",x8="@firebase/analytics",v8="@firebase/app-check-compat",w8="@firebase/app-check",b8="@firebase/auth",T8="@firebase/auth-compat",S8="@firebase/database",E8="@firebase/data-connect",C8="@firebase/database-compat",k8="@firebase/functions",A8="@firebase/functions-compat",I8="@firebase/installations",M8="@firebase/installations-compat",P8="@firebase/messaging",N8="@firebase/messaging-compat",R8="@firebase/performance",D8="@firebase/performance-compat",L8="@firebase/remote-config",j8="@firebase/remote-config-compat",O8="@firebase/storage",z8="@firebase/storage-compat",B8="@firebase/firestore",F8="@firebase/ai",V8="@firebase/firestore-compat",U8="firebase",$8="12.8.0";const Pw="[DEFAULT]",G8={[Mw]:"fire-core",[y8]:"fire-core-compat",[x8]:"fire-analytics",[_8]:"fire-analytics-compat",[w8]:"fire-app-check",[v8]:"fire-app-check-compat",[b8]:"fire-auth",[T8]:"fire-auth-compat",[S8]:"fire-rtdb",[E8]:"fire-data-connect",[C8]:"fire-rtdb-compat",[k8]:"fire-fn",[A8]:"fire-fn-compat",[I8]:"fire-iid",[M8]:"fire-iid-compat",[P8]:"fire-fcm",[N8]:"fire-fcm-compat",[R8]:"fire-perf",[D8]:"fire-perf-compat",[L8]:"fire-rc",[j8]:"fire-rc-compat",[O8]:"fire-gcs",[z8]:"fire-gcs-compat",[B8]:"fire-fst",[V8]:"fire-fst-compat",[F8]:"fire-vertex","fire-js":"fire-js",[U8]:"fire-js-all"};const Jx=new Map,H8=new Map,Nw=new Map;function ok(t,e){try{t.container.addComponent(e)}catch(r){Xu.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ly(t){const e=t.name;if(Nw.has(e))return Xu.debug(`There were multiple attempts to register component ${e}.`),!1;Nw.set(e,t);for(const r of Jx.values())ok(r,t);for(const r of H8.values())ok(r,t);return!0}function qP(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ul(t){return t==null?!1:t.settings!==void 0}const W8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},dh=new r_("app","Firebase",W8);class q8{constructor(e,r,l){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=l,this.container.addComponent(new zm("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dh.create("app-deleted",{appName:this._name})}}const s_=$8;function ZP(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const l={name:Pw,automaticDataCollectionEnabled:!0,...e},u=l.name;if(typeof u!="string"||!u)throw dh.create("bad-app-name",{appName:String(u)});if(r||(r=UP()),!r)throw dh.create("no-options");const m=Jx.get(u);if(m){if(Om(r,m.options)&&Om(l,m.config))return m;throw dh.create("duplicate-app",{appName:u})}const v=new QV(u);for(const a of Nw.values())v.addComponent(a);const b=new q8(r,l,v);return Jx.set(u,b),b}function Z8(t=Pw){const e=Jx.get(t);if(!e&&t===Pw&&UP())return ZP();if(!e)throw dh.create("no-app",{appName:t});return e}function km(t,e,r){let l=G8[t]??t;r&&(l+=`-${r}`);const u=l.match(/\s|\//),m=e.match(/\s|\//);if(u||m){const v=[`Unable to register library "${l}" with version "${e}":`];u&&v.push(`library name "${l}" contains illegal characters (whitespace or "/")`),u&&m&&v.push("and"),m&&v.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xu.warn(v.join(" "));return}Ly(new zm(`${l}-version`,()=>({library:l,version:e}),"VERSION"))}const X8="firebase-heartbeat-database",K8=1,jy="firebase-heartbeat-store";let C1=null;function XP(){return C1||(C1=h8(X8,K8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(jy)}catch(r){console.warn(r)}}}}).catch(t=>{throw dh.create("idb-open",{originalErrorMessage:t.message})})),C1}async function Y8(t){try{const r=(await XP()).transaction(jy),l=await r.objectStore(jy).get(KP(t));return await r.done,l}catch(e){if(e instanceof bh)Xu.warn(e.message);else{const r=dh.create("idb-get",{originalErrorMessage:e?.message});Xu.warn(r.message)}}}async function ak(t,e){try{const l=(await XP()).transaction(jy,"readwrite");await l.objectStore(jy).put(e,KP(t)),await l.done}catch(r){if(r instanceof bh)Xu.warn(r.message);else{const l=dh.create("idb-set",{originalErrorMessage:r?.message});Xu.warn(l.message)}}}function KP(t){return`${t.name}!${t.options.appId}`}const J8=1024,Q8=30;class eU{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new nU(r),this._heartbeatsCachePromise=this._storage.read().then(l=>(this._heartbeatsCache=l,l))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=lk();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:r}),this._heartbeatsCache.heartbeats.length>Q8){const u=rU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xu.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=lk(),{heartbeatsToSend:r,unsentEntries:l}=tU(this._heartbeatsCache.heartbeats),u=FP(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,l.length>0?(this._heartbeatsCache.heartbeats=l,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(e){return Xu.warn(e),""}}}function lk(){return new Date().toISOString().substring(0,10)}function tU(t,e=J8){const r=[];let l=t.slice();for(const u of t){const m=r.find(v=>v.agent===u.agent);if(m){if(m.dates.push(u.date),ck(r)>e){m.dates.pop();break}}else if(r.push({agent:u.agent,dates:[u.date]}),ck(r)>e){r.pop();break}l=l.slice(1)}return{heartbeatsToSend:r,unsentEntries:l}}class nU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return VV()?UV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await Y8(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return ak(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return ak(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:[...l.heartbeats,...e.heartbeats]})}else return}}function ck(t){return FP(JSON.stringify({version:2,heartbeats:t})).length}function rU(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let l=1;l<t.length;l++)t[l].date<r&&(r=t[l].date,e=l);return e}function iU(t){Ly(new zm("platform-logger",e=>new m8(e),"PRIVATE")),Ly(new zm("heartbeat",e=>new eU(e),"PRIVATE")),km(Mw,sk,t),km(Mw,sk,"esm2020"),km("fire-js","")}iU("");function YP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const sU=YP,JP=new r_("auth","Firebase",YP());const Qx=new GP("@firebase/auth");function oU(t,...e){Qx.logLevel<=qr.WARN&&Qx.warn(`Auth (${s_}): ${t}`,...e)}function Nx(t,...e){Qx.logLevel<=qr.ERROR&&Qx.error(`Auth (${s_}): ${t}`,...e)}function Wl(t,...e){throw rT(t,...e)}function Hc(t,...e){return rT(t,...e)}function QP(t,e,r){const l={...sU(),[e]:r};return new r_("auth","Firebase",l).create(e,{appName:t.name})}function Hu(t){return QP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function rT(t,...e){if(typeof t!="string"){const r=e[0],l=[...e.slice(1)];return l[0]&&(l[0].appName=t.name),t._errorFactory.create(r,...l)}return JP.create(t,...e)}function Un(t,e,...r){if(!t)throw rT(e,...r)}function $u(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Nx(e),new Error(e)}function Ku(t,e){t||$u(e)}function Rw(){return typeof self<"u"&&self.location?.href||""}function aU(){return uk()==="http:"||uk()==="https:"}function uk(){return typeof self<"u"&&self.location?.protocol||null}function lU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(aU()||zV()||"connection"in navigator)?navigator.onLine:!0}function cU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class o_{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ku(r>e,"Short delay should be less than long delay!"),this.isMobile=jV()||BV()}get(){return lU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function iT(t,e){Ku(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class eN{static initialize(e,r,l){this.fetchImpl=e,r&&(this.headersImpl=r),l&&(this.responseImpl=l)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$u("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$u("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$u("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const uU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const dU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],hU=new o_(3e4,6e4);function Th(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function Sh(t,e,r,l,u={}){return tN(t,u,async()=>{let m={},v={};l&&(e==="GET"?v=l:m={body:JSON.stringify(l)});const b=i_({key:t.config.apiKey,...v}).slice(1),a=await t._getAdditionalHeaders();a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode);const k={method:e,headers:a,...m};return OV()||(k.referrerPolicy="no-referrer"),t.emulatorConfig&&$v(t.emulatorConfig.host)&&(k.credentials="include"),eN.fetch()(await nN(t,t.config.apiHost,r,b),k)})}async function tN(t,e,r){t._canInitEmulator=!1;const l={...uU,...e};try{const u=new pU(t),m=await Promise.race([r(),u.promise]);u.clearNetworkTimeout();const v=await m.json();if("needConfirmation"in v)throw px(t,"account-exists-with-different-credential",v);if(m.ok&&!("errorMessage"in v))return v;{const b=m.ok?v.errorMessage:v.error.message,[a,k]=b.split(" : ");if(a==="FEDERATED_USER_ID_ALREADY_LINKED")throw px(t,"credential-already-in-use",v);if(a==="EMAIL_EXISTS")throw px(t,"email-already-in-use",v);if(a==="USER_DISABLED")throw px(t,"user-disabled",v);const M=l[a]||a.toLowerCase().replace(/[_\s]+/g,"-");if(k)throw QP(t,M,k);Wl(t,M)}}catch(u){if(u instanceof bh)throw u;Wl(t,"network-request-failed",{message:String(u)})}}async function a_(t,e,r,l,u={}){const m=await Sh(t,e,r,l,u);return"mfaPendingCredential"in m&&Wl(t,"multi-factor-auth-required",{_serverResponse:m}),m}async function nN(t,e,r,l){const u=`${e}${r}?${l}`,m=t,v=m.config.emulator?iT(t.config,u):`${t.config.apiScheme}://${u}`;return dU.includes(r)&&(await m._persistenceManagerAvailable,m._getPersistenceType()==="COOKIE")?m._getPersistence()._getFinalTarget(v).toString():v}function fU(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class pU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,l)=>{this.timer=setTimeout(()=>l(Hc(this.auth,"network-request-failed")),hU.get())})}}function px(t,e,r){const l={appName:t.name};r.email&&(l.email=r.email),r.phoneNumber&&(l.phoneNumber=r.phoneNumber);const u=Hc(t,e,l);return u.customData._tokenResponse=r,u}function dk(t){return t!==void 0&&t.enterprise!==void 0}class mU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return fU(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function gU(t,e){return Sh(t,"GET","/v2/recaptchaConfig",Th(t,e))}async function yU(t,e){return Sh(t,"POST","/v1/accounts:delete",e)}async function ev(t,e){return Sh(t,"POST","/v1/accounts:lookup",e)}function vy(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function _U(t,e=!1){const r=td(t),l=await r.getIdToken(e),u=sT(l);Un(u&&u.exp&&u.auth_time&&u.iat,r.auth,"internal-error");const m=typeof u.firebase=="object"?u.firebase:void 0,v=m?.sign_in_provider;return{claims:u,token:l,authTime:vy(k1(u.auth_time)),issuedAtTime:vy(k1(u.iat)),expirationTime:vy(k1(u.exp)),signInProvider:v||null,signInSecondFactor:m?.sign_in_second_factor||null}}function k1(t){return Number(t)*1e3}function sT(t){const[e,r,l]=t.split(".");if(e===void 0||r===void 0||l===void 0)return Nx("JWT malformed, contained fewer than 3 sections"),null;try{const u=VP(r);return u?JSON.parse(u):(Nx("Failed to decode base64 JWT payload"),null)}catch(u){return Nx("Caught error parsing JWT payload as JSON",u?.toString()),null}}function hk(t){const e=sT(t);return Un(e,"internal-error"),Un(typeof e.exp<"u","internal-error"),Un(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Oy(t,e,r=!1){if(r)return e;try{return await e}catch(l){throw l instanceof bh&&xU(l)&&t.auth.currentUser===t&&await t.auth.signOut(),l}}function xU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class vU{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const l=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,l)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Dw{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=vy(this.lastLoginAt),this.creationTime=vy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tv(t){const e=t.auth,r=await t.getIdToken(),l=await Oy(t,ev(e,{idToken:r}));Un(l?.users.length,e,"internal-error");const u=l.users[0];t._notifyReloadListener(u);const m=u.providerUserInfo?.length?rN(u.providerUserInfo):[],v=bU(t.providerData,m),b=t.isAnonymous,a=!(t.email&&u.passwordHash)&&!v?.length,k=b?a:!1,M={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:v,metadata:new Dw(u.createdAt,u.lastLoginAt),isAnonymous:k};Object.assign(t,M)}async function wU(t){const e=td(t);await tv(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function bU(t,e){return[...t.filter(l=>!e.some(u=>u.providerId===l.providerId)),...e]}function rN(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function TU(t,e){const r=await tN(t,{},async()=>{const l=i_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:u,apiKey:m}=t.config,v=await nN(t,u,"/v1/token",`key=${m}`),b=await t._getAdditionalHeaders();b["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:b,body:l};return t.emulatorConfig&&$v(t.emulatorConfig.host)&&(a.credentials="include"),eN.fetch()(v,a)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function SU(t,e){return Sh(t,"POST","/v2/accounts:revokeToken",Th(t,e))}class Am{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Un(e.idToken,"internal-error"),Un(typeof e.idToken<"u","internal-error"),Un(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):hk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Un(e.length!==0,"internal-error");const r=hk(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Un(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:l,refreshToken:u,expiresIn:m}=await TU(e,r);this.updateTokensAndExpiration(l,u,Number(m))}updateTokensAndExpiration(e,r,l){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+l*1e3}static fromJSON(e,r){const{refreshToken:l,accessToken:u,expirationTime:m}=r,v=new Am;return l&&(Un(typeof l=="string","internal-error",{appName:e}),v.refreshToken=l),u&&(Un(typeof u=="string","internal-error",{appName:e}),v.accessToken=u),m&&(Un(typeof m=="number","internal-error",{appName:e}),v.expirationTime=m),v}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Am,this.toJSON())}_performRefresh(){return $u("not implemented")}}function Xd(t,e){Un(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $l{constructor({uid:e,auth:r,stsTokenManager:l,...u}){this.providerId="firebase",this.proactiveRefresh=new vU(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=l,this.accessToken=l.accessToken,this.displayName=u.displayName||null,this.email=u.email||null,this.emailVerified=u.emailVerified||!1,this.phoneNumber=u.phoneNumber||null,this.photoURL=u.photoURL||null,this.isAnonymous=u.isAnonymous||!1,this.tenantId=u.tenantId||null,this.providerData=u.providerData?[...u.providerData]:[],this.metadata=new Dw(u.createdAt||void 0,u.lastLoginAt||void 0)}async getIdToken(e){const r=await Oy(this,this.stsTokenManager.getToken(this.auth,e));return Un(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return _U(this,e)}reload(){return wU(this)}_assign(e){this!==e&&(Un(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new $l({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Un(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let l=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),l=!0),r&&await tv(this),await this.auth._persistUserIfCurrent(this),l&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ul(this.auth.app))return Promise.reject(Hu(this.auth));const e=await this.getIdToken();return await Oy(this,yU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const l=r.displayName??void 0,u=r.email??void 0,m=r.phoneNumber??void 0,v=r.photoURL??void 0,b=r.tenantId??void 0,a=r._redirectEventId??void 0,k=r.createdAt??void 0,M=r.lastLoginAt??void 0,{uid:L,emailVerified:z,isAnonymous:O,providerData:K,stsTokenManager:H}=r;Un(L&&H,e,"internal-error");const Z=Am.fromJSON(this.name,H);Un(typeof L=="string",e,"internal-error"),Xd(l,e.name),Xd(u,e.name),Un(typeof z=="boolean",e,"internal-error"),Un(typeof O=="boolean",e,"internal-error"),Xd(m,e.name),Xd(v,e.name),Xd(b,e.name),Xd(a,e.name),Xd(k,e.name),Xd(M,e.name);const Y=new $l({uid:L,auth:e,email:u,emailVerified:z,displayName:l,isAnonymous:O,photoURL:v,phoneNumber:m,tenantId:b,stsTokenManager:Z,createdAt:k,lastLoginAt:M});return K&&Array.isArray(K)&&(Y.providerData=K.map(ee=>({...ee}))),a&&(Y._redirectEventId=a),Y}static async _fromIdTokenResponse(e,r,l=!1){const u=new Am;u.updateFromServerResponse(r);const m=new $l({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:l});return await tv(m),m}static async _fromGetAccountInfoResponse(e,r,l){const u=r.users[0];Un(u.localId!==void 0,"internal-error");const m=u.providerUserInfo!==void 0?rN(u.providerUserInfo):[],v=!(u.email&&u.passwordHash)&&!m?.length,b=new Am;b.updateFromIdToken(l);const a=new $l({uid:u.localId,auth:e,stsTokenManager:b,isAnonymous:v}),k={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:m,metadata:new Dw(u.createdAt,u.lastLoginAt),isAnonymous:!(u.email&&u.passwordHash)&&!m?.length};return Object.assign(a,k),a}}const fk=new Map;function Gu(t){Ku(t instanceof Function,"Expected a class definition");let e=fk.get(t);return e?(Ku(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,fk.set(t,e),e)}class iN{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}iN.type="NONE";const pk=iN;function Rx(t,e,r){return`firebase:${t}:${e}:${r}`}class Im{constructor(e,r,l){this.persistence=e,this.auth=r,this.userKey=l;const{config:u,name:m}=this.auth;this.fullUserKey=Rx(this.userKey,u.apiKey,m),this.fullPersistenceKey=Rx("persistence",u.apiKey,m),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await ev(this.auth,{idToken:e}).catch(()=>{});return r?$l._fromGetAccountInfoResponse(this.auth,r,e):null}return $l._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,l="authUser"){if(!r.length)return new Im(Gu(pk),e,l);const u=(await Promise.all(r.map(async k=>{if(await k._isAvailable())return k}))).filter(k=>k);let m=u[0]||Gu(pk);const v=Rx(l,e.config.apiKey,e.name);let b=null;for(const k of r)try{const M=await k._get(v);if(M){let L;if(typeof M=="string"){const z=await ev(e,{idToken:M}).catch(()=>{});if(!z)break;L=await $l._fromGetAccountInfoResponse(e,z,M)}else L=$l._fromJSON(e,M);k!==m&&(b=L),m=k;break}}catch{}const a=u.filter(k=>k._shouldAllowMigration);return!m._shouldAllowMigration||!a.length?new Im(m,e,l):(m=a[0],b&&await m._set(v,b.toJSON()),await Promise.all(r.map(async k=>{if(k!==m)try{await k._remove(v)}catch{}})),new Im(m,e,l))}}function mk(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(lN(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(sN(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(uN(e))return"Blackberry";if(dN(e))return"Webos";if(oN(e))return"Safari";if((e.includes("chrome/")||aN(e))&&!e.includes("edge/"))return"Chrome";if(cN(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,l=t.match(r);if(l?.length===2)return l[1]}return"Other"}function sN(t=Oo()){return/firefox\//i.test(t)}function oN(t=Oo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function aN(t=Oo()){return/crios\//i.test(t)}function lN(t=Oo()){return/iemobile/i.test(t)}function cN(t=Oo()){return/android/i.test(t)}function uN(t=Oo()){return/blackberry/i.test(t)}function dN(t=Oo()){return/webos/i.test(t)}function oT(t=Oo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function EU(t=Oo()){return oT(t)&&!!window.navigator?.standalone}function CU(){return FV()&&document.documentMode===10}function hN(t=Oo()){return oT(t)||cN(t)||dN(t)||uN(t)||/windows phone/i.test(t)||lN(t)}function fN(t,e=[]){let r;switch(t){case"Browser":r=mk(Oo());break;case"Worker":r=`${mk(Oo())}-${t}`;break;default:r=t}const l=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${s_}/${l}`}class kU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const l=m=>new Promise((v,b)=>{try{const a=e(m);v(a)}catch(a){b(a)}});l.onAbort=r,this.queue.push(l);const u=this.queue.length-1;return()=>{this.queue[u]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const l of this.queue)await l(e),l.onAbort&&r.push(l.onAbort)}catch(l){r.reverse();for(const u of r)try{u()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:l?.message})}}}async function AU(t,e={}){return Sh(t,"GET","/v2/passwordPolicy",Th(t,e))}const IU=6;class MU{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??IU,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const l=this.customStrengthOptions.minPasswordLength,u=this.customStrengthOptions.maxPasswordLength;l&&(r.meetsMinPasswordLength=e.length>=l),u&&(r.meetsMaxPasswordLength=e.length<=u)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let l;for(let u=0;u<e.length;u++)l=e.charAt(u),this.updatePasswordCharacterOptionsStatuses(r,l>="a"&&l<="z",l>="A"&&l<="Z",l>="0"&&l<="9",this.allowedNonAlphanumericCharacters.includes(l))}updatePasswordCharacterOptionsStatuses(e,r,l,u,m){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=l)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=u)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=m))}}class PU{constructor(e,r,l,u){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=l,this.config=u,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new gk(this),this.idTokenSubscription=new gk(this),this.beforeStateQueue=new kU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=JP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=u.sdkClientVersion,this._persistenceManagerAvailable=new Promise(m=>this._resolvePersistenceManagerAvailable=m)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gu(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Im.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await ev(this,{idToken:e}),l=await $l._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(l)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ul(this.app)){const m=this.app.settings.authIdToken;return m?new Promise(v=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(m).then(v,v))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let l=r,u=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const m=this.redirectUser?._redirectEventId,v=l?._redirectEventId,b=await this.tryRedirectSignIn(e);(!m||m===v)&&b?.user&&(l=b.user,u=!0)}if(!l)return this.directlySetCurrentUser(null);if(!l._redirectEventId){if(u)try{await this.beforeStateQueue.runMiddleware(l)}catch(m){l=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(m))}return l?this.reloadAndSetCurrentUserOrClear(l):this.directlySetCurrentUser(null)}return Un(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===l._redirectEventId?this.directlySetCurrentUser(l):this.reloadAndSetCurrentUserOrClear(l)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await tv(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=cU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ul(this.app))return Promise.reject(Hu(this));const r=e?td(e):null;return r&&Un(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Un(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ul(this.app)?Promise.reject(Hu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ul(this.app)?Promise.reject(Hu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await AU(this),r=new MU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new r_("auth","Firebase",e())}onAuthStateChanged(e,r,l){return this.registerStateListener(this.authStateSubscription,e,r,l)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,l){return this.registerStateListener(this.idTokenSubscription,e,r,l)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const l=this.onAuthStateChanged(()=>{l(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),l={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(l.tenantId=this.tenantId),await SU(this,l)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const l=await this.getOrInitRedirectPersistenceManager(r);return e===null?l.removeCurrentUser():l.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gu(e)||this._popupRedirectResolver;Un(r,this,"argument-error"),this.redirectPersistenceManager=await Im.create(this,[Gu(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,l,u){if(this._deleted)return()=>{};const m=typeof r=="function"?r:r.next.bind(r);let v=!1;const b=this._isInitialized?Promise.resolve():this._initializationPromise;if(Un(b,this,"internal-error"),b.then(()=>{v||m(this.currentUser)}),typeof r=="function"){const a=e.addObserver(r,l,u);return()=>{v=!0,a()}}else{const a=e.addObserver(r);return()=>{v=!0,a()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Un(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=fN(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const l=await this._getAppCheckToken();return l&&(e["X-Firebase-AppCheck"]=l),e}async _getAppCheckToken(){if(Ul(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&oU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function op(t){return td(t)}class gk{constructor(e){this.auth=e,this.observer=null,this.addObserver=qV(r=>this.observer=r)}get next(){return Un(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Gv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function NU(t){Gv=t}function pN(t){return Gv.loadJS(t)}function RU(){return Gv.recaptchaEnterpriseScript}function DU(){return Gv.gapiScript}function LU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class jU{constructor(){this.enterprise=new OU}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class OU{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const zU="recaptcha-enterprise",mN="NO_RECAPTCHA";class BU{constructor(e){this.type=zU,this.auth=op(e)}async verify(e="verify",r=!1){async function l(m){if(!r){if(m.tenantId==null&&m._agentRecaptchaConfig!=null)return m._agentRecaptchaConfig.siteKey;if(m.tenantId!=null&&m._tenantRecaptchaConfigs[m.tenantId]!==void 0)return m._tenantRecaptchaConfigs[m.tenantId].siteKey}return new Promise(async(v,b)=>{gU(m,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(a=>{if(a.recaptchaKey===void 0)b(new Error("recaptcha Enterprise site key undefined"));else{const k=new mU(a);return m.tenantId==null?m._agentRecaptchaConfig=k:m._tenantRecaptchaConfigs[m.tenantId]=k,v(k.siteKey)}}).catch(a=>{b(a)})})}function u(m,v,b){const a=window.grecaptcha;dk(a)?a.enterprise.ready(()=>{a.enterprise.execute(m,{action:e}).then(k=>{v(k)}).catch(()=>{v(mN)})}):b(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new jU().execute("siteKey",{action:"verify"}):new Promise((m,v)=>{l(this.auth).then(b=>{if(!r&&dk(window.grecaptcha))u(b,m,v);else{if(typeof window>"u"){v(new Error("RecaptchaVerifier is only supported in browser"));return}let a=RU();a.length!==0&&(a+=b),pN(a).then(()=>{u(b,m,v)}).catch(k=>{v(k)})}}).catch(b=>{v(b)})})}}async function yk(t,e,r,l=!1,u=!1){const m=new BU(t);let v;if(u)v=mN;else try{v=await m.verify(r)}catch{v=await m.verify(r,!0)}const b={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in b){const a=b.phoneEnrollmentInfo.phoneNumber,k=b.phoneEnrollmentInfo.recaptchaToken;Object.assign(b,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:k,captchaResponse:v,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in b){const a=b.phoneSignInInfo.recaptchaToken;Object.assign(b,{phoneSignInInfo:{recaptchaToken:a,captchaResponse:v,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return b}return l?Object.assign(b,{captchaResp:v}):Object.assign(b,{captchaResponse:v}),Object.assign(b,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(b,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),b}async function Lw(t,e,r,l,u){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const m=await yk(t,e,r,r==="getOobCode");return l(t,m)}else return l(t,e).catch(async m=>{if(m.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const v=await yk(t,e,r,r==="getOobCode");return l(t,v)}else return Promise.reject(m)})}function FU(t,e){const r=qP(t,"auth");if(r.isInitialized()){const u=r.getImmediate(),m=r.getOptions();if(Om(m,e??{}))return u;Wl(u,"already-initialized")}return r.initialize({options:e})}function VU(t,e){const r=e?.persistence||[],l=(Array.isArray(r)?r:[r]).map(Gu);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(l,e?.popupRedirectResolver)}function UU(t,e,r){const l=op(t);Un(/^https?:\/\//.test(e),l,"invalid-emulator-scheme");const u=!1,m=gN(e),{host:v,port:b}=$U(e),a=b===null?"":`:${b}`,k={url:`${m}//${v}${a}/`},M=Object.freeze({host:v,port:b,protocol:m.replace(":",""),options:Object.freeze({disableWarnings:u})});if(!l._canInitEmulator){Un(l.config.emulator&&l.emulatorConfig,l,"emulator-config-failed"),Un(Om(k,l.config.emulator)&&Om(M,l.emulatorConfig),l,"emulator-config-failed");return}l.config.emulator=k,l.emulatorConfig=M,l.settings.appVerificationDisabledForTesting=!0,$v(v)?(NV(`${m}//${v}${a}`),LV("Auth",!0)):GU()}function gN(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function $U(t){const e=gN(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const l=r[2].split("@").pop()||"",u=/^(\[[^\]]+\])(:|$)/.exec(l);if(u){const m=u[1];return{host:m,port:_k(l.substr(m.length+1))}}else{const[m,v]=l.split(":");return{host:m,port:_k(v)}}}function _k(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function GU(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class aT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return $u("not implemented")}_getIdTokenResponse(e){return $u("not implemented")}_linkToIdToken(e,r){return $u("not implemented")}_getReauthenticationResolver(e){return $u("not implemented")}}async function HU(t,e){return Sh(t,"POST","/v1/accounts:signUp",e)}async function WU(t,e){return a_(t,"POST","/v1/accounts:signInWithPassword",Th(t,e))}async function qU(t,e){return a_(t,"POST","/v1/accounts:signInWithEmailLink",Th(t,e))}async function ZU(t,e){return a_(t,"POST","/v1/accounts:signInWithEmailLink",Th(t,e))}class zy extends aT{constructor(e,r,l,u=null){super("password",l),this._email=e,this._password=r,this._tenantId=u}static _fromEmailAndPassword(e,r){return new zy(e,r,"password")}static _fromEmailAndCode(e,r,l=null){return new zy(e,r,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lw(e,r,"signInWithPassword",WU);case"emailLink":return qU(e,{email:this._email,oobCode:this._password});default:Wl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const l={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Lw(e,l,"signUpPassword",HU);case"emailLink":return ZU(e,{idToken:r,email:this._email,oobCode:this._password});default:Wl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Mm(t,e){return a_(t,"POST","/v1/accounts:signInWithIdp",Th(t,e))}const XU="http://localhost";class Yf extends aT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Yf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:l,signInMethod:u,...m}=r;if(!l||!u)return null;const v=new Yf(l,u);return v.idToken=m.idToken||void 0,v.accessToken=m.accessToken||void 0,v.secret=m.secret,v.nonce=m.nonce,v.pendingToken=m.pendingToken||null,v}_getIdTokenResponse(e){const r=this.buildRequest();return Mm(e,r)}_linkToIdToken(e,r){const l=this.buildRequest();return l.idToken=r,Mm(e,l)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Mm(e,r)}buildRequest(){const e={requestUri:XU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=i_(r)}return e}}function KU(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function YU(t){const e=oy(ay(t)).link,r=e?oy(ay(e)).deep_link_id:null,l=oy(ay(t)).deep_link_id;return(l?oy(ay(l)).link:null)||l||r||e||t}class lT{constructor(e){const r=oy(ay(e)),l=r.apiKey??null,u=r.oobCode??null,m=KU(r.mode??null);Un(l&&u&&m,"argument-error"),this.apiKey=l,this.operation=m,this.code=u,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=YU(e);try{return new lT(r)}catch{return null}}}class eg{constructor(){this.providerId=eg.PROVIDER_ID}static credential(e,r){return zy._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const l=lT.parseLink(r);return Un(l,"argument-error"),zy._fromEmailAndCode(e,l.code,l.tenantId)}}eg.PROVIDER_ID="password";eg.EMAIL_PASSWORD_SIGN_IN_METHOD="password";eg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class yN{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class l_ extends yN{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qd extends l_{constructor(){super("facebook.com")}static credential(e){return Yf._fromParams({providerId:Qd.PROVIDER_ID,signInMethod:Qd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qd.credentialFromTaggedObject(e)}static credentialFromError(e){return Qd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qd.credential(e.oauthAccessToken)}catch{return null}}}Qd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qd.PROVIDER_ID="facebook.com";class eh extends l_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Yf._fromParams({providerId:eh.PROVIDER_ID,signInMethod:eh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return eh.credentialFromTaggedObject(e)}static credentialFromError(e){return eh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:l}=e;if(!r&&!l)return null;try{return eh.credential(r,l)}catch{return null}}}eh.GOOGLE_SIGN_IN_METHOD="google.com";eh.PROVIDER_ID="google.com";class th extends l_{constructor(){super("github.com")}static credential(e){return Yf._fromParams({providerId:th.PROVIDER_ID,signInMethod:th.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return th.credentialFromTaggedObject(e)}static credentialFromError(e){return th.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return th.credential(e.oauthAccessToken)}catch{return null}}}th.GITHUB_SIGN_IN_METHOD="github.com";th.PROVIDER_ID="github.com";class nh extends l_{constructor(){super("twitter.com")}static credential(e,r){return Yf._fromParams({providerId:nh.PROVIDER_ID,signInMethod:nh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return nh.credentialFromTaggedObject(e)}static credentialFromError(e){return nh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:l}=e;if(!r||!l)return null;try{return nh.credential(r,l)}catch{return null}}}nh.TWITTER_SIGN_IN_METHOD="twitter.com";nh.PROVIDER_ID="twitter.com";async function JU(t,e){return a_(t,"POST","/v1/accounts:signUp",Th(t,e))}class Jf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,l,u=!1){const m=await $l._fromIdTokenResponse(e,l,u),v=xk(l);return new Jf({user:m,providerId:v,_tokenResponse:l,operationType:r})}static async _forOperation(e,r,l){await e._updateTokensIfNecessary(l,!0);const u=xk(l);return new Jf({user:e,providerId:u,_tokenResponse:l,operationType:r})}}function xk(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class nv extends bh{constructor(e,r,l,u){super(r.code,r.message),this.operationType=l,this.user=u,Object.setPrototypeOf(this,nv.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(e,r,l,u){return new nv(e,r,l,u)}}function _N(t,e,r,l){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(m=>{throw m.code==="auth/multi-factor-auth-required"?nv._fromErrorAndOperation(t,m,e,l):m})}async function QU(t,e,r=!1){const l=await Oy(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Jf._forOperation(t,"link",l)}async function e2(t,e,r=!1){const{auth:l}=t;if(Ul(l.app))return Promise.reject(Hu(l));const u="reauthenticate";try{const m=await Oy(t,_N(l,u,e,t),r);Un(m.idToken,l,"internal-error");const v=sT(m.idToken);Un(v,l,"internal-error");const{sub:b}=v;return Un(t.uid===b,l,"user-mismatch"),Jf._forOperation(t,u,m)}catch(m){throw m?.code==="auth/user-not-found"&&Wl(l,"user-mismatch"),m}}async function xN(t,e,r=!1){if(Ul(t.app))return Promise.reject(Hu(t));const l="signIn",u=await _N(t,l,e),m=await Jf._fromIdTokenResponse(t,l,u);return r||await t._updateCurrentUser(m.user),m}async function t2(t,e){return xN(op(t),e)}async function vN(t){const e=op(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function n2(t,e,r){if(Ul(t.app))return Promise.reject(Hu(t));const l=op(t),v=await Lw(l,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",JU).catch(a=>{throw a.code==="auth/password-does-not-meet-requirements"&&vN(t),a}),b=await Jf._fromIdTokenResponse(l,"signIn",v);return await l._updateCurrentUser(b.user),b}function r2(t,e,r){return Ul(t.app)?Promise.reject(Hu(t)):t2(td(t),eg.credential(e,r)).catch(async l=>{throw l.code==="auth/password-does-not-meet-requirements"&&vN(t),l})}function i2(t,e,r,l){return td(t).onIdTokenChanged(e,r,l)}function s2(t,e,r){return td(t).beforeAuthStateChanged(e,r)}function o2(t,e,r,l){return td(t).onAuthStateChanged(e,r,l)}function a2(t){return td(t).signOut()}const rv="__sak";class wN{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(rv,"1"),this.storage.removeItem(rv),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const l2=1e3,c2=10;class bN extends wN{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=hN(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const l=this.storage.getItem(r),u=this.localCache[r];l!==u&&e(r,u,l)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((v,b,a)=>{this.notifyListeners(v,a)});return}const l=e.key;r?this.detachListener():this.stopPolling();const u=()=>{const v=this.storage.getItem(l);!r&&this.localCache[l]===v||this.notifyListeners(l,v)},m=this.storage.getItem(l);CU()&&m!==e.newValue&&e.newValue!==e.oldValue?setTimeout(u,c2):u()}notifyListeners(e,r){this.localCache[e]=r;const l=this.listeners[e];if(l)for(const u of Array.from(l))u(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,l)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:l}),!0)})},l2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}bN.type="LOCAL";const u2=bN;class TN extends wN{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}TN.type="SESSION";const SN=TN;function d2(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class Hv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(u=>u.isListeningto(e));if(r)return r;const l=new Hv(e);return this.receivers.push(l),l}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:l,eventType:u,data:m}=r.data,v=this.handlersMap[u];if(!v?.size)return;r.ports[0].postMessage({status:"ack",eventId:l,eventType:u});const b=Array.from(v).map(async k=>k(r.origin,m)),a=await d2(b);r.ports[0].postMessage({status:"done",eventId:l,eventType:u,response:a})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Hv.receivers=[];function cT(t="",e=10){let r="";for(let l=0;l<e;l++)r+=Math.floor(Math.random()*10);return t+r}class h2{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,l=50){const u=typeof MessageChannel<"u"?new MessageChannel:null;if(!u)throw new Error("connection_unavailable");let m,v;return new Promise((b,a)=>{const k=cT("",20);u.port1.start();const M=setTimeout(()=>{a(new Error("unsupported_event"))},l);v={messageChannel:u,onMessage(L){const z=L;if(z.data.eventId===k)switch(z.data.status){case"ack":clearTimeout(M),m=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(m),b(z.data.response);break;default:clearTimeout(M),clearTimeout(m),a(new Error("invalid_response"));break}}},this.handlers.add(v),u.port1.addEventListener("message",v.onMessage),this.target.postMessage({eventType:e,eventId:k,data:r},[u.port2])}).finally(()=>{v&&this.removeMessageHandler(v)})}}function Wc(){return window}function f2(t){Wc().location.href=t}function EN(){return typeof Wc().WorkerGlobalScope<"u"&&typeof Wc().importScripts=="function"}async function p2(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function m2(){return navigator?.serviceWorker?.controller||null}function g2(){return EN()?self:null}const CN="firebaseLocalStorageDb",y2=1,iv="firebaseLocalStorage",kN="fbase_key";class c_{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Wv(t,e){return t.transaction([iv],e?"readwrite":"readonly").objectStore(iv)}function _2(){const t=indexedDB.deleteDatabase(CN);return new c_(t).toPromise()}function jw(){const t=indexedDB.open(CN,y2);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const l=t.result;try{l.createObjectStore(iv,{keyPath:kN})}catch(u){r(u)}}),t.addEventListener("success",async()=>{const l=t.result;l.objectStoreNames.contains(iv)?e(l):(l.close(),await _2(),e(await jw()))})})}async function vk(t,e,r){const l=Wv(t,!0).put({[kN]:e,value:r});return new c_(l).toPromise()}async function x2(t,e){const r=Wv(t,!1).get(e),l=await new c_(r).toPromise();return l===void 0?null:l.value}function wk(t,e){const r=Wv(t,!0).delete(e);return new c_(r).toPromise()}const v2=800,w2=3;class AN{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await jw(),this.db)}async _withRetries(e){let r=0;for(;;)try{const l=await this._openDb();return await e(l)}catch(l){if(r++>w2)throw l;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return EN()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Hv._getInstance(g2()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await p2(),!this.activeServiceWorker)return;this.sender=new h2(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||m2()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await jw();return await vk(e,rv,"1"),await wk(e,rv),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(l=>vk(l,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(l=>x2(l,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>wk(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(u=>{const m=Wv(u,!1).getAll();return new c_(m).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],l=new Set;if(e.length!==0)for(const{fbase_key:u,value:m}of e)l.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(m)&&(this.notifyListeners(u,m),r.push(u));for(const u of Object.keys(this.localCache))this.localCache[u]&&!l.has(u)&&(this.notifyListeners(u,null),r.push(u));return r}notifyListeners(e,r){this.localCache[e]=r;const l=this.listeners[e];if(l)for(const u of Array.from(l))u(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),v2)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}AN.type="LOCAL";const b2=AN;new o_(3e4,6e4);function T2(t,e){return e?Gu(e):(Un(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class uT extends aT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Mm(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Mm(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Mm(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function S2(t){return xN(t.auth,new uT(t),t.bypassAuthState)}function E2(t){const{auth:e,user:r}=t;return Un(r,e,"internal-error"),e2(r,new uT(t),t.bypassAuthState)}async function C2(t){const{auth:e,user:r}=t;return Un(r,e,"internal-error"),QU(r,new uT(t),t.bypassAuthState)}class IN{constructor(e,r,l,u,m=!1){this.auth=e,this.resolver=l,this.user=u,this.bypassAuthState=m,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(l){this.reject(l)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:l,postBody:u,tenantId:m,error:v,type:b}=e;if(v){this.reject(v);return}const a={auth:this.auth,requestUri:r,sessionId:l,tenantId:m||void 0,postBody:u||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(b)(a))}catch(k){this.reject(k)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return S2;case"linkViaPopup":case"linkViaRedirect":return C2;case"reauthViaPopup":case"reauthViaRedirect":return E2;default:Wl(this.auth,"internal-error")}}resolve(e){Ku(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ku(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const k2=new o_(2e3,1e4);class vm extends IN{constructor(e,r,l,u,m){super(e,r,u,m),this.provider=l,this.authWindow=null,this.pollId=null,vm.currentPopupAction&&vm.currentPopupAction.cancel(),vm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Un(e,this.auth,"internal-error"),e}async onExecution(){Ku(this.filter.length===1,"Popup operations only handle one event");const e=cT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Hc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Hc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,vm.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,k2.get())};e()}}vm.currentPopupAction=null;const A2="pendingRedirect",Dx=new Map;class I2 extends IN{constructor(e,r,l=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,l),this.eventId=null}async execute(){let e=Dx.get(this.auth._key());if(!e){try{const l=await M2(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(l)}catch(r){e=()=>Promise.reject(r)}Dx.set(this.auth._key(),e)}return this.bypassAuthState||Dx.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function M2(t,e){const r=R2(e),l=N2(t);if(!await l._isAvailable())return!1;const u=await l._get(r)==="true";return await l._remove(r),u}function P2(t,e){Dx.set(t._key(),e)}function N2(t){return Gu(t._redirectPersistence)}function R2(t){return Rx(A2,t.config.apiKey,t.name)}async function D2(t,e,r=!1){if(Ul(t.app))return Promise.reject(Hu(t));const l=op(t),u=T2(l,e),v=await new I2(l,u,r).execute();return v&&!r&&(delete v.user._redirectEventId,await l._persistUserIfCurrent(v.user),await l._setRedirectUser(null,e)),v}const L2=600*1e3;class j2{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(e,l)&&(r=!0,this.sendToConsumer(e,l),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!O2(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!MN(e)){const l=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Hc(this.auth,l))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const l=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&l}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=L2&&this.cachedEventUids.clear(),this.cachedEventUids.has(bk(e))}saveEventToCache(e){this.cachedEventUids.add(bk(e)),this.lastProcessedEventTime=Date.now()}}function bk(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function MN({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function O2(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return MN(t);default:return!1}}async function z2(t,e={}){return Sh(t,"GET","/v1/projects",e)}const B2=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,F2=/^https?/;async function V2(t){if(t.config.emulator)return;const{authorizedDomains:e}=await z2(t);for(const r of e)try{if(U2(r))return}catch{}Wl(t,"unauthorized-domain")}function U2(t){const e=Rw(),{protocol:r,hostname:l}=new URL(e);if(t.startsWith("chrome-extension://")){const v=new URL(t);return v.hostname===""&&l===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&v.hostname===l}if(!F2.test(r))return!1;if(B2.test(t))return l===t;const u=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+u+"|"+u+")$","i").test(l)}const $2=new o_(3e4,6e4);function Tk(){const t=Wc().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function G2(t){return new Promise((e,r)=>{function l(){Tk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{Tk(),r(Hc(t,"network-request-failed"))},timeout:$2.get()})}if(Wc().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Wc().gapi?.load)l();else{const u=LU("iframefcb");return Wc()[u]=()=>{gapi.load?l():r(Hc(t,"network-request-failed"))},pN(`${DU()}?onload=${u}`).catch(m=>r(m))}}).catch(e=>{throw Lx=null,e})}let Lx=null;function H2(t){return Lx=Lx||G2(t),Lx}const W2=new o_(5e3,15e3),q2="__/auth/iframe",Z2="emulator/auth/iframe",X2={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},K2=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function Y2(t){const e=t.config;Un(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?iT(e,Z2):`https://${t.config.authDomain}/${q2}`,l={apiKey:e.apiKey,appName:t.name,v:s_},u=K2.get(t.config.apiHost);u&&(l.eid=u);const m=t._getFrameworks();return m.length&&(l.fw=m.join(",")),`${r}?${i_(l).slice(1)}`}async function J2(t){const e=await H2(t),r=Wc().gapi;return Un(r,t,"internal-error"),e.open({where:document.body,url:Y2(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:X2,dontclear:!0},l=>new Promise(async(u,m)=>{await l.restyle({setHideOnLeave:!1});const v=Hc(t,"network-request-failed"),b=Wc().setTimeout(()=>{m(v)},W2.get());function a(){Wc().clearTimeout(b),u(l)}l.ping(a).then(a,()=>{m(v)})}))}const Q2={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},e$=500,t$=600,n$="_blank",r$="http://localhost";class Sk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function i$(t,e,r,l=e$,u=t$){const m=Math.max((window.screen.availHeight-u)/2,0).toString(),v=Math.max((window.screen.availWidth-l)/2,0).toString();let b="";const a={...Q2,width:l.toString(),height:u.toString(),top:m,left:v},k=Oo().toLowerCase();r&&(b=aN(k)?n$:r),sN(k)&&(e=e||r$,a.scrollbars="yes");const M=Object.entries(a).reduce((z,[O,K])=>`${z}${O}=${K},`,"");if(EU(k)&&b!=="_self")return s$(e||"",b),new Sk(null);const L=window.open(e||"",b,M);Un(L,t,"popup-blocked");try{L.focus()}catch{}return new Sk(L)}function s$(t,e){const r=document.createElement("a");r.href=t,r.target=e;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(l)}const o$="__/auth/handler",a$="emulator/auth/handler",l$=encodeURIComponent("fac");async function Ek(t,e,r,l,u,m){Un(t.config.authDomain,t,"auth-domain-config-required"),Un(t.config.apiKey,t,"invalid-api-key");const v={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:l,v:s_,eventId:u};if(e instanceof yN){e.setDefaultLanguage(t.languageCode),v.providerId=e.providerId||"",WV(e.getCustomParameters())||(v.customParameters=JSON.stringify(e.getCustomParameters()));for(const[M,L]of Object.entries({}))v[M]=L}if(e instanceof l_){const M=e.getScopes().filter(L=>L!=="");M.length>0&&(v.scopes=M.join(","))}t.tenantId&&(v.tid=t.tenantId);const b=v;for(const M of Object.keys(b))b[M]===void 0&&delete b[M];const a=await t._getAppCheckToken(),k=a?`#${l$}=${encodeURIComponent(a)}`:"";return`${c$(t)}?${i_(b).slice(1)}${k}`}function c$({config:t}){return t.emulator?iT(t,a$):`https://${t.authDomain}/${o$}`}const A1="webStorageSupport";class u${constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=SN,this._completeRedirectFn=D2,this._overrideRedirectResult=P2}async _openPopup(e,r,l,u){Ku(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const m=await Ek(e,r,l,Rw(),u);return i$(e,m,cT())}async _openRedirect(e,r,l,u){await this._originValidation(e);const m=await Ek(e,r,l,Rw(),u);return f2(m),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:u,promise:m}=this.eventManagers[r];return u?Promise.resolve(u):(Ku(m,"If manager is not set, promise should be"),m)}const l=this.initAndGetManager(e);return this.eventManagers[r]={promise:l},l.catch(()=>{delete this.eventManagers[r]}),l}async initAndGetManager(e){const r=await J2(e),l=new j2(e);return r.register("authEvent",u=>(Un(u?.authEvent,e,"invalid-auth-event"),{status:l.onEvent(u.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:l},this.iframes[e._key()]=r,l}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(A1,{type:A1},u=>{const m=u?.[0]?.[A1];m!==void 0&&r(!!m),Wl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=V2(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return hN()||oN()||oT()}}const d$=u$;var Ck="@firebase/auth",kk="1.12.0";class h${constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(l=>{e(l?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Un(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function f$(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function p$(t){Ly(new zm("auth",(e,{options:r})=>{const l=e.getProvider("app").getImmediate(),u=e.getProvider("heartbeat"),m=e.getProvider("app-check-internal"),{apiKey:v,authDomain:b}=l.options;Un(v&&!v.includes(":"),"invalid-api-key",{appName:l.name});const a={apiKey:v,authDomain:b,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:fN(t)},k=new PU(l,u,m,a);return VU(k,r),k},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,l)=>{e.getProvider("auth-internal").initialize()})),Ly(new zm("auth-internal",e=>{const r=op(e.getProvider("auth").getImmediate());return(l=>new h$(l))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),km(Ck,kk,f$(t)),km(Ck,kk,"esm2020")}const m$=300,g$=$P("authIdTokenMaxAge")||m$;let Ak=null;const y$=t=>async e=>{const r=e&&await e.getIdTokenResult(),l=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(l&&l>g$)return;const u=r?.token;Ak!==u&&(Ak=u,await fetch(t,{method:u?"POST":"DELETE",headers:u?{Authorization:`Bearer ${u}`}:{}}))};function _$(t=Z8()){const e=qP(t,"auth");if(e.isInitialized())return e.getImmediate();const r=FU(t,{popupRedirectResolver:d$,persistence:[b2,u2,SN]}),l=$P("authTokenSyncURL");if(l&&typeof isSecureContext=="boolean"&&isSecureContext){const m=new URL(l,location.origin);if(location.origin===m.origin){const v=y$(m.toString());s2(r,v,()=>v(r.currentUser)),i2(r,b=>v(b))}}const u=MV("auth");return u&&UU(r,`http://${u}`),r}function x$(){return document.getElementsByTagName("head")?.[0]??document}NU({loadJS(t){return new Promise((e,r)=>{const l=document.createElement("script");l.setAttribute("src",t),l.onload=e,l.onerror=u=>{const m=Hc("internal-error");m.customData=u,r(m)},l.type="text/javascript",l.charset="UTF-8",x$().appendChild(l)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});p$("Browser");var v$="firebase",w$="12.8.0";km(v$,w$,"app");const b$={apiKey:"AIzaSyAJHXB1tqt3VtZZ1qrEQR0NpPDBEjId9tk",authDomain:"winged-ray-485505-m3.firebaseapp.com",projectId:"winged-ray-485505-m3",storageBucket:"winged-ray-485505-m3.firebasestorage.app",messagingSenderId:"1067502227654",appId:"1:1067502227654:web:c784f33fc7d56a56f207c7"},T$=ZP(b$),mx=_$(T$),PN=P.createContext(void 0),S$=({children:t})=>{const[e,r]=P.useState(null),[l,u]=P.useState(!0);P.useEffect(()=>{const a=o2(mx,k=>{r(k),u(!1)});return()=>a()},[]);const m=async(a,k)=>{try{return await r2(mx,a,k),Gt.success("ng nhp thnh cng"),{error:null}}catch(M){return console.error(M),Gt.error("ng nhp tht bi: "+M.message),{error:M}}},v=async(a,k)=>{try{return await n2(mx,a,k),Gt.success("ng k thnh cng! Hy ng nhp ngay."),{error:null}}catch(M){return console.error(M),Gt.error("ng k tht bi: "+M.message),{error:M}}},b=async()=>{try{await a2(mx),Gt.success(" ng xut")}catch(a){Gt.error(a.message)}};return _.jsx(PN.Provider,{value:{user:e,isLoading:l,signIn:m,signUp:v,signOut:b},children:t})},_o=()=>{const t=P.useContext(PN);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},dT=P.createContext({});function ap(t){const e=P.useRef(null);return e.current===null&&(e.current=t()),e.current}const NN=typeof window<"u",hT=NN?P.useLayoutEffect:P.useEffect,qv=P.createContext(null);function fT(t,e){t.indexOf(e)===-1&&t.push(e)}function pT(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}function E$([...t],e,r){const l=e<0?t.length+e:e;if(l>=0&&l<t.length){const u=r<0?t.length+r:r,[m]=t.splice(e,1);t.splice(u,0,m)}return t}const Kc=(t,e,r)=>r>e?e:r<t?t:r;let mT=()=>{};const Yu={},RN=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function DN(t){return typeof t=="object"&&t!==null}const LN=t=>/^0[^.\s]+$/u.test(t);function gT(t){let e;return()=>(e===void 0&&(e=t()),e)}const rl=t=>t,C$=(t,e)=>r=>e(t(r)),u_=(...t)=>t.reduce(C$),By=(t,e,r)=>{const l=e-t;return l===0?1:(r-t)/l};class yT{constructor(){this.subscriptions=[]}add(e){return fT(this.subscriptions,e),()=>pT(this.subscriptions,e)}notify(e,r,l){const u=this.subscriptions.length;if(u)if(u===1)this.subscriptions[0](e,r,l);else for(let m=0;m<u;m++){const v=this.subscriptions[m];v&&v(e,r,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wu=t=>t*1e3,tl=t=>t/1e3;function jN(t,e){return e?t*(1e3/e):0}const ON=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,k$=1e-7,A$=12;function I$(t,e,r,l,u){let m,v,b=0;do v=e+(r-e)/2,m=ON(v,l,u)-t,m>0?r=v:e=v;while(Math.abs(m)>k$&&++b<A$);return v}function d_(t,e,r,l){if(t===e&&r===l)return rl;const u=m=>I$(m,0,1,t,r);return m=>m===0||m===1?m:ON(u(m),e,l)}const zN=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,BN=t=>e=>1-t(1-e),FN=d_(.33,1.53,.69,.99),_T=BN(FN),VN=zN(_T),UN=t=>(t*=2)<1?.5*_T(t):.5*(2-Math.pow(2,-10*(t-1))),xT=t=>1-Math.sin(Math.acos(t)),$N=BN(xT),GN=zN(xT),M$=d_(.42,0,1,1),P$=d_(0,0,.58,1),HN=d_(.42,0,.58,1),N$=t=>Array.isArray(t)&&typeof t[0]!="number",WN=t=>Array.isArray(t)&&typeof t[0]=="number",R$={linear:rl,easeIn:M$,easeInOut:HN,easeOut:P$,circIn:xT,circInOut:GN,circOut:$N,backIn:_T,backInOut:VN,backOut:FN,anticipate:UN},D$=t=>typeof t=="string",Ik=t=>{if(WN(t)){mT(t.length===4);const[e,r,l,u]=t;return d_(e,r,l,u)}else if(D$(t))return R$[t];return t},gx=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function L$(t,e){let r=new Set,l=new Set,u=!1,m=!1;const v=new WeakSet;let b={delta:0,timestamp:0,isProcessing:!1};function a(M){v.has(M)&&(k.schedule(M),t()),M(b)}const k={schedule:(M,L=!1,z=!1)=>{const K=z&&u?r:l;return L&&v.add(M),K.has(M)||K.add(M),M},cancel:M=>{l.delete(M),v.delete(M)},process:M=>{if(b=M,u){m=!0;return}u=!0,[r,l]=[l,r],r.forEach(a),r.clear(),u=!1,m&&(m=!1,k.process(M))}};return k}const j$=40;function qN(t,e){let r=!1,l=!0;const u={delta:0,timestamp:0,isProcessing:!1},m=()=>r=!0,v=gx.reduce((ie,pe)=>(ie[pe]=L$(m),ie),{}),{setup:b,read:a,resolveKeyframes:k,preUpdate:M,update:L,preRender:z,render:O,postRender:K}=v,H=()=>{const ie=Yu.useManualTiming?u.timestamp:performance.now();r=!1,Yu.useManualTiming||(u.delta=l?1e3/60:Math.max(Math.min(ie-u.timestamp,j$),1)),u.timestamp=ie,u.isProcessing=!0,b.process(u),a.process(u),k.process(u),M.process(u),L.process(u),z.process(u),O.process(u),K.process(u),u.isProcessing=!1,r&&e&&(l=!1,t(H))},Z=()=>{r=!0,l=!0,u.isProcessing||t(H)};return{schedule:gx.reduce((ie,pe)=>{const xe=v[pe];return ie[pe]=(Ce,je=!1,Ue=!1)=>(r||Z(),xe.schedule(Ce,je,Ue)),ie},{}),cancel:ie=>{for(let pe=0;pe<gx.length;pe++)v[gx[pe]].cancel(ie)},state:u,steps:v}}const{schedule:ei,cancel:Ju,state:Zs,steps:I1}=qN(typeof requestAnimationFrame<"u"?requestAnimationFrame:rl,!0);let jx;function O$(){jx=void 0}const Lo={now:()=>(jx===void 0&&Lo.set(Zs.isProcessing||Yu.useManualTiming?Zs.timestamp:performance.now()),jx),set:t=>{jx=t,queueMicrotask(O$)}},ZN=t=>e=>typeof e=="string"&&e.startsWith(t),XN=ZN("--"),z$=ZN("var(--"),vT=t=>z$(t)?B$.test(t.split("/*")[0].trim()):!1,B$=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Mk(t){return typeof t!="string"?!1:t.split("/*")[0].includes("var(--")}const tg={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Fy={...tg,transform:t=>Kc(0,1,t)},yx={...tg,default:1},wy=t=>Math.round(t*1e5)/1e5,wT=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function F$(t){return t==null}const V$=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,bT=(t,e)=>r=>!!(typeof r=="string"&&V$.test(r)&&r.startsWith(t)||e&&!F$(r)&&Object.prototype.hasOwnProperty.call(r,e)),KN=(t,e,r)=>l=>{if(typeof l!="string")return l;const[u,m,v,b]=l.match(wT);return{[t]:parseFloat(u),[e]:parseFloat(m),[r]:parseFloat(v),alpha:b!==void 0?parseFloat(b):1}},U$=t=>Kc(0,255,t),M1={...tg,transform:t=>Math.round(U$(t))},Vf={test:bT("rgb","red"),parse:KN("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:l=1})=>"rgba("+M1.transform(t)+", "+M1.transform(e)+", "+M1.transform(r)+", "+wy(Fy.transform(l))+")"};function $$(t){let e="",r="",l="",u="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),l=t.substring(5,7),u=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),l=t.substring(3,4),u=t.substring(4,5),e+=e,r+=r,l+=l,u+=u),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(l,16),alpha:u?parseInt(u,16)/255:1}}const Ow={test:bT("#"),parse:$$,transform:Vf.transform},h_=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Kd=h_("deg"),qc=h_("%"),yn=h_("px"),G$=h_("vh"),H$=h_("vw"),Pk={...qc,parse:t=>qc.parse(t)/100,transform:t=>qc.transform(t*100)},wm={test:bT("hsl","hue"),parse:KN("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:l=1})=>"hsla("+Math.round(t)+", "+qc.transform(wy(e))+", "+qc.transform(wy(r))+", "+wy(Fy.transform(l))+")"},rs={test:t=>Vf.test(t)||Ow.test(t)||wm.test(t),parse:t=>Vf.test(t)?Vf.parse(t):wm.test(t)?wm.parse(t):Ow.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Vf.transform(t):wm.transform(t),getAnimatableNone:t=>{const e=rs.parse(t);return e.alpha=0,rs.transform(e)}},W$=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function q$(t){return isNaN(t)&&typeof t=="string"&&(t.match(wT)?.length||0)+(t.match(W$)?.length||0)>0}const YN="number",JN="color",Z$="var",X$="var(",Nk="${}",K$=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Vy(t){const e=t.toString(),r=[],l={color:[],number:[],var:[]},u=[];let m=0;const b=e.replace(K$,a=>(rs.test(a)?(l.color.push(m),u.push(JN),r.push(rs.parse(a))):a.startsWith(X$)?(l.var.push(m),u.push(Z$),r.push(a)):(l.number.push(m),u.push(YN),r.push(parseFloat(a))),++m,Nk)).split(Nk);return{values:r,split:b,indexes:l,types:u}}function QN(t){return Vy(t).values}function eR(t){const{split:e,types:r}=Vy(t),l=e.length;return u=>{let m="";for(let v=0;v<l;v++)if(m+=e[v],u[v]!==void 0){const b=r[v];b===YN?m+=wy(u[v]):b===JN?m+=rs.transform(u[v]):m+=u[v]}return m}}const Y$=t=>typeof t=="number"?0:rs.test(t)?rs.getAnimatableNone(t):t;function J$(t){const e=QN(t);return eR(t)(e.map(Y$))}const gh={test:q$,parse:QN,createTransformer:eR,getAnimatableNone:J$};function P1(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Q$({hue:t,saturation:e,lightness:r,alpha:l}){t/=360,e/=100,r/=100;let u=0,m=0,v=0;if(!e)u=m=v=r;else{const b=r<.5?r*(1+e):r+e-r*e,a=2*r-b;u=P1(a,b,t+1/3),m=P1(a,b,t),v=P1(a,b,t-1/3)}return{red:Math.round(u*255),green:Math.round(m*255),blue:Math.round(v*255),alpha:l}}function sv(t,e){return r=>r>0?e:t}const yi=(t,e,r)=>t+(e-t)*r,N1=(t,e,r)=>{const l=t*t,u=r*(e*e-l)+l;return u<0?0:Math.sqrt(u)},e7=[Ow,Vf,wm],t7=t=>e7.find(e=>e.test(t));function Rk(t){const e=t7(t);if(!e)return!1;let r=e.parse(t);return e===wm&&(r=Q$(r)),r}const Dk=(t,e)=>{const r=Rk(t),l=Rk(e);if(!r||!l)return sv(t,e);const u={...r};return m=>(u.red=N1(r.red,l.red,m),u.green=N1(r.green,l.green,m),u.blue=N1(r.blue,l.blue,m),u.alpha=yi(r.alpha,l.alpha,m),Vf.transform(u))},zw=new Set(["none","hidden"]);function n7(t,e){return zw.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function r7(t,e){return r=>yi(t,e,r)}function TT(t){return typeof t=="number"?r7:typeof t=="string"?vT(t)?sv:rs.test(t)?Dk:o7:Array.isArray(t)?tR:typeof t=="object"?rs.test(t)?Dk:i7:sv}function tR(t,e){const r=[...t],l=r.length,u=t.map((m,v)=>TT(m)(m,e[v]));return m=>{for(let v=0;v<l;v++)r[v]=u[v](m);return r}}function i7(t,e){const r={...t,...e},l={};for(const u in r)t[u]!==void 0&&e[u]!==void 0&&(l[u]=TT(t[u])(t[u],e[u]));return u=>{for(const m in l)r[m]=l[m](u);return r}}function s7(t,e){const r=[],l={color:0,var:0,number:0};for(let u=0;u<e.values.length;u++){const m=e.types[u],v=t.indexes[m][l[m]],b=t.values[v]??0;r[u]=b,l[m]++}return r}const o7=(t,e)=>{const r=gh.createTransformer(e),l=Vy(t),u=Vy(e);return l.indexes.var.length===u.indexes.var.length&&l.indexes.color.length===u.indexes.color.length&&l.indexes.number.length>=u.indexes.number.length?zw.has(t)&&!u.values.length||zw.has(e)&&!l.values.length?n7(t,e):u_(tR(s7(l,u),u.values),r):sv(t,e)};function nR(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?yi(t,e,r):TT(t)(t,e)}const a7=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>ei.update(e,r),stop:()=>Ju(e),now:()=>Zs.isProcessing?Zs.timestamp:Lo.now()}},rR=(t,e,r=10)=>{let l="";const u=Math.max(Math.round(e/r),2);for(let m=0;m<u;m++)l+=Math.round(t(m/(u-1))*1e4)/1e4+", ";return`linear(${l.substring(0,l.length-2)})`},ov=2e4;function ST(t){let e=0;const r=50;let l=t.next(e);for(;!l.done&&e<ov;)e+=r,l=t.next(e);return e>=ov?1/0:e}function l7(t,e=100,r){const l=r({...t,keyframes:[0,e]}),u=Math.min(ST(l),ov);return{type:"keyframes",ease:m=>l.next(u*m).value/e,duration:tl(u)}}const c7=5;function iR(t,e,r){const l=Math.max(e-c7,0);return jN(r-t(l),e-l)}const Fi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},R1=.001;function u7({duration:t=Fi.duration,bounce:e=Fi.bounce,velocity:r=Fi.velocity,mass:l=Fi.mass}){let u,m,v=1-e;v=Kc(Fi.minDamping,Fi.maxDamping,v),t=Kc(Fi.minDuration,Fi.maxDuration,tl(t)),v<1?(u=k=>{const M=k*v,L=M*t,z=M-r,O=Bw(k,v),K=Math.exp(-L);return R1-z/O*K},m=k=>{const L=k*v*t,z=L*r+r,O=Math.pow(v,2)*Math.pow(k,2)*t,K=Math.exp(-L),H=Bw(Math.pow(k,2),v);return(-u(k)+R1>0?-1:1)*((z-O)*K)/H}):(u=k=>{const M=Math.exp(-k*t),L=(k-r)*t+1;return-R1+M*L},m=k=>{const M=Math.exp(-k*t),L=(r-k)*(t*t);return M*L});const b=5/t,a=h7(u,m,b);if(t=Wu(t),isNaN(a))return{stiffness:Fi.stiffness,damping:Fi.damping,duration:t};{const k=Math.pow(a,2)*l;return{stiffness:k,damping:v*2*Math.sqrt(l*k),duration:t}}}const d7=12;function h7(t,e,r){let l=r;for(let u=1;u<d7;u++)l=l-t(l)/e(l);return l}function Bw(t,e){return t*Math.sqrt(1-e*e)}const f7=["duration","bounce"],p7=["stiffness","damping","mass"];function Lk(t,e){return e.some(r=>t[r]!==void 0)}function m7(t){let e={velocity:Fi.velocity,stiffness:Fi.stiffness,damping:Fi.damping,mass:Fi.mass,isResolvedFromDuration:!1,...t};if(!Lk(t,p7)&&Lk(t,f7))if(t.visualDuration){const r=t.visualDuration,l=2*Math.PI/(r*1.2),u=l*l,m=2*Kc(.05,1,1-(t.bounce||0))*Math.sqrt(u);e={...e,mass:Fi.mass,stiffness:u,damping:m}}else{const r=u7(t);e={...e,...r,mass:Fi.mass},e.isResolvedFromDuration=!0}return e}function av(t=Fi.visualDuration,e=Fi.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:l,restDelta:u}=r;const m=r.keyframes[0],v=r.keyframes[r.keyframes.length-1],b={done:!1,value:m},{stiffness:a,damping:k,mass:M,duration:L,velocity:z,isResolvedFromDuration:O}=m7({...r,velocity:-tl(r.velocity||0)}),K=z||0,H=k/(2*Math.sqrt(a*M)),Z=v-m,Y=tl(Math.sqrt(a/M)),ee=Math.abs(Z)<5;l||(l=ee?Fi.restSpeed.granular:Fi.restSpeed.default),u||(u=ee?Fi.restDelta.granular:Fi.restDelta.default);let ie;if(H<1){const xe=Bw(Y,H);ie=Ce=>{const je=Math.exp(-H*Y*Ce);return v-je*((K+H*Y*Z)/xe*Math.sin(xe*Ce)+Z*Math.cos(xe*Ce))}}else if(H===1)ie=xe=>v-Math.exp(-Y*xe)*(Z+(K+Y*Z)*xe);else{const xe=Y*Math.sqrt(H*H-1);ie=Ce=>{const je=Math.exp(-H*Y*Ce),Ue=Math.min(xe*Ce,300);return v-je*((K+H*Y*Z)*Math.sinh(Ue)+xe*Z*Math.cosh(Ue))/xe}}const pe={calculatedDuration:O&&L||null,next:xe=>{const Ce=ie(xe);if(O)b.done=xe>=L;else{let je=xe===0?K:0;H<1&&(je=xe===0?Wu(K):iR(ie,xe,Ce));const Ue=Math.abs(je)<=l,et=Math.abs(v-Ce)<=u;b.done=Ue&&et}return b.value=b.done?v:Ce,b},toString:()=>{const xe=Math.min(ST(pe),ov),Ce=rR(je=>pe.next(xe*je).value,xe,30);return xe+"ms "+Ce},toTransition:()=>{}};return pe}av.applyToOptions=t=>{const e=l7(t,100,av);return t.ease=e.ease,t.duration=Wu(e.duration),t.type="keyframes",t};function Fw({keyframes:t,velocity:e=0,power:r=.8,timeConstant:l=325,bounceDamping:u=10,bounceStiffness:m=500,modifyTarget:v,min:b,max:a,restDelta:k=.5,restSpeed:M}){const L=t[0],z={done:!1,value:L},O=Ue=>b!==void 0&&Ue<b||a!==void 0&&Ue>a,K=Ue=>b===void 0?a:a===void 0||Math.abs(b-Ue)<Math.abs(a-Ue)?b:a;let H=r*e;const Z=L+H,Y=v===void 0?Z:v(Z);Y!==Z&&(H=Y-L);const ee=Ue=>-H*Math.exp(-Ue/l),ie=Ue=>Y+ee(Ue),pe=Ue=>{const et=ee(Ue),Ie=ie(Ue);z.done=Math.abs(et)<=k,z.value=z.done?Y:Ie};let xe,Ce;const je=Ue=>{O(z.value)&&(xe=Ue,Ce=av({keyframes:[z.value,K(z.value)],velocity:iR(ie,Ue,z.value),damping:u,stiffness:m,restDelta:k,restSpeed:M}))};return je(0),{calculatedDuration:null,next:Ue=>{let et=!1;return!Ce&&xe===void 0&&(et=!0,pe(Ue),je(Ue)),xe!==void 0&&Ue>=xe?Ce.next(Ue-xe):(!et&&pe(Ue),z)}}}function g7(t,e,r){const l=[],u=r||Yu.mix||nR,m=t.length-1;for(let v=0;v<m;v++){let b=u(t[v],t[v+1]);if(e){const a=Array.isArray(e)?e[v]||rl:e;b=u_(a,b)}l.push(b)}return l}function sR(t,e,{clamp:r=!0,ease:l,mixer:u}={}){const m=t.length;if(mT(m===e.length),m===1)return()=>e[0];if(m===2&&e[0]===e[1])return()=>e[1];const v=t[0]===t[1];t[0]>t[m-1]&&(t=[...t].reverse(),e=[...e].reverse());const b=g7(e,l,u),a=b.length,k=M=>{if(v&&M<t[0])return e[0];let L=0;if(a>1)for(;L<t.length-2&&!(M<t[L+1]);L++);const z=By(t[L],t[L+1],M);return b[L](z)};return r?M=>k(Kc(t[0],t[m-1],M)):k}function y7(t,e){const r=t[t.length-1];for(let l=1;l<=e;l++){const u=By(0,e,l);t.push(yi(r,1,u))}}function _7(t){const e=[0];return y7(e,t.length-1),e}function x7(t,e){return t.map(r=>r*e)}function v7(t,e){return t.map(()=>e||HN).splice(0,t.length-1)}function by({duration:t=300,keyframes:e,times:r,ease:l="easeInOut"}){const u=N$(l)?l.map(Ik):Ik(l),m={done:!1,value:e[0]},v=x7(r&&r.length===e.length?r:_7(e),t),b=sR(v,e,{ease:Array.isArray(u)?u:v7(e,u)});return{calculatedDuration:t,next:a=>(m.value=b(a),m.done=a>=t,m)}}const w7=t=>t!==null;function ET(t,{repeat:e,repeatType:r="loop"},l,u=1){const m=t.filter(w7),b=u<0||e&&r!=="loop"&&e%2===1?0:m.length-1;return!b||l===void 0?m[b]:l}const b7={decay:Fw,inertia:Fw,tween:by,keyframes:by,spring:av};function oR(t){typeof t.type=="string"&&(t.type=b7[t.type])}class CT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const T7=t=>t/100;class kT extends CT{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==Lo.now()&&this.tick(Lo.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;oR(e);const{type:r=by,repeat:l=0,repeatDelay:u=0,repeatType:m,velocity:v=0}=e;let{keyframes:b}=e;const a=r||by;a!==by&&typeof b[0]!="number"&&(this.mixKeyframes=u_(T7,nR(b[0],b[1])),b=[0,100]);const k=a({...e,keyframes:b});m==="mirror"&&(this.mirroredGenerator=a({...e,keyframes:[...b].reverse(),velocity:-v})),k.calculatedDuration===null&&(k.calculatedDuration=ST(k));const{calculatedDuration:M}=k;this.calculatedDuration=M,this.resolvedDuration=M+u,this.totalDuration=this.resolvedDuration*(l+1)-u,this.generator=k}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:l,totalDuration:u,mixKeyframes:m,mirroredGenerator:v,resolvedDuration:b,calculatedDuration:a}=this;if(this.startTime===null)return l.next(0);const{delay:k=0,keyframes:M,repeat:L,repeatType:z,repeatDelay:O,type:K,onUpdate:H,finalKeyframe:Z}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const Y=this.currentTime-k*(this.playbackSpeed>=0?1:-1),ee=this.playbackSpeed>=0?Y<0:Y>u;this.currentTime=Math.max(Y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let ie=this.currentTime,pe=l;if(L){const Ue=Math.min(this.currentTime,u)/b;let et=Math.floor(Ue),Ie=Ue%1;!Ie&&Ue>=1&&(Ie=1),Ie===1&&et--,et=Math.min(et,L+1),et%2&&(z==="reverse"?(Ie=1-Ie,O&&(Ie-=O/b)):z==="mirror"&&(pe=v)),ie=Kc(0,1,Ie)*b}const xe=ee?{done:!1,value:M[0]}:pe.next(ie);m&&(xe.value=m(xe.value));let{done:Ce}=xe;!ee&&a!==null&&(Ce=this.playbackSpeed>=0?this.currentTime>=u:this.currentTime<=0);const je=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&Ce);return je&&K!==Fw&&(xe.value=ET(M,this.options,Z,this.speed)),H&&H(xe.value),je&&this.finish(),xe}then(e,r){return this.finished.then(e,r)}get duration(){return tl(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+tl(e)}get time(){return tl(this.currentTime)}set time(e){e=Wu(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(Lo.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=tl(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=a7,startTime:r}=this.options;this.driver||(this.driver=e(u=>this.tick(u))),this.options.onPlay?.();const l=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=l):this.holdTime!==null?this.startTime=l-this.holdTime:this.startTime||(this.startTime=r??l),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Lo.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function S7(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Uf=t=>t*180/Math.PI,Vw=t=>{const e=Uf(Math.atan2(t[1],t[0]));return Uw(e)},E7={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Vw,rotateZ:Vw,skewX:t=>Uf(Math.atan(t[1])),skewY:t=>Uf(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Uw=t=>(t=t%360,t<0&&(t+=360),t),jk=Vw,Ok=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),zk=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),C7={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Ok,scaleY:zk,scale:t=>(Ok(t)+zk(t))/2,rotateX:t=>Uw(Uf(Math.atan2(t[6],t[5]))),rotateY:t=>Uw(Uf(Math.atan2(-t[2],t[0]))),rotateZ:jk,rotate:jk,skewX:t=>Uf(Math.atan(t[4])),skewY:t=>Uf(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function $w(t){return t.includes("scale")?1:0}function Gw(t,e){if(!t||t==="none")return $w(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let l,u;if(r)l=C7,u=r;else{const b=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);l=E7,u=b}if(!u)return $w(e);const m=l[e],v=u[1].split(",").map(A7);return typeof m=="function"?m(v):v[m]}const k7=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return Gw(r,e)};function A7(t){return parseFloat(t.trim())}const ng=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],rg=new Set(ng),Bk=t=>t===tg||t===yn,I7=new Set(["x","y","z"]),M7=ng.filter(t=>!I7.has(t));function P7(t){const e=[];return M7.forEach(r=>{const l=t.getValue(r);l!==void 0&&(e.push([r,l.get()]),l.set(r.startsWith("scale")?1:0))}),e}const ih={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Gw(e,"x"),y:(t,{transform:e})=>Gw(e,"y")};ih.translateX=ih.x;ih.translateY=ih.y;const Hf=new Set;let Hw=!1,Ww=!1,qw=!1;function aR(){if(Ww){const t=Array.from(Hf).filter(l=>l.needsMeasurement),e=new Set(t.map(l=>l.element)),r=new Map;e.forEach(l=>{const u=P7(l);u.length&&(r.set(l,u),l.render())}),t.forEach(l=>l.measureInitialState()),e.forEach(l=>{l.render();const u=r.get(l);u&&u.forEach(([m,v])=>{l.getValue(m)?.set(v)})}),t.forEach(l=>l.measureEndState()),t.forEach(l=>{l.suspendedScrollY!==void 0&&window.scrollTo(0,l.suspendedScrollY)})}Ww=!1,Hw=!1,Hf.forEach(t=>t.complete(qw)),Hf.clear()}function lR(){Hf.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Ww=!0)})}function N7(){qw=!0,lR(),aR(),qw=!1}class AT{constructor(e,r,l,u,m,v=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=l,this.motionValue=u,this.element=m,this.isAsync=v}scheduleResolve(){this.state="scheduled",this.isAsync?(Hf.add(this),Hw||(Hw=!0,ei.read(lR),ei.resolveKeyframes(aR))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:l,motionValue:u}=this;if(e[0]===null){const m=u?.get(),v=e[e.length-1];if(m!==void 0)e[0]=m;else if(l&&r){const b=l.readValue(r,v);b!=null&&(e[0]=b)}e[0]===void 0&&(e[0]=v),u&&m===void 0&&u.set(e[0])}S7(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),Hf.delete(this)}cancel(){this.state==="scheduled"&&(Hf.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const R7=t=>t.startsWith("--");function D7(t,e,r){R7(e)?t.style.setProperty(e,r):t.style[e]=r}const L7=gT(()=>window.ScrollTimeline!==void 0),j7={};function O7(t,e){const r=gT(t);return()=>j7[e]??r()}const cR=O7(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),ly=([t,e,r,l])=>`cubic-bezier(${t}, ${e}, ${r}, ${l})`,Fk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ly([0,.65,.55,1]),circOut:ly([.55,0,1,.45]),backIn:ly([.31,.01,.66,-.59]),backOut:ly([.33,1.53,.69,.99])};function uR(t,e){if(t)return typeof t=="function"?cR()?rR(t,e):"ease-out":WN(t)?ly(t):Array.isArray(t)?t.map(r=>uR(r,e)||Fk.easeOut):Fk[t]}function z7(t,e,r,{delay:l=0,duration:u=300,repeat:m=0,repeatType:v="loop",ease:b="easeOut",times:a}={},k=void 0){const M={[e]:r};a&&(M.offset=a);const L=uR(b,u);Array.isArray(L)&&(M.easing=L);const z={delay:l,duration:u,easing:Array.isArray(L)?"linear":L,fill:"both",iterations:m+1,direction:v==="reverse"?"alternate":"normal"};return k&&(z.pseudoElement=k),t.animate(M,z)}function dR(t){return typeof t=="function"&&"applyToOptions"in t}function B7({type:t,...e}){return dR(t)&&cR()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class F7 extends CT{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:r,name:l,keyframes:u,pseudoElement:m,allowFlatten:v=!1,finalKeyframe:b,onComplete:a}=e;this.isPseudoElement=!!m,this.allowFlatten=v,this.options=e,mT(typeof e.type!="string");const k=B7(e);this.animation=z7(r,l,u,k,m),k.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!m){const M=ET(u,this.options,b,this.speed);this.updateMotionValue?this.updateMotionValue(M):D7(r,l,M),this.animation.cancel()}a?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return tl(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+tl(e)}get time(){return tl(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Wu(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&L7()?(this.animation.timeline=e,rl):r(this)}}const hR={anticipate:UN,backInOut:VN,circInOut:GN};function V7(t){return t in hR}function U7(t){typeof t.ease=="string"&&V7(t.ease)&&(t.ease=hR[t.ease])}const D1=10;class $7 extends F7{constructor(e){U7(e),oR(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:l,onComplete:u,element:m,...v}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const b=new kT({...v,autoplay:!1}),a=Math.max(D1,Lo.now()-this.startTime),k=Kc(0,D1,a-D1);r.setWithVelocity(b.sample(Math.max(0,a-k)).value,b.sample(a).value,k),b.stop()}}const Vk=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(gh.test(t)||t==="0")&&!t.startsWith("url("));function G7(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function H7(t,e,r,l){const u=t[0];if(u===null)return!1;if(e==="display"||e==="visibility")return!0;const m=t[t.length-1],v=Vk(u,e),b=Vk(m,e);return!v||!b?!1:G7(t)||(r==="spring"||dR(r))&&l}function Zw(t){t.duration=0,t.type="keyframes"}const W7=new Set(["opacity","clipPath","filter","transform"]),q7=gT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Z7(t){const{motionValue:e,name:r,repeatDelay:l,repeatType:u,damping:m,type:v}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:a,transformTemplate:k}=e.owner.getProps();return q7()&&r&&W7.has(r)&&(r!=="transform"||!k)&&!a&&!l&&u!=="mirror"&&m!==0&&v!=="inertia"}const X7=40;class K7 extends CT{constructor({autoplay:e=!0,delay:r=0,type:l="keyframes",repeat:u=0,repeatDelay:m=0,repeatType:v="loop",keyframes:b,name:a,motionValue:k,element:M,...L}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=Lo.now();const z={autoplay:e,delay:r,type:l,repeat:u,repeatDelay:m,repeatType:v,name:a,motionValue:k,element:M,...L},O=M?.KeyframeResolver||AT;this.keyframeResolver=new O(b,(K,H,Z)=>this.onKeyframesResolved(K,H,z,!Z),a,k,M),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,l,u){this.keyframeResolver=void 0;const{name:m,type:v,velocity:b,delay:a,isHandoff:k,onUpdate:M}=l;this.resolvedAt=Lo.now(),H7(e,m,v,b)||((Yu.instantAnimations||!a)&&M?.(ET(e,l,r)),e[0]=e[e.length-1],Zw(l),l.repeat=0);const z={startTime:u?this.resolvedAt?this.resolvedAt-this.createdAt>X7?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...l,keyframes:e},O=!k&&Z7(z),K=z.motionValue?.owner?.current,H=O?new $7({...z,element:K}):new kT(z);H.finished.then(()=>{this.notifyFinished()}).catch(rl),this.pendingTimeline&&(this.stopTimeline=H.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=H}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),N7()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function fR(t,e,r,l=0,u=1){const m=Array.from(t).sort((k,M)=>k.sortNodePosition(M)).indexOf(e),v=t.size,b=(v-1)*l;return typeof r=="function"?r(m,v):u===1?m*l:b-m*l}const Y7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function J7(t){const e=Y7.exec(t);if(!e)return[,];const[,r,l,u]=e;return[`--${r??l}`,u]}function pR(t,e,r=1){const[l,u]=J7(t);if(!l)return;const m=window.getComputedStyle(e).getPropertyValue(l);if(m){const v=m.trim();return RN(v)?parseFloat(v):v}return vT(u)?pR(u,e,r+1):u}const Q7={type:"spring",stiffness:500,damping:25,restSpeed:10},e9=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),t9={type:"keyframes",duration:.8},n9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},r9=(t,{keyframes:e})=>e.length>2?t9:rg.has(t)?t.startsWith("scale")?e9(e[1]):Q7:n9,i9=t=>t!==null;function s9(t,{repeat:e,repeatType:r="loop"},l){const u=t.filter(i9),m=e&&r!=="loop"&&e%2===1?0:u.length-1;return u[m]}function IT(t,e){return t?.[e]??t?.default??t}function o9({when:t,delay:e,delayChildren:r,staggerChildren:l,staggerDirection:u,repeat:m,repeatType:v,repeatDelay:b,from:a,elapsed:k,...M}){return!!Object.keys(M).length}const MT=(t,e,r,l={},u,m)=>v=>{const b=IT(l,t)||{},a=b.delay||l.delay||0;let{elapsed:k=0}=l;k=k-Wu(a);const M={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...b,delay:-k,onUpdate:z=>{e.set(z),b.onUpdate&&b.onUpdate(z)},onComplete:()=>{v(),b.onComplete&&b.onComplete()},name:t,motionValue:e,element:m?void 0:u};o9(b)||Object.assign(M,r9(t,M)),M.duration&&(M.duration=Wu(M.duration)),M.repeatDelay&&(M.repeatDelay=Wu(M.repeatDelay)),M.from!==void 0&&(M.keyframes[0]=M.from);let L=!1;if((M.type===!1||M.duration===0&&!M.repeatDelay)&&(Zw(M),M.delay===0&&(L=!0)),(Yu.instantAnimations||Yu.skipAnimations)&&(L=!0,Zw(M),M.delay=0),M.allowFlatten=!b.type&&!b.ease,L&&!m&&e.get()!==void 0){const z=s9(M.keyframes,b);if(z!==void 0){ei.update(()=>{M.onUpdate(z),M.onComplete()});return}}return b.isSync?new kT(M):new K7(M)};function Uk(t){const e=[{},{}];return t?.values.forEach((r,l)=>{e[0][l]=r.get(),e[1][l]=r.getVelocity()}),e}function PT(t,e,r,l){if(typeof e=="function"){const[u,m]=Uk(l);e=e(r!==void 0?r:t.custom,u,m)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[u,m]=Uk(l);e=e(r!==void 0?r:t.custom,u,m)}return e}function Pm(t,e,r){const l=t.getProps();return PT(l,e,r!==void 0?r:l.custom,t)}const mR=new Set(["width","height","top","left","right","bottom",...ng]),$k=30,a9=t=>!isNaN(parseFloat(t)),Ty={current:void 0};class l9{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=l=>{const u=Lo.now();if(this.updatedAt!==u&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(l),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const m of this.dependents)m.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=Lo.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=a9(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new yT);const l=this.events[e].add(r);return e==="change"?()=>{l(),ei.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,l){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-l}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return Ty.current&&Ty.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=Lo.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>$k)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,$k);return jN(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Qf(t,e){return new l9(t,e)}const Xw=t=>Array.isArray(t);function c9(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Qf(r))}function u9(t){return Xw(t)?t[t.length-1]||0:t}function d9(t,e){const r=Pm(t,e);let{transitionEnd:l={},transition:u={},...m}=r||{};m={...m,...l};for(const v in m){const b=u9(m[v]);c9(t,v,b)}}const Xs=t=>!!(t&&t.getVelocity);function h9(t){return!!(Xs(t)&&t.add)}function Kw(t,e){const r=t.getValue("willChange");if(h9(r))return r.add(e);if(!r&&Yu.WillChange){const l=new Yu.WillChange("auto");t.addValue("willChange",l),l.add(e)}}function NT(t){return t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const f9="framerAppearId",gR="data-"+NT(f9);function yR(t){return t.props[gR]}function p9({protectedKeys:t,needsAnimating:e},r){const l=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,l}function _R(t,e,{delay:r=0,transitionOverride:l,type:u}={}){let{transition:m=t.getDefaultTransition(),transitionEnd:v,...b}=e;const a=m?.reduceMotion;l&&(m=l);const k=[],M=u&&t.animationState&&t.animationState.getState()[u];for(const L in b){const z=t.getValue(L,t.latestValues[L]??null),O=b[L];if(O===void 0||M&&p9(M,L))continue;const K={delay:r,...IT(m||{},L)},H=z.get();if(H!==void 0&&!z.isAnimating&&!Array.isArray(O)&&O===H&&!K.velocity)continue;let Z=!1;if(window.MotionHandoffAnimation){const ie=yR(t);if(ie){const pe=window.MotionHandoffAnimation(ie,L,ei);pe!==null&&(K.startTime=pe,Z=!0)}}Kw(t,L);const Y=a??t.shouldReduceMotion;z.start(MT(L,z,O,Y&&mR.has(L)?{type:!1}:K,t,Z));const ee=z.animation;ee&&k.push(ee)}return v&&Promise.all(k).then(()=>{ei.update(()=>{v&&d9(t,v)})}),k}function Yw(t,e,r={}){const l=Pm(t,e,r.type==="exit"?t.presenceContext?.custom:void 0);let{transition:u=t.getDefaultTransition()||{}}=l||{};r.transitionOverride&&(u=r.transitionOverride);const m=l?()=>Promise.all(_R(t,l,r)):()=>Promise.resolve(),v=t.variantChildren&&t.variantChildren.size?(a=0)=>{const{delayChildren:k=0,staggerChildren:M,staggerDirection:L}=u;return m9(t,e,a,k,M,L,r)}:()=>Promise.resolve(),{when:b}=u;if(b){const[a,k]=b==="beforeChildren"?[m,v]:[v,m];return a().then(()=>k())}else return Promise.all([m(),v(r.delay)])}function m9(t,e,r=0,l=0,u=0,m=1,v){const b=[];for(const a of t.variantChildren)a.notify("AnimationStart",e),b.push(Yw(a,e,{...v,delay:r+(typeof l=="function"?0:l)+fR(t.variantChildren,a,l,u,m)}).then(()=>a.notify("AnimationComplete",e)));return Promise.all(b)}function g9(t,e,r={}){t.notify("AnimationStart",e);let l;if(Array.isArray(e)){const u=e.map(m=>Yw(t,m,r));l=Promise.all(u)}else if(typeof e=="string")l=Yw(t,e,r);else{const u=typeof e=="function"?Pm(t,e,r.custom):e;l=Promise.all(_R(t,u,r))}return l.then(()=>{t.notify("AnimationComplete",e)})}const y9={test:t=>t==="auto",parse:t=>t},xR=t=>e=>e.test(t),vR=[tg,yn,qc,Kd,H$,G$,y9],Gk=t=>vR.find(xR(t));function _9(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||LN(t):!0}const x9=new Set(["brightness","contrast","saturate","opacity"]);function v9(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[l]=r.match(wT)||[];if(!l)return t;const u=r.replace(l,"");let m=x9.has(e)?1:0;return l!==r&&(m*=100),e+"("+m+u+")"}const w9=/\b([a-z-]*)\(.*?\)/gu,Jw={...gh,getAnimatableNone:t=>{const e=t.match(w9);return e?e.map(v9).join(" "):t}},Hk={...tg,transform:Math.round},b9={rotate:Kd,rotateX:Kd,rotateY:Kd,rotateZ:Kd,scale:yx,scaleX:yx,scaleY:yx,scaleZ:yx,skew:Kd,skewX:Kd,skewY:Kd,distance:yn,translateX:yn,translateY:yn,translateZ:yn,x:yn,y:yn,z:yn,perspective:yn,transformPerspective:yn,opacity:Fy,originX:Pk,originY:Pk,originZ:yn},RT={borderWidth:yn,borderTopWidth:yn,borderRightWidth:yn,borderBottomWidth:yn,borderLeftWidth:yn,borderRadius:yn,borderTopLeftRadius:yn,borderTopRightRadius:yn,borderBottomRightRadius:yn,borderBottomLeftRadius:yn,width:yn,maxWidth:yn,height:yn,maxHeight:yn,top:yn,right:yn,bottom:yn,left:yn,inset:yn,insetBlock:yn,insetBlockStart:yn,insetBlockEnd:yn,insetInline:yn,insetInlineStart:yn,insetInlineEnd:yn,padding:yn,paddingTop:yn,paddingRight:yn,paddingBottom:yn,paddingLeft:yn,paddingBlock:yn,paddingBlockStart:yn,paddingBlockEnd:yn,paddingInline:yn,paddingInlineStart:yn,paddingInlineEnd:yn,margin:yn,marginTop:yn,marginRight:yn,marginBottom:yn,marginLeft:yn,marginBlock:yn,marginBlockStart:yn,marginBlockEnd:yn,marginInline:yn,marginInlineStart:yn,marginInlineEnd:yn,fontSize:yn,backgroundPositionX:yn,backgroundPositionY:yn,...b9,zIndex:Hk,fillOpacity:Fy,strokeOpacity:Fy,numOctaves:Hk},T9={...RT,color:rs,backgroundColor:rs,outlineColor:rs,fill:rs,stroke:rs,borderColor:rs,borderTopColor:rs,borderRightColor:rs,borderBottomColor:rs,borderLeftColor:rs,filter:Jw,WebkitFilter:Jw},wR=t=>T9[t];function bR(t,e){let r=wR(t);return r!==Jw&&(r=gh),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const S9=new Set(["auto","none","0"]);function E9(t,e,r){let l=0,u;for(;l<t.length&&!u;){const m=t[l];typeof m=="string"&&!S9.has(m)&&Vy(m).values.length&&(u=t[l]),l++}if(u&&r)for(const m of e)t[m]=bR(r,u)}class C9 extends AT{constructor(e,r,l,u,m){super(e,r,l,u,m,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:l}=this;if(!r||!r.current)return;super.readKeyframes();for(let M=0;M<e.length;M++){let L=e[M];if(typeof L=="string"&&(L=L.trim(),vT(L))){const z=pR(L,r.current);z!==void 0&&(e[M]=z),M===e.length-1&&(this.finalKeyframe=L)}}if(this.resolveNoneKeyframes(),!mR.has(l)||e.length!==2)return;const[u,m]=e,v=Gk(u),b=Gk(m),a=Mk(u),k=Mk(m);if(a!==k&&ih[l]){this.needsMeasurement=!0;return}if(v!==b)if(Bk(v)&&Bk(b))for(let M=0;M<e.length;M++){const L=e[M];typeof L=="string"&&(e[M]=parseFloat(L))}else ih[l]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,l=[];for(let u=0;u<e.length;u++)(e[u]===null||_9(e[u]))&&l.push(u);l.length&&E9(e,l,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:l}=this;if(!e||!e.current)return;l==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ih[l](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const u=r[r.length-1];u!==void 0&&e.getValue(l,u).jump(u,!1)}measureEndState(){const{element:e,name:r,unresolvedKeyframes:l}=this;if(!e||!e.current)return;const u=e.getValue(r);u&&u.jump(this.measuredOrigin,!1);const m=l.length-1,v=l[m];l[m]=ih[r](e.measureViewportBox(),window.getComputedStyle(e.current)),v!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=v),this.removedTransforms?.length&&this.removedTransforms.forEach(([b,a])=>{e.getValue(b).set(a)}),this.resolveNoneKeyframes()}}function k9(t,e,r){if(t==null)return[];if(t instanceof EventTarget)return[t];if(typeof t=="string"){let l=document;const u=r?.[t]??l.querySelectorAll(t);return u?Array.from(u):[]}return Array.from(t).filter(l=>l!=null)}const TR=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function Qw(t){return DN(t)&&"offsetHeight"in t}const{schedule:DT}=qN(queueMicrotask,!1),Fl={x:!1,y:!1};function SR(){return Fl.x||Fl.y}function A9(t){return t==="x"||t==="y"?Fl[t]?null:(Fl[t]=!0,()=>{Fl[t]=!1}):Fl.x||Fl.y?null:(Fl.x=Fl.y=!0,()=>{Fl.x=Fl.y=!1})}function ER(t,e){const r=k9(t),l=new AbortController,u={passive:!0,...e,signal:l.signal};return[r,u,()=>l.abort()]}function Wk(t){return!(t.pointerType==="touch"||SR())}function I9(t,e,r={}){const[l,u,m]=ER(t,r),v=b=>{if(!Wk(b))return;const{target:a}=b,k=e(a,b);if(typeof k!="function"||!a)return;const M=L=>{Wk(L)&&(k(L),a.removeEventListener("pointerleave",M))};a.addEventListener("pointerleave",M,u)};return l.forEach(b=>{b.addEventListener("pointerenter",v,u)}),m}const CR=(t,e)=>e?t===e?!0:CR(t,e.parentElement):!1,LT=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,M9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function kR(t){return M9.has(t.tagName)||t.isContentEditable===!0}const Ox=new WeakSet;function qk(t){return e=>{e.key==="Enter"&&t(e)}}function L1(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const P9=(t,e)=>{const r=t.currentTarget;if(!r)return;const l=qk(()=>{if(Ox.has(r))return;L1(r,"down");const u=qk(()=>{L1(r,"up")}),m=()=>L1(r,"cancel");r.addEventListener("keyup",u,e),r.addEventListener("blur",m,e)});r.addEventListener("keydown",l,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",l),e)};function Zk(t){return LT(t)&&!SR()}function N9(t,e,r={}){const[l,u,m]=ER(t,r),v=b=>{const a=b.currentTarget;if(!Zk(b))return;Ox.add(a);const k=e(a,b),M=(O,K)=>{window.removeEventListener("pointerup",L),window.removeEventListener("pointercancel",z),Ox.has(a)&&Ox.delete(a),Zk(O)&&typeof k=="function"&&k(O,{success:K})},L=O=>{M(O,a===window||a===document||r.useGlobalTarget||CR(a,O.target))},z=O=>{M(O,!1)};window.addEventListener("pointerup",L,u),window.addEventListener("pointercancel",z,u)};return l.forEach(b=>{(r.useGlobalTarget?window:b).addEventListener("pointerdown",v,u),Qw(b)&&(b.addEventListener("focus",k=>P9(k,u)),!kR(b)&&!b.hasAttribute("tabindex")&&(b.tabIndex=0))}),m}function AR(t){return DN(t)&&"ownerSVGElement"in t}function R9(t){return AR(t)&&t.tagName==="svg"}function D9(...t){const e=!Array.isArray(t[0]),r=e?0:-1,l=t[0+r],u=t[1+r],m=t[2+r],v=t[3+r],b=sR(u,m,v);return e?b(l):b}const L9=[...vR,rs,gh],j9=t=>L9.find(xR(t)),Xk=()=>({translate:0,scale:1,origin:0,originPoint:0}),bm=()=>({x:Xk(),y:Xk()}),Kk=()=>({min:0,max:0}),ms=()=>({x:Kk(),y:Kk()}),eb={current:null},IR={current:!1},O9=typeof window<"u";function z9(){if(IR.current=!0,!!O9)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>eb.current=t.matches;t.addEventListener("change",e),e()}else eb.current=!1}const B9=new WeakMap;function Zv(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Uy(t){return typeof t=="string"||Array.isArray(t)}const jT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],OT=["initial",...jT];function Xv(t){return Zv(t.animate)||OT.some(e=>Uy(t[e]))}function MR(t){return!!(Xv(t)||t.variants)}function F9(t,e,r){for(const l in e){const u=e[l],m=r[l];if(Xs(u))t.addValue(l,u);else if(Xs(m))t.addValue(l,Qf(u,{owner:t}));else if(m!==u)if(t.hasValue(l)){const v=t.getValue(l);v.liveStyle===!0?v.jump(u):v.hasAnimated||v.set(u)}else{const v=t.getStaticValue(l);t.addValue(l,Qf(v!==void 0?v:u,{owner:t}))}}for(const l in r)e[l]===void 0&&t.removeValue(l);return e}const Yk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let lv={};function PR(t){lv=t}function V9(){return lv}class U9{scrapeMotionValuesFromProps(e,r,l){return{}}constructor({parent:e,props:r,presenceContext:l,reducedMotionConfig:u,blockInitialAnimation:m,visualState:v},b={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=AT,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const z=Lo.now();this.renderScheduledAt<z&&(this.renderScheduledAt=z,ei.render(this.render,!1,!0))};const{latestValues:a,renderState:k}=v;this.latestValues=a,this.baseTarget={...a},this.initialValues=r.initial?{...a}:{},this.renderState=k,this.parent=e,this.props=r,this.presenceContext=l,this.depth=e?e.depth+1:0,this.reducedMotionConfig=u,this.options=b,this.blockInitialAnimation=!!m,this.isControllingVariants=Xv(r),this.isVariantNode=MR(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:M,...L}=this.scrapeMotionValuesFromProps(r,{},this);for(const z in L){const O=L[z];a[z]!==void 0&&Xs(O)&&O.set(a[z])}}mount(e){this.current=e,B9.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,l)=>this.bindToMotionValue(l,r)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(IR.current||z9(),this.shouldReduceMotion=eb.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ju(this.notifyUpdate),Ju(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const l=rg.has(e);l&&this.onBindTransform&&this.onBindTransform();const u=r.on("change",v=>{this.latestValues[e]=v,this.props.onUpdate&&ei.preRender(this.notifyUpdate),l&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let m;typeof window<"u"&&window.MotionCheckAppearSync&&(m=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{u(),m&&m(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in lv){const r=lv[e];if(!r)continue;const{isEnabled:l,Feature:u}=r;if(!this.features[e]&&u&&l(this.props)&&(this.features[e]=new u(this)),this.features[e]){const m=this.features[e];m.isMounted?m.update():(m.mount(),m.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ms()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let l=0;l<Yk.length;l++){const u=Yk[l];this.propEventSubscriptions[u]&&(this.propEventSubscriptions[u](),delete this.propEventSubscriptions[u]);const m="on"+u,v=e[m];v&&(this.propEventSubscriptions[u]=this.on(u,v))}this.prevMotionValues=F9(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const l=this.values.get(e);r!==l&&(l&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let l=this.values.get(e);return l===void 0&&r!==void 0&&(l=Qf(r===null?void 0:r,{owner:this}),this.addValue(e,l)),l}readValue(e,r){let l=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return l!=null&&(typeof l=="string"&&(RN(l)||LN(l))?l=parseFloat(l):!j9(l)&&gh.test(r)&&(l=bR(e,r)),this.setBaseTarget(e,Xs(l)?l.get():l)),Xs(l)?l.get():l}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){const{initial:r}=this.props;let l;if(typeof r=="string"||typeof r=="object"){const m=PT(this.props,r,this.presenceContext?.custom);m&&(l=m[e])}if(r&&l!==void 0)return l;const u=this.getBaseTargetFromProps(this.props,e);return u!==void 0&&!Xs(u)?u:this.initialValues[e]!==void 0&&l===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new yT),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){DT.render(this.render)}}class NR extends U9{constructor(){super(...arguments),this.KeyframeResolver=C9}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){const l=e.style;return l?l[r]:void 0}removeValueFromRenderState(e,{vars:r,style:l}){delete r[e],delete l[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Xs(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class Eh{constructor(e){this.isMounted=!1,this.node=e}update(){}}function RR({top:t,left:e,right:r,bottom:l}){return{x:{min:e,max:r},y:{min:t,max:l}}}function $9({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function G9(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),l=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:l.y,right:l.x}}function j1(t){return t===void 0||t===1}function tb({scale:t,scaleX:e,scaleY:r}){return!j1(t)||!j1(e)||!j1(r)}function Bf(t){return tb(t)||DR(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function DR(t){return Jk(t.x)||Jk(t.y)}function Jk(t){return t&&t!=="0%"}function cv(t,e,r){const l=t-r,u=e*l;return r+u}function Qk(t,e,r,l,u){return u!==void 0&&(t=cv(t,u,l)),cv(t,r,l)+e}function nb(t,e=0,r=1,l,u){t.min=Qk(t.min,e,r,l,u),t.max=Qk(t.max,e,r,l,u)}function LR(t,{x:e,y:r}){nb(t.x,e.translate,e.scale,e.originPoint),nb(t.y,r.translate,r.scale,r.originPoint)}const eA=.999999999999,tA=1.0000000000001;function H9(t,e,r,l=!1){const u=r.length;if(!u)return;e.x=e.y=1;let m,v;for(let b=0;b<u;b++){m=r[b],v=m.projectionDelta;const{visualElement:a}=m.options;a&&a.props.style&&a.props.style.display==="contents"||(l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&Sm(t,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),v&&(e.x*=v.x.scale,e.y*=v.y.scale,LR(t,v)),l&&Bf(m.latestValues)&&Sm(t,m.latestValues))}e.x<tA&&e.x>eA&&(e.x=1),e.y<tA&&e.y>eA&&(e.y=1)}function Tm(t,e){t.min=t.min+e,t.max=t.max+e}function nA(t,e,r,l,u=.5){const m=yi(t.min,t.max,u);nb(t,e,r,m,l)}function Sm(t,e){nA(t.x,e.x,e.scaleX,e.scale,e.originX),nA(t.y,e.y,e.scaleY,e.scale,e.originY)}function jR(t,e){return RR(G9(t.getBoundingClientRect(),e))}function W9(t,e,r){const l=jR(t,r),{scroll:u}=e;return u&&(Tm(l.x,u.offset.x),Tm(l.y,u.offset.y)),l}const q9={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},Z9=ng.length;function X9(t,e,r){let l="",u=!0;for(let m=0;m<Z9;m++){const v=ng[m],b=t[v];if(b===void 0)continue;let a=!0;if(typeof b=="number")a=b===(v.startsWith("scale")?1:0);else{const k=parseFloat(b);a=v.startsWith("scale")?k===1:k===0}if(!a||r){const k=TR(b,RT[v]);if(!a){u=!1;const M=q9[v]||v;l+=`${M}(${k}) `}r&&(e[v]=k)}}return l=l.trim(),r?l=r(e,u?"":l):u&&(l="none"),l}function zT(t,e,r){const{style:l,vars:u,transformOrigin:m}=t;let v=!1,b=!1;for(const a in e){const k=e[a];if(rg.has(a)){v=!0;continue}else if(XN(a)){u[a]=k;continue}else{const M=TR(k,RT[a]);a.startsWith("origin")?(b=!0,m[a]=M):l[a]=M}}if(e.transform||(v||r?l.transform=X9(e,t.transform,r):l.transform&&(l.transform="none")),b){const{originX:a="50%",originY:k="50%",originZ:M=0}=m;l.transformOrigin=`${a} ${k} ${M}`}}function OR(t,{style:e,vars:r},l,u){const m=t.style;let v;for(v in e)m[v]=e[v];u?.applyProjectionStyles(m,l);for(v in r)m.setProperty(v,r[v])}function rA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const iy={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(yn.test(t))t=parseFloat(t);else return t;const r=rA(t,e.target.x),l=rA(t,e.target.y);return`${r}% ${l}%`}},K9={correct:(t,{treeScale:e,projectionDelta:r})=>{const l=t,u=gh.parse(t);if(u.length>5)return l;const m=gh.createTransformer(t),v=typeof u[0]!="number"?1:0,b=r.x.scale*e.x,a=r.y.scale*e.y;u[0+v]/=b,u[1+v]/=a;const k=yi(b,a,.5);return typeof u[2+v]=="number"&&(u[2+v]/=k),typeof u[3+v]=="number"&&(u[3+v]/=k),m(u)}},rb={borderRadius:{...iy,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:iy,borderTopRightRadius:iy,borderBottomLeftRadius:iy,borderBottomRightRadius:iy,boxShadow:K9};function zR(t,{layout:e,layoutId:r}){return rg.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!rb[t]||t==="opacity")}function BT(t,e,r){const l=t.style,u=e?.style,m={};if(!l)return m;for(const v in l)(Xs(l[v])||u&&Xs(u[v])||zR(v,t)||r?.getValue(v)?.liveStyle!==void 0)&&(m[v]=l[v]);return m}function Y9(t){return window.getComputedStyle(t)}class J9 extends NR{constructor(){super(...arguments),this.type="html",this.renderInstance=OR}readValueFromInstance(e,r){if(rg.has(r))return this.projection?.isProjecting?$w(r):k7(e,r);{const l=Y9(e),u=(XN(r)?l.getPropertyValue(r):l[r])||0;return typeof u=="string"?u.trim():u}}measureInstanceViewportBox(e,{transformPagePoint:r}){return jR(e,r)}build(e,r,l){zT(e,r,l.transformTemplate)}scrapeMotionValuesFromProps(e,r,l){return BT(e,r,l)}}const Q9={offset:"stroke-dashoffset",array:"stroke-dasharray"},eG={offset:"strokeDashoffset",array:"strokeDasharray"};function tG(t,e,r=1,l=0,u=!0){t.pathLength=1;const m=u?Q9:eG;t[m.offset]=`${-l}`,t[m.array]=`${e} ${r}`}const nG=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function BR(t,{attrX:e,attrY:r,attrScale:l,pathLength:u,pathSpacing:m=1,pathOffset:v=0,...b},a,k,M){if(zT(t,b,k),a){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:L,style:z}=t;L.transform&&(z.transform=L.transform,delete L.transform),(z.transform||L.transformOrigin)&&(z.transformOrigin=L.transformOrigin??"50% 50%",delete L.transformOrigin),z.transform&&(z.transformBox=M?.transformBox??"fill-box",delete L.transformBox);for(const O of nG)L[O]!==void 0&&(z[O]=L[O],delete L[O]);e!==void 0&&(L.x=e),r!==void 0&&(L.y=r),l!==void 0&&(L.scale=l),u!==void 0&&tG(L,u,m,v,!1)}const FR=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),VR=t=>typeof t=="string"&&t.toLowerCase()==="svg";function rG(t,e,r,l){OR(t,e,void 0,l);for(const u in e.attrs)t.setAttribute(FR.has(u)?u:NT(u),e.attrs[u])}function UR(t,e,r){const l=BT(t,e,r);for(const u in t)if(Xs(t[u])||Xs(e[u])){const m=ng.indexOf(u)!==-1?"attr"+u.charAt(0).toUpperCase()+u.substring(1):u;l[m]=t[u]}return l}class iG extends NR{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ms}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(rg.has(r)){const l=wR(r);return l&&l.default||0}return r=FR.has(r)?r:NT(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,l){return UR(e,r,l)}build(e,r,l){BR(e,r,this.isSVGTag,l.transformTemplate,l.style)}renderInstance(e,r,l,u){rG(e,r,l,u)}mount(e){this.isSVGTag=VR(e.tagName),super.mount(e)}}const sG=OT.length;function $R(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?$R(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<sG;r++){const l=OT[r],u=t.props[l];(Uy(u)||u===!1)&&(e[l]=u)}return e}function GR(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let l=0;l<r;l++)if(e[l]!==t[l])return!1;return!0}const oG=[...jT].reverse(),aG=jT.length;function lG(t){return e=>Promise.all(e.map(({animation:r,options:l})=>g9(t,r,l)))}function cG(t){let e=lG(t),r=iA(),l=!0;const u=a=>(k,M)=>{const L=Pm(t,M,a==="exit"?t.presenceContext?.custom:void 0);if(L){const{transition:z,transitionEnd:O,...K}=L;k={...k,...K,...O}}return k};function m(a){e=a(t)}function v(a){const{props:k}=t,M=$R(t.parent)||{},L=[],z=new Set;let O={},K=1/0;for(let Z=0;Z<aG;Z++){const Y=oG[Z],ee=r[Y],ie=k[Y]!==void 0?k[Y]:M[Y],pe=Uy(ie),xe=Y===a?ee.isActive:null;xe===!1&&(K=Z);let Ce=ie===M[Y]&&ie!==k[Y]&&pe;if(Ce&&l&&t.manuallyAnimateOnMount&&(Ce=!1),ee.protectedKeys={...O},!ee.isActive&&xe===null||!ie&&!ee.prevProp||Zv(ie)||typeof ie=="boolean")continue;const je=uG(ee.prevProp,ie);let Ue=je||Y===a&&ee.isActive&&!Ce&&pe||Z>K&&pe,et=!1;const Ie=Array.isArray(ie)?ie:[ie];let ot=Ie.reduce(u(Y),{});xe===!1&&(ot={});const{prevResolvedValues:ut={}}=ee,gt={...ut,...ot},ft=nt=>{Ue=!0,z.has(nt)&&(et=!0,z.delete(nt)),ee.needsAnimating[nt]=!0;const ze=t.getValue(nt);ze&&(ze.liveStyle=!1)};for(const nt in gt){const ze=ot[nt],Se=ut[nt];if(O.hasOwnProperty(nt))continue;let We=!1;Xw(ze)&&Xw(Se)?We=!GR(ze,Se):We=ze!==Se,We?ze!=null?ft(nt):z.add(nt):ze!==void 0&&z.has(nt)?ft(nt):ee.protectedKeys[nt]=!0}ee.prevProp=ie,ee.prevResolvedValues=ot,ee.isActive&&(O={...O,...ot}),l&&t.blockInitialAnimation&&(Ue=!1);const vt=Ce&&je;Ue&&(!vt||et)&&L.push(...Ie.map(nt=>{const ze={type:Y};if(typeof nt=="string"&&l&&!vt&&t.manuallyAnimateOnMount&&t.parent){const{parent:Se}=t,We=Pm(Se,nt);if(Se.enteringChildren&&We){const{delayChildren:fe}=We.transition||{};ze.delay=fR(Se.enteringChildren,t,fe)}}return{animation:nt,options:ze}}))}if(z.size){const Z={};if(typeof k.initial!="boolean"){const Y=Pm(t,Array.isArray(k.initial)?k.initial[0]:k.initial);Y&&Y.transition&&(Z.transition=Y.transition)}z.forEach(Y=>{const ee=t.getBaseTarget(Y),ie=t.getValue(Y);ie&&(ie.liveStyle=!0),Z[Y]=ee??null}),L.push({animation:Z})}let H=!!L.length;return l&&(k.initial===!1||k.initial===k.animate)&&!t.manuallyAnimateOnMount&&(H=!1),l=!1,H?e(L):Promise.resolve()}function b(a,k){if(r[a].isActive===k)return Promise.resolve();t.variantChildren?.forEach(L=>L.animationState?.setActive(a,k)),r[a].isActive=k;const M=v(a);for(const L in r)r[L].protectedKeys={};return M}return{animateChanges:v,setActive:b,setAnimateFunction:m,getState:()=>r,reset:()=>{r=iA()}}}function uG(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!GR(e,t):!1}function Df(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function iA(){return{animate:Df(!0),whileInView:Df(),whileHover:Df(),whileTap:Df(),whileDrag:Df(),whileFocus:Df(),exit:Df()}}function sA(t,e){t.min=e.min,t.max=e.max}function Ol(t,e){sA(t.x,e.x),sA(t.y,e.y)}function oA(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}const HR=1e-4,dG=1-HR,hG=1+HR,WR=.01,fG=0-WR,pG=0+WR;function jo(t){return t.max-t.min}function mG(t,e,r){return Math.abs(t-e)<=r}function aA(t,e,r,l=.5){t.origin=l,t.originPoint=yi(e.min,e.max,t.origin),t.scale=jo(r)/jo(e),t.translate=yi(r.min,r.max,t.origin)-t.originPoint,(t.scale>=dG&&t.scale<=hG||isNaN(t.scale))&&(t.scale=1),(t.translate>=fG&&t.translate<=pG||isNaN(t.translate))&&(t.translate=0)}function Sy(t,e,r,l){aA(t.x,e.x,r.x,l?l.originX:void 0),aA(t.y,e.y,r.y,l?l.originY:void 0)}function lA(t,e,r){t.min=r.min+e.min,t.max=t.min+jo(e)}function gG(t,e,r){lA(t.x,e.x,r.x),lA(t.y,e.y,r.y)}function cA(t,e,r){t.min=e.min-r.min,t.max=t.min+jo(e)}function uv(t,e,r){cA(t.x,e.x,r.x),cA(t.y,e.y,r.y)}function uA(t,e,r,l,u){return t-=e,t=cv(t,1/r,l),u!==void 0&&(t=cv(t,1/u,l)),t}function yG(t,e=0,r=1,l=.5,u,m=t,v=t){if(qc.test(e)&&(e=parseFloat(e),e=yi(v.min,v.max,e/100)-v.min),typeof e!="number")return;let b=yi(m.min,m.max,l);t===m&&(b-=e),t.min=uA(t.min,e,r,b,u),t.max=uA(t.max,e,r,b,u)}function dA(t,e,[r,l,u],m,v){yG(t,e[r],e[l],e[u],e.scale,m,v)}const _G=["x","scaleX","originX"],xG=["y","scaleY","originY"];function hA(t,e,r,l){dA(t.x,e,_G,r?r.x:void 0,l?l.x:void 0),dA(t.y,e,xG,r?r.y:void 0,l?l.y:void 0)}function fA(t){return t.translate===0&&t.scale===1}function qR(t){return fA(t.x)&&fA(t.y)}function pA(t,e){return t.min===e.min&&t.max===e.max}function vG(t,e){return pA(t.x,e.x)&&pA(t.y,e.y)}function mA(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function ZR(t,e){return mA(t.x,e.x)&&mA(t.y,e.y)}function gA(t){return jo(t.x)/jo(t.y)}function yA(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}function Ja(t){return[t("x"),t("y")]}function wG(t,e,r){let l="";const u=t.x.translate/e.x,m=t.y.translate/e.y,v=r?.z||0;if((u||m||v)&&(l=`translate3d(${u}px, ${m}px, ${v}px) `),(e.x!==1||e.y!==1)&&(l+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:k,rotate:M,rotateX:L,rotateY:z,skewX:O,skewY:K}=r;k&&(l=`perspective(${k}px) ${l}`),M&&(l+=`rotate(${M}deg) `),L&&(l+=`rotateX(${L}deg) `),z&&(l+=`rotateY(${z}deg) `),O&&(l+=`skewX(${O}deg) `),K&&(l+=`skewY(${K}deg) `)}const b=t.x.scale*e.x,a=t.y.scale*e.y;return(b!==1||a!==1)&&(l+=`scale(${b}, ${a})`),l||"none"}const XR=["TopLeft","TopRight","BottomLeft","BottomRight"],bG=XR.length,_A=t=>typeof t=="string"?parseFloat(t):t,xA=t=>typeof t=="number"||yn.test(t);function TG(t,e,r,l,u,m){u?(t.opacity=yi(0,r.opacity??1,SG(l)),t.opacityExit=yi(e.opacity??1,0,EG(l))):m&&(t.opacity=yi(e.opacity??1,r.opacity??1,l));for(let v=0;v<bG;v++){const b=`border${XR[v]}Radius`;let a=vA(e,b),k=vA(r,b);if(a===void 0&&k===void 0)continue;a||(a=0),k||(k=0),a===0||k===0||xA(a)===xA(k)?(t[b]=Math.max(yi(_A(a),_A(k),l),0),(qc.test(k)||qc.test(a))&&(t[b]+="%")):t[b]=k}(e.rotate||r.rotate)&&(t.rotate=yi(e.rotate||0,r.rotate||0,l))}function vA(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const SG=KR(0,.5,$N),EG=KR(.5,.95,rl);function KR(t,e,r){return l=>l<t?0:l>e?1:r(By(t,e,l))}function CG(t,e,r){const l=Xs(t)?t:Qf(t);return l.start(MT("",l,e,r)),l.animation}function $y(t,e,r,l={passive:!0}){return t.addEventListener(e,r,l),()=>t.removeEventListener(e,r)}const kG=(t,e)=>t.depth-e.depth;class AG{constructor(){this.children=[],this.isDirty=!1}add(e){fT(this.children,e),this.isDirty=!0}remove(e){pT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(kG),this.isDirty=!1,this.children.forEach(e)}}function IG(t,e){const r=Lo.now(),l=({timestamp:u})=>{const m=u-r;m>=e&&(Ju(l),t(m-e))};return ei.setup(l,!0),()=>Ju(l)}function zx(t){return Xs(t)?t.get():t}class MG{constructor(){this.members=[]}add(e){fT(this.members,e),e.scheduleRender()}remove(e){if(pT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(u=>e===u);if(r===0)return!1;let l;for(let u=r;u>=0;u--){const m=this.members[u];if(m.isPresent!==!1){l=m;break}}return l?(this.promote(l),!0):!1}promote(e,r){const l=this.lead;if(e!==l&&(this.prevLead=l,this.lead=e,e.show(),l)){l.instance&&l.scheduleRender(),e.scheduleRender();const u=l.options.layoutDependency,m=e.options.layoutDependency;u!==void 0&&m!==void 0&&u===m||(e.resumeFrom=l,r&&(e.resumeFrom.preserveOpacity=!0),l.snapshot&&(e.snapshot=l.snapshot,e.snapshot.latestValues=l.animationValues||l.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));const{crossfade:b}=e.options;b===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:l}=e;r.onExitComplete&&r.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Bx={hasAnimatedSinceResize:!0,hasEverUpdated:!1},O1=["","X","Y","Z"],PG=1e3;let NG=0;function z1(t,e,r,l){const{latestValues:u}=e;u[t]&&(r[t]=u[t],e.setStaticValue(t,0),l&&(l[t]=0))}function YR(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=yR(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:u,layoutId:m}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",ei,!(u||m))}const{parent:l}=t;l&&!l.hasCheckedOptimisedAppear&&YR(l)}function JR({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:l,resetTransform:u}){return class{constructor(v={},b=e?.()){this.id=NG++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(LG),this.nodes.forEach(BG),this.nodes.forEach(FG),this.nodes.forEach(jG)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=v,this.root=b?b.root||b:this,this.path=b?[...b.path,b]:[],this.parent=b,this.depth=b?b.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new AG)}addEventListener(v,b){return this.eventHandlers.has(v)||this.eventHandlers.set(v,new yT),this.eventHandlers.get(v).add(b)}notifyListeners(v,...b){const a=this.eventHandlers.get(v);a&&a.notify(...b)}hasListeners(v){return this.eventHandlers.has(v)}mount(v){if(this.instance)return;this.isSVG=AR(v)&&!R9(v),this.instance=v;const{layoutId:b,layout:a,visualElement:k}=this.options;if(k&&!k.current&&k.mount(v),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||b)&&(this.isLayoutDirty=!0),t){let M,L=0;const z=()=>this.root.updateBlockedByResize=!1;ei.read(()=>{L=window.innerWidth}),t(v,()=>{const O=window.innerWidth;O!==L&&(L=O,this.root.updateBlockedByResize=!0,M&&M(),M=IG(z,250),Bx.hasAnimatedSinceResize&&(Bx.hasAnimatedSinceResize=!1,this.nodes.forEach(TA)))})}b&&this.root.registerSharedNode(b,this),this.options.animate!==!1&&k&&(b||a)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:L,hasRelativeLayoutChanged:z,layout:O})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const K=this.options.transition||k.getDefaultTransition()||HG,{onLayoutAnimationStart:H,onLayoutAnimationComplete:Z}=k.getProps(),Y=!this.targetLayout||!ZR(this.targetLayout,O),ee=!L&&z;if(this.options.layoutRoot||this.resumeFrom||ee||L&&(Y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ie={...IT(K,"layout"),onPlay:H,onComplete:Z};(k.shouldReduceMotion||this.options.layoutRoot)&&(ie.delay=0,ie.type=!1),this.startAnimation(ie),this.setAnimationOrigin(M,ee)}else L||TA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=O})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const v=this.getStack();v&&v.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ju(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(VG),this.animationId++)}getTransformTemplate(){const{visualElement:v}=this.options;return v&&v.getProps().transformTemplate}willUpdate(v=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&YR(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let M=0;M<this.path.length;M++){const L=this.path[M];L.shouldResetTransform=!0,L.updateScroll("snapshot"),L.options.layoutRoot&&L.willUpdate(!1)}const{layoutId:b,layout:a}=this.options;if(b===void 0&&!a)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),v&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(wA);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(bA);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(zG),this.nodes.forEach(RG),this.nodes.forEach(DG)):this.nodes.forEach(bA),this.clearAllSnapshots();const b=Lo.now();Zs.delta=Kc(0,1e3/60,b-Zs.timestamp),Zs.timestamp=b,Zs.isProcessing=!0,I1.update.process(Zs),I1.preRender.process(Zs),I1.render.process(Zs),Zs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,DT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(OG),this.sharedNodes.forEach(UG)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ei.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ei.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!jo(this.snapshot.measuredBox.x)&&!jo(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();const v=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ms(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:b}=this.options;b&&b.notify("LayoutMeasure",this.layout.layoutBox,v?v.layoutBox:void 0)}updateScroll(v="measure"){let b=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===v&&(b=!1),b&&this.instance){const a=l(this.instance);this.scroll={animationId:this.root.animationId,phase:v,isRoot:a,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:a}}}resetTransform(){if(!u)return;const v=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,b=this.projectionDelta&&!qR(this.projectionDelta),a=this.getTransformTemplate(),k=a?a(this.latestValues,""):void 0,M=k!==this.prevTransformTemplateValue;v&&this.instance&&(b||Bf(this.latestValues)||M)&&(u(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(v=!0){const b=this.measurePageBox();let a=this.removeElementScroll(b);return v&&(a=this.removeTransform(a)),WG(a),{animationId:this.root.animationId,measuredBox:b,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:v}=this.options;if(!v)return ms();const b=v.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(qG))){const{scroll:k}=this.root;k&&(Tm(b.x,k.offset.x),Tm(b.y,k.offset.y))}return b}removeElementScroll(v){const b=ms();if(Ol(b,v),this.scroll?.wasRoot)return b;for(let a=0;a<this.path.length;a++){const k=this.path[a],{scroll:M,options:L}=k;k!==this.root&&M&&L.layoutScroll&&(M.wasRoot&&Ol(b,v),Tm(b.x,M.offset.x),Tm(b.y,M.offset.y))}return b}applyTransform(v,b=!1){const a=ms();Ol(a,v);for(let k=0;k<this.path.length;k++){const M=this.path[k];!b&&M.options.layoutScroll&&M.scroll&&M!==M.root&&Sm(a,{x:-M.scroll.offset.x,y:-M.scroll.offset.y}),Bf(M.latestValues)&&Sm(a,M.latestValues)}return Bf(this.latestValues)&&Sm(a,this.latestValues),a}removeTransform(v){const b=ms();Ol(b,v);for(let a=0;a<this.path.length;a++){const k=this.path[a];if(!k.instance||!Bf(k.latestValues))continue;tb(k.latestValues)&&k.updateSnapshot();const M=ms(),L=k.measurePageBox();Ol(M,L),hA(b,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,M)}return Bf(this.latestValues)&&hA(b,this.latestValues),b}setTargetDelta(v){this.targetDelta=v,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(v){this.options={...this.options,...v,crossfade:v.crossfade!==void 0?v.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Zs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(v=!1){const b=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=b.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=b.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=b.isSharedProjectionDirty);const a=!!this.resumingFrom||this!==b;if(!(v||a&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:M,layoutId:L}=this.options;if(!this.layout||!(M||L))return;this.resolvedRelativeTargetAt=Zs.timestamp;const z=this.getClosestProjectingParent();z&&this.linkedParentVersion!==z.layoutVersion&&!z.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(z&&z.layout?this.createRelativeTarget(z,this.layout.layoutBox,z.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ms(),this.targetWithTransforms=ms()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),gG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ol(this.target,this.layout.layoutBox),LR(this.target,this.targetDelta)):Ol(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,z&&!!z.resumingFrom==!!this.resumingFrom&&!z.options.layoutScroll&&z.target&&this.animationProgress!==1?this.createRelativeTarget(z,this.target,z.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||tb(this.parent.latestValues)||DR(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(v,b,a){this.relativeParent=v,this.linkedParentVersion=v.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ms(),this.relativeTargetOrigin=ms(),uv(this.relativeTargetOrigin,b,a),Ol(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const v=this.getLead(),b=!!this.resumingFrom||this!==v;let a=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(a=!1),b&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(a=!1),this.resolvedRelativeTargetAt===Zs.timestamp&&(a=!1),a)return;const{layout:k,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||M))return;Ol(this.layoutCorrected,this.layout.layoutBox);const L=this.treeScale.x,z=this.treeScale.y;H9(this.layoutCorrected,this.treeScale,this.path,b),v.layout&&!v.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(v.target=v.layout.layoutBox,v.targetWithTransforms=ms());const{target:O}=v;if(!O){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(oA(this.prevProjectionDelta.x,this.projectionDelta.x),oA(this.prevProjectionDelta.y,this.projectionDelta.y)),Sy(this.projectionDelta,this.layoutCorrected,O,this.latestValues),(this.treeScale.x!==L||this.treeScale.y!==z||!yA(this.projectionDelta.x,this.prevProjectionDelta.x)||!yA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",O))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(v=!0){if(this.options.visualElement?.scheduleRender(),v){const b=this.getStack();b&&b.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=bm(),this.projectionDelta=bm(),this.projectionDeltaWithTransform=bm()}setAnimationOrigin(v,b=!1){const a=this.snapshot,k=a?a.latestValues:{},M={...this.latestValues},L=bm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!b;const z=ms(),O=a?a.source:void 0,K=this.layout?this.layout.source:void 0,H=O!==K,Z=this.getStack(),Y=!Z||Z.members.length<=1,ee=!!(H&&!Y&&this.options.crossfade===!0&&!this.path.some(GG));this.animationProgress=0;let ie;this.mixTargetDelta=pe=>{const xe=pe/1e3;SA(L.x,v.x,xe),SA(L.y,v.y,xe),this.setTargetDelta(L),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(uv(z,this.layout.layoutBox,this.relativeParent.layout.layoutBox),$G(this.relativeTarget,this.relativeTargetOrigin,z,xe),ie&&vG(this.relativeTarget,ie)&&(this.isProjectionDirty=!1),ie||(ie=ms()),Ol(ie,this.relativeTarget)),H&&(this.animationValues=M,TG(M,k,this.latestValues,xe,ee,Y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=xe},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(v){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ju(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ei.update(()=>{Bx.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Qf(0)),this.currentAnimation=CG(this.motionValue,[0,1e3],{...v,velocity:0,isSync:!0,onUpdate:b=>{this.mixTargetDelta(b),v.onUpdate&&v.onUpdate(b)},onStop:()=>{},onComplete:()=>{v.onComplete&&v.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const v=this.getStack();v&&v.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(PG),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const v=this.getLead();let{targetWithTransforms:b,target:a,layout:k,latestValues:M}=v;if(!(!b||!a||!k)){if(this!==v&&this.layout&&k&&QR(this.options.animationType,this.layout.layoutBox,k.layoutBox)){a=this.target||ms();const L=jo(this.layout.layoutBox.x);a.x.min=v.target.x.min,a.x.max=a.x.min+L;const z=jo(this.layout.layoutBox.y);a.y.min=v.target.y.min,a.y.max=a.y.min+z}Ol(b,a),Sm(b,M),Sy(this.projectionDeltaWithTransform,this.layoutCorrected,b,M)}}registerSharedNode(v,b){this.sharedNodes.has(v)||this.sharedNodes.set(v,new MG),this.sharedNodes.get(v).add(b);const k=b.options.initialPromotionConfig;b.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(b):void 0})}isLead(){const v=this.getStack();return v?v.lead===this:!0}getLead(){const{layoutId:v}=this.options;return v?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:v}=this.options;return v?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:v}=this.options;if(v)return this.root.sharedNodes.get(v)}promote({needsReset:v,transition:b,preserveFollowOpacity:a}={}){const k=this.getStack();k&&k.promote(this,a),v&&(this.projectionDelta=void 0,this.needsReset=!0),b&&this.setOptions({transition:b})}relegate(){const v=this.getStack();return v?v.relegate(this):!1}resetSkewAndRotation(){const{visualElement:v}=this.options;if(!v)return;let b=!1;const{latestValues:a}=v;if((a.z||a.rotate||a.rotateX||a.rotateY||a.rotateZ||a.skewX||a.skewY)&&(b=!0),!b)return;const k={};a.z&&z1("z",v,k,this.animationValues);for(let M=0;M<O1.length;M++)z1(`rotate${O1[M]}`,v,k,this.animationValues),z1(`skew${O1[M]}`,v,k,this.animationValues);v.render();for(const M in k)v.setStaticValue(M,k[M]),this.animationValues&&(this.animationValues[M]=k[M]);v.scheduleRender()}applyProjectionStyles(v,b){if(!this.instance||this.isSVG)return;if(!this.isVisible){v.visibility="hidden";return}const a=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,v.visibility="",v.opacity="",v.pointerEvents=zx(b?.pointerEvents)||"",v.transform=a?a(this.latestValues,""):"none";return}const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=zx(b?.pointerEvents)||""),this.hasProjected&&!Bf(this.latestValues)&&(v.transform=a?a({},""):"none",this.hasProjected=!1);return}v.visibility="";const M=k.animationValues||k.latestValues;this.applyTransformsToTarget();let L=wG(this.projectionDeltaWithTransform,this.treeScale,M);a&&(L=a(M,L)),v.transform=L;const{x:z,y:O}=this.projectionDelta;v.transformOrigin=`${z.origin*100}% ${O.origin*100}% 0`,k.animationValues?v.opacity=k===this?M.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:v.opacity=k===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const K in rb){if(M[K]===void 0)continue;const{correct:H,applyTo:Z,isCSSVariable:Y}=rb[K],ee=L==="none"?M[K]:H(M[K],k);if(Z){const ie=Z.length;for(let pe=0;pe<ie;pe++)v[Z[pe]]=ee}else Y?this.options.visualElement.renderState.vars[K]=ee:v[K]=ee}this.options.layoutId&&(v.pointerEvents=k===this?zx(b?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(v=>v.currentAnimation?.stop()),this.root.nodes.forEach(wA),this.root.sharedNodes.clear()}}}function RG(t){t.updateLayout()}function DG(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:l}=t.layout,{animationType:u}=t.options,m=e.source!==t.layout.source;u==="size"?Ja(M=>{const L=m?e.measuredBox[M]:e.layoutBox[M],z=jo(L);L.min=r[M].min,L.max=L.min+z}):QR(u,e.layoutBox,r)&&Ja(M=>{const L=m?e.measuredBox[M]:e.layoutBox[M],z=jo(r[M]);L.max=L.min+z,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[M].max=t.relativeTarget[M].min+z)});const v=bm();Sy(v,r,e.layoutBox);const b=bm();m?Sy(b,t.applyTransform(l,!0),e.measuredBox):Sy(b,r,e.layoutBox);const a=!qR(v);let k=!1;if(!t.resumeFrom){const M=t.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:L,layout:z}=M;if(L&&z){const O=ms();uv(O,e.layoutBox,L.layoutBox);const K=ms();uv(K,r,z.layoutBox),ZR(O,K)||(k=!0),M.options.layoutRoot&&(t.relativeTarget=K,t.relativeTargetOrigin=O,t.relativeParent=M)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:b,layoutDelta:v,hasLayoutChanged:a,hasRelativeLayoutChanged:k})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function LG(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function jG(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function OG(t){t.clearSnapshot()}function wA(t){t.clearMeasurements()}function bA(t){t.isLayoutDirty=!1}function zG(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function TA(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function BG(t){t.resolveTargetDelta()}function FG(t){t.calcProjection()}function VG(t){t.resetSkewAndRotation()}function UG(t){t.removeLeadSnapshot()}function SA(t,e,r){t.translate=yi(e.translate,0,r),t.scale=yi(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function EA(t,e,r,l){t.min=yi(e.min,r.min,l),t.max=yi(e.max,r.max,l)}function $G(t,e,r,l){EA(t.x,e.x,r.x,l),EA(t.y,e.y,r.y,l)}function GG(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const HG={duration:.45,ease:[.4,0,.1,1]},CA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),kA=CA("applewebkit/")&&!CA("chrome/")?Math.round:rl;function AA(t){t.min=kA(t.min),t.max=kA(t.max)}function WG(t){AA(t.x),AA(t.y)}function QR(t,e,r){return t==="position"||t==="preserve-aspect"&&!mG(gA(e),gA(r),.2)}function qG(t){return t!==t.root&&t.scroll?.wasRoot}const ZG=JR({attachResizeListener:(t,e)=>$y(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),B1={current:void 0},e3=JR({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!B1.current){const t=new ZG({});t.mount(window),t.setOptions({layoutScroll:!0}),B1.current=t}return B1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Kv=P.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function IA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function XG(...t){return e=>{let r=!1;const l=t.map(u=>{const m=IA(u,e);return!r&&typeof m=="function"&&(r=!0),m});if(r)return()=>{for(let u=0;u<l.length;u++){const m=l[u];typeof m=="function"?m():IA(t[u],null)}}}}function KG(...t){return P.useCallback(XG(...t),t)}class YG extends P.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const l=r.offsetParent,u=Qw(l)&&l.offsetWidth||0,m=Qw(l)&&l.offsetHeight||0,v=this.props.sizeRef.current;v.height=r.offsetHeight||0,v.width=r.offsetWidth||0,v.top=r.offsetTop,v.left=r.offsetLeft,v.right=u-v.width-v.left,v.bottom=m-v.height-v.top}return null}componentDidUpdate(){}render(){return this.props.children}}function JG({children:t,isPresent:e,anchorX:r,anchorY:l,root:u}){const m=P.useId(),v=P.useRef(null),b=P.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:a}=P.useContext(Kv),k=t.props?.ref??t?.ref,M=KG(v,k);return P.useInsertionEffect(()=>{const{width:L,height:z,top:O,left:K,right:H,bottom:Z}=b.current;if(e||!v.current||!L||!z)return;const Y=r==="left"?`left: ${K}`:`right: ${H}`,ee=l==="bottom"?`bottom: ${Z}`:`top: ${O}`;v.current.dataset.motionPopId=m;const ie=document.createElement("style");a&&(ie.nonce=a);const pe=u??document.head;return pe.appendChild(ie),ie.sheet&&ie.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${L}px !important;
            height: ${z}px !important;
            ${Y}px !important;
            ${ee}px !important;
          }
        `),()=>{pe.contains(ie)&&pe.removeChild(ie)}},[e]),_.jsx(YG,{isPresent:e,childRef:v,sizeRef:b,children:P.cloneElement(t,{ref:M})})}const QG=({children:t,initial:e,isPresent:r,onExitComplete:l,custom:u,presenceAffectsLayout:m,mode:v,anchorX:b,anchorY:a,root:k})=>{const M=ap(eH),L=P.useId();let z=!0,O=P.useMemo(()=>(z=!1,{id:L,initial:e,isPresent:r,custom:u,onExitComplete:K=>{M.set(K,!0);for(const H of M.values())if(!H)return;l&&l()},register:K=>(M.set(K,!1),()=>M.delete(K))}),[r,M,l]);return m&&z&&(O={...O}),P.useMemo(()=>{M.forEach((K,H)=>M.set(H,!1))},[r]),P.useEffect(()=>{!r&&!M.size&&l&&l()},[r]),v==="popLayout"&&(t=_.jsx(JG,{isPresent:r,anchorX:b,anchorY:a,root:k,children:t})),_.jsx(qv.Provider,{value:O,children:t})};function eH(){return new Map}function t3(t=!0){const e=P.useContext(qv);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:l,register:u}=e,m=P.useId();P.useEffect(()=>{if(t)return u(m)},[t]);const v=P.useCallback(()=>t&&l&&l(m),[m,l,t]);return!r&&l?[!1,v]:[!0]}const _x=t=>t.key||"";function MA(t){const e=[];return P.Children.forEach(t,r=>{P.isValidElement(r)&&e.push(r)}),e}const Sa=({children:t,custom:e,initial:r=!0,onExitComplete:l,presenceAffectsLayout:u=!0,mode:m="sync",propagate:v=!1,anchorX:b="left",anchorY:a="top",root:k})=>{const[M,L]=t3(v),z=P.useMemo(()=>MA(t),[t]),O=v&&!M?[]:z.map(_x),K=P.useRef(!0),H=P.useRef(z),Z=ap(()=>new Map),Y=P.useRef(new Set),[ee,ie]=P.useState(z),[pe,xe]=P.useState(z);hT(()=>{K.current=!1,H.current=z;for(let Ue=0;Ue<pe.length;Ue++){const et=_x(pe[Ue]);O.includes(et)?(Z.delete(et),Y.current.delete(et)):Z.get(et)!==!0&&Z.set(et,!1)}},[pe,O.length,O.join("-")]);const Ce=[];if(z!==ee){let Ue=[...z];for(let et=0;et<pe.length;et++){const Ie=pe[et],ot=_x(Ie);O.includes(ot)||(Ue.splice(et,0,Ie),Ce.push(Ie))}return m==="wait"&&Ce.length&&(Ue=Ce),xe(MA(Ue)),ie(z),null}const{forceRender:je}=P.useContext(dT);return _.jsx(_.Fragment,{children:pe.map(Ue=>{const et=_x(Ue),Ie=v&&!M?!1:z===pe||O.includes(et),ot=()=>{if(Y.current.has(et))return;if(Y.current.add(et),Z.has(et))Z.set(et,!0);else return;let ut=!0;Z.forEach(gt=>{gt||(ut=!1)}),ut&&(je?.(),xe(H.current),v&&L?.(),l&&l())};return _.jsx(QG,{isPresent:Ie,initial:!K.current||r?void 0:!1,custom:e,presenceAffectsLayout:u,mode:m,root:k,onExitComplete:Ie?void 0:ot,anchorX:b,anchorY:a,children:Ue},et)})})},n3=P.createContext({strict:!1}),PA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let NA=!1;function tH(){if(NA)return;const t={};for(const e in PA)t[e]={isEnabled:r=>PA[e].some(l=>!!r[l])};PR(t),NA=!0}function r3(){return tH(),V9()}function nH(t){const e=r3();for(const r in t)e[r]={...e[r],...t[r]};PR(e)}const rH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function dv(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||rH.has(t)}let i3=t=>!dv(t);function iH(t){typeof t=="function"&&(i3=e=>e.startsWith("on")?!dv(e):t(e))}try{iH(require("@emotion/is-prop-valid").default)}catch{}function sH(t,e,r){const l={};for(const u in t)u==="values"&&typeof t.values=="object"||(i3(u)||r===!0&&dv(u)||!e&&!dv(u)||t.draggable&&u.startsWith("onDrag"))&&(l[u]=t[u]);return l}const Yv=P.createContext({});function oH(t,e){if(Xv(t)){const{initial:r,animate:l}=t;return{initial:r===!1||Uy(r)?r:void 0,animate:Uy(l)?l:void 0}}return t.inherit!==!1?e:{}}function aH(t){const{initial:e,animate:r}=oH(t,P.useContext(Yv));return P.useMemo(()=>({initial:e,animate:r}),[RA(e),RA(r)])}function RA(t){return Array.isArray(t)?t.join(" "):t}const FT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function s3(t,e,r){for(const l in e)!Xs(e[l])&&!zR(l,r)&&(t[l]=e[l])}function lH({transformTemplate:t},e){return P.useMemo(()=>{const r=FT();return zT(r,e,t),Object.assign({},r.vars,r.style)},[e])}function cH(t,e){const r=t.style||{},l={};return s3(l,r,t),Object.assign(l,lH(t,e)),l}function uH(t,e){const r={},l=cH(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,l.userSelect=l.WebkitUserSelect=l.WebkitTouchCallout="none",l.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=l,r}const o3=()=>({...FT(),attrs:{}});function dH(t,e,r,l){const u=P.useMemo(()=>{const m=o3();return BR(m,e,VR(l),t.transformTemplate,t.style),{...m.attrs,style:{...m.style}}},[e]);if(t.style){const m={};s3(m,t.style,t),u.style={...m,...u.style}}return u}const hH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function VT(t){return typeof t!="string"||t.includes("-")?!1:!!(hH.indexOf(t)>-1||/[A-Z]/u.test(t))}function fH(t,e,r,{latestValues:l},u,m=!1,v){const a=(v??VT(t)?dH:uH)(e,l,u,t),k=sH(e,typeof t=="string",m),M=t!==P.Fragment?{...k,...a,ref:r}:{},{children:L}=e,z=P.useMemo(()=>Xs(L)?L.get():L,[L]);return P.createElement(t,{...M,children:z})}function pH({scrapeMotionValuesFromProps:t,createRenderState:e},r,l,u){return{latestValues:mH(r,l,u,t),renderState:e()}}function mH(t,e,r,l){const u={},m=l(t,{});for(const z in m)u[z]=zx(m[z]);let{initial:v,animate:b}=t;const a=Xv(t),k=MR(t);e&&k&&!a&&t.inherit!==!1&&(v===void 0&&(v=e.initial),b===void 0&&(b=e.animate));let M=r?r.initial===!1:!1;M=M||v===!1;const L=M?b:v;if(L&&typeof L!="boolean"&&!Zv(L)){const z=Array.isArray(L)?L:[L];for(let O=0;O<z.length;O++){const K=PT(t,z[O]);if(K){const{transitionEnd:H,transition:Z,...Y}=K;for(const ee in Y){let ie=Y[ee];if(Array.isArray(ie)){const pe=M?ie.length-1:0;ie=ie[pe]}ie!==null&&(u[ee]=ie)}for(const ee in H)u[ee]=H[ee]}}}return u}const a3=t=>(e,r)=>{const l=P.useContext(Yv),u=P.useContext(qv),m=()=>pH(t,e,l,u);return r?m():ap(m)},gH=a3({scrapeMotionValuesFromProps:BT,createRenderState:FT}),yH=a3({scrapeMotionValuesFromProps:UR,createRenderState:o3}),_H=Symbol.for("motionComponentSymbol");function xH(t,e,r){const l=P.useRef(r);P.useInsertionEffect(()=>{l.current=r});const u=P.useRef(null);return P.useCallback(m=>{m&&t.onMount?.(m),e&&(m?e.mount(m):e.unmount());const v=l.current;if(typeof v=="function")if(m){const b=v(m);typeof b=="function"&&(u.current=b)}else u.current?(u.current(),u.current=null):v(m);else v&&(v.current=m)},[e])}const l3=P.createContext({});function cy(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function vH(t,e,r,l,u,m){const{visualElement:v}=P.useContext(Yv),b=P.useContext(n3),a=P.useContext(qv),k=P.useContext(Kv).reducedMotion,M=P.useRef(null),L=P.useRef(!1);l=l||b.renderer,!M.current&&l&&(M.current=l(t,{visualState:e,parent:v,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:k,isSVG:m}),L.current&&M.current&&(M.current.manuallyAnimateOnMount=!0));const z=M.current,O=P.useContext(l3);z&&!z.projection&&u&&(z.type==="html"||z.type==="svg")&&wH(M.current,r,u,O);const K=P.useRef(!1);P.useInsertionEffect(()=>{z&&K.current&&z.update(r,a)});const H=r[gR],Z=P.useRef(!!H&&!window.MotionHandoffIsComplete?.(H)&&window.MotionHasOptimisedAnimation?.(H));return hT(()=>{L.current=!0,z&&(K.current=!0,window.MotionIsMounted=!0,z.updateFeatures(),z.scheduleRenderMicrotask(),Z.current&&z.animationState&&z.animationState.animateChanges())}),P.useEffect(()=>{z&&(!Z.current&&z.animationState&&z.animationState.animateChanges(),Z.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(H)}),Z.current=!1),z.enteringChildren=void 0)}),z}function wH(t,e,r,l){const{layoutId:u,layout:m,drag:v,dragConstraints:b,layoutScroll:a,layoutRoot:k,layoutCrossfade:M}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:c3(t.parent)),t.projection.setOptions({layoutId:u,layout:m,alwaysMeasureLayout:!!v||b&&cy(b),visualElement:t,animationType:typeof m=="string"?m:"both",initialPromotionConfig:l,crossfade:M,layoutScroll:a,layoutRoot:k})}function c3(t){if(t)return t.options.allowProjection!==!1?t.projection:c3(t.parent)}function F1(t,{forwardMotionProps:e=!1,type:r}={},l,u){l&&nH(l);const m=r?r==="svg":VT(t),v=m?yH:gH;function b(k,M){let L;const z={...P.useContext(Kv),...k,layoutId:bH(k)},{isStatic:O}=z,K=aH(k),H=v(k,O);if(!O&&NN){TH();const Z=SH(z);L=Z.MeasureLayout,K.visualElement=vH(t,H,z,u,Z.ProjectionNode,m)}return _.jsxs(Yv.Provider,{value:K,children:[L&&K.visualElement?_.jsx(L,{visualElement:K.visualElement,...z}):null,fH(t,k,xH(H,K.visualElement,M),H,O,e,m)]})}b.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=P.forwardRef(b);return a[_H]=t,a}function bH({layoutId:t}){const e=P.useContext(dT).id;return e&&t!==void 0?e+"-"+t:t}function TH(t,e){P.useContext(n3).strict}function SH(t){const e=r3(),{drag:r,layout:l}=e;if(!r&&!l)return{};const u={...r,...l};return{MeasureLayout:r?.isEnabled(t)||l?.isEnabled(t)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function EH(t,e){if(typeof Proxy>"u")return F1;const r=new Map,l=(m,v)=>F1(m,v,t,e),u=(m,v)=>l(m,v);return new Proxy(u,{get:(m,v)=>v==="create"?l:(r.has(v)||r.set(v,F1(v,void 0,t,e)),r.get(v))})}const CH=(t,e)=>e.isSVG??VT(t)?new iG(e):new J9(e,{allowProjection:t!==P.Fragment});class kH extends Eh{constructor(e){super(e),e.animationState||(e.animationState=cG(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Zv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let AH=0;class IH extends Eh{constructor(){super(...arguments),this.id=AH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:l}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===l)return;const u=this.node.animationState.setActive("exit",!e);r&&!e&&u.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const MH={animation:{Feature:kH},exit:{Feature:IH}};function f_(t){return{point:{x:t.pageX,y:t.pageY}}}const PH=t=>e=>LT(e)&&t(e,f_(e));function Ey(t,e,r,l){return $y(t,e,PH(r),l)}const u3=({current:t})=>t?t.ownerDocument.defaultView:null,DA=(t,e)=>Math.abs(t-e);function NH(t,e){const r=DA(t.x,e.x),l=DA(t.y,e.y);return Math.sqrt(r**2+l**2)}const LA=new Set(["auto","scroll"]);class d3{constructor(e,r,{transformPagePoint:l,contextWindow:u=window,dragSnapToOrigin:m=!1,distanceThreshold:v=3,element:b}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=O=>{this.handleScroll(O.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const O=U1(this.lastMoveEventInfo,this.history),K=this.startEvent!==null,H=NH(O.offset,{x:0,y:0})>=this.distanceThreshold;if(!K&&!H)return;const{point:Z}=O,{timestamp:Y}=Zs;this.history.push({...Z,timestamp:Y});const{onStart:ee,onMove:ie}=this.handlers;K||(ee&&ee(this.lastMoveEvent,O),this.startEvent=this.lastMoveEvent),ie&&ie(this.lastMoveEvent,O)},this.handlePointerMove=(O,K)=>{this.lastMoveEvent=O,this.lastMoveEventInfo=V1(K,this.transformPagePoint),ei.update(this.updatePoint,!0)},this.handlePointerUp=(O,K)=>{this.end();const{onEnd:H,onSessionEnd:Z,resumeAnimation:Y}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&Y&&Y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ee=U1(O.type==="pointercancel"?this.lastMoveEventInfo:V1(K,this.transformPagePoint),this.history);this.startEvent&&H&&H(O,ee),Z&&Z(O,ee)},!LT(e))return;this.dragSnapToOrigin=m,this.handlers=r,this.transformPagePoint=l,this.distanceThreshold=v,this.contextWindow=u||window;const a=f_(e),k=V1(a,this.transformPagePoint),{point:M}=k,{timestamp:L}=Zs;this.history=[{...M,timestamp:L}];const{onSessionStart:z}=r;z&&z(e,U1(k,this.history)),this.removeListeners=u_(Ey(this.contextWindow,"pointermove",this.handlePointerMove),Ey(this.contextWindow,"pointerup",this.handlePointerUp),Ey(this.contextWindow,"pointercancel",this.handlePointerUp)),b&&this.startScrollTracking(b)}startScrollTracking(e){let r=e.parentElement;for(;r;){const l=getComputedStyle(r);(LA.has(l.overflowX)||LA.has(l.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const r=this.scrollPositions.get(e);if(!r)return;const l=e===window,u=l?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},m={x:u.x-r.x,y:u.y-r.y};m.x===0&&m.y===0||(l?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=m.x,this.lastMoveEventInfo.point.y+=m.y):this.history.length>0&&(this.history[0].x-=m.x,this.history[0].y-=m.y),this.scrollPositions.set(e,u),ei.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ju(this.updatePoint)}}function V1(t,e){return e?{point:e(t.point)}:t}function jA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function U1({point:t},e){return{point:t,delta:jA(t,h3(e)),offset:jA(t,RH(e)),velocity:DH(e,.1)}}function RH(t){return t[0]}function h3(t){return t[t.length-1]}function DH(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,l=null;const u=h3(t);for(;r>=0&&(l=t[r],!(u.timestamp-l.timestamp>Wu(e)));)r--;if(!l)return{x:0,y:0};const m=tl(u.timestamp-l.timestamp);if(m===0)return{x:0,y:0};const v={x:(u.x-l.x)/m,y:(u.y-l.y)/m};return v.x===1/0&&(v.x=0),v.y===1/0&&(v.y=0),v}function LH(t,{min:e,max:r},l){return e!==void 0&&t<e?t=l?yi(e,t,l.min):Math.max(t,e):r!==void 0&&t>r&&(t=l?yi(r,t,l.max):Math.min(t,r)),t}function OA(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function jH(t,{top:e,left:r,bottom:l,right:u}){return{x:OA(t.x,r,u),y:OA(t.y,e,l)}}function zA(t,e){let r=e.min-t.min,l=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,l]=[l,r]),{min:r,max:l}}function OH(t,e){return{x:zA(t.x,e.x),y:zA(t.y,e.y)}}function zH(t,e){let r=.5;const l=jo(t),u=jo(e);return u>l?r=By(e.min,e.max-l,t.min):l>u&&(r=By(t.min,t.max-u,e.min)),Kc(0,1,r)}function BH(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const ib=.35;function FH(t=ib){return t===!1?t=0:t===!0&&(t=ib),{x:BA(t,"left","right"),y:BA(t,"top","bottom")}}function BA(t,e,r){return{min:FA(t,e),max:FA(t,r)}}function FA(t,e){return typeof t=="number"?t:t[e]||0}const VH=new WeakMap;class UH{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ms(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:l}={}){const{presenceContext:u}=this.visualElement;if(u&&u.isPresent===!1)return;const m=L=>{r?(this.stopAnimation(),this.snapToCursor(f_(L).point)):this.pauseAnimation()},v=(L,z)=>{this.stopAnimation();const{drag:O,dragPropagation:K,onDragStart:H}=this.getProps();if(O&&!K&&(this.openDragLock&&this.openDragLock(),this.openDragLock=A9(O),!this.openDragLock))return;this.latestPointerEvent=L,this.latestPanInfo=z,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ja(Y=>{let ee=this.getAxisMotionValue(Y).get()||0;if(qc.test(ee)){const{projection:ie}=this.visualElement;if(ie&&ie.layout){const pe=ie.layout.layoutBox[Y];pe&&(ee=jo(pe)*(parseFloat(ee)/100))}}this.originPoint[Y]=ee}),H&&ei.postRender(()=>H(L,z)),Kw(this.visualElement,"transform");const{animationState:Z}=this.visualElement;Z&&Z.setActive("whileDrag",!0)},b=(L,z)=>{this.latestPointerEvent=L,this.latestPanInfo=z;const{dragPropagation:O,dragDirectionLock:K,onDirectionLock:H,onDrag:Z}=this.getProps();if(!O&&!this.openDragLock)return;const{offset:Y}=z;if(K&&this.currentDirection===null){this.currentDirection=$H(Y),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",z.point,Y),this.updateAxis("y",z.point,Y),this.visualElement.render(),Z&&Z(L,z)},a=(L,z)=>{this.latestPointerEvent=L,this.latestPanInfo=z,this.stop(L,z),this.latestPointerEvent=null,this.latestPanInfo=null},k=()=>Ja(L=>this.getAnimationState(L)==="paused"&&this.getAxisMotionValue(L).animation?.play()),{dragSnapToOrigin:M}=this.getProps();this.panSession=new d3(e,{onSessionStart:m,onStart:v,onMove:b,onSessionEnd:a,resumeAnimation:k},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:M,distanceThreshold:l,contextWindow:u3(this.visualElement),element:this.visualElement.current})}stop(e,r){const l=e||this.latestPointerEvent,u=r||this.latestPanInfo,m=this.isDragging;if(this.cancel(),!m||!u||!l)return;const{velocity:v}=u;this.startAnimation(v);const{onDragEnd:b}=this.getProps();b&&ei.postRender(()=>b(l,u))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:l}=this.getProps();!l&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,r,l){const{drag:u}=this.getProps();if(!l||!xx(e,u,this.currentDirection))return;const m=this.getAxisMotionValue(e);let v=this.originPoint[e]+l[e];this.constraints&&this.constraints[e]&&(v=LH(v,this.constraints[e],this.elastic[e])),m.set(v)}resolveConstraints(){const{dragConstraints:e,dragElastic:r}=this.getProps(),l=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,u=this.constraints;e&&cy(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&l?this.constraints=jH(l.layoutBox,e):this.constraints=!1,this.elastic=FH(r),u!==this.constraints&&l&&this.constraints&&!this.hasMutatedConstraints&&Ja(m=>{this.constraints!==!1&&this.getAxisMotionValue(m)&&(this.constraints[m]=BH(l.layoutBox[m],this.constraints[m]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!cy(e))return!1;const l=e.current,{projection:u}=this.visualElement;if(!u||!u.layout)return!1;const m=W9(l,u.root,this.visualElement.getTransformPagePoint());let v=OH(u.layout.layoutBox,m);if(r){const b=r($9(v));this.hasMutatedConstraints=!!b,b&&(v=RR(b))}return v}startAnimation(e){const{drag:r,dragMomentum:l,dragElastic:u,dragTransition:m,dragSnapToOrigin:v,onDragTransitionEnd:b}=this.getProps(),a=this.constraints||{},k=Ja(M=>{if(!xx(M,r,this.currentDirection))return;let L=a&&a[M]||{};v&&(L={min:0,max:0});const z=u?200:1e6,O=u?40:1e7,K={type:"inertia",velocity:l?e[M]:0,bounceStiffness:z,bounceDamping:O,timeConstant:750,restDelta:1,restSpeed:10,...m,...L};return this.startAxisValueAnimation(M,K)});return Promise.all(k).then(b)}startAxisValueAnimation(e,r){const l=this.getAxisMotionValue(e);return Kw(this.visualElement,e),l.start(MT(e,l,0,r,this.visualElement,!1))}stopAnimation(){Ja(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ja(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,l=this.visualElement.getProps(),u=l[r];return u||this.visualElement.getValue(e,(l.initial?l.initial[e]:void 0)||0)}snapToCursor(e){Ja(r=>{const{drag:l}=this.getProps();if(!xx(r,l,this.currentDirection))return;const{projection:u}=this.visualElement,m=this.getAxisMotionValue(r);if(u&&u.layout){const{min:v,max:b}=u.layout.layoutBox[r],a=m.get()||0;m.set(e[r]-yi(v,b,.5)+a)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:l}=this.visualElement;if(!cy(r)||!l||!this.constraints)return;this.stopAnimation();const u={x:0,y:0};Ja(v=>{const b=this.getAxisMotionValue(v);if(b&&this.constraints!==!1){const a=b.get();u[v]=zH({min:a,max:a},this.constraints[v])}});const{transformTemplate:m}=this.visualElement.getProps();this.visualElement.current.style.transform=m?m({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),Ja(v=>{if(!xx(v,e,null))return;const b=this.getAxisMotionValue(v),{min:a,max:k}=this.constraints[v];b.set(yi(a,k,u[v]))})}addListeners(){if(!this.visualElement.current)return;VH.set(this.visualElement,this);const e=this.visualElement.current,r=Ey(e,"pointerdown",a=>{const{drag:k,dragListener:M=!0}=this.getProps(),L=a.target,z=L!==e&&kR(L);k&&M&&!z&&this.start(a)}),l=()=>{const{dragConstraints:a}=this.getProps();cy(a)&&a.current&&(this.constraints=this.resolveRefConstraints())},{projection:u}=this.visualElement,m=u.addEventListener("measure",l);u&&!u.layout&&(u.root&&u.root.updateScroll(),u.updateLayout()),ei.read(l);const v=$y(window,"resize",()=>this.scalePositionWithinConstraints()),b=u.addEventListener("didUpdate",(({delta:a,hasLayoutChanged:k})=>{this.isDragging&&k&&(Ja(M=>{const L=this.getAxisMotionValue(M);L&&(this.originPoint[M]+=a[M].translate,L.set(L.get()+a[M].translate))}),this.visualElement.render())}));return()=>{v(),r(),m(),b&&b()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:l=!1,dragPropagation:u=!1,dragConstraints:m=!1,dragElastic:v=ib,dragMomentum:b=!0}=e;return{...e,drag:r,dragDirectionLock:l,dragPropagation:u,dragConstraints:m,dragElastic:v,dragMomentum:b}}}function xx(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function $H(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class GH extends Eh{constructor(e){super(e),this.removeGroupControls=rl,this.removeListeners=rl,this.controls=new UH(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||rl}update(){const{dragControls:e}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};e!==r&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const VA=t=>(e,r)=>{t&&ei.postRender(()=>t(e,r))};class HH extends Eh{constructor(){super(...arguments),this.removePointerDownListener=rl}onPointerDown(e){this.session=new d3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:u3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:l,onPanEnd:u}=this.node.getProps();return{onSessionStart:VA(e),onStart:VA(r),onMove:l,onEnd:(m,v)=>{delete this.session,u&&ei.postRender(()=>u(m,v))}}}mount(){this.removePointerDownListener=Ey(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let $1=!1;class WH extends P.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:l,layoutId:u}=this.props,{projection:m}=e;m&&(r.group&&r.group.add(m),l&&l.register&&u&&l.register(m),$1&&m.root.didUpdate(),m.addEventListener("animationComplete",()=>{this.safeToRemove()}),m.setOptions({...m.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Bx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:l,drag:u,isPresent:m}=this.props,{projection:v}=l;return v&&(v.isPresent=m,e.layoutDependency!==r&&v.setOptions({...v.options,layoutDependency:r}),$1=!0,u||e.layoutDependency!==r||r===void 0||e.isPresent!==m?v.willUpdate():this.safeToRemove(),e.isPresent!==m&&(m?v.promote():v.relegate()||ei.postRender(()=>{const b=v.getStack();(!b||!b.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),DT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:l}=this.props,{projection:u}=e;$1=!0,u&&(u.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(u),l&&l.deregister&&l.deregister(u))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function f3(t){const[e,r]=t3(),l=P.useContext(dT);return _.jsx(WH,{...t,layoutGroup:l,switchLayoutGroup:P.useContext(l3),isPresent:e,safeToRemove:r})}const qH={pan:{Feature:HH},drag:{Feature:GH,ProjectionNode:e3,MeasureLayout:f3}};function UA(t,e,r){const{props:l}=t;t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",r==="Start");const u="onHover"+r,m=l[u];m&&ei.postRender(()=>m(e,f_(e)))}class ZH extends Eh{mount(){const{current:e}=this.node;e&&(this.unmount=I9(e,(r,l)=>(UA(this.node,l,"Start"),u=>UA(this.node,u,"End"))))}unmount(){}}class XH extends Eh{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=u_($y(this.node.current,"focus",()=>this.onFocus()),$y(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function $A(t,e,r){const{props:l}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&l.whileTap&&t.animationState.setActive("whileTap",r==="Start");const u="onTap"+(r==="End"?"":r),m=l[u];m&&ei.postRender(()=>m(e,f_(e)))}class KH extends Eh{mount(){const{current:e}=this.node;e&&(this.unmount=N9(e,(r,l)=>($A(this.node,l,"Start"),(u,{success:m})=>$A(this.node,u,m?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const sb=new WeakMap,G1=new WeakMap,YH=t=>{const e=sb.get(t.target);e&&e(t)},JH=t=>{t.forEach(YH)};function QH({root:t,...e}){const r=t||document;G1.has(r)||G1.set(r,{});const l=G1.get(r),u=JSON.stringify(e);return l[u]||(l[u]=new IntersectionObserver(JH,{root:t,...e})),l[u]}function eW(t,e,r){const l=QH(e);return sb.set(t,r),l.observe(t),()=>{sb.delete(t),l.unobserve(t)}}const tW={some:0,all:1};class nW extends Eh{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:l,amount:u="some",once:m}=e,v={root:r?r.current:void 0,rootMargin:l,threshold:typeof u=="number"?u:tW[u]},b=a=>{const{isIntersecting:k}=a;if(this.isInView===k||(this.isInView=k,m&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:M,onViewportLeave:L}=this.node.getProps(),z=k?M:L;z&&z(a)};return eW(this.node.current,v,b)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(rW(e,r))&&this.startObserver()}unmount(){}}function rW({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const iW={inView:{Feature:nW},tap:{Feature:KH},focus:{Feature:XH},hover:{Feature:ZH}},sW={layout:{ProjectionNode:e3,MeasureLayout:f3}},oW={...MH,...iW,...qH,...sW},yr=EH(oW,CH);function p3(t){const e=ap(()=>Qf(t)),{isStatic:r}=P.useContext(Kv);if(r){const[,l]=P.useState(t);P.useEffect(()=>e.on("change",l),[])}return e}function m3(t,e){const r=p3(e()),l=()=>r.set(e());return l(),hT(()=>{const u=()=>ei.preRender(l,!1,!0),m=t.map(v=>v.on("change",u));return()=>{m.forEach(v=>v()),Ju(l)}}),r}function aW(t){Ty.current=[],t();const e=m3(Ty.current,t);return Ty.current=void 0,e}function lW(t,e,r,l){if(typeof t=="function")return aW(t);const m=typeof e=="function"?e:D9(e,r,l);return Array.isArray(t)?GA(t,m):GA([t],([v])=>m(v))}function GA(t,e){const r=ap(()=>[]);return m3(t,()=>{r.length=0;const l=t.length;for(let u=0;u<l;u++)r[u]=t[u].get();return e(r)})}const g3=P.createContext(null);function cW(t,e,r,l){if(!l)return t;const u=t.findIndex(M=>M.value===e);if(u===-1)return t;const m=l>0?1:-1,v=t[u+m];if(!v)return t;const b=t[u],a=v.layout,k=yi(a.min,a.max,.5);return m===1&&b.layout.max+r>k||m===-1&&b.layout.min+r<k?E$(t,u,u+m):t}function uW({children:t,as:e="ul",axis:r="y",onReorder:l,values:u,...m},v){const b=ap(()=>yr[e]),a=[],k=P.useRef(!1),M=P.useRef(null),L={axis:r,groupRef:M,registerItem:(K,H)=>{const Z=a.findIndex(Y=>K===Y.value);Z!==-1?a[Z].layout=H[r]:a.push({value:K,layout:H[r]}),a.sort(fW)},updateOrder:(K,H,Z)=>{if(k.current)return;const Y=cW(a,K,H,Z);a!==Y&&(k.current=!0,l(Y.map(hW).filter(ee=>u.indexOf(ee)!==-1)))}};P.useEffect(()=>{k.current=!1});const z=K=>{M.current=K,typeof v=="function"?v(K):v&&(v.current=K)},O={overflowAnchor:"none",...m.style};return _.jsx(b,{...m,style:O,ref:z,ignoreStrict:!0,children:_.jsx(g3.Provider,{value:L,children:t})})}const dW=P.forwardRef(uW);function hW(t){return t.value}function fW(t,e){return t.layout.min-e.layout.min}const vx=50,HA=25,pW=new Set(["auto","scroll"]),Cy=new WeakMap,ky=new WeakMap;let uy=null;function mW(){if(uy){const t=ob(uy,"y");t&&(ky.delete(t),Cy.delete(t));const e=ob(uy,"x");e&&e!==t&&(ky.delete(e),Cy.delete(e)),uy=null}}function gW(t,e){const r=getComputedStyle(t),l=e==="x"?r.overflowX:r.overflowY;return pW.has(l)}function ob(t,e){let r=t?.parentElement;for(;r;){if(gW(r,e))return r;r=r.parentElement}return null}function yW(t,e,r){const l=e.getBoundingClientRect(),u=r==="x"?l.left:l.top,m=r==="x"?l.right:l.bottom,v=t-u,b=m-t;if(v<vx){const a=1-v/vx;return{amount:-HA*a*a,edge:"start"}}else if(b<vx){const a=1-b/vx;return{amount:HA*a*a,edge:"end"}}return{amount:0,edge:null}}function _W(t,e,r,l){if(!t)return;uy=t;const u=ob(t,r);if(!u)return;const m=e-(r==="x"?window.scrollX:window.scrollY),{amount:v,edge:b}=yW(m,u,r);if(b===null){ky.delete(u),Cy.delete(u);return}if(ky.get(u)!==b){if(!(b==="start"&&l<0||b==="end"&&l>0))return;ky.set(u,b);const M=r==="x"?u.scrollWidth-u.clientWidth:u.scrollHeight-u.clientHeight;Cy.set(u,M)}if(v>0){const k=Cy.get(u);if((r==="x"?u.scrollLeft:u.scrollTop)>=k)return}r==="x"?u.scrollLeft+=v:u.scrollTop+=v}function WA(t,e=0){return Xs(t)?t:p3(e)}function xW({children:t,style:e={},value:r,as:l="li",onDrag:u,onDragEnd:m,layout:v=!0,...b},a){const k=ap(()=>yr[l]),M=P.useContext(g3),L={x:WA(e.x),y:WA(e.y)},z=lW([L.x,L.y],([Y,ee])=>Y||ee?1:"unset"),{axis:O,registerItem:K,updateOrder:H,groupRef:Z}=M;return _.jsx(k,{drag:O,...b,dragSnapToOrigin:!0,style:{...e,x:L.x,y:L.y,zIndex:z},layout:v,onDrag:(Y,ee)=>{const{velocity:ie,point:pe}=ee,xe=L[O].get();H(r,xe,ie[O]),_W(Z.current,pe[O],O,ie[O]),u&&u(Y,ee)},onDragEnd:(Y,ee)=>{mW(),m&&m(Y,ee)},onLayoutMeasure:Y=>{K(r,Y)},ref:a,ignoreStrict:!0,children:t})}const vW=P.forwardRef(xW);var wW=Symbol.for("react.lazy"),hv=Ev[" use ".trim().toString()];function bW(t){return typeof t=="object"&&t!==null&&"then"in t}function y3(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===wW&&"_payload"in t&&bW(t._payload)}function UT(t){const e=SW(t),r=P.forwardRef((l,u)=>{let{children:m,...v}=l;y3(m)&&typeof hv=="function"&&(m=hv(m._payload));const b=P.Children.toArray(m),a=b.find(CW);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}var TW=UT("Slot");function SW(t){const e=P.forwardRef((r,l)=>{let{children:u,...m}=r;if(y3(u)&&typeof hv=="function"&&(u=hv(u._payload)),P.isValidElement(u)){const v=AW(u),b=kW(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var EW=Symbol("radix.slottable");function CW(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===EW}function kW(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function AW(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}const IW=Qy("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),pn=P.forwardRef(({className:t,variant:e,size:r,asChild:l=!1,...u},m)=>{const v=l?TW:"button";return _.jsx(v,{className:cn(IW({variant:e,size:r,className:t})),ref:m,...u})});pn.displayName="Button";const MW=({size:t=20,className:e=""})=>_.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:_.jsx("path",{d:"M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5"})}),PW=()=>{const t=sp(),e=()=>{const l=document.getElementById("features-section");l&&l.scrollIntoView({behavior:"smooth"})},r=[{icon:_.jsx(Pv,{className:"w-8 h-8 text-blue-500"}),title:"Tm g cng c",desc:"Hiu  nh ca bn: G 'i', 'kht', 'ht tin'... h thng s t ng gi  qun n, cafe, ATM ph hp."},{icon:_.jsx(EM,{className:"w-8 h-8 text-green-500"}),title:"Bn  sinh vin",desc:"D liu c ti u ring cho sinh vin: V tr ging ng, th vin, nh tr, v cc im check-in hot nht."},{icon:_.jsx(qm,{className:"w-8 h-8 text-orange-500"}),title:"Sn Voucher",desc:"Lin kt vi cc ca hng quanh trng  tung ra cc m gim gi c quyn ch dnh cho sinh vin."},{icon:_.jsx(ah,{className:"w-8 h-8 text-yellow-500"}),title:"Review C Tm",desc:"Xem nh gi thc t t cng ng sinh vin trc khi quyt nh 'xung tin' i n hay i chi."}];return _.jsxs("div",{className:"min-h-screen bg-white text-gray-800 font-sans selection:bg-green-100",children:[_.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-md z-50 border-b border-gray-100",children:_.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>t("/"),children:[_.jsx("img",{src:"/logo.png",alt:"ThodiaUni",className:"w-8 h-8 object-contain rounded"}),_.jsx("span",{className:"font-bold text-xl tracking-tight text-green-700",children:"ThodiaUni"})]}),_.jsxs(pn,{variant:"ghost",onClick:()=>t("/"),className:"gap-2 hover:bg-green-50 text-green-700",children:[_.jsx(Iv,{size:18}),"Quay li Bn "]})]})}),_.jsxs("section",{className:"pt-32 pb-20 px-4 text-center relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-green-200/30 rounded-full blur-3xl -z-10"}),_.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-3xl mx-auto",children:[_.jsx("span",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-bold mb-4 inline-block",children:"Dnh ring cho Sinh Vin"}),_.jsxs("h1",{className:"text-5xl md:text-6xl font-black text-gray-900 mb-6 leading-tight",children:["Th a Ca ",_.jsx("span",{className:"text-green-600",children:"Sinh Vin"})]}),_.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:'Bn l tn sinh vin cn b ng? Hay "cu" sinh vin nhng tra no cng hi "Hm nay n g?". ThodiaUni chnh l ngi bn ng hnh gip bn lm ch khu vc quanh trng.'}),_.jsxs("div",{className:"flex justify-center gap-4",children:[_.jsx(pn,{size:"lg",className:"bg-green-600 hover:bg-green-700 text-white h-12 px-8 rounded-full text-lg shadow-lg shadow-green-600/20",onClick:()=>t("/"),children:"Khm ph ngay"}),_.jsx(pn,{variant:"outline",size:"lg",className:"h-12 px-8 rounded-full text-lg border-2 hover:bg-gray-50",onClick:e,children:"Tm hiu thm"})]})]})]}),_.jsx("section",{id:"features-section",className:"py-20 bg-gray-50",children:_.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[_.jsxs("div",{className:"text-center mb-16",children:[_.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Ti sao chn ThodiaUni?"}),_.jsx("p",{className:"text-gray-500",children:"Tt c nhng g bn cn  sng st qua 4 nm i hc."})]}),_.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((l,u)=>_.jsxs(yr.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{delay:u*.1},viewport:{once:!0},className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"mb-4 bg-gray-50 w-14 h-14 rounded-xl flex items-center justify-center",children:l.icon}),_.jsx("h3",{className:"text-xl font-bold mb-2 text-gray-800",children:l.title}),_.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:l.desc})]},u))})]})}),_.jsx("section",{className:"py-20 px-4",children:_.jsxs("div",{className:"max-w-4xl mx-auto bg-green-600 rounded-3xl p-8 md:p-12 text-center text-white relative overflow-hidden",children:[_.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),_.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-1/2 -translate-x-1/2"}),_.jsx($f,{className:"w-12 h-12 mx-auto mb-6 text-green-200 animate-pulse"}),_.jsx("h2",{className:"text-3xl font-bold mb-4",children:"S Mnh Ca Chng Ti"}),_.jsx("p",{className:"text-lg text-green-100 mb-8 leading-relaxed",children:'"Chng ti tin rng i sinh vin l khong thi gian p nht. ThodiaUni c to ra  gip bn bt lo lng v chuyn n , i li,  dnh trn tm tr cho vic hc tp v tri nghim tui tr."'}),_.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-sm font-medium text-green-200",children:[_.jsxs("span",{className:"flex items-center gap-2",children:[_.jsx(Ai,{size:16})," Lng i Hc"]}),_.jsxs("span",{className:"flex items-center gap-2",children:[_.jsx(MO,{size:16})," Kt ni cng ng"]})]})]})}),_.jsxs("footer",{className:"bg-gray-900 text-gray-400 py-12 px-4",children:[_.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx("img",{src:"/logo.png",alt:"ThodiaUni",className:"w-8 h-8 object-contain rounded"}),_.jsx("span",{className:"text-white font-bold text-xl",children:"ThodiaUni"})]}),_.jsxs("div",{className:"text-sm flex flex-col md:flex-row gap-4 md:gap-8 items-center font-medium",children:[_.jsxs("div",{className:"flex items-center gap-2 hover:text-white transition-colors cursor-default",children:[_.jsx(SM,{size:16,className:"text-gray-500"}),_.jsx("span",{children:"contact@thodiauni.com"})]}),_.jsxs("div",{className:"flex items-center gap-2 hover:text-white transition-colors cursor-default",children:[_.jsx(e_,{size:16,className:"text-gray-500"}),_.jsx("span",{children:"086 299 3382"})]})]}),_.jsxs("div",{className:"flex gap-6 items-center",children:[_.jsx("a",{href:"https://facebook.com/thodiauni",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-500 transition-colors flex items-center gap-1 group",title:"Facebook",children:_.jsx(kO,{size:24,className:"group-hover:scale-110 transition-transform"})}),_.jsx("a",{href:"https://tiktok.com/@thodiauni",target:"_blank",rel:"noopener noreferrer",className:"hover:text-pink-500 transition-colors flex items-center gap-1 group",title:"TikTok",children:_.jsx(MW,{size:22,className:"group-hover:scale-110 transition-transform"})})]})]}),_.jsx("div",{className:"max-w-6xl mx-auto mt-8 pt-8 border-t border-gray-800 text-center text-xs text-gray-600",children:" 2026 ThodiaUni Project. Built with passion."})]})]})};function H1({className:t,...e}){return _.jsx("div",{className:cn("animate-pulse rounded-md bg-muted",t),...e})}var NW=P.createContext(void 0);function p_(t){const e=P.useContext(NW);return t||e||"ltr"}function ab(t,[e,r]){return Math.min(r,Math.max(e,t))}function RW(t,e){return P.useReducer((r,l)=>e[r][l]??r,t)}var $T="ScrollArea",[_3]=sl($T),[DW,ol]=_3($T),x3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:l="hover",dir:u,scrollHideDelay:m=600,...v}=t,[b,a]=P.useState(null),[k,M]=P.useState(null),[L,z]=P.useState(null),[O,K]=P.useState(null),[H,Z]=P.useState(null),[Y,ee]=P.useState(0),[ie,pe]=P.useState(0),[xe,Ce]=P.useState(!1),[je,Ue]=P.useState(!1),et=or(e,ot=>a(ot)),Ie=p_(u);return _.jsx(DW,{scope:r,type:l,dir:Ie,scrollHideDelay:m,scrollArea:b,viewport:k,onViewportChange:M,content:L,onContentChange:z,scrollbarX:O,onScrollbarXChange:K,scrollbarXEnabled:xe,onScrollbarXEnabledChange:Ce,scrollbarY:H,onScrollbarYChange:Z,scrollbarYEnabled:je,onScrollbarYEnabledChange:Ue,onCornerWidthChange:ee,onCornerHeightChange:pe,children:_.jsx(Mn.div,{dir:Ie,...v,ref:et,style:{position:"relative","--radix-scroll-area-corner-width":Y+"px","--radix-scroll-area-corner-height":ie+"px",...t.style}})})});x3.displayName=$T;var v3="ScrollAreaViewport",w3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,children:l,nonce:u,...m}=t,v=ol(v3,r),b=P.useRef(null),a=or(e,b,v.onViewportChange);return _.jsxs(_.Fragment,{children:[_.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:u}),_.jsx(Mn.div,{"data-radix-scroll-area-viewport":"",...m,ref:a,style:{overflowX:v.scrollbarXEnabled?"scroll":"hidden",overflowY:v.scrollbarYEnabled?"scroll":"hidden",...t.style},children:_.jsx("div",{ref:v.onContentChange,style:{minWidth:"100%",display:"table"},children:l})})]})});w3.displayName=v3;var Jc="ScrollAreaScrollbar",GT=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),{onScrollbarXEnabledChange:m,onScrollbarYEnabledChange:v}=u,b=t.orientation==="horizontal";return P.useEffect(()=>(b?m(!0):v(!0),()=>{b?m(!1):v(!1)}),[b,m,v]),u.type==="hover"?_.jsx(LW,{...l,ref:e,forceMount:r}):u.type==="scroll"?_.jsx(jW,{...l,ref:e,forceMount:r}):u.type==="auto"?_.jsx(b3,{...l,ref:e,forceMount:r}):u.type==="always"?_.jsx(HT,{...l,ref:e}):null});GT.displayName=Jc;var LW=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),[m,v]=P.useState(!1);return P.useEffect(()=>{const b=u.scrollArea;let a=0;if(b){const k=()=>{window.clearTimeout(a),v(!0)},M=()=>{a=window.setTimeout(()=>v(!1),u.scrollHideDelay)};return b.addEventListener("pointerenter",k),b.addEventListener("pointerleave",M),()=>{window.clearTimeout(a),b.removeEventListener("pointerenter",k),b.removeEventListener("pointerleave",M)}}},[u.scrollArea,u.scrollHideDelay]),_.jsx(zo,{present:r||m,children:_.jsx(b3,{"data-state":m?"visible":"hidden",...l,ref:e})})}),jW=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),m=t.orientation==="horizontal",v=Qv(()=>a("SCROLL_END"),100),[b,a]=RW("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return P.useEffect(()=>{if(b==="idle"){const k=window.setTimeout(()=>a("HIDE"),u.scrollHideDelay);return()=>window.clearTimeout(k)}},[b,u.scrollHideDelay,a]),P.useEffect(()=>{const k=u.viewport,M=m?"scrollLeft":"scrollTop";if(k){let L=k[M];const z=()=>{const O=k[M];L!==O&&(a("SCROLL"),v()),L=O};return k.addEventListener("scroll",z),()=>k.removeEventListener("scroll",z)}},[u.viewport,m,a,v]),_.jsx(zo,{present:r||b!=="hidden",children:_.jsx(HT,{"data-state":b==="hidden"?"hidden":"visible",...l,ref:e,onPointerEnter:Xt(t.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:Xt(t.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),b3=P.forwardRef((t,e)=>{const r=ol(Jc,t.__scopeScrollArea),{forceMount:l,...u}=t,[m,v]=P.useState(!1),b=t.orientation==="horizontal",a=Qv(()=>{if(r.viewport){const k=r.viewport.offsetWidth<r.viewport.scrollWidth,M=r.viewport.offsetHeight<r.viewport.scrollHeight;v(b?k:M)}},10);return Bm(r.viewport,a),Bm(r.content,a),_.jsx(zo,{present:l||m,children:_.jsx(HT,{"data-state":m?"visible":"hidden",...u,ref:e})})}),HT=P.forwardRef((t,e)=>{const{orientation:r="vertical",...l}=t,u=ol(Jc,t.__scopeScrollArea),m=P.useRef(null),v=P.useRef(0),[b,a]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),k=k3(b.viewport,b.content),M={...l,sizes:b,onSizesChange:a,hasThumb:k>0&&k<1,onThumbChange:z=>m.current=z,onThumbPointerUp:()=>v.current=0,onThumbPointerDown:z=>v.current=z};function L(z,O){return UW(z,v.current,b,O)}return r==="horizontal"?_.jsx(OW,{...M,ref:e,onThumbPositionChange:()=>{if(u.viewport&&m.current){const z=u.viewport.scrollLeft,O=qA(z,b,u.dir);m.current.style.transform=`translate3d(${O}px, 0, 0)`}},onWheelScroll:z=>{u.viewport&&(u.viewport.scrollLeft=z)},onDragScroll:z=>{u.viewport&&(u.viewport.scrollLeft=L(z,u.dir))}}):r==="vertical"?_.jsx(zW,{...M,ref:e,onThumbPositionChange:()=>{if(u.viewport&&m.current){const z=u.viewport.scrollTop,O=qA(z,b);m.current.style.transform=`translate3d(0, ${O}px, 0)`}},onWheelScroll:z=>{u.viewport&&(u.viewport.scrollTop=z)},onDragScroll:z=>{u.viewport&&(u.viewport.scrollTop=L(z))}}):null}),OW=P.forwardRef((t,e)=>{const{sizes:r,onSizesChange:l,...u}=t,m=ol(Jc,t.__scopeScrollArea),[v,b]=P.useState(),a=P.useRef(null),k=or(e,a,m.onScrollbarXChange);return P.useEffect(()=>{a.current&&b(getComputedStyle(a.current))},[a]),_.jsx(S3,{"data-orientation":"horizontal",...u,ref:k,sizes:r,style:{bottom:0,left:m.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:m.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Jv(r)+"px",...t.style},onThumbPointerDown:M=>t.onThumbPointerDown(M.x),onDragScroll:M=>t.onDragScroll(M.x),onWheelScroll:(M,L)=>{if(m.viewport){const z=m.viewport.scrollLeft+M.deltaX;t.onWheelScroll(z),I3(z,L)&&M.preventDefault()}},onResize:()=>{a.current&&m.viewport&&v&&l({content:m.viewport.scrollWidth,viewport:m.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:pv(v.paddingLeft),paddingEnd:pv(v.paddingRight)}})}})}),zW=P.forwardRef((t,e)=>{const{sizes:r,onSizesChange:l,...u}=t,m=ol(Jc,t.__scopeScrollArea),[v,b]=P.useState(),a=P.useRef(null),k=or(e,a,m.onScrollbarYChange);return P.useEffect(()=>{a.current&&b(getComputedStyle(a.current))},[a]),_.jsx(S3,{"data-orientation":"vertical",...u,ref:k,sizes:r,style:{top:0,right:m.dir==="ltr"?0:void 0,left:m.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Jv(r)+"px",...t.style},onThumbPointerDown:M=>t.onThumbPointerDown(M.y),onDragScroll:M=>t.onDragScroll(M.y),onWheelScroll:(M,L)=>{if(m.viewport){const z=m.viewport.scrollTop+M.deltaY;t.onWheelScroll(z),I3(z,L)&&M.preventDefault()}},onResize:()=>{a.current&&m.viewport&&v&&l({content:m.viewport.scrollHeight,viewport:m.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:pv(v.paddingTop),paddingEnd:pv(v.paddingBottom)}})}})}),[BW,T3]=_3(Jc),S3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,sizes:l,hasThumb:u,onThumbChange:m,onThumbPointerUp:v,onThumbPointerDown:b,onThumbPositionChange:a,onDragScroll:k,onWheelScroll:M,onResize:L,...z}=t,O=ol(Jc,r),[K,H]=P.useState(null),Z=or(e,et=>H(et)),Y=P.useRef(null),ee=P.useRef(""),ie=O.viewport,pe=l.content-l.viewport,xe=Ui(M),Ce=Ui(a),je=Qv(L,10);function Ue(et){if(Y.current){const Ie=et.clientX-Y.current.left,ot=et.clientY-Y.current.top;k({x:Ie,y:ot})}}return P.useEffect(()=>{const et=Ie=>{const ot=Ie.target;K?.contains(ot)&&xe(Ie,pe)};return document.addEventListener("wheel",et,{passive:!1}),()=>document.removeEventListener("wheel",et,{passive:!1})},[ie,K,pe,xe]),P.useEffect(Ce,[l,Ce]),Bm(K,je),Bm(O.content,je),_.jsx(BW,{scope:r,scrollbar:K,hasThumb:u,onThumbChange:Ui(m),onThumbPointerUp:Ui(v),onThumbPositionChange:Ce,onThumbPointerDown:Ui(b),children:_.jsx(Mn.div,{...z,ref:Z,style:{position:"absolute",...z.style},onPointerDown:Xt(t.onPointerDown,et=>{et.button===0&&(et.target.setPointerCapture(et.pointerId),Y.current=K.getBoundingClientRect(),ee.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",O.viewport&&(O.viewport.style.scrollBehavior="auto"),Ue(et))}),onPointerMove:Xt(t.onPointerMove,Ue),onPointerUp:Xt(t.onPointerUp,et=>{const Ie=et.target;Ie.hasPointerCapture(et.pointerId)&&Ie.releasePointerCapture(et.pointerId),document.body.style.webkitUserSelect=ee.current,O.viewport&&(O.viewport.style.scrollBehavior=""),Y.current=null})})})}),fv="ScrollAreaThumb",E3=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=T3(fv,t.__scopeScrollArea);return _.jsx(zo,{present:r||u.hasThumb,children:_.jsx(FW,{ref:e,...l})})}),FW=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,style:l,...u}=t,m=ol(fv,r),v=T3(fv,r),{onThumbPositionChange:b}=v,a=or(e,L=>v.onThumbChange(L)),k=P.useRef(void 0),M=Qv(()=>{k.current&&(k.current(),k.current=void 0)},100);return P.useEffect(()=>{const L=m.viewport;if(L){const z=()=>{if(M(),!k.current){const O=$W(L,b);k.current=O,b()}};return b(),L.addEventListener("scroll",z),()=>L.removeEventListener("scroll",z)}},[m.viewport,M,b]),_.jsx(Mn.div,{"data-state":v.hasThumb?"visible":"hidden",...u,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...l},onPointerDownCapture:Xt(t.onPointerDownCapture,L=>{const O=L.target.getBoundingClientRect(),K=L.clientX-O.left,H=L.clientY-O.top;v.onThumbPointerDown({x:K,y:H})}),onPointerUp:Xt(t.onPointerUp,v.onThumbPointerUp)})});E3.displayName=fv;var WT="ScrollAreaCorner",C3=P.forwardRef((t,e)=>{const r=ol(WT,t.__scopeScrollArea),l=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&l?_.jsx(VW,{...t,ref:e}):null});C3.displayName=WT;var VW=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,...l}=t,u=ol(WT,r),[m,v]=P.useState(0),[b,a]=P.useState(0),k=!!(m&&b);return Bm(u.scrollbarX,()=>{const M=u.scrollbarX?.offsetHeight||0;u.onCornerHeightChange(M),a(M)}),Bm(u.scrollbarY,()=>{const M=u.scrollbarY?.offsetWidth||0;u.onCornerWidthChange(M),v(M)}),k?_.jsx(Mn.div,{...l,ref:e,style:{width:m,height:b,position:"absolute",right:u.dir==="ltr"?0:void 0,left:u.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function pv(t){return t?parseInt(t,10):0}function k3(t,e){const r=t/e;return isNaN(r)?0:r}function Jv(t){const e=k3(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=(t.scrollbar.size-r)*e;return Math.max(l,18)}function UW(t,e,r,l="ltr"){const u=Jv(r),m=u/2,v=e||m,b=u-v,a=r.scrollbar.paddingStart+v,k=r.scrollbar.size-r.scrollbar.paddingEnd-b,M=r.content-r.viewport,L=l==="ltr"?[0,M]:[M*-1,0];return A3([a,k],L)(t)}function qA(t,e,r="ltr"){const l=Jv(e),u=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,m=e.scrollbar.size-u,v=e.content-e.viewport,b=m-l,a=r==="ltr"?[0,v]:[v*-1,0],k=ab(t,a);return A3([0,v],[0,b])(k)}function A3(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const l=(e[1]-e[0])/(t[1]-t[0]);return e[0]+l*(r-t[0])}}function I3(t,e){return t>0&&t<e}var $W=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},l=0;return(function u(){const m={left:t.scrollLeft,top:t.scrollTop},v=r.left!==m.left,b=r.top!==m.top;(v||b)&&e(),r=m,l=window.requestAnimationFrame(u)})(),()=>window.cancelAnimationFrame(l)};function Qv(t,e){const r=Ui(t),l=P.useRef(0);return P.useEffect(()=>()=>window.clearTimeout(l.current),[]),P.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(r,e)},[r,e])}function Bm(t,e){const r=Ui(e);Wi(()=>{let l=0;if(t){const u=new ResizeObserver(()=>{cancelAnimationFrame(l),l=window.requestAnimationFrame(r)});return u.observe(t),()=>{window.cancelAnimationFrame(l),u.unobserve(t)}}},[t,r])}var M3=x3,GW=w3,HW=C3;const e0=P.forwardRef(({className:t,children:e,...r},l)=>_.jsxs(M3,{ref:l,className:cn("relative overflow-hidden",t),...r,children:[_.jsx(GW,{className:"h-full w-full rounded-[inherit]",children:e}),_.jsx(P3,{}),_.jsx(HW,{})]}));e0.displayName=M3.displayName;const P3=P.forwardRef(({className:t,orientation:e="vertical",...r},l)=>_.jsx(GT,{ref:l,orientation:e,className:cn("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:_.jsx(E3,{className:"relative flex-1 rounded-full bg-border"})}));P3.displayName=GT.displayName;const WW="https://thodia-backend-1067502227654.asia-southeast1.run.app",qW=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},ZW=`
  @keyframes scroll-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  .animate-scroll {
    display: flex;
    white-space: nowrap;
    animation: scroll-left 10s linear infinite;
  }
  .group:hover .animate-scroll {
    animation-play-state: paused;
  }
  .mask-gradient {
    mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
    -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
  }
`,XW=({text:t,className:e})=>t.length>28?_.jsx("div",{className:"overflow-hidden w-full mask-gradient",children:_.jsxs("div",{className:`animate-scroll w-fit ${e}`,children:[_.jsx("span",{className:"mr-8",children:t}),_.jsx("span",{className:"mr-8",children:t})]})}):_.jsx("h4",{className:`truncate ${e}`,children:t}),ZA=[{id:"food",icon:_.jsx(t_,{className:"w-3.5 h-3.5"}),label:"n ung"},{id:"cafe",icon:_.jsx(Ab,{className:"w-3.5 h-3.5"}),label:"Caf"},{id:"entertainment",icon:_.jsx(Ib,{className:"w-3.5 h-3.5"}),label:"Vui chi"},{id:"lecture_hall",icon:_.jsx(Mb,{className:"w-3.5 h-3.5"}),label:"Ging ng"},{id:"office",icon:_.jsx(kb,{className:"w-3.5 h-3.5"}),label:"Vn phng"},{id:"housing",icon:_.jsx(Pb,{className:"w-3.5 h-3.5"}),label:"Nh tr"},{id:"job",icon:_.jsx(oh,{className:"w-3.5 h-3.5"}),label:"Vic lm"},{id:"building",icon:_.jsx(Rm,{className:"w-3.5 h-3.5"}),label:"Ta nh"},{id:"checkin",icon:_.jsx(AM,{className:"w-3.5 h-3.5"}),label:"Check-in"}],KW=({onSelectLocation:t,userLocation:e})=>{const{language:r}=ia(),[l,u]=P.useState(!1),[m,v]=P.useState("food"),[b,a]=P.useState({}),[k,M]=P.useState(!0);P.useEffect(()=>{(async()=>{M(!0);try{const H=await(await fetch(`${WW}/api/stores/approved`)).json();if(!Array.isArray(H)){console.error("D liu tr v khng phi mng:",H),M(!1);return}let Z=H.map(ee=>{let ie=0;return e&&(ie=qW(e.lat,e.lng,ee.lat,ee.lng)),{...ee,distance:ie}});Z.sort((ee,ie)=>ee.is_premium&&!ie.is_premium?-1:!ee.is_premium&&ie.is_premium?1:(ee.distance||0)-(ie.distance||0));const Y={};ZA.forEach(ee=>Y[ee.id]=[]),Z.forEach(ee=>{Y[ee.category]&&Y[ee.category].length<10&&Y[ee.category].push(ee)}),a(Y)}catch(K){console.error("Li ti danh sch ca hng:",K)}finally{M(!1)}})()},[e]);const L=O=>{const K={...O,id:O.id,name:r==="en"&&O.name_en?O.name_en:O.name_vi,nameVi:O.name_vi,address:r==="en"&&O.address_en?O.address_en:O.address_vi,category:O.category,lat:O.lat,lng:O.lng,image:O.image_url,isUserStore:!0};t(K)},z=b[m]||[];return _.jsxs("div",{className:"absolute top-[112px] left-3 z-[30] flex flex-col items-start gap-2",children:[_.jsx("style",{children:ZW}),_.jsxs("button",{onClick:()=>u(!l),className:"bg-white/95 backdrop-blur-md shadow-lg border rounded-full px-3 py-2 text-xs font-bold flex items-center gap-2 hover:bg-white transition-all text-primary group active:scale-95",children:[_.jsx("div",{className:"bg-primary/10 p-1 rounded-full group-hover:bg-primary/20 transition-colors",children:_.jsx(Vc,{className:"w-3.5 h-3.5 text-primary"})}),r==="vi"?"Gi  gn y":"Nearby Suggestions",l?_.jsx(Dm,{className:"w-3 h-3 text-gray-400"}):_.jsx(qf,{className:"w-3 h-3 text-gray-400"})]}),_.jsx(Sa,{children:l&&_.jsxs(yr.div,{initial:{opacity:0,scale:.95,y:-10,height:0},animate:{opacity:1,scale:1,y:0,height:"auto"},exit:{opacity:0,scale:.95,y:-10,height:0},className:"w-[300px] md:w-[320px] max-h-[60vh] bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 overflow-hidden flex flex-col origin-top-left",children:[_.jsx("div",{className:"border-b bg-gray-50/80",children:_.jsxs("div",{className:"flex overflow-x-auto p-2 gap-1.5",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[_.jsx("style",{children:".flex::-webkit-scrollbar { display: none; }"}),ZA.map(O=>{const K=m===O.id;return _.jsxs("button",{onClick:()=>v(O.id),className:cn("flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all whitespace-nowrap",K?"bg-white text-primary shadow-sm border ring-1 ring-gray-100":"text-gray-500 hover:bg-gray-200/50 hover:text-gray-700 bg-transparent"),children:[O.icon,O.label]},O.id)})]})}),_.jsx(e0,{className:"flex-1 w-full bg-white/50",children:_.jsxs("div",{className:"p-2 space-y-2",children:[k?[1,2,3].map(O=>_.jsxs("div",{className:"flex gap-3 items-center p-2",children:[_.jsx(H1,{className:"w-12 h-12 rounded-lg flex-shrink-0"}),_.jsxs("div",{className:"space-y-2 flex-1",children:[_.jsx(H1,{className:"h-3 w-3/4"}),_.jsx(H1,{className:"h-2 w-1/2"})]})]},O)):z.length===0?_.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-gray-400 gap-2",children:[_.jsx(Vc,{className:"w-10 h-10 opacity-20"}),_.jsx("span",{className:"text-xs",children:"Khng tm thy a im no"})]}):z.map(O=>{const K=r==="en"&&O.name_en?O.name_en:O.name_vi,H=r==="en"&&O.address_en?O.address_en:O.address_vi,Z=O.is_premium,Y=O.distance?O.distance<1?`${(O.distance*1e3).toFixed(0)}m`:`${O.distance.toFixed(1)}km`:"";return _.jsxs(yr.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>L(O),className:cn("flex gap-3 p-2 rounded-lg transition-all cursor-pointer border group relative overflow-hidden",Z?"bg-gradient-to-r from-yellow-50 to-white border-yellow-200/60 hover:border-yellow-300":"bg-white/60 border-transparent hover:bg-white hover:shadow-sm hover:border-gray-100"),children:[_.jsxs("div",{className:"w-14 h-14 flex-shrink-0 relative",children:[_.jsx("img",{src:O.image_url||"https://placehold.co/100x100?text=Store",className:"w-full h-full object-cover rounded-md bg-gray-100 border border-gray-100",loading:"lazy",onError:ee=>ee.currentTarget.src="https://placehold.co/100x100?text=Store"}),Z&&_.jsx("div",{className:"absolute -top-1.5 -left-1.5 z-10",children:_.jsxs("span",{className:"relative flex h-3 w-3",children:[_.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),_.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-yellow-500 border border-white"})]})})]}),_.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center gap-0.5",children:[_.jsxs("div",{className:"flex justify-between items-start gap-1",children:[_.jsx("div",{className:"flex-1 min-w-0",children:_.jsx(XW,{text:K,className:cn("text-xs font-bold transition-colors",Z?"text-yellow-800":"text-gray-800 group-hover:text-primary")})}),Y&&_.jsx("span",{className:"text-[9px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded-full whitespace-nowrap border border-blue-100",children:Y})]}),_.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[_.jsx(Ai,{className:"w-2.5 h-2.5 flex-shrink-0 text-gray-400"}),_.jsx("p",{className:"text-[10px] truncate w-full",children:H})]}),Z&&_.jsx("div",{className:"flex gap-1 mt-1",children:_.jsxs("span",{className:"text-[8px] text-yellow-700 font-bold bg-gradient-to-r from-yellow-100 to-transparent pl-1 pr-2 rounded-sm flex items-center gap-1",children:[_.jsx(nl,{className:"w-2 h-2 fill-yellow-700"}),"VIP Partner"]})})]})]},O.id)}),_.jsx("div",{className:"h-2"})]})})]})})]})};var Fx={exports:{}},YW=Fx.exports,XA;function JW(){return XA||(XA=1,(function(t,e){var r={};(function(l,u){t.exports=u()})(YW,(function(){var l,u,m;function v(a,k){if(!l)l=k;else if(!u)u=k;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",L={};l(L),m=k(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}v(["exports"],(function(a){var k=typeof self<"u"?self:{},M="2.15.0";let L;const z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(L==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{L=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):i}catch{L=i}}return L},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!z.API_URL)return null;try{const i=new URL(z.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},O={supported:!1,testSupport:function(i){!Z&&H&&(Y?ee(i):K=i)}};let K,H,Z=!1,Y=!1;function ee(i){const n=i.createTexture();i.bindTexture(i.TEXTURE_2D,n);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,H),i.isContextLost())return;O.supported=!0}catch{}i.deleteTexture(n),Z=!0}k.document&&(H=k.document.createElement("img"),H.onload=function(){K&&ee(K),K=null,Y=!0},H.onerror=function(){Z=!0,K=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ie="01";function pe(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var xe=Ce;function Ce(i,n,s,c){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(c-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=c}Ce.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,c=0;c<8;c++){var f=this.sampleCurveX(s)-i;if(Math.abs(f)<n)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var w=0,E=1;for(s=i,c=0;c<20&&(f=this.sampleCurveX(s),!(Math.abs(f-i)<n));c++)i>f?w=s:E=s,s=.5*(E-w)+w;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var je=pe(xe),Ue=et;function et(i,n){this.x=i,this.y=n}et.prototype={clone:function(){return new et(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,s=i.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),s=Math.sin(i),c=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=c,this},_rotateAround:function(i,n){var s=Math.cos(i),c=Math.sin(i),f=n.y+c*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-c*(this.y-n.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},et.convert=function(i){return i instanceof et?i:Array.isArray(i)?new et(i[0],i[1]):i};var Ie=pe(Ue);const ot=Math.PI/180,ut=180/Math.PI;function gt(i){return i*ot}function ft(i){return i*ut}const vt=[[0,0],[1,0],[1,1],[0,1]];function st(i){if(i<=0)return 0;if(i>=1)return 1;const n=i*i,s=n*i;return 4*(i<.5?s:3*(i-n)+s-.75)}function nt(i,n,s,c){const f=new je(i,n,s,c);return function(y){return f.solve(y)}}const ze=nt(.25,.1,.25,1);function Se(i,n,s){return Math.min(s,Math.max(n,i))}function We(i,n,s){return(s=Se((s-i)/(n-i),0,1))*s*(3-2*s)}function fe(i,n,s){const c=s-n,f=((i-n)%c+c)%c+n;return f===n?s:f}function Fe(i,n,s){if(!i.length)return s(null,[]);let c=i.length;const f=new Array(i.length);let y=null;i.forEach(((w,E)=>{n(w,((A,I)=>{A&&(y=A),f[E]=I,--c==0&&s(y,f)}))}))}function lt(i){const n=[];for(const s in i)n.push(i[s]);return n}function Tt(i,...n){for(const s of n)for(const c in s)i[c]=s[c];return i}let Kt=1;function sn(){return Kt++}function xt(){return(function i(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)})()}function Zt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function vn(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function on(i,n){i.forEach((s=>{n[s]&&(n[s]=n[s].bind(n))}))}function Sn(i,n){return i.indexOf(n,i.length-n.length)!==-1}function Yt(i,n,s){const c={};for(const f in i)c[f]=n.call(this,i[f],f,i);return c}function nr(i,n,s){const c={};for(const f in i)n.call(s||this,i[f],f,i)&&(c[f]=i[f]);return c}function Xn(i){return Array.isArray(i)?i.map(Xn):typeof i=="object"&&i?Yt(i,Xn):i}const _i={};function Kn(i){_i[i]||(typeof console<"u"&&console.warn(i),_i[i]=!0)}function Er(i,n,s){return(s.y-i.y)*(n.x-i.x)>(n.y-i.y)*(s.x-i.x)}function Ks(i){let n=0;for(let s,c,f=0,y=i.length,w=y-1;f<y;w=f++)s=i[f],c=i[w],n+=(c.x-s.x)*(s.y+c.y);return n}function xi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Zr(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,c,f,y)=>{const w=f||y;return n[c]=!w||w.toLowerCase(),""})),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let ti=null;function is(i){if(ti==null){const n=i.navigator?i.navigator.userAgent:null;ti=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return ti}function qi(i){try{const n=k[i];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ns(i,n){return[i[4*n],i[4*n+1],i[4*n+2],i[4*n+3]]}const xs="mapbox-tiles";let Vr=500,ss=50,vi,Rs;function Zi(){try{return k.caches}catch{}}function Ii(){Zi()&&!vi&&(vi=k.caches.open(xs))}function xo(i){const n=i.indexOf("?");if(n<0)return i;const s=(function(f){const y=f.indexOf("?");return y>0?f.slice(y+1).split("&"):[]})(i),c=s.filter((f=>{const y=f.split("=");return y[0]==="language"||y[0]==="worldview"}));return c.length?`${i.slice(0,n)}?${c.join("&")}`:i.slice(0,n)}let Ys=1/0;const Mi={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Mi);class os extends Error{constructor(n,s,c){s===401&&Oe(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ni=xi()?()=>self.worker&&self.worker.referrer:()=>(k.location.protocol==="blob:"?k.parent:k).location.href,Ds=function(i,n){if(!(/^file:/.test(s=i.url)||/^file:/.test(ni())&&!/^\w+:/.test(s))){if(k.fetch&&k.Request&&k.AbortController&&k.Request.prototype.hasOwnProperty("signal"))return(function(c,f){const y=new k.AbortController,w=new k.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:ni(),referrerPolicy:c.referrerPolicy,signal:y.signal});let E=!1,A=!1;const I=(j=w.url).indexOf("sku=")>0&&Oe(j);var j;c.type==="json"&&w.headers.set("Accept","application/json");const V=(q,X,te)=>{if(A)return;if(q&&q.message!=="SecurityError"&&Kn(q.toString()),X&&te)return U(X);const ae=Date.now();k.fetch(w).then((ge=>{if(ge.ok){const ke=I?ge.clone():null;return U(ge,ke,ae)}return f(new os(ge.statusText,ge.status,c.url))})).catch((ge=>{ge.name!=="AbortError"&&f(new Error(`${ge.message} ${c.url}`))}))},U=(q,X,te)=>{(c.type==="arrayBuffer"?q.arrayBuffer():c.type==="json"?q.json():q.text()).then((ae=>{A||(X&&te&&(function(ge,ke,ye){if(Ii(),!vi)return;const Ee={status:ke.status,statusText:ke.statusText,headers:new k.Headers};ke.headers.forEach(((Qe,Xe)=>Ee.headers.set(Xe,Qe)));const Pe=Zr(ke.headers.get("Cache-Control")||"");if(Pe["no-store"])return;Pe["max-age"]&&Ee.headers.set("Expires",new Date(ye+1e3*Pe["max-age"]).toUTCString());const Me=Ee.headers.get("Expires");Me&&(new Date(Me).getTime()-ye<42e4||(function(Qe,Xe){if(Rs===void 0)try{new Response(new ReadableStream),Rs=!0}catch{Rs=!1}Rs?Xe(Qe.body):Qe.blob().then(Xe)})(ke,(Qe=>{const Xe=new k.Response(Qe,Ee);Ii(),vi&&vi.then((mt=>mt.put(xo(ge.url),Xe))).catch((mt=>Kn(mt.message)))})))})(w,X,te),E=!0,f(null,ae,q.headers.get("Cache-Control"),q.headers.get("Expires")))})).catch((ae=>{A||f(new Error(ae.message))}))};return I?(function(q,X){if(Ii(),!vi)return X(null);const te=xo(q.url);vi.then((ae=>{ae.match(te).then((ge=>{const ke=(function(ye){if(!ye)return!1;const Ee=new Date(ye.headers.get("Expires")||0),Pe=Zr(ye.headers.get("Cache-Control")||"");return Ee>Date.now()&&!Pe["no-cache"]})(ge);ae.delete(te),ke&&ae.put(te,ge.clone()),X(null,ge,ke)})).catch(X)})).catch(X)})(w,V):V(null,null),{cancel:()=>{A=!0,E||y.abort()}}})(i,n);if(xi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,n,void 0,!0)}var s;return(function(c,f){const y=new k.XMLHttpRequest;y.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const w in c.headers)y.setRequestHeader(w,c.headers[w]);return c.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=c.credentials==="include",y.onerror=()=>{f(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let w=y.response;if(c.type==="json")try{w=JSON.parse(y.response)}catch(E){return f(E)}f(null,w,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else f(new os(y.statusText,y.status,c.url))},y.send(c.body),{cancel:()=>y.abort()}})(i,n)},Js=function(i,n){return Ds(Tt(i,{type:"arrayBuffer"}),n)};function vo(i){const n=k.document.createElement("a");return n.href=i,n.protocol===k.document.location.protocol&&n.host===k.document.location.host}const be="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ne,re;ne=[],re=0;const ue=function(i,n){if(O.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),re>=z.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:i,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return ne.push(y),y}re++;let s=!1;const c=()=>{if(!s)for(s=!0,re--;ne.length&&re<z.MAX_PARALLEL_IMAGE_REQUESTS;){const y=ne.shift(),{requestParameters:w,callback:E,cancelled:A}=y;A||(y.cancel=ue(w,E).cancel)}},f=Js(i,((y,w,E,A)=>{c(),y?n(y):w&&(k.createImageBitmap?(function(I,j){const V=new k.Blob([new Uint8Array(I)],{type:"image/png"});k.createImageBitmap(V).then((U=>{j(null,U)})).catch((U=>{j(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(w,((I,j)=>n(I,j,E,A))):(function(I,j){const V=new k.Image,U=k.URL;V.onload=()=>{j(null,V),U.revokeObjectURL(V.src),V.onload=null,k.requestAnimationFrame((()=>{V.src=be}))},V.onerror=()=>j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new k.Blob([new Uint8Array(I)],{type:"image/png"});V.src=I.byteLength?U.createObjectURL(q):be})(w,((I,j)=>n(I,j,E,A))))}));return{cancel:()=>{f.cancel(),c()}}},Te="NO_ACCESS_TOKEN";function we(i){return i.indexOf("mapbox:")===0}function Oe(i){return z.API_URL_REGEX.test(i)}function Be(i){return z.API_CDN_URL_REGEX.test(i)}function Le(i){return z.API_STYLE_REGEX.test(i)&&!Ze(i)}function Ze(i){return z.API_SPRITE_REGEX.test(i)}const Et=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rt(i){const n=i.match(Et);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function bt(i){const n=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${n}`}const wn="mapbox.eventData";function An(i){if(!i)return null;const n=i.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(k.atob(n[1]).split("").map((s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch{return null}}class kn{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=An(z.ACCESS_TOKEN);let c="";return c=s&&s.u?k.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,((f,y)=>String.fromCharCode(+("0x"+y))))):z.ACCESS_TOKEN||"",n?`${wn}.${n}:${c}`:`${wn}:${c}`}fetchEventData(){const n=qi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{const f=k.localStorage.getItem(s);f&&(this.eventData=JSON.parse(f));const y=k.localStorage.getItem(c);y&&(this.anonId=y)}catch{Kn("Unable to read from LocalStorage")}}saveEventData(){const n=qi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{k.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&k.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Kn("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,c,f){if(!z.EVENTS_URL)return;const y=Rt(z.EVENTS_URL);y.params.push(`access_token=${f||z.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(n).toISOString()},E=s?Tt(w,s):w,A={url:bt(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=(function(I,j){return Ds(Tt(I,{method:"POST"}),j)})(A,(I=>{this.pendingRequest=null,c(I),this.saveEventData(),this.processRequests(f)}))}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const Pn=new class extends kn{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,n){z.EVENTS_URL&&z.ACCESS_TOKEN&&Array.isArray(i)&&i.some((s=>we(s)||Oe(s)))&&this.queueRequest(Date.now(),n)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=An(z.ACCESS_TOKEN),s=n?n.u:z.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;vn(this.anonId)||(this.anonId=xt(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),w=new Date(f),E=(f-this.eventData.lastSuccess)/864e5;c=c||E>=1||E<-1||y.getDate()!==w.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ie,"enabled.telemetry":!1,userId:this.anonId},(y=>{y||(this.eventData.lastSuccess=f,this.eventData.tokenU=s)}),i):this.processRequests()}},$n=Pn.postTurnstileEvent.bind(Pn),jr=new class extends kn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,n,s,c){this.skuToken=n,this.errorCb=c,z.EVENTS_URL&&(s||z.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(Te)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),vn(this.anonId)||(this.anonId=xt()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ie,skuToken:this.skuToken,userId:this.anonId},(c=>{c?this.errorCb(c):n&&(this.success[n]=!0)}),i))}},ri=jr.postMapLoadEvent.bind(jr),Xi=new class extends kn{constructor(){super("gljs.performance")}postPerformanceEvent(i,n){z.EVENTS_URL&&(i||z.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:s}=this.queue.shift(),c=(function(f){const y=k.performance.getEntriesByType("resource"),w=k.performance.getEntriesByType("mark"),E=(function(U){const q={};if(U){for(const X in U)if(X!=="other")for(const te of U[X]){const ae=`${X}ResolveRangeMin`,ge=`${X}ResolveRangeMax`,ke=`${X}RequestCount`,ye=`${X}RequestCachedCount`;q[ae]=Math.min(q[ae]||1/0,te.startTime),q[ge]=Math.max(q[ge]||-1/0,te.responseEnd);const Ee=Pe=>{q[Pe]===void 0&&(q[Pe]=0),++q[Pe]};te.transferSize!==void 0&&te.transferSize===0&&Ee(ye),Ee(ke)}}return q})((function(U,q){const X={};if(U)for(const te of U){const ae=q(te);X[ae]===void 0&&(X[ae]=[]),X[ae].push(te)}return X})(y,Ah)),A=k.devicePixelRatio,I=k.navigator.connection||k.navigator.mozConnection||k.navigator.webkitConnection,j={counters:[],metadata:[],attributes:[]},V=(U,q,X)=>{X!=null&&U.push({name:q,value:X.toString()})};for(const U in E)V(j.counters,U,E[U]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(V(j.counters,"interactionRangeMin",f.interactionRange[0]),V(j.counters,"interactionRangeMax",f.interactionRange[1])),w)for(const U of Object.keys(ll)){const q=ll[U],X=w.find((te=>te.name===q));X&&V(j.counters,q,X.startTime)}return V(j.counters,"visibilityHidden",f.visibilityHidden),V(j.attributes,"style",(function(U){if(U)for(const q of U){const X=q.name.split("?")[0];if(Le(X)){const te=X.split("/").slice(-2);if(te.length===2)return`mapbox://styles/${te[0]}/${te[1]}`}}})(y)),V(j.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),V(j.attributes,"fogEnabled",f.fogEnabled?"true":"false"),V(j.attributes,"projection",f.projection),V(j.attributes,"zoom",f.zoom),V(j.metadata,"devicePixelRatio",A),V(j.metadata,"connectionEffectiveType",I?I.effectiveType:void 0),V(j.metadata,"navigatorUserAgent",k.navigator.userAgent),V(j.metadata,"screenWidth",k.screen.width),V(j.metadata,"screenHeight",k.screen.height),V(j.metadata,"windowWidth",k.innerWidth),V(j.metadata,"windowHeight",k.innerHeight),V(j.metadata,"mapWidth",f.width/A),V(j.metadata,"mapHeight",f.height/A),V(j.metadata,"webglRenderer",f.renderer),V(j.metadata,"webglVendor",f.vendor),V(j.metadata,"sdkVersion",M),V(j.metadata,"sdkIdentifier","mapbox-gl-js"),j})(s);for(const f of c.metadata);for(const f of c.counters);for(const f of c.attributes);this.postEvent(n,c,(()=>{}),i)}},Nr=Xi.postPerformanceEvent.bind(Xi),wo=new class extends kn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,n,s,c){if(!z.API_URL||!z.SESSION_PATH)return;const f=Rt(z.API_URL+z.SESSION_PATH);f.params.push(`sku=${n||""}`),f.params.push(`access_token=${c||z.ACCESS_TOKEN||""}`);const y={url:bt(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=(function(w,E){return Ds(Tt(w,{method:"GET"}),E)})(y,(w=>{this.pendingRequest=null,s(w),this.saveEventData(),this.processRequests(c)}))}getSessionAPI(i,n,s,c){this.skuToken=n,this.errorCb=c,z.SESSION_PATH&&z.API_URL&&(s||z.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(Te)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,(c=>{c?this.errorCb(c):n&&(this.success[n]=!0)}),i)}},wi=wo.getSessionAPI.bind(wo),as=new Set,ll={create:"create",load:"load",fullLoad:"fullLoad"},dp={mark(i){k.performance.mark(i)},measure(i,n,s){k.performance.measure(i,n,s)}};function Ah(i){const n=i.name.split("?")[0];return Be(n)&&n.includes("mapbox-gl.js")?"javascript":Be(n)&&n.includes("mapbox-gl.css")?"css":(function(s){return z.API_FONTS_REGEX.test(s)})(n)?"fontRange":Ze(n)?"sprite":Le(n)?"style":(function(s){return z.API_TILEJSON_REGEX.test(s)})(n)?"tilejson":"other"}const ir=k.performance;function Ih(i){const n=i?i.url.toString():void 0;return ir.getEntriesByName(n)}let Qc,Ur,nd,Qs;const Fo={now:()=>nd!==void 0?nd:k.performance.now(),setNow(i){nd=i},restoreNow(){nd=void 0},frame(i){const n=k.requestAnimationFrame(i);return{cancel:()=>k.cancelAnimationFrame(n)}},getImageData(i,n=0){const{width:s,height:c}=i;Qs||(Qs=k.document.createElement("canvas"));const f=Qs.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(s>Qs.width||c>Qs.height)&&(Qs.width=s,Qs.height=c),f.clearRect(-n,-n,s+2*n,c+2*n),f.drawImage(i,0,0,s,c),f.getImageData(-n,-n,s+2*n,c+2*n)},resolveURL:i=>(Qc||(Qc=k.document.createElement("a")),Qc.href=i,Qc.href),get devicePixelRatio(){return k.devicePixelRatio},get prefersReducedMotion(){return!!k.matchMedia&&(Ur==null&&(Ur=k.matchMedia("(prefers-reduced-motion: reduce)")),Ur.matches)}};function Zl(i,n,s){s[i]&&s[i].indexOf(n)!==-1||(s[i]=s[i]||[],s[i].push(n))}function Mh(i,n,s){if(s&&s[i]){const c=s[i].indexOf(n);c!==-1&&s[i].splice(c,1)}}class ka{constructor(n,s={}){Tt(this,s),this.type=n}}class eo extends ka{constructor(n,s={}){super("error",Tt({error:n},s))}}class vs{on(n,s){return this._listeners=this._listeners||{},Zl(n,s,this._listeners),this}off(n,s){return Mh(n,s,this._listeners),Mh(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Zl(n,s,this._oneTimeListeners),this):new Promise((c=>this.once(n,c)))}fire(n,s){typeof n=="string"&&(n=new ka(n,s||{}));const c=n.type;if(this.listens(c)){n.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const E of f)E.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const E of y)Mh(c,E,this._oneTimeListeners),E.call(this,n);const w=this._eventedParent;w&&(Tt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(n))}else n instanceof eo&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var pt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function bi(i,...n){for(const s of n)for(const c in s)i[c]=s[c];return i}function ii(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Pi(i){if(Array.isArray(i))return i.map(Pi);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const s in i)n[s]=Pi(i[s]);return n}return ii(i)}class hp extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}var Ls=hp;class Xl{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[c,f]of s)this.bindings[c]=f}concat(n){return new Xl(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}var Kl=Xl;const sa={kind:"null"},Ut={kind:"number"},Hn={kind:"string"},Bn={kind:"boolean"},ws={kind:"color"},js={kind:"object"},Nn={kind:"value"},Os={kind:"collator"},cl={kind:"formatted"},sr={kind:"resolvedImage"};function zs(i,n){return{kind:"array",itemType:i,N:n}}function Cr(i){if(i.kind==="array"){const n=Cr(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const rd=[sa,Ut,Hn,Bn,ws,cl,js,zs(Nn),sr];function Vo(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Vo(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const s of rd)if(!Vo(s,n))return null}}return`Expected ${Cr(i)} but found ${Cr(n)} instead.`}function Yl(i,n){return n.some((s=>s.kind===i.kind))}function Jl(i,n){return n.some((s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i))}var eu,tu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function to(i){return(i=Math.round(i))<0?0:i>255?255:i}function no(i){return to(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function bo(i){return(n=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:n>1?1:n;var n}function Uo(i,n,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?i+(n-i)*s*6:2*s<1?n:3*s<2?i+(n-i)*(2/3-s)*6:i}try{eu={}.parseCSSColor=function(i){var n,s=i.replace(/ /g,"").toLowerCase();if(s in tu)return tu[s].slice();if(s[0]==="#")return s.length===4?(n=parseInt(s.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:s.length===7&&(n=parseInt(s.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var c=s.indexOf("("),f=s.indexOf(")");if(c!==-1&&f+1===s.length){var y=s.substr(0,c),w=s.substr(c+1,f-(c+1)).split(","),E=1;switch(y){case"rgba":if(w.length!==4)return null;E=bo(w.pop());case"rgb":return w.length!==3?null:[no(w[0]),no(w[1]),no(w[2]),E];case"hsla":if(w.length!==4)return null;E=bo(w.pop());case"hsl":if(w.length!==3)return null;var A=(parseFloat(w[0])%360+360)%360/360,I=bo(w[1]),j=bo(w[2]),V=j<=.5?j*(I+1):j+I-j*I,U=2*j-V;return[to(255*Uo(U,V,A+1/3)),to(255*Uo(U,V,A)),to(255*Uo(U,V,A-1/3)),E];default:return null}}return null}}catch{}class Ni{constructor(n,s,c,f=1){this.r=n,this.g=s,this.b=c,this.a=f}static parse(n){if(!n)return;if(n instanceof Ni)return n;if(typeof n!="string")return;const s=eu(n);return s?new Ni(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,c,f]=this.toArray();return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(c)},${f})`}toArray(){const{r:n,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*n/f,255*s/f,255*c/f,f]}toArray01(){const{r:n,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[n/f,s/f,c/f,f]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:c,a:f}=this;return[n,s,c,f]}}Ni.black=new Ni(0,0,0,1),Ni.white=new Ni(1,1,1,1),Ni.transparent=new Ni(0,0,0,0),Ni.red=new Ni(1,0,0,1),Ni.blue=new Ni(0,0,1,1);var _r=Ni;class Ph{constructor(n,s,c){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class id{constructor(n,s,c,f,y){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=c,this.fontStack=f,this.textColor=y}}class Ri{constructor(n){this.sections=n}static fromString(n){return new Ri([new id(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof Ri?n:Ri.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.name]);continue}n.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),n.push(c)}return n}}class ro{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new ro({name:n,available:!1}):null}serialize(){return["image",this.name]}}function Nh(i,n,s,c){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,n,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,n,s,c]:[i,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Aa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof _r||i instanceof Ph||i instanceof Ri||i instanceof ro)return!0;if(Array.isArray(i)){for(const n of i)if(!Aa(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!Aa(i[n]))return!1;return!0}return!1}function Br(i){if(i===null)return sa;if(typeof i=="string")return Hn;if(typeof i=="boolean")return Bn;if(typeof i=="number")return Ut;if(i instanceof _r)return ws;if(i instanceof Ph)return Os;if(i instanceof Ri)return cl;if(i instanceof ro)return sr;if(Array.isArray(i)){const n=i.length;let s;for(const c of i){const f=Br(c);if(s){if(s===f)continue;s=Nn;break}s=f}return zs(s||Nn,n)}return js}function nu(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof _r||i instanceof Ri||i instanceof ro?i.toString():JSON.stringify(i)}class ul{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Aa(n[1]))return s.error("invalid value");const c=n[1];let f=Br(c);const y=s.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new ul(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toArray()):this.value instanceof Ri?this.value.serialize():this.value}}var To=ul,Xr=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Ql={string:Hn,number:Ut,boolean:Bn,object:js};class Rh{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let c,f=1;const y=n[0];if(y==="array"){let E,A;if(n.length>2){const I=n[1];if(typeof I!="string"||!(I in Ql)||I==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=Ql[I],f++}else E=Nn;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);A=n[2],f++}c=zs(E,A)}else c=Ql[y];const w=[];for(;f<n.length;f++){const E=s.parse(n[f],f,Nn);if(!E)return null;w.push(E)}return new Rh(c,w)}evaluate(n){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(n);if(!Vo(this.type,Br(c)))return c;if(s===this.args.length-1)throw new Xr(`Expected value to be of type ${Cr(this.type)}, but found ${Cr(Br(c))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const f=n.N;(typeof f=="number"||this.args.length>1)&&s.push(f)}}return s.concat(this.args.map((c=>c.serialize())))}}var oa=Rh;class $o{constructor(n){this.type=cl,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const f=[];let y=!1;for(let w=1;w<=n.length-1;++w){const E=n[w];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let A=null;if(E["font-scale"]&&(A=s.parse(E["font-scale"],1,Ut),!A))return null;let I=null;if(E["text-font"]&&(I=s.parse(E["text-font"],1,zs(Hn)),!I))return null;let j=null;if(E["text-color"]&&(j=s.parse(E["text-color"],1,ws),!j))return null;const V=f[f.length-1];V.scale=A,V.font=I,V.textColor=j}else{const A=s.parse(n[w],1,Nn);if(!A)return null;const I=A.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:A,scale:null,font:null,textColor:null})}}return new $o(f)}evaluate(n){return new Ri(this.sections.map((s=>{const c=s.content.evaluate(n);return Br(c)===sr?new id("",c,null,null,null):new id(nu(c),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)})))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),n.push(c)}return n}}class dl{constructor(n){this.type=sr,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Hn);return c?new dl(c):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),c=ro.fromString(s);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(s)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Dh={"to-boolean":Bn,"to-color":ws,"to-number":Ut,"to-string":Hn};class sd{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[0];if((c==="to-boolean"||c==="to-string")&&n.length!==2)return s.error("Expected one argument.");const f=Dh[c],y=[];for(let w=1;w<n.length;w++){const E=s.parse(n[w],w,Nn);if(!E)return null;y.push(E)}return new sd(f,y)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,c;for(const f of this.args){if(s=f.evaluate(n),c=null,s instanceof _r)return s;if(typeof s=="string"){const y=n.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Nh(s[0],s[1],s[2],s[3]),!c))return new _r(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Xr(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(n),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new Xr(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Ri.fromString(nu(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?ro.fromString(nu(this.args[0].evaluate(n))):nu(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new $o([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new dl(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild((s=>{n.push(s.serialize())})),n}}var Bs=sd;const io=["Unknown","Point","LineString","Polygon"];var ec=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?io[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*n-i[0])+this.featureDistanceData.bearing[1]*(c*n-i[1])}return 0}parseColor(i){let n=this._parseColorCache[i];return n||(n=this._parseColorCache[i]=_r.parse(i)),n}};class Ia{constructor(n,s,c,f){this.name=n,this.type=s,this._evaluate=c,this.args=f}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((n=>n.serialize())))}static parse(n,s){const c=n[0],f=Ia.definitions[c];if(!f)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,w=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=w.filter((([I])=>!Array.isArray(I)||I.length===n.length-1));let A=null;for(const[I,j]of E){A=new zh(s.registry,s.path,null,s.scope);const V=[];let U=!1;for(let q=1;q<n.length;q++){const X=n[q],te=Array.isArray(I)?I[q-1]:I.type,ae=A.parse(X,1+V.length,te);if(!ae){U=!0;break}V.push(ae)}if(!U)if(Array.isArray(I)&&I.length!==V.length)A.error(`Expected ${I.length} arguments, but found ${V.length} instead.`);else{for(let q=0;q<V.length;q++){const X=Array.isArray(I)?I[q]:I.type,te=V[q];A.concat(q+1).checkSubtype(X,te.type)}if(A.errors.length===0)return new Ia(c,y,j,V)}}if(E.length===1)s.errors.push(...A.errors);else{const I=(E.length?E:w).map((([V])=>{return U=V,Array.isArray(U)?`(${U.map(Cr).join(", ")})`:`(${Cr(U.type)}...)`;var U})).join(" | "),j=[];for(let V=1;V<n.length;V++){const U=s.parse(n[V],1+j.length);if(!U)return null;j.push(Cr(U.type))}s.error(`Expected arguments of type ${I}, but found (${j.join(", ")}) instead.`)}return null}static register(n,s){Ia.definitions=s;for(const c in s)n[c]=Ia}}var so=Ia;class Ma{constructor(n,s,c){this.type=Os,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const f=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Bn);if(!f)return null;const y=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Bn);if(!y)return null;let w=null;return c.locale&&(w=s.parse(c.locale,1,Hn),!w)?null:new Ma(f,y,w)}evaluate(n){return new Ph(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const Go=8192;function Ki(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function So(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function hl(i,n){const s=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,n.z);return[Math.round(s*f*Go),Math.round(c*f*Go)]}function tc(i,n,s){const c=i[0]-n[0],f=i[1]-n[1],y=i[0]-s[0],w=i[1]-s[1];return c*w-y*f==0&&c*y<=0&&f*w<=0}function od(i,n){let s=!1;for(let w=0,E=n.length;w<E;w++){const A=n[w];for(let I=0,j=A.length;I<j-1;I++){if(tc(i,A[I],A[I+1]))return!1;(f=A[I])[1]>(c=i)[1]!=(y=A[I+1])[1]>c[1]&&c[0]<(y[0]-f[0])*(c[1]-f[1])/(y[1]-f[1])+f[0]&&(s=!s)}}var c,f,y;return s}function ru(i,n){for(let s=0;s<n.length;s++)if(od(i,n[s]))return!0;return!1}function iu(i,n,s,c){const f=c[0]-s[0],y=c[1]-s[1],w=(i[0]-s[0])*y-f*(i[1]-s[1]),E=(n[0]-s[0])*y-f*(n[1]-s[1]);return w>0&&E<0||w<0&&E>0}function Ho(i,n,s){for(const I of s)for(let j=0;j<I.length-1;++j)if((E=[(w=I[j+1])[0]-(y=I[j])[0],w[1]-y[1]])[0]*(A=[(f=n)[0]-(c=i)[0],f[1]-c[1]])[1]-E[1]*A[0]!=0&&iu(c,f,y,w)&&iu(y,w,c,f))return!0;var c,f,y,w,E,A;return!1}function Jn(i,n){for(let s=0;s<i.length;++s)if(!od(i[s],n))return!1;for(let s=0;s<i.length-1;++s)if(Ho(i[s],i[s+1],n))return!1;return!0}function fp(i,n){for(let s=0;s<n.length;s++)if(Jn(i,n[s]))return!0;return!1}function Lh(i,n,s){const c=[];for(let f=0;f<i.length;f++){const y=[];for(let w=0;w<i[f].length;w++){const E=hl(i[f][w],s);Ki(n,E),y.push(E)}c.push(y)}return c}function pp(i,n,s){const c=[];for(let f=0;f<i.length;f++){const y=Lh(i[f],n,s);c.push(y)}return c}function jh(i,n,s,c){if(i[0]<s[0]||i[0]>s[2]){const f=.5*c;let y=i[0]-s[0]>f?-c:s[0]-i[0]>f?c:0;y===0&&(y=i[0]-s[2]>f?-c:s[2]-i[0]>f?c:0),i[0]+=y}Ki(n,i)}function ad(i,n,s,c){const f=Math.pow(2,c.z)*Go,y=[c.x*Go,c.y*Go],w=[];if(!i)return w;for(const E of i)for(const A of E){const I=[A.x+y[0],A.y+y[1]];jh(I,n,s,f),w.push(I)}return w}function Oh(i,n,s,c){const f=Math.pow(2,c.z)*Go,y=[c.x*Go,c.y*Go],w=[];if(!i)return w;for(const A of i){const I=[];for(const j of A){const V=[j.x+y[0],j.y+y[1]];Ki(n,V),I.push(V)}w.push(I)}if(n[2]-n[0]<=f/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const A of w)for(const I of A)jh(I,n,s,f)}var E;return w}class nc{constructor(n,s){this.type=Bn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Aa(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const y=c.features[f].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new nc(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new nc(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new nc(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(s,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(!w)return!1;if(c.type==="Polygon"){const E=Lh(c.coordinates,y,w),A=ad(s.geometry(),f,y,w);if(!So(f,y))return!1;for(const I of A)if(!od(I,E))return!1}if(c.type==="MultiPolygon"){const E=pp(c.coordinates,y,w),A=ad(s.geometry(),f,y,w);if(!So(f,y))return!1;for(const I of A)if(!ru(I,E))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(s,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(!w)return!1;if(c.type==="Polygon"){const E=Lh(c.coordinates,y,w),A=Oh(s.geometry(),f,y,w);if(!So(f,y))return!1;for(const I of A)if(!Jn(I,E))return!1}if(c.type==="MultiPolygon"){const E=pp(c.coordinates,y,w),A=Oh(s.geometry(),f,y,w);if(!So(f,y))return!1;for(const I of A)if(!fp(I,E))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ld=nc;function rc(i){if(i instanceof so&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ld)return!1;let n=!0;return i.eachChild((s=>{n&&!rc(s)&&(n=!1)})),n}function aa(i){if(i instanceof so&&i.name==="feature-state")return!1;let n=!0;return i.eachChild((s=>{n&&!aa(s)&&(n=!1)})),n}function Pa(i,n){if(i instanceof so&&n.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild((c=>{s&&!Pa(c,n)&&(s=!1)})),s}class cd{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=n[1];return s.scope.has(c)?new cd(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var mp=cd;class su{constructor(n,s=[],c,f=new Kl,y=[]){this.registry=n,this.path=s,this.key=s.map((w=>`[${w}]`)).join(""),this.scope=f,this.errors=y,this.expectedType=c}parse(n,s,c,f,y={}){return s?this.concat(s,c,f)._parse(n,y):this._parse(n,y)}_parse(n,s){function c(f,y,w){return w==="assert"?new oa(y,[f]):w==="coerce"?new Bs(y,[f]):f}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=n[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let w=y.parse(n,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,A=w.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||A.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(E,A))return null}else w=c(w,E,s.typeAnnotation||"coerce");else w=c(w,E,s.typeAnnotation||"assert")}if(!(w instanceof To)&&w.type.kind!=="resolvedImage"&&ou(w)){const E=new ec;try{w=new To(w.type,w.evaluate(E))}catch(A){return this.error(A.message),null}}return w}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,c){const f=typeof n=="number"?this.path.concat(n):this.path,y=c?this.scope.concat(c):this.scope;return new su(this.registry,f,s||null,y,this.errors)}error(n,...s){const c=`${this.key}${s.map((f=>`[${f}]`)).join("")}`;this.errors.push(new Ls(c,n))}checkSubtype(n,s){const c=Vo(n,s);return c&&this.error(c),c}}var zh=su;function ou(i){if(i instanceof mp)return ou(i.boundExpression);if(i instanceof so&&i.name==="error"||i instanceof Ma||i instanceof ld)return!1;const n=i instanceof Bs||i instanceof oa;let s=!0;return i.eachChild((c=>{s=n?s&&ou(c):s&&c instanceof To})),!!s&&rc(i)&&Pa(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ud(i,n){const s=i.length-1;let c,f,y=0,w=s,E=0;for(;y<=w;)if(E=Math.floor((y+w)/2),c=i[E],f=i[E+1],c<=n){if(E===s||n<f)return E;y=E+1}else{if(!(c>n))throw new Xr("Input is not a number.");w=E-1}return 0}class dd{constructor(n,s,c){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[f,y]of c)this.labels.push(f),this.outputs.push(y)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(n[1],1,Ut);if(!c)return null;const f=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let w=1;w<n.length;w+=2){const E=w===1?-1/0:n[w],A=n[w+1],I=w,j=w+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(f.length&&f[f.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const V=s.parse(A,j,y);if(!V)return null;y=y||V.type,f.push([E,V])}return new dd(y,c,f)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=s[0])return c[0].evaluate(n);const y=s.length;return f>=s[y-1]?c[y-1].evaluate(n):c[ud(s,f)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}var Bh=dd;function Yn(i,n,s){return i*(1-s)+n*s}var au=Object.freeze({__proto__:null,array:function(i,n,s){return i.map(((c,f)=>Yn(c,n[f],s)))},color:function(i,n,s){return new _r(Yn(i.r,n.r,s),Yn(i.g,n.g,s),Yn(i.b,n.b,s),Yn(i.a,n.a,s))},number:Yn});const gp=.95047,Fh=1.08883,yp=4/29,fl=6/29,Vh=3*fl*fl,sg=fl*fl*fl,Uh=Math.PI/180,lu=180/Math.PI;function $h(i){return i>sg?Math.pow(i,1/3):i/Vh+yp}function hd(i){return i>fl?i*i*i:Vh*(i-yp)}function fd(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function cu(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Gh(i){const n=cu(i.r),s=cu(i.g),c=cu(i.b),f=$h((.4124564*n+.3575761*s+.1804375*c)/gp),y=$h((.2126729*n+.7151522*s+.072175*c)/1);return{l:116*y-16,a:500*(f-y),b:200*(y-$h((.0193339*n+.119192*s+.9503041*c)/Fh)),alpha:i.a}}function Hh(i){let n=(i.l+16)/116,s=isNaN(i.a)?n:n+i.a/500,c=isNaN(i.b)?n:n-i.b/200;return n=1*hd(n),s=gp*hd(s),c=Fh*hd(c),new _r(fd(3.2404542*s-1.5371385*n-.4985314*c),fd(-.969266*s+1.8760108*n+.041556*c),fd(.0556434*s-.2040259*n+1.0572252*c),i.alpha)}function ic(i,n,s){const c=n-i;return i+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const uu={forward:Gh,reverse:Hh,interpolate:function(i,n,s){return{l:Yn(i.l,n.l,s),a:Yn(i.a,n.a,s),b:Yn(i.b,n.b,s),alpha:Yn(i.alpha,n.alpha,s)}}},sc={forward:function(i){const{l:n,a:s,b:c}=Gh(i),f=Math.atan2(c,s)*lu;return{h:f<0?f+360:f,c:Math.sqrt(s*s+c*c),l:n,alpha:i.a}},reverse:function(i){const n=i.h*Uh,s=i.c;return Hh({l:i.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:i.alpha})},interpolate:function(i,n,s){return{h:ic(i.h,n.h,s),c:Yn(i.c,n.c,s),l:Yn(i.l,n.l,s),alpha:Yn(i.alpha,n.alpha,s)}}};var Wh=Object.freeze({__proto__:null,hcl:sc,lab:uu});class oc{constructor(n,s,c,f,y){this.type=n,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[w,E]of y)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(n,s,c,f){let y=0;if(n.name==="exponential")y=pd(s,n.base,c,f);else if(n.name==="linear")y=pd(s,1,c,f);else if(n.name==="cubic-bezier"){const w=n.controlPoints;y=new je(w[0],w[1],w[2],w[3]).solve(pd(s,1,c,f))}return y}static parse(n,s){let[c,f,y,...w]=n;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const I=f[1];if(typeof I!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:I}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const I=f.slice(1);if(I.length!==4||I.some((j=>typeof j!="number"||j<0||j>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:I}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,Ut),!y)return null;const E=[];let A=null;c==="interpolate-hcl"||c==="interpolate-lab"?A=ws:s.expectedType&&s.expectedType.kind!=="value"&&(A=s.expectedType);for(let I=0;I<w.length;I+=2){const j=w[I],V=w[I+1],U=I+3,q=I+4;if(typeof j!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=j)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const X=s.parse(V,q,A);if(!X)return null;A=A||X.type,E.push([j,X])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new oc(A,c,f,y,E):s.error(`Type ${Cr(A)} is not interpolatable.`)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=s[0])return c[0].evaluate(n);const y=s.length;if(f>=s[y-1])return c[y-1].evaluate(n);const w=ud(s,f),E=oc.interpolationFactor(this.interpolation,f,s[w],s[w+1]),A=c[w].evaluate(n),I=c[w+1].evaluate(n);return this.operator==="interpolate"?au[this.type.kind.toLowerCase()](A,I,E):this.operator==="interpolate-hcl"?sc.reverse(sc.interpolate(sc.forward(A),sc.forward(I),E)):uu.reverse(uu.interpolate(uu.forward(A),uu.forward(I),E))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function pd(i,n,s,c){const f=c-s,y=i-s;return f===0?0:n===1?y/f:(Math.pow(n,y)-1)/(Math.pow(n,f)-1)}var bs=oc;class Na{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let c=null;const f=s.expectedType;f&&f.kind!=="value"&&(c=f);const y=[];for(const E of n.slice(1)){const A=s.parse(E,1+y.length,c,void 0,{typeAnnotation:"omit"});if(!A)return null;c=c||A.type,y.push(A)}const w=f&&y.some((E=>Vo(f,E.type)));return new Na(w?Nn:c,y)}evaluate(n){let s,c=null,f=0;for(const y of this.args){if(f++,c=y.evaluate(n),c&&c instanceof ro&&!c.available&&(s||(s=c),c=null,f===this.args.length))return s;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){const n=["coalesce"];return this.eachChild((s=>{n.push(s.serialize())})),n}}var qh=Na;class pl{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let y=1;y<n.length-1;y+=2){const w=n[y];if(typeof w!="string")return s.error(`Expected string, but found ${typeof w} instead.`,y);if(/[^a-zA-Z0-9_]/.test(w))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=s.parse(n[y+1],y+1);if(!E)return null;c.push([w,E])}const f=s.parse(n[n.length-1],n.length-1,s.expectedType,c);return f?new pl(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,c]of this.bindings)n.push(s,c.serialize());return n.push(this.result.serialize()),n}}var _p=pl;class md{constructor(n,s,c){this.type=n,this.index=s,this.input=c}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Ut),f=s.parse(n[2],2,zs(s.expectedType||Nn));return c&&f?new md(f.type.itemType,c,f):null}evaluate(n){const s=this.index.evaluate(n),c=this.input.evaluate(n);if(s<0)throw new Xr(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new Xr(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new Xr(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Zh=md;class du{constructor(n,s){this.type=Bn,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Nn),f=s.parse(n[2],2,Nn);return c&&f?Yl(c.type,[Bn,Hn,Ut,sa,Nn])?new du(c,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(c.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!Jl(s,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(Br(s))} instead.`);if(!Jl(c,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${Cr(Br(c))} instead.`);return c.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var hu=du;class ac{constructor(n,s,c){this.type=Ut,this.needle=n,this.haystack=s,this.fromIndex=c}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Nn),f=s.parse(n[2],2,Nn);if(!c||!f)return null;if(!Yl(c.type,[Bn,Hn,Ut,sa,Nn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(c.type)} instead`);if(n.length===4){const y=s.parse(n[3],3,Ut);return y?new ac(c,f,y):null}return new ac(c,f)}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Jl(s,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(Br(s))} instead.`);if(!Jl(c,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${Cr(Br(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(n);return c.indexOf(s,f)}return c.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var Xh=ac;class Kh{constructor(n,s,c,f,y,w){this.inputType=n,this.type=s,this.input=c,this.cases=f,this.outputs=y,this.otherwise=w}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let c,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const y={},w=[];for(let I=2;I<n.length-1;I+=2){let j=n[I];const V=n[I+1];Array.isArray(j)||(j=[j]);const U=s.concat(I);if(j.length===0)return U.error("Expected at least one branch label.");for(const X of j){if(typeof X!="number"&&typeof X!="string")return U.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return U.error("Numeric branch labels must be integer values.");if(c){if(U.checkSubtype(c,Br(X)))return null}else c=Br(X);if(y[String(X)]!==void 0)return U.error("Branch labels must be unique.");y[String(X)]=w.length}const q=s.parse(V,I,f);if(!q)return null;f=f||q.type,w.push(q)}const E=s.parse(n[1],1,Nn);if(!E)return null;const A=s.parse(n[n.length-1],n.length-1,f);return A?E.type.kind!=="value"&&s.concat(1).checkSubtype(c,E.type)?null:new Kh(c,f,E,y,w,A):null}evaluate(n){const s=this.input.evaluate(n);return(Br(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],f={};for(const w of s){const E=f[this.cases[w]];E===void 0?(f[this.cases[w]]=c.length,c.push([this.cases[w],[w]])):c[E][1].push(w)}const y=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,E]of c)n.push(E.length===1?y(E[0]):E.map(y)),n.push(this.outputs[w].serialize());return n.push(this.otherwise.serialize()),n}}var og=Kh;class Yh{constructor(n,s,c){this.type=n,this.branches=s,this.otherwise=c}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const f=[];for(let w=1;w<n.length-1;w+=2){const E=s.parse(n[w],w,Bn);if(!E)return null;const A=s.parse(n[w+1],w+1,c);if(!A)return null;f.push([E,A]),c=c||A.type}const y=s.parse(n[n.length-1],n.length-1,c);return y?new Yh(c,f,y):null}evaluate(n){for(const[s,c]of this.branches)if(s.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,c]of this.branches)n(s),n(c);n(this.otherwise)}outputDefined(){return this.branches.every((([n,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild((s=>{n.push(s.serialize())})),n}}var xp=Yh;class fu{constructor(n,s,c,f){this.type=n,this.input=s,this.beginIndex=c,this.endIndex=f}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Nn),f=s.parse(n[2],2,Ut);if(!c||!f)return null;if(!Yl(c.type,[zs(Nn),Hn,Nn]))return s.error(`Expected first argument to be of type array or string, but found ${Cr(c.type)} instead`);if(n.length===4){const y=s.parse(n[3],3,Ut);return y?new fu(c.type,c,f,y):null}return new fu(c.type,c,f)}evaluate(n){const s=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!Jl(s,["string","array"]))throw new Xr(`Expected first argument to be of type array or string, but found ${Cr(Br(s))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(n);return s.slice(c,f)}return s.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var oo=fu;function Ra(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Jh(i,n,s,c){return c.compare(n,s)===0}function ml(i,n,s){const c=i!=="=="&&i!=="!=";return class N3{constructor(y,w,E){this.type=Bn,this.lhs=y,this.rhs=w,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||w.type.kind==="value"}static parse(y,w){if(y.length!==3&&y.length!==4)return w.error("Expected two or three arguments.");const E=y[0];let A=w.parse(y[1],1,Nn);if(!A)return null;if(!Ra(E,A.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${Cr(A.type)}'.`);let I=w.parse(y[2],2,Nn);if(!I)return null;if(!Ra(E,I.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${Cr(I.type)}'.`);if(A.type.kind!==I.type.kind&&A.type.kind!=="value"&&I.type.kind!=="value")return w.error(`Cannot compare types '${Cr(A.type)}' and '${Cr(I.type)}'.`);c&&(A.type.kind==="value"&&I.type.kind!=="value"?A=new oa(I.type,[A]):A.type.kind!=="value"&&I.type.kind==="value"&&(I=new oa(A.type,[I])));let j=null;if(y.length===4){if(A.type.kind!=="string"&&I.type.kind!=="string"&&A.type.kind!=="value"&&I.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(j=w.parse(y[3],3,Os),!j)return null}return new N3(A,I,j)}evaluate(y){const w=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(c&&this.hasUntypedArgument){const A=Br(w),I=Br(E);if(A.kind!==I.kind||A.kind!=="string"&&A.kind!=="number")throw new Xr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${A.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const A=Br(w),I=Br(E);if(A.kind!=="string"||I.kind!=="string")return n(y,w,E)}return this.collator?s(y,w,E,this.collator.evaluate(y)):n(y,w,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[i];return this.eachChild((w=>{y.push(w.serialize())})),y}}}const vp=ml("==",(function(i,n,s){return n===s}),Jh),wp=ml("!=",(function(i,n,s){return n!==s}),(function(i,n,s,c){return!Jh(0,n,s,c)})),Qh=ml("<",(function(i,n,s){return n<s}),(function(i,n,s,c){return c.compare(n,s)<0})),ag=ml(">",(function(i,n,s){return n>s}),(function(i,n,s,c){return c.compare(n,s)>0})),lg=ml("<=",(function(i,n,s){return n<=s}),(function(i,n,s,c){return c.compare(n,s)<=0})),gl=ml(">=",(function(i,n,s){return n>=s}),(function(i,n,s,c){return c.compare(n,s)>=0}));class lc{constructor(n,s,c,f,y,w){this.type=Hn,this.number=n,this.locale=s,this.currency=c,this.unit=f,this.minFractionDigits=y,this.maxFractionDigits=w}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Ut);if(!c)return null;const f=n[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=s.parse(f.locale,1,Hn),!y))return null;let w=null;if(f.currency&&(w=s.parse(f.currency,1,Hn),!w))return null;let E=null;if(f.unit&&(E=s.parse(f.unit,1,Hn),!E))return null;let A=null;if(f["min-fraction-digits"]&&(A=s.parse(f["min-fraction-digits"],1,Ut),!A))return null;let I=null;return f["max-fraction-digits"]&&(I=s.parse(f["max-fraction-digits"],1,Ut),!I)?null:new lc(c,y,w,E,A,I)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Wo{constructor(n){this.type=Ut,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=s.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Cr(c.type)} instead.`):new Wo(c):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Xr(`Expected value to be of type string or array, but found ${Cr(Br(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild((s=>{n.push(s.serialize())})),n}}const gd={"==":vp,"!=":wp,">":ag,"<":Qh,">=":gl,"<=":lg,array:oa,at:Zh,boolean:oa,case:xp,coalesce:qh,collator:Ma,format:$o,image:dl,in:hu,"index-of":Xh,interpolate:bs,"interpolate-hcl":bs,"interpolate-lab":bs,length:Wo,let:_p,literal:To,match:og,number:oa,"number-format":lc,object:oa,slice:oo,step:Bh,string:oa,"to-boolean":Bs,"to-color":Bs,"to-number":Bs,"to-string":Bs,var:mp,within:ld};function ef(i,[n,s,c,f]){n=n.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const y=f?f.evaluate(i):1,w=Nh(n,s,c,y);if(w)throw new Xr(w);return new _r(n/255*y,s/255*y,c/255*y,y)}function ao(i,n){return i in n}function la(i,n){const s=n[i];return s===void 0?null:s}function Ts(i){return{type:i}}so.register(gd,{error:[{kind:"error"},[Hn],(i,[n])=>{throw new Xr(n.evaluate(i))}],typeof:[Hn,[Nn],(i,[n])=>Cr(Br(n.evaluate(i)))],"to-rgba":[zs(Ut,4),[ws],(i,[n])=>n.evaluate(i).toArray()],rgb:[ws,[Ut,Ut,Ut],ef],rgba:[ws,[Ut,Ut,Ut,Ut],ef],has:{type:Bn,overloads:[[[Hn],(i,[n])=>ao(n.evaluate(i),i.properties())],[[Hn,js],(i,[n,s])=>ao(n.evaluate(i),s.evaluate(i))]]},get:{type:Nn,overloads:[[[Hn],(i,[n])=>la(n.evaluate(i),i.properties())],[[Hn,js],(i,[n,s])=>la(n.evaluate(i),s.evaluate(i))]]},"feature-state":[Nn,[Hn],(i,[n])=>la(n.evaluate(i),i.featureState||{})],properties:[js,[],i=>i.properties()],"geometry-type":[Hn,[],i=>i.geometryType()],id:[Nn,[],i=>i.id()],zoom:[Ut,[],i=>i.globals.zoom],pitch:[Ut,[],i=>i.globals.pitch||0],"distance-from-center":[Ut,[],i=>i.distanceFromCenter()],"heatmap-density":[Ut,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ut,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[Ut,[],i=>i.globals.skyRadialProgress||0],accumulated:[Nn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ut,Ts(Ut),(i,n)=>{let s=0;for(const c of n)s+=c.evaluate(i);return s}],"*":[Ut,Ts(Ut),(i,n)=>{let s=1;for(const c of n)s*=c.evaluate(i);return s}],"-":{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)-s.evaluate(i)],[[Ut],(i,[n])=>-n.evaluate(i)]]},"/":[Ut,[Ut,Ut],(i,[n,s])=>n.evaluate(i)/s.evaluate(i)],"%":[Ut,[Ut,Ut],(i,[n,s])=>n.evaluate(i)%s.evaluate(i)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(i,[n,s])=>Math.pow(n.evaluate(i),s.evaluate(i))],sqrt:[Ut,[Ut],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))],log2:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[Ut,[Ut],(i,[n])=>Math.sin(n.evaluate(i))],cos:[Ut,[Ut],(i,[n])=>Math.cos(n.evaluate(i))],tan:[Ut,[Ut],(i,[n])=>Math.tan(n.evaluate(i))],asin:[Ut,[Ut],(i,[n])=>Math.asin(n.evaluate(i))],acos:[Ut,[Ut],(i,[n])=>Math.acos(n.evaluate(i))],atan:[Ut,[Ut],(i,[n])=>Math.atan(n.evaluate(i))],min:[Ut,Ts(Ut),(i,n)=>Math.min(...n.map((s=>s.evaluate(i))))],max:[Ut,Ts(Ut),(i,n)=>Math.max(...n.map((s=>s.evaluate(i))))],abs:[Ut,[Ut],(i,[n])=>Math.abs(n.evaluate(i))],round:[Ut,[Ut],(i,[n])=>{const s=n.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[Ut,[Ut],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[Ut,[Ut],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[Bn,[Hn,Nn],(i,[n,s])=>i.properties()[n.value]===s.value],"filter-id-==":[Bn,[Nn],(i,[n])=>i.id()===n.value],"filter-type-==":[Bn,[Hn],(i,[n])=>i.geometryType()===n.value],"filter-<":[Bn,[Hn,Nn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Bn,[Nn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s<c}],"filter->":[Bn,[Hn,Nn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c>f}],"filter-id->":[Bn,[Nn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s>c}],"filter-<=":[Bn,[Hn,Nn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Bn,[Nn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s<=c}],"filter->=":[Bn,[Hn,Nn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Bn,[Nn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s>=c}],"filter-has":[Bn,[Nn],(i,[n])=>n.value in i.properties()],"filter-has-id":[Bn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Bn,[zs(Hn)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[Bn,[zs(Nn)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[Bn,[Hn,zs(Nn)],(i,[n,s])=>s.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[Bn,[Hn,zs(Nn)],(i,[n,s])=>(function(c,f,y,w){for(;y<=w;){const E=y+w>>1;if(f[E]===c)return!0;f[E]>c?w=E-1:y=E+1}return!1})(i.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Bn,overloads:[[[Bn,Bn],(i,[n,s])=>n.evaluate(i)&&s.evaluate(i)],[Ts(Bn),(i,n)=>{for(const s of n)if(!s.evaluate(i))return!1;return!0}]]},any:{type:Bn,overloads:[[[Bn,Bn],(i,[n,s])=>n.evaluate(i)||s.evaluate(i)],[Ts(Bn),(i,n)=>{for(const s of n)if(s.evaluate(i))return!0;return!1}]]},"!":[Bn,[Bn],(i,[n])=>!n.evaluate(i)],"is-supported-script":[Bn,[Hn],(i,[n])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(n.evaluate(i))}],upcase:[Hn,[Hn],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Hn,[Hn],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Hn,Ts(Nn),(i,n)=>n.map((s=>nu(s.evaluate(i)))).join("")],"resolved-locale":[Hn,[Os],(i,[n])=>n.evaluate(i).resolvedLocale()]});var cc=gd;function pu(i){return{result:"success",value:i}}function Da(i){return{result:"error",value:i}}function yl(i){return i["property-type"]==="data-driven"}function mu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function gu(i){return!!i.expression&&i.expression.interpolated}function Qn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function uc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function ca(i){return i}function dc(i,n){const s=n.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",f=c||!(c||i.property!==void 0),y=i.type||(gu(n)?"exponential":"interval");if(s&&((i=bi({},i)).stops&&(i.stops=i.stops.map((I=>[I[0],_r.parse(I[1])]))),i.default=_r.parse(i.default?i.default:n.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Wh[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let w,E,A;if(y==="exponential")w=Fs;else if(y==="interval")w=yd;else if(y==="categorical"){w=bp,E=Object.create(null);for(const I of i.stops)E[I[0]]=I[1];A=typeof i.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=Tp}if(c){const I={},j=[];for(let q=0;q<i.stops.length;q++){const X=i.stops[q],te=X[0].zoom;I[te]===void 0&&(I[te]={zoom:te,type:i.type,property:i.property,default:i.default,stops:[]},j.push(te)),I[te].stops.push([X[0].value,X[1]])}const V=[];for(const q of j)V.push([I[q].zoom,dc(I[q],n)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:bs.interpolationFactor.bind(void 0,U),zoomStops:V.map((q=>q[0])),evaluate:({zoom:q},X)=>Fs({stops:V,base:i.base},n,q).evaluate(q,X)}}if(f){const I=y==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:bs.interpolationFactor.bind(void 0,I),zoomStops:i.stops.map((j=>j[0])),evaluate:({zoom:j})=>w(i,n,j,E,A)}}return{kind:"source",evaluate(I,j){const V=j&&j.properties?j.properties[i.property]:void 0;return V===void 0?La(i.default,n.default):w(i,n,V,E,A)}}}function La(i,n,s){return i!==void 0?i:n!==void 0?n:s!==void 0?s:void 0}function bp(i,n,s,c,f){return La(typeof s===f?c[s]:void 0,i.default,n.default)}function yd(i,n,s){if(Qn(s)!=="number")return La(i.default,n.default);const c=i.stops.length;if(c===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[c-1][0])return i.stops[c-1][1];const f=ud(i.stops.map((y=>y[0])),s);return i.stops[f][1]}function Fs(i,n,s){const c=i.base!==void 0?i.base:1;if(Qn(s)!=="number")return La(i.default,n.default);const f=i.stops.length;if(f===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[f-1][0])return i.stops[f-1][1];const y=ud(i.stops.map((j=>j[0])),s),w=(function(j,V,U,q){const X=q-U,te=j-U;return X===0?0:V===1?te/X:(Math.pow(V,te)-1)/(Math.pow(V,X)-1)})(s,c,i.stops[y][0],i.stops[y+1][0]),E=i.stops[y][1],A=i.stops[y+1][1];let I=au[n.type]||ca;if(i.colorSpace&&i.colorSpace!=="rgb"){const j=Wh[i.colorSpace];I=(V,U)=>j.reverse(j.interpolate(j.forward(V),j.forward(U),w))}return typeof E.evaluate=="function"?{evaluate(...j){const V=E.evaluate.apply(void 0,j),U=A.evaluate.apply(void 0,j);if(V!==void 0&&U!==void 0)return I(V,U,w)}}:I(E,A,w)}function Tp(i,n,s){return n.type==="color"?s=_r.parse(s):n.type==="formatted"?s=Ri.fromString(s.toString()):n.type==="resolvedImage"?s=ro.fromString(s.toString()):Qn(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),La(s,i.default,n.default)}class yu{constructor(n,s){this.expression=n,this._warningHistory={},this._evaluator=new ec,this._defaultValue=s?(function(c){return c.type==="color"&&(uc(c.default)||Array.isArray(c.default))?new _r(0,0,0,0):c.type==="color"?_r.parse(c.default)||null:c.default===void 0?null:c.default})(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,c,f,y,w,E,A){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,c,f,y,w,E,A){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=A||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Xr(`Expected value to be one of ${Object.keys(this._enumValues).map((j=>JSON.stringify(j))).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function _l(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in cc}function gr(i,n){const s=new zh(cc,[],n?(function(f){const y={color:ws,string:Hn,number:Ut,enum:Hn,boolean:Bn,formatted:cl,resolvedImage:sr};return f.type==="array"?zs(y[f.value]||Nn,f.length):y[f.type]})(n):void 0),c=s.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?pu(new yu(c,n)):Da(s.errors)}class _u{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!aa(s.expression)}evaluateWithoutErrorHandling(n,s,c,f,y,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,f,y,w)}evaluate(n,s,c,f,y,w){return this._styleExpression.evaluate(n,s,c,f,y,w)}}class ja{constructor(n,s,c,f){this.kind=n,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!aa(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(n,s,c,f,y,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,f,y,w)}evaluate(n,s,c,f,y,w){return this._styleExpression.evaluate(n,s,c,f,y,w)}interpolationFactor(n,s,c){return this.interpolationType?bs.interpolationFactor(this.interpolationType,n,s,c):0}}function ua(i,n){if((i=gr(i,n)).result==="error")return i;const s=i.value.expression,c=rc(s);if(!c&&!yl(n))return Da([new Ls("","data expressions not supported")]);const f=Pa(s,["zoom","pitch","distance-from-center"]);if(!f&&!mu(n))return Da([new Ls("","zoom expressions not supported")]);const y=hc(s);return y||f?y instanceof Ls?Da([y]):y instanceof bs&&!gu(n)?Da([new Ls("",'"interpolate" expressions cannot be used with this property')]):pu(y?new ja(c?"camera":"composite",i.value,y.labels,y instanceof bs?y.interpolation:void 0):new _u(c?"constant":"source",i.value)):Da([new Ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class xu{constructor(n,s){this._parameters=n,this._specification=s,bi(this,dc(this._parameters,this._specification))}static deserialize(n){return new xu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function hc(i){let n=null;if(i instanceof _p)n=hc(i.result);else if(i instanceof qh){for(const s of i.args)if(n=hc(s),n)break}else(i instanceof Bh||i instanceof bs)&&i.input instanceof so&&i.input.name==="zoom"&&(n=i);return n instanceof Ls||i.eachChild((s=>{const c=hc(s);c instanceof Ls?n=c:!n&&c?n=new Ls("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new Ls("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}class zt{constructor(n,s,c,f){this.message=(n?`${n}: `:"")+c,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function Ss(i){const n=i.key,s=i.value,c=i.valueSpec||{},f=i.objectElementValidators||{},y=i.style,w=i.styleSpec;let E=[];const A=Qn(s);if(A!=="object")return[new zt(n,s,`object expected, ${A} found`)];for(const I in s){const j=I.split(".")[0];let V;f[j]?V=f[j]:c[j]?V=Wn:f["*"]?V=f["*"]:c["*"]&&(V=Wn),V?E=E.concat(V({key:(n&&`${n}.`)+I,value:s[I],valueSpec:c[j]||c["*"],style:y,styleSpec:w,object:s,objectKey:I},s)):E.push(new zt(n,s[I],`unknown property "${I}"`))}for(const I in c)f[I]||c[I].required&&c[I].default===void 0&&s[I]===void 0&&E.push(new zt(n,s,`missing required property "${I}"`));return E}function xl(i){const n=i.value,s=i.valueSpec,c=i.style,f=i.styleSpec,y=i.key,w=i.arrayElementValidator||Wn;if(Qn(n)!=="array")return[new zt(y,n,`array expected, ${Qn(n)} found`)];if(s.length&&n.length!==s.length)return[new zt(y,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new zt(y,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let E={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};f.$version<7&&(E.function=s.function),Qn(s.value)==="object"&&(E=s.value);let A=[];for(let I=0;I<n.length;I++)A=A.concat(w({array:n,arrayIndex:I,value:n[I],valueSpec:E,style:c,styleSpec:f,key:`${y}[${I}]`}));return A}function fc(i){const n=i.key,s=i.value,c=i.valueSpec;let f=Qn(s);if(f==="number"&&s!=s&&(f="NaN"),f!=="number")return[new zt(n,s,`number expected, ${f} found`)];if("minimum"in c){let y=c.minimum;if(Qn(c.minimum)==="array"&&(y=c.minimum[i.arrayIndex]),s<y)return[new zt(n,s,`${s} is less than the minimum value ${y}`)]}if("maximum"in c){let y=c.maximum;if(Qn(c.maximum)==="array"&&(y=c.maximum[i.arrayIndex]),s>y)return[new zt(n,s,`${s} is greater than the maximum value ${y}`)]}return[]}function vu(i){const n=i.valueSpec,s=ii(i.value.type);let c,f,y,w={};const E=s!=="categorical"&&i.value.property===void 0,A=!E,I=Qn(i.value.stops)==="array"&&Qn(i.value.stops[0])==="array"&&Qn(i.value.stops[0][0])==="object",j=Ss({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(q){if(s==="identity")return[new zt(q.key,q.value,'identity function may not have a "stops" property')];let X=[];const te=q.value;return X=X.concat(xl({key:q.key,value:te,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:V})),Qn(te)==="array"&&te.length===0&&X.push(new zt(q.key,te,"array must have at least one stop")),X},default:function(q){return Wn({key:q.key,value:q.value,valueSpec:n,style:q.style,styleSpec:q.styleSpec})}}});return s==="identity"&&E&&j.push(new zt(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||j.push(new zt(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!gu(i.valueSpec)&&j.push(new zt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(A&&!yl(i.valueSpec)?j.push(new zt(i.key,i.value,"property functions not supported")):E&&!mu(i.valueSpec)&&j.push(new zt(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!I||i.value.property!==void 0||j.push(new zt(i.key,i.value,'"property" property is required')),j;function V(q){let X=[];const te=q.value,ae=q.key;if(Qn(te)!=="array")return[new zt(ae,te,`array expected, ${Qn(te)} found`)];if(te.length!==2)return[new zt(ae,te,`array length 2 expected, length ${te.length} found`)];if(I){if(Qn(te[0])!=="object")return[new zt(ae,te,`object expected, ${Qn(te[0])} found`)];if(te[0].zoom===void 0)return[new zt(ae,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new zt(ae,te,"object stop key must have value")];const ge=ii(te[0].zoom);if(typeof ge!="number")return[new zt(ae,te[0].zoom,"stop zoom values must be numbers")];if(y&&y>ge)return[new zt(ae,te[0].zoom,"stop zoom values must appear in ascending order")];ge!==y&&(y=ge,f=void 0,w={}),X=X.concat(Ss({key:`${ae}[0]`,value:te[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:fc,value:U}}))}else X=X.concat(U({key:`${ae}[0]`,value:te[0],style:q.style,styleSpec:q.styleSpec},te));return _l(Pi(te[1]))?X.concat([new zt(`${ae}[1]`,te[1],"expressions are not allowed in function stops.")]):X.concat(Wn({key:`${ae}[1]`,value:te[1],valueSpec:n,style:q.style,styleSpec:q.styleSpec}))}function U(q,X){const te=Qn(q.value),ae=ii(q.value),ge=q.value!==null?q.value:X;if(c){if(te!==c)return[new zt(q.key,ge,`${te} stop domain type must match previous stop domain type ${c}`)]}else c=te;if(te!=="number"&&te!=="string"&&te!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new zt(q.key,ge,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&s!=="categorical"){let ke=`number expected, ${te} found`;return yl(n)&&s===void 0&&(ke+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(q.key,ge,ke)]}return s!=="categorical"||te!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?s!=="categorical"&&te==="number"&&typeof ae=="number"&&typeof f=="number"&&f!==void 0&&ae<f?[new zt(q.key,ge,"stop domain values must appear in ascending order")]:(f=ae,s==="categorical"&&ae in w?[new zt(q.key,ge,"stop domain values must be unique")]:(w[ae]=!0,[])):[new zt(q.key,ge,`integer expected, found ${String(ae)}`)]}}function Di(i){const n=(i.expressionContext==="property"?ua:gr)(Pi(i.value),i.valueSpec);if(n.result==="error")return n.value.map((c=>new zt(`${i.key}${c.key}`,i.value,c.message)));const s=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new zt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!aa(s))return[new zt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return pc(s,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Pa(s,["zoom","feature-state"]))return[new zt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!rc(s))return[new zt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function pc(i,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const f of n.valueSpec.expression.parameters)s.delete(f);if(s.size===0)return[];const c=[];return i instanceof so&&s.has(i.name)?[new zt(n.key,n.value,`["${i.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(i.eachChild((f=>{c.push(...pc(f,n))})),c)}function vl(i){const n=i.key,s=i.value,c=i.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(ii(s))===-1&&f.push(new zt(n,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(ii(s))===-1&&f.push(new zt(n,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function mc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!mc(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function gc(i,n="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};mc(i)||(i=_c(i));const s=i;let c=!0;try{c=(function(I){if(!Oa(I))return I;let j=Pi(I);return yc(j),j=_d(j),j})(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const f=pt[`filter_${n}`],y=gr(c,f);let w=null;if(y.result==="error")throw new Error(y.value.map((I=>`${I.key}: ${I.message}`)).join(", "));w=(I,j,V)=>y.value.evaluate(I,j,{},V);let E=null,A=null;if(c!==s){const I=gr(s,f);if(I.result==="error")throw new Error(I.value.map((j=>`${j.key}: ${j.message}`)).join(", "));E=(j,V,U,q,X)=>I.value.evaluate(j,V,{},U,void 0,void 0,q,X),A=!rc(I.value.expression)}return{filter:w,dynamicFilter:E||void 0,needGeometry:Ep(c),needFeature:!!A}}function _d(i){if(!Array.isArray(i))return i;const n=(function(s){if(tf.has(s[0])){for(let c=1;c<s.length;c++)if(Oa(s[c]))return!0}return s})(i);return n===!0?n:n.map((s=>_d(s)))}function yc(i){let n=!1;const s=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)n=n||Oa(i[c]),s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="match"){n=n||Oa(i[1]);for(let c=2;c<i.length-1;c+=2)s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="step"){n=n||Oa(i[1]);for(let c=1;c<i.length-1;c+=2)s.push(i[c+1])}n&&(i.length=0,i.push("any",...s));for(let c=1;c<i.length;c++)yc(i[c])}function Oa(i){if(!Array.isArray(i))return!1;if((n=i[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<i.length;s++)if(Oa(i[s]))return!0;return!1}const tf=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Sp(i,n){return i<n?-1:i>n?1:0}function Ep(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let n=1;n<i.length;n++)if(Ep(i[n]))return!0;return!1}function _c(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?wu(i[1],i[2],"=="):n==="!="?da(wu(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?wu(i[1],i[2],n):n==="any"?(s=i.slice(1),["any"].concat(s.map(_c))):n==="all"?["all"].concat(i.slice(1).map(_c)):n==="none"?["all"].concat(i.slice(1).map(_c).map(da)):n==="in"?qo(i[1],i.slice(2)):n==="!in"?da(qo(i[1],i.slice(2))):n==="has"?xd(i[1]):n==="!has"?da(xd(i[1])):n!=="within"||i;var s}function wu(i,n,s){switch(i){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,i,n]}}function qo(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((s=>typeof s!=typeof n[0]))?["filter-in-large",i,["literal",n.sort(Sp)]]:["filter-in-small",i,["literal",n]]}}function xd(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function da(i){return["!",i]}function Es(i){return mc(Pi(i.value))?Di(bi({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):ha(i)}function ha(i){const n=i.value,s=i.key;if(Qn(n)!=="array")return[new zt(s,n,`array expected, ${Qn(n)} found`)];const c=i.styleSpec;let f,y=[];if(n.length<1)return[new zt(s,n,"filter array must have at least 1 element")];switch(y=y.concat(vl({key:`${s}[0]`,value:n[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),ii(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&ii(n[1])==="$type"&&y.push(new zt(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new zt(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(f=Qn(n[1]),f!=="string"&&y.push(new zt(`${s}[1]`,n[1],`string expected, ${f} found`)));for(let w=2;w<n.length;w++)f=Qn(n[w]),ii(n[1])==="$type"?y=y.concat(vl({key:`${s}[${w}]`,value:n[w],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new zt(`${s}[${w}]`,n[w],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)y=y.concat(ha({key:`${s}[${w}]`,value:n[w],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Qn(n[1]),n.length!==2?y.push(new zt(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new zt(`${s}[1]`,n[1],`string expected, ${f} found`));break;case"within":f=Qn(n[1]),n.length!==2?y.push(new zt(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="object"&&y.push(new zt(`${s}[1]`,n[1],`object expected, ${f} found`))}return y}function Eo(i,n){const s=i.key,c=i.style,f=i.styleSpec,y=i.value,w=i.objectKey,E=f[`${n}_${i.layerType}`];if(!E)return[];const A=w.match(/^(.*)-transition$/);if(n==="paint"&&A&&E[A[1]]&&E[A[1]].transition)return Wn({key:s,value:y,valueSpec:f.transition,style:c,styleSpec:f});const I=i.valueSpec||E[w];if(!I)return[new zt(s,y,`unknown property "${w}"`)];let j;if(Qn(y)==="string"&&yl(I)&&!I.tokens&&(j=/^{([^}]+)}$/.exec(y))){const U=`\`{ "type": "identity", "property": ${j?JSON.stringify(j[1]):'"_"'} }\``;return[new zt(s,y,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${U}.`)]}const V=[];return i.layerType==="symbol"&&(w==="text-field"&&c&&!c.glyphs&&V.push(new zt(s,y,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&uc(Pi(y))&&ii(y.type)==="identity"&&V.push(new zt(s,y,'"text-font" does not support identity functions'))),V.concat(Wn({key:i.key,value:y,valueSpec:I,style:c,styleSpec:f,expressionContext:"property",propertyType:n,propertyKey:w}))}function vd(i){return Eo(i,"paint")}function nf(i){return Eo(i,"layout")}function Cp(i){let n=[];const s=i.value,c=i.key,f=i.style,y=i.styleSpec;s.type||s.ref||n.push(new zt(c,s,'either "type" or "ref" is required'));let w=ii(s.type);const E=ii(s.ref);if(s.id){const A=ii(s.id);for(let I=0;I<i.arrayIndex;I++){const j=f.layers[I];ii(j.id)===A&&n.push(new zt(c,s.id,`duplicate layer id "${s.id}", previously used at line ${j.id.__line__}`))}}if("ref"in s){let A;["type","source","source-layer","filter","layout"].forEach((I=>{I in s&&n.push(new zt(c,s[I],`"${I}" is prohibited for ref layers`))})),f.layers.forEach((I=>{ii(I.id)===E&&(A=I)})),A?A.ref?n.push(new zt(c,s.ref,"ref cannot reference another ref layer")):w=ii(A.type):typeof E=="string"&&n.push(new zt(c,s.ref,`ref layer "${E}" not found`))}else if(w!=="background"&&w!=="sky")if(s.source){const A=f.sources&&f.sources[s.source],I=A&&ii(A.type);A?I==="vector"&&w==="raster"?n.push(new zt(c,s.source,`layer "${s.id}" requires a raster source`)):I==="raster"&&w!=="raster"?n.push(new zt(c,s.source,`layer "${s.id}" requires a vector source`)):I!=="vector"||s["source-layer"]?I==="raster-dem"&&w!=="hillshade"?n.push(new zt(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||I==="geojson"&&A.lineMetrics||n.push(new zt(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new zt(c,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new zt(c,s.source,`source "${s.source}" not found`))}else n.push(new zt(c,s,'missing required property "source"'));return n=n.concat(Ss({key:c,value:s,valueSpec:y.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Wn({key:`${c}.type`,value:s.type,valueSpec:y.layer.type,style:i.style,styleSpec:i.styleSpec,object:s,objectKey:"type"}),filter:A=>Es(bi({layerType:w},A)),layout:A=>Ss({layer:s,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":I=>nf(bi({layerType:w},I))}}),paint:A=>Ss({layer:s,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":I=>vd(bi({layerType:w},I))}})}})),n}function Cs(i){const n=i.value,s=i.key,c=Qn(n);return c!=="string"?[new zt(s,n,`string expected, ${c} found`)]:[]}const xc={promoteId:function({key:i,value:n}){if(Qn(n)==="string")return Cs({key:i,value:n});{const s=[];for(const c in n)s.push(...Cs({key:`${i}.${c}`,value:n[c]}));return s}}};function wl(i){const n=i.value,s=i.key,c=i.styleSpec,f=i.style;if(!n.type)return[new zt(s,n,'"type" is required')];const y=ii(n.type);let w;switch(y){case"vector":case"raster":case"raster-dem":return w=Ss({key:s,value:n,valueSpec:c[`source_${y.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:xc}),w;case"geojson":if(w=Ss({key:s,value:n,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:xc}),n.cluster)for(const E in n.clusterProperties){const[A,I]=n.clusterProperties[E],j=typeof A=="string"?[A,["accumulated"],["get",E]]:A;w.push(...Di({key:`${s}.${E}.map`,value:I,expressionContext:"cluster-map"})),w.push(...Di({key:`${s}.${E}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return w;case"video":return Ss({key:s,value:n,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return Ss({key:s,value:n,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new zt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:`${s}.type`,value:n.type,valueSpec:{values:wd(c)}})}}function wd(i){return i.source.reduce(((n,s)=>{const c=i[s];return c.type.type==="enum"&&(n=n.concat(Object.keys(c.type.values))),n}),[])}function bd(i){const n=i.value,s=i.styleSpec,c=s.light,f=i.style;let y=[];const w=Qn(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new zt("light",n,`object expected, ${w} found`)]),y;for(const E in n){const A=E.match(/^(.*)-transition$/);y=y.concat(A&&c[A[1]]&&c[A[1]].transition?Wn({key:E,value:n[E],valueSpec:s.transition,style:f,styleSpec:s}):c[E]?Wn({key:E,value:n[E],valueSpec:c[E],style:f,styleSpec:s}):[new zt(E,n[E],`unknown property "${E}"`)])}return y}function za(i){const n=i.value,s=i.key,c=i.style,f=i.styleSpec,y=f.terrain;let w=[];const E=Qn(n);if(n===void 0)return w;if(E!=="object")return w=w.concat([new zt("terrain",n,`object expected, ${E} found`)]),w;for(const A in n){const I=A.match(/^(.*)-transition$/);w=w.concat(I&&y[I[1]]&&y[I[1]].transition?Wn({key:A,value:n[A],valueSpec:f.transition,style:c,styleSpec:f}):y[A]?Wn({key:A,value:n[A],valueSpec:y[A],style:c,styleSpec:f}):[new zt(A,n[A],`unknown property "${A}"`)])}if(n.source){const A=c.sources&&c.sources[n.source],I=A&&ii(A.type);A?I!=="raster-dem"&&w.push(new zt(s,n.source,`terrain cannot be used with a source of type ${String(I)}, it only be used with a "raster-dem" source type`)):w.push(new zt(s,n.source,`source "${n.source}" not found`))}else w.push(new zt(s,n,'terrain is missing required property "source"'));return w}function fa(i){const n=i.value,s=i.style,c=i.styleSpec,f=c.fog;let y=[];const w=Qn(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new zt("fog",n,`object expected, ${w} found`)]),y;for(const E in n){const A=E.match(/^(.*)-transition$/);y=y.concat(A&&f[A[1]]&&f[A[1]].transition?Wn({key:E,value:n[E],valueSpec:c.transition,style:s,styleSpec:c}):f[E]?Wn({key:E,value:n[E],valueSpec:f[E],style:s,styleSpec:c}):[new zt(E,n[E],`unknown property "${E}"`)])}return y}const Rr={"*":()=>[],array:xl,boolean:function(i){const n=i.value,s=i.key,c=Qn(n);return c!=="boolean"?[new zt(s,n,`boolean expected, ${c} found`)]:[]},number:fc,color:function(i){const n=i.key,s=i.value,c=Qn(s);return c!=="string"?[new zt(n,s,`color expected, ${c} found`)]:eu(s)===null?[new zt(n,s,`color expected, "${s}" found`)]:[]},enum:vl,filter:Es,function:vu,layer:Cp,object:Ss,source:wl,light:bd,terrain:za,fog:fa,string:Cs,formatted:function(i){return Cs(i).length===0?[]:Di(i)},resolvedImage:function(i){return Cs(i).length===0?[]:Di(i)},projection:function(i){const n=i.value,s=i.styleSpec,c=s.projection,f=i.style;let y=[];const w=Qn(n);if(w==="object")for(const E in n)y=y.concat(Wn({key:E,value:n[E],valueSpec:c[E],style:f,styleSpec:s}));else w!=="string"&&(y=y.concat([new zt("projection",n,`object or string expected, ${w} found`)]));return y}};function Wn(i){const n=i.value,s=i.valueSpec,c=i.styleSpec;return s.expression&&uc(ii(n))?vu(i):s.expression&&_l(Pi(n))?Di(i):s.type&&Rr[s.type]?Rr[s.type](i):Ss(bi({},i,{valueSpec:s.type?c[s.type]:s}))}function Ba(i){const n=i.value,s=i.key,c=Cs(i);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new zt(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new zt(s,n,'"glyphs" url must include a "{range}" token'))),c}function $i(i,n=pt){return Gi(Wn({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,objectElementValidators:{glyphs:Ba,"*":()=>[]}}))}const ks=i=>Gi(vd(i)),bl=i=>Gi(nf(i));function Gi(i){return i.slice().sort(((n,s)=>n.line&&s.line?n.line-s.line:0))}function ls(i,n){let s=!1;if(n&&n.length)for(const c of n)i.fire(new eo(new Error(c.message))),s=!0;return s}var Td=Co,lo=3;function Co(i,n,s){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var f=new Int32Array(this.arrayBuffer);i=f[0],this.d=(n=f[1])+2*(s=f[2]);for(var y=0;y<this.d*this.d;y++){var w=f[lo+y],E=f[lo+y+1];c.push(w===E?null:f.subarray(w,E))}var A=f[lo+c.length+1];this.keys=f.subarray(f[lo+c.length],A),this.bboxes=f.subarray(A),this.insert=this._insertReadonly}else{this.d=n+2*s;for(var I=0;I<this.d*this.d;I++)c.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=i,this.padding=s,this.scale=n/i,this.uid=0;var j=s/n*i;this.min=-j,this.max=i+j}Co.prototype.insert=function(i,n,s,c,f){this._forEachCell(n,s,c,f,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f)},Co.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},Co.prototype._insertCell=function(i,n,s,c,f,y){this.cells[f].push(y)},Co.prototype.query=function(i,n,s,c,f){var y=this.min,w=this.max;if(i<=y&&n<=y&&w<=s&&w<=c&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(i,n,s,c,this._queryCell,E,{},f),E},Co.prototype._queryCell=function(i,n,s,c,f,y,w,E){var A=this.cells[f];if(A!==null)for(var I=this.keys,j=this.bboxes,V=0;V<A.length;V++){var U=A[V];if(w[U]===void 0){var q=4*U;(E?E(j[q+0],j[q+1],j[q+2],j[q+3]):i<=j[q+2]&&n<=j[q+3]&&s>=j[q+0]&&c>=j[q+1])?(w[U]=!0,y.push(I[U])):w[U]=!1}}},Co.prototype._forEachCell=function(i,n,s,c,f,y,w,E){for(var A=this._convertToCellCoord(i),I=this._convertToCellCoord(n),j=this._convertToCellCoord(s),V=this._convertToCellCoord(c),U=A;U<=j;U++)for(var q=I;q<=V;q++){var X=this.d*q+U;if((!E||E(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&f.call(this,i,n,s,c,X,y,w,E))return}},Co.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},Co.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},Co.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,n=lo+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var f=new Int32Array(n+s+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var y=n,w=0;w<i.length;w++){var E=i[w];f[lo+w]=y,f.set(E,y),y+=E.length}return f[lo+i.length]=y,f.set(this.keys,y),f[lo+i.length+1]=y+=this.keys.length,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer};var Zo=pe(Td);const bu={};function Ft(i,n,s={}){Object.defineProperty(i,"_classRegistryKey",{value:n,writeable:!1}),bu[n]={klass:i,omit:s.omit||[]}}Ft(Object,"Object"),Zo.serialize=function(i,n){const s=i.toArrayBuffer();return n&&n.push(s),{buffer:s}},Zo.deserialize=function(i){return new Zo(i.buffer)},Object.defineProperty(Zo,"name",{value:"Grid"}),Ft(Zo,"Grid"),Ft(_r,"Color"),Ft(Error,"Error"),Ft(os,"AJAXError"),Ft(ro,"ResolvedImage"),Ft(xu,"StylePropertyFunction"),Ft(yu,"StyleExpression",{omit:["_evaluator"]}),Ft(ja,"ZoomDependentExpression"),Ft(_u,"ZoomConstantExpression"),Ft(so,"CompoundExpression",{omit:["_evaluate"]});for(const i in cc)bu[cc[i]._classRegistryKey]||Ft(cc[i],`Expression${i}`);function vc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Tu(i){return k.ImageBitmap&&i instanceof k.ImageBitmap}function Tl(i,n){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(vc(i)||Tu(i))return n&&n.push(i),i;if(ArrayBuffer.isView(i)){const s=i;return n&&n.push(s.buffer),s}if(i instanceof k.ImageData)return n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const s=[];for(const c of i)s.push(Tl(c,n));return s}if(typeof i=="object"){const s=i.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=s.serialize?s.serialize(i,n):{};if(!s.serialize){for(const y in i)i.hasOwnProperty(y)&&(bu[c].omit.indexOf(y)>=0||(f[y]=Tl(i[y],n)));i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof i)}function Sl(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||vc(i)||Tu(i)||ArrayBuffer.isView(i)||i instanceof k.ImageData)return i;if(Array.isArray(i))return i.map(Sl);if(typeof i=="object"){const n=i.$name||"Object",{klass:s}=bu[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(i);const c=Object.create(s.prototype);for(const f of Object.keys(i))f!=="$name"&&(c[f]=Sl(i[f]));return c}throw new Error("can't deserialize object of type "+typeof i)}const Ot={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Fa(i){for(const n of i)if(bc(n.charCodeAt(0)))return!0;return!1}function wc(i){for(const n of i)if(!Su(n.charCodeAt(0)))return!1;return!0}function Su(i){return!(Ot.Arabic(i)||Ot["Arabic Supplement"](i)||Ot["Arabic Extended-A"](i)||Ot["Arabic Presentation Forms-A"](i)||Ot["Arabic Presentation Forms-B"](i))}function bc(i){return!(i!==746&&i!==747&&(i<4352||!(Ot["Bopomofo Extended"](i)||Ot.Bopomofo(i)||Ot["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ot["CJK Compatibility Ideographs"](i)||Ot["CJK Compatibility"](i)||Ot["CJK Radicals Supplement"](i)||Ot["CJK Strokes"](i)||!(!Ot["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ot["CJK Unified Ideographs Extension A"](i)||Ot["CJK Unified Ideographs"](i)||Ot["Enclosed CJK Letters and Months"](i)||Ot["Hangul Compatibility Jamo"](i)||Ot["Hangul Jamo Extended-A"](i)||Ot["Hangul Jamo Extended-B"](i)||Ot["Hangul Jamo"](i)||Ot["Hangul Syllables"](i)||Ot.Hiragana(i)||Ot["Ideographic Description Characters"](i)||Ot.Kanbun(i)||Ot["Kangxi Radicals"](i)||Ot["Katakana Phonetic Extensions"](i)||Ot.Katakana(i)&&i!==12540||!(!Ot["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ot["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ot["Unified Canadian Aboriginal Syllabics"](i)||Ot["Unified Canadian Aboriginal Syllabics Extended"](i)||Ot["Vertical Forms"](i)||Ot["Yijing Hexagram Symbols"](i)||Ot["Yi Syllables"](i)||Ot["Yi Radicals"](i))))}function Vs(i){return!(bc(i)||(function(n){return!!(Ot["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ot["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ot["Letterlike Symbols"](n)||Ot["Number Forms"](n)||Ot["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ot["Control Pictures"](n)&&n!==9251||Ot["Optical Character Recognition"](n)||Ot["Enclosed Alphanumerics"](n)||Ot["Geometric Shapes"](n)||Ot["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ot["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ot["CJK Symbols and Punctuation"](n)||Ot.Katakana(n)||Ot["Private Use Area"](n)||Ot["CJK Compatibility Forms"](n)||Ot["Small Form Variants"](n)||Ot["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(i))}function Us(i){return i>=1424&&i<=2303||Ot["Arabic Presentation Forms-A"](i)||Ot["Arabic Presentation Forms-B"](i)}function El(i,n){return!(!n&&Us(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ot.Khmer(i))}function pa(i){for(const n of i)if(Us(n.charCodeAt(0)))return!0;return!1}const ko="deferred",ma="loading",Sd="loaded";let Va=null,g="unavailable",o=null;const h=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(g="error"),Va&&Va(i)};function x(){T.fire(new ka("pluginStateChange",{pluginStatus:g,pluginURL:o}))}const T=new vs,C=function(){return g},R=function(){if(g!==ko||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");g=ma,x(),o&&Js({url:o},(i=>{i?h(i):(g=Sd,x())}))},D={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>g===Sd||D.applyArabicShaping!=null,isLoading:()=>g===ma,setState(i){g=i.pluginStatus,o=i.pluginURL},isParsed:()=>D.applyArabicShaping!=null&&D.processBidirectionalText!=null&&D.processStyledBidirectionalText!=null,getPluginURL:()=>o};class B{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(n){return(function(s,c){for(const f of s)if(!El(f.charCodeAt(0),c))return!1;return!0})(n,D.isLoaded())}}class G{constructor(n,s){this.property=n,this.value=s,this.expression=(function(c,f){if(uc(c))return new xu(c,f);if(_l(c)){const y=ua(c,f);if(y.result==="error")throw new Error(y.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return y.value}{let y=c;return typeof c=="string"&&f.type==="color"&&(y=_r.parse(c)),{kind:"constant",evaluate:()=>y}}})(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,c){return this.property.possiblyEvaluate(this,n,s,c)}}class ${constructor(n){this.property=n,this.value=new G(n,void 0)}transitioned(n,s){return new oe(this.property,this.value,s,Tt({},n.transition,this.transition),n.now)}untransitioned(){return new oe(this.property,this.value,null,{},0)}}class J{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return Xn(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new $(this._values[n].property)),this._values[n].value=new G(this._values[n].property,s===null?void 0:Xn(s))}getTransition(n){return Xn(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new $(this._values[n].property)),this._values[n].transition=Xn(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c);const f=this.getTransition(s);f!==void 0&&(n[`${s}-transition`]=f)}return n}transitioned(n,s){const c=new ce(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(n,s._values[f]);return c}untransitioned(){const n=new ce(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class oe{constructor(n,s,c,f,y){const w=f.delay||0,E=f.duration||0;y=y||0,this.property=n,this.value=s,this.begin=y+w,this.end=this.begin+E,n.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(n,s,c){const f=n.now||0,y=this.value.possiblyEvaluate(n,s,c),w=this.prior;if(w){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return w.possiblyEvaluate(n,s,c);{const E=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(n,s,c),y,st(E))}}return y}}class ce{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,c){const f=new me(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(n,s,c);return f}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class he{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return Xn(this._values[n].value)}setValue(n,s){this._values[n]=new G(this._values[n].property,s===null?void 0:Xn(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c)}return n}possiblyEvaluate(n,s,c){const f=new me(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(n,s,c);return f}}class de{constructor(n,s,c){this.property=n,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,c,f){return this.property.evaluate(this.value,this.parameters,n,s,c,f)}}class me{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Q{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,c){const f=au[this.specification.type];return f?f(n,s,c):n}}class le{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,c,f){return new de(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},c,f)}:n.expression,s)}interpolate(n,s,c){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new de(this,{kind:"constant",value:void 0},n.parameters);const f=au[this.specification.type];return f?new de(this,{kind:"constant",value:f(n.value.value,s.value.value,c)},n.parameters):n}evaluate(n,s,c,f,y,w){return n.kind==="constant"?n.value:n.evaluate(s,c,f,y,w)}}class _e{constructor(n){this.specification=n}possiblyEvaluate(n,s,c,f){return!!n.expression.evaluate(s,null,{},c,f)}interpolate(){return!1}}class ve{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new B(0,{});for(const c in n){const f=n[c];f.specification.overridable&&this.overridableProperties.push(c);const y=this.defaultPropertyValues[c]=new G(f,void 0),w=this.defaultTransitionablePropertyValues[c]=new $(f);this.defaultTransitioningPropertyValues[c]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=y.possiblyEvaluate(s)}}}function Ne(i,n){return 256*(i=Se(Math.floor(i),0,255))+Se(Math.floor(n),0,255)}Ft(le,"DataDrivenProperty"),Ft(Q,"DataConstantProperty"),Ft(_e,"ColorRampProperty");const De={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Re{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class Ge{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function $e(i,n=1){let s=0,c=0;return{members:i.map((f=>{const y=De[f.type].BYTES_PER_ELEMENT,w=s=Ye(s,Math.max(n,y)),E=f.components||1;return c=Math.max(c,y),s+=y*E,{name:f.name,type:f.type,components:E,offset:w}})),size:Ye(s,Math.max(c,n)),alignment:n}}function Ye(i,n){return Math.ceil(i/n)*n}class At extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.int16[f+0]=s,this.int16[f+1]=c,n}}At.prototype.bytesPerElement=4,Ft(At,"StructArrayLayout2i4");class qe extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.int16[y+0]=s,this.int16[y+1]=c,this.int16[y+2]=f,n}}qe.prototype.bytesPerElement=6,Ft(qe,"StructArrayLayout3i6");class ct extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.int16[w+0]=s,this.int16[w+1]=c,this.int16[w+2]=f,this.int16[w+3]=y,n}}ct.prototype.bytesPerElement=8,Ft(ct,"StructArrayLayout4i8");class Je extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,f,y,w,E)}emplace(n,s,c,f,y,w,E,A){const I=6*n,j=12*n,V=3*n;return this.int16[I+0]=s,this.int16[I+1]=c,this.uint8[j+4]=f,this.uint8[j+5]=y,this.uint8[j+6]=w,this.uint8[j+7]=E,this.float32[V+2]=A,n}}Je.prototype.bytesPerElement=12,Ft(Je,"StructArrayLayout2i4ub1f12");class Ct extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.float32[w+0]=s,this.float32[w+1]=c,this.float32[w+2]=f,this.float32[w+3]=y,n}}Ct.prototype.bytesPerElement=16,Ft(Ct,"StructArrayLayout4f16");class Ke extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=6*n,A=3*n;return this.uint16[E+0]=s,this.uint16[E+1]=c,this.uint16[E+2]=f,this.uint16[E+3]=y,this.float32[A+2]=w,n}}Ke.prototype.bytesPerElement=12,Ft(Ke,"StructArrayLayout4ui1f12");class dt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.uint16[w+0]=s,this.uint16[w+1]=c,this.uint16[w+2]=f,this.uint16[w+3]=y,n}}dt.prototype.bytesPerElement=8,Ft(dt,"StructArrayLayout4ui8");class St extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,f,y,w)}emplace(n,s,c,f,y,w,E){const A=6*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=f,this.int16[A+3]=y,this.int16[A+4]=w,this.int16[A+5]=E,n}}St.prototype.bytesPerElement=12,Ft(St,"StructArrayLayout6i12");class wt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U){const q=this.length;return this.resize(q+1),this.emplace(q,n,s,c,f,y,w,E,A,I,j,V,U)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q){const X=12*n;return this.int16[X+0]=s,this.int16[X+1]=c,this.int16[X+2]=f,this.int16[X+3]=y,this.uint16[X+4]=w,this.uint16[X+5]=E,this.uint16[X+6]=A,this.uint16[X+7]=I,this.int16[X+8]=j,this.int16[X+9]=V,this.int16[X+10]=U,this.int16[X+11]=q,n}}wt.prototype.bytesPerElement=24,Ft(wt,"StructArrayLayout4i4ui4i24");class It extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,f,y,w)}emplace(n,s,c,f,y,w,E){const A=10*n,I=5*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=f,this.float32[I+2]=y,this.float32[I+3]=w,this.float32[I+4]=E,n}}It.prototype.bytesPerElement=20,Ft(It,"StructArrayLayout3i3f20");class en extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}en.prototype.bytesPerElement=4,Ft(en,"StructArrayLayout1ul4");class _n extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q){const X=this.length;return this.resize(X+1),this.emplace(X,n,s,c,f,y,w,E,A,I,j,V,U,q)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=20*n,ae=10*n;return this.int16[te+0]=s,this.int16[te+1]=c,this.int16[te+2]=f,this.int16[te+3]=y,this.int16[te+4]=w,this.float32[ae+3]=E,this.float32[ae+4]=A,this.float32[ae+5]=I,this.float32[ae+6]=j,this.int16[te+14]=V,this.uint32[ae+8]=U,this.uint16[te+18]=q,this.uint16[te+19]=X,n}}_n.prototype.bytesPerElement=40,Ft(_n,"StructArrayLayout5i4f1i1ul2ui40");class Wt extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,f,y,w,E)}emplace(n,s,c,f,y,w,E,A){const I=8*n;return this.int16[I+0]=s,this.int16[I+1]=c,this.int16[I+2]=f,this.int16[I+4]=y,this.int16[I+5]=w,this.int16[I+6]=E,this.int16[I+7]=A,n}}Wt.prototype.bytesPerElement=16,Ft(Wt,"StructArrayLayout3i2i2i16");class dn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=4*n,A=8*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=f,this.int16[A+6]=y,this.int16[A+7]=w,n}}dn.prototype.bytesPerElement=16,Ft(dn,"StructArrayLayout2f1f2i16");class jn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=12*n,E=3*n;return this.uint8[w+0]=s,this.uint8[w+1]=c,this.float32[E+1]=f,this.float32[E+2]=y,n}}jn.prototype.bytesPerElement=12,Ft(jn,"StructArrayLayout2ub2f12");class Fn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=f,n}}Fn.prototype.bytesPerElement=12,Ft(Fn,"StructArrayLayout3f12");class tn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.uint16[y+0]=s,this.uint16[y+1]=c,this.uint16[y+2]=f,n}}tn.prototype.bytesPerElement=6,Ft(tn,"StructArrayLayout3ui6");class Gn extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe){const Me=this.length;return this.resize(Me+1),this.emplace(Me,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe,Me){const Qe=30*n,Xe=15*n,mt=60*n;return this.int16[Qe+0]=s,this.int16[Qe+1]=c,this.int16[Qe+2]=f,this.float32[Xe+2]=y,this.float32[Xe+3]=w,this.uint16[Qe+8]=E,this.uint16[Qe+9]=A,this.uint32[Xe+5]=I,this.uint32[Xe+6]=j,this.uint32[Xe+7]=V,this.uint16[Qe+16]=U,this.uint16[Qe+17]=q,this.uint16[Qe+18]=X,this.float32[Xe+10]=te,this.float32[Xe+11]=ae,this.uint8[mt+48]=ge,this.uint8[mt+49]=ke,this.uint8[mt+50]=ye,this.uint32[Xe+13]=Ee,this.int16[Qe+28]=Pe,this.uint8[mt+58]=Me,n}}Gn.prototype.bytesPerElement=60,Ft(Gn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class ar extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t,kt){const Nt=this.length;return this.resize(Nt+1),this.emplace(Nt,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t,kt)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,ke,ye,Ee,Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t,kt,Nt){const ht=38*n,Bt=19*n;return this.int16[ht+0]=s,this.int16[ht+1]=c,this.int16[ht+2]=f,this.float32[Bt+2]=y,this.float32[Bt+3]=w,this.int16[ht+8]=E,this.int16[ht+9]=A,this.int16[ht+10]=I,this.int16[ht+11]=j,this.int16[ht+12]=V,this.int16[ht+13]=U,this.uint16[ht+14]=q,this.uint16[ht+15]=X,this.uint16[ht+16]=te,this.uint16[ht+17]=ae,this.uint16[ht+18]=ge,this.uint16[ht+19]=ke,this.uint16[ht+20]=ye,this.uint16[ht+21]=Ee,this.uint16[ht+22]=Pe,this.uint16[ht+23]=Me,this.uint16[ht+24]=Qe,this.uint16[ht+25]=Xe,this.uint16[ht+26]=mt,this.uint16[ht+27]=Mt,this.uint16[ht+28]=rt,this.uint32[Bt+15]=yt,this.float32[Bt+16]=_t,this.float32[Bt+17]=kt,this.float32[Bt+18]=Nt,n}}ar.prototype.bytesPerElement=76,Ft(ar,"StructArrayLayout3i2f6i15ui1ul3f76");class lr extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}lr.prototype.bytesPerElement=4,Ft(lr,"StructArrayLayout1f4");class rr extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=5*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=f,this.float32[E+3]=y,this.float32[E+4]=w,n}}rr.prototype.bytesPerElement=20,Ft(rr,"StructArrayLayout5f20");class Li extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=6*n;return this.uint32[3*n+0]=s,this.uint16[w+2]=c,this.uint16[w+3]=f,this.uint16[w+4]=y,n}}Li.prototype.bytesPerElement=12,Ft(Li,"StructArrayLayout1ul3ui12");class $r extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.uint16[f+0]=s,this.uint16[f+1]=c,n}}$r.prototype.bytesPerElement=4,Ft($r,"StructArrayLayout2ui4");class $s extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}$s.prototype.bytesPerElement=2,Ft($s,"StructArrayLayout1ui2");class co extends Ge{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.float32[f+0]=s,this.float32[f+1]=c,n}}co.prototype.bytesPerElement=8,Ft(co,"StructArrayLayout2f8");class In extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}In.prototype.size=40;class pr extends _n{get(n){return new In(this,n)}}Ft(pr,"CollisionBoxArray");class er extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}er.prototype.size=60;class Gr extends Gn{get(n){return new er(this,n)}}Ft(Gr,"PlacedSymbolArray");class ji extends Re{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}ji.prototype.size=76;class xr extends ar{get(n){return new ji(this,n)}}Ft(xr,"SymbolInstanceArray");class hi extends lr{getoffsetX(n){return this.float32[1*n+0]}}Ft(hi,"GlyphOffsetArray");class Dr extends At{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Ft(Dr,"SymbolLineVertexArray");class Or extends Re{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Or.prototype.size=12;class Kr extends Li{get(n){return new Or(this,n)}}Ft(Kr,"FeatureIndexArray");class uo extends $r{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Ft(uo,"FillExtrusionCentroidArray");const ho=$e([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ao=$e([{name:"a_dash",components:4,type:"Uint16"}]);var Ed={exports:{}},fi={exports:{}};fi.exports=function(i,n){var s,c,f,y,w,E,A,I;for(c=i.length-(s=3&i.length),f=n,w=3432918353,E=461845907,I=0;I<c;)A=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,f=27492+(65535&(y=5*(65535&(f=(f^=A=(65535&(A=(A=(65535&A)*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(A=0,s){case 3:A^=(255&i.charCodeAt(I+2))<<16;case 2:A^=(255&i.charCodeAt(I+1))<<8;case 1:f^=A=(65535&(A=(A=(65535&(A^=255&i.charCodeAt(I)))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Eu=fi.exports,kp={exports:{}};kp.exports=function(i,n){for(var s,c=i.length,f=n^c,y=0;c>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++y;switch(c){case 3:f^=(255&i.charCodeAt(y+2))<<16;case 2:f^=(255&i.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var Ap=Eu,Ua=kp.exports;Ed.exports=Ap,Ed.exports.murmur3=Ap,Ed.exports.murmur2=Ua;var fo=pe(Ed.exports);class Tc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,c,f){this.ids.push(Ip(n)),this.positions.push(s,c,f)}getPositions(n){const s=Ip(n);let c=0,f=this.ids.length-1;for(;c<f;){const w=c+f>>1;this.ids[w]>=s?f=w:c=w+1}const y=[];for(;this.ids[c]===s;)y.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return y}static serialize(n,s){const c=new Float64Array(n.ids),f=new Uint32Array(n.positions);return rf(c,f,0,c.length-1),s&&s.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(n){const s=new Tc;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function Ip(i){const n=+i;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:fo(String(i))}function rf(i,n,s,c){for(;s<c;){const f=i[s+c>>1];let y=s-1,w=c+1;for(;;){do y++;while(i[y]<f);do w--;while(i[w]>f);if(y>=w)break;sf(i,y,w),sf(n,3*y,3*w),sf(n,3*y+1,3*w+1),sf(n,3*y+2,3*w+2)}w-s<c-w?(rf(i,n,s,w),s=w+1):(rf(i,n,w+1,c),c=w)}}function sf(i,n,s){const c=i[n];i[n]=i[s],i[s]=c}Ft(Tc,"FeaturePositionMap");class $a{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}}class of extends $a{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class cg extends $a{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class ug extends $a{constructor(n){super(n),this.current=_r.transparent}set(n,s,c){this.fetchUniformLocation(n,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const w_=new Float32Array(16),b_=new Float32Array(9),T_=new Float32Array(4);function Cu(i){return[Ne(255*i.r,255*i.g),Ne(255*i.b,255*i.a)]}class Cd{constructor(n,s,c){this.value=n,this.uniformNames=s.map((f=>`u_${f}`)),this.type=c}setUniform(n,s,c,f,y){s.set(n,y,f.constantOr(this.value))}getBinding(n,s){return this.type==="color"?new ug(n):new of(n)}}class Cl{constructor(n,s){this.uniformNames=s.map((c=>`u_${c}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,c,f,y){const w=y==="u_pattern"||y==="u_dash"?this.pattern:y==="u_pixel_ratio"?this.pixelRatio:null;w&&s.set(n,y,w)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new cg(n):new of(n)}}class Xo{constructor(n,s,c,f){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map((y=>({name:`a_${y}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(n,s,c,f,y,w){const E=this.paintVertexArray.length,A=this.expression.evaluate(new B(0),s,{},y,f,w);this.paintVertexArray.resize(n),this._setPaintValue(E,n,A)}updatePaintArray(n,s,c,f,y){const w=this.expression.evaluate({zoom:0},c,f,void 0,y);this._setPaintValue(n,s,w)}_setPaintValue(n,s,c){if(this.type==="color"){const f=Cu(c);for(let y=n;y<s;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=n;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Ko{constructor(n,s,c,f,y,w){this.expression=n,this.uniformNames=s.map((E=>`u_${E}_t`)),this.type=c,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map((E=>({name:`a_${E}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new w}populatePaintArray(n,s,c,f,y,w){const E=this.expression.evaluate(new B(this.zoom),s,{},y,f,w),A=this.expression.evaluate(new B(this.zoom+1),s,{},y,f,w),I=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(I,n,E,A)}updatePaintArray(n,s,c,f,y){const w=this.expression.evaluate({zoom:this.zoom},c,f,void 0,y),E=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,y);this._setPaintValue(n,s,w,E)}_setPaintValue(n,s,c,f){if(this.type==="color"){const y=Cu(c),w=Cu(f);for(let E=n;E<s;E++)this.paintVertexArray.emplace(E,y[0],y[1],w[0],w[1])}else{for(let y=n;y<s;y++)this.paintVertexArray.emplace(y,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,c,f,y){const w=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,E=Se(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);s.set(n,y,E)}getBinding(n,s){return new of(n)}}class Ga{constructor(n,s,c,f,y){this.expression=n,this.layerId=y,this.paintVertexAttributes=(c==="array"?Ao:ho).members;for(let w=0;w<s.length;++w);this.paintVertexArray=new f}populatePaintArray(n,s,c){const f=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(f,n,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(n,s,c,f,y,w){this._setPaintValues(n,s,c.patterns&&c.patterns[this.layerId],w)}_setPaintValues(n,s,c,f){if(!f||!c)return;const y=f[c];if(!y)return;const{tl:w,br:E,pixelRatio:A}=y;for(let I=n;I<s;I++)this.paintVertexArray.emplace(I,w[0],w[1],E[0],E[1],A)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kl{constructor(n,s,c=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const y in n.paint._values){if(!c(y))continue;const w=n.paint.get(y);if(!(w instanceof de&&yl(w.property.specification)))continue;const E=E_(y,n.type),A=w.value,I=w.property.specification.type,j=!!w.property.useIntegerZoom,V=y==="line-dasharray"||y.endsWith("pattern"),U=y==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||U)if(A.kind==="source"||U||V){const q=hg(y,I,"source");this.binders[y]=V?new Ga(A,E,I,q,n.id):new Xo(A,E,I,q),f.push(`/a_${y}`)}else{const q=hg(y,I,"composite");this.binders[y]=new Ko(A,E,I,j,s,q),f.push(`/z_${y}`)}else this.binders[y]=V?new Cl(A.value,E):new Cd(A.value,E,I),f.push(`/u_${y}`)}this.cacheKey=f.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Xo||s instanceof Ko?s.maxValue:0}populatePaintArrays(n,s,c,f,y,w){for(const E in this.binders){const A=this.binders[E];(A instanceof Xo||A instanceof Ko||A instanceof Ga)&&A.populatePaintArray(n,s,c,f,y,w)}}setConstantPatternPositions(n){for(const s in this.binders){const c=this.binders[s];c instanceof Cl&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,s,c,f,y,w){let E=!1;for(const A in n){const I=s.getPositions(A);for(const j of I){const V=c.feature(j.index);for(const U in this.binders){const q=this.binders[U];if((q instanceof Xo||q instanceof Ko||q instanceof Ga)&&q.expression.isStateDependent===!0){const X=f.paint.get(U);q.expression=X.value,q.updatePaintArray(j.start,j.end,V,n[A],y,w),E=!0}}}}return E}defines(){const n=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Cd||c instanceof Cl)&&n.push(...c.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Xo||c instanceof Ko||c instanceof Ga)for(let f=0;f<c.paintVertexAttributes.length;f++)n.push(c.paintVertexAttributes[f].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Cd||c instanceof Cl||c instanceof Ko)for(const f of c.uniformNames)n.push(f)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Cd||f instanceof Cl||f instanceof Ko)for(const y of f.uniformNames)s.push({name:y,property:c,binding:f.getBinding(n,y)})}return s}setUniforms(n,s,c,f,y){for(const{name:w,property:E,binding:A}of c)this.binders[E].setUniform(n,A,y,f.get(E),w)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Xo||s instanceof Ko||s instanceof Ga)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const c=this.binders[s];(c instanceof Xo||c instanceof Ko||c instanceof Ga)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Xo||s instanceof Ko||s instanceof Ga)&&s.destroy()}}}class Sc{constructor(n,s,c=(()=>!0)){this.programConfigurations={};for(const f of n)this.programConfigurations[f.id]=new kl(f,s,c);this.needsUpload=!1,this._featureMap=new Tc,this._bufferOffset=0}populatePaintArrays(n,s,c,f,y,w,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(n,s,f,y,w,E);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,c,f,y){for(const w of c)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(n,this._featureMap,s,w,f,y)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const S_={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function E_(i,n){return S_[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}const dg={"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke},"line-dasharray":{source:dt,composite:dt}},C_={color:{source:co,composite:Ct},number:{source:lr,composite:co}};function hg(i,n,s){const c=dg[i];return c&&c[s]||C_[n][s]}Ft(Cd,"ConstantBinder"),Ft(Cl,"PatternConstantBinder"),Ft(Xo,"SourceExpressionBinder"),Ft(Ga,"PatternCompositeBinder"),Ft(Ko,"CompositeExpressionBinder"),Ft(kl,"ProgramConfiguration",{omit:["_buffers"]}),Ft(Sc,"ProgramConfigurationSet");const fg="-transition";class ga extends vs{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new he(s.layout)),s.paint)){this._transitionablePaint=new J(s.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new me(s.paint)}}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,c={}){s!=null&&this._validate(bl,`layers.${this.id}.layout.${n}`,n,s,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return Sn(n,fg)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,c={}){if(s!=null&&this._validate(ks,`layers.${this.id}.paint.${n}`,n,s,c))return!1;if(Sn(n,fg))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const f=this._transitionablePaint._values[n],y=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const E=this._transitionablePaint._values[n].value,A=E.isDataDriven(),I=Sn(n,"pattern")||n==="line-dasharray";return A||y||I||this._handleOverridablePaintPropertyUpdate(n,w,E)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,s,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),nr(n,((s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length)))}_validate(n,s,c,f,y={}){return(!y||y.validate!==!1)&&ls(this,n.call($i,{key:s,layerType:this.type,objectKey:c,value:f,styleSpec:pt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof de&&yl(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=gc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const k_=$e([{name:"a_pos",components:2,type:"Int16"}],4),w0=$e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class si{constructor(n=[]){this.segments=n}prepareSegment(n,s,c,f){let y=this.segments[this.segments.length-1];return n>si.MAX_VERTEX_ARRAY_LENGTH&&Kn(`Max vertices per segment is ${si.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>si.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,c,f){return new si([{vertexOffset:n,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}si.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft(si,"SegmentVector");var ln=8192;class Al{constructor(n,s){n&&(s?this.setSouthWest(n).setNorthEast(s):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof hn?new hn(n.lng,n.lat):hn.convert(n),this}setSouthWest(n){return this._sw=n instanceof hn?new hn(n.lng,n.lat):hn.convert(n),this}extend(n){const s=this._sw,c=this._ne;let f,y;if(n instanceof hn)f=n,y=n;else{if(!(n instanceof Al))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Al.convert(n)):this.extend(hn.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(hn.convert(n)):this;if(f=n._sw,y=n._ne,!f||!y)return this}return s||c?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new hn(f.lng,f.lat),this._ne=new hn(y.lng,y.lat)),this}getCenter(){return new hn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new hn(this.getWest(),this.getNorth())}getSouthEast(){return new hn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:c}=hn.convert(n);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(n){return!n||n instanceof Al?n:new Al(n)}}var af=1e-6,cs=typeof Float32Array<"u"?Float32Array:Array;function A_(){var i=new cs(9);return cs!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function I_(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=s[0],q=s[1],X=s[2],te=s[3],ae=s[4],ge=s[5],ke=s[6],ye=s[7],Ee=s[8];return i[0]=U*c+q*w+X*I,i[1]=U*f+q*E+X*j,i[2]=U*y+q*A+X*V,i[3]=te*c+ae*w+ge*I,i[4]=te*f+ae*E+ge*j,i[5]=te*y+ae*A+ge*V,i[6]=ke*c+ye*w+Ee*I,i[7]=ke*f+ye*E+Ee*j,i[8]=ke*y+ye*A+Ee*V,i}function ya(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function Io(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=n[4],E=n[5],A=n[6],I=n[7],j=n[8],V=n[9],U=n[10],q=n[11],X=n[12],te=n[13],ae=n[14],ge=n[15],ke=s*E-c*w,ye=s*A-f*w,Ee=s*I-y*w,Pe=c*A-f*E,Me=c*I-y*E,Qe=f*I-y*A,Xe=j*te-V*X,mt=j*ae-U*X,Mt=j*ge-q*X,rt=V*ae-U*te,yt=V*ge-q*te,_t=U*ge-q*ae,kt=ke*_t-ye*yt+Ee*rt+Pe*Mt-Me*mt+Qe*Xe;return kt?(i[0]=(E*_t-A*yt+I*rt)*(kt=1/kt),i[1]=(f*yt-c*_t-y*rt)*kt,i[2]=(te*Qe-ae*Me+ge*Pe)*kt,i[3]=(U*Me-V*Qe-q*Pe)*kt,i[4]=(A*Mt-w*_t-I*mt)*kt,i[5]=(s*_t-f*Mt+y*mt)*kt,i[6]=(ae*Ee-X*Qe-ge*ye)*kt,i[7]=(j*Qe-U*Ee+q*ye)*kt,i[8]=(w*yt-E*Mt+I*Xe)*kt,i[9]=(c*Mt-s*yt-y*Xe)*kt,i[10]=(X*Me-te*Ee+ge*ke)*kt,i[11]=(V*Ee-j*Me-q*ke)*kt,i[12]=(E*mt-w*rt-A*Xe)*kt,i[13]=(s*rt-c*mt+f*Xe)*kt,i[14]=(te*ye-X*Pe-ae*ke)*kt,i[15]=(j*Pe-V*ye+U*ke)*kt,i):null}function Il(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=n[9],q=n[10],X=n[11],te=n[12],ae=n[13],ge=n[14],ke=n[15],ye=s[0],Ee=s[1],Pe=s[2],Me=s[3];return i[0]=ye*c+Ee*E+Pe*V+Me*te,i[1]=ye*f+Ee*A+Pe*U+Me*ae,i[2]=ye*y+Ee*I+Pe*q+Me*ge,i[3]=ye*w+Ee*j+Pe*X+Me*ke,i[4]=(ye=s[4])*c+(Ee=s[5])*E+(Pe=s[6])*V+(Me=s[7])*te,i[5]=ye*f+Ee*A+Pe*U+Me*ae,i[6]=ye*y+Ee*I+Pe*q+Me*ge,i[7]=ye*w+Ee*j+Pe*X+Me*ke,i[8]=(ye=s[8])*c+(Ee=s[9])*E+(Pe=s[10])*V+(Me=s[11])*te,i[9]=ye*f+Ee*A+Pe*U+Me*ae,i[10]=ye*y+Ee*I+Pe*q+Me*ge,i[11]=ye*w+Ee*j+Pe*X+Me*ke,i[12]=(ye=s[12])*c+(Ee=s[13])*E+(Pe=s[14])*V+(Me=s[15])*te,i[13]=ye*f+Ee*A+Pe*U+Me*ae,i[14]=ye*y+Ee*I+Pe*q+Me*ge,i[15]=ye*w+Ee*j+Pe*X+Me*ke,i}function Ec(i,n,s){var c,f,y,w,E,A,I,j,V,U,q,X,te=s[0],ae=s[1],ge=s[2];return n===i?(i[12]=n[0]*te+n[4]*ae+n[8]*ge+n[12],i[13]=n[1]*te+n[5]*ae+n[9]*ge+n[13],i[14]=n[2]*te+n[6]*ae+n[10]*ge+n[14],i[15]=n[3]*te+n[7]*ae+n[11]*ge+n[15]):(f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=n[9],q=n[10],X=n[11],i[0]=c=n[0],i[1]=f,i[2]=y,i[3]=w,i[4]=E,i[5]=A,i[6]=I,i[7]=j,i[8]=V,i[9]=U,i[10]=q,i[11]=X,i[12]=c*te+E*ae+V*ge+n[12],i[13]=f*te+A*ae+U*ge+n[13],i[14]=y*te+I*ae+q*ge+n[14],i[15]=w*te+j*ae+X*ge+n[15]),i}function Cc(i,n,s){var c=s[0],f=s[1],y=s[2];return i[0]=n[0]*c,i[1]=n[1]*c,i[2]=n[2]*c,i[3]=n[3]*c,i[4]=n[4]*f,i[5]=n[5]*f,i[6]=n[6]*f,i[7]=n[7]*f,i[8]=n[8]*y,i[9]=n[9]*y,i[10]=n[10]*y,i[11]=n[11]*y,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}function Mp(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[4],w=n[5],E=n[6],A=n[7],I=n[8],j=n[9],V=n[10],U=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=y*f+I*c,i[5]=w*f+j*c,i[6]=E*f+V*c,i[7]=A*f+U*c,i[8]=I*f-y*c,i[9]=j*f-w*c,i[10]=V*f-E*c,i[11]=U*f-A*c,i}function lf(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[0],w=n[1],E=n[2],A=n[3],I=n[8],j=n[9],V=n[10],U=n[11];return n!==i&&(i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*f-I*c,i[1]=w*f-j*c,i[2]=E*f-V*c,i[3]=A*f-U*c,i[8]=y*c+I*f,i[9]=w*c+j*f,i[10]=E*c+V*f,i[11]=A*c+U*f,i}function Pp(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ku(i,n,s){var c,f,y,w=s[0],E=s[1],A=s[2],I=Math.hypot(w,E,A);return I<af?null:(w*=I=1/I,E*=I,A*=I,c=Math.sin(n),f=Math.cos(n),i[0]=w*w*(y=1-f)+f,i[1]=E*w*y+A*c,i[2]=A*w*y-E*c,i[3]=0,i[4]=w*E*y-A*c,i[5]=E*E*y+f,i[6]=A*E*y+w*c,i[7]=0,i[8]=w*A*y+E*c,i[9]=E*A*y-w*c,i[10]=A*A*y+f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var pg=Il;function cf(){var i=new cs(3);return cs!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function M_(i){var n=new cs(3);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n}function kd(i){return Math.hypot(i[0],i[1],i[2])}function Au(i,n,s){var c=new cs(3);return c[0]=i,c[1]=n,c[2]=s,c}function Ha(i,n,s){return i[0]=n[0]+s[0],i[1]=n[1]+s[1],i[2]=n[2]+s[2],i}function Np(i,n,s){return i[0]=n[0]-s[0],i[1]=n[1]-s[1],i[2]=n[2]-s[2],i}function mg(i,n,s){return i[0]=n[0]*s[0],i[1]=n[1]*s[1],i[2]=n[2]*s[2],i}function uf(i,n,s){return i[0]=Math.min(n[0],s[0]),i[1]=Math.min(n[1],s[1]),i[2]=Math.min(n[2],s[2]),i}function Yi(i,n,s){return i[0]=Math.max(n[0],s[0]),i[1]=Math.max(n[1],s[1]),i[2]=Math.max(n[2],s[2]),i}function zr(i,n,s){return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i}function Ad(i,n,s,c){return i[0]=n[0]+s[0]*c,i[1]=n[1]+s[1]*c,i[2]=n[2]+s[2]*c,i}function us(i,n){var s=n[0],c=n[1],f=n[2],y=s*s+c*c+f*f;return y>0&&(y=1/Math.sqrt(y)),i[0]=n[0]*y,i[1]=n[1]*y,i[2]=n[2]*y,i}function Mo(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]}function Rp(i,n,s){var c=n[0],f=n[1],y=n[2],w=s[0],E=s[1],A=s[2];return i[0]=f*A-y*E,i[1]=y*w-c*A,i[2]=c*E-f*w,i}function Hr(i,n,s){var c=n[0],f=n[1],y=n[2],w=s[3]*c+s[7]*f+s[11]*y+s[15];return i[0]=(s[0]*c+s[4]*f+s[8]*y+s[12])/(w=w||1),i[1]=(s[1]*c+s[5]*f+s[9]*y+s[13])/w,i[2]=(s[2]*c+s[6]*f+s[10]*y+s[14])/w,i}function Dp(i,n,s){var c=s[0],f=s[1],y=s[2],w=n[0],E=n[1],A=n[2],I=f*A-y*E,j=y*w-c*A,V=c*E-f*w,U=f*V-y*j,q=y*I-c*V,X=c*j-f*I,te=2*s[3];return j*=te,V*=te,q*=2,X*=2,i[0]=w+(I*=te)+(U*=2),i[1]=E+j+q,i[2]=A+V+X,i}var Id,Po=Np,P_=mg,N_=kd;function Lp(i,n,s){return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=n[3]*s,i}function jp(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=s*s+c*c+f*f+y*y;return w>0&&(w=1/Math.sqrt(w)),i[0]=s*w,i[1]=c*w,i[2]=f*w,i[3]=y*w,i}function kc(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3];return i[0]=s[0]*c+s[4]*f+s[8]*y+s[12]*w,i[1]=s[1]*c+s[5]*f+s[9]*y+s[13]*w,i[2]=s[2]*c+s[6]*f+s[10]*y+s[14]*w,i[3]=s[3]*c+s[7]*f+s[11]*y+s[15]*w,i}function Op(){var i=new cs(4);return cs!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function df(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function R_(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A+w*E,i[1]=f*A+y*E,i[2]=y*A-f*E,i[3]=w*A-c*E,i}function gg(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A-y*E,i[1]=f*A+w*E,i[2]=y*A+c*E,i[3]=w*A-f*E,i}cf(),Id=new cs(4),cs!=Float32Array&&(Id[0]=0,Id[1]=0,Id[2]=0,Id[3]=0);var yg=jp;cf(),Au(1,0,0),Au(0,1,0),Op(),Op(),A_();const D_=$e([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:hf}=D_,Wa=$e([{name:"a_pos_3",components:3,type:"Int16"}]);var ff=$e([{name:"a_pos",type:"Int16",components:2}]);class zp{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,c){const f=Mo(s,this.dir);if(Math.abs(f)<1e-6)return!1;const y=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/f;return c[0]=this.pos[0]+this.dir[0]*y,c[1]=this.pos[1]+this.dir[1]*y,c[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(n,s,c){if((function(q,X){var te=q[0],ae=q[1],ge=q[2],ke=X[0],ye=X[1],Ee=X[2];return Math.abs(te-ke)<=af*Math.max(1,Math.abs(te),Math.abs(ke))&&Math.abs(ae-ye)<=af*Math.max(1,Math.abs(ae),Math.abs(ye))&&Math.abs(ge-Ee)<=af*Math.max(1,Math.abs(ge),Math.abs(Ee))})(this.pos,n)||s===0)return c[0]=c[1]=c[2]=0,!1;const[f,y,w]=this.dir,E=this.pos[0]-n[0],A=this.pos[1]-n[1],I=this.pos[2]-n[2],j=f*f+y*y+w*w,V=2*(E*f+A*y+I*w),U=V*V-4*j*(E*E+A*A+I*I-s*s);if(U<0){const q=Math.max(-V/2,0),X=E+f*q,te=A+y*q,ae=I+w*q,ge=Math.hypot(X,te,ae);return c[0]=X*s/ge,c[1]=te*s/ge,c[2]=ae*s/ge,!1}{const q=(-V-Math.sqrt(U))/(2*j);if(q<0){const X=Math.hypot(E,A,I);return c[0]=E*s/X,c[1]=A*s/X,c[2]=I*s/X,!1}return c[0]=E+f*q,c[1]=A+y*q,c[2]=I+w*q,!0}}}class pf{constructor(n,s,c,f,y){this.TL=n,this.TR=s,this.BR=c,this.BL=f,this.horizon=y}static fromInvProjectionMatrix(n,s,c){const f=[-1,1,1],y=[1,1,1],w=[1,-1,1],E=[-1,-1,1],A=Hr(f,f,n),I=Hr(y,y,n),j=Hr(w,w,n),V=Hr(E,E,n);return new pf(A,I,j,V,s/c)}}class Bp{constructor(n,s){this.points=n,this.planes=s}static fromInvProjectionMatrix(n,s,c,f){const y=Math.pow(2,c),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((A=>{const I=kc([],A,n),j=1/I[3]/s*y;return(function(V,U,q){return V[0]=U[0]*q[0],V[1]=U[1]*q[1],V[2]=U[2]*q[2],V[3]=U[3]*q[3],V})(I,I,[j,j,f?1/I[3]:j,j])})),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((A=>{const I=us([],Rp([],Po([],w[A[0]],w[A[1]]),Po([],w[A[2]],w[A[1]]))),j=-Mo(I,w[A[1]]);return I.concat(j)}));return new Bp(w,E)}}class ds{static fromPoints(n){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of n)uf(s,s,f),Yi(c,c,f);return new ds(s,c)}static applyTransform(n,s){const c=n.getCorners();for(let f=0;f<c.length;++f)Hr(c[f],c[f],s);return ds.fromPoints(c)}constructor(n,s){this.min=n,this.max=s,this.center=zr([],Ha([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],c=M_(this.min),f=M_(this.max);for(let y=0;y<s.length;y++)c[y]=s[y]?this.min[y]:this.center[y],f[y]=s[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new ds(c,f)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){const s=this.getCorners();let c=!0;for(let f=0;f<n.planes.length;f++){const y=n.planes[f];let w=0;for(let E=0;E<s.length;E++)w+=Mo(y,s[E])+y[3]>=0;if(w===0)return 0;w!==s.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){const A=n.points[E][f]-this.min[f];y=Math.min(y,A),w=Math.max(w,A)}if(w<0||y>this.max[f]-this.min[f])return 0}return 1}}const Iu=5,hs=6,qa=ln/Math.PI/2,b0=16383,Za=64,Oi=[Za,32,16],Yo=-qa,Jt=qa,Md=[new ds([Yo,Yo,Yo],[Jt,Jt,Jt]),new ds([Yo,Yo,Yo],[0,0,Jt]),new ds([0,Yo,Yo],[Jt,0,Jt]),new ds([Yo,0,Yo],[0,Jt,Jt]),new ds([0,0,Yo],[Jt,Jt,Jt])];function Pd(i){return i*qa/Ac}function _g(i,n,s,c=!0){const f=zr([],i._camera.position,i.worldSize),y=[n,s,1,1];kc(y,y,i.pixelMatrixInverse),Lp(y,y,1/y[3]);const w=us([],Po([],y,f)),E=i.globeMatrix,A=[E[12],E[13],E[14]],I=Po([],A,f),j=kd(I),V=us([],I),U=i.worldSize/(2*Math.PI),q=Mo(V,w),X=Math.asin(U/j);if(X<Math.acos(q)){if(!c)return null;const Mt=[],rt=[];zr(Mt,w,j/q),us(rt,Po(rt,Mt,I)),us(w,Ha(w,I,zr(w,rt,Math.tan(X)*j)))}const te=[];new zp(f,w).closestPointOnSphere(A,U,te);const ae=us([],Ns(E,0)),ge=us([],Ns(E,1)),ke=us([],Ns(E,2)),ye=Mo(ae,te),Ee=Mo(ge,te),Pe=Mo(ke,te),Me=ft(Math.asin(-Ee/U));let Qe=ft(Math.atan2(ye,Pe));Qe=i.center.lng+(function(Mt,rt){const yt=(rt-Mt+180)%360-180;return yt<-180?yt+360:yt})(i.center.lng,Qe);const Xe=kr(Qe),mt=Se(Fr(Me),0,1);return new Ic(Xe,mt)}class T0{constructor(n,s,c){this.a=Po([],n,c),this.b=Po([],s,c),this.center=c;const f=us([],this.a),y=us([],this.b);this.angle=Math.acos(Mo(f,y))}}function Mu(i,n){if(i.angle===0)return null;let s;return s=i.a[n]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[n]/i.a[n]/Math.sin(i.angle)-1/Math.tan(i.angle)),s<0||s>1?null:(function(c,f,y,w){const E=Math.sin(y);return c*(Math.sin((1-w)*y)/E)+f*(Math.sin(w*y)/E)})(i.a[n],i.b[n],i.angle,Se(s,0,1))+i.center[n]}function No(i){if(i.z<=1)return Md[i.z+2*i.y+i.x];const n=mf(Nd(i));return ds.fromPoints(n)}function Ml(i,n,s){return zr(i,i,1-s),Ad(i,i,n,s)}function xg(i,n){const s=Rd(n.zoom);if(s===0)return No(i);const c=Nd(i),f=mf(c),y=kr(c.getWest())*n.worldSize,w=kr(c.getEast())*n.worldSize,E=Fr(c.getNorth())*n.worldSize,A=Fr(c.getSouth())*n.worldSize,I=[y,E,0],j=[w,E,0],V=[y,A,0],U=[w,A,0],q=Io([],n.globeMatrix);return Hr(I,I,q),Hr(j,j,q),Hr(V,V,q),Hr(U,U,q),f[0]=Ml(f[0],V,s),f[1]=Ml(f[1],U,s),f[2]=Ml(f[2],j,s),f[3]=Ml(f[3],I,s),ds.fromPoints(f)}function vg(i,n,s){for(const c of i)Hr(c,c,n),zr(c,c,s)}function L_(i,n,s){const c=n/i.worldSize,f=i.globeMatrix;if(s.z<=1){const Xe=No(s).getCorners();return vg(Xe,f,c),ds.fromPoints(Xe)}const y=Nd(s),w=mf(y);vg(w,f,c);const E=Number.MAX_VALUE,A=[-E,-E,-E],I=[E,E,E];if(y.contains(i.center)){for(const Mt of w)uf(I,I,Mt),Yi(A,A,Mt);A[2]=0;const Xe=i.point,mt=[Xe.x*c,Xe.y*c,0];return uf(I,I,mt),Yi(A,A,mt),new ds(I,A)}const j=[f[12]*c,f[13]*c,f[14]*c],V=y.getCenter(),U=Se(i.center.lat,-Yr,Yr),q=Se(V.lat,-Yr,Yr),X=kr(i.center.lng),te=Fr(U);let ae=X-kr(V.lng);const ge=te-Fr(q);ae>.5?ae-=1:ae<-.5&&(ae+=1);let ke=0;Math.abs(ae)>Math.abs(ge)?ke=ae>=0?1:3:(ke=ge>=0?0:2,Ad(j,j,[f[4]*c,f[5]*c,f[6]*c],-Math.sin(gt(ge>=0?y.getSouth():y.getNorth()))*qa));const ye=w[ke],Ee=w[(ke+1)%4],Pe=new T0(ye,Ee,j),Me=[Mu(Pe,0)||ye[0],Mu(Pe,1)||ye[1],Mu(Pe,2)||ye[2]],Qe=Rd(i.zoom);if(Qe>0){const Xe=(function({x:Mt,y:rt,z:yt},_t,kt,Nt,ht){const Bt=1/(1<<yt);let Qt=Mt*Bt,$t=Qt+Bt,Rn=rt*Bt,Dt=Rn+Bt,un=0;const Dn=(Qt+$t)/2-Nt;return Dn>.5?un=-1:Dn<-.5&&(un=1),Qt=((Qt+un)*_t-(Nt*=_t))*kt+Nt,$t=(($t+un)*_t-Nt)*kt+Nt,Rn=(Rn*_t-(ht*=_t))*kt+ht,Dt=(Dt*_t-ht)*kt+ht,[[Qt,Dt,0],[$t,Dt,0],[$t,Rn,0],[Qt,Rn,0]]})(s,n,i._pixelsPerMercatorPixel,X,te);for(let Mt=0;Mt<w.length;Mt++)Ml(w[Mt],Xe[Mt],Qe);const mt=Ha([],Xe[ke],Xe[(ke+1)%4]);zr(mt,mt,.5),Ml(Me,mt,Qe)}for(const Xe of w)uf(I,I,Xe),Yi(A,A,Xe);return I[2]=Math.min(ye[2],Ee[2]),uf(I,I,Me),Yi(A,A,Me),new ds(I,A)}function Nd({x:i,y:n,z:s}){const c=1/(1<<s),f=new hn(Ji(i*c),cr((n+1)*c)),y=new hn(Ji((i+1)*c),cr(n*c));return new Al(f,y)}function mf(i){const n=gt(i.getNorth()),s=gt(i.getSouth()),c=Math.cos(n),f=Math.cos(s),y=Math.sin(n),w=Math.sin(s),E=i.getWest(),A=i.getEast();return[pi(f,w,E),pi(f,w,A),pi(c,y,A),pi(c,y,E)]}function pi(i,n,s,c=qa){return s=gt(s),[i*Math.sin(s)*c,-n*c,i*Math.cos(s)*c]}function As(i,n,s){return pi(Math.cos(gt(i)),Math.sin(gt(i)),n,s)}function Jo(i,n,s,c){const f=1<<s.z,y=(i/ln+s.x)/f;return As(cr((n/ln+s.y)/f),Ji(y),c)}function gf({min:i,max:n}){return b0/Math.max(n[0]-i[0],n[1]-i[1],n[2]-i[2])}const wg=new Float64Array(16);function Gs(i){const n=gf(i),s=Pp(wg,[n,n,n]);return Ec(s,s,((c=[])[0]=-(f=i.min)[0],c[1]=-f[1],c[2]=-f[2],c));var c,f}function Fp(i){const n=(c=i.min,(s=wg)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=c[0],s[13]=c[1],s[14]=c[2],s[15]=1,s);var s,c;const f=1/gf(i);return Cc(n,n,[f,f,f])}function _a(i,n,s,c,f){const y=(function(A){const I=ln/(2*Math.PI);return A/(2*Math.PI)/I})(s),w=[i,n,-s/(2*Math.PI)],E=ya(new Float64Array(16));return Ec(E,E,w),Cc(E,E,[y,y,y]),Mp(E,E,gt(-f)),lf(E,E,gt(-c)),E}function Rd(i){return We(Iu,hs,i)}function bg(i,n){const s=As(n.lat,n.lng),c=(function(X){const te=As(X._center.lat,X._center.lng);let ae=Rp([],Au(0,1,0),te);const ge=ku([],-X.angle,te);ae=Hr(ae,ae,ge),ku(ge,-X._pitch,ae);const ke=us([],te);return zr(ke,ke,Pd(X.cameraToCenterDistance/X.pixelsPerMeter)),Hr(ke,ke,ge),Ha([],te,ke)})(i);return w=(f=Np([],c,s))[0],E=f[1],A=f[2],I=(y=s)[0],j=y[1],V=y[2],q=(U=Math.sqrt(w*w+E*E+A*A)*Math.sqrt(I*I+j*j+V*V))&&Mo(f,y)/U,Math.acos(Math.min(Math.max(q,-1),1));var f,y,w,E,A,I,j,V,U,q}function Vp(i,n){return bg(i,n)>Math.PI/2*1.01}const Tg=gt(85),j_=Math.cos(Tg),S0=Math.sin(Tg),Ac=63710088e-1,Up=2*Math.PI*Ac;class Hi{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Hi(fe(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,c=this.lat*s,f=n.lat*s,y=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((n.lng-this.lng)*s);return Ac*Math.acos(Math.min(y,1))}toBounds(n=0){const s=360*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Al(new Hi(this.lng-c,this.lat-s),new Hi(this.lng+c,this.lat+s))}toEcef(n){const s=Pd(n);return As(this.lat,this.lng,qa+s)}static convert(n){if(n instanceof Hi)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Hi(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Hi(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var hn=Hi;function zi(i){return Up*Math.cos(i*Math.PI/180)}function kr(i){return(180+i)/360}function Fr(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function oi(i,n){return i/zi(n)}function Ji(i){return 360*i-180}function cr(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Dd(i,n){return i*zi(cr(n))}const Yr=85.051129;function yf(i){return 1/Math.cos(i*Math.PI/180)}class Ic{constructor(n,s,c=0){this.x=+n,this.y=+s,this.z=+c}static fromLngLat(n,s=0){const c=hn.convert(n);return new Ic(kr(c.lng),Fr(c.lat),oi(s,c.lat))}toLngLat(){return new hn(Ji(this.x),cr(this.y))}toAltitude(){return Dd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Up*yf(cr(this.y))}}function Pu(i,n,s,c,f,y,w,E,A){const I=(n+c)/2,j=(s+f)/2,V=new Ie(I,j);E(V),(function(U,q,X,te,ae,ge){const ke=X-ae,ye=te-ge;return Math.abs((te-q)*ke-(X-U)*ye)/Math.hypot(ke,ye)})(V.x,V.y,y.x,y.y,w.x,w.y)>=A?(Pu(i,n,s,I,j,y,V,E,A),Pu(i,I,j,c,f,V,w,E,A)):i.push(w)}function Hs(i,n,s){let c=i[0],f=c.x,y=c.y;n(c);const w=[c];for(let E=1;E<i.length;E++){const A=i[E],{x:I,y:j}=A;n(A),Pu(w,f,y,I,j,c,A,n,s),f=I,y=j,c=A}return w}function _f(i,n,s,c){if(c(n,s)){const f=n.add(s)._mult(.5);_f(i,n,f,c),_f(i,f,s,c)}else i.push(s)}function Ld(i,n){let s=i[0];const c=[s];for(let f=1;f<i.length;f++){const y=i[f];_f(c,s,y,n),s=y}return c}const xa=Math.pow(2,14)-1,xf=-xa-1;function Sg(i,n){const s=Math.round(i.x*n),c=Math.round(i.y*n);return i.x=Se(s,xf,xa),i.y=Se(c,xf,xa),(s<i.x||s>i.x+1||c<i.y||c>i.y+1)&&Kn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function Is(i,n,s){const c=i.loadGeometry(),f=i.extent,y=ln/f;if(n&&s&&s.projection.isReprojectedInTileSpace){const w=1<<n.z,{scale:E,x:A,y:I,projection:j}=s,V=U=>{const q=Ji((n.x+U.x/f)/w),X=cr((n.y+U.y/f)/w),te=j.project(q,X);U.x=(te.x*E-A)*f,U.y=(te.y*E-I)*f};for(let U=0;U<c.length;U++)if(i.type!==1)c[U]=Hs(c[U],V,1);else{const q=[];for(const X of c[U])X.x<0||X.x>=f||X.y<0||X.y>=f||(V(X),q.push(X));c[U]=q}}for(const w of c)for(const E of w)Sg(E,y);return c}function Xa(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?Is(i):[]}}function va(i,n,s,c,f){i.emplaceBack(2*n+(c+1)/2,2*s+(f+1)/2)}function Nu(i,n,s){i.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Ru{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new At,this.indexArray=new tn,this.segments=new si,this.programConfigurations=new Sc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(n,s,c,f){const y=this.layers[0],w=[];let E=null;y.type==="circle"&&(E=y.layout.get("circle-sort-key"));for(const{feature:I,id:j,index:V,sourceLayerIndex:U}of n){const q=this.layers[0]._featureFilter.needGeometry,X=Xa(I,q);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),X,c))continue;const te=E?E.evaluate(X,{},c):void 0,ae={id:j,properties:I.properties,type:I.type,sourceLayerIndex:U,index:V,geometry:q?X.geometry:Is(I,c,f),patterns:{},sortKey:te};w.push(ae)}E&&w.sort(((I,j)=>I.sortKey-j.sortKey));let A=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new St,A=f.projection);for(const I of w){const{geometry:j,index:V,sourceLayerIndex:U}=I,q=n[V].feature;this.addFeature(I,j,V,s.availableImages,c,A),s.featureIndex.insert(q,j,V,U,this.index)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,k_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,w0.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,c,f,y,w){for(const E of s)for(const A of E){const I=A.x,j=A.y;if(I<0||I>=ln||j<0||j>=ln)continue;if(w){const q=w.projectTilePoint(I,j,y),X=w.upVector(y,I,j),te=this.globeExtVertexArray;Nu(te,q,X),Nu(te,q,X),Nu(te,q,X),Nu(te,q,X)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),U=V.vertexLength;va(this.layoutVertexArray,I,j,-1,-1),va(this.layoutVertexArray,I,j,1,-1),va(this.layoutVertexArray,I,j,1,1),va(this.layoutVertexArray,I,j,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},f,y)}}function $p(i,n){for(let s=0;s<i.length;s++)if(Pl(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(Pl(i,n[s]))return!0;return!!Ka(i,n)}function Gp(i,n,s){return!!Pl(i,n)||!!Ms(n,i,s)}function vf(i,n){if(i.length===1)return Hp(n,i[0]);for(let s=0;s<n.length;s++){const c=n[s];for(let f=0;f<c.length;f++)if(Pl(i,c[f]))return!0}for(let s=0;s<i.length;s++)if(Hp(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(Ka(i,n[s]))return!0;return!1}function Ws(i,n,s){if(i.length>1){if(Ka(i,n))return!0;for(let c=0;c<n.length;c++)if(Ms(n[c],i,s))return!0}for(let c=0;c<i.length;c++)if(Ms(i[c],n,s))return!0;return!1}function Ka(i,n){if(i.length===0||n.length===0)return!1;for(let s=0;s<i.length-1;s++){const c=i[s],f=i[s+1];for(let y=0;y<n.length-1;y++)if(wa(c,f,n[y],n[y+1]))return!0}return!1}function wa(i,n,s,c){return Er(i,s,c)!==Er(n,s,c)&&Er(i,n,s)!==Er(i,n,c)}function Ms(i,n,s){const c=s*s;if(n.length===1)return i.distSqr(n[0])<c;for(let f=1;f<n.length;f++)if(Eg(i,n[f-1],n[f])<c)return!0;return!1}function Eg(i,n,s){const c=n.distSqr(s);if(c===0)return i.distSqr(n);const f=((i.x-n.x)*(s.x-n.x)+(i.y-n.y)*(s.y-n.y))/c;return i.distSqr(f<0?n:f>1?s:s.sub(n)._mult(f)._add(n))}function Hp(i,n){let s,c,f,y=!1;for(let w=0;w<i.length;w++){s=i[w];for(let E=0,A=s.length-1;E<s.length;A=E++)c=s[E],f=s[A],c.y>n.y!=f.y>n.y&&n.x<(f.x-c.x)*(n.y-c.y)/(f.y-c.y)+c.x&&(y=!y)}return y}function Pl(i,n){let s=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const y=i[c],w=i[f];y.y>n.y!=w.y>n.y&&n.x<(w.x-y.x)*(n.y-y.y)/(w.y-y.y)+y.x&&(s=!s)}return s}function O_(i,n,s,c,f){for(const w of i)if(n<=w.x&&s<=w.y&&c>=w.x&&f>=w.y)return!0;const y=[new Ie(n,s),new Ie(n,f),new Ie(c,f),new Ie(c,s)];if(i.length>2){for(const w of y)if(Pl(i,w))return!0}for(let w=0;w<i.length-1;w++)if(Mc(i[w],i[w+1],y))return!0;return!1}function Mc(i,n,s){const c=s[0],f=s[2];if(i.x<c.x&&n.x<c.x||i.x>f.x&&n.x>f.x||i.y<c.y&&n.y<c.y||i.y>f.y&&n.y>f.y)return!1;const y=Er(i,n,s[0]);return y!==Er(i,n,s[1])||y!==Er(i,n,s[2])||y!==Er(i,n,s[3])}function Du(i,n,s){const c=n.paint.get(i).value;return c.kind==="constant"?c.value:s.programConfigurations.get(n.id).getMaxValue(i)}function jd(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Pc(i,n,s,c,f){if(!n[0]&&!n[1])return i;const y=Ie.convert(n)._mult(f);s==="viewport"&&y._rotate(-c);const w=[];for(let E=0;E<i.length;E++)w.push(i[E].sub(y));return w}function Wp(i,n,s,c){const f=Ie.convert(i)._mult(c);return n==="viewport"&&f._rotate(-s),f}Ft(Ru,"CircleBucket",{omit:["layers"]});const Lu=new ve({"circle-sort-key":new le(pt.layout_circle["circle-sort-key"])});var z_={paint:new ve({"circle-radius":new le(pt.paint_circle["circle-radius"]),"circle-color":new le(pt.paint_circle["circle-color"]),"circle-blur":new le(pt.paint_circle["circle-blur"]),"circle-opacity":new le(pt.paint_circle["circle-opacity"]),"circle-translate":new Q(pt.paint_circle["circle-translate"]),"circle-translate-anchor":new Q(pt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Q(pt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Q(pt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new le(pt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new le(pt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new le(pt.paint_circle["circle-stroke-opacity"])}),layout:Lu};function Cg(i,n,s,c,f,y,w,E,A){if(y&&i.queryGeometry.isAboveHorizon)return!1;y&&(A*=i.pixelToTileUnitsFactor);const I=i.tileID.canonical,j=s.projection.upVectorScale(I,s.center.lat,s.worldSize).metersToTile;for(const V of n)for(const U of V){const q=U.add(E),X=f&&s.elevation?s.elevation.exaggeration()*f.getElevationAt(q.x,q.y,!0):0,te=s.projection.projectTilePoint(q.x,q.y,I);if(X>0){const ye=s.projection.upVector(I,q.x,q.y);te.x+=ye[0]*j*X,te.y+=ye[1]*j*X,te.z+=ye[2]*j*X}const ae=y?q:kg(te.x,te.y,te.z,c),ge=y?i.tilespaceRays.map((ye=>C0(ye,X))):i.queryGeometry.screenGeometry,ke=kc([],[te.x,te.y,te.z,1],c);if(!w&&y?A*=ke[3]/s.cameraToCenterDistance:w&&!y&&(A*=s.cameraToCenterDistance/ke[3]),y){const ye=cr((U.y/ln+I.y)/(1<<I.z));A/=s.projection.pixelsPerMeter(ye,1)/oi(1,ye)}if(Gp(ge,ae,A))return!0}return!1}function kg(i,n,s,c){const f=kc([],[i,n,s,1],c);return new Ie(f[0]/f[3],f[1]/f[3])}const wf=Au(0,0,0),E0=Au(0,0,1);function C0(i,n){const s=cf();return wf[2]=n,i.intersectsPlane(wf,E0,s),new Ie(s[0],s[1])}class Ag extends Ru{}function Ig(i,{width:n,height:s},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==n*s*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(n*s*c);return i.width=n,i.height=s,i.data=f,i}function Nc(i,n,s){const{width:c,height:f}=n;c===i.width&&f===i.height||(Mg(i,n,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,f)},s),i.width=c,i.height=f,i.data=n.data)}function Mg(i,n,s,c,f,y){if(f.width===0||f.height===0)return n;if(f.width>i.width||f.height>i.height||s.x>i.width-f.width||s.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>n.width||f.height>n.height||c.x>n.width-f.width||c.y>n.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const w=i.data,E=n.data;for(let A=0;A<f.height;A++){const I=((s.y+A)*i.width+s.x)*y,j=((c.y+A)*n.width+c.x)*y;for(let V=0;V<f.width*y;V++)E[j+V]=w[I+V]}return n}Ft(Ag,"HeatmapBucket",{omit:["layers"]});class po{constructor(n,s){Ig(this,n,1,s)}resize(n){Nc(this,new po(n),1)}clone(){return new po({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,f,y){Mg(n,s,c,f,y,1)}}class qs{constructor(n,s){Ig(this,n,4,s)}resize(n){Nc(this,new qs(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new qs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,f,y){Mg(n,s,c,f,y,4)}}Ft(po,"AlphaImage"),Ft(qs,"RGBAImage");var mi={paint:new ve({"heatmap-radius":new le(pt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new le(pt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Q(pt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _e(pt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Q(pt.paint_heatmap["heatmap-opacity"])})};function Pg(i){const n={},s=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new qs({width:s,height:c}),y=(w,E,A)=>{n[i.evaluationKey]=A;const I=i.expression.evaluate(n);f.data[w+E+0]=Math.floor(255*I.r/I.a),f.data[w+E+1]=Math.floor(255*I.g/I.a),f.data[w+E+2]=Math.floor(255*I.b/I.a),f.data[w+E+3]=Math.floor(255*I.a)};if(i.clips)for(let w=0,E=0;w<c;++w,E+=4*s)for(let A=0,I=0;A<s;A++,I+=4){const j=A/(s-1),{start:V,end:U}=i.clips[w];y(E,I,V*(1-j)+U*j)}else for(let w=0,E=0;w<s;w++,E+=4)y(0,E,w/(s-1));return f}var B_={paint:new ve({"hillshade-illumination-direction":new Q(pt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Q(pt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Q(pt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Q(pt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Q(pt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Q(pt.paint_hillshade["hillshade-accent-color"])})};const k0=$e([{name:"a_pos",components:2,type:"Int16"}],4),{members:A0}=k0;var qp={exports:{}};function bf(i,n,s){s=s||2;var c,f,y,w,E,A,I,j=n&&n.length,V=j?n[0]*s:i.length,U=F_(i,0,V,s,!0),q=[];if(!U||U.next===U.prev)return q;if(j&&(U=(function(te,ae,ge,ke){var ye,Ee,Pe,Me=[];for(ye=0,Ee=ae.length;ye<Ee;ye++)(Pe=F_(te,ae[ye]*ke,ye<Ee-1?ae[ye+1]*ke:te.length,ke,!1))===Pe.next&&(Pe.steiner=!0),Me.push(Lg(Pe));for(Me.sort(Xp),ye=0;ye<Me.length;ye++)ge=Ng(Me[ye],ge);return ge})(i,n,U,s)),i.length>80*s){c=y=i[0],f=w=i[1];for(var X=s;X<V;X+=s)(E=i[X])<c&&(c=E),(A=i[X+1])<f&&(f=A),E>y&&(y=E),A>w&&(w=A);I=(I=Math.max(y-c,w-f))!==0?32767/I:0}return ju(U,q,s,c,f,I,0),q}function F_(i,n,s,c,f){var y,w;if(f===Bd(i,n,s,c)>0)for(y=n;y<s;y+=c)w=Kp(y,i[y],i[y+1],w);else for(y=s-c;y>=n;y-=c)w=Kp(y,i[y],i[y+1],w);return w&&zu(w,w.next)&&(Dc(w),w=w.next),w}function Qi(i,n){if(!i)return i;n||(n=i);var s,c=i;do if(s=!1,c.steiner||!zu(c,c.next)&&Jr(c.prev,c,c.next)!==0)c=c.next;else{if(Dc(c),(c=n=c.prev)===c.next)break;s=!0}while(s||c!==n);return n}function ju(i,n,s,c,f,y,w){if(i){!w&&y&&(function(j,V,U,q){var X=j;do X.z===0&&(X.z=Dg(X.x,X.y,V,U,q)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next;while(X!==j);X.prevZ.nextZ=null,X.prevZ=null,(function(te){var ae,ge,ke,ye,Ee,Pe,Me,Qe,Xe=1;do{for(ge=te,te=null,Ee=null,Pe=0;ge;){for(Pe++,ke=ge,Me=0,ae=0;ae<Xe&&(Me++,ke=ke.nextZ);ae++);for(Qe=Xe;Me>0||Qe>0&&ke;)Me!==0&&(Qe===0||!ke||ge.z<=ke.z)?(ye=ge,ge=ge.nextZ,Me--):(ye=ke,ke=ke.nextZ,Qe--),Ee?Ee.nextZ=ye:te=ye,ye.prevZ=Ee,Ee=ye;ge=ke}Ee.nextZ=null,Xe*=2}while(Pe>1)})(X)})(i,c,f,y);for(var E,A,I=i;i.prev!==i.next;)if(E=i.prev,A=i.next,y?Rc(i,c,f,y):I0(i))n.push(E.i/s|0),n.push(i.i/s|0),n.push(A.i/s|0),Dc(i),i=A.next,I=A.next;else if((i=A)===I){w?w===1?ju(i=Zp(Qi(i),n,s),n,s,c,f,y,2):w===2&&Ou(i,n,s,c,f,y):ju(Qi(i),n,s,c,f,y,1);break}}}function I0(i){var n=i.prev,s=i,c=i.next;if(Jr(n,s,c)>=0)return!1;for(var f=n.x,y=s.x,w=c.x,E=n.y,A=s.y,I=c.y,j=f<y?f<w?f:w:y<w?y:w,V=E<A?E<I?E:I:A<I?A:I,U=f>y?f>w?f:w:y>w?y:w,q=E>A?E>I?E:I:A>I?A:I,X=c.next;X!==n;){if(X.x>=j&&X.x<=U&&X.y>=V&&X.y<=q&&Od(f,E,y,A,w,I,X.x,X.y)&&Jr(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function Rc(i,n,s,c){var f=i.prev,y=i,w=i.next;if(Jr(f,y,w)>=0)return!1;for(var E=f.x,A=y.x,I=w.x,j=f.y,V=y.y,U=w.y,q=E<A?E<I?E:I:A<I?A:I,X=j<V?j<U?j:U:V<U?V:U,te=E>A?E>I?E:I:A>I?A:I,ae=j>V?j>U?j:U:V>U?V:U,ge=Dg(q,X,n,s,c),ke=Dg(te,ae,n,s,c),ye=i.prevZ,Ee=i.nextZ;ye&&ye.z>=ge&&Ee&&Ee.z<=ke;){if(ye.x>=q&&ye.x<=te&&ye.y>=X&&ye.y<=ae&&ye!==f&&ye!==w&&Od(E,j,A,V,I,U,ye.x,ye.y)&&Jr(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Ee.x>=q&&Ee.x<=te&&Ee.y>=X&&Ee.y<=ae&&Ee!==f&&Ee!==w&&Od(E,j,A,V,I,U,Ee.x,Ee.y)&&Jr(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;ye&&ye.z>=ge;){if(ye.x>=q&&ye.x<=te&&ye.y>=X&&ye.y<=ae&&ye!==f&&ye!==w&&Od(E,j,A,V,I,U,ye.x,ye.y)&&Jr(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Ee&&Ee.z<=ke;){if(Ee.x>=q&&Ee.x<=te&&Ee.y>=X&&Ee.y<=ae&&Ee!==f&&Ee!==w&&Od(E,j,A,V,I,U,Ee.x,Ee.y)&&Jr(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function Zp(i,n,s){var c=i;do{var f=c.prev,y=c.next.next;!zu(f,y)&&Tf(f,c,c.next,y)&&Ef(f,y)&&Ef(y,f)&&(n.push(f.i/s|0),n.push(c.i/s|0),n.push(y.i/s|0),Dc(c),Dc(c.next),c=i=y),c=c.next}while(c!==i);return Qi(c)}function Ou(i,n,s,c,f,y){var w=i;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&V_(w,E)){var A=jg(w,E);return w=Qi(w,w.next),A=Qi(A,A.next),ju(w,n,s,c,f,y,0),void ju(A,n,s,c,f,y,0)}E=E.next}w=w.next}while(w!==i)}function Xp(i,n){return i.x-n.x}function Ng(i,n){var s=(function(f,y){var w,E=y,A=f.x,I=f.y,j=-1/0;do{if(I<=E.y&&I>=E.next.y&&E.next.y!==E.y){var V=E.x+(I-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(V<=A&&V>j&&(j=V,w=E.x<E.next.x?E:E.next,V===A))return w}E=E.next}while(E!==y);if(!w)return null;var U,q=w,X=w.x,te=w.y,ae=1/0;E=w;do A>=E.x&&E.x>=X&&A!==E.x&&Od(I<te?A:j,I,X,te,I<te?j:A,I,E.x,E.y)&&(U=Math.abs(I-E.y)/(A-E.x),Ef(E,f)&&(U<ae||U===ae&&(E.x>w.x||E.x===w.x&&Rg(w,E)))&&(w=E,ae=U)),E=E.next;while(E!==q);return w})(i,n);if(!s)return n;var c=jg(s,i);return Qi(c,c.next),Qi(s,s.next)}function Rg(i,n){return Jr(i.prev,i,n.prev)<0&&Jr(n.next,i,i.next)<0}function Dg(i,n,s,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Lg(i){var n=i,s=i;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==i);return s}function Od(i,n,s,c,f,y,w,E){return(f-w)*(n-E)>=(i-w)*(y-E)&&(i-w)*(c-E)>=(s-w)*(n-E)&&(s-w)*(y-E)>=(f-w)*(c-E)}function V_(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!(function(s,c){var f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==c.i&&f.next.i!==c.i&&Tf(f,f.next,s,c))return!0;f=f.next}while(f!==s);return!1})(i,n)&&(Ef(i,n)&&Ef(n,i)&&(function(s,c){var f=s,y=!1,w=(s.x+c.x)/2,E=(s.y+c.y)/2;do f.y>E!=f.next.y>E&&f.next.y!==f.y&&w<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==s);return y})(i,n)&&(Jr(i.prev,i,n.prev)||Jr(i,n.prev,n))||zu(i,n)&&Jr(i.prev,i,i.next)>0&&Jr(n.prev,n,n.next)>0)}function Jr(i,n,s){return(n.y-i.y)*(s.x-n.x)-(n.x-i.x)*(s.y-n.y)}function zu(i,n){return i.x===n.x&&i.y===n.y}function Tf(i,n,s,c){var f=zd(Jr(i,n,s)),y=zd(Jr(i,n,c)),w=zd(Jr(s,c,i)),E=zd(Jr(s,c,n));return f!==y&&w!==E||!(f!==0||!Sf(i,s,n))||!(y!==0||!Sf(i,c,n))||!(w!==0||!Sf(s,i,c))||!(E!==0||!Sf(s,n,c))}function Sf(i,n,s){return n.x<=Math.max(i.x,s.x)&&n.x>=Math.min(i.x,s.x)&&n.y<=Math.max(i.y,s.y)&&n.y>=Math.min(i.y,s.y)}function zd(i){return i>0?1:i<0?-1:0}function Ef(i,n){return Jr(i.prev,i,i.next)<0?Jr(i,n,i.next)>=0&&Jr(i,i.prev,n)>=0:Jr(i,n,i.prev)<0||Jr(i,i.next,n)<0}function jg(i,n){var s=new Cf(i.i,i.x,i.y),c=new Cf(n.i,n.x,n.y),f=i.next,y=n.prev;return i.next=n,n.prev=i,s.next=f,f.prev=s,c.next=s,s.prev=c,y.next=c,c.prev=y,c}function Kp(i,n,s,c){var f=new Cf(i,n,s);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Dc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Cf(i,n,s){this.i=i,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bd(i,n,s,c){for(var f=0,y=n,w=s-c;y<s;y+=c)f+=(i[w]-i[y])*(i[y+1]+i[w+1]),w=y;return f}qp.exports=bf,qp.exports.default=bf,bf.deviation=function(i,n,s,c){var f=n&&n.length,y=Math.abs(Bd(i,0,f?n[0]*s:i.length,s));if(f)for(var w=0,E=n.length;w<E;w++)y-=Math.abs(Bd(i,n[w]*s,w<E-1?n[w+1]*s:i.length,s));var A=0;for(w=0;w<c.length;w+=3){var I=c[w]*s,j=c[w+1]*s,V=c[w+2]*s;A+=Math.abs((i[I]-i[V])*(i[j+1]-i[I+1])-(i[I]-i[j])*(i[V+1]-i[I+1]))}return y===0&&A===0?0:Math.abs((A-y)/y)},bf.flatten=function(i){for(var n=i[0][0].length,s={vertices:[],holes:[],dimensions:n},c=0,f=0;f<i.length;f++){for(var y=0;y<i[f].length;y++)for(var w=0;w<n;w++)s.vertices.push(i[f][y][w]);f>0&&s.holes.push(c+=i[f-1].length)}return s};var Yp=pe(qp.exports);function M0(i,n,s,c,f){kf(i,n,s,c||i.length-1,f||If)}function kf(i,n,s,c,f){for(;c>s;){if(c-s>600){var y=c-s+1,w=n-s+1,E=Math.log(y),A=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*A*(y-A)/y)*(w-y/2<0?-1:1);kf(i,n,Math.max(s,Math.floor(n-w*A/y+I)),Math.min(c,Math.floor(n+(y-w)*A/y+I)),f)}var j=i[n],V=s,U=c;for(Af(i,s,n),f(i[c],j)>0&&Af(i,s,c);V<U;){for(Af(i,V,U),V++,U--;f(i[V],j)<0;)V++;for(;f(i[U],j)>0;)U--}f(i[s],j)===0?Af(i,s,U):Af(i,++U,c),U<=n&&(s=U+1),n<=U&&(c=U-1)}}function Af(i,n,s){var c=i[n];i[n]=i[s],i[s]=c}function If(i,n){return i<n?-1:i>n?1:0}function Og(i,n){const s=i.length;if(s<=1)return[i];const c=[];let f,y;for(let w=0;w<s;w++){const E=Ks(i[w]);E!==0&&(i[w].area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(f&&c.push(f),f=[i[w]]):f.push(i[w]))}if(f&&c.push(f),n>1)for(let w=0;w<c.length;w++)c[w].length<=n||(M0(c[w],n,1,c[w].length-1,Jp),c[w]=c[w].slice(0,n));return c}function Jp(i,n){return n.area-i.area}function d(i,n,s){const c=s.patternDependencies;let f=!1;for(const y of n){const w=y.paint.get(`${i}-pattern`);w.isConstant()||(f=!0);const E=w.constantOr(null);E&&(f=!0,c[E]=!0)}return f}function p(i,n,s,c,f){const y=f.patternDependencies;for(const w of n){const E=w.paint.get(`${i}-pattern`).value;if(E.kind!=="constant"){let A=E.evaluate({zoom:c},s,{},f.availableImages);A=A&&A.name?A.name:A,y[A]=!0,s.patterns[w.id]=A}}return s}class S{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new At,this.indexArray=new tn,this.indexArray2=new $r,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new si,this.segments2=new si,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.projection=n.projection}populate(n,s,c,f){this.hasPattern=d("fill",this.layers,s);const y=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:E,id:A,index:I,sourceLayerIndex:j}of n){const V=this.layers[0]._featureFilter.needGeometry,U=Xa(E,V);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),U,c))continue;const q=y?y.evaluate(U,{},c,s.availableImages):void 0,X={id:A,properties:E.properties,type:E.type,sourceLayerIndex:j,index:I,geometry:V?U.geometry:Is(E,c,f),patterns:{},sortKey:q};w.push(X)}y&&w.sort(((E,A)=>E.sortKey-A.sortKey));for(const E of w){const{geometry:A,index:I,sourceLayerIndex:j}=E;if(this.hasPattern){const V=p("fill",this.layers,E,this.zoom,s);this.patternFeatures.push(V)}else this.addFeature(E,A,I,c,{},s.availableImages);s.featureIndex.insert(n[I].feature,A,I,j,this.index)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}addFeatures(n,s,c,f,y){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,A0),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,c,f,y,w=[]){for(const E of Og(s,500)){let A=0;for(const X of E)A+=X.length;const I=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),j=I.vertexLength,V=[],U=[];for(const X of E){if(X.length===0)continue;X!==E[0]&&U.push(V.length/2);const te=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),ae=te.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(ae+X.length-1,ae),V.push(X[0].x),V.push(X[0].y);for(let ge=1;ge<X.length;ge++)this.layoutVertexArray.emplaceBack(X[ge].x,X[ge].y),this.indexArray2.emplaceBack(ae+ge-1,ae+ge),V.push(X[ge].x),V.push(X[ge].y);te.vertexLength+=X.length,te.primitiveLength+=X.length}const q=Yp(V,U);for(let X=0;X<q.length;X+=3)this.indexArray.emplaceBack(j+q[X],j+q[X+1],j+q[X+2]);I.vertexLength+=A,I.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}}Ft(S,"FillBucket",{omit:["layers","patternFeatures"]});const N=new ve({"fill-sort-key":new le(pt.layout_fill["fill-sort-key"])});var F={paint:new ve({"fill-antialias":new Q(pt.paint_fill["fill-antialias"]),"fill-opacity":new le(pt.paint_fill["fill-opacity"]),"fill-color":new le(pt.paint_fill["fill-color"]),"fill-outline-color":new le(pt.paint_fill["fill-outline-color"]),"fill-translate":new Q(pt.paint_fill["fill-translate"]),"fill-translate-anchor":new Q(pt.paint_fill["fill-translate-anchor"]),"fill-pattern":new le(pt.paint_fill["fill-pattern"])}),layout:N};const W=$e([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),se=$e([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ae=$e([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ve}=W;var at={},Lt=Ue,jt=Pt;function Pt(i,n,s,c,f){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=f,i.readFields(rn,this,n)}function rn(i,n,s){i==1?n.id=s.readVarint():i==2?(function(c,f){for(var y=c.readVarint()+c.pos;c.pos<y;){var w=f._keys[c.readVarint()],E=f._values[c.readVarint()];f.properties[w]=E}})(s,n):i==3?n.type=s.readVarint():i==4&&(n._geometry=s.pos)}function fn(i){for(var n,s,c=0,f=0,y=i.length,w=y-1;f<y;w=f++)c+=((s=i[w]).x-(n=i[f]).x)*(n.y+s.y);return c}Pt.types=["Unknown","Point","LineString","Polygon"],Pt.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,s=i.readVarint()+i.pos,c=1,f=0,y=0,w=0,E=[];i.pos<s;){if(f<=0){var A=i.readVarint();c=7&A,f=A>>3}if(f--,c===1||c===2)y+=i.readSVarint(),w+=i.readSVarint(),c===1&&(n&&E.push(n),n=[]),n.push(new Lt(y,w));else{if(c!==7)throw new Error("unknown command "+c);n&&n.push(n[0].clone())}}return n&&E.push(n),E},Pt.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,s=1,c=0,f=0,y=0,w=1/0,E=-1/0,A=1/0,I=-1/0;i.pos<n;){if(c<=0){var j=i.readVarint();s=7&j,c=j>>3}if(c--,s===1||s===2)(f+=i.readSVarint())<w&&(w=f),f>E&&(E=f),(y+=i.readSVarint())<A&&(A=y),y>I&&(I=y);else if(s!==7)throw new Error("unknown command "+s)}return[w,A,E,I]},Pt.prototype.toGeoJSON=function(i,n,s){var c,f,y=this.extent*Math.pow(2,s),w=this.extent*i,E=this.extent*n,A=this.loadGeometry(),I=Pt.types[this.type];function j(q){for(var X=0;X<q.length;X++){var te=q[X];q[X]=[360*(te.x+w)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+E)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(c=0;c<A.length;c++)V[c]=A[c][0];j(A=V);break;case 2:for(c=0;c<A.length;c++)j(A[c]);break;case 3:for(A=(function(q){var X=q.length;if(X<=1)return[q];for(var te,ae,ge=[],ke=0;ke<X;ke++){var ye=fn(q[ke]);ye!==0&&(ae===void 0&&(ae=ye<0),ae===ye<0?(te&&ge.push(te),te=[q[ke]]):te.push(q[ke]))}return te&&ge.push(te),ge})(A),c=0;c<A.length;c++)for(f=0;f<A[c].length;f++)j(A[c][f])}A.length===1?A=A[0]:I="Multi"+I;var U={type:"Feature",geometry:{type:I,coordinates:A},properties:this.properties};return"id"in this&&(U.id=this.id),U};var mn=jt,gi=tt;function tt(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(He,this,n),this.length=this._features.length}function He(i,n,s){i===15?n.version=s.readVarint():i===1?n.name=s.readString():i===5?n.extent=s.readVarint():i===2?n._features.push(s.pos):i===3?n._keys.push(s.readString()):i===4&&n._values.push((function(c){for(var f=null,y=c.readVarint()+c.pos;c.pos<y;){var w=c.readVarint()>>3;f=w===1?c.readString():w===2?c.readFloat():w===3?c.readDouble():w===4?c.readVarint64():w===5?c.readVarint():w===6?c.readSVarint():w===7?c.readBoolean():null}return f})(s))}tt.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new mn(this._pbf,n,this.extent,this._keys,this._values)};var it=gi;function Vt(i,n,s){if(i===3){var c=new it(s,s.readVarint()+s.pos);c.length&&(n[c.name]=c)}}var gn=at.VectorTile=function(i,n){this.layers=i.readFields(Vt,{},n)},En=at.VectorTileFeature=jt;function Cn(i,n,s,c){const f=[],y=c===0?(w,E,A,I,j,V)=>{w.push(new Ie(V,A+(V-E)/(I-E)*(j-A)))}:(w,E,A,I,j,V)=>{w.push(new Ie(E+(V-A)/(j-A)*(I-E),V))};for(const w of i){const E=[];for(const A of w){if(A.length<=2)continue;const I=[];for(let U=0;U<A.length-1;U++){const q=A[U].x,X=A[U].y,te=A[U+1].x,ae=A[U+1].y,ge=c===0?q:X,ke=c===0?te:ae;ge<n?ke>n&&y(I,q,X,te,ae,n):ge>s?ke<s&&y(I,q,X,te,ae,s):I.push(A[U]),ke<n&&ge>=n&&y(I,q,X,te,ae,n),ke>s&&ge<=s&&y(I,q,X,te,ae,s)}let j=A[A.length-1];const V=c===0?j.x:j.y;V>=n&&V<=s&&I.push(j),I.length&&(j=I[I.length-1],I[0].x===j.x&&I[0].y===j.y||I.push(I[0]),E.push(I))}E.length&&f.push(E)}return f}at.VectorTileLayer=gi;const Vn=En.types,es=Math.pow(2,13);function ur(i,n,s,c,f,y,w,E){i.emplaceBack((n<<1)+w,(s<<1)+y,(Math.floor(c*es)<<1)+f,Math.round(E))}function Qo(i,n,s){i.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class U_{constructor(){this.acc=new Ie(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Ie(n.x,n.y),this.max=new Ie(n.x,n.y))}append(n,s){this.currentPolyCount.edges++,this.acc._add(n);const c=this.min,f=this.max;n.x<c.x?c.x=n.x:n.x>f.x&&(f.x=n.x),n.y<c.y?c.y=n.y:n.y>f.y&&(f.y=n.y),((n.x===0||n.x===ln)&&n.x===s.x)!=((n.y===0||n.y===ln)&&n.y===s.y)&&this.processBorderOverlap(n,s),s.x<0!=n.x<0&&this.addBorderIntersection(0,Yn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>ln!=n.x>ln&&this.addBorderIntersection(1,Yn(s.y,n.y,(ln-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,Yn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>ln!=n.y>ln&&this.addBorderIntersection(3,Yn(s.x,n.x,(ln-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,n.x)}}centroid(){const n=this.polyCount.reduce(((s,c)=>s+c.edges),0);return n!==0?this.acc.div(n)._round():new Ie(0,0)}span(){return new Ie(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((n,s)=>n+ +(s[0]!==Number.MAX_VALUE)),0)}}class zg{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.layoutVertexArray=new ct,this.centroidVertexArray=new uo,this.indexArray=new tn,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new si,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.enableTerrain=n.enableTerrain}populate(n,s,c,f){this.features=[],this.hasPattern=d("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=(function(y){const w=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*w/(w*w+1)/ln/(1<<y.z)})(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:w,index:E,sourceLayerIndex:A}of n){const I=this.layers[0]._featureFilter.needGeometry,j=Xa(y,I);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),j,c))continue;const V={id:w,sourceLayerIndex:A,index:E,geometry:I?j.geometry:Is(y,c,f),properties:y.properties,type:y.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(p("fill-extrusion",this.layers,V,this.zoom,s)):this.addFeature(V,V.geometry,E,c,{},s.availableImages,f),s.featureIndex.insert(y,V.geometry,E,A,this.index,U)}this.sortBorders()}addFeatures(n,s,c,f,y){for(const w of this.features){const{geometry:E}=w;this.addFeature(w,E,w.index,s,c,f,y)}this.sortBorders()}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Ve),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,Ae.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,se.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,c,f,y,w,E){const A=[new Ie(0,0),new Ie(ln,ln)],I=E.projection,j=I.name==="globe",V=this.enableTerrain&&!j?new U_:null,U=Vn[n.type]==="Polygon";j&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new St);const q=Og(s,500);for(let ge=q.length-1;ge>=0;ge--){const ke=q[ge];(ke.length===0||(X=ke[0]).every((ye=>ye.x<=0))||X.every((ye=>ye.x>=ln))||X.every((ye=>ye.y<=0))||X.every((ye=>ye.y>=ln)))&&q.splice(ge,1)}var X;let te;if(j)te=CS(q,A,f);else{te=[];for(const ge of q)te.push({polygon:ge,bounds:A})}const ae=U?this.edgeRadius:0;for(const{polygon:ge,bounds:ke}of te){let ye=0,Ee=0;for(const Me of ge)U&&!Me[0].equals(Me[Me.length-1])&&Me.push(Me[0]),Ee+=U?Me.length-1:Me.length;const Pe=this.segments.prepareSegment((U?5:4)*Ee,this.layoutVertexArray,this.indexArray);if(U){const Me=[],Qe=[];ye=Pe.vertexLength;for(const mt of ge){let Mt,rt;mt.length&&mt!==ge[0]&&Qe.push(Me.length/2),Mt=mt[1].sub(mt[0])._perp()._unit();for(let yt=1;yt<mt.length;yt++){const _t=mt[yt],kt=mt[yt===mt.length-1?1:yt+1];let{x:Nt,y:ht}=_t;if(ae){rt=kt.sub(_t)._perp()._unit();const Bt=Mt.add(rt)._unit(),Qt=ae*Math.min(4,1/(Mt.x*Bt.x+Mt.y*Bt.y));Nt+=Qt*Bt.x,ht+=Qt*Bt.y,Mt=rt}ur(this.layoutVertexArray,Nt,ht,0,0,1,1,0),Pe.vertexLength++,Me.push(_t.x,_t.y),j&&Qo(this.layoutVertexExtArray,I.projectTilePoint(Nt,ht,f),I.upVector(f,Nt,ht))}}const Xe=Yp(Me,Qe);for(let mt=0;mt<Xe.length;mt+=3)this.indexArray.emplaceBack(ye+Xe[mt],ye+Xe[mt+2],ye+Xe[mt+1]),Pe.primitiveLength++}for(const Me of ge){V&&Me.length&&V.startRing(Me[0]);let Qe,Xe,mt,Mt=Me.length>4&&TS(Me[Me.length-2],Me[0],Me[1]),rt=ae?BL(Me[Me.length-2],Me[0],Me[1],ae):0;Xe=Me[1].sub(Me[0])._perp()._unit();let yt=!0;for(let _t=1,kt=0;_t<Me.length;_t++){let Nt=Me[_t-1],ht=Me[_t];const Bt=Me[_t===Me.length-1?1:_t+1];if(V&&U&&V.currentPolyCount.top++,bS(ht,Nt,ke)){ae&&(Xe=Bt.sub(ht)._perp()._unit(),yt=!yt);continue}V&&V.append(ht,Nt);const Qt=ht.sub(Nt)._perp(),$t=Qt.x/(Math.abs(Qt.x)+Math.abs(Qt.y)),Rn=Qt.y>0?1:0,Dt=Nt.dist(ht);if(kt+Dt>32768&&(kt=0),ae){mt=Bt.sub(ht)._perp()._unit();let Ln=wS(Nt,ht,Bt,vS(Xe,mt),ae);isNaN(Ln)&&(Ln=0);const bn=ht.sub(Nt)._unit();Nt=Nt.add(bn.mult(rt))._round(),ht=ht.add(bn.mult(-Ln))._round(),rt=Ln,Xe=mt}const un=Pe.vertexLength,Dn=Me.length>4&&TS(Nt,ht,Bt);let dr=SS(kt,Mt,yt);if(ur(this.layoutVertexArray,Nt.x,Nt.y,$t,Rn,0,0,dr),ur(this.layoutVertexArray,Nt.x,Nt.y,$t,Rn,0,1,dr),kt+=Dt,dr=SS(kt,Dn,!yt),Mt=Dn,ur(this.layoutVertexArray,ht.x,ht.y,$t,Rn,0,0,dr),ur(this.layoutVertexArray,ht.x,ht.y,$t,Rn,0,1,dr),Pe.vertexLength+=4,this.indexArray.emplaceBack(un+0,un+1,un+2),this.indexArray.emplaceBack(un+1,un+3,un+2),Pe.primitiveLength+=2,ae){const Ln=ye+(_t===1?Me.length-2:_t-2),bn=_t===1?ye:Ln+1;if(this.indexArray.emplaceBack(un+1,Ln,un+3),this.indexArray.emplaceBack(Ln,bn,un+3),Pe.primitiveLength+=2,Qe===void 0&&(Qe=un),!bS(Bt,Me[_t],ke)){const Lr=_t===Me.length-1?Qe:Pe.vertexLength;this.indexArray.emplaceBack(un+2,un+3,Lr),this.indexArray.emplaceBack(un+3,Lr+1,Lr),this.indexArray.emplaceBack(un+3,bn,Lr+1),Pe.primitiveLength+=3}yt=!yt}if(j){const Ln=this.layoutVertexExtArray,bn=I.projectTilePoint(Nt.x,Nt.y,f),Lr=I.projectTilePoint(ht.x,ht.y,f),On=I.upVector(f,Nt.x,Nt.y),zn=I.upVector(f,ht.x,ht.y);Qo(Ln,bn,On),Qo(Ln,bn,On),Qo(Ln,Lr,zn),Qo(Ln,Lr,zn)}}U&&(ye+=Me.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const ge=V.borders,ke=this.featuresOnBorder.push(V)-1;for(let ye=0;ye<4;ye++)ge[ye][0]!==Number.MAX_VALUE&&this.borders[ye].push(ke)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort(((s,c)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[c].borders[n][0]))}encodeCentroid(n,s,c=!0){let f,y;if(n)if(n.y!==0){const E=s.span()._mult(this.tileToMeter);f=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(E.x/10)),y=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else f=Math.ceil(7*(n.x+450)),y=0;else f=0,y=+c;let w=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const E of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let A=0;A<E.top;A++)this.centroidVertexArray.emplace(w++,f,y);for(let A=0;A<2*E.edges;A++)this.centroidVertexArray.emplace(w++,0,y),this.centroidVertexArray.emplace(w++,f,y)}}}function vS(i,n){const s=i.add(n)._unit();return i.x*s.x+i.y*s.y}function BL(i,n,s,c){const f=n.sub(i)._perp()._unit(),y=s.sub(n)._perp()._unit();return wS(i,n,s,vS(f,y),c)}function wS(i,n,s,c,f){const y=Math.sqrt(1-c*c);return Math.min(i.dist(n)/3,n.dist(s)/3,f*y/c)}function bS(i,n,s){return i.x<s[0].x&&n.x<s[0].x||i.x>s[1].x&&n.x>s[1].x||i.y<s[0].y&&n.y<s[0].y||i.y>s[1].y&&n.y>s[1].y}function TS(i,n,s){if(i.x<0||i.x>=ln||n.x<0||n.x>=ln||s.x<0||s.x>=ln)return!1;const c=s.sub(n),f=c.perp(),y=i.sub(n);return(c.x*y.x+c.y*y.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(y.x*y.x+y.y*y.y))>-.866&&f.x*y.x+f.y*y.y<0}function SS(i,n,s){const c=n?2|i:-3&i;return s?1|c:-2&c}function ES(){const i=Math.PI/32,n=Math.tan(i),s=Ac;return s*Math.sqrt(1+2*n*n)-s}function CS(i,n,s){const c=1<<s.z,f=Ji(s.x/c),y=Ji((s.x+1)/c),w=cr(s.y/c),E=cr((s.y+1)/c);return(function(A,I,j,V,U=0,q){const X=[];if(!A.length||!j||!V)return X;const te=(Me,Qe)=>{for(const Xe of Me)X.push({polygon:Xe,bounds:Qe})},ae=Math.ceil(Math.log2(j)),ge=Math.ceil(Math.log2(V)),ke=ae-ge,ye=[];for(let Me=0;Me<Math.abs(ke);Me++)ye.push(ke>0?0:1);for(let Me=0;Me<Math.min(ae,ge);Me++)ye.push(0),ye.push(1);let Ee=A;if(Ee=Cn(Ee,I[0].y-U,I[1].y+U,1),Ee=Cn(Ee,I[0].x-U,I[1].x+U,0),!Ee.length)return X;const Pe=[];for(ye.length?Pe.push({polygons:Ee,bounds:I,depth:0}):te(Ee,I);Pe.length;){const Me=Pe.pop(),Qe=Me.depth,Xe=ye[Qe],mt=Me.bounds[0],Mt=Me.bounds[1],rt=Xe===0?mt.x:mt.y,yt=Xe===0?Mt.x:Mt.y,_t=q?q(Xe,rt,yt):.5*(rt+yt),kt=Cn(Me.polygons,rt-U,_t+U,Xe),Nt=Cn(Me.polygons,_t-U,yt+U,Xe);if(kt.length){const ht=[mt,new Ie(Xe===0?_t:Mt.x,Xe===1?_t:Mt.y)];ye.length>Qe+1?Pe.push({polygons:kt,bounds:ht,depth:Qe+1}):te(kt,ht)}if(Nt.length){const ht=[new Ie(Xe===0?_t:mt.x,Xe===1?_t:mt.y),Mt];ye.length>Qe+1?Pe.push({polygons:Nt,bounds:ht,depth:Qe+1}):te(Nt,ht)}}return X})(i,n,Math.ceil((y-f)/11.25),Math.ceil((w-E)/11.25),1,((A,I,j)=>{if(A===0)return .5*(I+j);{const V=cr((s.y+I/ln)/c);return(Fr(.5*(cr((s.y+j/ln)/c)+V))*c-s.y)*ln}}))}Ft(zg,"FillExtrusionBucket",{omit:["layers","features"]}),Ft(U_,"PartMetadata");const FL=new ve({"fill-extrusion-edge-radius":new Q(pt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var VL={paint:new ve({"fill-extrusion-opacity":new Q(pt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new le(pt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Q(pt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Q(pt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new le(pt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new le(pt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new le(pt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Q(pt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Q(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Q(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Q(pt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:FL};function kS(i,n,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[i*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class $_{constructor(n,s,c){this.z=n,this.x=s,this.y=c,this.key=Bg(0,n,n,s,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const c=(function(y,w,E){var A=kS(256*y,256*(w=Math.pow(2,E)-w-1),E),I=kS(256*(y+1),256*(w+1),E);return A[0]+","+A[1]+","+I[0]+","+I[1]})(this.x,this.y,this.z),f=(function(y,w,E){let A,I="";for(let j=y;j>0;j--)A=1<<j-1,I+=(w&A?1:0)+(E&A?2:0);return I})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class AS{constructor(n,s){this.wrap=n,this.canonical=s,this.key=Bg(n,s.z,s.z,s.x,s.y)}}class mo{constructor(n,s,c,f,y){this.overscaledZ=n,this.wrap=s,this.canonical=new $_(c,+f,+y),this.key=s===0&&n===c?this.canonical.key:Bg(s,n,c,f,y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new mo(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new mo(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return Bg(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return Bg(this.wrap*+s,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new mo(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new mo(s,this.wrap,s,c,f),new mo(s,this.wrap,s,c+1,f),new mo(s,this.wrap,s,c,f+1),new mo(s,this.wrap,s,c+1,f+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new mo(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new mo(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new AS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Bg(i,n,s,c,f){const y=1<<Math.min(s,22);let w=y*(f%y)+c%y;return i&&s<22&&(w+=y*y*((i<0?-2*i-1:2*i)%(1<<2*(22-s)))),16*(32*w+s)+(n-s)}Ft($_,"CanonicalTileID"),Ft(mo,"OverscaledTileID",{omit:["projMatrix"]});class Qp extends Ie{constructor(n,s,c){super(n,s),this.z=c}}function Fg(i,n){return i.x*n.x+i.y*n.y}function IS(i,n){if(i.length===1){let s=0;const c=n[s++];let f;for(;!f||c.equals(f);)if(f=n[s++],!f)return 1/0;for(;s<n.length;s++){const y=n[s],w=i[0],E=f.sub(c),A=y.sub(c),I=w.sub(c),j=Fg(E,E),V=Fg(E,A),U=Fg(A,A),q=Fg(I,E),X=Fg(I,A),te=j*U-V*V,ae=(U*q-V*X)/te,ge=(j*X-V*q)/te,ke=c.z*(1-ae-ge)+f.z*ae+y.z*ge;if(isFinite(ke))return ke}return 1/0}{let s=1/0;for(const c of n)s=Math.min(s,c.z);return s}}function MS(i,n,s,c,f,y,w,E){const A=w*f.getElevationAt(i,n,!0,!0),I=y[0]!==0,j=I?y[1]===0?w*(y[0]/7-450):w*(function(V,U,q){const X=Math.floor(U[0]/8),te=Math.floor(U[1]/8),ae=10*(U[0]-8*X),ge=10*(U[1]-8*te),ke=V.getElevationAt(X,te,!0,!0),ye=V.getMeterToDEM(q),Ee=Math.floor(.5*(ae*ye-1)),Pe=Math.floor(.5*(ge*ye-1)),Me=V.tileCoordToPixel(X,te),Qe=2*Ee+1,Xe=2*Pe+1,mt=(function(Nt,ht,Bt,Qt,$t){return[Nt.getElevationAtPixel(ht,Bt,!0),Nt.getElevationAtPixel(ht+$t,Bt,!0),Nt.getElevationAtPixel(ht,Bt+$t,!0),Nt.getElevationAtPixel(ht+Qt,Bt+$t,!0)]})(V,Me.x-Ee,Me.y-Pe,Qe,Xe),Mt=Math.abs(mt[0]-mt[1]),rt=Math.abs(mt[2]-mt[3]),yt=Math.abs(mt[0]-mt[2])+Math.abs(mt[1]-mt[3]),_t=Math.min(.25,.5*ye*(Mt+rt)/Qe),kt=Math.min(.25,.5*ye*yt/Xe);return ke+Math.max(_t*ae,kt*ge)})(f,y,E):A;return{base:A+(s===0)?-1:s,top:I?Math.max(j+c,A+s+2):A+c}}const UL=$e([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:$L}=UL,GL=$e([{name:"a_packed",components:4,type:"Float32"}]),{members:HL}=GL,WL=En.types,qL=Math.cos(Math.PI/180*37.5);class G_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new Je,this.layoutVertexArray2=new Ct,this.indexArray=new tn,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new si,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(n,s,c,f){this.hasPattern=d("line",this.layers,s);const y=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:j,id:V,index:U,sourceLayerIndex:q}of n){const X=this.layers[0]._featureFilter.needGeometry,te=Xa(j,X);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),te,c))continue;const ae=y?y.evaluate(te,{},c):void 0,ge={id:V,properties:j.properties,type:j.type,sourceLayerIndex:q,index:U,geometry:X?te.geometry:Is(j,c,f),patterns:{},sortKey:ae};w.push(ge)}y&&w.sort(((j,V)=>j.sortKey-V.sortKey));const{lineAtlas:E,featureIndex:A}=s,I=this.addConstantDashes(E);for(const j of w){const{geometry:V,index:U,sourceLayerIndex:q}=j;if(I&&this.addFeatureDashes(j,E),this.hasPattern){const X=p("line",this.layers,j,this.zoom,s);this.patternFeatures.push(X)}else this.addFeature(j,V,U,c,E.positions,s.availableImages);A.insert(n[U].feature,V,U,q,this.index)}}addConstantDashes(n){let s=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,y=c.layout.get("line-cap").value;if(f.kind!=="constant"||y.kind!=="constant")s=!0;else{const w=y.value,E=f.value;if(!E)continue;n.addDash(E,w)}}return s}addFeatureDashes(n,s){const c=this.zoom;for(const f of this.layers){const y=f.paint.get("line-dasharray").value,w=f.layout.get("line-cap").value;if(y.kind==="constant"&&w.kind==="constant")continue;let E,A;if(y.kind==="constant"){if(E=y.value,!E)continue}else E=y.evaluate({zoom:c},n);A=w.kind==="constant"?w.value:w.evaluate({zoom:c},n),s.addDash(E,A),n.patterns[f.id]=s.getKey(E,A)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}addFeatures(n,s,c,f,y){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,HL)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,$L),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,c,f,y,w){const E=this.layers[0].layout,A=E.get("line-join").evaluate(n,{}),I=E.get("line-cap").evaluate(n,{}),j=E.get("line-miter-limit"),V=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const U of s)this.addLine(U,n,A,I,j,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}addLine(n,s,c,f,y,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<n.length-1;ge++)this.totalDistance+=n[ge].dist(n[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=WL[s.type]==="Polygon";let A=n.length;for(;A>=2&&n[A-1].equals(n[A-2]);)A--;let I=0;for(;I<A-1&&n[I].equals(n[I+1]);)I++;if(A<(E?3:2))return;c==="bevel"&&(y=1.05);const j=this.overscaling<=16?15*ln/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let U,q,X,te,ae;this.e1=this.e2=-1,E&&(U=n[A-2],ae=n[I].sub(U)._unit()._perp());for(let ge=I;ge<A;ge++){if(X=ge===A-1?E?n[I+1]:void 0:n[ge+1],X&&n[ge].equals(X))continue;ae&&(te=ae),U&&(q=U),U=n[ge],ae=X?X.sub(U)._unit()._perp():te,te=te||ae;let ke=te.add(ae);ke.x===0&&ke.y===0||ke._unit();const ye=te.x*ae.x+te.y*ae.y,Ee=ke.x*ae.x+ke.y*ae.y,Pe=Ee!==0?1/Ee:1/0,Me=2*Math.sqrt(2-2*Ee),Qe=Ee<qL&&q&&X,Xe=te.x*ae.y-te.y*ae.x>0;if(Qe&&ge>I){const rt=U.dist(q);if(rt>2*j){const yt=U.sub(U.sub(q)._mult(j/rt)._round());this.updateDistance(q,yt),this.addCurrentVertex(yt,te,0,0,V),q=yt}}const mt=q&&X;let Mt=mt?c:E?"butt":f;if(mt&&Mt==="round"&&(Pe<w?Mt="miter":Pe<=2&&(Mt="fakeround")),Mt==="miter"&&Pe>y&&(Mt="bevel"),Mt==="bevel"&&(Pe>2&&(Mt="flipbevel"),Pe<y&&(Mt="miter")),q&&this.updateDistance(q,U),Mt==="miter")ke._mult(Pe),this.addCurrentVertex(U,ke,0,0,V);else if(Mt==="flipbevel"){if(Pe>100)ke=ae.mult(-1);else{const rt=Pe*te.add(ae).mag()/te.sub(ae).mag();ke._perp()._mult(rt*(Xe?-1:1))}this.addCurrentVertex(U,ke,0,0,V),this.addCurrentVertex(U,ke.mult(-1),0,0,V)}else if(Mt==="bevel"||Mt==="fakeround"){const rt=-Math.sqrt(Pe*Pe-1),yt=Xe?rt:0,_t=Xe?0:rt;if(q&&this.addCurrentVertex(U,te,yt,_t,V),Mt==="fakeround"){const kt=Math.round(180*Me/Math.PI/20);for(let Nt=1;Nt<kt;Nt++){let ht=Nt/kt;if(ht!==.5){const Qt=ht-.5;ht+=ht*Qt*(ht-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*Qt*Qt+(.848013+ye*(.215638*ye-1.06021)))}const Bt=ae.sub(te)._mult(ht)._add(te)._unit()._mult(Xe?-1:1);this.addHalfVertex(U,Bt.x,Bt.y,!1,Xe,0,V)}}X&&this.addCurrentVertex(U,ae,-yt,-_t,V)}else if(Mt==="butt")this.addCurrentVertex(U,ke,0,0,V);else if(Mt==="square"){const rt=q?1:-1;q||this.addCurrentVertex(U,ke,rt,rt,V),this.addCurrentVertex(U,ke,0,0,V),q&&this.addCurrentVertex(U,ke,rt,rt,V)}else Mt==="round"&&(q&&(this.addCurrentVertex(U,te,0,0,V),this.addCurrentVertex(U,te,1,1,V,!0)),X&&(this.addCurrentVertex(U,ae,-1,-1,V,!0),this.addCurrentVertex(U,ae,0,0,V)));if(Qe&&ge<A-1){const rt=U.dist(X);if(rt>2*j){const yt=U.add(X.sub(U)._mult(j/rt)._round());this.updateDistance(U,yt),this.addCurrentVertex(yt,ae,0,0,V),U=yt}}}}addCurrentVertex(n,s,c,f,y,w=!1){const E=s.y*f-s.x,A=-s.y-s.x*f;this.addHalfVertex(n,s.x+s.y*c,s.y-s.x*c,w,!1,c,y),this.addHalfVertex(n,E,A,w,!0,-f,y)}addHalfVertex({x:n,y:s},c,f,y,w,E,A){this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(s<<1)+(w?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const I=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),A.primitiveLength++),w?this.e2=I:this.e1=I}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}Ft(G_,"LineBucket",{omit:["layers","patternFeatures"]});const ZL=new ve({"line-cap":new le(pt.layout_line["line-cap"]),"line-join":new le(pt.layout_line["line-join"]),"line-miter-limit":new Q(pt.layout_line["line-miter-limit"]),"line-round-limit":new Q(pt.layout_line["line-round-limit"]),"line-sort-key":new le(pt.layout_line["line-sort-key"])});var PS={paint:new ve({"line-opacity":new le(pt.paint_line["line-opacity"]),"line-color":new le(pt.paint_line["line-color"]),"line-translate":new Q(pt.paint_line["line-translate"]),"line-translate-anchor":new Q(pt.paint_line["line-translate-anchor"]),"line-width":new le(pt.paint_line["line-width"]),"line-gap-width":new le(pt.paint_line["line-gap-width"]),"line-offset":new le(pt.paint_line["line-offset"]),"line-blur":new le(pt.paint_line["line-blur"]),"line-dasharray":new le(pt.paint_line["line-dasharray"]),"line-pattern":new le(pt.paint_line["line-pattern"]),"line-gradient":new _e(pt.paint_line["line-gradient"]),"line-trim-offset":new Q(pt.paint_line["line-trim-offset"])}),layout:ZL};const NS=new class extends le{possiblyEvaluate(i,n){return n=new B(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),super.possiblyEvaluate(i,n)}evaluate(i,n,s,c){return n=Tt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(i,n,s,c)}}(PS.paint.properties["line-width"].specification);function RS(i,n){return n>0?n+2*i:i}NS.useIntegerZoom=!0;const XL=$e([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),KL=$e([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),YL=$e([{name:"a_projected_pos",components:4,type:"Float32"}],4);$e([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const JL=$e([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),QL=$e([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const DS=$e([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),e5=$e([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);$e([{name:"triangle",components:3,type:"Uint16"}]),$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),$e([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),$e([{type:"Float32",name:"offsetX"}]),$e([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var fs=24;const Nl=128;function P0(i,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new B(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=s;let y=0;for(;y<c.length&&c[y]<=i;)y++;y=Math.max(0,y-1);let w=y;for(;w<c.length&&c[w]<i+1;)w++;w=Math.min(c.length-1,w);const E=c[y],A=c[w];return s.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:A,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:A,minSize:s.evaluate(new B(E)),maxSize:s.evaluate(new B(A)),interpolationType:f}}}function H_(i,{uSize:n,uSizeT:s},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/Nl:i.kind==="composite"?Yn(c/Nl,f/Nl,s):n}function em(i,n){let s=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:w}=i,E=f?Se(bs.interpolationFactor(f,n,y,w),0,1):0;i.kind==="camera"?c=Yn(i.minSize,i.maxSize,E):s=E}return{uSizeT:s,uSize:c}}var t5=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Nl,evaluateSizeForFeature:H_,evaluateSizeForZoom:em,getSizeData:P0});function n5(i,n,s){return i.sections.forEach((c=>{c.text=(function(f,y,w){const E=y.layout.get("text-transform").evaluate(w,{});return E==="uppercase"?f=f.toLocaleUpperCase():E==="lowercase"&&(f=f.toLocaleLowerCase()),D.applyArabicShaping&&(f=D.applyArabicShaping(f)),f})(c.text,n,s)})),i}const Vg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function r5(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function i5(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var LS=Ar,jS=function(i,n,s,c,f){var y,w,E=8*f-c-1,A=(1<<E)-1,I=A>>1,j=-7,V=f-1,U=-1,q=i[n+V];for(V+=U,y=q&(1<<-j)-1,q>>=-j,j+=E;j>0;y=256*y+i[n+V],V+=U,j-=8);for(w=y&(1<<-j)-1,y>>=-j,j+=c;j>0;w=256*w+i[n+V],V+=U,j-=8);if(y===0)y=1-I;else{if(y===A)return w?NaN:1/0*(q?-1:1);w+=Math.pow(2,c),y-=I}return(q?-1:1)*w*Math.pow(2,y-c)},OS=function(i,n,s,c,f,y){var w,E,A,I=8*y-f-1,j=(1<<I)-1,V=j>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=0,X=1,te=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,w=j):(w=Math.floor(Math.log(n)/Math.LN2),n*(A=Math.pow(2,-w))<1&&(w--,A*=2),(n+=w+V>=1?U/A:U*Math.pow(2,1-V))*A>=2&&(w++,A/=2),w+V>=j?(E=0,w=j):w+V>=1?(E=(n*A-1)*Math.pow(2,f),w+=V):(E=n*Math.pow(2,V-1)*Math.pow(2,f),w=0));f>=8;i[s+q]=255&E,q+=X,E/=256,f-=8);for(w=w<<f|E,I+=f;I>0;i[s+q]=255&w,q+=X,w/=256,I-=8);i[s+q-X]|=128*te};function Ar(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Ar.Varint=0,Ar.Fixed64=1,Ar.Bytes=2,Ar.Fixed32=5;var N0=4294967296,zS=1/N0,BS=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Bu(i){return i.type===Ar.Bytes?i.readVarint()+i.pos:i.pos+1}function tm(i,n,s){return s?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function FS(i,n,s){var c=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(c);for(var f=s.pos-1;f>=i;f--)s.buf[f+c]=s.buf[f]}function s5(i,n){for(var s=0;s<i.length;s++)n.writeVarint(i[s])}function o5(i,n){for(var s=0;s<i.length;s++)n.writeSVarint(i[s])}function a5(i,n){for(var s=0;s<i.length;s++)n.writeFloat(i[s])}function l5(i,n){for(var s=0;s<i.length;s++)n.writeDouble(i[s])}function c5(i,n){for(var s=0;s<i.length;s++)n.writeBoolean(i[s])}function u5(i,n){for(var s=0;s<i.length;s++)n.writeFixed32(i[s])}function d5(i,n){for(var s=0;s<i.length;s++)n.writeSFixed32(i[s])}function h5(i,n){for(var s=0;s<i.length;s++)n.writeFixed64(i[s])}function f5(i,n){for(var s=0;s<i.length;s++)n.writeSFixed64(i[s])}function W_(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function nm(i,n,s){i[s]=n,i[s+1]=n>>>8,i[s+2]=n>>>16,i[s+3]=n>>>24}function VS(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Ar.prototype={destroy:function(){this.buf=null},readFields:function(i,n,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),f=c>>3,y=this.pos;this.type=7&c,i(f,n,this),this.pos===y&&this.skip(c)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=W_(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=VS(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=W_(this.buf,this.pos)+W_(this.buf,this.pos+4)*N0;return this.pos+=8,i},readSFixed64:function(){var i=W_(this.buf,this.pos)+VS(this.buf,this.pos+4)*N0;return this.pos+=8,i},readFloat:function(){var i=jS(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=jS(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,s,c=this.buf;return n=127&(s=c[this.pos++]),s<128?n:(n|=(127&(s=c[this.pos++]))<<7,s<128?n:(n|=(127&(s=c[this.pos++]))<<14,s<128?n:(n|=(127&(s=c[this.pos++]))<<21,s<128?n:(function(f,y,w){var E,A,I=w.buf;if(E=(112&(A=I[w.pos++]))>>4,A<128||(E|=(127&(A=I[w.pos++]))<<3,A<128)||(E|=(127&(A=I[w.pos++]))<<10,A<128)||(E|=(127&(A=I[w.pos++]))<<17,A<128)||(E|=(127&(A=I[w.pos++]))<<24,A<128)||(E|=(1&(A=I[w.pos++]))<<31,A<128))return tm(f,E,y);throw new Error("Expected varint not more than 10 bytes")})(n|=(15&(s=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&BS?(function(s,c,f){return BS.decode(s.subarray(c,f))})(this.buf,n,i):(function(s,c,f){for(var y="",w=c;w<f;){var E,A,I,j=s[w],V=null,U=j>239?4:j>223?3:j>191?2:1;if(w+U>f)break;U===1?j<128&&(V=j):U===2?(192&(E=s[w+1]))==128&&(V=(31&j)<<6|63&E)<=127&&(V=null):U===3?(A=s[w+2],(192&(E=s[w+1]))==128&&(192&A)==128&&((V=(15&j)<<12|(63&E)<<6|63&A)<=2047||V>=55296&&V<=57343)&&(V=null)):U===4&&(A=s[w+2],I=s[w+3],(192&(E=s[w+1]))==128&&(192&A)==128&&(192&I)==128&&((V=(15&j)<<18|(63&E)<<12|(63&A)<<6|63&I)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,U=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),w+=U}return y})(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Ar.Bytes)return i.push(this.readVarint(n));var s=Bu(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSVarint());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Ar.Bytes)return i.push(this.readBoolean());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFloat());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Ar.Bytes)return i.push(this.readDouble());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFixed32());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSFixed32());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFixed64());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSFixed64());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Ar.Varint)for(;this.buf[this.pos++]>127;);else if(n===Ar.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Ar.Fixed32)this.pos+=4;else{if(n!==Ar.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),nm(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),nm(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),nm(this.buf,-1&i,this.pos),nm(this.buf,Math.floor(i*zS),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),nm(this.buf,-1&i,this.pos),nm(this.buf,Math.floor(i*zS),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?(function(n,s){var c,f;if(n>=0?(c=n%4294967296|0,f=n/4294967296|0):(f=~(-n/4294967296),4294967295^(c=~(-n%4294967296))?c=c+1|0:(c=0,f=f+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,w,E){E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,E.buf[E.pos]=127&(y>>>=7)})(c,0,s),(function(y,w){var E=(7&y)<<4;w.buf[w.pos++]|=E|((y>>>=3)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y)))))})(f,s)})(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=(function(c,f,y){for(var w,E,A=0;A<f.length;A++){if((w=f.charCodeAt(A))>55295&&w<57344){if(!E){w>56319||A+1===f.length?(c[y++]=239,c[y++]=191,c[y++]=189):E=w;continue}if(w<56320){c[y++]=239,c[y++]=191,c[y++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(c[y++]=239,c[y++]=191,c[y++]=189,E=null);w<128?c[y++]=w:(w<2048?c[y++]=w>>6|192:(w<65536?c[y++]=w>>12|224:(c[y++]=w>>18|240,c[y++]=w>>12&63|128),c[y++]=w>>6&63|128),c[y++]=63&w|128)}return y})(this.buf,i,this.pos);var s=this.pos-n;s>=128&&FS(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),OS(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),OS(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,n){this.pos++;var s=this.pos;i(n,this);var c=this.pos-s;c>=128&&FS(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,n,s){this.writeTag(i,Ar.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,s5,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,o5,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,c5,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,a5,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,l5,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,u5,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,d5,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,h5,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,f5,n)},writeBytesField:function(i,n){this.writeTag(i,Ar.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Ar.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Ar.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Ar.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var q_=pe(LS);const R0=3;function p5(i,n,s){n.glyphs=[],i===1&&s.readMessage(m5,n)}function m5(i,n,s){if(i===3){const{id:c,bitmap:f,width:y,height:w,left:E,top:A,advance:I}=s.readMessage(g5,{});n.glyphs.push({id:c,bitmap:new po({width:y+2*R0,height:w+2*R0},f),metrics:{width:y,height:w,left:E,top:A,advance:I}})}else i===4?n.ascender=s.readSVarint():i===5&&(n.descender=s.readSVarint())}function g5(i,n,s){i===1?n.id=s.readVarint():i===2?n.bitmap=s.readBytes():i===3?n.width=s.readVarint():i===4?n.height=s.readVarint():i===5?n.left=s.readSVarint():i===6?n.top=s.readSVarint():i===7&&(n.advance=s.readVarint())}const US=R0;function D0(i){let n=0,s=0;for(const w of i)n+=w.w*w.h,s=Math.max(s,w.w);i.sort(((w,E)=>E.h-w.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let f=0,y=0;for(const w of i)for(let E=c.length-1;E>=0;E--){const A=c[E];if(!(w.w>A.w||w.h>A.h)){if(w.x=A.x,w.y=A.y,y=Math.max(y,w.y+w.h),f=Math.max(f,w.x+w.w),w.w===A.w&&w.h===A.h){const I=c.pop();E<c.length&&(c[E]=I)}else w.h===A.h?(A.x+=w.w,A.w-=w.w):w.w===A.w?(A.y+=w.h,A.h-=w.h):(c.push({x:A.x+w.w,y:A.y,w:A.w-w.w,h:w.h}),A.y+=w.h,A.h-=w.h);break}}return{w:f,h:y,fill:n/(f*y)||0}}const Ro=1;class L0{constructor(n,{pixelRatio:s,version:c,stretchX:f,stretchY:y,content:w}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=f,this.stretchY=y,this.content=w,this.version=c}get tl(){return[this.paddedRect.x+Ro,this.paddedRect.y+Ro]}get br(){return[this.paddedRect.x+this.paddedRect.w-Ro,this.paddedRect.y+this.paddedRect.h-Ro]}get displaySize(){return[(this.paddedRect.w-2*Ro)/this.pixelRatio,(this.paddedRect.h-2*Ro)/this.pixelRatio]}}class $S{constructor(n,s){const c={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,c,y),this.addImages(s,f,y);const{w,h:E}=D0(y),A=new qs({width:w||1,height:E||1});for(const I in n){const j=n[I],V=c[I].paddedRect;qs.copy(j.data,A,{x:0,y:0},{x:V.x+Ro,y:V.y+Ro},j.data)}for(const I in s){const j=s[I],V=f[I].paddedRect,U=V.x+Ro,q=V.y+Ro,X=j.data.width,te=j.data.height;qs.copy(j.data,A,{x:0,y:0},{x:U,y:q},j.data),qs.copy(j.data,A,{x:0,y:te-1},{x:U,y:q-1},{width:X,height:1}),qs.copy(j.data,A,{x:0,y:0},{x:U,y:q+te},{width:X,height:1}),qs.copy(j.data,A,{x:X-1,y:0},{x:U-1,y:q},{width:1,height:te}),qs.copy(j.data,A,{x:0,y:0},{x:U+X,y:q},{width:1,height:te})}this.image=A,this.iconPositions=c,this.patternPositions=f}addImages(n,s,c){for(const f in n){const y=n[f],w={x:0,y:0,w:y.data.width+2*Ro,h:y.data.height+2*Ro};c.push(w),s[f]=new L0(w,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(n,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((c=>n.hasImage(c))),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),s)}patchUpdatedImage(n,s,c){if(!n||!s||n.version===s.version)return;n.version=s.version;const[f,y]=n.tl;c.update(s.data,void 0,{x:f,y})}}Ft(L0,"ImagePosition"),Ft($S,"ImageAtlas");const ba={horizontal:1,vertical:2,horizontalOnly:3},GS=-17;class Ug{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const c=new Ug;return c.scale=n||1,c.fontStack=s,c}static forImage(n){const s=new Ug;return s.imageName=n,s}}class rm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const c=new rm;for(let f=0;f<n.sections.length;f++){const y=n.sections[f];y.image?c.addImageSection(y):c.addTextSection(y,s)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=(function(s,c){let f="";for(let y=0;y<s.length;y++){const w=s.charCodeAt(y+1)||null,E=s.charCodeAt(y-1)||null;f+=!c&&(w&&Vs(w)&&!Vg[s[y+1]]||E&&Vs(E)&&!Vg[s[y-1]])||!Vg[s[y]]?s[y]:Vg[s[y]]}return f})(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&Z_[this.text.charCodeAt(c)];c++)n++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&Z_[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const c=new rm;return c.text=this.text.substring(n,s),c.sectionIndex=this.sectionIndex.slice(n,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,s)=>Math.max(n,this.sections[s].scale)),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Ug.forText(n.scale,n.fontStack||s));const c=this.sections.length-1;for(let f=0;f<n.text.length;++f)this.sectionIndex.push(c)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void Kn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Ug.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Kn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function j0(i,n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=rm.fromFeature(i,f);V===ba.vertical&&te.verticalizePunctuation(U);let ae=[];const ge=(function(Me,Qe,Xe,mt,Mt,rt){if(!Me)return[];const yt=[],_t=(function(Bt,Qt,$t,Rn,Dt,un){let Dn=0;for(let dr=0;dr<Bt.length();dr++){const Ln=Bt.getSection(dr);Dn+=HS(Bt.getCharCode(dr),Ln,Rn,Dt,Qt,un)}return Dn/Math.max(1,Math.ceil(Dn/$t))})(Me,Qe,Xe,mt,Mt,rt),kt=Me.text.indexOf("")>=0;let Nt=0;for(let Bt=0;Bt<Me.length();Bt++){const Qt=Me.getSection(Bt),$t=Me.getCharCode(Bt);if(Z_[$t]||(Nt+=HS($t,Qt,mt,Mt,Qe,rt)),Bt<Me.length()-1){const Rn=!((ht=$t)<11904||!(Ot["Bopomofo Extended"](ht)||Ot.Bopomofo(ht)||Ot["CJK Compatibility Forms"](ht)||Ot["CJK Compatibility Ideographs"](ht)||Ot["CJK Compatibility"](ht)||Ot["CJK Radicals Supplement"](ht)||Ot["CJK Strokes"](ht)||Ot["CJK Symbols and Punctuation"](ht)||Ot["CJK Unified Ideographs Extension A"](ht)||Ot["CJK Unified Ideographs"](ht)||Ot["Enclosed CJK Letters and Months"](ht)||Ot["Halfwidth and Fullwidth Forms"](ht)||Ot.Hiragana(ht)||Ot["Ideographic Description Characters"](ht)||Ot["Kangxi Radicals"](ht)||Ot["Katakana Phonetic Extensions"](ht)||Ot.Katakana(ht)||Ot["Vertical Forms"](ht)||Ot["Yi Radicals"](ht)||Ot["Yi Syllables"](ht)));(y5[$t]||Rn||Qt.imageName)&&yt.push(qS(Bt+1,Nt,_t,yt,_5($t,Me.getCharCode(Bt+1),Rn&&kt),!1))}}var ht;return ZS(qS(Me.length(),Nt,_t,yt,0,!0))})(te,I,y,n,c,q),{processBidirectionalText:ke,processStyledBidirectionalText:ye}=D;if(ke&&te.sections.length===1){const Me=ke(te.toString(),ge);for(const Qe of Me){const Xe=new rm;Xe.text=Qe,Xe.sections=te.sections;for(let mt=0;mt<Qe.length;mt++)Xe.sectionIndex.push(0);ae.push(Xe)}}else if(ye){const Me=ye(te.text,te.sectionIndex,ge);for(const Qe of Me){const Xe=new rm;Xe.text=Qe[0],Xe.sectionIndex=Qe[1],Xe.sections=te.sections,ae.push(Xe)}}else ae=(function(Me,Qe){const Xe=[],mt=Me.text;let Mt=0;for(const rt of Qe)Xe.push(Me.substring(Mt,rt)),Mt=rt;return Mt<mt.length&&Xe.push(Me.substring(Mt,mt.length)),Xe})(te,ge);const Ee=[],Pe={positionedLines:Ee,text:te.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return(function(Me,Qe,Xe,mt,Mt,rt,yt,_t,kt,Nt,ht,Bt){let Qt=0,$t=0,Rn=0;const Dt=_t==="right"?1:_t==="left"?0:.5;let un=!1;for(const On of Mt){const zn=On.getSections();for(const wr of zn){if(wr.imageName)continue;const Ir=Qe[wr.fontStack];if(Ir&&(un=Ir.ascender!==void 0&&Ir.descender!==void 0,!un))break}if(!un)break}let Dn=0;for(const On of Mt){On.trim();const zn=On.getMaxScale(),wr=(zn-1)*fs,Ir={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Dn]=Ir;const Mr=Ir.positionedGlyphs;let br=0;if(!On.length()){$t+=rt,++Dn;continue}let Wr=0,ai=0;for(let Tr=0;Tr<On.length();Tr++){const Bi=On.getSection(Tr),Si=On.getSectionIndex(Tr),Qr=On.getCharCode(Tr);let mr=Bi.scale,Ei=null,Pr=null,go=null,Ci=fs,ps=0;const ts=!(kt===ba.horizontal||!ht&&!bc(Qr)||ht&&(Z_[Qr]||(dr=Qr,Ot.Arabic(dr)||Ot["Arabic Supplement"](dr)||Ot["Arabic Extended-A"](dr)||Ot["Arabic Presentation Forms-A"](dr)||Ot["Arabic Presentation Forms-B"](dr))));if(Bi.imageName){const yo=mt[Bi.imageName];if(!yo)continue;go=Bi.imageName,Me.iconsInText=Me.iconsInText||!0,Pr=yo.paddedRect;const ns=yo.displaySize;mr=mr*fs/Bt,Ei={width:ns[0],height:ns[1],left:Ro,top:-US,advance:ts?ns[1]:ns[0],localGlyph:!1},ps=un?-Ei.height*mr:GS+zn*fs-ns[1]*mr,Ci=Ei.advance;const Ll=(ts?ns[0]:ns[1])*mr-fs*zn;Ll>0&&Ll>br&&(br=Ll)}else{const yo=Xe[Bi.fontStack];if(!yo)continue;yo[Qr]&&(Pr=yo[Qr]);const ns=Qe[Bi.fontStack];if(!ns)continue;const Ll=ns.glyphs[Qr];if(!Ll)continue;if(Ei=Ll.metrics,Ci=Qr!==8203?fs:0,un){const um=ns.ascender!==void 0?Math.abs(ns.ascender):0,Jg=ns.descender!==void 0?Math.abs(ns.descender):0,Qg=(um+Jg)*mr;Wr<Qg&&(Wr=Qg,ai=(um-Jg)/2*mr),ps=-um*mr}else ps=GS+(zn-mr)*fs}ts?(Me.verticalizable=!0,Mr.push({glyph:Qr,imageName:go,x:Qt,y:$t+ps,vertical:ts,scale:mr,localGlyph:Ei.localGlyph,fontStack:Bi.fontStack,sectionIndex:Si,metrics:Ei,rect:Pr}),Qt+=Ci*mr+Nt):(Mr.push({glyph:Qr,imageName:go,x:Qt,y:$t+ps,vertical:ts,scale:mr,localGlyph:Ei.localGlyph,fontStack:Bi.fontStack,sectionIndex:Si,metrics:Ei,rect:Pr}),Qt+=Ei.advance*mr+Nt)}Mr.length!==0&&(Rn=Math.max(Qt-Nt,Rn),un?XS(Mr,Dt,br,ai,rt*zn/2):XS(Mr,Dt,br,0,rt/2)),Qt=0;const Ti=rt*zn+br;Ir.lineOffset=Math.max(br,wr),$t+=Ti,++Dn}var dr;const Ln=$t,{horizontalAlign:bn,verticalAlign:Lr}=O0(yt);(function(On,zn,wr,Ir,Mr,br){const Wr=(zn-wr)*Mr,ai=-br*Ir;for(const Ti of On)for(const Tr of Ti.positionedGlyphs)Tr.x+=Wr,Tr.y+=ai})(Me.positionedLines,Dt,bn,Lr,Rn,Ln),Me.top+=-Lr*Ln,Me.bottom=Me.top+Ln,Me.left+=-bn*Rn,Me.right=Me.left+Rn,Me.hasBaseline=un})(Pe,n,s,c,ae,w,E,A,V,I,U,X),!(function(Me){for(const Qe of Me)if(Qe.positionedGlyphs.length!==0)return!1;return!0})(Ee)&&Pe}const Z_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},y5={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function HS(i,n,s,c,f,y){if(n.imageName){const w=c[n.imageName];return w?w.displaySize[0]*n.scale*fs/y+f:0}{const w=s[n.fontStack],E=w&&w.glyphs[i];return E?E.metrics.advance*n.scale+f:0}}function WS(i,n,s,c){const f=Math.pow(i-n,2);return c?i<n?f/2:2*f:f+Math.abs(s)*s}function _5(i,n,s){let c=0;return i===10&&(c-=1e4),s&&(c+=150),i!==40&&i!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function qS(i,n,s,c,f,y){let w=null,E=WS(n,s,f,y);for(const A of c){const I=WS(n-A.x,s,f,y)+A.badness;I<=E&&(w=A,E=I)}return{index:i,x:n,priorBreak:w,badness:E}}function ZS(i){return i?ZS(i.priorBreak).concat(i.index):[]}function O0(i){let n=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function XS(i,n,s,c,f){if(!(n||s||c||f))return;const y=i.length-1,w=i[y],E=(w.x+w.metrics.advance*w.scale)*n;for(let A=0;A<=y;A++)i[A].x-=E,i[A].y+=s+c+f}function x5(i,n,s){const{horizontalAlign:c,verticalAlign:f}=O0(s),y=n[0]-i.displaySize[0]*c,w=n[1]-i.displaySize[1]*f;return{image:i,top:w,bottom:w+i.displaySize[1],left:y,right:y+i.displaySize[0]}}function KS(i,n,s,c,f,y){const w=i.image;let E;if(w.content){const ae=w.content,ge=w.pixelRatio||1;E=[ae[0]/ge,ae[1]/ge,w.displaySize[0]-ae[2]/ge,w.displaySize[1]-ae[3]/ge]}const A=n.left*y,I=n.right*y;let j,V,U,q;s==="width"||s==="both"?(q=f[0]+A-c[3],V=f[0]+I+c[1]):(q=f[0]+(A+I-w.displaySize[0])/2,V=q+w.displaySize[0]);const X=n.top*y,te=n.bottom*y;return s==="height"||s==="both"?(j=f[1]+X-c[0],U=f[1]+te+c[2]):(j=f[1]+(X+te-w.displaySize[1])/2,U=j+w.displaySize[1]),{image:w,top:j,right:V,bottom:U,left:q,collisionPadding:E}}class Fu extends Ie{constructor(n,s,c,f,y){super(n,s),this.angle=f,this.z=c,y!==void 0&&(this.segment=y)}clone(){return new Fu(this.x,this.y,this.z,this.angle,this.segment)}}function YS(i,n,s,c,f){if(n.segment===void 0)return!0;let y=n,w=n.segment+1,E=0;for(;E>-s/2;){if(w--,w<0)return!1;E-=i[w].dist(y),y=i[w]}E+=i[w].dist(i[w+1]),w++;const A=[];let I=0;for(;E<s/2;){const j=i[w],V=i[w+1];if(!V)return!1;let U=i[w-1].angleTo(j)-j.angleTo(V);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:E,angleDelta:U}),I+=U;E-A[0].distance>c;)I-=A.shift().angleDelta;if(I>f)return!1;w++,E+=j.dist(V)}return!0}function JS(i){let n=0;for(let s=0;s<i.length-1;s++)n+=i[s].dist(i[s+1]);return n}function QS(i,n,s){return i?.6*n*s:0}function eE(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function v5(i,n,s,c,f,y){const w=QS(s,f,y),E=eE(s,c)*y;let A=0;const I=JS(i)/2;for(let j=0;j<i.length-1;j++){const V=i[j],U=i[j+1],q=V.dist(U);if(A+q>I){const X=(I-A)/q,te=Yn(V.x,U.x,X),ae=Yn(V.y,U.y,X),ge=new Fu(te,ae,0,U.angleTo(V),j);return!w||YS(i,ge,E,w,n)?ge:void 0}A+=q}}function w5(i,n,s,c,f,y,w,E,A){const I=QS(c,y,w),j=eE(c,f),V=j*w,U=i[0].x===0||i[0].x===A||i[0].y===0||i[0].y===A;return n-V<n/4&&(n=V+n/4),tE(i,U?n/2*E%n:(j/2+2*y)*w*E%n,n,I,s,V,U,!1,A)}function tE(i,n,s,c,f,y,w,E,A){const I=y/2,j=JS(i);let V=0,U=n-s,q=[];for(let X=0;X<i.length-1;X++){const te=i[X],ae=i[X+1],ge=te.dist(ae),ke=ae.angleTo(te);for(;U+s<V+ge;){U+=s;const ye=(U-V)/ge,Ee=Yn(te.x,ae.x,ye),Pe=Yn(te.y,ae.y,ye);if(Ee>=0&&Ee<A&&Pe>=0&&Pe<A&&U-I>=0&&U+I<=j){const Me=new Fu(Ee,Pe,0,ke,X);Me._round(),c&&!YS(i,Me,y,c,f)||q.push(Me)}}V+=ge}return E||q.length||w||(q=tE(i,V/2,s,c,f,y,w,!0,A)),q}function nE(i,n,s,c,f){const y=[];for(let w=0;w<i.length;w++){const E=i[w];let A;for(let I=0;I<E.length-1;I++){let j=E[I],V=E[I+1];j.x<n&&V.x<n||(j.x<n?j=new Ie(n,j.y+(n-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x<n&&(V=new Ie(n,j.y+(n-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y<s&&V.y<s||(j.y<s?j=new Ie(j.x+(s-j.y)/(V.y-j.y)*(V.x-j.x),s)._round():V.y<s&&(V=new Ie(j.x+(s-j.y)/(V.y-j.y)*(V.x-j.x),s)._round()),j.x>=c&&V.x>=c||(j.x>=c?j=new Ie(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x>=c&&(V=new Ie(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y>=f&&V.y>=f||(j.y>=f?j=new Ie(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round():V.y>=f&&(V=new Ie(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round()),A&&j.equals(A[A.length-1])||(A=[j],y.push(A)),A.push(V)))))}}return y}Ft(Fu,"Anchor");const $g=1e20;function rE(i,n,s,c,f,y,w,E,A){for(let I=n;I<n+c;I++)iE(i,s*y+I,y,f,w,E,A);for(let I=s;I<s+f;I++)iE(i,I*y+n,1,c,w,E,A)}function iE(i,n,s,c,f,y,w){y[0]=0,w[0]=-$g,w[1]=$g,f[0]=i[n];for(let E=1,A=0,I=0;E<c;E++){f[E]=i[n+E*s];const j=E*E;do{const V=y[A];I=(f[E]-f[V]+j-V*V)/(E-V)/2}while(I<=w[A]&&--A>-1);A++,y[A]=E,w[A]=I,w[A+1]=$g}for(let E=0,A=0;E<c;E++){for(;w[A+1]<E;)A++;const I=y[A],j=E-I;i[n+E*s]=f[I]+j*j}}const Rl=2,z0={none:0,ideographs:1,all:2};class im{constructor(n,s,c){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,s){const c=[];for(const f in n)for(const y of n[f])c.push({stack:f,id:y});Fe(c,(({stack:f,id:y},w)=>{let E=this.entries[f];E||(E=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=E.glyphs[y];if(A!==void 0)return void w(null,{stack:f,id:y,glyph:A});if(A=this._tinySDF(E,f,y),A)return E.glyphs[y]=A,void w(null,{stack:f,id:y,glyph:A});const I=Math.floor(y/256);if(256*I>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[I])return void w(null,{stack:f,id:y,glyph:A});let j=E.requests[I];j||(j=E.requests[I]=[],im.loadGlyphRange(f,I,this.url,this.requestManager,((V,U)=>{if(U){E.ascender=U.ascender,E.descender=U.descender;for(const q in U.glyphs)this._doesCharSupportLocalGlyph(+q)||(E.glyphs[+q]=U.glyphs[+q]);E.ranges[I]=!0}for(const q of j)q(V,U);delete E.requests[I]}))),j.push(((V,U)=>{V?w(V):U&&w(null,{stack:f,id:y,glyph:U.glyphs[y]||null})}))}),((f,y)=>{if(f)s(f);else if(y){const w={};for(const{stack:E,id:A,glyph:I}of y)w[E]===void 0&&(w[E]={}),w[E].glyphs===void 0&&(w[E].glyphs={}),w[E].glyphs[A]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},w[E].ascender=this.entries[E].ascender,w[E].descender=this.entries[E].descender;s(null,w)}}))}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==z0.none&&(this.localGlyphMode===z0.all?!!this.localFontFamily:!!this.localFontFamily&&(Ot["CJK Unified Ideographs"](n)||Ot["Hangul Syllables"](n)||Ot.Hiragana(n)||Ot.Katakana(n)||Ot["CJK Symbols and Punctuation"](n)))}_tinySDF(n,s,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let y=n.tinySDF;if(!y){let te="400";/bold/i.test(s)?te="900":/medium/i.test(s)?te="500":/light/i.test(s)&&(te="200"),y=n.tinySDF=new im.TinySDF({fontFamily:f,fontWeight:te,fontSize:24*Rl,buffer:3*Rl,radius:8*Rl}),y.fontWeight=te}if(this.localGlyphs[y.fontWeight][c])return this.localGlyphs[y.fontWeight][c];const w=String.fromCharCode(c),{data:E,width:A,height:I,glyphWidth:j,glyphHeight:V,glyphLeft:U,glyphTop:q,glyphAdvance:X}=y.draw(w);return this.localGlyphs[y.fontWeight][c]={id:c,bitmap:new po({width:A,height:I},E),metrics:{width:j/Rl,height:V/Rl,left:U/Rl,top:q/Rl-27,advance:X/Rl,localGlyph:!0}}}}im.loadGlyphRange=function(i,n,s,c,f){const y=256*n,w=y+255,E=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",i).replace("{range}",`${y}-${w}`),Mi.Glyphs);Js(E,((A,I)=>{if(A)f(A);else if(I){const j={},V=(function(U){return new q_(U).readFields(p5,{})})(I);for(const U of V.glyphs)j[U.id]=U;f(null,{glyphs:j,ascender:V.ascender,descender:V.descender})}}))},im.TinySDF=class{constructor({fontSize:i=24,buffer:n=3,radius:s=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=s;const E=this.size=i+4*n,A=this._createCanvas(E),I=this.ctx=A.getContext("2d",{willReadFrequently:!0});I.font=`${w} ${y} ${i}px ${f}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(i){const n=document.createElement("canvas");return n.width=n.height=i,n}draw(i){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(i),w=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),A=Math.min(this.size-this.buffer,w+Math.ceil(c)),I=E+2*this.buffer,j=A+2*this.buffer,V=Math.max(I*j,0),U=new Uint8ClampedArray(V),q={data:U,width:I,height:j,glyphWidth:E,glyphHeight:A,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(E===0||A===0)return q;const{ctx:X,buffer:te,gridInner:ae,gridOuter:ge}=this;X.clearRect(te,te,E,A),X.fillText(i,te,te+w);const ke=X.getImageData(te,te,E,A);ge.fill($g,0,V),ae.fill(0,0,V);for(let ye=0;ye<A;ye++)for(let Ee=0;Ee<E;Ee++){const Pe=ke.data[4*(ye*E+Ee)+3]/255;if(Pe===0)continue;const Me=(ye+te)*I+Ee+te;if(Pe===1)ge[Me]=0,ae[Me]=$g;else{const Qe=.5-Pe;ge[Me]=Qe>0?Qe*Qe:0,ae[Me]=Qe<0?Qe*Qe:0}}rE(ge,0,0,I,j,I,this.f,this.v,this.z),rE(ae,te,te,E,A,I,this.f,this.v,this.z);for(let ye=0;ye<V;ye++){const Ee=Math.sqrt(ge[ye])-Math.sqrt(ae[ye]);U[ye]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return q}};const sm=Ro;function sE(i,n,s,c){const f=[],y=i.image,w=y.pixelRatio,E=y.paddedRect.w-2*sm,A=y.paddedRect.h-2*sm,I=i.right-i.left,j=i.bottom-i.top,V=y.stretchX||[[0,E]],U=y.stretchY||[[0,A]],q=(rt,yt)=>rt+yt[1]-yt[0],X=V.reduce(q,0),te=U.reduce(q,0),ae=E-X,ge=A-te;let ke=0,ye=X,Ee=0,Pe=te,Me=0,Qe=ae,Xe=0,mt=ge;if(y.content&&c){const rt=y.content;ke=X_(V,0,rt[0]),Ee=X_(U,0,rt[1]),ye=X_(V,rt[0],rt[2]),Pe=X_(U,rt[1],rt[3]),Me=rt[0]-ke,Xe=rt[1]-Ee,Qe=rt[2]-rt[0]-ye,mt=rt[3]-rt[1]-Pe}const Mt=(rt,yt,_t,kt)=>{const Nt=K_(rt.stretch-ke,ye,I,i.left),ht=Y_(rt.fixed-Me,Qe,rt.stretch,X),Bt=K_(yt.stretch-Ee,Pe,j,i.top),Qt=Y_(yt.fixed-Xe,mt,yt.stretch,te),$t=K_(_t.stretch-ke,ye,I,i.left),Rn=Y_(_t.fixed-Me,Qe,_t.stretch,X),Dt=K_(kt.stretch-Ee,Pe,j,i.top),un=Y_(kt.fixed-Xe,mt,kt.stretch,te),Dn=new Ie(Nt,Bt),dr=new Ie($t,Bt),Ln=new Ie($t,Dt),bn=new Ie(Nt,Dt),Lr=new Ie(ht/w,Qt/w),On=new Ie(Rn/w,un/w),zn=n*Math.PI/180;if(zn){const Mr=Math.sin(zn),br=Math.cos(zn),Wr=[br,-Mr,Mr,br];Dn._matMult(Wr),dr._matMult(Wr),bn._matMult(Wr),Ln._matMult(Wr)}const wr=rt.stretch+rt.fixed,Ir=yt.stretch+yt.fixed;return{tl:Dn,tr:dr,bl:bn,br:Ln,tex:{x:y.paddedRect.x+sm+wr,y:y.paddedRect.y+sm+Ir,w:_t.stretch+_t.fixed-wr,h:kt.stretch+kt.fixed-Ir},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:On,minFontScaleX:Qe/w/I,minFontScaleY:mt/w/j,isSDF:s}};if(c&&(y.stretchX||y.stretchY)){const rt=oE(V,ae,X),yt=oE(U,ge,te);for(let _t=0;_t<rt.length-1;_t++){const kt=rt[_t],Nt=rt[_t+1];for(let ht=0;ht<yt.length-1;ht++)f.push(Mt(kt,yt[ht],Nt,yt[ht+1]))}}else f.push(Mt({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:A+1}));return f}function X_(i,n,s){let c=0;for(const f of i)c+=Math.max(n,Math.min(s,f[1]))-Math.max(n,Math.min(s,f[0]));return c}function oE(i,n,s){const c=[{fixed:-sm,stretch:0}];for(const[f,y]of i){const w=c[c.length-1];c.push({fixed:f-w.stretch,stretch:w.stretch}),c.push({fixed:f-w.stretch,stretch:w.stretch+(y-f)})}return c.push({fixed:n+sm,stretch:s}),c}function K_(i,n,s,c){return i/n*s+c}function Y_(i,n,s,c){return i-n*s/c}function b5(i,n,s,c){const f=n+i.positionedLines[c].lineOffset;return c===0?s+f/2:s+(f+(n+i.positionedLines[c-1].lineOffset))/2}class T5{constructor(n=[],s=S5){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:c}=this,f=s[n];for(;n>0;){const y=n-1>>1,w=s[y];if(c(f,w)>=0)break;s[n]=w,n=y}s[n]=f}_down(n){const{data:s,compare:c}=this,f=this.length>>1,y=s[n];for(;n<f;){let w=1+(n<<1),E=s[w];const A=w+1;if(A<this.length&&c(s[A],E)<0&&(w=A,E=s[A]),c(E,y)>=0)break;s[n]=E,n=w}s[n]=y}}function S5(i,n){return i<n?-1:i>n?1:0}function E5(i,n=1,s=!1){let c=1/0,f=1/0,y=-1/0,w=-1/0;const E=i[0];for(let q=0;q<E.length;q++){const X=E[q];(!q||X.x<c)&&(c=X.x),(!q||X.y<f)&&(f=X.y),(!q||X.x>y)&&(y=X.x),(!q||X.y>w)&&(w=X.y)}const A=Math.min(y-c,w-f);let I=A/2;const j=new T5([],C5);if(A===0)return new Ie(c,f);for(let q=c;q<y;q+=A)for(let X=f;X<w;X+=A)j.push(new om(q+I,X+I,I,i));let V=(function(q){let X=0,te=0,ae=0;const ge=q[0];for(let ke=0,ye=ge.length,Ee=ye-1;ke<ye;Ee=ke++){const Pe=ge[ke],Me=ge[Ee],Qe=Pe.x*Me.y-Me.x*Pe.y;te+=(Pe.x+Me.x)*Qe,ae+=(Pe.y+Me.y)*Qe,X+=3*Qe}return new om(te/X,ae/X,0,q)})(i),U=j.length;for(;j.length;){const q=j.pop();(q.d>V.d||!V.d)&&(V=q,s&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,U)),q.max-V.d<=n||(I=q.h/2,j.push(new om(q.p.x-I,q.p.y-I,I,i)),j.push(new om(q.p.x+I,q.p.y-I,I,i)),j.push(new om(q.p.x-I,q.p.y+I,I,i)),j.push(new om(q.p.x+I,q.p.y+I,I,i)),U+=4)}return s&&(console.log(`num probes: ${U}`),console.log(`best distance: ${V.d}`)),V.p}function C5(i,n){return n.max-i.max}class om{constructor(n,s,c,f){this.p=new Ie(n,s),this.h=c,this.d=(function(y,w){let E=!1,A=1/0;for(let I=0;I<w.length;I++){const j=w[I];for(let V=0,U=j.length,q=U-1;V<U;q=V++){const X=j[V],te=j[q];X.y>y.y!=te.y>y.y&&y.x<(te.x-X.x)*(y.y-X.y)/(te.y-X.y)+X.x&&(E=!E),A=Math.min(A,Eg(y,X,te))}}return(E?1:-1)*Math.sqrt(A)})(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const am=7,B0=Number.POSITIVE_INFINITY,k5=Math.sqrt(2);function aE(i,[n,s]){let c=0,f=0;if(s===B0){n<0&&(n=0);const y=n/k5;switch(i){case"top-right":case"top-left":f=y-am;break;case"bottom-right":case"bottom-left":f=-y+am;break;case"bottom":f=-n+am;break;case"top":f=n-am}switch(i){case"top-right":case"bottom-right":c=-y;break;case"top-left":case"bottom-left":c=y;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),i){case"top-right":case"top-left":case"top":f=s-am;break;case"bottom-right":case"bottom-left":case"bottom":f=-s+am}switch(i){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,f]}function A5(i,n,s,c,f,y,w,E,A,I){i.createArrays(),i.tilePixelRatio=ln/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const j=i.layers[0].layout,V=i.layers[0]._unevaluatedLayout._values,U={};if(i.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=i.textSizeData;U.compositeTextSizes=[V["text-size"].possiblyEvaluate(new B(te),E),V["text-size"].possiblyEvaluate(new B(ae),E)]}if(i.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=i.iconSizeData;U.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new B(te),E),V["icon-size"].possiblyEvaluate(new B(ae),E)]}U.layoutTextSize=V["text-size"].possiblyEvaluate(new B(A+1),E),U.layoutIconSize=V["icon-size"].possiblyEvaluate(new B(A+1),E),U.textMaxSize=V["text-size"].possiblyEvaluate(new B(18),E);const q=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",X=j.get("text-size");for(const te of i.features){const ae=j.get("text-font").evaluate(te,{},E).join(","),ge=X.evaluate(te,{},E),ke=U.layoutTextSize.evaluate(te,{},E),ye=(U.layoutIconSize.evaluate(te,{},E),{horizontal:{},vertical:void 0}),Ee=te.text;let Pe,Me=[0,0];if(Ee){const mt=Ee.toString(),Mt=j.get("text-letter-spacing").evaluate(te,{},E)*fs,rt=j.get("text-line-height").evaluate(te,{},E)*fs,yt=wc(mt)?Mt:0,_t=j.get("text-anchor").evaluate(te,{},E),kt=j.get("text-variable-anchor");if(!kt){const $t=j.get("text-radial-offset").evaluate(te,{},E);Me=$t?aE(_t,[$t*fs,B0]):j.get("text-offset").evaluate(te,{},E).map((Rn=>Rn*fs))}let Nt=q?"center":j.get("text-justify").evaluate(te,{},E);const ht=j.get("symbol-placement")==="point",Bt=ht?j.get("text-max-width").evaluate(te,{},E)*fs:1/0,Qt=$t=>{i.allowVerticalPlacement&&Fa(mt)&&(ye.vertical=j0(Ee,n,s,f,ae,Bt,rt,_t,$t,yt,Me,ba.vertical,!0,ke,ge))};if(!q&&kt){const $t=Nt==="auto"?kt.map((Dt=>F0(Dt))):[Nt];let Rn=!1;for(let Dt=0;Dt<$t.length;Dt++){const un=$t[Dt];if(!ye.horizontal[un])if(Rn)ye.horizontal[un]=ye.horizontal[0];else{const Dn=j0(Ee,n,s,f,ae,Bt,rt,"center",un,yt,Me,ba.horizontal,!1,ke,ge);Dn&&(ye.horizontal[un]=Dn,Rn=Dn.positionedLines.length===1)}}Qt("left")}else{if(Nt==="auto"&&(Nt=F0(_t)),ht||j.get("text-writing-mode").indexOf("horizontal")>=0||!Fa(mt)){const $t=j0(Ee,n,s,f,ae,Bt,rt,_t,Nt,yt,Me,ba.horizontal,!1,ke,ge);$t&&(ye.horizontal[Nt]=$t)}Qt(ht?"left":Nt)}}let Qe=!1;if(te.icon&&te.icon.name){const mt=c[te.icon.name];mt&&(Pe=x5(f[te.icon.name],j.get("icon-offset").evaluate(te,{},E),j.get("icon-anchor").evaluate(te,{},E)),Qe=mt.sdf,i.sdfIcons===void 0?i.sdfIcons=mt.sdf:i.sdfIcons!==mt.sdf&&Kn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(mt.pixelRatio!==i.pixelRatio||j.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Xe=cE(ye.horizontal)||ye.vertical;i.iconsInText||(i.iconsInText=!!Xe&&Xe.iconsInText),(Xe||Pe)&&I5(i,te,ye,Pe,c,U,ke,0,Me,Qe,w,E,I)}y&&i.generateCollisionDebugBuffers(A,i.collisionBoxArray)}function F0(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function I5(i,n,s,c,f,y,w,E,A,I,j,V,U){let q=y.textMaxSize.evaluate(n,{},V);q===void 0&&(q=w);const X=i.layers[0].layout,te=X.get("icon-offset").evaluate(n,{},V),ae=cE(s.horizontal)||s.vertical,ge=U.name==="globe",ke=fs,ye=w/ke,Ee=i.tilePixelRatio*q/ke,Pe=(_t=i.overscaling,i.zoom>18&&_t>2&&(_t>>=1),Math.max(ln/(512*_t),1)*X.get("symbol-spacing")),Me=X.get("text-padding")*i.tilePixelRatio,Qe=X.get("icon-padding")*i.tilePixelRatio,Xe=gt(X.get("text-max-angle")),mt=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",Mt=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",rt=X.get("symbol-placement"),yt=Pe/2;var _t;const kt=X.get("icon-text-fit");let Nt;c&&kt!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(Nt=KS(c,s.vertical,kt,X.get("icon-text-fit-padding"),te,ye)),ae&&(c=KS(c,ae,kt,X.get("icon-text-fit-padding"),te,ye)));const ht=(Bt,Qt,$t)=>{if(Qt.x<0||Qt.x>=ln||Qt.y<0||Qt.y>=ln)return;let Rn=null;if(ge){const{x:Dt,y:un,z:Dn}=U.projectTilePoint(Qt.x,Qt.y,$t);Rn={anchor:new Fu(Dt,un,Dn,0,void 0),up:U.upVector($t,Qt.x,Qt.y)}}(function(Dt,un,Dn,dr,Ln,bn,Lr,On,zn,wr,Ir,Mr,br,Wr,ai,Ti,Tr,Bi,Si,Qr,mr,Ei,Pr,go,Ci){const ps=Dt.addToLineVertexArray(un,dr);let ts,yo,ns,Ll,um,Jg,Qg,UE=0,$E=0,GE=0,HE=0,t1=-1,n1=-1;const zc={};let WE=fo("");const Nf=Dn?Dn.anchor:un;let r1=0,i1=0;if(zn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[r1,i1]=zn.layout.get("text-offset").evaluate(mr,{},Ci).map((ea=>ea*fs)):(r1=zn.layout.get("text-radial-offset").evaluate(mr,{},Ci)*fs,i1=B0),Dt.allowVerticalPlacement&&Ln.vertical){const ea=Ln.vertical;if(ai)Jg=V0(ea),On&&(Qg=V0(On));else{const ta=zn.layout.get("text-rotate").evaluate(mr,{},Ci)+90;ns=J_(wr,Nf,un,Ir,Mr,br,ea,Wr,ta,Ti),On&&(Ll=J_(wr,Nf,un,Ir,Mr,br,On,Bi,ta))}}if(bn){const ea=zn.layout.get("icon-rotate").evaluate(mr,{},Ci),ta=zn.layout.get("icon-text-fit")!=="none",ey=sE(bn,ea,Pr,ta),o1=On?sE(On,ea,Pr,ta):void 0;yo=J_(wr,Nf,un,Ir,Mr,br,bn,Bi,ea),UE=4*ey.length;const qE=Dt.iconSizeData;let Rf=null;qE.kind==="source"?(Rf=[Nl*zn.layout.get("icon-size").evaluate(mr,{},Ci)],Rf[0]>Fd&&Kn(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Gg}. Reduce your "icon-size".`)):qE.kind==="composite"&&(Rf=[Nl*Ei.compositeIconSizes[0].evaluate(mr,{},Ci),Nl*Ei.compositeIconSizes[1].evaluate(mr,{},Ci)],(Rf[0]>Fd||Rf[1]>Fd)&&Kn(`${Dt.layerIds[0]}: Value for "icon-size" is >= ${Gg}. Reduce your "icon-size".`)),Dt.addSymbols(Dt.icon,ey,Rf,Qr,Si,mr,!1,Dn,un,ps.lineStartIndex,ps.lineLength,-1,go,Ci),t1=Dt.icon.placedSymbolArray.length-1,o1&&($E=4*o1.length,Dt.addSymbols(Dt.icon,o1,Rf,Qr,Si,mr,ba.vertical,Dn,un,ps.lineStartIndex,ps.lineLength,-1,go,Ci),n1=Dt.icon.placedSymbolArray.length-1)}for(const ea in Ln.horizontal){const ta=Ln.horizontal[ea];ts||(WE=fo(ta.text),ai?um=V0(ta):ts=J_(wr,Nf,un,Ir,Mr,br,ta,Wr,zn.layout.get("text-rotate").evaluate(mr,{},Ci),Ti));const ey=ta.positionedLines.length===1;if(GE+=lE(Dt,Dn,un,ta,Lr,zn,ai,mr,Ti,ps,Ln.vertical?ba.horizontal:ba.horizontalOnly,ey?Object.keys(Ln.horizontal):[ea],zc,t1,Ei,go,Ci),ey)break}Ln.vertical&&(HE+=lE(Dt,Dn,un,Ln.vertical,Lr,zn,ai,mr,Ti,ps,ba.vertical,["vertical"],zc,n1,Ei,go,Ci));let Wd=-1;const s1=(ea,ta)=>ea?Math.max(ea,ta):ta;Wd=s1(um,Wd),Wd=s1(Jg,Wd),Wd=s1(Qg,Wd);const rj=Wd>-1?1:0;Dt.glyphOffsetArray.length>=Ud.MAX_GLYPHS&&Kn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),mr.sortKey!==void 0&&Dt.addToSortKeyRanges(Dt.symbolInstances.length,mr.sortKey),Dt.symbolInstances.emplaceBack(Nf.x,Nf.y,Nf.z,un.x,un.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical>=0?zc.vertical:-1,t1,n1,WE,ts!==void 0?ts:Dt.collisionBoxArray.length,ts!==void 0?ts+1:Dt.collisionBoxArray.length,ns!==void 0?ns:Dt.collisionBoxArray.length,ns!==void 0?ns+1:Dt.collisionBoxArray.length,yo!==void 0?yo:Dt.collisionBoxArray.length,yo!==void 0?yo+1:Dt.collisionBoxArray.length,Ll||Dt.collisionBoxArray.length,Ll?Ll+1:Dt.collisionBoxArray.length,Ir,GE,HE,UE,$E,rj,0,r1,i1,Wd)})(i,Qt,Rn,Bt,s,c,f,Nt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,Me,mt,A,0,Qe,Mt,te,n,y,I,j,V)};if(rt==="line")for(const Bt of nE(n.geometry,0,0,ln,ln)){const Qt=w5(Bt,Pe,Xe,s.vertical||ae,c,ke,Ee,i.overscaling,ln);for(const $t of Qt)ae&&M5(i,ae.text,yt,$t)||ht(Bt,$t,V)}else if(rt==="line-center"){for(const Bt of n.geometry)if(Bt.length>1){const Qt=v5(Bt,Xe,s.vertical||ae,c,ke,Ee);Qt&&ht(Bt,Qt,V)}}else if(n.type==="Polygon")for(const Bt of Og(n.geometry,0)){const Qt=E5(Bt,16);ht(Bt[0],new Fu(Qt.x,Qt.y,0,0,void 0),V)}else if(n.type==="LineString")for(const Bt of n.geometry)ht(Bt,new Fu(Bt[0].x,Bt[0].y,0,0,void 0),V);else if(n.type==="Point")for(const Bt of n.geometry)for(const Qt of Bt)ht([Qt],new Fu(Qt.x,Qt.y,0,0,void 0),V)}const Gg=255,Fd=Gg*Nl;function lE(i,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae){const ge=(function(Ee,Pe,Me,Qe,Xe,mt,Mt,rt){const yt=[];if(Pe.positionedLines.length===0)return yt;const _t=Qe.layout.get("text-rotate").evaluate(mt,{})*Math.PI/180,kt=(function($t){const Rn=$t[0],Dt=$t[1],un=Rn*Dt;return un>0?[Rn,-Dt]:un<0?[-Rn,Dt]:Rn===0?[Dt,Rn]:[Dt,-Rn]})(Me);let Nt=Math.abs(Pe.top-Pe.bottom);for(const $t of Pe.positionedLines)Nt-=$t.lineOffset;const ht=Pe.positionedLines.length,Bt=Nt/ht;let Qt=Pe.top-Me[1];for(let $t=0;$t<ht;++$t){const Rn=Pe.positionedLines[$t];Qt=b5(Pe,Bt,Qt,$t);for(const Dt of Rn.positionedGlyphs){if(!Dt.rect)continue;const un=Dt.rect||{};let Dn=US+1,dr=!0,Ln=1,bn=0;if(Dt.imageName){const Pr=Mt[Dt.imageName];if(!Pr)continue;if(Pr.sdf){Kn("SDF images are not supported in formatted text and will be ignored.");continue}dr=!1,Ln=Pr.pixelRatio,Dn=Ro/Ln}const Lr=(Xe||rt)&&Dt.vertical,On=Dt.metrics.advance*Dt.scale/2,zn=Dt.metrics,wr=Dt.rect;if(wr===null)continue;rt&&Pe.verticalizable&&(bn=Dt.imageName?On-Dt.metrics.width*Dt.scale/2:0);const Ir=Xe?[Dt.x+On,Dt.y]:[0,0];let Mr=[0,0],br=[0,0],Wr=!1;Xe||(Lr?(br=[Dt.x+On+kt[0],Dt.y+kt[1]-bn],Wr=!0):Mr=[Dt.x+On+Me[0],Dt.y+Me[1]-bn]);const ai=wr.w*Dt.scale/(Ln*(Dt.localGlyph?Rl:1)),Ti=wr.h*Dt.scale/(Ln*(Dt.localGlyph?Rl:1));let Tr,Bi,Si,Qr;if(Lr){const Pr=Dt.y-Qt,go=new Ie(-On,On-Pr),Ci=-Math.PI/2,ps=new Ie(...br);Tr=new Ie(-On+Mr[0],Mr[1]),Tr._rotateAround(Ci,go)._add(ps),Tr.x+=-Pr+On,Tr.y-=(zn.left-Dn)*Dt.scale;const ts=Dt.imageName?zn.advance*Dt.scale:fs*Dt.scale,yo=String.fromCharCode(Dt.glyph);r5(yo)?Tr.x+=(1-Dn)*Dt.scale:i5(yo)?Tr.x+=ts-zn.height*Dt.scale+(-Dn-1)*Dt.scale:Tr.x+=Dt.imageName||zn.width+2*Dn===wr.w&&zn.height+2*Dn===wr.h?(ts-Ti)/2:(ts-(zn.height+2*Dn)*Dt.scale)/2,Bi=new Ie(Tr.x,Tr.y-ai),Si=new Ie(Tr.x+Ti,Tr.y),Qr=new Ie(Tr.x+Ti,Tr.y-ai)}else{const Pr=(zn.left-Dn)*Dt.scale-On+Mr[0],go=(-zn.top-Dn)*Dt.scale+Mr[1],Ci=Pr+ai,ps=go+Ti;Tr=new Ie(Pr,go),Bi=new Ie(Ci,go),Si=new Ie(Pr,ps),Qr=new Ie(Ci,ps)}if(_t){let Pr;Pr=Xe?new Ie(0,0):Wr?new Ie(kt[0],kt[1]):new Ie(Me[0],Me[1]),Tr._rotateAround(_t,Pr),Bi._rotateAround(_t,Pr),Si._rotateAround(_t,Pr),Qr._rotateAround(_t,Pr)}const mr=new Ie(0,0),Ei=new Ie(0,0);yt.push({tl:Tr,tr:Bi,bl:Si,br:Qr,tex:un,writingMode:Pe.writingMode,glyphOffset:Ir,sectionIndex:Dt.sectionIndex,isSDF:dr,pixelOffsetTL:mr,pixelOffsetBR:Ei,minFontScaleX:0,minFontScaleY:0})}}return yt})(0,c,A,y,w,E,f,i.allowVerticalPlacement),ke=i.textSizeData;let ye=null;ke.kind==="source"?(ye=[Nl*y.layout.get("text-size").evaluate(E,{},ae)],ye[0]>Fd&&Kn(`${i.layerIds[0]}: Value for "text-size" is >= ${Gg}. Reduce your "text-size".`)):ke.kind==="composite"&&(ye=[Nl*X.compositeTextSizes[0].evaluate(E,{},ae),Nl*X.compositeTextSizes[1].evaluate(E,{},ae)],(ye[0]>Fd||ye[1]>Fd)&&Kn(`${i.layerIds[0]}: Value for "text-size" is >= ${Gg}. Reduce your "text-size".`)),i.addSymbols(i.text,ge,ye,A,w,E,j,n,s,I.lineStartIndex,I.lineLength,q,te,ae);for(const Ee of V)U[Ee]=i.text.placedSymbolArray.length-1;return 4*ge.length}function cE(i){for(const n in i)return i[n];return null}function J_(i,n,s,c,f,y,w,E,A,I){let j=w.top,V=w.bottom,U=w.left,q=w.right;const X=w.collisionPadding;if(X&&(U-=X[0],j-=X[1],q+=X[2],V+=X[3]),A){const te=new Ie(U,j),ae=new Ie(q,j),ge=new Ie(U,V),ke=new Ie(q,V),ye=gt(A);let Ee=new Ie(0,0);I&&(Ee=new Ie(I[0],I[1])),te._rotateAround(ye,Ee),ae._rotateAround(ye,Ee),ge._rotateAround(ye,Ee),ke._rotateAround(ye,Ee),U=Math.min(te.x,ae.x,ge.x,ke.x),q=Math.max(te.x,ae.x,ge.x,ke.x),j=Math.min(te.y,ae.y,ge.y,ke.y),V=Math.max(te.y,ae.y,ge.y,ke.y)}return i.emplaceBack(n.x,n.y,n.z,s.x,s.y,U,j,q,V,E,c,f,y),i.length-1}function V0(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const n=i.bottom-i.top;return n>0?Math.max(10,n):null}function M5(i,n,s,c){const f=i.compareText;if(n in f){const y=f[n];for(let w=y.length-1;w>=0;w--)if(c.dist(y[w])<s)return!0}else f[n]=[];return f[n].push(c),!1}function uE(i,n){const s=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*n:0,f=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),y=Math.sin(s)*f/Math.sin(Math.max(Math.PI/2-i._pitch-s,.01)),w=Math.sin(i._pitch)*y+f;return Math.min(1.01*w,f*(1/i._horizonShift))}function Mf(i,n){if(!n.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:n};const s=Math.pow(2,-i.z),c=i.x*s,f=(i.x+1)*s,y=i.y*s,w=(i.y+1)*s,E=Ji(c),A=Ji(f),I=cr(y),j=cr(w),V=n.project(E,I),U=n.project(A,I),q=n.project(A,j),X=n.project(E,j);let te=Math.min(V.x,U.x,q.x,X.x),ae=Math.min(V.y,U.y,q.y,X.y),ge=Math.max(V.x,U.x,q.x,X.x),ke=Math.max(V.y,U.y,q.y,X.y);const ye=s/16;function Ee(Me,Qe,Xe,mt,Mt,rt){const yt=(Xe+Mt)/2,_t=(mt+rt)/2,kt=n.project(Ji(yt),cr(_t)),Nt=Math.max(0,te-kt.x,ae-kt.y,kt.x-ge,kt.y-ke);te=Math.min(te,kt.x),ge=Math.max(ge,kt.x),ae=Math.min(ae,kt.y),ke=Math.max(ke,kt.y),Nt>ye&&(Ee(Me,kt,Xe,mt,yt,_t),Ee(kt,Qe,yt,_t,Mt,rt))}Ee(V,U,c,y,f,y),Ee(U,q,f,y,f,w),Ee(q,X,f,w,c,w),Ee(X,V,c,w,c,y),te-=ye,ae-=ye,ge+=ye,ke+=ye;const Pe=1/Math.max(ge-te,ke-ae);return{scale:Pe,x:te*Pe,y:ae*Pe,x2:ge*Pe,y2:ke*Pe,projection:n}}const P5=ya(new Float32Array(16));class Vd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new hn(0,0)}projectTilePoint(n,s,c){return{x:n,y:s,z:0}}locationPoint(n,s,c=!0){return n._coordinatePoint(n.locationCoordinate(s),c)}pixelsPerMeter(n,s){return oi(1,n)*s}pixelSpaceConversion(n,s,c){return 1}farthestPixelDistance(n){return uE(n,n.pixelsPerMeter)}pointCoordinate(n,s,c,f){const y=n.horizonLineFromTop(!1),w=new Ie(s,Math.max(y,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(w,f))}pointCoordinate3D(n,s,c){const f=new Ie(s,c);if(n.elevation)return n.elevation.pointCoordinate(f);{const y=this.pointCoordinate(n,f.x,f.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(n,s){if(n.elevation)return!this.pointCoordinate3D(n,s.x,s.y);const c=n.horizonLineFromTop();return s.y<c}createInversionMatrix(n,s){return P5}createTileMatrix(n,s,c){let f,y,w;const E=c.canonical,A=ya(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=Mf(E,this);f=1,y=I.x+c.wrap*I.scale,w=I.y,Cc(A,A,[f/I.scale,f/I.scale,n.pixelsPerMeter/s])}else f=s/n.zoomScale(E.z),y=(E.x+Math.pow(2,E.z)*c.wrap)*f,w=E.y*f;return Ec(A,A,[y,w,0]),Cc(A,A,[f/ln,f/ln,1]),A}upVector(n,s,c){return[0,0,1]}upVectorScale(n,s,c){return{metersToTile:1}}}class N5 extends Vd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,c]=this.parallels=n.parallels||[29.5,45.5],f=Math.sin(gt(s));this.n=(f+Math.sin(gt(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:c,c:f,r0:y}=this,w=gt(n-this.center[0]),E=gt(s),A=Math.sqrt(f-2*c*Math.sin(E))/c;return{x:A*Math.sin(w*c),y:A*Math.cos(w*c)-y,z:0}}unproject(n,s){const{n:c,c:f,r0:y}=this,w=y+s;let E=Math.atan2(n,Math.abs(w))*Math.sign(w);w*c<0&&(E-=Math.PI*Math.sign(n)*Math.sign(w));const A=gt(this.center[0])*c;E=fe(E,-Math.PI-A,Math.PI-A);const I=Se(ft(E/c)+this.center[0],-180,180),j=Math.asin(Se((f-(n*n+w*w)*c*c)/(2*c),-1,1)),V=Se(ft(j),-Yr,Yr);return new hn(I,V)}}const Hg=1.340264,Wg=-.081106,qg=893e-6,Zg=.003796,Q_=Math.sqrt(3)/2;class R5 extends Vd{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(Q_*Math.sin(s)),f=c*c,y=f*f*f;return{x:.5*(n*Math.cos(c)/(Q_*(Hg+3*Wg*f+y*(7*qg+9*Zg*f)))/Math.PI+.5),y:1-.5*(c*(Hg+Wg*f+y*(qg+Zg*f))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=c*c,y=f*f*f;for(let j,V,U,q=0;q<12&&(V=c*(Hg+Wg*f+y*(qg+Zg*f))-s,U=Hg+3*Wg*f+y*(7*qg+9*Zg*f),j=V/U,c=Se(c-j,-Math.PI/3,Math.PI/3),f=c*c,y=f*f*f,!(Math.abs(j)<1e-12));++q);const w=Q_*n*(Hg+3*Wg*f+y*(7*qg+9*Zg*f))/Math.cos(c),E=Math.asin(Math.sin(c)/Q_),A=Se(180*w/Math.PI,-180,180),I=Se(180*E/Math.PI,-Yr,Yr);return new hn(A,I)}}class D5 extends Vd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const c=360*(n-.5),f=Se(360*(.5-s),-Yr,Yr);return new hn(c,f)}}const lm=Math.PI/2;function ex(i){return Math.tan((lm+i)/2)}class L5 extends Vd{constructor(n){super(n),this.center=n.center||[0,30];const[s,c]=this.parallels=n.parallels||[30,30];let f=gt(s),y=gt(c);this.southernCenter=f+y<0,this.southernCenter&&(f=-f,y=-y);const w=Math.cos(f),E=ex(f);this.n=f===y?Math.sin(f):Math.log(w/Math.cos(y))/Math.log(ex(y)/E),this.f=w*Math.pow(ex(f),this.n)/this.n}project(n,s){s=gt(s),this.southernCenter&&(s=-s),n=gt(n-this.center[0]);const c=1e-6,{n:f,f:y}=this;y>0?s<-lm+c&&(s=-lm+c):s>lm-c&&(s=lm-c);const w=y/Math.pow(ex(s),f);let E=w*Math.sin(f*n),A=y-w*Math.cos(f*n);return E=.5*(E/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:E,y:this.southernCenter?A:1-A,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f}=this,y=f-s,w=Math.sign(y),E=Math.sign(c)*Math.sqrt(n*n+y*y);let A=Math.atan2(n,Math.abs(y))*w;y*c<0&&(A-=Math.PI*Math.sign(n)*w);const I=Se(ft(A/c)+this.center[0],-180,180),j=Se(ft(2*Math.atan(Math.pow(f/E,1/c))-lm),-Yr,Yr);return new hn(I,this.southernCenter?-j:j)}}class dE extends Vd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:kr(n),y:Fr(s),z:0}}unproject(n,s){const c=Ji(n),f=cr(s);return new hn(c,f)}}const hE=gt(Yr);class j5 extends Vd{project(n,s){const c=(s=gt(s))*s,f=c*c;return{x:.5*((n=gt(n))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=25,y=0,w=c*c;do{w=c*c;const I=w*w;y=(c*(1.007226+w*(.015085+I*(.028874*w-.044475-.005916*I)))-s)/(1.007226+w*(.045255+I*(.259866*w-.311325-.005916*11*I))),c=Se(c-y,-hE,hE)}while(Math.abs(y)>1e-6&&--f>0);w=c*c;const E=Se(ft(n/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),A=ft(c);return new hn(E,A)}}const fE=gt(Yr);class O5 extends Vd{project(n,s){s=gt(s),n=gt(n);const c=Math.cos(s),f=2/Math.PI,y=Math.acos(c*Math.cos(n/2)),w=Math.sin(y)/y,E=.5*(n*f+2*c*Math.sin(n/2)/w)||0,A=.5*(s+Math.sin(s)/w)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(n,s){let c=n=(2*n-.5)*Math.PI,f=s=(2*(1-s)-1)*Math.PI,y=25;const w=1e-6;let E=0,A=0;do{const I=Math.cos(f),j=Math.sin(f),V=2*j*I,U=j*j,q=I*I,X=Math.cos(c/2),te=Math.sin(c/2),ae=2*X*te,ge=te*te,ke=1-q*X*X,ye=ke?1/ke:0,Ee=ke?Math.acos(I*X)*Math.sqrt(1/ke):0,Pe=.5*(2*Ee*I*te+2*c/Math.PI)-n,Me=.5*(Ee*j+f)-s,Qe=.5*ye*(q*ge+Ee*I*X*U)+1/Math.PI,Xe=ye*(ae*V/4-Ee*j*te),mt=.125*ye*(V*te-Ee*j*q*ae),Mt=.5*ye*(U*X+Ee*ge*I)+.5,rt=Xe*mt-Mt*Qe;E=(Me*Xe-Pe*Mt)/rt,A=(Pe*mt-Me*Qe)/rt,c=Se(c-E,-Math.PI,Math.PI),f=Se(f-A,-fE,fE)}while((Math.abs(E)>w||Math.abs(A)>w)&&--y>0);return new hn(ft(c),ft(f))}}class pE extends Vd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(gt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:c,cosPhi:f}=this;return{x:gt(n)*f*c+.5,y:-Math.sin(gt(s))/f*c+.5,z:0}}unproject(n,s){const{scale:c,cosPhi:f}=this,y=-(s-.5)/c,w=Se(ft((n-.5)/c)/f,-180,180),E=Math.asin(Se(y*f,-1,1)),A=Se(ft(E),-Yr,Yr);return new hn(w,A)}}class z5 extends dE{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,c){const f=Jo(n,s,c);return Hr(f,f,Gs(No(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(n,s){const c=As(s.lat,s.lng),f=us([],c),y=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude;Ad(c,c,f,oi(1,0)*ln*y);const w=ya(new Float64Array(16));return Il(w,n.pixelMatrix,n.globeMatrix),Hr(c,c,w),new Ie(c[0],c[1])}pixelsPerMeter(n,s){return oi(1,0)*s}pixelSpaceConversion(n,s,c){const f=oi(1,n)*s,y=Yn(oi(1,45)*s,f,c);return this.pixelsPerMeter(n,s)/y}createTileMatrix(n,s,c){const f=Fp(No(c.canonical));return Il(new Float64Array(16),n.globeMatrix,f)}createInversionMatrix(n,s){const{center:c}=n,f=Gs(No(s));return lf(f,f,gt(c.lng)),Mp(f,f,gt(c.lat)),Cc(f,f,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(n,s,c,f){return _g(n,s,c,!0)||new Ic(0,0)}pointCoordinate3D(n,s,c){const f=this.pointCoordinate(n,s,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(n,s){return!_g(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=(function(f,y){const w=f.cameraToCenterDistance,E=f._centerAltitude*y,A=f._camera,I=f._camera.forward(),j=Ha([],zr([],I,-w),[0,0,E]),V=f.worldSize/(2*Math.PI),U=[0,0,-V],q=f.width/f.height,X=Math.tan(f.fovAboveCenter),te=zr([],A.up(),X),ae=zr([],A.right(),X*q),ge=us([],Ha([],Ha([],I,te),ae)),ke=[];let ye;if(new zp(j,ge).closestPointOnSphere(U,V,ke)){const Ee=Ha([],ke,U),Pe=Po([],Ee,j);ye=Math.cos(f.fovAboveCenter)*kd(Pe)}else{const Ee=Po([],j,U),Pe=Po([],U,j);us(Pe,Pe);const Me=kd(Ee)-V;ye=Math.sqrt(Me*(Me+2*V));const Qe=Math.acos(ye/(V+Me))-Math.acos(Mo(I,Pe));ye*=Math.cos(Qe)}return 1.01*ye})(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=Rd(n.zoom);if(c>0){const f=uE(n,oi(1,n.center.lat)*n.worldSize),y=n.worldSize/(2*Math.PI),w=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Yn(s,f+y*(1-Math.cos(w)),Math.pow(c,10))}return s}upVector(n,s,c){return Jo(s,c,n,1)}upVectorScale(n){return{metersToTile:Pd(gf(No(n)))}}}function mE(i){const n=i.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(i.name){case"mercator":return new dE(i);case"equirectangular":return new D5(i);case"naturalEarth":return new j5(i);case"equalEarth":return new R5(i);case"winkelTripel":return new O5(i);case"albers":return s?new pE(i):new N5(i);case"lambertConformalConic":return s?new pE(i):new L5(i);case"globe":return new z5(i)}throw new Error(`Invalid projection name: ${i.name}`)}const B5=En.types,F5=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function tx(i,n,s,c,f,y,w,E,A,I,j,V,U){const q=E?Math.min(Fd,Math.round(E[0])):0,X=E?Math.min(Fd,Math.round(E[1])):0;i.emplaceBack(n,s,Math.round(32*c),Math.round(32*f),y,w,(q<<1)+(A?1:0),X,16*I,16*j,256*V,256*U)}function nx(i,n,s,c,f,y,w){i.emplaceBack(n,s,c,f,y,w)}function rx(i,n,s,c,f){i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f)}function V5(i){for(const n of i.sections)if(pa(n.text))return!0;return!1}class U0{constructor(n){this.layoutVertexArray=new wt,this.indexArray=new tn,this.programConfigurations=n,this.segments=new si,this.dynamicLayoutVertexArray=new Ct,this.opacityVertexArray=new en,this.placedSymbolArray=new Gr,this.globeExtVertexArray=new It}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,XL.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,YL.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,F5,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,KL.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ft(U0,"SymbolBuffers");class $0{constructor(n,s,c){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new c,this.segments=new si,this.collisionVertexArray=new jn,this.collisionVertexArrayExt=new Fn}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,JL.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,QL.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ft($0,"CollisionBuffers");class Ud{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((w=>w.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ya([]),this.placementViewportMatrix=ya([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=P0(this.zoom,s["text-size"]),this.iconSizeData=P0(this.zoom,s["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),y=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map((w=>ba[w])),this.stateDependentLayerIds=this.layers.filter((w=>w.isStateDependent())).map((w=>w.id)),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new U0(new Sc(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new U0(new Sc(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new hi,this.lineVertexArray=new Dr,this.symbolInstances=new xr}calculateGlyphDependencies(n,s,c,f,y){for(let w=0;w<n.length;w++)if(s[n.charCodeAt(w)]=!0,f&&y){const E=Vg[n.charAt(w)];E&&(s[E.charCodeAt(0)]=!0)}}populate(n,s,c,f){const y=this.layers[0],w=y.layout,E=this.projection.name==="globe",A=w.get("text-font"),I=w.get("text-field"),j=w.get("icon-image"),V=(I.value.kind!=="constant"||I.value.value instanceof Ri&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),U=j.value.kind!=="constant"||!!j.value.value||Object.keys(j.parameters).length>0,q=w.get("symbol-sort-key");if(this.features=[],!V&&!U)return;const X=s.iconDependencies,te=s.glyphDependencies,ae=s.availableImages,ge=new B(this.zoom);for(const{feature:ke,id:ye,index:Ee,sourceLayerIndex:Pe}of n){const Me=y._featureFilter.needGeometry,Qe=Xa(ke,Me);if(!y._featureFilter.filter(ge,Qe,c))continue;if(Me||(Qe.geometry=Is(ke,c,f)),E&&ke.type!==1&&c.z<=5){const rt=Qe.geometry,yt=.98078528056,_t=(kt,Nt)=>Mo(Jo(kt.x,kt.y,c,1),Jo(Nt.x,Nt.y,c,1))<yt;for(let kt=0;kt<rt.length;kt++)rt[kt]=Ld(rt[kt],_t)}let Xe,mt;if(V){const rt=y.getValueAndResolveTokens("text-field",Qe,c,ae),yt=Ri.factory(rt);V5(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||C()==="unavailable"||this.hasRTLText&&D.isParsed())&&(Xe=n5(yt,y,Qe))}if(U){const rt=y.getValueAndResolveTokens("icon-image",Qe,c,ae);mt=rt instanceof ro?rt:ro.fromString(rt)}if(!Xe&&!mt)continue;const Mt=this.sortFeaturesByKey?q.evaluate(Qe,{},c):void 0;if(this.features.push({id:ye,text:Xe,icon:mt,index:Ee,sourceLayerIndex:Pe,geometry:Qe.geometry,properties:ke.properties,type:B5[ke.type],sortKey:Mt}),mt&&(X[mt.name]=!0),Xe){const rt=A.evaluate(Qe,{},c).join(","),yt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(ba.vertical)>=0;for(const _t of Xe.sections)if(_t.image)X[_t.image.name]=!0;else{const kt=Fa(Xe.toString()),Nt=_t.fontStack||rt,ht=te[Nt]=te[Nt]||{};this.calculateGlyphDependencies(_t.text,ht,yt,this.allowVerticalPlacement,kt)}}}w.get("symbol-placement")==="line"&&(this.features=(function(ke){const ye={},Ee={},Pe=[];let Me=0;function Qe(rt){Pe.push(ke[rt]),Me++}function Xe(rt,yt,_t){const kt=Ee[rt];return delete Ee[rt],Ee[yt]=kt,Pe[kt].geometry[0].pop(),Pe[kt].geometry[0]=Pe[kt].geometry[0].concat(_t[0]),kt}function mt(rt,yt,_t){const kt=ye[yt];return delete ye[yt],ye[rt]=kt,Pe[kt].geometry[0].shift(),Pe[kt].geometry[0]=_t[0].concat(Pe[kt].geometry[0]),kt}function Mt(rt,yt,_t){const kt=_t?yt[0][yt[0].length-1]:yt[0][0];return`${rt}:${kt.x}:${kt.y}`}for(let rt=0;rt<ke.length;rt++){const yt=ke[rt],_t=yt.geometry,kt=yt.text?yt.text.toString():null;if(!kt){Qe(rt);continue}const Nt=Mt(kt,_t),ht=Mt(kt,_t,!0);if(Nt in Ee&&ht in ye&&Ee[Nt]!==ye[ht]){const Bt=mt(Nt,ht,_t),Qt=Xe(Nt,ht,Pe[Bt].geometry);delete ye[Nt],delete Ee[ht],Ee[Mt(kt,Pe[Qt].geometry,!0)]=Qt,Pe[Bt].geometry=null}else Nt in Ee?Xe(Nt,ht,_t):ht in ye?mt(Nt,ht,_t):(Qe(rt),ye[Nt]=Me-1,Ee[ht]=Me-1)}return Pe.filter((rt=>rt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((ke,ye)=>ke.sortKey-ye.sortKey))}update(n,s,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,c,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=mE(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:f,y}of s)this.lineVertexArray.emplaceBack(f,y);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=n.indexArray,ae=n.layoutVertexArray,ge=n.globeExtVertexArray,ke=n.segments.prepareSegment(4*s.length,ae,te,this.canOverlap?w.sortKey:void 0),ye=this.glyphOffsetArray.length,Ee=ke.vertexLength,Pe=this.allowVerticalPlacement&&E===ba.vertical?Math.PI/2:0,Me=w.text&&w.text.sections;for(let Xe=0;Xe<s.length;Xe++){const{tl:mt,tr:Mt,bl:rt,br:yt,tex:_t,pixelOffsetTL:kt,pixelOffsetBR:Nt,minFontScaleX:ht,minFontScaleY:Bt,glyphOffset:Qt,isSDF:$t,sectionIndex:Rn}=s[Xe],Dt=ke.vertexLength,un=Qt[1];if(tx(ae,I.x,I.y,mt.x,un+mt.y,_t.x,_t.y,c,$t,kt.x,kt.y,ht,Bt),tx(ae,I.x,I.y,Mt.x,un+Mt.y,_t.x+_t.w,_t.y,c,$t,Nt.x,kt.y,ht,Bt),tx(ae,I.x,I.y,rt.x,un+rt.y,_t.x,_t.y+_t.h,c,$t,kt.x,Nt.y,ht,Bt),tx(ae,I.x,I.y,yt.x,un+yt.y,_t.x+_t.w,_t.y+_t.h,c,$t,Nt.x,Nt.y,ht,Bt),A){const{x:Dn,y:dr,z:Ln}=A.anchor,[bn,Lr,On]=A.up;nx(ge,Dn,dr,Ln,bn,Lr,On),nx(ge,Dn,dr,Ln,bn,Lr,On),nx(ge,Dn,dr,Ln,bn,Lr,On),nx(ge,Dn,dr,Ln,bn,Lr,On),rx(n.dynamicLayoutVertexArray,Dn,dr,Ln,Pe)}else rx(n.dynamicLayoutVertexArray,I.x,I.y,I.z,Pe);te.emplaceBack(Dt,Dt+1,Dt+2),te.emplaceBack(Dt+1,Dt+2,Dt+3),ke.vertexLength+=4,ke.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Qt[0]),Xe!==s.length-1&&Rn===s[Xe+1].sectionIndex||n.programConfigurations.populatePaintArrays(ae.length,w,w.index,{},q,X,Me&&Me[Rn])}const Qe=A?A.anchor:I;n.placedSymbolArray.emplaceBack(Qe.x,Qe.y,Qe.z,I.x,I.y,ye,this.glyphOffsetArray.length-ye,Ee,j,V,I.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],E,0,!1,0,U,0)}_commitLayoutVertex(n,s,c,f,y,w,E){n.emplaceBack(s,c,f,y,w,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,s,c,f,y,w,E){const A=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),I=A.vertexLength,j=E.tileAnchorX,V=E.tileAnchorY;for(let q=0;q<4;q++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,n.padding),c.collisionVertexArrayExt.emplaceBack(s,-n.padding,n.padding),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Ie(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Ie(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Ie(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Ie(n.x1,n.y2)),A.vertexLength+=4;const U=c.indexArray;U.emplaceBack(I,I+1),U.emplaceBack(I+1,I+2),U.emplaceBack(I+2,I+3),U.emplaceBack(I+3,I),A.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceTextSize(n,w,s,E);this._addCollisionDebugVertices(A,I,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceIconSize(n,s,w.placedIconSymbolIndex);this._addCollisionDebugVertices(A,I,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,w)}}generateCollisionDebugBuffers(n,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new $0(Wt,DS.members,$r),this.iconCollisionBox=new $0(Wt,DS.members,$r);const c=em(this.iconSizeData,n),f=em(this.textSizeData,n);for(let y=0;y<this.symbolInstances.length;y++){const w=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(f,n,s,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(f,n,s,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(c,n,s,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(c,n,s,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(n,s,c,f){const y=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:f),w=H_(this.textSizeData,n,y)/fs;return this.tilePixelRatio*w}getSymbolInstanceIconSize(n,s,c){const f=this.icon.placedSymbolArray.get(c),y=H_(this.iconSizeData,n,f);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(n,s,c){n.emplaceBack(s,-c,-c),n.emplaceBack(s,c,-c),n.emplaceBack(s,c,c),n.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceTextSize(n,w,s,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,I,A.padding)}}_updateIconDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceIconSize(n,s,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,I,A.padding)}}updateCollisionDebugBuffers(n,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=em(this.iconSizeData,n),f=em(this.textSizeData,n);for(let y=0;y<this.symbolInstances.length;y++){const w=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(f,n,s,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(f,n,s,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(c,n,s,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,n,s,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,c,f,y,w,E,A,I){const j={};if(s<c){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Pe}=n.get(s);j.textBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee},j.textFeatureIndex=Pe}if(f<y){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Pe}=n.get(f);j.verticalTextBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee},j.verticalTextFeatureIndex=Pe}if(w<E){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Pe}=n.get(w);j.iconBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee},j.iconFeatureIndex=Pe}if(A<I){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Pe}=n.get(A);j.verticalIconBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:ke,tileAnchorX:ye,tileAnchorY:Ee},j.verticalIconFeatureIndex=Pe}return j}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const c=n.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs;for(let y=c.vertexStartIndex;y<f;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),c=Math.cos(n),f=[],y=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const A=this.symbolInstances.get(E);f.push(0|Math.round(s*A.tileAnchorX+c*A.tileAnchorY)),y.push(A.featureIndex)}return w.sort(((E,A)=>f[E]-f[A]||y[A]-y[E])),w}addToSortKeyRanges(n,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:I}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),y>=0&&y!==f&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&w!==y&&w!==f&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft(Ud,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Ud.MAX_GLYPHS=65535,Ud.addDynamicAttributes=rx;const U5=new ve({"symbol-placement":new Q(pt.layout_symbol["symbol-placement"]),"symbol-spacing":new Q(pt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Q(pt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new le(pt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Q(pt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Q(pt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Q(pt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Q(pt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Q(pt.layout_symbol["icon-rotation-alignment"]),"icon-size":new le(pt.layout_symbol["icon-size"]),"icon-text-fit":new Q(pt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Q(pt.layout_symbol["icon-text-fit-padding"]),"icon-image":new le(pt.layout_symbol["icon-image"]),"icon-rotate":new le(pt.layout_symbol["icon-rotate"]),"icon-padding":new Q(pt.layout_symbol["icon-padding"]),"icon-keep-upright":new Q(pt.layout_symbol["icon-keep-upright"]),"icon-offset":new le(pt.layout_symbol["icon-offset"]),"icon-anchor":new le(pt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Q(pt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Q(pt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Q(pt.layout_symbol["text-rotation-alignment"]),"text-field":new le(pt.layout_symbol["text-field"]),"text-font":new le(pt.layout_symbol["text-font"]),"text-size":new le(pt.layout_symbol["text-size"]),"text-max-width":new le(pt.layout_symbol["text-max-width"]),"text-line-height":new le(pt.layout_symbol["text-line-height"]),"text-letter-spacing":new le(pt.layout_symbol["text-letter-spacing"]),"text-justify":new le(pt.layout_symbol["text-justify"]),"text-radial-offset":new le(pt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Q(pt.layout_symbol["text-variable-anchor"]),"text-anchor":new le(pt.layout_symbol["text-anchor"]),"text-max-angle":new Q(pt.layout_symbol["text-max-angle"]),"text-writing-mode":new Q(pt.layout_symbol["text-writing-mode"]),"text-rotate":new le(pt.layout_symbol["text-rotate"]),"text-padding":new Q(pt.layout_symbol["text-padding"]),"text-keep-upright":new Q(pt.layout_symbol["text-keep-upright"]),"text-transform":new le(pt.layout_symbol["text-transform"]),"text-offset":new le(pt.layout_symbol["text-offset"]),"text-allow-overlap":new Q(pt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Q(pt.layout_symbol["text-ignore-placement"]),"text-optional":new Q(pt.layout_symbol["text-optional"])});var G0={paint:new ve({"icon-opacity":new le(pt.paint_symbol["icon-opacity"]),"icon-color":new le(pt.paint_symbol["icon-color"]),"icon-halo-color":new le(pt.paint_symbol["icon-halo-color"]),"icon-halo-width":new le(pt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new le(pt.paint_symbol["icon-halo-blur"]),"icon-translate":new Q(pt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Q(pt.paint_symbol["icon-translate-anchor"]),"text-opacity":new le(pt.paint_symbol["text-opacity"]),"text-color":new le(pt.paint_symbol["text-color"],{runtimeType:ws,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new le(pt.paint_symbol["text-halo-color"]),"text-halo-width":new le(pt.paint_symbol["text-halo-width"]),"text-halo-blur":new le(pt.paint_symbol["text-halo-blur"]),"text-translate":new Q(pt.paint_symbol["text-translate"]),"text-translate-anchor":new Q(pt.paint_symbol["text-translate-anchor"])}),layout:U5};class gE{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:sa,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft(gE,"FormatSectionOverride",{omit:["defaultValue"]});class ix extends ga{constructor(n){super(n,G0)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const y of c)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,s,c,f){const y=this.layout.get(n).evaluate(s,{},c,f),w=this._unevaluatedLayout._values[n];return w.isDataDriven()||_l(w.value)||!y?y:(function(E,A){return A.replace(/{([^{}]+)}/g,((I,j)=>j in E?String(E[j]):""))})(s.properties,y)}createBucket(n){return new Ud(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of G0.paint.overridableProperties){if(!ix.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),c=new gE(s),f=new yu(c,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new _u("source",f):new ja("composite",f,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new de(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&ix.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const c=n.get("text-field"),f=G0.paint.properties[s];let y=!1;const w=E=>{for(const A of E)if(f.overrides&&f.overrides.hasOverride(A))return void(y=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Ri)w(c.value.value.sections);else if(c.value.kind==="source"){const E=I=>{y||(I instanceof To&&Br(I.value)===cl?w(I.value.sections):I instanceof $o?w(I.sections):I.eachChild(E))},A=c.value;A._styleExpression&&E(A._styleExpression.expression)}return y}getProgramConfiguration(n){return new kl(this,n)}}var $5={paint:new ve({"background-color":new Q(pt.paint_background["background-color"]),"background-pattern":new Q(pt.paint_background["background-pattern"]),"background-opacity":new Q(pt.paint_background["background-opacity"])})},G5={paint:new ve({"raster-opacity":new Q(pt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Q(pt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Q(pt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Q(pt.paint_raster["raster-brightness-max"]),"raster-saturation":new Q(pt.paint_raster["raster-saturation"]),"raster-contrast":new Q(pt.paint_raster["raster-contrast"]),"raster-resampling":new Q(pt.paint_raster["raster-resampling"]),"raster-fade-duration":new Q(pt.paint_raster["raster-fade-duration"])})};class H5 extends ga{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var W5={paint:new ve({"sky-type":new Q(pt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Q(pt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Q(pt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Q(pt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Q(pt.paint_sky["sky-gradient-radius"]),"sky-gradient":new _e(pt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Q(pt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Q(pt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Q(pt.paint_sky["sky-opacity"])})};function H0(i,n,s){const c=[0,0,1],f=df([]);return gg(f,f,s?-gt(i)+Math.PI:gt(i)),R_(f,f,-gt(n)),Dp(c,c,f),us(c,c)}const q5={circle:class extends ga{constructor(i){super(i,z_)}createBucket(i){return new Ru(i)}queryRadius(i){const n=i;return Du("circle-radius",this,n)+Du("circle-stroke-width",this,n)+jd(this.paint.get("circle-translate"))}queryIntersectsFeature(i,n,s,c,f,y,w,E){const A=Wp(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return Cg(i,c,y,w,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,I)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new kl(this,i)}},heatmap:class extends ga{createBucket(i){return new Ag(i)}constructor(i){super(i,mi),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Pg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Du("heatmap-radius",this,i)}queryIntersectsFeature(i,n,s,c,f,y,w,E){const A=this.paint.get("heatmap-radius").evaluate(n,s);return Cg(i,c,y,w,E,!0,!0,new Ie(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new kl(this,i)}},hillshade:class extends ga{constructor(i){super(i,B_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ga{constructor(i){super(i,F)}getProgramIds(){const i=this.paint.get("fill-pattern"),n=i&&i.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(i){return new kl(this,i)}recalculate(i,n){super.recalculate(i,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new S(i)}queryRadius(){return jd(this.paint.get("fill-translate"))}queryIntersectsFeature(i,n,s,c,f,y){return!i.queryGeometry.isAboveHorizon&&vf(Pc(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends ga{constructor(i){super(i,VL)}createBucket(i){return new zg(i)}queryRadius(){return jd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new kl(this,i)}queryIntersectsFeature(i,n,s,c,f,y,w,E,A){const I=Wp(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),j=this.paint.get("fill-extrusion-height").evaluate(n,s),V=this.paint.get("fill-extrusion-base").evaluate(n,s),U=[0,0],q=E&&y.elevation,X=y.elevation?y.elevation.exaggeration():1,te=i.tile.getBucket(this);if(q&&te instanceof zg){const Ee=te.centroidVertexArray,Pe=A+1;Pe<Ee.length&&(U[0]=Ee.geta_centroid_pos0(Pe),U[1]=Ee.geta_centroid_pos1(Pe))}if(U[0]===0&&U[1]===1)return!1;y.projection.name==="globe"&&(c=CS([c],[new Ie(0,0),new Ie(ln,ln)],i.tileID.canonical).map((Ee=>Ee.polygon)).flat());const ae=q?E:null,[ge,ke]=(function(Ee,Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t,kt){return Ee.projection.name==="globe"?(function(Nt,ht,Bt,Qt,$t,Rn,Dt,un,Dn,dr,Ln){const bn=[],Lr=[],On=Nt.projection.upVectorScale(Ln,Nt.center.lat,Nt.worldSize).metersToTile,zn=[0,0,0,1],wr=[0,0,0,1],Ir=(br,Wr,ai,Ti)=>{br[0]=Wr,br[1]=ai,br[2]=Ti,br[3]=1},Mr=ES();Bt>0&&(Bt+=Mr),Qt+=Mr;for(const br of ht){const Wr=[],ai=[];for(const Ti of br){const Tr=Ti.x+$t.x,Bi=Ti.y+$t.y,Si=Nt.projection.projectTilePoint(Tr,Bi,Ln),Qr=Nt.projection.upVector(Ln,Ti.x,Ti.y);let mr=Bt,Ei=Qt;if(Dt){const Pr=MS(Tr,Bi,Bt,Qt,Dt,un,Dn,dr);mr+=Pr.base,Ei+=Pr.top}Bt!==0?Ir(zn,Si.x+Qr[0]*On*mr,Si.y+Qr[1]*On*mr,Si.z+Qr[2]*On*mr):Ir(zn,Si.x,Si.y,Si.z),Ir(wr,Si.x+Qr[0]*On*Ei,Si.y+Qr[1]*On*Ei,Si.z+Qr[2]*On*Ei),Hr(zn,zn,Rn),Hr(wr,wr,Rn),Wr.push(new Qp(zn[0],zn[1],zn[2])),ai.push(new Qp(wr[0],wr[1],wr[2]))}bn.push(Wr),Lr.push(ai)}return[bn,Lr]})(Ee,Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t,kt):Mt?(function(Nt,ht,Bt,Qt,$t,Rn,Dt,un,Dn){const dr=[],Ln=[],bn=[0,0,0,1];for(const Lr of Nt){const On=[],zn=[];for(const wr of Lr){const Ir=wr.x+Qt.x,Mr=wr.y+Qt.y,br=MS(Ir,Mr,ht,Bt,Rn,Dt,un,Dn);bn[0]=Ir,bn[1]=Mr,bn[2]=br.base,bn[3]=1,kc(bn,bn,$t),bn[3]=Math.max(bn[3],1e-5);const Wr=new Qp(bn[0]/bn[3],bn[1]/bn[3],bn[2]/bn[3]);bn[0]=Ir,bn[1]=Mr,bn[2]=br.top,bn[3]=1,kc(bn,bn,$t),bn[3]=Math.max(bn[3],1e-5);const ai=new Qp(bn[0]/bn[3],bn[1]/bn[3],bn[2]/bn[3]);On.push(Wr),zn.push(ai)}dr.push(On),Ln.push(zn)}return[dr,Ln]})(Pe,Me,Qe,Xe,mt,Mt,rt,yt,_t):(function(Nt,ht,Bt,Qt,$t){const Rn=[],Dt=[],un=$t[8]*ht,Dn=$t[9]*ht,dr=$t[10]*ht,Ln=$t[11]*ht,bn=$t[8]*Bt,Lr=$t[9]*Bt,On=$t[10]*Bt,zn=$t[11]*Bt;for(const wr of Nt){const Ir=[],Mr=[];for(const br of wr){const Wr=br.x+Qt.x,ai=br.y+Qt.y,Ti=$t[0]*Wr+$t[4]*ai+$t[12],Tr=$t[1]*Wr+$t[5]*ai+$t[13],Bi=$t[2]*Wr+$t[6]*ai+$t[14],Si=$t[3]*Wr+$t[7]*ai+$t[15],Qr=Ti+un,mr=Tr+Dn,Ei=Bi+dr,Pr=Math.max(Si+Ln,1e-5),go=Ti+bn,Ci=Tr+Lr,ps=Bi+On,ts=Math.max(Si+zn,1e-5);Ir.push(new Qp(Qr/Pr,mr/Pr,Ei/Pr)),Mr.push(new Qp(go/ts,Ci/ts,ps/ts))}Rn.push(Ir),Dt.push(Mr)}return[Rn,Dt]})(Pe,Me,Qe,Xe,mt)})(y,c,V,j,I,w,ae,U,X,y.center.lat,i.tileID.canonical),ye=i.queryGeometry;return(function(Ee,Pe,Me){let Qe=1/0;vf(Me,Pe)&&(Qe=IS(Me,Pe[0]));for(let Xe=0;Xe<Pe.length;Xe++){const mt=Pe[Xe],Mt=Ee[Xe];for(let rt=0;rt<mt.length-1;rt++){const yt=mt[rt],_t=[yt,mt[rt+1],Mt[rt+1],Mt[rt],yt];$p(Me,_t)&&(Qe=Math.min(Qe,IS(Me,_t)))}}return Qe!==1/0&&Qe})(ge,ke,ye.isPointQuery()?ye.screenBounds:ye.screenGeometry)}},line:class extends ga{constructor(i){super(i,PS),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Bh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,n){super.recalculate(i,n),this.paint._values["line-floorwidth"]=NS.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new G_(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new kl(this,i)}queryRadius(i){const n=i,s=RS(Du("line-width",this,n),Du("line-gap-width",this,n)),c=Du("line-offset",this,n);return s/2+Math.abs(c)+jd(this.paint.get("line-translate"))}queryIntersectsFeature(i,n,s,c,f,y){if(i.queryGeometry.isAboveHorizon)return!1;const w=Pc(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),E=i.pixelToTileUnitsFactor/2*RS(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),A=this.paint.get("line-offset").evaluate(n,s);return A&&(c=(function(I,j){const V=[],U=new Ie(0,0);for(let q=0;q<I.length;q++){const X=I[q],te=[];for(let ae=0;ae<X.length;ae++){const ge=X[ae],ke=X[ae+1],ye=ae===0?U:ge.sub(X[ae-1])._unit()._perp(),Ee=ae===X.length-1?U:ke.sub(ge)._unit()._perp(),Pe=ye._add(Ee)._unit();Pe._mult(1/(Pe.x*Ee.x+Pe.y*Ee.y)),te.push(Pe._mult(j)._add(ge))}V.push(te)}return V})(c,A*i.pixelToTileUnitsFactor)),(function(I,j,V){for(let U=0;U<j.length;U++){const q=j[U];if(I.length>=3){for(let X=0;X<q.length;X++)if(Pl(I,q[X]))return!0}if(Ws(I,q,V))return!0}return!1})(w,c,E)}isTileClipped(){return!0}},symbol:ix,background:class extends ga{constructor(i){super(i,$5)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ga{constructor(i){super(i,G5)}getProgramIds(){return["raster"]}},sky:class extends ga{constructor(i){super(i,W5),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Pg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(i,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,y=i.style.light,w=y.properties.get("position");return f&&y.properties.get("anchor")==="viewport"&&Kn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?H0(w.azimuthal,90-w.polar,n):H0(c[0],90-c[1],n)}const s=this.paint.get("sky-gradient-center");return H0(s[0],90-s[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Xg{constructor(n,s,c,f){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(s,f)}update(n,s,c){const{width:f,height:y}=n,{context:w}=this,{gl:E}=w,{HTMLImageElement:A,HTMLCanvasElement:I,HTMLVideoElement:j,ImageData:V,ImageBitmap:U}=k;if(E.bindTexture(E.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===y){const{x:q,y:X}=c||{x:0,y:0};n instanceof A||n instanceof I||n instanceof j||n instanceof V||U&&n instanceof U?E.texSubImage2D(E.TEXTURE_2D,0,q,X,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,q,X,f,y,E.RGBA,E.UNSIGNED_BYTE,n.data)}else this.size=[f,y],n instanceof A||n instanceof I||n instanceof j||n instanceof V||U&&n instanceof U?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,f,y,0,this.format,E.UNSIGNED_BYTE,n.data);this.useMipmap=!!(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(n,s){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),n!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?n===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:n),this.filter=n),s!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class Z5{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class X5{constructor(){this.tasks={},this.taskQueue=[],on(["process"],this),this.invoker=new Z5(this.process),this.nextId=0}add(n,s){const c=this.nextId++,f=(function({type:y,isSymbolTile:w,zoom:E}){return E=E||0,y==="message"?0:y!=="maybePrepare"||w?y!=="parseTile"||w?y==="parseTile"&&w?300-E:y==="maybePrepare"&&w?400-E:500:200-E:100-E})(s);return f===0?(xi(),n(),{cancel:()=>{}}):(this.tasks[c]={fn:n,metadata:s,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}})}process(){xi();{if(this.taskQueue=this.taskQueue.filter((c=>!!this.tasks[c])),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}}pick(){let n=null,s=1/0;for(let f=0;f<this.taskQueue.length;f++){const y=this.tasks[this.taskQueue[f]];y.priority<s&&(s=y.priority,n=f)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class yE{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const c=n[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const K5=["tile","layer","source","sourceLayer","state"];class _E{constructor(n,s,c,f,y){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=c,this._y=f,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const s of K5)this[s]!==void 0&&(n[s]=this[s]);return n}}const Ya=32,Lc=33,$d=new Uint16Array(8184);for(let i=0;i<2046;i++){let n=i+2,s=0,c=0,f=0,y=0,w=0,E=0;for(1&n?f=y=w=Ya:s=c=E=Ya;(n>>=1)>1;){const I=s+f>>1,j=c+y>>1;1&n?(f=s,y=c,s=w,c=E):(s=f,c=y,f=w,y=E),w=I,E=j}const A=4*i;$d[A+0]=s,$d[A+1]=c,$d[A+2]=f,$d[A+3]=y}const jc=new Uint16Array(2178),Gd=new Uint8Array(1089),sx=new Uint16Array(1089);function xE(i){return i===0?-.03125:i===32?.03125:0}var vE=$e([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const wE={type:2,extent:ln,loadGeometry:()=>[[new Ie(0,0),new Ie(ln+1,0),new Ie(ln+1,ln+1),new Ie(0,ln+1),new Ie(0,0)]]};class W0{constructor(n,s,c,f,y){this.tileID=n,this.uid=sn(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<Fo.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Mf(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,c){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(f,y){const w={};if(!y)return w;for(const E of f){const A=E.layerIds.map((I=>y.getLayer(I))).filter(Boolean);if(A.length!==0){E.layers=A,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((I=>A.filter((j=>j.id===I))[0])));for(const I of A)w[I.id]=E}}return w})(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof Ud){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof Ud&&y.hasRTLText){this.hasRTLText=!0,D.isLoading()||D.isLoaded()||C()!=="deferred"||R();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(f).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new pr}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(n)}const s=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Xg(n,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Xg(n,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Xg(n,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,s,c,f,y,w,E,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:E,transform:w,params:y,tileTransform:this.tileTransform},n,s,c):{}}querySourceFeatures(n,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),y=s?s.sourceLayer:"",w=f._geojsonTileLayer||f[y];if(!w)return;const E=gc(s&&s.filter),{z:A,x:I,y:j}=this.tileID.canonical,V={z:A,x:I,y:j};for(let U=0;U<w.length;U++){const q=w.feature(U);if(E.needGeometry){const ae=Xa(q,!0);if(!E.filter(new B(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!E.filter(new B(this.tileID.overscaledZ),q))continue;const X=c.getId(q,y),te=new _E(q,A,I,j,X);te.tile=V,n.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const c=Zr(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const y=this.expirationTime-s;y?this.expirationTime=c+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),f=s.style.listImages();for(const y in this.buckets){if(!s.style.hasLayer(y))continue;const w=this.buckets[y],E=w.layers[0].sourceLayer||"_geojsonTileLayer",A=c[E],I=n[E];if(!A||!I||Object.keys(I).length===0)continue;if(w.update(I,A,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof G_||w instanceof S){const V=s.style._getSourceCache(w.layers[0].source);s._terrain&&s._terrain.enabled&&V&&w.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(V.id,this.tileID)}const j=s&&s.style&&s.style.getLayer(y);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Fo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=Fo.now()+n}setTexture(n,s){const c=s.context,f=c.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new Xg(c,n,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(n,s){const c={};for(const f of s)c[f]=!0;this.dependencies[n]=c}hasDependency(n,s){for(const c of n){const f=this.dependencies[c];if(f){for(const y of s)if(f[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=Is(wE,this.tileID.canonical,this.tileTransform)[0],f=new At,y=new $s;for(let w=0;w<c.length;w++){const{x:E,y:A}=c[w];f.emplaceBack(E,A),y.emplaceBack(w)}y.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(y),this._tileDebugBuffer=n.createVertexBuffer(f,ff.members),this._tileDebugSegments=si.simpleSegment(0,0,f.length,y.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=Is(wE,this.tileID.canonical,this.tileTransform)[0];let f,y;if(this.isRaster){const w=(function(E,A){const I=Mf(E,A),j=Math.pow(2,E.z);for(let ae=0;ae<Lc;ae++)for(let ge=0;ge<Lc;ge++){const ke=Ji((E.x+(ge+xE(ge))/Ya)/j),ye=cr((E.y+(ae+xE(ae))/Ya)/j),Ee=A.project(ke,ye),Pe=ae*Lc+ge;jc[2*Pe+0]=Math.round((Ee.x*I.scale-I.x)*ln),jc[2*Pe+1]=Math.round((Ee.y*I.scale-I.y)*ln)}Gd.fill(0),sx.fill(0);for(let ae=2045;ae>=0;ae--){const ge=4*ae,ke=$d[ge+0],ye=$d[ge+1],Ee=$d[ge+2],Pe=$d[ge+3],Me=ke+Ee>>1,Qe=ye+Pe>>1,Xe=Me+Qe-ye,mt=Qe+ke-Me,Mt=ye*Lc+ke,rt=Pe*Lc+Ee,yt=Qe*Lc+Me,_t=Math.hypot((jc[2*Mt+0]+jc[2*rt+0])/2-jc[2*yt+0],(jc[2*Mt+1]+jc[2*rt+1])/2-jc[2*yt+1])>=16;Gd[yt]=Gd[yt]||(_t?1:0),ae<1022&&(Gd[yt]=Gd[yt]||Gd[(ye+mt>>1)*Lc+(ke+Xe>>1)]||Gd[(Pe+mt>>1)*Lc+(Ee+Xe>>1)])}const V=new ct,U=new tn;let q=0;function X(ae,ge){const ke=ge*Lc+ae;return sx[ke]===0&&(V.emplaceBack(jc[2*ke+0],jc[2*ke+1],ae*ln/Ya,ge*ln/Ya),sx[ke]=++q),sx[ke]-1}function te(ae,ge,ke,ye,Ee,Pe){const Me=ae+ke>>1,Qe=ge+ye>>1;if(Math.abs(ae-Ee)+Math.abs(ge-Pe)>1&&Gd[Qe*Lc+Me])te(Ee,Pe,ae,ge,Me,Qe),te(ke,ye,Ee,Pe,Me,Qe);else{const Xe=X(ae,ge),mt=X(ke,ye),Mt=X(Ee,Pe);U.emplaceBack(Xe,mt,Mt)}}return te(0,0,Ya,Ya,Ya,0),te(Ya,Ya,0,0,0,Ya),{vertices:V,indices:U}})(this.tileID.canonical,s);f=w.vertices,y=w.indices}else{f=new ct,y=new tn;for(const{x:E,y:A}of c)f.emplaceBack(E,A,0,0);const w=Yp(f.int16,void 0,4);for(let E=0;E<w.length;E+=3)y.emplaceBack(w[E],w[E+1],w[E+2])}this._tileBoundsBuffer=n.createVertexBuffer(f,vE.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(y),this._tileBoundsSegments=si.simpleSegment(0,0,f.length,y.length)}_makeGlobeTileDebugBuffers(n,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const f=this.tileID.canonical,y=Gs(xg(f,s)),w=Rd(s.zoom);let E;w>0&&(E=Io(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,f,s,y,E,w),this._makeGlobeTileDebugTextBuffer(n,f,s,y,E,w)}_globePoint(n,s,c,f,y,w,E){let A=Jo(n,s,c);if(w){const I=1<<c.z,j=kr(f.center.lng),V=Fr(f.center.lat),U=(c.x+.5)/I-j;let q=0;U>.5?q=-1:U<-.5&&(q=1);let X=(n/ln+c.x)/I+q,te=(s/ln+c.y)/I;X=(X-j)*f._pixelsPerMercatorPixel+j,te=(te-V)*f._pixelsPerMercatorPixel+V;const ae=[X*f.worldSize,te*f.worldSize,0];Hr(ae,ae,w),A=Ml(A,ae,E)}return Hr(A,A,y)}_makeGlobeTileDebugBorderBuffer(n,s,c,f,y,w){const E=new At,A=new $s,I=new qe,j=(U,q,X,te,ae)=>{const ge=(X-U)/(ae-1),ke=(te-q)/(ae-1),ye=E.length;for(let Ee=0;Ee<ae;Ee++){const Pe=U+Ee*ge,Me=q+Ee*ke;E.emplaceBack(Pe,Me);const Qe=this._globePoint(Pe,Me,s,c,f,y,w);I.emplaceBack(Qe[0],Qe[1],Qe[2]),A.emplaceBack(ye+Ee)}},V=ln;j(0,0,V,0,16),j(V,0,V,V,16),j(V,V,0,V,16),j(0,V,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(A),this._tileDebugBuffer=n.createVertexBuffer(E,ff.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(I,Wa.members),this._tileDebugSegments=si.simpleSegment(0,0,E.length,A.length)}_makeGlobeTileDebugTextBuffer(n,s,c,f,y,w){const E=ln/4,A=new At,I=new tn,j=new qe,V=25;I.reserve(32),A.reserve(V),j.reserve(V);const U=(q,X)=>V*q+X;for(let q=0;q<V;q++){const X=q*E;for(let te=0;te<V;te++){const ae=te*E;A.emplaceBack(ae,X);const ge=this._globePoint(ae,X,s,c,f,y,w);j.emplaceBack(ge[0],ge[1],ge[2])}}for(let q=0;q<4;q++)for(let X=0;X<4;X++){const te=U(q,X),ae=U(q,X+1),ge=U(q+1,X),ke=U(q+1,X+1);I.emplaceBack(te,ae,ge),I.emplaceBack(ge,ae,ke)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(I),this._tileDebugTextBuffer=n.createVertexBuffer(A,ff.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(j,Wa.members),this._tileDebugTextSegments=si.simpleSegment(0,0,V,32)}}class Y5{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,c){const f=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][f]=this.stateChanges[n][f]||{},Tt(this.stateChanges[n][f],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==f&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][f]===null){this.deletedStates[n][f]={};for(const y in this.state[n][f])c[y]||(this.deletedStates[n][f][y]=null)}else for(const y in c)this.deletedStates[n]&&this.deletedStates[n][f]&&this.deletedStates[n][f][y]===null&&delete this.deletedStates[n][f][y]}removeFeatureState(n,s,c){if(this.deletedStates[n]===null)return;const f=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&s!==void 0)this.deletedStates[n][f]!==null&&(this.deletedStates[n][f]=this.deletedStates[n][f]||{},this.deletedStates[n][f][c]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][f])for(c in this.deletedStates[n][f]={},this.stateChanges[n][f])this.deletedStates[n][f][c]=null;else this.deletedStates[n][f]=null;else this.deletedStates[n]=null}getState(n,s){const c=String(s),f=Tt({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][s];if(y===null)return{};for(const w in y)delete f[w]}return f}initializeTileState(n,s){n.setFeatureState(this.state,s)}coalesceChanges(n,s){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const w in this.stateChanges[f])this.state[f][w]||(this.state[f][w]={}),Tt(this.state[f][w],this.stateChanges[f][w]),y[w]=this.state[f][w];c[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const w in this.state[f])y[w]={},this.state[f][w]={};else for(const w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else if(this.state[f][w])for(const E of Object.keys(this.deletedStates[f][w]))delete this.state[f][w][E];y[w]=this.state[f][w]}c[f]=c[f]||{},Tt(c[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in n)n[f].setFeatureState(c,s)}}class bE{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const c=this.toIdx(n,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function TE(i,n,s,c){let f=0,y=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(c[w])<1e-15){if(s[w]<i[w]||s[w]>n[w])return null}else{const E=1/c[w];let A=(i[w]-s[w])*E,I=(n[w]-s[w])*E;if(A>I){const j=A;A=I,I=j}if(A>f&&(f=A),I<y&&(y=I),f>y)return null}return f}function SE(i,n,s,c,f,y,w,E,A,I,j){const V=c-i,U=f-n,q=y-s,X=w-i,te=E-n,ae=A-s,ge=j[1]*ae-j[2]*te,ke=j[2]*X-j[0]*ae,ye=j[0]*te-j[1]*X,Ee=V*ge+U*ke+q*ye;if(Math.abs(Ee)<1e-15)return null;const Pe=1/Ee,Me=I[0]-i,Qe=I[1]-n,Xe=I[2]-s,mt=(Me*ge+Qe*ke+Xe*ye)*Pe;if(mt<0||mt>1)return null;const Mt=Qe*q-Xe*U,rt=Xe*V-Me*q,yt=Me*U-Qe*V,_t=(j[0]*Mt+j[1]*rt+j[2]*yt)*Pe;return _t<0||mt+_t>1?null:(X*Mt+te*rt+ae*yt)*Pe}function EE(i,n,s){return(i-n)/(s-n)}function CE(i,n,s,c,f,y,w,E,A){const I=1<<s,j=y-c,V=w-f,U=(i+1)/I*j+c,q=(n+0)/I*V+f,X=(n+1)/I*V+f;E[0]=(i+0)/I*j+c,E[1]=q,A[0]=U,A[1]=X}class kE{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=(function(y){const w=Math.ceil(Math.log2(y.dim/8)),E=[];let A=Math.ceil(Math.pow(2,w));const I=1/A,j=(q,X,te,ae,ge)=>{const ke=ae?1:0,ye=(q+1)*te-ke,Ee=X*te,Pe=(X+1)*te-ke;ge[0]=q*te,ge[1]=Ee,ge[2]=ye,ge[3]=Pe};let V=new bE(A);const U=[];for(let q=0;q<A*A;q++){j(q%A,Math.floor(q/A),I,!1,U);const X=Hd(U[0],U[1],y),te=Hd(U[2],U[1],y),ae=Hd(U[2],U[3],y),ge=Hd(U[0],U[3],y);V.minimums.push(Math.min(X,te,ae,ge)),V.maximums.push(Math.max(X,te,ae,ge)),V.leaves.push(1)}for(E.push(V),A/=2;A>=1;A/=2){const q=E[E.length-1];V=new bE(A);for(let X=0;X<A*A;X++){j(X%A,Math.floor(X/A),2,!0,U);const te=q.getElevation(U[0],U[1]),ae=q.getElevation(U[2],U[1]),ge=q.getElevation(U[2],U[3]),ke=q.getElevation(U[0],U[3]),ye=q.isLeaf(U[0],U[1]),Ee=q.isLeaf(U[2],U[1]),Pe=q.isLeaf(U[2],U[3]),Me=q.isLeaf(U[0],U[3]),Qe=Math.min(te.min,ae.min,ge.min,ke.min),Xe=Math.max(te.max,ae.max,ge.max,ke.max),mt=ye&&Ee&&Pe&&Me;V.maximums.push(Xe),V.minimums.push(Qe),V.leaves.push(Xe-Qe<=5&&mt?1:0)}E.push(V)}return E})(this.dem),c=s.length-1,f=s[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(n,s,c,f,y,w,E=1){return TE([n,s,-100],[c,f,this.maximums[0]*E],y,w)}raycast(n,s,c,f,y,w,E=1){if(!this.nodeCount)return null;const A=this.raycastRoot(n,s,c,f,y,w,E);if(A==null)return null;const I=[],j=[],V=[],U=[],q=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:X,t:te,nodex:ae,nodey:ge,depth:ke}=q.pop();if(this.leaves[X]){CE(ae,ge,ke,n,s,c,f,V,U);const Ee=1<<ke,Pe=(ae+0)/Ee,Me=(ae+1)/Ee,Qe=(ge+0)/Ee,Xe=(ge+1)/Ee,mt=Hd(Pe,Qe,this.dem)*E,Mt=Hd(Me,Qe,this.dem)*E,rt=Hd(Me,Xe,this.dem)*E,yt=Hd(Pe,Xe,this.dem)*E,_t=SE(V[0],V[1],mt,U[0],V[1],Mt,U[0],U[1],rt,y,w),kt=SE(U[0],U[1],rt,V[0],U[1],yt,V[0],V[1],mt,y,w),Nt=Math.min(_t!==null?_t:Number.MAX_VALUE,kt!==null?kt:Number.MAX_VALUE);if(Nt!==Number.MAX_VALUE)return Nt;{const ht=Ad([],y,w,te);if(AE(mt,Mt,yt,rt,EE(ht[0],V[0],U[0]),EE(ht[1],V[1],U[1]))>=ht[2])return te}continue}let ye=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){CE((ae<<1)+this._siblingOffset[Ee][0],(ge<<1)+this._siblingOffset[Ee][1],ke+1,n,s,c,f,V,U),V[2]=-100,U[2]=this.maximums[this.childOffsets[X]+Ee]*E;const Pe=TE(V,U,y,w);if(Pe!=null){const Me=Pe;I[Ee]=Me;let Qe=!1;for(let Xe=0;Xe<ye&&!Qe;Xe++)Me>=I[j[Xe]]&&(j.splice(Xe,0,Ee),Qe=!0);Qe||(j[ye]=Ee),ye++}}for(let Ee=0;Ee<ye;Ee++){const Pe=j[Ee];q.push({idx:this.childOffsets[X]+Pe,t:I[Pe],nodex:(ae<<1)+this._siblingOffset[Pe][0],nodey:(ge<<1)+this._siblingOffset[Pe][1],depth:ke+1})}}return null}_addNode(n,s,c){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,c,f,y){if(n[f].isLeaf(s,c)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const w=f-1,E=n[w];let A=0,I=0;for(let j=0;j<this._siblingOffset.length;j++){const V=2*s+this._siblingOffset[j][0],U=2*c+this._siblingOffset[j][1],q=E.getElevation(V,U),X=E.isLeaf(V,U),te=this._addNode(q.min,q.max,X);X&&(A|=1<<j),I||(I=te)}for(let j=0;j<this._siblingOffset.length;j++)A&1<<j||this._construct(n,2*s+this._siblingOffset[j][0],2*c+this._siblingOffset[j][1],w,I+j)}}function AE(i,n,s,c,f,y){return Yn(Yn(i,s,y),Yn(n,c,y),f)}function Hd(i,n,s){const c=s.dim,f=Se(i*c-.5,0,c-1),y=Se(n*c-.5,0,c-1),w=Math.floor(f),E=Math.floor(y),A=Math.min(w+1,c-1),I=Math.min(E+1,c-1);return AE(s.get(w,E),s.get(A,E),s.get(w,I),s.get(A,I),f-w,y-E)}const IE={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function J5(i,n,s){return(256*i*256+256*n+s)/10-1e4}function Q5(i,n,s){return 256*i+n+s/256-32768}class ox{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,c,f=!1,y=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Kn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const w=this.dim=s.height-2,E=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let A=0;A<w;A++)E[this._idx(-1,A)]=E[this._idx(0,A)],E[this._idx(w,A)]=E[this._idx(w-1,A)],E[this._idx(A,-1)]=E[this._idx(A,0)],E[this._idx(A,w)]=E[this._idx(A,w-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(w,-1)]=E[this._idx(w-1,0)],E[this._idx(-1,w)]=E[this._idx(0,w-1)],E[this._idx(w,w)]=E[this._idx(w-1,w-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new kE(this)}get(n,s,c=!1){c&&(n=Se(n,-1,this.dim),s=Se(s,-1,this.dim));const f=4*this._idx(n,s);return(this.encoding==="terrarium"?Q5:J5)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(n){return IE[n]}get unpackVector(){return IE[this.encoding]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const c=[0,0,0,0],f=ox.getUnpackVector(s);let y=Math.floor((n+f[3])/f[2]);return c[2]=y%256,y=Math.floor(y/256),c[1]=y%256,y=Math.floor(y/256),c[0]=y,c}getPixels(){return new qs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,y=s*this.dim+this.dim,w=c*this.dim,E=c*this.dim+this.dim;switch(s){case-1:f=y-1;break;case 1:y=f+1}switch(c){case-1:w=E-1;break;case 1:E=w+1}const A=-s*this.dim,I=-c*this.dim;for(let j=w;j<E;j++)for(let V=f;V<y;V++){const U=4*this._idx(V,j),q=4*this._idx(V+A,j+I);this.pixels[U+0]=n.pixels[q+0],this.pixels[U+1]=n.pixels[q+1],this.pixels[U+2]=n.pixels[q+2],this.pixels[U+3]=n.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ft(ox,"DEMData"),Ft(kE,"DemMinMaxQuadTree",{omit:["dem"]});class ej{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,c){const f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:s,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout((()=>{this.remove(n,y)}),c)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const c=n.wrapped().key,f=s===void 0?0:this.data[c].indexOf(s),y=this.data[c][f];return this.data[c].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const c in this.data)for(const f of this.data[c])n(f.value)||s.push(f);for(const c of s)this.remove(c.value.tileID,c)}}class cm{constructor(n,s,c){this.func=n,this.mask=s,this.range=c}}cm.ReadOnly=!1,cm.ReadWrite=!0,cm.disabled=new cm(519,cm.ReadOnly,[0,1]);const q0=7680;class Z0{constructor(n,s,c,f,y,w){this.test=n,this.ref=s,this.mask=c,this.fail=f,this.depthFail=y,this.pass=w}}Z0.disabled=new Z0({func:519,mask:0},0,0,q0,q0,q0);class Oc{constructor(n,s,c){this.blendFunction=n,this.blendColor=s,this.mask=c}}Oc.Replace=[1,0],Oc.disabled=new Oc(Oc.Replace,_r.transparent,[!1,!1,!1,!1]),Oc.unblended=new Oc(Oc.Replace,_r.transparent,[!0,!0,!0,!0]),Oc.alphaBlended=new Oc([1,771],_r.transparent,[!0,!0,!0,!0]);const X0=1029,K0=2305;class Dl{constructor(n,s,c){this.enable=n,this.mode=s,this.frontFace=c}}Dl.disabled=new Dl(!1,X0,K0),Dl.backCCW=new Dl(!0,X0,K0),Dl.backCW=new Dl(!0,X0,2304),Dl.frontCW=new Dl(!0,1028,2304),Dl.frontCCW=new Dl(!0,1028,K0);class Pf extends vs{constructor(n,s,c){super(),this.id=n,this._onlySymbols=c,s.on("data",(f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),s.on("error",(()=>{this._sourceErrored=!0})),this._source=s,this._tiles={},this._cache=new ej(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Y5,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,(()=>{}))}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,(()=>{}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return lt(this._tiles).map((n=>n.tileID)).sort(ME).map((n=>n.key))}getRenderableIds(n){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,n)&&s.push(this._tiles[c]);return n?s.sort(((c,f)=>{const y=c.tileID,w=f.tileID,E=new Ie(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),A=new Ie(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||A.y-E.y||A.x-E.x})).map((c=>c.tileID.key)):s.map((c=>c.tileID)).sort(ME).map((c=>c.key))}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,n,s)))}_tileLoaded(n,s,c,f){if(f)if(n.state="errored",f.status!==404)this._source.fire(new eo(f,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=Fo.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new ka("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const y=s[f];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);c(n,w),c(w,n)}}function c(f,y){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let w=y.tileID.canonical.x-f.tileID.canonical.x;const E=y.tileID.canonical.y-f.tileID.canonical.y,A=Math.pow(2,f.tileID.canonical.z),I=y.tileID.key;w===0&&E===0||Math.abs(E)>1||(Math.abs(w)>1&&(Math.abs(w+A)===1?w+=A:Math.abs(w-A)===1&&(w-=A)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,w,E),f.neighboringTiles&&f.neighboringTiles[I]&&(f.neighboringTiles[I].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,c,f){for(const y in this._tiles){let w=this._tiles[y];if(f[y]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>c)continue;let E=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const I=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[I.key],w&&w.hasData()&&(E=I)}let A=E;for(;A.overscaledZ>s;)if(A=A.scaledTo(A.overscaledZ-1),n[A.key]){f[E.key]=E;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=n.overscaledZ-1;c>=s;c--){const f=n.scaledTo(c),y=this._getLoadedTile(f);if(y)return y}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const c=Math.ceil(n.width/s)+1,f=Math.ceil(n.height/s)+1,y=Math.floor(c*f*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(E)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const c={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),c[y.tileID.key]=y}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(n,s,c){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((E=>new mo(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y))):(f=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter((E=>this._source.hasTile(E))))):f=[];const y=this._updateRetainedTiles(f);if(PE(this._source.type)&&f.length!==0){const E={},A={},I=Object.keys(y);for(const V of I){const U=y[V],q=this._tiles[V];if(!q||q.fadeEndTime&&q.fadeEndTime<=Fo.now())continue;const X=this.findLoadedParent(U,Math.max(U.overscaledZ-Pf.maxOverzooming,this._source.minzoom));X&&(this._addTile(X.tileID),E[X.tileID.key]=X.tileID),A[V]=U}const j=f[f.length-1].overscaledZ;for(const V in this._tiles){const U=this._tiles[V];if(y[V]||!U.hasData())continue;let q=U.tileID;for(;q.overscaledZ>j;){q=q.scaledTo(q.overscaledZ-1);const X=this._tiles[q.key];if(X&&X.hasData()&&A[q.key]){y[V]=U.tileID;break}}}for(const V in E)y[V]||(this._coveredTiles[V]=!0,y[V]=E[V])}for(const E in y)this._tiles[E].clearFadeHold();const w=(function(E,A){const I=[];for(const j in E)j in A||I.push(j);return I})(this._tiles,y);for(const E of w){const A=this._tiles[E];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const c={},f=n.reduce(((I,j)=>Math.min(I,j.overscaledZ)),1/0),y=n[0].overscaledZ,w=Math.max(y-Pf.maxOverzooming,this._source.minzoom),E=Math.max(y+Pf.maxUnderzooming,this._source.minzoom),A={};for(const I of n){const j=this._addTile(I);s[I.key]=I,j.hasData()||f<this._source.maxzoom&&(A[I.key]=I)}this._retainLoadedChildren(A,f,E,s);for(const I of n){let j=this._tiles[I.key];if(j.hasData())continue;if(I.canonical.z>=this._source.maxzoom){const U=I.children(this._source.maxzoom)[0],q=this.getTile(U);if(q&&q.hasData()){s[U.key]=U;continue}}else{const U=I.children(this._source.maxzoom);if(s[U[0].key]&&s[U[1].key]&&s[U[2].key]&&s[U[3].key])continue}let V=j.wasRequested();for(let U=I.overscaledZ-1;U>=w;--U){const q=I.scaledTo(U);if(c[q.key]||(c[q.key]=!0,j=this.getTile(q),!j&&V&&(j=this._addTile(q)),j&&(s[q.key]=q,V=j.wasRequested(),j.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let c,f=this._tiles[n].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}s.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;f=y}for(const y of s)this._loadedParentTiles[y]=c}}_addTile(n){let s=this._tiles[n.key];if(s)return s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const c=!!s;if(!c){const f=this.map?this.map.painter:null;s=new W0(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,c||this._source.fire(new ka("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=s.getExpiryTimeout();c&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),c))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,c){const f=[],y=this.transform;if(!y)return f;const w=y.projection.name==="globe",E=kr(y.center.lng);for(const A in this._tiles){const I=this._tiles[A];if(c&&I.clearQueryDebugViz(),I.holdingForFade())continue;let j;if(w){const V=I.tileID.canonical;if(V.z===0){const U=[Math.abs(Se(E,...Kg(V,-1))-E),Math.abs(Se(E,...Kg(V,1))-E)];j=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(Se(E,...Kg(V,-1))-E),Math.abs(Se(E,...Kg(V,0))-E),Math.abs(Se(E,...Kg(V,1))-E)];j=[U.indexOf(Math.min(...U))-1]}}else j=[0];for(const V of j){const U=n.containsTile(I,y,s,V);U&&f.push(U)}}return f}getVisibleCoordinates(n){const s=this.getRenderableIds(n).map((c=>this._tiles[c].tileID));for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(PE(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=Fo.now())return!0}return!1}setFeatureState(n,s,c){this._state.updateState(n=n||"_geojsonTileLayer",s,c)}removeFeatureState(n,s,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,c)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,c){const f=this._tiles[n];f&&f.setDependencies(s,c)}reloadTilesForDependencies(n,s){for(const c in this._tiles)this._tiles[c].hasDependency(n,s)&&this._reloadTile(+c,"reloading");this._cache.filter((c=>!c.hasDependency(n,s)))}_preloadTiles(n,s){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(n,s))};return void this._source.on("data",E)}const c=new Map,f=Array.isArray(n)?n:[n],y=this.map.painter.terrain,w=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const E of f){const A=E.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const I of A)c.set(I.key,I);this.usedForTerrain&&E.updateElevation(!1)}Fe(Array.from(c.values()),((E,A)=>{const I=new W0(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(I,(j=>{this._source.type==="raster-dem"&&I.dem&&this._backfillDEM(I),A(j,I)}))}),s)}}function ME(i,n){const s=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return i.overscaledZ-n.overscaledZ||c-s||n.canonical.y-i.canonical.y||n.canonical.x-i.canonical.x}function PE(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function Kg(i,n){const s=1<<i.z;return[i.x/s+n,(i.x+1)/s+n]}Pf.maxOverzooming=10,Pf.maxUnderzooming=3;class ax{constructor(n,s,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(n,s,c){const f=c||n.findDEMTileFor(s);if(!f||!f.dem)return;const y=f.dem,w=f.tileID,E=1<<s.canonical.z-w.canonical.z;return new ax(f,f.tileSize/ln/E,[(s.canonical.x/E-w.canonical.x)*y.dim,(s.canonical.y/E-w.canonical.y)*y.dim])}tileCoordToPixel(n,s){const c=s*this._scale+this._offset[1],f=Math.floor(n*this._scale+this._offset[0]),y=Math.floor(c);return new Ie(f,y)}getElevationAt(n,s,c,f){const y=n*this._scale+this._offset[0],w=s*this._scale+this._offset[1],E=Math.floor(y),A=Math.floor(w),I=this._dem;return f=!!f,c?Yn(Yn(I.get(E,A,f),I.get(E,A+1,f),w-A),Yn(I.get(E+1,A,f),I.get(E+1,A+1,f),w-A),y-E):I.get(E,A,f)}getElevationAtPixel(n,s,c){return this._dem.get(n,s,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*oi(1,n)*this._dem.stride}}class NE{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new Zo(ln,16,0),this.featureIndexArray=new Kr,this.promoteId=s}insert(n,s,c,f,y,w=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,y,w);const A=this.grid;for(let I=0;I<s.length;I++){const j=s[I],V=[1/0,1/0,-1/0,-1/0];for(let U=0;U<j.length;U++){const q=j[U];V[0]=Math.min(V[0],q.x),V[1]=Math.min(V[1],q.y),V[2]=Math.max(V[2],q.x),V[3]=Math.max(V[3],q.y)}V[0]<ln&&V[1]<ln&&V[2]>=0&&V[3]>=0&&A.insert(E,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new gn(new q_(this.rawTileData)).layers,this.sourceLayerCoder=new yE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,c,f){this.loadVTLayers();const y=n.params||{},w=gc(y.filter),E=n.tileResult,A=n.transform,I=E.bufferedTilespaceBounds,j=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,((X,te,ae,ge)=>O_(E.bufferedTilespaceGeometry,X,te,ae,ge)));j.sort(tj);let V=null;A.elevation&&j.length>0&&(V=ax.create(A.elevation,this.tileID));const U={};let q;for(let X=0;X<j.length;X++){const te=j[X];if(te===q)continue;q=te;const ae=this.featureIndexArray.get(te);let ge=null;this.loadMatchingFeature(U,ae,w,y.layers,y.availableImages,s,c,f,((ke,ye,Ee,Pe=0)=>(ge||(ge=Is(ke,this.tileID.canonical,n.tileTransform)),ye.queryIntersectsFeature(E,ke,Ee,ge,this.z,n.transform,n.pixelPosMatrix,V,Pe))))}return U}loadMatchingFeature(n,s,c,f,y,w,E,A,I){const{featureIndex:j,bucketIndex:V,sourceLayerIndex:U,layoutVertexArrayOffset:q}=s,X=this.bucketLayerIDs[V];if(f&&!(function(ke,ye){for(let Ee=0;Ee<ke.length;Ee++)if(ye.indexOf(ke[Ee])>=0)return!0;return!1})(f,X))return;const te=this.sourceLayerCoder.decode(U),ae=this.vtLayers[te].feature(j);if(c.needGeometry){const ke=Xa(ae,!0);if(!c.filter(new B(this.tileID.overscaledZ),ke,this.tileID.canonical))return}else if(!c.filter(new B(this.tileID.overscaledZ),ae))return;const ge=this.getId(ae,te);for(let ke=0;ke<X.length;ke++){const ye=X[ke];if(f&&f.indexOf(ye)<0)continue;const Ee=w[ye];if(!Ee)continue;let Pe={};ge!==void 0&&A&&(Pe=A.getState(Ee.sourceLayer||"_geojsonTileLayer",ge));const Me=Tt({},E[ye]);Me.paint=RE(Me.paint,Ee.paint,ae,Pe,y),Me.layout=RE(Me.layout,Ee.layout,ae,Pe,y);const Qe=!I||I(ae,Ee,Pe,q);if(!Qe)continue;const Xe=new _E(ae,this.z,this.x,this.y,ge);Xe.layer=Me;let mt=n[ye];mt===void 0&&(mt=n[ye]=[]),mt.push({featureIndex:j,feature:Xe,intersectionZ:Qe})}}lookupSymbolFeatures(n,s,c,f,y,w,E,A){const I={};this.loadVTLayers();const j=gc(y);for(const V of n)this.loadMatchingFeature(I,{bucketIndex:c,sourceLayerIndex:f,featureIndex:V,layoutVertexArrayOffset:0},j,w,E,A,s);return I}loadFeature(n){const{featureIndex:s,sourceLayerIndex:c}=n;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),y=this.vtFeatures[f];if(y[s])return y[s];const w=this.vtLayers[f].feature(s);return y[s]=w,w}hasLayer(n){for(const s of this.bucketLayerIDs)for(const c of s)if(n===c)return!0;return!1}getId(n,s){let c=n.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];f!=null&&(c=n.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function RE(i,n,s,c,f){return Yt(i,((y,w)=>{const E=n instanceof me?n.get(w):null;return E&&E.evaluate?E.evaluate(s,c,f):E}))}function tj(i,n){return n-i}Ft(NE,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class DE{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new po({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const c=this.getKey(n,s);return this.positions[c]}trim(){const n=this.width,s=this.height=Zt(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,c){const f=[];let y=n.length%2==1?-n[n.length-1]*c:0,w=n[0]*c,E=!0;f.push({left:y,right:w,isDash:E,zeroLength:n[0]===0});let A=n[0];for(let I=1;I<n.length;I++){E=!E;const j=n[I];y=A*c,A+=j,w=A*c,f.push({left:y,right:w,isDash:E,zeroLength:j===0})}return f}addRoundDash(n,s,c){const f=s/2;for(let y=-c;y<=c;y++){const w=this.width*(this.nextRow+c+y);let E=0,A=n[E];for(let I=0;I<this.width;I++){I/A.right>1&&(A=n[++E]);const j=Math.abs(I-A.left),V=Math.abs(I-A.right),U=Math.min(j,V);let q;const X=y/c*(f+1);if(A.isDash){const te=f-Math.abs(X);q=Math.sqrt(U*U+te*te)}else q=f-Math.sqrt(U*U+X*X);this.image.data[w+I]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(n,s){for(let A=n.length-1;A>=0;--A){const I=n[A],j=n[A+1];I.zeroLength?n.splice(A,1):j&&j.isDash===I.isDash&&(j.left=I.left,n.splice(A,1))}const c=n[0],f=n[n.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const y=this.width*this.nextRow;let w=0,E=n[w];for(let A=0;A<this.width;A++){A/E.right>1&&(E=n[++w]);const I=Math.abs(A-E.left),j=Math.abs(A-E.right),V=Math.min(I,j);this.image.data[y+A]=Math.max(0,Math.min(255,(E.isDash?V:-V)+s+128))}}addDash(n,s){const c=this.getKey(n,s);if(this.positions[c])return this.positions[c];const f=s==="round",y=f?7:0,w=2*y+1;if(this.nextRow+w>this.height)return Kn("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let j=0;j<n.length;j++)n[j]<0&&(Kn("Negative value is found in line dasharray, replacing values with 0"),n[j]=0),E+=n[j];if(E!==0){const j=this.width/E,V=this.getDashRanges(n,this.width,j);f?this.addRoundDash(V,j,y):this.addRegularDash(V,s==="square"?.5*j:0)}const A=this.nextRow+y;this.nextRow+=w;const I={tl:[A,y],br:[E,0]};return this.positions[c]=I,I}}Ft(DE,"LineAtlas");const LE=1*Rl;class jE{constructor(n){const s={},c=[];for(const E in n){const A=n[E],I=s[E]={};for(const j in A.glyphs){const V=A.glyphs[+j];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const U=V.metrics.localGlyph?LE:1,q={x:0,y:0,w:V.bitmap.width+2*U,h:V.bitmap.height+2*U};c.push(q),I[j]=q}}const{w:f,h:y}=D0(c),w=new po({width:f||1,height:y||1});for(const E in n){const A=n[E];for(const I in A.glyphs){const j=A.glyphs[+I];if(!j||j.bitmap.width===0||j.bitmap.height===0)continue;const V=s[E][I],U=j.metrics.localGlyph?LE:1;po.copy(j.bitmap,w,{x:0,y:0},{x:V.x+U,y:V.y+U},j.bitmap)}}this.image=w,this.positions=s}}Ft(jE,"GlyphAtlas");class nj{constructor(n){this.tileID=new mo(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=Mf(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,s,c,f,y){this.status="parsing",this.data=n,this.collisionBoxArray=new pr;const w=new yE(Object.keys(n.layers).sort()),E=new NE(this.tileID,this.promoteId);E.bucketLayerIDs=[];const A={},I=new DE(256,256),j={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:I,availableImages:c},V=s.familiesBySource[this.source];for(const Pe in V){const Me=n.layers[Pe];if(!Me)continue;let Qe=!1,Xe=!1;for(const rt of V[Pe])rt[0].type==="symbol"?Qe=!0:Xe=!0;if(this.isSymbolTile===!0&&!Qe||this.isSymbolTile===!1&&!Xe)continue;Me.version===1&&Kn(`Vector tile source "${this.source}" layer "${Pe}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const mt=w.encode(Pe),Mt=[];for(let rt=0;rt<Me.length;rt++){const yt=Me.feature(rt),_t=E.getId(yt,Pe);Mt.push({feature:yt,id:_t,index:rt,sourceLayerIndex:mt})}for(const rt of V[Pe]){const yt=rt[0];this.isSymbolTile!==void 0&&yt.type==="symbol"!==this.isSymbolTile||yt.minzoom&&this.zoom<Math.floor(yt.minzoom)||yt.maxzoom&&this.zoom>=yt.maxzoom||yt.visibility!=="none"&&(Y0(rt,this.zoom,c),(A[yt.id]=yt.createBucket({index:E.bucketLayerIDs.length,layers:rt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:mt,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(Mt,j,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(rt.map((_t=>_t.id))))}}let U,q,X,te;I.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=()=>{if(U)return y(U);if(q&&X&&te){const Pe=new jE(q),Me=new $S(X,te);for(const Qe in A){const Xe=A[Qe];Xe instanceof Ud?(Y0(Xe.layers,this.zoom,c),A5(Xe,q,Pe.positions,X,Me.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Xe.hasPattern&&(Xe instanceof G_||Xe instanceof S||Xe instanceof zg)&&(Y0(Xe.layers,this.zoom,c),Xe.addFeatures(j,this.tileID.canonical,Me.patternPositions,c,this.tileTransform))}this.status="done",y(null,{buckets:lt(A).filter((Qe=>!Qe.isEmpty())),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Pe.image,lineAtlas:I,imageAtlas:Me,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?X:null,glyphPositions:this.returnDependencies?Pe.positions:null})}},ke=Yt(j.glyphDependencies,(Pe=>Object.keys(Pe).map(Number)));Object.keys(ke).length?f.send("getGlyphs",{uid:this.uid,stacks:ke},((Pe,Me)=>{U||(U=Pe,q=Me,ge())}),void 0,!1,ae):q={};const ye=Object.keys(j.iconDependencies);ye.length?f.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},((Pe,Me)=>{U||(U=Pe,X=Me,ge())}),void 0,!1,ae):X={};const Ee=Object.keys(j.patternDependencies);Ee.length?f.send("getImages",{icons:Ee,source:this.source,tileID:this.tileID,type:"patterns"},((Pe,Me)=>{U||(U=Pe,te=Me,ge())}),void 0,!1,ae):te={},ge()}}function Y0(i,n,s){const c=new B(n);for(const f of i)f.recalculate(c,s)}class OE{constructor(n){this.entries={},this.scheduler=n}request(n,s,c,f){const y=this.entries[n]=this.entries[n]||{callbacks:[]};if(y.result){const[w,E]=y.result;return this.scheduler?this.scheduler.add((()=>{f(w,E)}),s):f(w,E),()=>{}}return y.callbacks.push(f),y.cancel||(y.cancel=c(((w,E)=>{y.result=[w,E];for(const A of y.callbacks)this.scheduler?this.scheduler.add((()=>{A(w,E)}),s):A(w,E);setTimeout((()=>delete this.entries[n]),3e3)}))),()=>{y.result||(y.callbacks=y.callbacks.filter((w=>w!==f)),y.callbacks.length||(y.cancel(),delete this.entries[n]))}}}function zE(i,n,s){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},(f=>{const y=Js(i.request,((w,E,A,I)=>{w?f(w):E&&f(null,{vectorTile:s?void 0:new gn(new q_(E)),rawData:E,cacheControl:A,expires:I})}));return()=>{y.cancel(),f()}}),n)}const BE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class J0{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=BE[15&c];if(!y)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new J0(E,w,y,n)}constructor(n,s=64,c=Float64Array,f){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=BE.indexOf(this.ArrayType),w=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+A,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+w+E+A),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+A,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=s,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return Q0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:w,nodeSize:E}=this,A=[0,y.length-1,0],I=[];for(;A.length;){const j=A.pop()||0,V=A.pop()||0,U=A.pop()||0;if(V-U<=E){for(let ae=U;ae<=V;ae++){const ge=w[2*ae],ke=w[2*ae+1];ge>=n&&ge<=c&&ke>=s&&ke<=f&&I.push(y[ae])}continue}const q=U+V>>1,X=w[2*q],te=w[2*q+1];X>=n&&X<=c&&te>=s&&te<=f&&I.push(y[q]),(j===0?n<=X:s<=te)&&(A.push(U),A.push(q-1),A.push(1-j)),(j===0?c>=X:f>=te)&&(A.push(q+1),A.push(V),A.push(1-j))}return I}within(n,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:w}=this,E=[0,f.length-1,0],A=[],I=c*c;for(;E.length;){const j=E.pop()||0,V=E.pop()||0,U=E.pop()||0;if(V-U<=w){for(let ae=U;ae<=V;ae++)VE(y[2*ae],y[2*ae+1],n,s)<=I&&A.push(f[ae]);continue}const q=U+V>>1,X=y[2*q],te=y[2*q+1];VE(X,te,n,s)<=I&&A.push(f[q]),(j===0?n-c<=X:s-c<=te)&&(E.push(U),E.push(q-1),E.push(1-j)),(j===0?n+c>=X:s+c>=te)&&(E.push(q+1),E.push(V),E.push(1-j))}return A}}function Q0(i,n,s,c,f,y){if(f-c<=s)return;const w=c+f>>1;FE(i,n,w,c,f,y),Q0(i,n,s,c,w-1,1-y),Q0(i,n,s,w+1,f,1-y)}function FE(i,n,s,c,f,y){for(;f>c;){if(f-c>600){const I=f-c+1,j=s-c+1,V=Math.log(I),U=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*U*(I-U)/I)*(j-I/2<0?-1:1);FE(i,n,s,Math.max(c,Math.floor(s-j*U/I+q)),Math.min(f,Math.floor(s+(I-j)*U/I+q)),y)}const w=n[2*s+y];let E=c,A=f;for(Yg(i,n,c,s),n[2*f+y]>w&&Yg(i,n,c,f);E<A;){for(Yg(i,n,E,A),E++,A--;n[2*E+y]<w;)E++;for(;n[2*A+y]>w;)A--}n[2*c+y]===w?Yg(i,n,c,A):(A++,Yg(i,n,A,f)),A<=s&&(c=A+1),s<=A&&(f=A-1)}}function Yg(i,n,s,c){e1(i,s,c),e1(n,2*s,2*c),e1(n,2*s+1,2*c+1)}function e1(i,n,s){const c=i[n];i[n]=i[s],i[s]=c}function VE(i,n,s,c){const f=i-s,y=n-c;return f*f+y*y}a.ARRAY_TYPE=cs,a.AUTH_ERR_MSG=Te,a.Aabb=ds,a.Actor=class{constructor(i,n,s){this.target=i,this.parent=n,this.mapId=s,this.callbacks={},this.cancelCallbacks={},on(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=xi()?i:k,this.scheduler=new X5}send(i,n,s,c,f=!1,y){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=y,this.callbacks[w]=s);const E=is(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:i,hasCallback:!!s,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:Tl(n,E)},E),{cancel:()=>{s&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(i){const n=i.data,s=n.id;if(s&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(n.mustQueue||xi()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add((()=>this.processTask(s,n)),c&&c.metadata||{type:"message"})}else this.processTask(s,n)}processTask(i,n){if(n.type==="<response>"){const s=this.callbacks[i];delete this.callbacks[i],s&&(n.error?s(Sl(n.error)):s(null,Sl(n.data)))}else{const s=is(this.globalScope)?void 0:[],c=n.hasCallback?(y,w)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:y?Tl(y):null,data:Tl(w,s)},s)}:y=>{},f=Sl(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,f,c);else if(this.parent.getWorkerSource){const y=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,y[0],f.source)[y[1]](f,c)}else c(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=$_,a.Color=_r,a.ColorMode=Oc,a.CullFaceMode=Dl,a.DEMData=ox,a.DataConstantProperty=Q,a.DedupedRequest=OE,a.DepthMode=cm,a.EXTENT=ln,a.Elevation=class{isDataAvailableAtPoint(i){const n=this._source();if(this.isUsingMockSource()||!n||i.y<0||i.y>1)return!1;const s=n.getSource().maxzoom,c=1<<s,f=Math.floor(i.x),y=Math.floor((i.x-f)*c),w=Math.floor(i.y*c),E=this.findDEMTileFor(new mo(s,f,s,y,w));return!(!E||!E.dem)}getAtPointOrZero(i,n=0){return this.getAtPoint(i,n)||0}getAtPoint(i,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||i.y<0||i.y>1)return n;const f=c.getSource().maxzoom,y=1<<f,w=Math.floor(i.x),E=i.x-w,A=new mo(f,w,f,Math.floor(E*y),Math.floor(i.y*y)),I=this.findDEMTileFor(A);if(!I||!I.dem)return n;const j=I.dem,V=1<<I.tileID.canonical.z,U=(E*V-I.tileID.canonical.x)*j.dim,q=(i.y*V-I.tileID.canonical.y)*j.dim,X=Math.floor(U),te=Math.floor(q);return(s?this.exaggeration():1)*Yn(Yn(j.get(X,te),j.get(X,te+1),q-te),Yn(j.get(X+1,te),j.get(X+1,te+1),q-te),U-X)}getAtTileOffset(i,n,s){const c=1<<i.canonical.z;return this.getAtPointOrZero(new Ic(i.wrap+(i.canonical.x+n/ln)/c,(i.canonical.y+s/ln)/c))}getAtTileOffsetFunc(i,n,s,c){return f=>{const y=this.getAtTileOffset(i,f.x,f.y),w=c.upVector(i.canonical,f.x,f.y);return zr(w,w,y*c.upVectorScale(i.canonical,n,s).metersToTile),w}}getForTilePoints(i,n,s,c){if(this.isUsingMockSource())return!1;const f=ax.create(this,i,c);return!!f&&(n.forEach((y=>{y[2]=this.exaggeration()*f.getElevationAt(y[0],y[1],s)})),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(i);if(!n||!n.dem)return null;const s=n.dem.tree,c=n.tileID,f=1<<i.canonical.z-c.canonical.z;let y=i.canonical.x/f-c.canonical.x,w=i.canonical.y/f-c.canonical.y,E=0;for(let A=0;A<i.canonical.z-c.canonical.z&&!s.leaves[E];A++){y*=2,w*=2;const I=2*Math.floor(w)+Math.floor(y);E=s.childOffsets[E]+I,y%=1,w%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=eo,a.EvaluationParameters=B,a.Event=ka,a.Evented=vs,a.FillExtrusionBucket=zg,a.Frustum=Bp,a.FrustumCorners=pf,a.GLOBE_RADIUS=qa,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=hs,a.GLOBE_ZOOM_THRESHOLD_MIN=Iu,a.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,n){const s=new At,c=new tn,f=[],y=i+1+2,w=n[0]+1,E=n[0]+1+(1+n.length),A=(I,j,V)=>{let U=I===y-1?I-2:I===0?I:I-1;return U+=V?24575:0,[U,j]};for(let I=0;I<y;++I)s.emplaceBack(...A(I,0,!0));for(let I=0;I<w;++I)for(let j=0;j<y;++j)s.emplaceBack(...A(j,I,(j===0||j===y-1)&&!0));for(let I=0;I<n.length;++I){const j=n[I];for(let V=0;V<y;++V)s.emplaceBack(...A(V,j,!0))}for(let I=0;I<n.length;++I){const j=c.length,V=n[I]+1+2,U=new tn;for(let te=0;te<V-1;te++){const ae=te===V-2,ge=ae?y*(E-n.length+I-te):y;for(let ke=0;ke<y-1;ke++){const ye=te*y+ke;te===0||ae||ke===0||ke===y-2?(U.emplaceBack(ye+1,ye,ye+ge),U.emplaceBack(ye+ge,ye+ge+1,ye+1)):(c.emplaceBack(ye+1,ye,ye+ge),c.emplaceBack(ye+ge,ye+ge+1,ye+1))}}const q=si.simpleSegment(0,j,s.length,c.length-j);for(let te=0;te<U.uint16.length;te+=3)c.emplaceBack(U.uint16[te],U.uint16[te+1],U.uint16[te+2]);const X=si.simpleSegment(0,j,s.length,c.length-j);f.push({withoutSkirts:q,withSkirts:X})}return{vertices:s,indices:c,segments:f}}_createGrid(i){const n=this._fillGridMeshWithLods(Za,Oi);this._gridSegments=n.segments,this._gridBuffer=i.createVertexBuffer(n.vertices,ff.members),this._gridIndexBuffer=i.createIndexBuffer(n.indices,!0)}_createPoles(i){const n=new tn;for(let f=0;f<=Za;f++)n.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=i.createIndexBuffer(n,!0);const s=new rr,c=new rr;this._poleSegments=[];for(let f=0,y=0;f<Iu;f++){const w=360/(1<<f);s.emplaceBack(0,-qa,0,.5,0),c.emplaceBack(0,-qa,0,.5,1);for(let E=0;E<=Za;E++){const A=E/Za,I=Yn(0,w,A),[j,V,U]=pi(j_,S0,I,qa);s.emplaceBack(j,V,U,A,0),c.emplaceBack(j,V,U,A,1)}this._poleSegments.push(si.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(s,hf,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,hf,!1)}getGridBuffers(i,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,n){if(!this._wireframeSegments){const s=new $r,c=Za,f=c+1+2,y=1;this._wireframeSegments=[];for(let w=0,E=0;w<Oi.length;w++){const A=Oi[w];for(let j=y;j<A+y;j++)for(let V=y;V<c+y;V++){const U=j*f+V;s.emplaceBack(U,U+1),s.emplaceBack(U,U+f),s.emplaceBack(U,U+f+1)}const I=A*c*3;this._wireframeSegments.push(si.simpleSegment(0,E,(A+1)*f,I)),E+=I}this._wireframeIndexBuffer=i.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[n]]}},a.GlyphManager=im,a.ImagePosition=L0,a.KDBush=J0,a.LivePerformanceUtils=dp,a.LngLat=hn,a.LngLatBounds=Al,a.LocalGlyphMode=z0,a.MAX_MERCATOR_LATITUDE=Yr,a.MercatorCoordinate=Ic,a.ONE_EM=fs,a.OverscaledTileID=mo,a.PerformanceMarkers=ll,a.Point=Ie,a.Properties=ve,a.RGBAImage=qs,a.Ray=zp,a.RequestManager=class{constructor(i,n,s){this._transformRequestFn=i,this._customAccessToken=n,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const i=(function(){let n="";for(let s=0;s<10;s++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,n].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,n){return this._transformRequestFn&&this._transformRequestFn(i,n)||{url:i}}normalizeStyleURL(i,n){if(!we(i))return i;const s=Rt(i);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeGlyphsURL(i,n){if(!we(i))return i;const s=Rt(i);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeSourceURL(i,n,s,c){if(!we(i))return i;const f=Rt(i);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),s&&f.params.push(`language=${s}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||n)}normalizeSpriteURL(i,n,s,c){const f=Rt(i);return we(i)?(f.path=`/styles/v1${f.path}/sprite${n}${s}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${n}${s}`,bt(f))}normalizeTileURL(i,n,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!we(i))return i;const c=Rt(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||s&&c.authority!=="raster"&&s===512?"@2x":""}${O.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${z.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${z.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||(function(y){for(const w of y){const E=w.match(/^access_token=(.*)$/);if(E)return E[1]}return null})(c.params)||z.ACCESS_TOKEN;return z.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(i,n){const s=Rt(i);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return i;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${z.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${z.TILE_URL_VERSION}/`,"")}`;let f=s.params;return n&&(f=f.filter((y=>!y.match(/^access_token=/)))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(i,n){const s=!!n&&we(n),c=[];for(const f of i.tiles||[])Oe(f)?c.push(this.canonicalizeTileURL(f,s)):c.push(f);return c}_makeAPIURL(i,n){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Rt(z.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const f=i.params.indexOf("secure");f>=0&&i.params.splice(f,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!z.REQUIRE_ACCESS_TOKEN)return bt(i);if(n=n||z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return i.params=i.params.filter((f=>f.indexOf("access_token")===-1)),i.params.push(`access_token=${n||""}`),bt(i)}},a.ResourceType=Mi,a.SegmentVector=si,a.SourceCache=Pf,a.StencilMode=Z0,a.StructArrayLayout1ui2=$s,a.StructArrayLayout2f1f2i16=dn,a.StructArrayLayout2i4=At,a.StructArrayLayout2ui4=$r,a.StructArrayLayout3f12=Fn,a.StructArrayLayout3ui6=tn,a.StructArrayLayout4i8=ct,a.StructArrayLayout5f20=rr,a.Texture=Xg,a.Tile=W0,a.Transitionable=J,a.Uniform1f=of,a.Uniform1i=class extends $a{constructor(i){super(i),this.current=0}set(i,n,s){this.fetchUniformLocation(i,n)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},a.Uniform2f=class extends $a{constructor(i){super(i),this.current=[0,0]}set(i,n,s){this.fetchUniformLocation(i,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},a.Uniform3f=class extends $a{constructor(i){super(i),this.current=[0,0,0]}set(i,n,s){this.fetchUniformLocation(i,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},a.Uniform4f=cg,a.UniformColor=ug,a.UniformMatrix2f=class extends $a{constructor(i){super(i),this.current=T_}set(i,n,s){if(this.fetchUniformLocation(i,n)){for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}},a.UniformMatrix3f=class extends $a{constructor(i){super(i),this.current=b_}set(i,n,s){if(this.fetchUniformLocation(i,n)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.UniformMatrix4f=class extends $a{constructor(i){super(i),this.current=w_}set(i,n,s){if(this.fetchUniformLocation(i,n)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},a.UnwrappedTileID=AS,a.ValidationError=zt,a.VectorTileFeature=En,a.VectorTileWorkerSource=class extends vs{constructor(i,n,s,c,f){super(),this.actor=i,this.layerIndex=n,this.availableImages=s,this.loadVectorData=f||zE,this.loading={},this.loaded={},this.deduped=new OE(i.scheduler),this.isSpriteLoaded=c,this.scheduler=i.scheduler}loadTile(i,n){const s=i.uid,c=i&&i.request,f=c&&c.collectResourceTiming,y=this.loading[s]=new nj(i);y.abort=this.loadVectorData(i,((w,E)=>{const A=!this.loading[s];if(delete this.loading[s],A||w||!E)return y.status="done",A||(this.loaded[s]=y),n(w);const I=E.rawData,j={};E.expires&&(j.expires=E.expires),E.cacheControl&&(j.cacheControl=E.cacheControl),y.vectorTile=E.vectorTile||new gn(new q_(I));const V=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,((U,q)=>{if(U||!q)return n(U);const X={};if(f){const te=Ih(c);te.length>0&&(X.resourceTiming=JSON.parse(JSON.stringify(te)))}n(null,Tt({rawTileData:I.slice(0)},q,j,X))}))};this.isSpriteLoaded?V():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):V()})),this.loaded=this.loaded||{},this.loaded[s]=y}))}reloadTile(i,n){const s=this.loaded,c=i.uid,f=this;if(s&&s[c]){const y=s[c];y.showCollisionBoxes=i.showCollisionBoxes,y.enableTerrain=!!i.enableTerrain,y.projection=i.projection,y.tileTransform=Mf(i.tileID.canonical,i.projection);const w=(E,A)=>{const I=y.reloadCallback;I&&(delete y.reloadCallback,y.parse(y.vectorTile,f.layerIndex,this.availableImages,f.actor,I)),n(E,A)};y.status==="parsing"?y.reloadCallback=w:y.status==="done"&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(i,n){const s=i.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),n()}removeTile(i,n){const s=this.loaded,c=i.uid;s&&s[c]&&delete s[c],n()}},a.WritingMode=ba,a.ZoomDependentExpression=ja,a.add=Ha,a.addDynamicAttributes=rx,a.adjoint=function(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=n[4],E=n[5],A=n[6],I=n[7],j=n[8];return i[0]=w*j-E*I,i[1]=f*I-c*j,i[2]=c*E-f*w,i[3]=E*A-y*j,i[4]=s*j-f*A,i[5]=f*y-s*E,i[6]=y*I-w*A,i[7]=c*A-s*I,i[8]=s*w-c*y,i},a.asyncAll=Fe,a.bezier=nt,a.bindAll=on,a.boundsAttributes=vE,a.bufferConvexPolygon=function(i,n){const s=[];for(let c=0;c<i.length;c++){const f=fe(c-1,-1,i.length-1),y=fe(c+1,-1,i.length-1),w=i[c],E=i[y],A=i[f].sub(w).unit(),I=E.sub(w).unit(),j=I.angleWithSep(A.x,A.y),V=A.add(I).unit().mult(-1*n/Math.sin(j/2));s.push(w.add(V))}return s},a.cacheEntryPossiblyAdded=function(i){Ys++,Ys>ss&&(i.getActor().send("enforceCacheSizeLimit",Vr),Ys=0)},a.calculateGlobeLabelMatrix=function(i,n){const{x:s,y:c}=i.point,f=_a(s,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Il(f,f,Fp(No(n)))},a.calculateGlobeMatrix=function(i){const{x:n,y:s}=i.point,{lng:c,lat:f}=i._center;return _a(n,s,i.worldSize,c,f)},a.calculateGlobeMercatorMatrix=function(i){const n=i.pixelsPerMeter,s=n/oi(1,i.center.lat),c=ya(new Float64Array(16));return Ec(c,c,[i.point.x,i.point.y,0]),Cc(c,c,[s,s,n]),Float32Array.from(c)},a.circumferenceAtLatitude=zi,a.clamp=Se,a.clearTileCache=function(i){if(!Zi())return;const n=k.caches.delete(xs);i&&n.catch(i).then((()=>i()))},a.clipLine=nE,a.clone=function(i){var n=new cs(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},a.clone$1=Xn,a.collisionCircleLayout=e5,a.config=z,a.conjugate=function(i,n){return i[0]=-n[0],i[1]=-n[1],i[2]=-n[2],i[3]=n[3],i},a.create=function(){var i=new cs(16);return cs!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=A_,a.createExpression=gr,a.createLayout=$e,a.createStyleLayer=function(i){return i.type==="custom"?new H5(i):new q5[i.type](i)},a.cross=Rp,a.degToRad=gt,a.distance=function(i,n){return Math.hypot(n[0]-i[0],n[1]-i[1],n[2]-i[2])},a.div=function(i,n,s){return i[0]=n[0]/s[0],i[1]=n[1]/s[1],i[2]=n[2]/s[2],i},a.dot=Mo,a.earthRadius=Ac,a.ease=ze,a.easeCubicInOut=st,a.ecefToLatLng=function([i,n,s]){const c=Math.hypot(i,n,s),f=Math.atan2(i,s),y=.5*Math.PI-Math.acos(-n/c);return new hn(ft(f),ft(y))},a.emitValidationErrors=ls,a.endsWith=Sn,a.enforceCacheSizeLimit=function(i){Ii(),vi&&vi.then((n=>{n.keys().then((s=>{for(let c=0;c<s.length-i;c++)n.delete(s[c])}))}))},a.evaluateSizeForFeature=H_,a.evaluateSizeForZoom=em,a.evaluateVariableOffset=aE,a.evented=T,a.exactEquals=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]},a.exactEquals$1=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]},a.exported=Fo,a.exported$1=O,a.extend=Tt,a.extend$1=bi,a.fillExtrusionHeightLift=ES,a.filterObject=nr,a.fromMat4=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[4],i[4]=n[5],i[5]=n[6],i[6]=n[8],i[7]=n[9],i[8]=n[10],i},a.fromQuat=function(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=s+s,E=c+c,A=f+f,I=s*w,j=c*w,V=c*E,U=f*w,q=f*E,X=f*A,te=y*w,ae=y*E,ge=y*A;return i[0]=1-V-X,i[1]=j+ge,i[2]=U-ae,i[3]=0,i[4]=j-ge,i[5]=1-I-X,i[6]=q+te,i[7]=0,i[8]=U+ae,i[9]=q-te,i[10]=1-I-V,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,n){var s=Math.sin(n),c=Math.cos(n);return i[0]=c,i[1]=s,i[2]=0,i[3]=-s,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=Pp,a.furthestTileCorner=function(i){const n=Math.round((i+45+360)%360/90)%4;return vt[n]},a.getAABBPointSquareDist=function(i,n,s){let c=0;for(let f=0;f<2;++f){const y=s?s[f]:0;i[f]>y&&(c+=(i[f]-y)*(i[f]-y)),n[f]<y&&(c+=(y-n[f])*(y-n[f]))}return c},a.getAnchorAlignment=O0,a.getAnchorJustification=F0,a.getBounds=function(i){let n=1/0,s=1/0,c=-1/0,f=-1/0;for(const y of i)n=Math.min(n,y.x),s=Math.min(s,y.y),c=Math.max(c,y.x),f=Math.max(f,y.y);return{min:new Ie(n,s),max:new Ie(c,f)}},a.getColumn=Ns,a.getDefaultExportFromCjs=pe,a.getGridMatrix=function(i,n,s,c){const f=n.getNorth(),y=n.getSouth(),w=n.getWest(),E=n.getEast(),A=1<<i.z,I=E-w,j=f-y,V=I/Za,U=-j/Oi[s],q=[0,V,0,U,0,0,f,w,0];if(i.z>0){const X=180/c;I_(q,q,[X/I+1,0,0,0,X/j+1,0,-.5*X/V,.5*X/U,1])}return q[2]=A,q[5]=i.x,q[8]=i.y,q},a.getImage=ue,a.getJSON=function(i,n){return Ds(Tt(i,{type:"json"}),n)},a.getLatitudinalLod=function(i){const n=Yr-5;i=Se(i,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(gt(i))),3);return Math.round(s*(Oi.length-1))},a.getMapSessionAPI=wi,a.getPerformanceMeasurement=Ih,a.getProjection=mE,a.getRTLTextPluginStatus=C,a.getReferrer=ni,a.getTilePoint=function(i,{x:n,y:s},c=0){return new Ie(((n-c)*i.scale-i.x)*ln,(s*i.scale-i.y)*ln)},a.getTileVec3=function(i,n,s=0){return Au(((n.x-s)*i.scale-i.x)*ln,(n.y*i.scale-i.y)*ln,Dd(n.z,n.y))},a.getVideo=function(i,n){const s=k.document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let c=0;c<i.length;c++){const f=k.document.createElement("source");vo(i[c])||(s.crossOrigin="Anonymous"),f.src=i[c],s.appendChild(f)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(i){const n=[0,0,0],s=ya(new Float64Array(16));return Il(s,i.pixelMatrix,i.globeMatrix),Hr(n,n,s),new Ie(n[0],n[1])},a.globeDenormalizeECEF=Fp,a.globeECEFOrigin=function(i,n){const s=[0,0,0];return Hr(s,s,Gs(No(n.canonical))),Hr(s,s,i),s},a.globeMetersToEcef=Pd,a.globeNormalizeECEF=Gs,a.globePixelsToTileUnits=function(i,n){return ln/(512*Math.pow(2,i))*gf(No(n))},a.globePoleMatrixForTile=function(i,n,s){const c=ya(new Float64Array(16)),f=(n/(1<<i)-.5)*Math.PI*2;return lf(c,s.globeMatrix,f),Float32Array.from(c)},a.globeTileBounds=No,a.globeTiltAtLngLat=bg,a.globeToMercatorTransition=Rd,a.globeUseCustomAntiAliasing=function(i,n,s){const c=Rd(s.zoom),f=i.style.map._antialias,y=!!n.extStandardDerivatives,w=n.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!f&&!w&&y},a.identity=ya,a.identity$1=df,a.invert=Io,a.isFullscreen=function(){return!!k.document.fullscreenElement||!!k.document.webkitFullscreenElement},a.isLngLatBehindGlobe=Vp,a.isMapAuthenticated=function(i){return as.has(i)},a.isMapboxURL=we,a.isSafariWithAntialiasingBug=function(i){const n=i.navigator?i.navigator.userAgent:null;return!!is(i)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=cr,a.latLngToECEF=As,a.len=N_,a.length=kd,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.lngFromMercatorX=Ji,a.loadVectorTile=zE,a.makeRequest=Ds,a.mapValue=function(i,n,s,c,f){return Se((i-n)/(s-n)*(f-c)+c,c,f)},a.mercatorScale=yf,a.mercatorXfromLng=kr,a.mercatorYfromLat=Fr,a.mercatorZfromAltitude=oi,a.mul=pg,a.mul$1=P_,a.multiply=Il,a.multiply$1=I_,a.multiply$2=mg,a.nextPowerOfTwo=Zt,a.normalize=us,a.normalize$1=yg,a.normalize$2=jp,a.number=Yn,a.ortho=function(i,n,s,c,f,y,w){var E=1/(n-s),A=1/(c-f),I=1/(y-w);return i[0]=-2*E,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*A,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(n+s)*E,i[13]=(f+c)*A,i[14]=(w+y)*I,i[15]=1,i},a.pbf=LS,a.perspective=function(i,n,s,c,f){var y,w=1/Math.tan(n/2);return i[0]=w/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+c)*(y=1/(c-f)),i[14]=2*f*c*y):(i[10]=-1,i[14]=-2*c),i},a.pick=function(i,n){const s={};for(let c=0;c<n.length;c++){const f=n[c];f in i&&(s[f]=i[f])}return s},a.plugin=D,a.pointGeometry=Ue,a.polesInViewport=function(i){const n=ya(new Float64Array(16));Il(n,i.pixelMatrix,i.globeMatrix);const s=[0,Yo,0],c=[0,Jt,0];return Hr(s,s,n),Hr(c,c,n),[s[0]>0&&s[0]<=i.width&&s[1]>0&&s[1]<=i.height&&!Vp(i,new hn(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!Vp(i,new hn(i.center.lat,-90))]},a.polygonContainsPoint=Pl,a.polygonIntersectsBox=O_,a.polygonIntersectsPolygon=$p,a.polygonizeBounds=function(i,n,s=0,c=!0){const f=new Ie(s,s),y=i.sub(f),w=n.add(f),E=[y,new Ie(w.x,y.y),w,new Ie(y.x,w.y)];return c&&E.push(y.clone()),E},a.posAttributes=ff,a.postMapLoadEvent=ri,a.postPerformanceEvent=Nr,a.postTurnstileEvent=$n,a.potpack=D0,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=ft,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:g,pluginURL:o}),T.on("pluginStateChange",i),i},a.removeAuthState=function(i){as.delete(i)},a.renderColorRamp=Pg,a.resample=Hs,a.rotateX=Mp,a.rotateX$1=R_,a.rotateY=lf,a.rotateY$1=gg,a.rotateZ=function(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[0],w=n[1],E=n[2],A=n[3],I=n[4],j=n[5],V=n[6],U=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*f+I*c,i[1]=w*f+j*c,i[2]=E*f+V*c,i[3]=A*f+U*c,i[4]=I*f-y*c,i[5]=j*f-w*c,i[6]=V*f-E*c,i[7]=U*f-A*c,i},a.rotateZ$1=function(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A+f*E,i[1]=f*A-c*E,i[2]=y*A+w*E,i[3]=w*A-y*E,i},a.scale=Cc,a.scale$1=Lp,a.scale$2=zr,a.scaleAndAdd=Ad,a.set=function(i,n,s,c){return i[0]=n,i[1]=s,i[2]=c,i},a.setCacheLimits=function(i,n){Vr=i,ss=n},a.setColumn=function(i,n,s){i[4*n+0]=s[0],i[4*n+1]=s[1],i[4*n+2]=s[2],i[4*n+3]=s[3]},a.setRTLTextPlugin=function(i,n,s=!1){if(g===ko||g===ma||g===Sd)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=Fo.resolveURL(i),g=ko,Va=n,x(),s||R()},a.smoothstep=We,a.spec=pt,a.squaredLength=function(i){var n=i[0],s=i[1],c=i[2];return n*n+s*s+c*c},a.storeAuthState=function(i,n){n?as.add(i):as.delete(i)},a.sub=Po,a.subtract=Np,a.symbolSize=t5,a.tileAABB=function(i,n,s,c,f,y,w,E,A){if(A.name==="globe")return L_(i,n,new $_(s,c,f));const I=Mf({z:s,x:c,y:f},A);return new ds([(y+I.x/I.scale)*n,n*(I.y/I.scale),w],[(y+I.x2/I.scale)*n,n*(I.y2/I.scale),E])},a.tileCornersToBounds=Nd,a.tileTransform=Mf,a.transformMat3=function(i,n,s){var c=n[0],f=n[1],y=n[2];return i[0]=c*s[0]+f*s[3]+y*s[6],i[1]=c*s[1]+f*s[4]+y*s[7],i[2]=c*s[2]+f*s[5]+y*s[8],i},a.transformMat4=Hr,a.transformMat4$1=kc,a.transformQuat=Dp,a.transitionTileAABBinECEF=xg,a.translate=Ec,a.transpose=function(i,n){if(i===n){var s=n[1],c=n[2],f=n[5];i[1]=n[3],i[2]=n[6],i[3]=s,i[5]=n[7],i[6]=c,i[7]=f}else i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8];return i},a.triggerPluginCompletionEvent=h,a.uniqueId=sn,a.updateGlobeVertexNormal=function(i,n,s,c,f){const y=5*n+2;i.float32[y+0]=s,i.float32[y+1]=c,i.float32[y+2]=f},a.validateCustomStyleLayer=function(i){const n=[],s=i.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},a.validateFilter=i=>Gi(Es(i)),a.validateFog=i=>Gi(fa(i)),a.validateLayer=i=>Gi(Cp(i)),a.validateLight=i=>Gi(bd(i)),a.validateSource=i=>Gi(wl(i)),a.validateStyle=$i,a.validateTerrain=i=>Gi(za(i)),a.values=lt,a.vectorTile=at,a.version=M,a.warnOnce=Kn,a.window=k,a.wrap=fe})),v(["./shared"],(function(a){function k(be){if(typeof be=="number"||typeof be=="boolean"||typeof be=="string"||be==null)return JSON.stringify(be);if(Array.isArray(be)){let re="[";for(const ue of be)re+=`${k(ue)},`;return`${re}]`}let ne="{";for(const re of Object.keys(be).sort())ne+=`${re}:${k(be[re])},`;return`${ne}}`}function M(be){let ne="";for(const re of a.refProperties)ne+=`/${k(be[re])}`;return ne}class L{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,re){for(const Te of ne)this._layerConfigs[Te.id]=Te,(this._layers[Te.id]=a.createStyleLayer(Te)).compileFilter(),this.keyCache[Te.id]&&delete this.keyCache[Te.id];for(const Te of re)delete this.keyCache[Te],delete this._layerConfigs[Te],delete this._layers[Te];this.familiesBySource={};const ue=(function(Te,we){const Oe={};for(let Le=0;Le<Te.length;Le++){const Ze=we&&we[Te[Le].id]||M(Te[Le]);we&&(we[Te[Le].id]=Ze);let Et=Oe[Ze];Et||(Et=Oe[Ze]=[]),Et.push(Te[Le])}const Be=[];for(const Le in Oe)Be.push(Oe[Le]);return Be})(a.values(this._layerConfigs),this.keyCache);for(const Te of ue){const we=Te.map((Rt=>this._layers[Rt.id])),Oe=we[0];if(Oe.visibility==="none")continue;const Be=Oe.source||"";let Le=this.familiesBySource[Be];Le||(Le=this.familiesBySource[Be]={});const Ze=Oe.sourceLayer||"_geojsonTileLayer";let Et=Le[Ze];Et||(Et=Le[Ze]=[]),Et.push(we)}}}class z{loadTile(ne,re){const{uid:ue,encoding:Te,rawImageData:we,padding:Oe,buildQuadTree:Be}=ne,Le=a.window.ImageBitmap&&we instanceof a.window.ImageBitmap?this.getImageData(we,Oe):we;re(null,new a.DEMData(ue,Le,Te,Oe<1,Be))}getImageData(ne,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const ue=this.offscreenCanvasContext.getImageData(-re,-re,ne.width+2*re,ne.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ue}}function O(be,ne){if(be.length!==0){K(be[0],ne);for(var re=1;re<be.length;re++)K(be[re],!ne)}}function K(be,ne){for(var re=0,ue=0,Te=0,we=be.length,Oe=we-1;Te<we;Oe=Te++){var Be=(be[Te][0]-be[Oe][0])*(be[Oe][1]+be[Te][1]),Le=re+Be;ue+=Math.abs(re)>=Math.abs(Be)?re-Le+Be:Be-Le+re,re=Le}re+ue>=0!=!!ne&&be.reverse()}var H=a.getDefaultExportFromCjs((function be(ne,re){var ue,Te=ne&&ne.type;if(Te==="FeatureCollection")for(ue=0;ue<ne.features.length;ue++)be(ne.features[ue],re);else if(Te==="GeometryCollection")for(ue=0;ue<ne.geometries.length;ue++)be(ne.geometries[ue],re);else if(Te==="Feature")be(ne.geometry,re);else if(Te==="Polygon")O(ne.coordinates,re);else if(Te==="MultiPolygon")for(ue=0;ue<ne.coordinates.length;ue++)O(ne.coordinates[ue],re);return ne}));const Z=a.VectorTileFeature.prototype.toGeoJSON;var Y={exports:{}},ee=a.pointGeometry,ie=a.vectorTile.VectorTileFeature,pe=xe;function xe(be,ne){this.options=ne||{},this.features=be,this.length=be.length}function Ce(be,ne){this.id=typeof be.id=="number"?be.id:void 0,this.type=be.type,this.rawGeometry=be.type===1?[be.geometry]:be.geometry,this.properties=be.tags,this.extent=ne||4096}xe.prototype.feature=function(be){return new Ce(this.features[be],this.options.extent)},Ce.prototype.loadGeometry=function(){var be=this.rawGeometry;this.geometry=[];for(var ne=0;ne<be.length;ne++){for(var re=be[ne],ue=[],Te=0;Te<re.length;Te++)ue.push(new ee(re[Te][0],re[Te][1]));this.geometry.push(ue)}return this.geometry},Ce.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var be=this.geometry,ne=1/0,re=-1/0,ue=1/0,Te=-1/0,we=0;we<be.length;we++)for(var Oe=be[we],Be=0;Be<Oe.length;Be++){var Le=Oe[Be];ne=Math.min(ne,Le.x),re=Math.max(re,Le.x),ue=Math.min(ue,Le.y),Te=Math.max(Te,Le.y)}return[ne,ue,re,Te]},Ce.prototype.toGeoJSON=ie.prototype.toGeoJSON;var je=a.pbf,Ue=pe;function et(be){var ne=new je;return(function(re,ue){for(var Te in re.layers)ue.writeMessage(3,Ie,re.layers[Te])})(be,ne),ne.finish()}function Ie(be,ne){var re;ne.writeVarintField(15,be.version||1),ne.writeStringField(1,be.name||""),ne.writeVarintField(5,be.extent||4096);var ue={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<be.length;re++)ue.feature=be.feature(re),ne.writeMessage(2,ot,ue);var Te=ue.keys;for(re=0;re<Te.length;re++)ne.writeStringField(3,Te[re]);var we=ue.values;for(re=0;re<we.length;re++)ne.writeMessage(4,st,we[re])}function ot(be,ne){var re=be.feature;re.id!==void 0&&ne.writeVarintField(1,re.id),ne.writeMessage(2,ut,be),ne.writeVarintField(3,re.type),ne.writeMessage(4,vt,re)}function ut(be,ne){var re=be.feature,ue=be.keys,Te=be.values,we=be.keycache,Oe=be.valuecache;for(var Be in re.properties){var Le=re.properties[Be],Ze=we[Be];if(Le!==null){Ze===void 0&&(ue.push(Be),we[Be]=Ze=ue.length-1),ne.writeVarint(Ze);var Et=typeof Le;Et!=="string"&&Et!=="boolean"&&Et!=="number"&&(Le=JSON.stringify(Le));var Rt=Et+":"+Le,bt=Oe[Rt];bt===void 0&&(Te.push(Le),Oe[Rt]=bt=Te.length-1),ne.writeVarint(bt)}}}function gt(be,ne){return(ne<<3)+(7&be)}function ft(be){return be<<1^be>>31}function vt(be,ne){for(var re=be.loadGeometry(),ue=be.type,Te=0,we=0,Oe=re.length,Be=0;Be<Oe;Be++){var Le=re[Be],Ze=1;ue===1&&(Ze=Le.length),ne.writeVarint(gt(1,Ze));for(var Et=ue===3?Le.length-1:Le.length,Rt=0;Rt<Et;Rt++){Rt===1&&ue!==1&&ne.writeVarint(gt(2,Et-1));var bt=Le[Rt].x-Te,wn=Le[Rt].y-we;ne.writeVarint(ft(bt)),ne.writeVarint(ft(wn)),Te+=bt,we+=wn}ue===3&&ne.writeVarint(gt(7,1))}}function st(be,ne){var re=typeof be;re==="string"?ne.writeStringField(1,be):re==="boolean"?ne.writeBooleanField(7,be):re==="number"&&(be%1!=0?ne.writeDoubleField(3,be):be<0?ne.writeSVarintField(6,be):ne.writeVarintField(5,be))}Y.exports=et,Y.exports.fromVectorTileJs=et,Y.exports.fromGeojsonVt=function(be,ne){ne=ne||{};var re={};for(var ue in be)re[ue]=new Ue(be[ue].features,ne),re[ue].name=ue,re[ue].version=ne.version,re[ue].extent=ne.extent;return et({layers:re})},Y.exports.GeoJSONWrapper=Ue;var nt=a.getDefaultExportFromCjs(Y.exports);const ze={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:be=>be},Se=Math.fround||(We=new Float32Array(1),be=>(We[0]=+be,We[0]));var We;const fe=3,Fe=5,lt=6;class Tt{constructor(ne){this.options=Object.assign(Object.create(ze),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:re,minZoom:ue,maxZoom:Te}=this.options;re&&console.time("total time");const we=`prepare ${ne.length} points`;re&&console.time(we),this.points=ne;const Oe=[];for(let Le=0;Le<ne.length;Le++){const Ze=ne[Le];if(!Ze.geometry)continue;const[Et,Rt]=Ze.geometry.coordinates,bt=Se(xt(Et)),wn=Se(Zt(Rt));Oe.push(bt,wn,1/0,Le,-1,1),this.options.reduce&&Oe.push(0)}let Be=this.trees[Te+1]=this._createTree(Oe);re&&console.timeEnd(we);for(let Le=Te;Le>=ue;Le--){const Ze=+Date.now();Be=this.trees[Le]=this._createTree(this._cluster(Be,Le)),re&&console.log("z%d: %d clusters in %dms",Le,Be.numItems,+Date.now()-Ze)}return re&&console.timeEnd("total time"),this}getClusters(ne,re){let ue=((ne[0]+180)%360+360)%360-180;const Te=Math.max(-90,Math.min(90,ne[1]));let we=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)ue=-180,we=180;else if(ue>we){const Rt=this.getClusters([ue,Te,180,Oe],re),bt=this.getClusters([-180,Te,we,Oe],re);return Rt.concat(bt)}const Be=this.trees[this._limitZoom(re)],Le=Be.range(xt(ue),Zt(Oe),xt(we),Zt(Te)),Ze=Be.data,Et=[];for(const Rt of Le){const bt=this.stride*Rt;Et.push(Ze[bt+Fe]>1?Kt(Ze,bt,this.clusterProps):this.points[Ze[bt+fe]])}return Et}getChildren(ne){const re=this._getOriginId(ne),ue=this._getOriginZoom(ne),Te="No cluster with the specified id.",we=this.trees[ue];if(!we)throw new Error(Te);const Oe=we.data;if(re*this.stride>=Oe.length)throw new Error(Te);const Be=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),Le=we.within(Oe[re*this.stride],Oe[re*this.stride+1],Be),Ze=[];for(const Et of Le){const Rt=Et*this.stride;Oe[Rt+4]===ne&&Ze.push(Oe[Rt+Fe]>1?Kt(Oe,Rt,this.clusterProps):this.points[Oe[Rt+fe]])}if(Ze.length===0)throw new Error(Te);return Ze}getLeaves(ne,re,ue){const Te=[];return this._appendLeaves(Te,ne,re=re||10,ue=ue||0,0),Te}getTile(ne,re,ue){const Te=this.trees[this._limitZoom(ne)],we=Math.pow(2,ne),{extent:Oe,radius:Be}=this.options,Le=Be/Oe,Ze=(ue-Le)/we,Et=(ue+1+Le)/we,Rt={features:[]};return this._addTileFeatures(Te.range((re-Le)/we,Ze,(re+1+Le)/we,Et),Te.data,re,ue,we,Rt),re===0&&this._addTileFeatures(Te.range(1-Le/we,Ze,1,Et),Te.data,we,ue,we,Rt),re===we-1&&this._addTileFeatures(Te.range(0,Ze,Le/we,Et),Te.data,-1,ue,we,Rt),Rt.features.length?Rt:null}getClusterExpansionZoom(ne){let re=this._getOriginZoom(ne)-1;for(;re<=this.options.maxZoom;){const ue=this.getChildren(ne);if(re++,ue.length!==1)break;ne=ue[0].properties.cluster_id}return re}_appendLeaves(ne,re,ue,Te,we){const Oe=this.getChildren(re);for(const Be of Oe){const Le=Be.properties;if(Le&&Le.cluster?we+Le.point_count<=Te?we+=Le.point_count:we=this._appendLeaves(ne,Le.cluster_id,ue,Te,we):we<Te?we++:ne.push(Be),ne.length===ue)break}return we}_createTree(ne){const re=new a.KDBush(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ne.length;ue+=this.stride)re.add(ne[ue],ne[ue+1]);return re.finish(),re.data=ne,re}_addTileFeatures(ne,re,ue,Te,we,Oe){for(const Be of ne){const Le=Be*this.stride,Ze=re[Le+Fe]>1;let Et,Rt,bt;if(Ze)Et=sn(re,Le,this.clusterProps),Rt=re[Le],bt=re[Le+1];else{const kn=this.points[re[Le+fe]];Et=kn.properties;const[Pn,$n]=kn.geometry.coordinates;Rt=xt(Pn),bt=Zt($n)}const wn={type:1,geometry:[[Math.round(this.options.extent*(Rt*we-ue)),Math.round(this.options.extent*(bt*we-Te))]],tags:Et};let An;An=Ze||this.options.generateId?re[Le+fe]:this.points[re[Le+fe]].id,An!==void 0&&(wn.id=An),Oe.features.push(wn)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,re){const{radius:ue,extent:Te,reduce:we,minPoints:Oe}=this.options,Be=ue/(Te*Math.pow(2,re)),Le=ne.data,Ze=[],Et=this.stride;for(let Rt=0;Rt<Le.length;Rt+=Et){if(Le[Rt+2]<=re)continue;Le[Rt+2]=re;const bt=Le[Rt],wn=Le[Rt+1],An=ne.within(Le[Rt],Le[Rt+1],Be),kn=Le[Rt+Fe];let Pn=kn;for(const $n of An){const jr=$n*Et;Le[jr+2]>re&&(Pn+=Le[jr+Fe])}if(Pn>kn&&Pn>=Oe){let $n,jr=bt*kn,ri=wn*kn,Xi=-1;const Nr=((Rt/Et|0)<<5)+(re+1)+this.points.length;for(const wo of An){const wi=wo*Et;if(Le[wi+2]<=re)continue;Le[wi+2]=re;const as=Le[wi+Fe];jr+=Le[wi]*as,ri+=Le[wi+1]*as,Le[wi+4]=Nr,we&&($n||($n=this._map(Le,Rt,!0),Xi=this.clusterProps.length,this.clusterProps.push($n)),we($n,this._map(Le,wi)))}Le[Rt+4]=Nr,Ze.push(jr/Pn,ri/Pn,1/0,Nr,-1,Pn),we&&Ze.push(Xi)}else{for(let $n=0;$n<Et;$n++)Ze.push(Le[Rt+$n]);if(Pn>1)for(const $n of An){const jr=$n*Et;if(!(Le[jr+2]<=re)){Le[jr+2]=re;for(let ri=0;ri<Et;ri++)Ze.push(Le[jr+ri])}}}}return Ze}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,re,ue){if(ne[re+Fe]>1){const Oe=this.clusterProps[ne[re+lt]];return ue?Object.assign({},Oe):Oe}const Te=this.points[ne[re+fe]].properties,we=this.options.map(Te);return ue&&we===Te?Object.assign({},we):we}}function Kt(be,ne,re){return{type:"Feature",id:be[ne+fe],properties:sn(be,ne,re),geometry:{type:"Point",coordinates:[(ue=be[ne],360*(ue-.5)),vn(be[ne+1])]}};var ue}function sn(be,ne,re){const ue=be[ne+Fe],Te=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,we=be[ne+lt],Oe=we===-1?{}:Object.assign({},re[we]);return Object.assign(Oe,{cluster:!0,cluster_id:be[ne+fe],point_count:ue,point_count_abbreviated:Te})}function xt(be){return be/360+.5}function Zt(be){const ne=Math.sin(be*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function vn(be){const ne=(180-360*be)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function on(be,ne,re,ue){for(var Te,we=ue,Oe=re-ne>>1,Be=re-ne,Le=be[ne],Ze=be[ne+1],Et=be[re],Rt=be[re+1],bt=ne+3;bt<re;bt+=3){var wn=Sn(be[bt],be[bt+1],Le,Ze,Et,Rt);if(wn>we)Te=bt,we=wn;else if(wn===we){var An=Math.abs(bt-Oe);An<Be&&(Te=bt,Be=An)}}we>ue&&(Te-ne>3&&on(be,ne,Te,ue),be[Te+2]=we,re-Te>3&&on(be,Te,re,ue))}function Sn(be,ne,re,ue,Te,we){var Oe=Te-re,Be=we-ue;if(Oe!==0||Be!==0){var Le=((be-re)*Oe+(ne-ue)*Be)/(Oe*Oe+Be*Be);Le>1?(re=Te,ue=we):Le>0&&(re+=Oe*Le,ue+=Be*Le)}return(Oe=be-re)*Oe+(Be=ne-ue)*Be}function Yt(be,ne,re,ue){var Te={id:be===void 0?null:be,type:ne,geometry:re,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(we){var Oe=we.geometry,Be=we.type;if(Be==="Point"||Be==="MultiPoint"||Be==="LineString")nr(we,Oe);else if(Be==="Polygon"||Be==="MultiLineString")for(var Le=0;Le<Oe.length;Le++)nr(we,Oe[Le]);else if(Be==="MultiPolygon")for(Le=0;Le<Oe.length;Le++)for(var Ze=0;Ze<Oe[Le].length;Ze++)nr(we,Oe[Le][Ze])})(Te),Te}function nr(be,ne){for(var re=0;re<ne.length;re+=3)be.minX=Math.min(be.minX,ne[re]),be.minY=Math.min(be.minY,ne[re+1]),be.maxX=Math.max(be.maxX,ne[re]),be.maxY=Math.max(be.maxY,ne[re+1])}function Xn(be,ne,re,ue){if(ne.geometry){var Te=ne.geometry.coordinates,we=ne.geometry.type,Oe=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),Be=[],Le=ne.id;if(re.promoteId?Le=ne.properties[re.promoteId]:re.generateId&&(Le=ue||0),we==="Point")_i(Te,Be);else if(we==="MultiPoint")for(var Ze=0;Ze<Te.length;Ze++)_i(Te[Ze],Be);else if(we==="LineString")Kn(Te,Be,Oe,!1);else if(we==="MultiLineString"){if(re.lineMetrics){for(Ze=0;Ze<Te.length;Ze++)Kn(Te[Ze],Be=[],Oe,!1),be.push(Yt(Le,"LineString",Be,ne.properties));return}Er(Te,Be,Oe,!1)}else if(we==="Polygon")Er(Te,Be,Oe,!0);else{if(we!=="MultiPolygon"){if(we==="GeometryCollection"){for(Ze=0;Ze<ne.geometry.geometries.length;Ze++)Xn(be,{id:Le,geometry:ne.geometry.geometries[Ze],properties:ne.properties},re,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ze=0;Ze<Te.length;Ze++){var Et=[];Er(Te[Ze],Et,Oe,!0),Be.push(Et)}}be.push(Yt(Le,we,Be,ne.properties))}}function _i(be,ne){ne.push(Ks(be[0])),ne.push(xi(be[1])),ne.push(0)}function Kn(be,ne,re,ue){for(var Te,we,Oe=0,Be=0;Be<be.length;Be++){var Le=Ks(be[Be][0]),Ze=xi(be[Be][1]);ne.push(Le),ne.push(Ze),ne.push(0),Be>0&&(Oe+=ue?(Te*Ze-Le*we)/2:Math.sqrt(Math.pow(Le-Te,2)+Math.pow(Ze-we,2))),Te=Le,we=Ze}var Et=ne.length-3;ne[2]=1,on(ne,0,Et,re),ne[Et+2]=1,ne.size=Math.abs(Oe),ne.start=0,ne.end=ne.size}function Er(be,ne,re,ue){for(var Te=0;Te<be.length;Te++){var we=[];Kn(be[Te],we,re,ue),ne.push(we)}}function Ks(be){return be/360+.5}function xi(be){var ne=Math.sin(be*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Zr(be,ne,re,ue,Te,we,Oe,Be){if(ue/=ne,we>=(re/=ne)&&Oe<ue)return be;if(Oe<re||we>=ue)return null;for(var Le=[],Ze=0;Ze<be.length;Ze++){var Et=be[Ze],Rt=Et.geometry,bt=Et.type,wn=Te===0?Et.minX:Et.minY,An=Te===0?Et.maxX:Et.maxY;if(wn>=re&&An<ue)Le.push(Et);else if(!(An<re||wn>=ue)){var kn=[];if(bt==="Point"||bt==="MultiPoint")ti(Rt,kn,re,ue,Te);else if(bt==="LineString")is(Rt,kn,re,ue,Te,!1,Be.lineMetrics);else if(bt==="MultiLineString")Ns(Rt,kn,re,ue,Te,!1);else if(bt==="Polygon")Ns(Rt,kn,re,ue,Te,!0);else if(bt==="MultiPolygon")for(var Pn=0;Pn<Rt.length;Pn++){var $n=[];Ns(Rt[Pn],$n,re,ue,Te,!0),$n.length&&kn.push($n)}if(kn.length){if(Be.lineMetrics&&bt==="LineString"){for(Pn=0;Pn<kn.length;Pn++)Le.push(Yt(Et.id,bt,kn[Pn],Et.tags));continue}bt!=="LineString"&&bt!=="MultiLineString"||(kn.length===1?(bt="LineString",kn=kn[0]):bt="MultiLineString"),bt!=="Point"&&bt!=="MultiPoint"||(bt=kn.length===3?"Point":"MultiPoint"),Le.push(Yt(Et.id,bt,kn,Et.tags))}}}return Le.length?Le:null}function ti(be,ne,re,ue,Te){for(var we=0;we<be.length;we+=3){var Oe=be[we+Te];Oe>=re&&Oe<=ue&&(ne.push(be[we]),ne.push(be[we+1]),ne.push(be[we+2]))}}function is(be,ne,re,ue,Te,we,Oe){for(var Be,Le,Ze=qi(be),Et=Te===0?Vr:ss,Rt=be.start,bt=0;bt<be.length-3;bt+=3){var wn=be[bt],An=be[bt+1],kn=be[bt+2],Pn=be[bt+3],$n=be[bt+4],jr=Te===0?wn:An,ri=Te===0?Pn:$n,Xi=!1;Oe&&(Be=Math.sqrt(Math.pow(wn-Pn,2)+Math.pow(An-$n,2))),jr<re?ri>re&&(Le=Et(Ze,wn,An,Pn,$n,re),Oe&&(Ze.start=Rt+Be*Le)):jr>ue?ri<ue&&(Le=Et(Ze,wn,An,Pn,$n,ue),Oe&&(Ze.start=Rt+Be*Le)):xs(Ze,wn,An,kn),ri<re&&jr>=re&&(Le=Et(Ze,wn,An,Pn,$n,re),Xi=!0),ri>ue&&jr<=ue&&(Le=Et(Ze,wn,An,Pn,$n,ue),Xi=!0),!we&&Xi&&(Oe&&(Ze.end=Rt+Be*Le),ne.push(Ze),Ze=qi(be)),Oe&&(Rt+=Be)}var Nr=be.length-3;wn=be[Nr],An=be[Nr+1],kn=be[Nr+2],(jr=Te===0?wn:An)>=re&&jr<=ue&&xs(Ze,wn,An,kn),Nr=Ze.length-3,we&&Nr>=3&&(Ze[Nr]!==Ze[0]||Ze[Nr+1]!==Ze[1])&&xs(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ne.push(Ze)}function qi(be){var ne=[];return ne.size=be.size,ne.start=be.start,ne.end=be.end,ne}function Ns(be,ne,re,ue,Te,we){for(var Oe=0;Oe<be.length;Oe++)is(be[Oe],ne,re,ue,Te,we,!1)}function xs(be,ne,re,ue){be.push(ne),be.push(re),be.push(ue)}function Vr(be,ne,re,ue,Te,we){var Oe=(we-ne)/(ue-ne);return be.push(we),be.push(re+(Te-re)*Oe),be.push(1),Oe}function ss(be,ne,re,ue,Te,we){var Oe=(we-re)/(Te-re);return be.push(ne+(ue-ne)*Oe),be.push(we),be.push(1),Oe}function vi(be,ne){for(var re=[],ue=0;ue<be.length;ue++){var Te,we=be[ue],Oe=we.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Te=Rs(we.geometry,ne);else if(Oe==="MultiLineString"||Oe==="Polygon"){Te=[];for(var Be=0;Be<we.geometry.length;Be++)Te.push(Rs(we.geometry[Be],ne))}else if(Oe==="MultiPolygon")for(Te=[],Be=0;Be<we.geometry.length;Be++){for(var Le=[],Ze=0;Ze<we.geometry[Be].length;Ze++)Le.push(Rs(we.geometry[Be][Ze],ne));Te.push(Le)}re.push(Yt(we.id,Oe,Te,we.tags))}return re}function Rs(be,ne){var re=[];re.size=be.size,be.start!==void 0&&(re.start=be.start,re.end=be.end);for(var ue=0;ue<be.length;ue+=3)re.push(be[ue]+ne,be[ue+1],be[ue+2]);return re}function Zi(be,ne){if(be.transformed)return be;var re,ue,Te,we=1<<be.z,Oe=be.x,Be=be.y;for(re=0;re<be.features.length;re++){var Le=be.features[re],Ze=Le.geometry,Et=Le.type;if(Le.geometry=[],Et===1)for(ue=0;ue<Ze.length;ue+=2)Le.geometry.push(Ii(Ze[ue],Ze[ue+1],ne,we,Oe,Be));else for(ue=0;ue<Ze.length;ue++){var Rt=[];for(Te=0;Te<Ze[ue].length;Te+=2)Rt.push(Ii(Ze[ue][Te],Ze[ue][Te+1],ne,we,Oe,Be));Le.geometry.push(Rt)}}return be.transformed=!0,be}function Ii(be,ne,re,ue,Te,we){return[Math.round(re*(be*ue-Te)),Math.round(re*(ne*ue-we))]}function xo(be,ne,re,ue,Te){for(var we=ne===Te.maxZoom?0:Te.tolerance/((1<<ne)*Te.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:ue,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Be=0;Be<be.length;Be++){Oe.numFeatures++,Ys(Oe,be[Be],we,Te);var Le=be[Be].minX,Ze=be[Be].minY,Et=be[Be].maxX,Rt=be[Be].maxY;Le<Oe.minX&&(Oe.minX=Le),Ze<Oe.minY&&(Oe.minY=Ze),Et>Oe.maxX&&(Oe.maxX=Et),Rt>Oe.maxY&&(Oe.maxY=Rt)}return Oe}function Ys(be,ne,re,ue){var Te=ne.geometry,we=ne.type,Oe=[];if(we==="Point"||we==="MultiPoint")for(var Be=0;Be<Te.length;Be+=3)Oe.push(Te[Be]),Oe.push(Te[Be+1]),be.numPoints++,be.numSimplified++;else if(we==="LineString")Mi(Oe,Te,be,re,!1,!1);else if(we==="MultiLineString"||we==="Polygon")for(Be=0;Be<Te.length;Be++)Mi(Oe,Te[Be],be,re,we==="Polygon",Be===0);else if(we==="MultiPolygon")for(var Le=0;Le<Te.length;Le++){var Ze=Te[Le];for(Be=0;Be<Ze.length;Be++)Mi(Oe,Ze[Be],be,re,!0,Be===0)}if(Oe.length){var Et=ne.tags||null;if(we==="LineString"&&ue.lineMetrics){for(var Rt in Et={},ne.tags)Et[Rt]=ne.tags[Rt];Et.mapbox_clip_start=Te.start/Te.size,Et.mapbox_clip_end=Te.end/Te.size}var bt={geometry:Oe,type:we==="Polygon"||we==="MultiPolygon"?3:we==="LineString"||we==="MultiLineString"?2:1,tags:Et};ne.id!==null&&(bt.id=ne.id),be.features.push(bt)}}function Mi(be,ne,re,ue,Te,we){var Oe=ue*ue;if(ue>0&&ne.size<(Te?Oe:ue))re.numPoints+=ne.length/3;else{for(var Be=[],Le=0;Le<ne.length;Le+=3)(ue===0||ne[Le+2]>Oe)&&(re.numSimplified++,Be.push(ne[Le]),Be.push(ne[Le+1])),re.numPoints++;Te&&(function(Ze,Et){for(var Rt=0,bt=0,wn=Ze.length,An=wn-2;bt<wn;An=bt,bt+=2)Rt+=(Ze[bt]-Ze[An])*(Ze[bt+1]+Ze[An+1]);if(Rt>0===Et)for(bt=0,wn=Ze.length;bt<wn/2;bt+=2){var kn=Ze[bt],Pn=Ze[bt+1];Ze[bt]=Ze[wn-2-bt],Ze[bt+1]=Ze[wn-1-bt],Ze[wn-2-bt]=kn,Ze[wn-1-bt]=Pn}})(Be,we),be.push(Be)}}function os(be,ne){var re=(ne=this.options=(function(Te,we){for(var Oe in we)Te[Oe]=we[Oe];return Te})(Object.create(this.options),ne)).debug;if(re&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");var ue=(function(Te,we){var Oe=[];if(Te.type==="FeatureCollection")for(var Be=0;Be<Te.features.length;Be++)Xn(Oe,Te.features[Be],we,Be);else Xn(Oe,Te.type==="Feature"?Te:{geometry:Te},we);return Oe})(be,ne);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ue=(function(Te,we){var Oe=we.buffer/we.extent,Be=Te,Le=Zr(Te,1,-1-Oe,Oe,0,-1,2,we),Ze=Zr(Te,1,1-Oe,2+Oe,0,-1,2,we);return(Le||Ze)&&(Be=Zr(Te,1,-Oe,1+Oe,0,-1,2,we)||[],Le&&(Be=vi(Le,1).concat(Be)),Ze&&(Be=Be.concat(vi(Ze,-1)))),Be})(ue,ne),ue.length&&this.splitTile(ue,0,0,0),re&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ni(be,ne,re){return 32*((1<<be)*re+ne)+be}function Ds(be,ne){const re=be.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const ue=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!ue)return ne(null,null);const Te=new class{constructor(Oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Oe.length,this._features=Oe}feature(Oe){return new class{constructor(Be){this._feature=Be,this.extent=a.EXTENT,this.type=Be.type,this.properties=Be.tags,"id"in Be&&!isNaN(Be.id)&&(this.id=parseInt(Be.id,10))}loadGeometry(){if(this._feature.type===1){const Be=[];for(const Le of this._feature.geometry)Be.push([new a.Point(Le[0],Le[1])]);return Be}{const Be=[];for(const Le of this._feature.geometry){const Ze=[];for(const Et of Le)Ze.push(new a.Point(Et[0],Et[1]));Be.push(Ze)}return Be}}toGeoJSON(Be,Le,Ze){return Z.call(this,Be,Le,Ze)}}(this._features[Oe])}}(ue.features);let we=nt(Te);we.byteOffset===0&&we.byteLength===we.buffer.byteLength||(we=new Uint8Array(we)),ne(null,{vectorTile:Te,rawData:we.buffer})}os.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},os.prototype.splitTile=function(be,ne,re,ue,Te,we,Oe){for(var Be=[be,ne,re,ue],Le=this.options,Ze=Le.debug;Be.length;){ue=Be.pop(),re=Be.pop(),ne=Be.pop(),be=Be.pop();var Et=1<<ne,Rt=ni(ne,re,ue),bt=this.tiles[Rt];if(!bt&&(Ze>1&&console.time("creation"),bt=this.tiles[Rt]=xo(be,ne,re,ue,Le),this.tileCoords.push({z:ne,x:re,y:ue}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,re,ue,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));var wn="z"+ne;this.stats[wn]=(this.stats[wn]||0)+1,this.total++}if(bt.source=be,Te){if(ne===Le.maxZoom||ne===Te)continue;var An=1<<Te-ne;if(re!==Math.floor(we/An)||ue!==Math.floor(Oe/An))continue}else if(ne===Le.indexMaxZoom||bt.numPoints<=Le.indexMaxPoints)continue;if(bt.source=null,be.length!==0){Ze>1&&console.time("clipping");var kn,Pn,$n,jr,ri,Xi,Nr=.5*Le.buffer/Le.extent,wo=.5-Nr,wi=.5+Nr,as=1+Nr;kn=Pn=$n=jr=null,ri=Zr(be,Et,re-Nr,re+wi,0,bt.minX,bt.maxX,Le),Xi=Zr(be,Et,re+wo,re+as,0,bt.minX,bt.maxX,Le),be=null,ri&&(kn=Zr(ri,Et,ue-Nr,ue+wi,1,bt.minY,bt.maxY,Le),Pn=Zr(ri,Et,ue+wo,ue+as,1,bt.minY,bt.maxY,Le),ri=null),Xi&&($n=Zr(Xi,Et,ue-Nr,ue+wi,1,bt.minY,bt.maxY,Le),jr=Zr(Xi,Et,ue+wo,ue+as,1,bt.minY,bt.maxY,Le),Xi=null),Ze>1&&console.timeEnd("clipping"),Be.push(kn||[],ne+1,2*re,2*ue),Be.push(Pn||[],ne+1,2*re,2*ue+1),Be.push($n||[],ne+1,2*re+1,2*ue),Be.push(jr||[],ne+1,2*re+1,2*ue+1)}}},os.prototype.getTile=function(be,ne,re){var ue=this.options,Te=ue.extent,we=ue.debug;if(be<0||be>24)return null;var Oe=1<<be,Be=ni(be,ne=(ne%Oe+Oe)%Oe,re);if(this.tiles[Be])return Zi(this.tiles[Be],Te);we>1&&console.log("drilling down to z%d-%d-%d",be,ne,re);for(var Le,Ze=be,Et=ne,Rt=re;!Le&&Ze>0;)Ze--,Et=Math.floor(Et/2),Rt=Math.floor(Rt/2),Le=this.tiles[ni(Ze,Et,Rt)];return Le&&Le.source?(we>1&&console.log("found parent tile z%d-%d-%d",Ze,Et,Rt),we>1&&console.time("drilling down"),this.splitTile(Le.source,Ze,Et,Rt,be,ne,re),we>1&&console.timeEnd("drilling down"),this.tiles[Be]?Zi(this.tiles[Be],Te):null):null};class Js extends a.VectorTileWorkerSource{constructor(ne,re,ue,Te,we){super(ne,re,ue,Te,Ds),we&&(this.loadGeoJSON=we)}loadData(ne,re){const ue=ne&&ne.request,Te=ue&&ue.collectResourceTiming;this.loadGeoJSON(ne,((we,Oe)=>{if(we||!Oe)return re(we);if(typeof Oe!="object")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{H(Oe,!0);try{if(ne.filter){const Le=a.createExpression(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Le.result==="error")throw new Error(Le.value.map((Et=>`${Et.key}: ${Et.message}`)).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter((Et=>Le.value.evaluate({zoom:0},Et)))}}this._geoJSONIndex=ne.cluster?new Tt((function({superclusterOptions:Le,clusterProperties:Ze}){if(!Ze||!Le)return Le;const Et={},Rt={},bt={accumulated:null,zoom:0},wn={properties:null},An=Object.keys(Ze);for(const kn of An){const[Pn,$n]=Ze[kn],jr=a.createExpression($n),ri=a.createExpression(typeof Pn=="string"?[Pn,["accumulated"],["get",kn]]:Pn);Et[kn]=jr.value,Rt[kn]=ri.value}return Le.map=kn=>{wn.properties=kn;const Pn={};for(const $n of An)Pn[$n]=Et[$n].evaluate(bt,wn);return Pn},Le.reduce=(kn,Pn)=>{wn.properties=Pn;for(const $n of An)bt.accumulated=kn[$n],kn[$n]=Rt[$n].evaluate(bt,wn)},Le})(ne)).load(Oe.features):(function(Le,Ze){return new os(Le,Ze)})(Oe,ne.geojsonVtOptions)}catch(Le){return re(Le)}this.loaded={};const Be={};if(Te){const Le=a.getPerformanceMeasurement(ue);Le&&(Be.resourceTiming={},Be.resourceTiming[ne.source]=JSON.parse(JSON.stringify(Le)))}re(null,Be)}}))}reloadTile(ne,re){const ue=this.loaded;return ue&&ue[ne.uid]?super.reloadTile(ne,re):this.loadTile(ne,re)}loadGeoJSON(ne,re){if(ne.request)a.getJSON(ne.request,re);else{if(typeof ne.data!="string")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(ne.data))}catch{return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(ue){re(ue)}}getClusterChildren(ne,re){try{re(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(ue){re(ue)}}getClusterLeaves(ne,re){try{re(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(ue){re(ue)}}}class vo{constructor(ne){this.self=ne,this.actor=new a.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Js},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,ue)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=ue},this.self.registerRTLTextPlugin=re=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=re.applyArabicShaping,a.plugin.processBidirectionalText=re.processBidirectionalText,a.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(ne,re,ue){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],ue()}checkIfReady(ne,re,ue){ue()}setReferrer(ne,re){this.referrer=re}spriteLoaded(ne,re){this.isSpriteLoaded[ne]=re;for(const ue in this.workerSources[ne]){const Te=this.workerSources[ne][ue];for(const we in Te)Te[we]instanceof a.VectorTileWorkerSource&&(Te[we].isSpriteLoaded=re,Te[we].fire(new a.Event("isSpriteLoaded")))}}setImages(ne,re,ue){this.availableImages[ne]=re;for(const Te in this.workerSources[ne]){const we=this.workerSources[ne][Te];for(const Oe in we)we[Oe].availableImages=re}ue()}enableTerrain(ne,re,ue){this.terrain=re,ue()}setProjection(ne,re){this.projections[ne]=a.getProjection(re)}setLayers(ne,re,ue){this.getLayerIndex(ne).replace(re),ue()}updateLayers(ne,re,ue){this.getLayerIndex(ne).update(re.layers,re.removedIds),ue()}loadTile(ne,re,ue){const Te=this.enableTerrain?a.extend({enableTerrain:this.terrain},re):re;Te.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).loadTile(Te,ue)}loadDEMTile(ne,re,ue){const Te=this.enableTerrain?a.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(ne,re.source).loadTile(Te,ue)}reloadTile(ne,re,ue){const Te=this.enableTerrain?a.extend({enableTerrain:this.terrain},re):re;Te.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).reloadTile(Te,ue)}abortTile(ne,re,ue){this.getWorkerSource(ne,re.type,re.source).abortTile(re,ue)}removeTile(ne,re,ue){this.getWorkerSource(ne,re.type,re.source).removeTile(re,ue)}removeSource(ne,re,ue){if(!this.workerSources[ne]||!this.workerSources[ne][re.type]||!this.workerSources[ne][re.type][re.source])return;const Te=this.workerSources[ne][re.type][re.source];delete this.workerSources[ne][re.type][re.source],Te.removeSource!==void 0?Te.removeSource(re,ue):ue()}loadWorkerSource(ne,re,ue){try{this.self.importScripts(re.url),ue()}catch(Te){ue(Te.toString())}}syncRTLPluginState(ne,re,ue){try{a.plugin.setState(re);const Te=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&Te!=null){this.self.importScripts(Te);const we=a.plugin.isParsed();ue(we?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Te}`),we)}}catch(Te){ue(Te.toString())}}getAvailableImages(ne){let re=this.availableImages[ne];return re||(re=[]),re}getLayerIndex(ne){let re=this.layerIndexes[ne];return re||(re=this.layerIndexes[ne]=new L),re}getWorkerSource(ne,re,ue){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][re]||(this.workerSources[ne][re]={}),!this.workerSources[ne][re][ue]){const Te={send:(we,Oe,Be,Le,Ze,Et)=>{this.actor.send(we,Oe,Be,ne,Ze,Et)},scheduler:this.actor.scheduler};this.workerSources[ne][re][ue]=new this.workerSourceTypes[re](Te,this.getLayerIndex(ne),this.getAvailableImages(ne),this.isSpriteLoaded[ne])}return this.workerSources[ne][re][ue]}getDEMWorkerSource(ne,re){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][re]||(this.demWorkerSources[ne][re]=new z),this.demWorkerSources[ne][re]}enforceCacheSizeLimit(ne,re){a.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(ne,re,ue){ue(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new vo(self)),vo})),v(["./shared"],(function(a){function k(g,o){if(Array.isArray(g)){if(!Array.isArray(o)||g.length!==o.length)return!1;for(let h=0;h<g.length;h++)if(!k(g[h],o[h]))return!1;return!0}if(typeof g=="object"&&g!==null&&o!==null){if(typeof o!="object"||Object.keys(g).length!==Object.keys(o).length)return!1;for(const h in g)if(!k(g[h],o[h]))return!1;return!0}return g===o}var M=L;function L(g){return!(function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var x,T,C=new Blob([""],{type:"text/javascript"}),R=URL.createObjectURL(C);try{T=new Worker(R),x=!0}catch{x=!1}return T&&T.terminate(),URL.revokeObjectURL(R),x})()?"Uint8ClampedArray"in window?ArrayBuffer.isView?(function(){var x=document.createElement("canvas");x.width=x.height=1;var T=x.getContext("2d");if(!T)return!1;var C=T.getImageData(0,0,1,1);return C&&C.width===x.width})()?(z[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(z[h]=(function(x){var T,C=(function(R){var D=document.createElement("canvas"),B=Object.create(L.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=R,D.getContext("webgl",B)||D.getContext("experimental-webgl",B)})(x);if(!C)return!1;try{T=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!T||C.isContextLost())&&(C.shaderSource(T,"void main() {}"),C.compileShader(T),C.getShaderParameter(T,C.COMPILE_STATUS)===!0)})(h)),z[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h})(g)}var z={};function O(g,o,h){const x=a.window.document.createElement(g);return o!==void 0&&(x.className=o),h&&h.appendChild(x),x}function K(g,o,h){const x=a.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const T of Object.keys(o))x.setAttributeNS(null,T,o[T]);return h&&h.appendChild(x),x}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const H=a.window.document&&a.window.document.documentElement.style,Z=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Y;function ee(){H&&Z&&(Y=H[Z],H[Z]="none")}function ie(){H&&Z&&(H[Z]=Y)}function pe(g){g.preventDefault(),g.stopPropagation(),a.window.removeEventListener("click",pe,!0)}function xe(){a.window.addEventListener("click",pe,!0),a.window.setTimeout((()=>{a.window.removeEventListener("click",pe,!0)}),0)}function Ce(g,o){const h=g.getBoundingClientRect();return et(g,h,o)}function je(g,o){const h=g.getBoundingClientRect(),x=[];for(let T=0;T<o.length;T++)x.push(et(g,h,o[T]));return x}function Ue(g){return a.window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function et(g,o,h){const x=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new a.Point((h.clientX-o.left)*x,(h.clientY-o.top)*x)}function Ie(g,o){var h=o[0],x=o[1],T=o[2],C=o[3],R=h*C-T*x;return R?(g[0]=C*(R=1/R),g[1]=-x*R,g[2]=-T*R,g[3]=h*R,g):null}function ot(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class ut extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:x}of this.requestors)this._notify(h,x);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,h){this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let x=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),x=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),x=!1),this._validateContent(h.content,h)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),x=!1),x}_validateStretch(o,h){if(!o)return!0;let x=0;for(const T of o){if(T[0]<x||T[1]<T[0]||h<T[1])return!1;x=T[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let x=!0;if(!this.isLoaded())for(const T of o)this.images[T]||(x=!1);this.isLoaded()||x?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const x={};for(const T of o){this.images[T]||this.fire(new a.Event("styleimagemissing",{id:T}));const C=this.images[T];C?x[T]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:a.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,x)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],x=this.getImage(o);if(!x)return null;if(h&&h.position.version===x.version)return h.position;if(h)h.position.version=x.version;else{const T={w:x.data.width+2,h:x.data.height+2,x:0,y:0},C=new a.ImagePosition(T,x);this.patterns[o]={bin:T,position:C}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const C in this.patterns)o.push(this.patterns[C].bin);const{w:h,h:x}=a.potpack(o),T=this.atlasImage;T.resize({width:h||1,height:x||1});for(const C in this.patterns){const{bin:R}=this.patterns[C],D=R.x+1,B=R.y+1,G=this.images[C].data,$=G.width,J=G.height;a.RGBAImage.copy(G,T,{x:0,y:0},{x:D,y:B},{width:$,height:J}),a.RGBAImage.copy(G,T,{x:0,y:J-1},{x:D,y:B-1},{width:$,height:1}),a.RGBAImage.copy(G,T,{x:0,y:0},{x:D,y:B+J},{width:$,height:1}),a.RGBAImage.copy(G,T,{x:$-1,y:0},{x:D-1,y:B},{width:1,height:J}),a.RGBAImage.copy(G,T,{x:0,y:0},{x:D+$,y:B},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const x=this.images[h];ot(x)&&this.updateImage(h,x)}}}const gt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(g,o){return(function([h,x,T]){const C=a.degToRad(x+90),R=a.degToRad(T);return{x:h*Math.cos(C)*Math.sin(R),y:h*Math.sin(C)*Math.sin(R),z:h*Math.cos(R),azimuthal:x,polar:T}})(g.expression.evaluate(o))}interpolate(g,o,h){return{x:a.number(g.x,o.x,h),y:a.number(g.y,o.y,h),z:a.number(g.z,o.z,h),azimuthal:a.number(g.azimuthal,o.azimuthal,h),polar:a.number(g.polar,o.polar,h)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class ft extends a.Evented{constructor(o){super(),this._transitionable=new a.Transitionable(gt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(a.validateLight,o,h))for(const x in o){const T=o[x];a.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),T):this._transitionable.setValue(x,T)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,x){return(!x||x.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const vt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let st=class extends a.Evented{constructor(g,o){super(),this._transitionable=new a.Transitionable(vt),this.set(g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(g){for(const o in g){const h=g[o];a.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),h):this._transitionable.setValue(o,h)}}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}};function nt(g,o,h,x){const T=a.smoothstep(45,65,h),[C,R]=ze(g,x),D=a.length(o);let B=1-Math.min(1,Math.exp((D-C)/(R-C)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*T*g.alpha}function ze(g,o){const h=.5/Math.tan(.5*o);return[g.range[0]+h,g.range[1]+h]}const Se=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class We extends a.Evented{constructor(o,h){super(),this._transitionable=new a.Transitionable(Se),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const o=this._transform,h=o.projection.name==="globe",x=a.globeToMercatorTransition(o.zoom),T=this.properties.get("range"),C=[.5,3];return{range:h?[a.number(C[0],T[0],x),a.number(C[1],T[1],x)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h={}){if(!this._validate(a.validateFog,o,h)){for(const x of Object.keys(a.spec.fog))o&&o[x]===void 0&&(o[x]=a.spec.fog[x].default);for(const x in o){const T=o[x];a.endsWith(x,"-transition")?this._transitionable.setTransition(x.slice(0,-11),T):this._transitionable.setValue(x,T)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?(function(x,T,C){const R=a.MercatorCoordinate.fromLngLat(T),D=C.elevation?C.elevation.getAtPointOrZero(R):0,B=[R.x,R.y,D];return a.transformMat4(B,B,C.mercatorFogMatrix),nt(x,B,C.pitch,C._fov)})(this.state,o,h):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?ze(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,x){return(!x||x.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class fe{constructor(o,h){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const x=this.workerPool.acquire(this.id);for(let T=0;T<x.length;T++){const C=new fe.Actor(x[T],h,this.id);C.name=`Worker ${T}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(o,h,x){a.asyncAll(this.actors,((T,C)=>{T.send(o,h,C)}),x=x||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((o=>{o.remove()})),this.actors=[],this.workerPool.release(this.id)}}function Fe(g,o,h){return o*(a.EXTENT/(g.tileSize*Math.pow(2,h-g.tileID.overscaledZ)))}fe.Actor=a.Actor;class lt{constructor(o,h,x,T){this.screenBounds=o,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=x,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(o,h){let x,T;if(o instanceof a.Point||typeof o[0]=="number"){const C=a.Point.convert(o);x=[C],T=h.isPointAboveHorizon(C)}else{const C=a.Point.convert(o[0]),R=a.Point.convert(o[1]);x=[C,R],T=a.polygonizeBounds(C,R).every((D=>h.isPointAboveHorizon(D)))}return new lt(x,h.getCameraPoint(),T,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const h=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],T=a.polygonizeBounds(h,x,0,!1);return this.cameraPoint.y>x.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<x.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=x.x?T[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(T[3]=this.cameraPoint)),a.bufferConvexPolygon(T,o)}bufferedCameraGeometryGlobe(o){const h=this.screenBounds[0],x=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],T=a.polygonizeBounds(h,x,o),C=this.cameraPoint.clone();switch(3*((C.y>h.y)+(C.y>x.y))+((C.x>h.x)+(C.x>x.x))){case 0:T[0]=C,T[4]=C.clone();break;case 1:T.splice(1,0,C);break;case 2:T[1]=C;break;case 3:T.splice(4,0,C);break;case 5:T.splice(2,0,C);break;case 6:T[3]=C;break;case 7:T.splice(3,0,C);break;case 8:T[2]=C}return T}containsTile(o,h,x,T=0){const C=o.queryPadding/h._pixelsPerMercatorPixel+1,R=x?this._bufferedCameraMercator(C,h):this._bufferedScreenMercator(C,h);let D=o.tileID.wrap+(R.unwrapped?T:0);const B=R.polygon.map((me=>a.getTilePoint(o.tileTransform,me,D)));if(!a.polygonIntersectsBox(B,0,0,a.EXTENT,a.EXTENT))return;D=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const G=this.screenGeometryMercator.polygon.map((me=>a.getTileVec3(o.tileTransform,me,D))),$=G.map((me=>new a.Point(me[0],me[1]))),J=h.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),oe=a.getTileVec3(o.tileTransform,J,D),ce=G.map((me=>{const Q=a.sub(me,me,oe);return a.normalize(Q,Q),new a.Ray(oe,Q)})),he=Fe(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:ce,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(de=a.getBounds(B),de.min.x=a.clamp(de.min.x,0,a.EXTENT),de.min.y=a.clamp(de.min.y,0,a.EXTENT),de.max.x=a.clamp(de.max.x,0,a.EXTENT),de.max.y=a.clamp(de.max.y,0,a.EXTENT),de),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:he};var de}_bufferedScreenMercator(o,h){const x=sn(o);if(this._screenRaycastCache[x])return this._screenRaycastCache[x];{let T;return T=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map((C=>h.pointCoordinate3D(C))),unwrapped:!0},this._screenRaycastCache[x]=T,T}}_bufferedCameraMercator(o,h){const x=sn(o);if(this._cameraRaycastCache[x])return this._cameraRaycastCache[x];{let T;return T=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map((C=>h.pointCoordinate3D(C))),unwrapped:!0},this._cameraRaycastCache[x]=T,T}}_projectAndResample(o,h){const x=(function(C,R){const D=a.multiply([],R.pixelMatrix,R.globeMatrix),B=[0,-a.GLOBE_RADIUS,0,1],G=[0,a.GLOBE_RADIUS,0,1],$=[0,0,0,1];a.transformMat4$1(B,B,D),a.transformMat4$1(G,G,D),a.transformMat4$1($,$,D);const J=new a.Point(B[0]/B[3],B[1]/B[3]),oe=new a.Point(G[0]/G[3],G[1]/G[3]),ce=a.polygonContainsPoint(C,J)&&B[3]<$[3],he=a.polygonContainsPoint(C,oe)&&G[3]<$[3];if(!ce&&!he)return null;const de=(function(Re,Ge,$e){for(let Ye=1;Ye<Re.length;Ye++){const At=Kt(Ge.pointCoordinate3D(Re[Ye-1]).x),qe=Kt(Ge.pointCoordinate3D(Re[Ye]).x);if($e<0){if(At<qe)return{idx:Ye,t:-At/(qe-1-At)}}else if(qe<At)return{idx:Ye,t:(1-At)/(qe+1-At)}}return null})(C,R,ce?-1:1);if(!de)return null;const{idx:me,t:Q}=de;let le=me>1?Tt(C.slice(0,me),R):[],_e=me<C.length?Tt(C.slice(me),R):[];le=le.map((Re=>new a.Point(Kt(Re.x),Re.y))),_e=_e.map((Re=>new a.Point(Kt(Re.x),Re.y)));const ve=[...le];ve.length===0&&ve.push(_e[_e.length-1]);const Ne=a.number(ve[ve.length-1].y,(_e.length===0?le[0]:_e[0]).y,Q);let De;return De=ce?[new a.Point(0,Ne),new a.Point(0,0),new a.Point(1,0),new a.Point(1,Ne)]:[new a.Point(1,Ne),new a.Point(1,1),new a.Point(0,1),new a.Point(0,Ne)],ve.push(...De),_e.length===0?ve.push(le[0]):ve.push(..._e),{polygon:ve.map((Re=>new a.MercatorCoordinate(Re.x,Re.y))),unwrapped:!1}})(o,h);if(x)return x;const T=(function(C,R){let D=!1,B=-1/0,G=0;for(let J=0;J<C.length-1;J++)C[J].x>B&&(B=C[J].x,G=J);for(let J=0;J<C.length-1;J++){const oe=(G+J)%(C.length-1),ce=C[oe],he=C[oe+1];Math.abs(ce.x-he.x)>.5&&(ce.x<he.x?(ce.x+=1,oe===0&&(C[C.length-1].x+=1)):(he.x+=1,oe+1===C.length-1&&(C[0].x+=1)),D=!0)}const $=a.mercatorXfromLng(R.center.lng);return D&&$<Math.abs($-1)&&C.forEach((J=>{J.x-=1})),{polygon:C,unwrapped:D}})(Tt(o,h).map((C=>new a.Point(Kt(C.x),C.y))),h);return{polygon:T.polygon.map((C=>new a.MercatorCoordinate(C.x,C.y))),unwrapped:T.unwrapped}}}function Tt(g,o){return a.resample(g,(h=>{const x=o.pointCoordinate3D(h);h.x=x.x,h.y=x.y}),1/256)}function Kt(g){return g<0?1+g%1:g%1}function sn(g){return 100*g|0}function xt(g,o,h,x,T){const C=function(R,D){if(R)return T(R);if(D){g.url&&D.tiles&&g.tiles&&delete g.tiles;const B=a.pick(a.extend(D,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(B.vectorLayers=D.vector_layers,B.vectorLayerIds=B.vectorLayers.map((G=>G.id))),B.tiles=o.canonicalizeTileset(B,g.url),T(null,B)}};return g.url?a.getJSON(o.transformRequest(o.normalizeSourceURL(g.url,null,h,x),a.ResourceType.Source),C):a.exported.frame((()=>C(null,g)))}class Zt{constructor(o,h,x){this.bounds=a.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=x||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),x=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*h),T=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*h),C=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*h),R=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=x&&o.x<C&&o.y>=T&&o.y<R}}class vn{constructor(o,h,x){this.context=o;const T=o.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!x,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const on={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Sn{constructor(o,h,x,T){this.length=h.length,this.attributes=x,this.itemSize=h.bytesPerElement,this.dynamicDraw=T,this.context=o;const C=o.gl;this.buffer=C.createBuffer(),o.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let x=0;x<this.attributes.length;x++){const T=h.attributes[this.attributes[x].name];T!==void 0&&o.enableVertexAttribArray(T)}}setVertexAttribPointers(o,h,x){for(let T=0;T<this.attributes.length;T++){const C=this.attributes[T],R=h.attributes[C.name];R!==void 0&&o.vertexAttribPointer(R,C.components,o[on[C.type]],!1,this.itemSize,C.offset+this.itemSize*(x||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Yt{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class nr extends Yt{getDefault(){return a.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Xn extends Yt{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class _i extends Yt{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Kn extends Yt{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Er extends Yt{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Ks extends Yt{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class xi extends Yt{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Zr extends Yt{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class ti extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class is extends Yt{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class qi extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ns extends Yt{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class xs extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class Vr extends Yt{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class ss extends Yt{getDefault(){return a.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class vi extends Yt{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Rs extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class Zi extends Yt{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ii extends Yt{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let xo,Ys=class extends Yt{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Mi extends Yt{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class os extends Yt{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ni extends Yt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Ds extends Yt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Js extends Yt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class vo extends Yt{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class be extends Yt{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ne extends Yt{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class re extends Yt{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ue extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Te extends Yt{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class we extends Yt{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class Oe extends we{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Be extends we{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Le extends Be{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ze{constructor(o,h,x,T){this.context=o,this.width=h,this.height=x;const C=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Oe(o,C),T&&(this.depthAttachment=new Be(o,C))}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const x=this.depthAttachment.get();x&&o.deleteRenderbuffer(x)}o.deleteFramebuffer(this.framebuffer)}}class Et{constructor(o,h=!1){if(this.gl=o,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const x=o;this.extVertexArrayObject={createVertexArrayOES:x.createVertexArray.bind(o),deleteVertexArrayOES:x.deleteVertexArray.bind(o),bindVertexArrayOES:x.bindVertexArray.bind(o)}}this.clearColor=new nr(this),this.clearDepth=new Xn(this),this.clearStencil=new _i(this),this.colorMask=new Kn(this),this.depthMask=new Er(this),this.stencilMask=new Ks(this),this.stencilFunc=new xi(this),this.stencilOp=new Zr(this),this.stencilTest=new ti(this),this.depthRange=new is(this),this.depthTest=new qi(this),this.depthFunc=new Ns(this),this.blend=new xs(this),this.blendFunc=new Vr(this),this.blendColor=new ss(this),this.blendEquation=new vi(this),this.cullFace=new Rs(this),this.cullFaceSide=new Zi(this),this.frontFace=new Ii(this),this.program=new Ys(this),this.activeTexture=new Mi(this),this.viewport=new os(this),this.bindFramebuffer=new ni(this),this.bindRenderbuffer=new Ds(this),this.bindTexture=new Js(this),this.bindVertexBuffer=new vo(this),this.bindElementBuffer=new be(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ne(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new ue(this),this.pixelStoreUnpackFlipY=new Te(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new vn(this,o,h)}createVertexBuffer(o,h,x){return new Sn(this,o,h,x)}createRenderbuffer(o,h,x){const T=this.gl,C=T.createRenderbuffer();return this.bindRenderbuffer.set(C),T.renderbufferStorage(T.RENDERBUFFER,o,h,x),this.bindRenderbuffer.set(null),C}createFramebuffer(o,h,x){return new Ze(this,o,h,x)}clear({color:o,depth:h,stencil:x}){const T=this.gl;let C=0;o&&(C|=T.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(C|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),x!==void 0&&(C|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(x),this.stencilMask.set(255)),T.clear(C)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){k(o.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Rt extends a.Evented{constructor(o,h,x,T){if(super(),this.id=o,this.dispatcher=x,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(h,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,x=this.map._worldview;this._tileJSONRequest=xt(this._options,this.map._requestManager,h,x,((T,C)=>{this._tileJSONRequest=null,this._loaded=!0,T?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),x&&x.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${x}`),this.fire(new a.ErrorEvent(T))):C&&(a.extend(this,C),C.bounds&&(this.tileBounds=new Zt(C.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(T)}))}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(o,h){const x=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(x,a.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",T,C.bind(this));else if(o.actor=this._tileWorkers[x]=this._tileWorkers[x]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",T,C.bind(this),void 0,!0);else{const R=a.loadVectorTile.call({deduped:this._deduped},T,((D,B)=>{D||!B?C.call(this,D):(T.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},o.actor&&o.actor.send("loadTile",T,C.bind(this),void 0,!0))}),!0);o.request={cancel:R}}function C(R,D){return delete o.request,o.aborted?h(null):R&&R.status!==404?h(R):(D&&D.resourceTiming&&(o.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&o.setExpiryData(D),o.loadVectorData(D,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class bt extends a.Evented{constructor(o,h,x,T){super(),this.id=o,this.dispatcher=x,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},h),a.extend(this,a.pick(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=xt(this._options,this.map._requestManager,null,null,((h,x)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new a.ErrorEvent(h)):x&&(a.extend(this,x),x.bounds&&(this.tileBounds=new Zt(x.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(x.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(h)}))}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const x=a.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),x,this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(T,a.ResourceType.Tile),((C,R,D,B)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):C?(o.state="errored",h(C)):R?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:D,expires:B}),o.setTexture(R,this.map.painter),o.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null))))}static loadTileData(o,h,x){o.setTexture(h,x)}static unloadTileData(o,h){o.texture&&h.saveTileTexture(o.texture)}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function wn(g,o,h,x,T,C,R,D){const B=[g,h,T,o,x,C,1,1,1],G=[R,D,1],$=a.adjoint([],B),[J,oe,ce]=a.transformMat3(G,G,a.transpose($,$));return a.multiply$1(B,[J,0,0,0,oe,0,0,0,ce],B)}class An extends a.Evented{constructor(o,h,x,T){super(),this.id=o,this.dispatcher=x,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=h,this._dirty=!1}load(o,h){this._loaded=h||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),((x,T)=>{if(this._imageRequest=null,this._loaded=!0,x)this.fire(new a.ErrorEvent(x));else if(T){const{HTMLImageElement:C}=a.window;this.image=T instanceof C?a.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const h=o.map(a.MercatorCoordinate.fromLngLat);return this.tileID=(function(x){let T=1/0,C=1/0,R=-1/0,D=-1/0;for(const J of x)T=Math.min(T,J.x),C=Math.min(C,J.y),R=Math.max(R,J.x),D=Math.max(D,J.y);const B=Math.max(R-T,D-C),G=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),$=Math.pow(2,G);return new a.CanonicalTileID(G,Math.floor((T+R)/2*$),Math.floor((C+D)/2*$))})(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const B in this.tiles){const G=this.tiles[B];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const h=a.tileTransform(this.tileID,this.map.transform.projection),[x,T,C,R]=this.coordinates.map((B=>{const G=h.projection.project(B[0],B[1]);return a.getTilePoint(h,G)._round()}));this.perspectiveTransform=(function(B,G,$,J,oe,ce,he,de,me,Q){const le=wn(0,0,B,0,0,G,B,G),_e=wn($,J,oe,ce,he,de,me,Q);return a.multiply$1(_e,a.adjoint(le,le),_e),[_e[6]/_e[8]*B/a.EXTENT,_e[7]/_e[8]*G/a.EXTENT]})(this.width,this.height,x.x,x.y,T.x,T.y,R.x,R.y,C.x,C.y);const D=this._boundsArray=new a.StructArrayLayout4i8;D.emplaceBack(x.x,x.y,0,0),D.emplaceBack(T.x,T.y,a.EXTENT,0),D.emplaceBack(R.x,R.y,0,a.EXTENT),D.emplaceBack(C.x,C.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(D,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,h=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const kn={vector:Rt,raster:bt,"raster-dem":class extends bt{constructor(g,o,h,x){super(g,o,h,x),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function x(T,C){T&&(g.state="errored",o(T)),C&&(g.dem=C,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=a.getImage(this.map._requestManager.transformRequest(h,a.ResourceType.Tile),(function(T,C,R,D){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(T)g.state="errored",o(T);else if(C){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:R,expires:D});const B=a.window.ImageBitmap&&C instanceof a.window.ImageBitmap&&(xo==null&&(xo=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),xo),G=1-(C.width-a.prevPowerOfTwo(C.width))/2;G<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const $=B?C:a.exported.getImageData(C,G),J={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:G};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",J,x.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,h=Math.pow(2,o.z),x=(o.x-1+h)%h,T=o.x===0?g.wrap-1:g.wrap,C=(o.x+1+h)%h,R=o.x+1===h?g.wrap+1:g.wrap,D={};return D[new a.OverscaledTileID(g.overscaledZ,T,o.z,x,o.y).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,R,o.z,C,o.y).key]={backfilled:!1},o.y>0&&(D[new a.OverscaledTileID(g.overscaledZ,T,o.z,x,o.y-1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,R,o.z,C,o.y-1).key]={backfilled:!1}),o.y+1<h&&(D[new a.OverscaledTileID(g.overscaledZ,T,o.z,x,o.y+1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,R,o.z,C,o.y+1).key]={backfilled:!1}),D}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends a.Evented{constructor(g,o,h,x){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(x),this._data=o.data,this._options=a.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const T=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*T,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*T,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*T,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},o),this}getClusterLeaves(g,o,h,x){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:o,offset:h},x),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=a.extend({},this.workerOptions),o=this._data;typeof o=="string"?(g.request=this.map._requestManager.transformRequest(a.exported.resolveURL(o),a.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,((h,x)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new a.ErrorEvent(h));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&x&&x.resourceTiming&&x.resourceTiming[this.id]&&(T.resourceTiming=x.resourceTiming[this.id]),this.fire(new a.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(g,o){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(h,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((x,T)=>(delete g.request,g.unloadVectorData(),g.aborted?o(null):x?o(x):(g.loadVectorData(T,this.map.painter,h==="reloadTile"),o(null)))),void 0,h==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends An{constructor(g,o,h,x){super(g,o,h,x),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.ResourceType.Source).url);a.getVideo(this.urls,((o,h)=>{this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(g,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:An,canvas:class extends An{constructor(g,o,h,x){super(g,o,h,x),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((C=>typeof C!="number"))))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends a.Evented{constructor(g,o,h,x){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(x),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Zt(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:h,z:x}=g.canonical;return this._implementation.hasTile({x:o,y:h,z:x})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:h,y:x,z:T}=g.tileID.canonical,C=new a.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y:x,z:T},{signal:C.signal})).then((function(R){return delete g.request,g.aborted?(g.state="unloaded",o(null)):R===void 0?(g.state="errored",o(null)):R===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):(function(D){return D instanceof a.window.ImageData||D instanceof a.window.HTMLCanvasElement||D instanceof a.window.ImageBitmap||D instanceof a.window.HTMLImageElement})(R)?(this.loadTileData(g,R),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((R=>{R.code!==20&&(g.state="errored",o(R))})),g.request.cancel=()=>C.abort()}loadTileData(g,o){bt.loadTileData(g,o,this._map.painter)}unloadTileData(g){bt.unloadTileData(g,this._map.painter)}unloadTile(g,o){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:h,y:x,z:T}=g.tileID.canonical;this._implementation.unloadTile({x:h,y:x,z:T})}o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Pn=function(g,o,h,x){const T=new kn[o.type](g,o,h,x);if(T.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${T.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],T),T};function $n(g,o){const h=a.identity([]);return a.scale(h,h,[.5*g.width,.5*-g.height,1]),a.translate(h,h,[1,-1,0]),a.multiply(h,h,g.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(h)}function jr(g,o,h,x,T,C,R,D=!1){const B=g.tilesIn(x,R,D);B.sort(Xi);const G=[];for(const J of B)G.push({wrappedTileID:J.tile.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(o,h,g._state,J,T,C,$n(g.transform,J.tile.tileID),D)});const $=(function(J){const oe={},ce={};for(const he of J){const de=he.queryResults,me=he.wrappedTileID,Q=ce[me]=ce[me]||{};for(const le in de){const _e=de[le],ve=Q[le]=Q[le]||{},Ne=oe[le]=oe[le]||[];for(const De of _e)ve[De.featureIndex]||(ve[De.featureIndex]=!0,Ne.push(De))}}return oe})(G);for(const J in $)$[J].forEach((oe=>{const ce=oe.feature,he=ce.layer;he&&he.type!=="background"&&he.type!=="sky"&&(ce.source=he.source,he["source-layer"]&&(ce.sourceLayer=he["source-layer"]),ce.state=ce.id!==void 0?g.getFeatureState(he["source-layer"],ce.id):{})}));return $}function ri(g,o){const h=g.getRenderableIds().map((C=>g.getTileByID(C))),x=[],T={};for(let C=0;C<h.length;C++){const R=h[C],D=R.tileID.canonical.key;T[D]||(T[D]=!0,R.querySourceFeatures(x,o))}return x}function Xi(g,o){const h=g.tileID,x=o.tileID;return h.overscaledZ-x.overscaledZ||h.canonical.y-x.canonical.y||h.wrap-x.wrap||h.canonical.x-x.canonical.x}function Nr(){return Va.workerClass!=null?new Va.workerClass:new a.window.Worker(Va.workerUrl)}const wo="mapboxgl_preloaded_worker_pool";class wi{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<wi.workerCount;)this.workers.push(new Nr);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[wo]}numActive(){return Object.keys(this.active).length}}let as;function ll(){return as||(as=new wi),as}function dp(g,o){const h={};for(const x in g)x!=="ref"&&(h[x]=g[x]);return a.refProperties.forEach((x=>{x in o&&(h[x]=o[x])})),h}function Ah(g){g=g.slice();const o=Object.create(null);for(let h=0;h<g.length;h++)o[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=dp(g[h],o[g[h].ref]));return g}wi.workerCount=2;const ir={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function Ih(g,o,h){h.push({command:ir.addSource,args:[g,o[g]]})}function Qc(g,o,h){o.push({command:ir.removeSource,args:[g]}),h[g]=!0}function Ur(g,o,h,x){Qc(g,h,x),Ih(g,o,h)}function nd(g,o,h){let x;for(x in g[h])if(g[h].hasOwnProperty(x)&&x!=="data"&&!k(g[h][x],o[h][x]))return!1;for(x in o[h])if(o[h].hasOwnProperty(x)&&x!=="data"&&!k(g[h][x],o[h][x]))return!1;return!0}function Qs(g,o,h,x,T,C){let R;for(R in o=o||{},g=g||{})g.hasOwnProperty(R)&&(k(g[R],o[R])||h.push({command:C,args:[x,R,o[R],T]}));for(R in o)o.hasOwnProperty(R)&&!g.hasOwnProperty(R)&&(k(g[R],o[R])||h.push({command:C,args:[x,R,o[R],T]}))}function Fo(g){return g.id}function Zl(g,o){return g[o.id]=o,g}class Mh{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let x=1;x<this.points.length;x++)this._distances[x]=this._distances[x-1]+this.points[x].dist(this.points[x-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.clamp(o,0,1);let h=1,x=this._distances[h];const T=o*this.paddedLength+this.padding;for(;x<T&&h<this._distances.length;)x=this._distances[++h];const C=h-1,R=this._distances[C],D=x-R,B=D>0?(T-R)/D:0;return this.points[C].mult(1-B).add(this.points[h].mult(B))}}class ka{constructor(o,h,x){const T=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(o/x),this.yCellCount=Math.ceil(h/x);for(let R=0;R<this.xCellCount*this.yCellCount;R++)T.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,x,T,C){this._forEachCell(h,x,T,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(x),this.bboxes.push(T),this.bboxes.push(C)}insertCircle(o,h,x,T){this._forEachCell(h-T,x-T,h+T,x+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(x),this.circles.push(T)}_insertBoxCell(o,h,x,T,C,R){this.boxCells[C].push(R)}_insertCircleCell(o,h,x,T,C,R){this.circleCells[C].push(R)}_query(o,h,x,T,C,R){if(x<0||o>this.width||T<0||h>this.height)return!C&&[];const D=[];if(o<=0&&h<=0&&this.width<=x&&this.height<=T){if(C)return!0;for(let B=0;B<this.boxKeys.length;B++)D.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const G=this.circles[3*B],$=this.circles[3*B+1],J=this.circles[3*B+2];D.push({key:this.circleKeys[B],x1:G-J,y1:$-J,x2:G+J,y2:$+J})}return R?D.filter(R):D}return this._forEachCell(o,h,x,T,this._queryCell,D,{hitTest:C,seenUids:{box:{},circle:{}}},R),C?D.length>0:D}_queryCircle(o,h,x,T,C){const R=o-x,D=o+x,B=h-x,G=h+x;if(D<0||R>this.width||G<0||B>this.height)return!T&&[];const $=[];return this._forEachCell(R,B,D,G,this._queryCellCircle,$,{hitTest:T,circle:{x:o,y:h,radius:x},seenUids:{box:{},circle:{}}},C),T?$.length>0:$}query(o,h,x,T,C){return this._query(o,h,x,T,!1,C)}hitTest(o,h,x,T,C){return this._query(o,h,x,T,!0,C)}hitTestCircle(o,h,x,T){return this._queryCircle(o,h,x,!0,T)}_queryCell(o,h,x,T,C,R,D,B){const G=D.seenUids,$=this.boxCells[C];if($!==null){const oe=this.bboxes;for(const ce of $)if(!G.box[ce]){G.box[ce]=!0;const he=4*ce;if(o<=oe[he+2]&&h<=oe[he+3]&&x>=oe[he+0]&&T>=oe[he+1]&&(!B||B(this.boxKeys[ce]))){if(D.hitTest)return R.push(!0),!0;R.push({key:this.boxKeys[ce],x1:oe[he],y1:oe[he+1],x2:oe[he+2],y2:oe[he+3]})}}}const J=this.circleCells[C];if(J!==null){const oe=this.circles;for(const ce of J)if(!G.circle[ce]){G.circle[ce]=!0;const he=3*ce;if(this._circleAndRectCollide(oe[he],oe[he+1],oe[he+2],o,h,x,T)&&(!B||B(this.circleKeys[ce]))){if(D.hitTest)return R.push(!0),!0;{const de=oe[he],me=oe[he+1],Q=oe[he+2];R.push({key:this.circleKeys[ce],x1:de-Q,y1:me-Q,x2:de+Q,y2:me+Q})}}}}}_queryCellCircle(o,h,x,T,C,R,D,B){const G=D.circle,$=D.seenUids,J=this.boxCells[C];if(J!==null){const ce=this.bboxes;for(const he of J)if(!$.box[he]){$.box[he]=!0;const de=4*he;if(this._circleAndRectCollide(G.x,G.y,G.radius,ce[de+0],ce[de+1],ce[de+2],ce[de+3])&&(!B||B(this.boxKeys[he])))return R.push(!0),!0}}const oe=this.circleCells[C];if(oe!==null){const ce=this.circles;for(const he of oe)if(!$.circle[he]){$.circle[he]=!0;const de=3*he;if(this._circlesCollide(ce[de],ce[de+1],ce[de+2],G.x,G.y,G.radius)&&(!B||B(this.circleKeys[he])))return R.push(!0),!0}}}_forEachCell(o,h,x,T,C,R,D,B){const G=this._convertToXCellCoord(o),$=this._convertToYCellCoord(h),J=this._convertToXCellCoord(x),oe=this._convertToYCellCoord(T);for(let ce=G;ce<=J;ce++)for(let he=$;he<=oe;he++)if(C.call(this,o,h,x,T,this.xCellCount*he+ce,R,D,B))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,x,T,C,R){const D=T-o,B=C-h,G=x+R;return G*G>D*D+B*B}_circleAndRectCollide(o,h,x,T,C,R,D){const B=(R-T)/2,G=Math.abs(o-(T+B));if(G>B+x)return!1;const $=(D-C)/2,J=Math.abs(h-(C+$));if(J>$+x)return!1;if(G<=B||J<=$)return!0;const oe=G-B,ce=J-$;return oe*oe+ce*ce<=x*x}}const eo={unknown:0,flipRequired:1,flipNotRequired:2},vs=Math.tan(85*Math.PI/180);function pt(g,o,h,x,T,C,R){const D=a.create();if(h)if(C.name==="globe"){const B=a.calculateGlobeLabelMatrix(T,o);a.multiply(D,D,B)}else{const B=Ie([],R);D[0]=B[0],D[1]=B[1],D[4]=B[2],D[5]=B[3],x||a.rotateZ(D,D,T.angle)}else a.multiply(D,T.labelPlaneMatrix,g);return D}function bi(g,o,h,x,T,C,R){const D=pt(g,o,h,x,T,C,R);return C.name==="globe"&&h||(D[2]=D[6]=D[10]=D[14]=0),D}function ii(g,o,h,x,T,C,R){if(h){if(C.name==="globe"){const D=pt(g,o,h,x,T,C,R);return a.invert(D,D),a.multiply(D,g,D),D}{const D=a.clone(g),B=a.identity([]);return B[0]=R[0],B[1]=R[1],B[4]=R[2],B[5]=R[3],a.multiply(D,D,B),x||a.rotateZ(D,D,-T.angle),D}}return T.glCoordMatrix}function Pi(g,o,h,x){const T=[g,o,h,1];h?a.transformMat4$1(T,T,x):Nn(T,T,x);const C=T[3];return T[0]/=C,T[1]/=C,T[2]/=C,T}function hp(g,o){return Math.min(.5+g/o*.5,1.5)}function Ls(g,o){const h=g[0]/g[3],x=g[1]/g[3];return h>=-o[0]&&h<=o[0]&&x>=-o[1]&&x<=o[1]}function Xl(g,o,h,x,T,C,R,D,B,G){const $=h.transform,J=x?g.textSizeData:g.iconSizeData,oe=a.evaluateSizeForZoom(J,h.transform.zoom),ce=$.projection.name==="globe",he=[256/h.width*2+1,256/h.height*2+1],de=x?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;de.clear();let me=null;ce&&(me=x?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const Q=g.lineVertexArray,le=x?g.text.placedSymbolArray:g.icon.placedSymbolArray,_e=h.transform.width/h.transform.height;let ve,Ne=!1;for(let De=0;De<le.length;De++){const Re=le.get(De),{numGlyphs:Ge,writingMode:$e}=Re;if($e!==a.WritingMode.vertical||Ne||ve===a.WritingMode.horizontal||(Ne=!0),ve=$e,(Re.hidden||$e===a.WritingMode.vertical)&&!Ne){js(Ge,de);continue}Ne=!1;const Ye=new a.Point(Re.tileAnchorX,Re.tileAnchorY);let{x:At,y:qe,z:ct}=$.projection.projectTilePoint(Ye.x,Ye.y,G.canonical);if(B){const[_n,Wt,dn]=B(Ye);At+=_n,qe+=Wt,ct+=dn}const Je=[At,qe,ct,1];if(a.transformMat4$1(Je,Je,o),!Ls(Je,he)){js(Ge,de);continue}const Ct=hp(h.transform.cameraToCenterDistance,Je[3]),Ke=a.evaluateSizeForFeature(J,oe,Re),dt=R?Ke/Ct:Ke*Ct,St=Pi(At,qe,ct,T);if(St[3]<=0){js(Ge,de);continue}let wt={};const It=R?null:B,en=Ut(Re,dt,!1,D,o,T,C,g.glyphOffsetArray,Q,de,me,St,Ye,wt,_e,It,$.projection,G,R);Ne=en.useVertical,It&&en.needsFlipping&&(wt={}),(en.notEnoughRoom||Ne||en.needsFlipping&&Ut(Re,dt,!0,D,o,T,C,g.glyphOffsetArray,Q,de,me,St,Ye,wt,_e,It,$.projection,G,R).notEnoughRoom)&&js(Ge,de)}x?(g.text.dynamicLayoutVertexBuffer.updateData(de),me&&g.text.globeExtVertexBuffer.updateData(me)):(g.icon.dynamicLayoutVertexBuffer.updateData(de),me&&g.icon.globeExtVertexBuffer.updateData(me))}function Kl(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de){const{lineStartIndex:me,glyphStartIndex:Q,segment:le}=D,_e=Q+D.numGlyphs,ve=me+D.lineLength,Ne=o.getoffsetX(Q),De=o.getoffsetX(_e-1),Re=ws(g*Ne,h,x,T,C,R,le,me,ve,B,G,$,J,oe,!0,ce,he,de);if(!Re)return null;const Ge=ws(g*De,h,x,T,C,R,le,me,ve,B,G,$,J,oe,!0,ce,he,de);return Ge?{first:Re,last:Ge}:null}function sa(g,o,h,x){return g===a.WritingMode.horizontal&&Math.abs(x)>Math.abs(h)?{useVertical:!0}:g===a.WritingMode.vertical?x>0?{needsFlipping:!0}:null:o!==eo.unknown&&(function(T,C){return T===0||Math.abs(C/T)>vs})(h,x)?o===eo.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function Ut(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de,me,Q,le){const _e=o/24,ve=g.lineOffsetX*_e,Ne=g.lineOffsetY*_e,{lineStartIndex:De,glyphStartIndex:Re,numGlyphs:Ge,segment:$e,writingMode:Ye,flipState:At}=g,qe=De+g.lineLength,ct=Je=>{if($){const[St,wt,It]=Je.up,en=G.length;a.updateGlobeVertexNormal($,en+0,St,wt,It),a.updateGlobeVertexNormal($,en+1,St,wt,It),a.updateGlobeVertexNormal($,en+2,St,wt,It),a.updateGlobeVertexNormal($,en+3,St,wt,It)}const[Ct,Ke,dt]=Je.point;a.addDynamicAttributes(G,Ct,Ke,dt,Je.angle)};if(Ge>1){const Je=Kl(_e,D,ve,Ne,h,J,oe,g,B,C,ce,de,!1,me,Q,le);if(!Je)return{notEnoughRoom:!0};if(x&&!h){let[Ct,Ke,dt]=Je.first.point,[St,wt,It]=Je.last.point;[Ct,Ke]=Pi(Ct,Ke,dt,R),[St,wt]=Pi(St,wt,It,R);const en=sa(Ye,At,(St-Ct)*he,wt-Ke);if(g.flipState=en&&en.needsFlipping?eo.flipRequired:eo.flipNotRequired,en)return en}ct(Je.first);for(let Ct=Re+1;Ct<Re+Ge-1;Ct++){const Ke=ws(_e*D.getoffsetX(Ct),ve,Ne,h,J,oe,$e,De,qe,B,C,ce,de,!1,!1,me,Q,le);if(!Ke)return G.length-=4*(Ct-Re),{notEnoughRoom:!0};ct(Ke)}ct(Je.last)}else{if(x&&!h){const Ct=Pi(oe.x,oe.y,0,T),Ke=De+$e+1,dt=new a.Point(B.getx(Ke),B.gety(Ke)),St=Pi(dt.x,dt.y,0,T),wt=St[3]>0?St:Bn(oe,dt,Ct,1,T,void 0,me,Q.canonical),It=sa(Ye,At,(wt[0]-Ct[0])*he,wt[1]-Ct[1]);if(g.flipState=It&&It.needsFlipping?eo.flipRequired:eo.flipNotRequired,It)return It}const Je=ws(_e*D.getoffsetX(Re),ve,Ne,h,J,oe,$e,De,qe,B,C,ce,de,!1,!1,me,Q,le);if(!Je)return{notEnoughRoom:!0};ct(Je)}return{}}function Hn(g,o,h,x,T){const{x:C,y:R,z:D}=x.projectTilePoint(g.x,g.y,o);if(!T)return Pi(C,R,D,h);const[B,G,$]=T(g);return Pi(C+B,R+G,D+$,h)}function Bn(g,o,h,x,T,C,R,D){const B=Hn(g.sub(o)._unit()._add(g),D,T,R,C);return a.sub(B,h,B),a.normalize(B,B),a.scaleAndAdd(B,h,B,x)}function ws(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de,me,Q){const le=x?g-o:g+o;let _e=le>0?1:-1,ve=0;x&&(_e*=-1,ve=Math.PI),_e<0&&(ve+=Math.PI);let Ne=D+R+(_e>0?0:1)|0,De=T,Re=T,Ge=0,$e=0;const Ye=Math.abs(le),At=[],qe=[];let ct=C,Je=ct;const Ct=()=>Bn(Je,ct,Re,Ye-Ge+1,$,oe,de,me.canonical);for(;Ge+$e<=Ye;){if(Ne+=_e,Ne<D||Ne>=B)return null;if(Re=De,Je=ct,At.push(Re),ce&&qe.push(Je),ct=new a.Point(G.getx(Ne),G.gety(Ne)),De=J[Ne],!De){const dn=Hn(ct,me.canonical,$,de,oe);De=dn[3]>0?J[Ne]=dn:Ct()}Ge+=$e,$e=a.distance(Re,De)}he&&oe&&(J[Ne]&&(De=Ct(),$e=a.distance(Re,De)),J[Ne]=De);const Ke=(Ye-Ge)/$e,dt=ct.sub(Je)._mult(Ke)._add(Je),St=a.sub([],De,Re),wt=a.scaleAndAdd([],Re,St,Ke);let It=[0,0,1],en=St[0],_n=St[1];if(Q&&(It=de.upVector(me.canonical,dt.x,dt.y),It[0]!==0||It[1]!==0||It[2]!==1)){const dn=[It[2],0,-It[0]],jn=a.cross([],It,dn);a.normalize(dn,dn),a.normalize(jn,jn),en=a.dot(St,dn),_n=a.dot(St,jn)}if(h){const dn=a.cross([],It,St);a.normalize(dn,dn),a.scaleAndAdd(wt,wt,dn,h*_e)}const Wt=ve+Math.atan2(_n,en);return At.push(wt),ce&&qe.push(dt),{point:wt,angle:Wt,path:At,tilePath:qe,up:It}}function js(g,o){const h=o.length,x=h+4*g;o.resize(x),o.float32.fill(-1/0,4*h,4*x)}function Nn(g,o,h){const x=o[0],T=o[1];return g[0]=h[0]*x+h[4]*T+h[12],g[1]=h[1]*x+h[5]*T+h[13],g[3]=h[3]*x+h[7]*T+h[15],g}const Os=100;class cl{constructor(o,h,x=new ka(o.width+200,o.height+200,25),T=new ka(o.width+200,o.height+200,25)){this.transform=o,this.grid=x,this.ignoredGrid=T,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Os,this.screenBottomBoundary=o.height+Os,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,x,T,C,R,D,B){let G=x.projectedAnchorX,$=x.projectedAnchorY,J=x.projectedAnchorZ;const oe=x.elevation,ce=x.tileID,he=o.getProjection();if(oe&&ce){const[De,Re,Ge]=he.upVector(ce.canonical,x.tileAnchorX,x.tileAnchorY),$e=he.upVectorScale(ce.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=De*oe*$e,$+=Re*oe*$e,J+=Ge*oe*$e}const de=this.projectAndGetPerspectiveRatio(D,G,$,J,x.tileID,he.name==="globe"||!!oe||this.transform.pitch>0,he),me=R*de.perspectiveRatio,Q=(x.x1*h+T.x-x.padding)*me+de.point.x,le=(x.y1*h+T.y-x.padding)*me+de.point.y,_e=(x.x2*h+T.x+x.padding)*me+de.point.x,ve=(x.y2*h+T.y+x.padding)*me+de.point.y,Ne=de.perspectiveRatio<=.55||de.occluded;return!this.isInsideGrid(Q,le,_e,ve)||!C&&this.grid.hitTest(Q,le,_e,ve,B)||Ne?{box:[],offscreen:!1,occluded:de.occluded}:{box:[Q,le,_e,ve],offscreen:this.isOffscreen(Q,le,_e,ve),occluded:!1}}placeCollisionCircles(o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de){const me=[],Q=this.transform.elevation,le=o.getProjection(),_e=Q?Q.getAtTileOffsetFunc(de,this.transform.center.lat,this.transform.worldSize,le):null,ve=new a.Point(x.tileAnchorX,x.tileAnchorY);let{x:Ne,y:De,z:Re}=le.projectTilePoint(ve.x,ve.y,de.canonical);if(_e){const[dt,St,wt]=_e(ve);Ne+=dt,De+=St,Re+=wt}const Ge=le.name==="globe",$e=this.projectAndGetPerspectiveRatio(D,Ne,De,Re,de,Ge||!!Q||this.transform.pitch>0,le),{perspectiveRatio:Ye}=$e,At=(J?R/Ye:R*Ye)/a.ONE_EM,qe=Pi(Ne,De,Re,B),ct=$e.signedDistanceFromCamera>0?Kl(At,C,x.lineOffsetX*At,x.lineOffsetY*At,!1,qe,ve,x,T,B,{},Q&&!J?_e:null,J&&!!Q,le,de,J):null;let Je=!1,Ct=!1,Ke=!0;if(ct&&!$e.occluded){const dt=.5*ce*Ye+he,St=new a.Point(-100,-100),wt=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),It=new Mh,{first:en,last:_n}=ct,Wt=en.path.length;let dn=[];for(let tn=Wt-1;tn>=1;tn--)dn.push(en.path[tn]);for(let tn=1;tn<_n.path.length;tn++)dn.push(_n.path[tn]);const jn=2.5*dt;G&&(dn=dn.map((([tn,Gn,ar],lr)=>(_e&&!Ge&&(ar=_e(lr<Wt-1?en.tilePath[Wt-1-lr]:_n.tilePath[lr-Wt+2])[2]),Pi(tn,Gn,ar,G)))),dn.some((tn=>tn[3]<=0))&&(dn=[]));let Fn=[];if(dn.length>0){let tn=1/0,Gn=-1/0,ar=1/0,lr=-1/0;for(const rr of dn)tn=Math.min(tn,rr[0]),ar=Math.min(ar,rr[1]),Gn=Math.max(Gn,rr[0]),lr=Math.max(lr,rr[1]);Gn>=St.x&&tn<=wt.x&&lr>=St.y&&ar<=wt.y&&(Fn=[dn.map((rr=>new a.Point(rr[0],rr[1])))],(tn<St.x||Gn>wt.x||ar<St.y||lr>wt.y)&&(Fn=a.clipLine(Fn,St.x,St.y,wt.x,wt.y)))}for(const tn of Fn){It.reset(tn,.25*dt);let Gn=0;Gn=It.length<=.5*dt?1:Math.ceil(It.paddedLength/jn)+1;for(let ar=0;ar<Gn;ar++){const lr=ar/Math.max(Gn-1,1),rr=It.lerp(lr),Li=rr.x+Os,$r=rr.y+Os;me.push(Li,$r,dt,0);const $s=Li-dt,co=$r-dt,In=Li+dt,pr=$r+dt;if(Ke=Ke&&this.isOffscreen($s,co,In,pr),Ct=Ct||this.isInsideGrid($s,co,In,pr),!h&&this.grid.hitTestCircle(Li,$r,dt,oe)&&(Je=!0,!$))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!$&&Je||!Ct?[]:me,offscreen:Ke,collisionDetected:Je,occluded:$e.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let x=1/0,T=1/0,C=-1/0,R=-1/0;for(const $ of o){const J=new a.Point($.x+Os,$.y+Os);x=Math.min(x,J.x),T=Math.min(T,J.y),C=Math.max(C,J.x),R=Math.max(R,J.y),h.push(J)}const D=this.grid.query(x,T,C,R).concat(this.ignoredGrid.query(x,T,C,R)),B={},G={};for(const $ of D){const J=$.key;if(B[J.bucketInstanceId]===void 0&&(B[J.bucketInstanceId]={}),B[J.bucketInstanceId][J.featureIndex])continue;const oe=[new a.Point($.x1,$.y1),new a.Point($.x2,$.y1),new a.Point($.x2,$.y2),new a.Point($.x1,$.y2)];a.polygonIntersectsPolygon(h,oe)&&(B[J.bucketInstanceId][J.featureIndex]=!0,G[J.bucketInstanceId]===void 0&&(G[J.bucketInstanceId]=[]),G[J.bucketInstanceId].push(J.featureIndex))}return G}insertCollisionBox(o,h,x,T,C){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:x,featureIndex:T,collisionGroupID:C},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,x,T,C){const R=h?this.ignoredGrid:this.grid,D={bucketInstanceId:x,featureIndex:T,collisionGroupID:C};for(let B=0;B<o.length;B+=4)R.insertCircle(D,o[B],o[B+1],o[B+2])}projectAndGetPerspectiveRatio(o,h,x,T,C,R,D){const B=[h,x,T,1];let G=!1;T||this.transform.pitch>0?(a.transformMat4$1(B,B,o),this.fogState&&C&&D.name!=="globe"&&(G=(function(oe,ce,he,de,me,Q){const le=Q.calculateFogTileMatrix(me),_e=[ce,he,de];return a.transformMat4(_e,_e,le),nt(oe,_e,Q.pitch,Q._fov)})(this.fogState,h,x,T,C.toUnwrapped(),this.transform)>.9)):Nn(B,B,o);const $=B[3];return{point:new a.Point((B[0]/$+1)/2*this.transform.width+Os,(-B[1]/$+1)/2*this.transform.height+Os),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/$*.5,1.5),signedDistanceFromCamera:$,occluded:R&&B[2]>$||G}}isOffscreen(o,h,x,T){return x<Os||o>=this.screenRightBoundary||T<Os||h>this.screenBottomBoundary}isInsideGrid(o,h,x,T){return x>=0&&o<this.gridRightBoundary&&T>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=a.identity([]);return a.translate(o,o,[-100,-100,0]),o}}function sr(g,o,h){const x=o.createTileMatrix(g,g.worldSize,h.toUnwrapped());return a.multiply(new Float32Array(16),g.projMatrix,x)}function zs(g,o,h){if(o.projection.name===h.projection.name)return g.projMatrix;const x=h.clone();return x.setProjection(o.projection),sr(x,o.getProjection(),g)}function Cr(g,o,h){return o.name===h.projection.name?g.projMatrix:sr(h,o,g)}class rd{constructor(o,h,x,T){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):T&&x?1:0,this.placed=x}isHidden(){return this.opacity===0&&!this.placed}}class Vo{constructor(o,h,x,T,C,R=!1){this.text=new rd(o?o.text:null,h,x,C),this.icon=new rd(o?o.icon:null,h,T,C),this.clipped=R}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yl{constructor(o,h,x,T=!1){this.text=o,this.icon=h,this.skipFade=x,this.clipped=T}}class Jl{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class eu{constructor(o,h,x,T,C){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=x,this.bucketIndex=T,this.tileID=C}}class tu{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:x=>x.collisionGroupID===h}}return this.collisionGroups[o]}}function to(g,o,h,x,T){const{horizontalAlign:C,verticalAlign:R}=a.getAnchorAlignment(g),D=-(C-.5)*o,B=-(R-.5)*h,G=a.evaluateVariableOffset(g,x);return new a.Point(D+G[0]*T,B+G[1]*T)}function no(g,o,h,x,T){const C=new a.Point(g,o);return h&&C._rotate(x?T:-T),C}class bo{constructor(o,h,x,T,C){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new cl(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new tu(x),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,x,T){const C=x.getBucket(h),R=x.latestFeatureIndex;if(!C||!R||h.id!==C.layerIds[0])return;const D=C.layers[0].layout,B=x.collisionBoxArray,G=Math.pow(2,this.transform.zoom-x.tileID.overscaledZ),$=x.tileSize/a.EXTENT,J=x.tileID.toUnwrapped();this.transform.setProjection(C.projection);const oe=(ce=x.tileID,he=C.getProjection(),de=this.transform,he.name===this.projection?de.calculateProjMatrix(ce.toUnwrapped()):sr(de,he,ce));var ce,he,de;const me=D.get("text-pitch-alignment")==="map",Q=D.get("text-rotation-alignment")==="map";h.compileFilter();const le=h.dynamicFilter(),_e=h.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(x),Ne=bi(oe,x.tileID.canonical,me,Q,this.transform,C.getProjection(),ve);let De=null;if(me){const $e=ii(oe,x.tileID.canonical,me,Q,this.transform,C.getProjection(),ve);De=a.multiply([],this.transform.labelPlaneMatrix,$e)}let Re=null;le&&x.latestFeatureIndex&&(Re={unwrappedTileID:J,dynamicFilter:le,dynamicFilterNeedsFeature:_e,featureIndex:x.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new eu(C.bucketInstanceId,R,C.sourceLayerIndex,C.index,x.tileID);const Ge={bucket:C,layout:D,posMatrix:oe,textLabelPlaneMatrix:Ne,labelToScreenMatrix:De,clippingData:Re,scale:G,textPixelRatio:$,holdingForFade:x.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(T)for(const $e of C.sortKeyRanges){const{sortKey:Ye,symbolInstanceStart:At,symbolInstanceEnd:qe}=$e;o.push({sortKey:Ye,symbolInstanceStart:At,symbolInstanceEnd:qe,parameters:Ge})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:Ge})}attemptAnchorPlacement(o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de,me,Q,le){const{textOffset0:_e,textOffset1:ve,crossTileID:Ne}=oe,De=[_e,ve],Re=to(o,x,T,De,C),Ge=this.collisionIndex.placeCollisionBox(he,C,h,no(Re.x,Re.y,R,D,this.transform.angle),J,B,G,$.predicate);if(me){const $e=he.getSymbolInstanceIconSize(le,this.transform.zoom,oe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(he,$e,me,no(Re.x,Re.y,R,D,this.transform.angle),J,B,G,$.predicate).box.length===0)return}if(Ge.box.length>0){let $e;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ne]&&this.prevPlacement.placements[Ne]&&this.prevPlacement.placements[Ne].text&&($e=this.prevPlacement.variableOffsets[Ne].anchor),this.variableOffsets[Ne]={textOffset:De,width:x,height:T,anchor:o,textScale:C,prevAnchor:$e},this.markUsedJustification(he,o,oe,de),he.allowVerticalPlacement&&(this.markUsedOrientation(he,de,oe),this.placedOrientations[Ne]=de),{shift:Re,placedGlyphBoxes:Ge}}}placeLayerBucketPart(o,h,x,T){const{bucket:C,layout:R,posMatrix:D,textLabelPlaneMatrix:B,labelToScreenMatrix:G,clippingData:$,textPixelRatio:J,holdingForFade:oe,collisionBoxArray:ce,partiallyEvaluatedTextSize:he,partiallyEvaluatedIconSize:de,collisionGroup:me}=o.parameters,Q=R.get("text-optional"),le=R.get("icon-optional"),_e=R.get("text-allow-overlap"),ve=R.get("icon-allow-overlap"),Ne=R.get("text-rotation-alignment")==="map",De=R.get("text-pitch-alignment")==="map",Re=R.get("icon-text-fit")!=="none",Ge=R.get("symbol-z-order")==="viewport-y";this.transform.setProjection(C.projection);let $e=_e&&(ve||!C.hasIconData()||le),Ye=ve&&(_e||!C.hasTextData()||Q);!C.collisionArrays&&ce&&C.deserializeCollisionBoxes(ce),x&&T&&C.updateCollisionDebugBuffers(this.transform.zoom,ce);const At=(qe,ct,Je)=>{const{crossTileID:Ct,numVerticalGlyphVertices:Ke}=qe;if($){const In={zoom:this.transform.zoom,pitch:this.transform.pitch};let pr=null;if($.dynamicFilterNeedsFeature){const er=this.retainedQueryData[C.bucketInstanceId];pr=$.featureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:er.bucketIndex,sourceLayerIndex:er.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(In,pr,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new a.Point(qe.tileAnchorX,qe.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[Ct]=new Yl(!1,!1,!1,!0),void h.add(Ct)}if(h.has(Ct))return;if(oe)return void(this.placements[Ct]=new Yl(!1,!1,!1));let dt=!1,St=!1,wt=!0,It=!1,en=!1,_n=null,Wt={box:null,offscreen:null,occluded:null},dn={box:null},jn=null,Fn=null,tn=null,Gn=0,ar=0,lr=0;Je.textFeatureIndex?Gn=Je.textFeatureIndex:qe.useRuntimeCollisionCircles&&(Gn=qe.featureIndex),Je.verticalTextFeatureIndex&&(ar=Je.verticalTextFeatureIndex);const rr=In=>{In.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const pr=this.transform.elevation;(pr||In.elevation)&&(In.elevation=pr?pr.getAtTileOffset(In.tileID,In.tileAnchorX,In.tileAnchorY):0)},Li=Je.textBox;if(Li){rr(Li);const In=er=>{let Gr=a.WritingMode.horizontal;if(C.allowVerticalPlacement&&!er&&this.prevPlacement){const ji=this.prevPlacement.placedOrientations[Ct];ji&&(this.placedOrientations[Ct]=ji,Gr=ji,this.markUsedOrientation(C,Gr,qe))}return Gr},pr=(er,Gr)=>{if(C.allowVerticalPlacement&&Ke>0&&Je.verticalTextBox){for(const ji of C.writingModes)if(ji===a.WritingMode.vertical?(Wt=Gr(),dn=Wt):Wt=er(),Wt&&Wt.box&&Wt.box.length)break}else Wt=er()};if(R.get("text-variable-anchor")){let er=R.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Ct]){const xr=this.prevPlacement.variableOffsets[Ct];er.indexOf(xr.anchor)>0&&(er=er.filter((hi=>hi!==xr.anchor)),er.unshift(xr.anchor))}const Gr=(xr,hi,Dr)=>{const Or=C.getSymbolInstanceTextSize(he,qe,this.transform.zoom,ct),Kr=(xr.x2-xr.x1)*Or+2*xr.padding,uo=(xr.y2-xr.y1)*Or+2*xr.padding,ho=Re&&!ve?hi:null;ho&&rr(ho);let Ao={box:[],offscreen:!1,occluded:!1};const Ed=_e?2*er.length:er.length;for(let fi=0;fi<Ed;++fi){const Eu=this.attemptAnchorPlacement(er[fi%er.length],xr,Kr,uo,Or,Ne,De,J,D,me,fi>=er.length,qe,ct,C,Dr,ho,he,de);if(Eu&&(Ao=Eu.placedGlyphBoxes,Ao&&Ao.box&&Ao.box.length)){dt=!0,_n=Eu.shift;break}}return Ao};pr((()=>Gr(Li,Je.iconBox,a.WritingMode.horizontal)),(()=>{const xr=Je.verticalTextBox;return xr&&rr(xr),C.allowVerticalPlacement&&!(Wt&&Wt.box&&Wt.box.length)&&Ke>0&&xr?Gr(xr,Je.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),Wt&&(dt=Wt.box,wt=Wt.offscreen,It=Wt.occluded);const ji=In(!(!Wt||!Wt.box));if(!dt&&this.prevPlacement){const xr=this.prevPlacement.variableOffsets[Ct];xr&&(this.variableOffsets[Ct]=xr,this.markUsedJustification(C,xr.anchor,qe,ji))}}else{const er=(Gr,ji)=>{const xr=C.getSymbolInstanceTextSize(he,qe,this.transform.zoom,ct),hi=this.collisionIndex.placeCollisionBox(C,xr,Gr,new a.Point(0,0),_e,J,D,me.predicate);return hi&&hi.box&&hi.box.length&&(this.markUsedOrientation(C,ji,qe),this.placedOrientations[Ct]=ji),hi};pr((()=>er(Li,a.WritingMode.horizontal)),(()=>{const Gr=Je.verticalTextBox;return C.allowVerticalPlacement&&Ke>0&&Gr?(rr(Gr),er(Gr,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),In(!!(Wt&&Wt.box&&Wt.box.length))}}if(jn=Wt,dt=jn&&jn.box&&jn.box.length>0,wt=jn&&jn.offscreen,It=jn&&jn.occluded,qe.useRuntimeCollisionCircles){const In=C.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex>=0?qe.centerJustifiedTextSymbolIndex:qe.verticalPlacedTextSymbolIndex),pr=a.evaluateSizeForFeature(C.textSizeData,he,In),er=R.get("text-padding");Fn=this.collisionIndex.placeCollisionCircles(C,_e,In,C.lineVertexArray,C.glyphOffsetArray,pr,D,B,G,x,De,me.predicate,qe.collisionCircleDiameter*pr/a.ONE_EM,er,this.retainedQueryData[C.bucketInstanceId].tileID),dt=_e||Fn.circles.length>0&&!Fn.collisionDetected,wt=wt&&Fn.offscreen,It=Fn.occluded}if(Je.iconFeatureIndex&&(lr=Je.iconFeatureIndex),Je.iconBox){const In=pr=>{rr(pr);const er=Re&&_n?no(_n.x,_n.y,Ne,De,this.transform.angle):new a.Point(0,0),Gr=C.getSymbolInstanceIconSize(de,this.transform.zoom,qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Gr,pr,er,ve,J,D,me.predicate)};dn&&dn.box&&dn.box.length&&Je.verticalIconBox?(tn=In(Je.verticalIconBox),St=tn.box.length>0):(tn=In(Je.iconBox),St=tn.box.length>0),wt=wt&&tn.offscreen,en=tn.occluded}const $r=Q||qe.numHorizontalGlyphVertices===0&&Ke===0,$s=le||qe.numIconVertices===0;if($r||$s?$s?$r||(St=St&&dt):dt=St&&dt:St=dt=St&&dt,dt&&jn&&jn.box&&this.collisionIndex.insertCollisionBox(jn.box,R.get("text-ignore-placement"),C.bucketInstanceId,dn&&dn.box&&ar?ar:Gn,me.ID),St&&tn&&this.collisionIndex.insertCollisionBox(tn.box,R.get("icon-ignore-placement"),C.bucketInstanceId,lr,me.ID),Fn&&(dt&&this.collisionIndex.insertCollisionCircles(Fn.circles,R.get("text-ignore-placement"),C.bucketInstanceId,Gn,me.ID),x)){const In=C.bucketInstanceId;let pr=this.collisionCircleArrays[In];pr===void 0&&(pr=this.collisionCircleArrays[In]=new Jl);for(let er=0;er<Fn.circles.length;er+=4)pr.circles.push(Fn.circles[er+0]),pr.circles.push(Fn.circles[er+1]),pr.circles.push(Fn.circles[er+2]),pr.circles.push(Fn.collisionDetected?1:0)}const co=C.projection.name!=="globe";$e=$e&&(co||!It),Ye=Ye&&(co||!en),this.placements[Ct]=new Yl(dt||$e,St||Ye,wt||C.justReloaded),h.add(Ct)};if(Ge){const qe=C.getSortedSymbolIndexes(this.transform.angle);for(let ct=qe.length-1;ct>=0;--ct){const Je=qe[ct];At(C.symbolInstances.get(Je),Je,C.collisionArrays[Je])}}else for(let qe=o.symbolInstanceStart;qe<o.symbolInstanceEnd;qe++)At(C.symbolInstances.get(qe),qe,C.collisionArrays[qe]);if(x&&C.bucketInstanceId in this.collisionCircleArrays){const qe=this.collisionCircleArrays[C.bucketInstanceId];a.invert(qe.invProjMatrix,D),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,h,x,T){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:R,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:B,crossTileID:G}=x,$=a.getAnchorJustification(h),J=T===a.WritingMode.vertical?B:$==="left"?C:$==="center"?R:$==="right"?D:-1;C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=J>=0&&C!==J?0:G),R>=0&&(o.text.placedSymbolArray.get(R).crossTileID=J>=0&&R!==J?0:G),D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=J>=0&&D!==J?0:G),B>=0&&(o.text.placedSymbolArray.get(B).crossTileID=J>=0&&B!==J?0:G)}markUsedOrientation(o,h,x){const T=h===a.WritingMode.horizontal||h===a.WritingMode.horizontalOnly?h:0,C=h===a.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:R,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:G}=x,$=o.text.placedSymbolArray;R>=0&&($.get(R).placedOrientation=T),D>=0&&($.get(D).placedOrientation=T),B>=0&&($.get(B).placedOrientation=T),G>=0&&($.get(G).placedOrientation=C)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let x=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const T=h?h.symbolFadeChange(o):1,C=h?h.opacities:{},R=h?h.variableOffsets:{},D=h?h.placedOrientations:{};for(const B in this.placements){const G=this.placements[B],$=C[B];$?(this.opacities[B]=new Vo($,T,G.text,G.icon,null,G.clipped),x=x||G.text!==$.text.placed||G.icon!==$.icon.placed):(this.opacities[B]=new Vo(null,T,G.text,G.icon,G.skipFade,G.clipped),x=x||G.text||G.icon)}for(const B in C){const G=C[B];if(!this.opacities[B]){const $=new Vo(G,T,!1,!1);$.isHidden()||(this.opacities[B]=$,x=x||G.text.placed||G.icon.placed)}}for(const B in R)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=R[B]);for(const B in D)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=D[B]);x?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const x=new Set;for(const T of h){const C=T.getBucket(o);C&&T.latestFeatureIndex&&o.id===C.layerIds[0]&&this.updateBucketOpacities(C,x,T.collisionBoxArray)}}updateBucketOpacities(o,h,x){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const T=o.layers[0].layout,C=!!o.layers[0].dynamicFilter(),R=new Vo(null,0,!1,!1,!0),D=T.get("text-allow-overlap"),B=T.get("icon-allow-overlap"),G=T.get("text-variable-anchor"),$=T.get("text-rotation-alignment")==="map",J=T.get("text-pitch-alignment")==="map",oe=T.get("icon-text-fit")!=="none",ce=new Vo(null,0,D&&(B||!o.hasIconData()||T.get("icon-optional")),B&&(D||!o.hasTextData()||T.get("text-optional")),!0);!o.collisionArrays&&x&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(x);const he=(me,Q,le)=>{for(let _e=0;_e<Q/4;_e++)me.opacityVertexArray.emplaceBack(le)};let de=0;for(let me=0;me<o.symbolInstances.length;me++){const Q=o.symbolInstances.get(me),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:_e,crossTileID:ve,numIconVertices:Ne}=Q,De=h.has(ve);let Re=this.opacities[ve];De?Re=R:Re||(Re=ce,this.opacities[ve]=Re),h.add(ve);const Ge=le>0||_e>0,$e=Ne>0,Ye=this.placedOrientations[ve],At=Ye===a.WritingMode.vertical,qe=Ye===a.WritingMode.horizontal||Ye===a.WritingMode.horizontalOnly;if(!Ge&&!$e||Re.isHidden()||de++,Ge){const ct=Aa(Re.text);he(o.text,le,At?Br:ct),he(o.text,_e,qe?Br:ct);const Je=Re.text.isHidden(),{leftJustifiedTextSymbolIndex:Ct,centerJustifiedTextSymbolIndex:Ke,rightJustifiedTextSymbolIndex:dt,verticalPlacedTextSymbolIndex:St}=Q,wt=o.text.placedSymbolArray,It=Je||At?1:0;Ct>=0&&(wt.get(Ct).hidden=It),Ke>=0&&(wt.get(Ke).hidden=It),dt>=0&&(wt.get(dt).hidden=It),St>=0&&(wt.get(St).hidden=Je||qe?1:0);const en=this.variableOffsets[ve];en&&this.markUsedJustification(o,en.anchor,Q,Ye);const _n=this.placedOrientations[ve];_n&&(this.markUsedJustification(o,"left",Q,_n),this.markUsedOrientation(o,_n,Q))}if($e){const ct=Aa(Re.icon),{placedIconSymbolIndex:Je,verticalPlacedIconSymbolIndex:Ct}=Q,Ke=o.icon.placedSymbolArray,dt=Re.icon.isHidden()?1:0;Je>=0&&(he(o.icon,Ne,At?Br:ct),Ke.get(Je).hidden=dt),Ct>=0&&(he(o.icon,Q.numVerticalIconVertices,qe?Br:ct),Ke.get(Ct).hidden=dt)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const ct=o.collisionArrays[me];if(ct){let Je=new a.Point(0,0),Ct=!0;if(ct.textBox||ct.verticalTextBox){if(G){const dt=this.variableOffsets[ve];dt?(Je=to(dt.anchor,dt.width,dt.height,dt.textOffset,dt.textScale),$&&Je._rotate(J?this.transform.angle:-this.transform.angle)):Ct=!1}C&&(Ct=!Re.clipped),ct.textBox&&Uo(o.textCollisionBox.collisionVertexArray,Re.text.placed,!Ct||At,Je.x,Je.y),ct.verticalTextBox&&Uo(o.textCollisionBox.collisionVertexArray,Re.text.placed,!Ct||qe,Je.x,Je.y)}const Ke=Ct&&!!(!qe&&ct.verticalIconBox);ct.iconBox&&Uo(o.iconCollisionBox.collisionVertexArray,Re.icon.placed,Ke,oe?Je.x:0,oe?Je.y:0),ct.verticalIconBox&&Uo(o.iconCollisionBox.collisionVertexArray,Re.icon.placed,!Ke,oe?Je.x:0,oe?Je.y:0)}}}if(o.fullyClipped=de===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=me.invProjMatrix,o.placementViewportMatrix=me.viewportMatrix,o.collisionCircleArray=me.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const x=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*x>o}setStale(){this.stale=!0}}function Uo(g,o,h,x,T){g.emplaceBack(o?1:0,h?1:0,x||0,T||0),g.emplaceBack(o?1:0,h?1:0,x||0,T||0),g.emplaceBack(o?1:0,h?1:0,x||0,T||0),g.emplaceBack(o?1:0,h?1:0,x||0,T||0)}const Ni=Math.pow(2,25),_r=Math.pow(2,24),Ph=Math.pow(2,17),id=Math.pow(2,16),Ri=Math.pow(2,9),ro=Math.pow(2,8),Nh=Math.pow(2,1);function Aa(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,h=Math.floor(127*g.opacity);return h*Ni+o*_r+h*Ph+o*id+h*Ri+o*ro+h*Nh+o}const Br=0;class nu{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,x,T,C){const R=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(R,T,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,R.sort(((D,B)=>D.sortKey-B.sortKey)));this._currentPartIndex<R.length;){const D=R[this._currentPartIndex];if(h.placeLayerBucketPart(D,this._seenCrossTileIDs,x,D.symbolInstanceStart===0),this._currentPartIndex++,C())return!0}return!1}}class ul{constructor(o,h,x,T,C,R,D,B){this.placement=new bo(o,C,R,D,B),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=x,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(o,h,x){const T=a.exported.now(),C=()=>{const R=a.exported.now()-T;return!this._forceFullPlacement&&R>2};for(;this._currentPlacementIndex>=0;){const R=h[o[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(R.type==="symbol"&&(!R.minzoom||R.minzoom<=D)&&(!R.maxzoom||R.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new nu(R)),this._inProgressLayer.continuePlacement(x[R.source],this.placement,this._showCollisionBoxes,R,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const To=512/a.EXTENT/2;class Xr{constructor(o,h,x){this.tileID=o,this.bucketInstanceId=x,this.index=new a.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const T=o.canonical.x*a.EXTENT,C=o.canonical.y*a.EXTENT;for(let R=0;R<h.length;R++){const{key:D,crossTileID:B,tileAnchorX:G,tileAnchorY:$}=h.get(R),J=Math.floor((T+G)*To),oe=Math.floor((C+$)*To);this.index.add(J,oe),this.keys.push(D),this.crossTileIDs.push(B)}this.index.finish()}findMatches(o,h,x){const T=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),C=To/Math.pow(2,h.canonical.z-this.tileID.canonical.z),R=h.canonical.x*a.EXTENT,D=h.canonical.y*a.EXTENT;for(let B=0;B<o.length;B++){const G=o.get(B);if(G.crossTileID)continue;const{key:$,tileAnchorX:J,tileAnchorY:oe}=G,ce=Math.floor((R+J)*C),he=Math.floor((D+oe)*C),de=this.index.range(ce-T,he-T,ce+T,he+T);for(const me of de){const Q=this.crossTileIDs[me];if(this.keys[me]===$&&!x.has(Q)){x.add(Q),G.crossTileID=Q;break}}}}}class Ql{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Rh{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const x in this.indexes){const T=this.indexes[x],C={};for(const R in T){const D=T[R];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+h),C[D.tileID.key]=D}this.indexes[x]=C}this.lng=o}addBucket(o,h,x){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let C=0;C<h.symbolInstances.length;C++)h.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const T=this.usedCrossTileIDs[o.overscaledZ];for(const C in this.indexes){const R=this.indexes[C];if(Number(C)>o.overscaledZ)for(const D in R){const B=R[D];B.tileID.isChildOf(o)&&B.findMatches(h.symbolInstances,o,T)}else{const D=R[o.scaledTo(Number(C)).key];D&&D.findMatches(h.symbolInstances,o,T)}}for(let C=0;C<h.symbolInstances.length;C++){const R=h.symbolInstances.get(C);R.crossTileID||(R.crossTileID=x.generate(),T.add(R.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Xr(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const x of h.crossTileIDs)this.usedCrossTileIDs[o].delete(x)}removeStaleBuckets(o){let h=!1;for(const x in this.indexes){const T=this.indexes[x];for(const C in T)o[T[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(x,T[C]),delete T[C],h=!0)}return h}}class oa{constructor(){this.layerIndexes={},this.crossTileIDs=new Ql,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,x,T){let C=this.layerIndexes[o.id];C===void 0&&(C=this.layerIndexes[o.id]=new Rh);let R=!1;const D={};T.name!=="globe"&&C.handleWrapJump(x);for(const B of h){const G=B.getBucket(o);G&&o.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(B.tileID,G,this.crossTileIDs)&&(R=!0),D[G.bucketInstanceId]=!0)}return C.removeStaleBuckets(D)&&(R=!0),R}pruneUnusedLayers(o){const h={};o.forEach((x=>{h[x]=!0}));for(const x in this.layerIndexes)h[x]||delete this.layerIndexes[x]}}const $o=(g,o)=>a.emitValidationErrors(g,o&&o.filter((h=>h.identifier!=="source.canvas"))),dl=a.pick(ir,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Dh=a.pick(ir,["setCenter","setZoom","setBearing","setPitch"]),sd={version:8,layers:[],sources:{}},Bs={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class io extends a.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new fe(ll(),this),this.imageManager=new ut,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(o._requestManager,h.localFontFamily?a.LocalGlyphMode.all:h.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new oa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const x=this;this._rtlTextPluginCallback=io.registerForPluginStateChange((T=>{x.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},((C,R)=>{if(a.triggerPluginCompletionEvent(C),R&&R.every((D=>D)))for(const D in x._sourceCaches){const B=x._sourceCaches[D],G=B.getSource().type;G!=="vector"&&G!=="geojson"||B.reload()}}))})),this.on("data",(T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const C=this.getSource(T.sourceId);if(C&&C.vectorLayerIds)for(const R in this._layers){const D=this._layers[R];D.source===C.id&&this._validateLayer(D)}}))}loadURL(o,h={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const x=typeof h.validate=="boolean"?h.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken);const T=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(T,((C,R)=>{this._request=null,C?this.fire(new a.ErrorEvent(C)):R&&this._load(R,x)}))}loadJSON(o,h={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame((()=>{this._request=null,this._load(o,h.validate!==!1)}))}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(sd,!1)}_updateLayerCount(o,h){const x=h?1:-1;o.is3D()&&(this._num3DLayers+=x),o.type==="circle"&&(this._numCircleLayers+=x),o.type==="symbol"&&(this._numSymbolLayers+=x)}_load(o,h){if(h&&$o(this,a.validateStyle(o)))return;this._loaded=!0,this.stylesheet=a.clone$1(o),this._updateMapProjection();for(const T in o.sources)this.addSource(T,o.sources[T],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const x=Ah(this.stylesheet.layers);this._order=x.map((T=>T.id)),this._layers={},this._serializedLayers={};for(const T of x){const C=a.createStyleLayer(T);C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ft(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=(function(h,x,T){let C,R,D;const B=a.exported.devicePixelRatio>1?"@2x":"";let G=a.getJSON(x.transformRequest(x.normalizeSpriteURL(h,B,".json"),a.ResourceType.SpriteJSON),((oe,ce)=>{G=null,D||(D=oe,C=ce,J())})),$=a.getImage(x.transformRequest(x.normalizeSpriteURL(h,B,".png"),a.ResourceType.SpriteImage),((oe,ce)=>{$=null,D||(D=oe,R=ce,J())}));function J(){if(D)T(D);else if(C&&R){const oe=a.exported.getImageData(R),ce={};for(const he in C){const{width:de,height:me,x:Q,y:le,sdf:_e,pixelRatio:ve,stretchX:Ne,stretchY:De,content:Re}=C[he],Ge=new a.RGBAImage({width:de,height:me});a.RGBAImage.copy(oe,Ge,{x:Q,y:le},{x:0,y:0},{width:de,height:me}),ce[he]={data:Ge,pixelRatio:ve,sdf:_e,stretchX:Ne,stretchY:De,content:Re}}T(null,ce)}}return{cancel(){G&&(G.cancel(),G=null),$&&($.cancel(),$=null)}}})(o,this.map._requestManager,((h,x)=>{if(this._spriteRequest=null,h)this.fire(new a.ErrorEvent(h));else if(x)for(const T in x)this.imageManager.addImage(T,x[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))}))}_validateLayer(o){const h=this.getSource(o.source);if(!h)return;const x=o.sourceLayer;x&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(x)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${x}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const h=[];for(const x of o){const T=this._layers[x];T.type!=="custom"&&h.push(T.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():Bs[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(T.length||C.length)&&this._updateWorkerLayers(T,C);for(const R in this._updatedSources){const D=this._updatedSources[R];D==="reload"?this._reloadSource(R):D==="clear"&&this._clearSource(R)}this._updateTilesForChangedImages();for(const R in this._updatedPaintProps)this._layers[R].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const x={};for(const T in this._sourceCaches){const C=this._sourceCaches[T];x[T]=C.used,C.used=!1}for(const T of this._order){const C=this._layers[T];if(C.recalculate(o,this._availableImages),!C.isHidden(o.zoom)){const D=this._getLayerSourceCache(C);D&&(D.used=!0)}const R=this.map.painter;if(R){const D=C.getProgramIds();if(!D)continue;const B=C.getProgramConfiguration(o.zoom);for(const G of D)R.useProgram(G,B)}}for(const T in x){const C=this._sourceCaches[T];x[T]!==C.used&&C.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),$o(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ah(o.layers);const h=(function(T,C){if(!T)return[{command:ir.setStyle,args:[C]}];let R=[];try{if(!k(T.version,C.version))return[{command:ir.setStyle,args:[C]}];k(T.center,C.center)||R.push({command:ir.setCenter,args:[C.center]}),k(T.zoom,C.zoom)||R.push({command:ir.setZoom,args:[C.zoom]}),k(T.bearing,C.bearing)||R.push({command:ir.setBearing,args:[C.bearing]}),k(T.pitch,C.pitch)||R.push({command:ir.setPitch,args:[C.pitch]}),k(T.sprite,C.sprite)||R.push({command:ir.setSprite,args:[C.sprite]}),k(T.glyphs,C.glyphs)||R.push({command:ir.setGlyphs,args:[C.glyphs]}),k(T.transition,C.transition)||R.push({command:ir.setTransition,args:[C.transition]}),k(T.light,C.light)||R.push({command:ir.setLight,args:[C.light]}),k(T.fog,C.fog)||R.push({command:ir.setFog,args:[C.fog]}),k(T.projection,C.projection)||R.push({command:ir.setProjection,args:[C.projection]});const D={},B=[];(function(J,oe,ce,he){let de;for(de in oe=oe||{},J=J||{})J.hasOwnProperty(de)&&(oe.hasOwnProperty(de)||Qc(de,ce,he));for(de in oe){if(!oe.hasOwnProperty(de))continue;const me=oe[de];J.hasOwnProperty(de)?k(J[de],me)||(J[de].type==="geojson"&&me.type==="geojson"&&nd(J,oe,de)?ce.push({command:ir.setGeoJSONSourceData,args:[de,me.data]}):Ur(de,oe,ce,he)):Ih(de,oe,ce)}})(T.sources,C.sources,B,D);const G=[];T.layers&&T.layers.forEach((J=>{J.source&&D[J.source]?R.push({command:ir.removeLayer,args:[J.id]}):G.push(J)}));let $=T.terrain;$&&D[$.source]&&(R.push({command:ir.setTerrain,args:[void 0]}),$=void 0),R=R.concat(B),k($,C.terrain)||R.push({command:ir.setTerrain,args:[C.terrain]}),(function(J,oe,ce){oe=oe||[];const he=(J=J||[]).map(Fo),de=oe.map(Fo),me=J.reduce(Zl,{}),Q=oe.reduce(Zl,{}),le=he.slice(),_e=Object.create(null);let ve,Ne,De,Re,Ge,$e,Ye;for(ve=0,Ne=0;ve<he.length;ve++)De=he[ve],Q.hasOwnProperty(De)?Ne++:(ce.push({command:ir.removeLayer,args:[De]}),le.splice(le.indexOf(De,Ne),1));for(ve=0,Ne=0;ve<de.length;ve++)De=de[de.length-1-ve],le[le.length-1-ve]!==De&&(me.hasOwnProperty(De)?(ce.push({command:ir.removeLayer,args:[De]}),le.splice(le.lastIndexOf(De,le.length-Ne),1)):Ne++,$e=le[le.length-ve],ce.push({command:ir.addLayer,args:[Q[De],$e]}),le.splice(le.length-ve,0,De),_e[De]=!0);for(ve=0;ve<de.length;ve++)if(De=de[ve],Re=me[De],Ge=Q[De],!_e[De]&&!k(Re,Ge))if(k(Re.source,Ge.source)&&k(Re["source-layer"],Ge["source-layer"])&&k(Re.type,Ge.type)){for(Ye in Qs(Re.layout,Ge.layout,ce,De,null,ir.setLayoutProperty),Qs(Re.paint,Ge.paint,ce,De,null,ir.setPaintProperty),k(Re.filter,Ge.filter)||ce.push({command:ir.setFilter,args:[De,Ge.filter]}),k(Re.minzoom,Ge.minzoom)&&k(Re.maxzoom,Ge.maxzoom)||ce.push({command:ir.setLayerZoomRange,args:[De,Ge.minzoom,Ge.maxzoom]}),Re)Re.hasOwnProperty(Ye)&&Ye!=="layout"&&Ye!=="paint"&&Ye!=="filter"&&Ye!=="metadata"&&Ye!=="minzoom"&&Ye!=="maxzoom"&&(Ye.indexOf("paint.")===0?Qs(Re[Ye],Ge[Ye],ce,De,Ye.slice(6),ir.setPaintProperty):k(Re[Ye],Ge[Ye])||ce.push({command:ir.setLayerProperty,args:[De,Ye,Ge[Ye]]}));for(Ye in Ge)Ge.hasOwnProperty(Ye)&&!Re.hasOwnProperty(Ye)&&Ye!=="layout"&&Ye!=="paint"&&Ye!=="filter"&&Ye!=="metadata"&&Ye!=="minzoom"&&Ye!=="maxzoom"&&(Ye.indexOf("paint.")===0?Qs(Re[Ye],Ge[Ye],ce,De,Ye.slice(6),ir.setPaintProperty):k(Re[Ye],Ge[Ye])||ce.push({command:ir.setLayerProperty,args:[De,Ye,Ge[Ye]]}))}else ce.push({command:ir.removeLayer,args:[De]}),$e=le[le.lastIndexOf(De)+1],ce.push({command:ir.addLayer,args:[Ge,$e]})})(G,C.layers,R)}catch(D){console.warn("Unable to compute style diff:",D),R=[{command:ir.setStyle,args:[C]}]}return R})(this.serialize(),o).filter((T=>!(T.command in Dh)));if(h.length===0)return!1;const x=h.filter((T=>!(T.command in dl)));if(x.length>0)throw new Error(`Unimplemented: ${x.map((T=>T.command)).join(", ")}.`);return h.forEach((T=>{T.command!=="setTransition"&&T.command!=="setProjection"&&this[T.command].apply(this,T.args)})),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,h){return this.getImage(o)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,h),this._afterImageUpdated(o),this)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,h,x={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(a.validateSource,`sources.${o}`,h,null,x))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const T=Pn(o,h,this.dispatcher,this);T.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:T.serialize(),sourceId:o})));const C=R=>{const D=(R?"symbol:":"other:")+o,B=this._sourceCaches[D]=new a.SourceCache(D,T,R);(R?this._symbolSourceCaches:this._otherSourceCaches)[o]=B,B.style=this,B.onAdd(this.map)};C(!1),h.type!=="vector"&&h.type!=="geojson"||C(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const h=this.getSource(o);if(!h)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const x=this._getSourceCaches(o);for(const T of x)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getSource(o).setData(h),this._changed=!0}getSource(o){const h=this._getSourceCache(o);return h&&h.getSource()}_getSources(){const o=[];for(const h in this._otherSourceCaches){const x=this._getSourceCache(h);x&&o.push(x.getSource())}return o}addLayer(o,h,x={}){this._checkLoaded();const T=o.id;if(this.getLayer(T))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let C;if(o.type==="custom"){if($o(this,a.validateCustomStyleLayer(o)))return;C=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(T,o.source),o=a.clone$1(o),o=a.extend(o,{source:T})),this._validate(a.validateLayer,`layers.${T}`,o,{arrayIndex:-1},x))return;C=a.createStyleLayer(o),this._validateLayer(C),C.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const R=h?this._order.indexOf(h):this._order.length;if(h&&R===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(R,0,T),this._layerOrderChanged=!0,this._layers[T]=C;const D=this._getLayerSourceCache(C);if(this._removedLayers[T]&&C.source&&D&&C.type!=="custom"){const B=this._removedLayers[T];delete this._removedLayers[T],B.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",D.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const x=this._order.indexOf(o);this._order.splice(x,1);const T=h?this._order.indexOf(h):this._order.length;h&&T===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(T,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const x=this._order.indexOf(o);this._order.splice(x,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,x){this._checkLoaded();const T=this.getLayer(o);T?T.minzoom===h&&T.maxzoom===x||(h!=null&&(T.minzoom=h),x!=null&&(T.maxzoom=x),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,h,x={}){this._checkLoaded();const T=this.getLayer(o);if(T){if(!k(T.filter,h))return h==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(a.validateFilter,`layers.${T.id}.filter`,h,{layerType:T.type},x)||(T.filter=a.clone$1(h),this._updateLayer(T)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const h=this.getLayer(o);return h&&a.clone$1(h.filter)}setLayoutProperty(o,h,x,T={}){this._checkLoaded();const C=this.getLayer(o);C?k(C.getLayoutProperty(h),x)||(C.setLayoutProperty(h,x,T),this._updateLayer(C)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,h){const x=this.getLayer(o);if(x)return x.getLayoutProperty(h);this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,h,x,T={}){this._checkLoaded();const C=this.getLayer(o);C?k(C.getPaintProperty(h),x)||(C.setPaintProperty(h,x,T)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,h){const x=this.getLayer(o);return x&&x.getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const x=o.source,T=o.sourceLayer,C=this.getSource(x);if(!C)return void this.fire(new a.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const R=C.type;if(R==="geojson"&&T)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(R==="vector"&&!T)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const D=this._getSourceCaches(x);for(const B of D)B.setFeatureState(T,o.id,h)}removeFeatureState(o,h){this._checkLoaded();const x=o.source,T=this.getSource(x);if(!T)return void this.fire(new a.ErrorEvent(new Error(`The source '${x}' does not exist in the map's style.`)));const C=T.type,R=C==="vector"?o.sourceLayer:void 0;if(C==="vector"&&!R)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const D=this._getSourceCaches(x);for(const B of D)B.removeFeatureState(R,o.id,h)}getFeatureState(o){this._checkLoaded();const h=o.source,x=o.sourceLayer,T=this.getSource(h);if(T){if(T.type!=="vector"||x)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(x,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const h in this._sourceCaches){const x=this._sourceCaches[h].getSource();o[x.id]||(o[x.id]=x.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},(h=>h!==void 0))}_updateLayer(o){this._updatedLayers[o.id]=!0;const h=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",h.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const h=R=>this._layers[R].type==="fill-extrusion",x={},T=[];for(let R=this._order.length-1;R>=0;R--){const D=this._order[R];if(h(D)){x[D]=R;for(const B of o){const G=B[D];if(G)for(const $ of G)T.push($)}}}T.sort(((R,D)=>D.intersectionZ-R.intersectionZ));const C=[];for(let R=this._order.length-1;R>=0;R--){const D=this._order[R];if(h(D))for(let B=T.length-1;B>=0;B--){const G=T[B].feature;if(x[G.layer.id]<R)break;C.push(G),T.pop()}else for(const B of o){const G=B[D];if(G)for(const $ of G)C.push($.feature)}}return C}queryRenderedFeatures(o,h,x){h&&h.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const T={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of h.layers){const G=this._layers[B];if(!G)return this.fire(new a.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];T[G.source]=!0}}const C=[];h.availableImages=this._availableImages;const R=h&&h.layers?h.layers.some((B=>{const G=this.getLayer(B);return G&&G.is3D()})):this.has3DLayers(),D=lt.createFromScreenPoints(o,x);for(const B in this._sourceCaches){const G=this._sourceCaches[B].getSource().id;h.layers&&!T[G]||C.push(jr(this._sourceCaches[B],this._layers,this._serializedLayers,D,h,x,R,!!this.map._showQueryGeometry))}return this.placement&&C.push((function(B,G,$,J,oe,ce,he){const de={},me=ce.queryRenderedSymbols(J),Q=[];for(const le of Object.keys(me).map(Number))Q.push(he[le]);Q.sort(Xi);for(const le of Q){const _e=le.featureIndex.lookupSymbolFeatures(me[le.bucketInstanceId],G,le.bucketIndex,le.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,B);for(const ve in _e){const Ne=de[ve]=de[ve]||[],De=_e[ve];De.sort(((Re,Ge)=>{const $e=le.featureSortOrder;if($e){const Ye=$e.indexOf(Re.featureIndex);return $e.indexOf(Ge.featureIndex)-Ye}return Ge.featureIndex-Re.featureIndex}));for(const Re of De)Ne.push(Re)}}for(const le in de)de[le].forEach((_e=>{const ve=_e.feature,Ne=$(B[le]);if(!Ne)return;const De=Ne.getFeatureState(ve.layer["source-layer"],ve.id);ve.source=ve.layer.source,ve.layer["source-layer"]&&(ve.sourceLayer=ve.layer["source-layer"]),ve.state=De}));return de})(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),D.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(o,h){h&&h.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const x=this._getSourceCaches(o);let T=[];for(const C of x)T=T.concat(ri(C,h));return T}addSourceType(o,h,x){return io.getSourceType(o)?x(new Error(`A source type called "${o}" already exists.`)):(io.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},x):x(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const x=this.light.getLight();let T=!1;for(const R in o)if(!k(o[R],x[R])){T=!0;break}if(!T)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,h),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,h=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let x=o;if(h===1){if(typeof x.source=="object"){const T="terrain-dem-src";this.addSource(T,x.source),x=a.clone$1(x),x=a.extend(x,{source:T})}if(this._validate(a.validateTerrain,"terrain",x))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!x)return;this._createTerrain(x,h)}else{const T=this.terrain,C=T.get();for(const R of Object.keys(a.spec.terrain))!x.hasOwnProperty(R)&&a.spec.terrain[R].default&&(x[R]=a.spec.terrain[R].default);for(const R in x)if(!k(x[R],C[R])){T.set(x),this.stylesheet.terrain=x;const D=this._setTransitionParameters({duration:0});T.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const h=this.fog=new We(o,this.map.transform);this.stylesheet.fog=o;const x=this._setTransitionParameters({duration:0});h.updateTransitions(x)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const o of this.map._markers)o._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,x=h.get();Object.keys(o).length===0&&h.set(o);for(const T in o)if(!k(o[T],x[T])){h.set(o),this.stylesheet.fog=o;const C=this._setTransitionParameters({duration:0});h.updateTransitions(C);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:a.exported.now(),transition:a.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter((x=>this.isLayerDraped(this._layers[x]))),h=this._order.filter((x=>!this.isLayerDraped(this._layers[x])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){const x=this.terrain=new st(o,h);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});x.updateTransitions(T)}_force3DLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,x,T,C={}){return(!C||C.validate!==!1)&&$o(this,o.call(a.validateStyle,a.extend({key:h,style:this.serialize(),value:x,styleSpec:a.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const h=this._getSourceCaches(o);for(const x of h)x.clearTiles()}_reloadSource(o){const h=this._getSourceCaches(o);for(const x of h)x.resume(),x.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const h in this._sourceCaches)this._sourceCaches[h].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,x,T,C=!1){let R=!1,D=!1;const B={};for(const G of this._order){const $=this._layers[G];if($.type!=="symbol")continue;if(!B[$.source]){const oe=this._getLayerSourceCache($);if(!oe)continue;B[$.source]=oe.getRenderableIds(!0).map((ce=>oe.getTileByID(ce))).sort(((ce,he)=>he.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(he.tileID)?-1:1)))}const J=this.crossTileSymbolIndex.addLayer($,B[$.source],o.center.lng,o.projection);R=R||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||x===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),o.zoom))&&(this.pauseablePlacement=new ul(o,this._order,C,h,x,T,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),D=!0),R&&this.pauseablePlacement.placement.setStale()),D||R)for(const G of this._order){const $=this._layers[G];$.type==="symbol"&&this.placement.updateLayerOpacities($,B[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,x){this.imageManager.getImages(h.icons,x),this._updateTilesForChangedImages();const T=C=>{C&&C.setDependencies(h.tileID.key,h.type,h.icons)};T(this._otherSourceCaches[h.source]),T(this._symbolSourceCaches[h.source])}getGlyphs(o,h,x){this.glyphManager.getGlyphs(h.stacks,x)}getResource(o,h,x){return a.makeRequest(h,x)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){const h=this._getSourceCaches(o);return h.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):h.every((x=>x.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}io.getSourceType=function(g){return kn[g]},io.setSourceType=function(g,o){kn[g]=o},io.registerForPluginStateChange=a.registerForPluginStateChange;var ec=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ia="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",so=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ma=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,Go=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Ki={},So={};const hl=[];Ho(ec,hl),Ho(so,hl),Ho(Ma,hl),Ho(Go,hl),Ki=Jn("",so),So=Jn(Go,Ma);const tc=Jn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),od=ec,ru=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var iu={background:Jn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Jn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Jn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Jn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Jn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Jn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Jn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Jn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Jn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Jn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Jn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Jn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Jn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Jn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Jn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Jn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Jn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Jn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Jn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Jn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Jn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Jn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Jn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Jn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Jn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Jn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxGradient:Jn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxCapture:Jn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Jn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Jn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Ho(g,o){const h=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let x of h)if(x=x.trim(),x[0]==="#"&&x.includes("if")&&!x.includes("endif")){x=x.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=x.split(" ");for(const C of T)o.includes(C)||o.push(C)}}function Jn(g,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,x=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},C=[...hl];return Ho(g,C),Ho(o,C),{fragmentSource:g=g.replace(h,((R,D,B,G,$)=>(T[$]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${B} ${G} ${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = u_${$};
#endif
`))),vertexSource:o=o.replace(h,((R,D,B,G,$)=>{const J=G==="float"?"vec2":"vec4",oe=$.match(/color/)?"color":J;return T[$]?D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${J} a_${$};
varying ${B} ${G} ${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${J} a_${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = a_${$};
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${G} ${$} = u_${$};
#endif
`})),staticAttributes:x,usedDefines:C}}class fp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,x,T,C,R,D){this.context=o;let B=this.boundPaintVertexBuffers.length!==T.length;for(let $=0;!B&&$<T.length;$++)this.boundPaintVertexBuffers[$]!==T[$]&&(B=!0);let G=this.boundDynamicVertexBuffers.length!==D.length;for(let $=0;!G&&$<D.length;$++)this.boundDynamicVertexBuffers[$]!==D[$]&&(G=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==x||B||G||this.boundIndexBuffer!==C||this.boundVertexOffset!==R)this.freshBind(h,x,T,C,R,D);else{o.bindVertexArrayOES.set(this.vao);for(const $ of D)$&&$.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(o,h,x,T,C,R){let D;const B=o.numAttributes,G=this.context,$=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),D=0,this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=x,this.boundIndexBuffer=T,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=R;else{D=G.currentNumAttributes||0;for(let J=B;J<D;J++)$.disableVertexAttribArray(J)}h.enableAttributes($,o),h.bind(),h.setVertexAttribPointers($,o,C);for(const J of x)J.enableAttributes($,o),J.bind(),J.setVertexAttribPointers($,o,C);for(const J of R)J&&(J.enableAttributes($,o),J.bind(),J.setVertexAttribPointers($,o,C));T&&T.bind(),G.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Lh(g,o){const h=Math.pow(2,o.canonical.z),x=o.canonical.y;return[new a.MercatorCoordinate(0,x/h).toLngLat().lat,new a.MercatorCoordinate(0,(x+1)/h).toLngLat().lat]}function pp(g,o,h,x,T,C,R){const D=g.context,B=D.gl,G=h.fbo;if(!G)return;g.prepareDrawTile();const $=g.useProgram("hillshade");D.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,G.colorAttachment.get());const J=((de,me,Q,le)=>{const _e=Q.paint.get("hillshade-shadow-color"),ve=Q.paint.get("hillshade-highlight-color"),Ne=Q.paint.get("hillshade-accent-color");let De=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(De-=de.transform.angle);const Re=!de.options.moving;return{u_matrix:le||de.transform.calculateProjMatrix(me.tileID.toUnwrapped(),Re),u_image:0,u_latrange:Lh(0,me.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),De],u_shadow:_e,u_highlight:ve,u_accent:Ne}})(g,h,x,g.terrain?o.projMatrix:null);g.prepareDrawProgram(D,$,o.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:ce,tileBoundsSegments:he}=g.getTileBoundsBuffers(h);$.draw(D,B.TRIANGLES,T,C,R,a.CullFaceMode.disabled,J,x.id,oe,ce,he)}function jh(g,o,h){if(!o.needsDEMTextureUpload)return;const x=g.context,T=x.gl;x.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(h.stride);const C=h.getPixels();o.demTexture?o.demTexture.update(C,{premultiply:!1}):o.demTexture=new a.Texture(x,C,T.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function ad(g,o,h,x,T,C){const R=g.context,D=R.gl;if(!o.dem)return;const B=o.dem;if(R.activeTexture.set(D.TEXTURE1),jh(g,o,B),!o.demTexture)return;o.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);const G=B.dim;R.activeTexture.set(D.TEXTURE0);let $=o.fbo;if(!$){const he=new a.Texture(R,{width:G,height:G,data:null},D.RGBA);he.bind(D.LINEAR,D.CLAMP_TO_EDGE),$=o.fbo=R.createFramebuffer(G,G,!0),$.colorAttachment.set(he.texture)}R.bindFramebuffer.set($.framebuffer),R.viewport.set([0,0,G,G]);const{tileBoundsBuffer:J,tileBoundsIndexBuffer:oe,tileBoundsSegments:ce}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(R,D.TRIANGLES,x,T,C,a.CullFaceMode.disabled,((he,de)=>{const me=de.stride,Q=a.create();return a.ortho(Q,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Q,Q,[0,-a.EXTENT,0]),{u_matrix:Q,u_image:1,u_dimension:[me,me],u_zoom:he.overscaledZ,u_unpack:de.unpackVector}})(o.tileID,B),h.id,J,oe,ce),o.needsHillshadePrepare=!1}const Oh=g=>({u_matrix:new a.UniformMatrix4f(g),u_image0:new a.Uniform1i(g),u_skirt_height:new a.Uniform1f(g)}),nc=(g,o)=>({u_matrix:g,u_image0:0,u_skirt_height:o}),ld=(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(x),u_merc_matrix:h,u_zoom_transition:T,u_merc_center:C,u_image0:0,u_frustum_tl:R,u_frustum_tr:D,u_frustum_br:B,u_frustum_bl:G,u_globe_pos:$,u_globe_radius:J,u_viewport:oe,u_grid_matrix:he?Float32Array.from(he):new Float32Array(9),u_skirt_height:ce});function rc(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const aa=new class{constructor(){this.operations={}}newMorphing(g,o,h,x,T){if(g in this.operations){const C=this.operations[g];C.to.tileID.key!==h.tileID.key&&(C.queued=h)}else this.operations[g]={startTime:x,phase:0,duration:T,from:o,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const h=this.operations[o];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Pa={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function cd(g){return 6*Math.pow(1.5,22-g)}function mp(g,o){const h=1<<g.z;return!o&&(g.x===0||g.x===h-1)||g.y===0||g.y===h-1}const su=g=>({u_matrix:g});function zh(g,o,h,x,T){if(T>0){const C=a.exported.now(),R=(C-g.timeAdded)/T,D=o?(C-o.timeAdded)/T:-1,B=h.getSource(),G=x.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),$=!o||Math.abs(o.tileID.overscaledZ-G)>Math.abs(g.tileID.overscaledZ-G),J=$&&g.refreshedUponExpiration?1:a.clamp($?R:1-D,0,1);return g.refreshedUponExpiration&&R>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class ou extends a.SourceCache{constructor(o){const h={type:"raster-dem",maxzoom:o.transform.maxZoom},x=new fe(ll(),null),T=Pn("mock-dem",h,x,o.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class ud extends a.SourceCache{constructor(o){const h=Pn("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new fe(ll(),null),o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,x){if(o.freezeTileCoverage)return;this.transform=o;const T=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((C,R)=>{if(C[R.key]="",!this._tiles[R.key]){const D=new a.Tile(R,this._source.tileSize*R.overscaleFactor(),o.tileZoom);D.state="loaded",this._tiles[R.key]=D}return C}),{});for(const C in this._tiles)C in T||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(o){const h=this.proxyCachedFBO[o];if(h!==void 0){const x=Object.values(h);this.renderCachePool.push(...x),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach((o=>o.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class dd extends a.OverscaledTileID{constructor(o,h,x){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=x}}class Bh extends a.Elevation{constructor(o,h){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[x,T,C]=(function(B){const G=new a.StructArrayLayout2i4,$=new a.StructArrayLayout3ui6,J=131;G.reserve(17161),$.reserve(33800);const oe=a.EXTENT/128,ce=a.EXTENT+oe/2,he=ce+oe;for(let me=-oe;me<he;me+=oe)for(let Q=-oe;Q<he;Q+=oe){const le=Q<0||Q>ce||me<0||me>ce?24575:0,_e=a.clamp(Math.round(Q),0,a.EXTENT),ve=a.clamp(Math.round(me),0,a.EXTENT);G.emplaceBack(_e+le,ve)}const de=(me,Q)=>{const le=Q*J+me;$.emplaceBack(le+1,le,le+J),$.emplaceBack(le+J,le+J+1,le+1)};for(let me=1;me<129;me++)for(let Q=1;Q<129;Q++)de(Q,me);return[0,129].forEach((me=>{for(let Q=0;Q<130;Q++)de(Q,me),de(me,Q)})),[G,$,32768]})(),R=o.context;this.gridBuffer=R.createVertexBuffer(x,a.posAttributes.members),this.gridIndexBuffer=R.createIndexBuffer(T),this.gridSegments=a.SegmentVector.simpleSegment(0,0,x.length,T.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,x.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ud(h.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const D=R.gl;this._overlapStencilMode=new a.StencilMode({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ou(h.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(o,h,x){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const T=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const C=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const R=this.getScaledDemTileSize();this.sourceCache.update(h,R,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),h.updateElevation(!0,x),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((o=>o.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,x=this.painter.transform;this._initializing&&(this._initializing=x._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(x.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=h.getIds().map((B=>{const G=h.getTileByID(B).tileID;return G.projMatrix=x.calculateProjMatrix(G.toUnwrapped()),G}));(function(B,G){const $=G.transform.pointCoordinate(G.transform.getCameraPoint()),J=new a.Point($.x,$.y);B.sort(((oe,ce)=>{if(ce.overscaledZ-oe.overscaledZ)return ce.overscaledZ-oe.overscaledZ;const he=new a.Point(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),de=new a.Point(ce.canonical.x+(1<<ce.canonical.z)*ce.wrap,ce.canonical.y),me=J.mult(1<<oe.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(he)-me.distSqr(de)}))})(T,this.painter),this._previousZoom=x.zoom;const C=this.proxyToSource||{};this.proxyToSource={},T.forEach((B=>{this.proxyToSource[B.key]={}})),this.terrainTileForTile={};const R=this._style._sourceCaches;for(const B in R){const G=R[B];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,o[B],C),G.usedForTerrain))continue;const $=o[B];G.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[h.id]=T.map((B=>new dd(B,B.key,this.orthoMatrix))),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const D={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const G=this.terrainTileForTile[B.key];if(!G)continue;const $=G.tileID.key;$ in D||(this._visibleDemTiles.push(G),D[$]=$)}}_assignTerrainTiles(o){this._initializing||o.forEach((h=>{if(this.terrainTileForTile[h.key])return;const x=this._findTileCoveringTileID(h,this.sourceCache);x&&(this.terrainTileForTile[h.key]=x)}))}_prepareDEMTextures(){const o=this.painter.context,h=o.gl;for(const x in this.terrainTileForTile){const T=this.terrainTileForTile[x],C=T.dem;!C||T.demTexture&&!T.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),jh(this.painter,T,C))}}_prepareDemTileUniforms(o,h,x,T){if(!h||h.demTexture==null)return!1;const C=o.tileID.canonical,R=Math.pow(2,h.tileID.canonical.z-C.z),D=T||"";return x[`u_dem_tl${D}`]=[C.x*R%1,C.y*R%1],x[`u_dem_scale${D}`]=R,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,h=o.gl;if(!this._emptyDepthBufferTexture){const x=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(o,x,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const h=this._visibleDemTiles.reduce(((x,T)=>{if(!T.dem)return x;const C=T.dem.tree.minimums[0];return C>0&&o++,x+C}),0);return o?h/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);const x=this._getLoadedAreaMinimum(),T=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(x,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(T,{premultiply:!1}):C=this._emptyDEMTexture=new a.Texture(o,T,h.RGBA,{premultiply:!1}),C}setupElevationDraw(o,h,x){const T=this.painter.context,C=T.gl,R=(D=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(D),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var D;R.u_dem_size=this.sourceCache.getSource().tileSize,R.u_exaggeration=this.exaggeration();let B=null,G=null,$=1;if(x&&x.morphing&&this._useVertexMorphing){const J=x.morphing.srcDemTile,oe=x.morphing.dstDemTile;$=x.morphing.phase,J&&oe&&(this._prepareDemTileUniforms(o,J,R,"_prev")&&(G=J),this._prepareDemTileUniforms(o,oe,R)&&(B=oe))}if(G&&B?(T.activeTexture.set(C.TEXTURE2),B.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),T.activeTexture.set(C.TEXTURE4),G.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),R.u_dem_lerp=$):(B=this.terrainTileForTile[o.tileID.key],T.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(o,B,R)?B.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),T.activeTexture.set(C.TEXTURE3),x&&x.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(R.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),R.u_depth_size_inv=[1,1]),x&&x.useMeterToDem&&B){const J=(1<<B.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;R.u_meter_to_dem=J}if(x&&x.labelPlaneMatrixInv&&(R.u_label_plane_matrix_inv=x.labelPlaneMatrixInv),h.setTerrainUniformValues(T,R),this.painter.transform.projection.name==="globe"){const J=this.globeUniformValues(this.painter.transform,o.tileID.canonical,x&&x.useDenormalizedUpVectorScale);h.setGlobeUniformValues(T,J)}}globeUniformValues(o,h,x){const T=o.projection;return{u_tile_tl_up:T.upVector(h,0,0),u_tile_tr_up:T.upVector(h,a.EXTENT,0),u_tile_br_up:T.upVector(h,a.EXTENT,a.EXTENT),u_tile_bl_up:T.upVector(h,0,a.EXTENT),u_tile_up_scale:x?a.globeMetersToEcef(1):T.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const h=this.painter,x=this.painter.context;o.length!==0&&(x.bindFramebuffer.set(null),x.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(T,C,R,D,B){if(T.transform.projection.name==="globe")(function(G,$,J,oe,ce){const he=G.context,de=he.gl;let me,Q;const le=G.options.showTerrainWireframe?2:0,_e=G.transform,ve=a.globeUseCustomAntiAliasing(G,he,_e),Ne=(Ct,Ke)=>{if(Q===Ct)return;const dt=[Pa[Ct],"PROJECTION_GLOBE_VIEW"];ve&&dt.push("CUSTOM_ANTIALIASING"),Ke&&dt.push(Pa[le]),me=G.useProgram("globeRaster",null,dt),Q=Ct},De=G.colorModeForRenderPass(),Re=new a.DepthMode(de.LEQUAL,a.DepthMode.ReadWrite,G.depthRangeFor3D);aa.update(ce);const Ge=a.calculateGlobeMercatorMatrix(_e),$e=[a.mercatorXfromLng(_e.center.lng),a.mercatorYfromLat(_e.center.lat)],Ye=le?[!1,!0]:[!1],At=G.globeSharedBuffers,qe=[_e.width*a.exported.devicePixelRatio,_e.height*a.exported.devicePixelRatio],ct=Float32Array.from(_e.globeMatrix),Je={useDenormalizedUpVectorScale:!0};if(Ye.forEach((Ct=>{const Ke=G.transform,dt=cd(Ke.zoom)*$.exaggeration();Q=-1;const St=Ct?de.LINES:de.TRIANGLES;for(const wt of oe){const It=J.getTile(wt),en=a.StencilMode.disabled,_n=$.prevTerrainTileForTile[wt.key],Wt=$.terrainTileForTile[wt.key];rc(_n,Wt)&&aa.newMorphing(wt.key,_n,Wt,ce,250),he.activeTexture.set(de.TEXTURE0),It.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);const dn=aa.getMorphValuesForProxy(wt.key),jn=dn?1:0;dn&&a.extend$1(Je,{morphing:{srcDemTile:dn.from,dstDemTile:dn.to,phase:a.easeCubicInOut(dn.phase)}});const Fn=a.tileCornersToBounds(wt.canonical),tn=a.getLatitudinalLod(Fn.getCenter().lat),Gn=a.getGridMatrix(wt.canonical,Fn,tn,Ke.worldSize/Ke._pixelsPerMercatorPixel),ar=a.globeNormalizeECEF(a.globeTileBounds(wt.canonical)),lr=ld(Ke.projMatrix,ct,Ge,ar,a.globeToMercatorTransition(Ke.zoom),$e,Ke.frustumCorners.TL,Ke.frustumCorners.TR,Ke.frustumCorners.BR,Ke.frustumCorners.BL,Ke.globeCenterInViewSpace,Ke.globeRadius,qe,dt,Gn);if(Ne(jn,Ct),$.setupElevationDraw(It,me,Je),G.prepareDrawProgram(he,me,wt.toUnwrapped()),At){const[rr,Li,$r]=Ct?At.getWirefameBuffers(G.context,tn):At.getGridBuffers(tn,dt!==0);me.draw(he,St,Re,en,De,a.CullFaceMode.backCCW,lr,"globe_raster",rr,Li,$r)}}})),At){const Ct=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ve&&Ct.push("CUSTOM_ANTIALIASING"),me=G.useProgram("globeRaster",null,Ct);for(const Ke of oe){const{x:dt,y:St,z:wt}=Ke.canonical,It=St===0,en=St===(1<<wt)-1,[_n,Wt,dn,jn]=At.getPoleBuffers(wt);if(jn&&(It||en)){const Fn=J.getTile(Ke);he.activeTexture.set(de.TEXTURE0),Fn.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let tn=a.globePoleMatrixForTile(wt,dt,_e);const Gn=a.globeNormalizeECEF(a.globeTileBounds(Ke.canonical)),ar=(lr,rr)=>lr.draw(he,de.TRIANGLES,Re,a.StencilMode.disabled,De,a.CullFaceMode.disabled,ld(_e.projMatrix,tn,tn,Gn,0,$e,_e.frustumCorners.TL,_e.frustumCorners.TR,_e.frustumCorners.BR,_e.frustumCorners.BL,_e.globeCenterInViewSpace,_e.globeRadius,qe,0),"globe_pole_raster",rr,dn,jn);$.setupElevationDraw(Fn,me,Je),G.prepareDrawProgram(he,me,Ke.toUnwrapped()),It&&ar(me,_n),en&&(tn=a.scale(a.create(),tn,[1,-1,1]),ar(me,Wt))}}}})(T,C,R,D,B);else{const G=T.context,$=G.gl;let J,oe;const ce=T.options.showTerrainWireframe?2:0,he=(_e,ve)=>{if(oe===_e)return;const Ne=[Pa[_e]];ve&&Ne.push(Pa[ce]),J=T.useProgram("terrainRaster",null,Ne),oe=_e},de=T.colorModeForRenderPass(),me=new a.DepthMode($.LEQUAL,a.DepthMode.ReadWrite,T.depthRangeFor3D);aa.update(B);const Q=T.transform,le=cd(Q.zoom)*C.exaggeration();(ce?[!1,!0]:[!1]).forEach((_e=>{oe=-1;const ve=_e?$.LINES:$.TRIANGLES,[Ne,De]=_e?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const Re of D){const Ge=R.getTile(Re),$e=a.StencilMode.disabled,Ye=C.prevTerrainTileForTile[Re.key],At=C.terrainTileForTile[Re.key];rc(Ye,At)&&aa.newMorphing(Re.key,Ye,At,B,250),G.activeTexture.set($.TEXTURE0),Ge.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const qe=aa.getMorphValuesForProxy(Re.key),ct=qe?1:0;let Je;qe&&(Je={morphing:{srcDemTile:qe.from,dstDemTile:qe.to,phase:a.easeCubicInOut(qe.phase)}});const Ct=nc(Re.projMatrix,mp(Re.canonical,Q.renderWorldCopies)?le/10:le);he(ct,_e),C.setupElevationDraw(Ge,J,Je),T.prepareDrawProgram(G,J,Re.toUnwrapped()),J.draw(G,ve,me,$e,de,a.CullFaceMode.backCCW,Ct,"terrain_raster",C.gridBuffer,Ne,De)}}))}})(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const h=this.painter,x=this.painter.context,T=this.proxySourceCache,C=this.proxiedCoords[T.id],R=this._drapedRenderBatches.shift(),D=[],B=h.style.order;let G=0;for(const $ of C){const J=T.getTileByID($.proxyTileKey),oe=T.proxyCachedFBO[$.key]?T.proxyCachedFBO[$.key][o]:void 0,ce=oe!==void 0?T.renderCache[oe]:this.pool[G++],he=oe!==void 0;if(J.texture=ce.tex,he&&!ce.dirty){D.push(J.tileID);continue}let de;x.bindFramebuffer.set(ce.fb.framebuffer),this.renderedToTile=!1,ce.dirty&&(x.clear({color:a.Color.transparent,stencil:0}),ce.dirty=!1);for(let me=R.start;me<=R.end;++me){const Q=h.style._layers[B[me]];if(Q.isHidden(h.transform.zoom))continue;const le=h.style._getLayerSourceCache(Q),_e=le?this.proxyToSource[$.key][le.id]:[$];if(!_e)continue;const ve=_e;x.viewport.set([0,0,ce.fb.width,ce.fb.height]),de!==(le?le.id:null)&&(this._setupStencil(ce,_e,Q,le),de=le?le.id:null),h.renderLayer(h,le,Q,ve)}this.renderedToTile?(ce.dirty=!0,D.push(J.tileID)):he||--G,G===5&&(G=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,x.bindFramebuffer.set(null),x.viewport.set([0,0,h.width,h.height]),R.end+1}postRender(){}renderCacheEfficiency(o){const h=o.order.length;if(h===0)return{efficiency:100};let x,T=0,C=0,R=!1;for(let D=0;D<h;++D){const B=o._layers[o.order[D]];this._style.isLayerDraped(B)?(R&&++T,++C):R||(R=!0,x=B.id)}return C===0?{efficiency:100}:{efficiency:100*(1-T/C),firstUndrapedLayer:x}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter((h=>h.dem)).forEach((h=>{o=Math.min(o,h.dem.tree.minimums[0])})),o===0?o:(o-30)*this._exaggeration}raycast(o,h,x){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter((C=>C.dem)).map((C=>{const R=C.tileID,D=1<<R.overscaledZ,{x:B,y:G}=R.canonical,$=B/D,J=(B+1)/D,oe=G/D,ce=(G+1)/D;return{minx:$,miny:oe,maxx:J,maxy:ce,t:C.dem.tree.raycastRoot($,oe,J,ce,o,h,x),tile:C}}));T.sort(((C,R)=>(C.t!==null?C.t:Number.MAX_VALUE)-(R.t!==null?R.t:Number.MAX_VALUE)));for(const C of T){if(C.t==null)return null;const R=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,o,h,x);if(R!=null)return R}return null}_createFBO(){const o=this.painter.context,h=o.gl,x=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);const T=new a.Texture(o,{width:x[0],height:x[1],data:null},h.RGBA);T.bind(h.LINEAR,h.CLAMP_TO_EDGE);const C=o.createFramebuffer(x[0],x[1],!1);return C.colorAttachment.set(T.texture),C.depthAttachment=new Le(o,C.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,x[0],x[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:C,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some((o=>{const h=this._style._layers[o],x=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!x&&h.shouldRedrape():!x&&h.hasTransition()}))}_clearLineLayersFromRenderCache(){let o=!1;for(const x of this._style._getSources())if(x instanceof Rt){o=!0;break}if(!o)return;const h={};for(let x=0;x<this._style.order.length;++x){const T=this._style._layers[this._style.order[x]],C=this._style._getLayerSourceCache(T);if(C&&!h[C.id]&&!T.isHidden(this.painter.transform.zoom)&&T.type==="line"&&T.widthExpression()instanceof a.ZoomDependentExpression){h[C.id]=!0;for(const R of this.proxyCoords){const D=this.proxyToSource[R.key][C.id];if(D)for(const B of D)this._clearRenderCacheForTile(C.id,B)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const x in this._style._sourceCaches)if(this._style._sourceCaches[x]._source instanceof bt){o=!0;break}if(!o)return;const h={};for(let x=0;x<this._style.order.length;++x){const T=this._style._layers[this._style.order[x]],C=this._style._getLayerSourceCache(T);if(!C||h[C.id]||T.isHidden(this.painter.transform.zoom)||T.type!=="raster")continue;const R=T.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const B=this.proxyToSource[D.key][C.id];if(B)for(const G of B){const $=zh(C.getTile(G),C.findLoadedParent(G,0),C,this.painter.transform,R);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(C.id,G)}}}}_setupDrapedRenderBatches(){const o=this._style.order,h=o.length;if(h===0)return;const x=[];let T,C=0,R=this._style._layers[o[C]];for(;!this._style.isLayerDraped(R)&&R.isHidden(this.painter.transform.zoom)&&++C<h;)R=this._style._layers[o[C]];for(;C<h;++C){const D=this._style._layers[o[C]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?T===void 0&&(T=C):T!==void 0&&(x.push({start:T,end:C-1}),T=void 0))}T!==void 0&&x.push({start:T,end:C-1}),this._drapedRenderBatches=x}_setupRenderCache(o){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const R=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let D=0;D<R.length;++D){const B=Object.values(R[D]);h.renderCachePool.push(...B)}}return}this._clearRasterLayersFromRenderCache();const x=this.proxyCoords,T=this._tilesDirty;for(let R=x.length-1;R>=0;R--){const D=x[R];if(h.getTileByID(D.key),h.proxyCachedFBO[D.key]!==void 0){const B=o[D.key],G=this.proxyToSource[D.key];let $=0;for(const J in G){const oe=G[J],ce=B[J];if(!ce||ce.length!==oe.length||oe.some(((he,de)=>he!==ce[de]||T[J]&&T[J].hasOwnProperty(he.key)))){$=-1;break}++$}for(const J in h.proxyCachedFBO[D.key])h.renderCache[h.proxyCachedFBO[D.key][J]].dirty=$<0||$!==Object.values(B).length}}const C=[...this._drapedRenderBatches];C.sort(((R,D)=>D.end-D.start-(R.end-R.start)));for(const R of C)for(const D of x){if(h.proxyCachedFBO[D.key])continue;let B=h.renderCachePool.pop();B===void 0&&h.renderCache.length<50&&(B=h.renderCache.length,h.renderCache.push(this._createFBO())),B!==void 0&&(h.proxyCachedFBO[D.key]={},h.proxyCachedFBO[D.key][R.start]=B,h.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,x,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,R=C.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let D;if(x.isTileClipped())D=h.length,this._overlapStencilMode.test={func:R.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:R.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,x.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(o,h){const x=this.painter,T=this.painter.context,C=T.gl;x._tileClippingMaskIDs={},T.setColorMode(a.ColorMode.disabled),T.setDepthMode(a.DepthMode.disabled);const R=x.useProgram("clippingMask");for(const D of o){const B=x._tileClippingMaskIDs[D.key]=--h;R.draw(T,C.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:C.ALWAYS,mask:0},B,255,C.KEEP,C.KEEP,C.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,su(D.projMatrix),"$clipping",x.tileExtentBuffer,x.quadTriangleIndexBuffer,x.tileExtentSegments)}}pointCoordinate(o){const h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;const x=[o.x,o.y,1,1];a.transformMat4$1(x,x,h.pixelMatrixInverse),a.scale$1(x,x,1/x[3]),x[0]/=h.worldSize,x[1]/=h.worldSize;const T=h._camera.position,C=a.mercatorZfromAltitude(1,h.center.lat),R=[T[0],T[1],T[2]/C,0],D=a.subtract([],x.slice(0,3),R);a.normalize(D,D);const B=this.raycast(R,D,this._exaggeration);return B!==null&&B?(a.scaleAndAdd(R,R,D,B),R[3]=R[2],R[2]*=C,R):null}drawDepth(){const o=this.painter,h=o.context,x=this.proxySourceCache,T=Math.ceil(o.width),C=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const R=h.gl,D=h.createFramebuffer(T,C,!0);h.activeTexture.set(R.TEXTURE0);const B=new a.Texture(h,{width:T,height:C,data:null},R.RGBA);B.bind(R.NEAREST,R.CLAMP_TO_EDGE),D.colorAttachment.set(B.texture);const G=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,T,C);D.depthAttachment.set(G),this._depthFBO=D,this._depthTexture=B}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,T,C]),(function(R,D,B,G){if(R.transform.projection.name==="globe")return;const $=R.context,J=$.gl;$.clear({depth:1});const oe=R.useProgram("terrainDepth"),ce=new a.DepthMode(J.LESS,a.DepthMode.ReadWrite,R.depthRangeFor3D);for(const he of G){const de=B.getTile(he),me=nc(he.projMatrix,0);D.setupElevationDraw(de,oe),oe.draw($,J.TRIANGLES,ce,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,me,"terrain_depth",D.gridBuffer,D.gridIndexBuffer,D.gridNoSkirtSegments)}})(o,this,x,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,h,x){if(o.getSource()instanceof An)return this._setupProxiedCoordsForImageSource(o,h,x);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const T=this.proxiedCoords[o.id]=[],C=this.proxyCoords;for(let D=0;D<C.length;D++){const B=C[D],G=this._findTileCoveringTileID(B,o);if(G){const $=this._createProxiedId(B,G,x[B.key]&&x[B.key][o.id]);T.push($),this.proxyToSource[B.key][o.id]=[$]}}let R=!1;for(let D=0;D<h.length;D++){const B=o.getTile(h[D]);if(!B||!B.hasData())continue;const G=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==B.tileID.canonical.z){const $=this.proxyToSource[G.tileID.key][o.id],J=this._createProxiedId(G.tileID,B,x[G.tileID.key]&&x[G.tileID.key][o.id]);$?$.splice($.length-1,0,J):this.proxyToSource[G.tileID.key][o.id]=[J],T.push(J),R=!0}}this._sourceTilesOverlap[o.id]=R}_setupProxiedCoordsForImageSource(o,h,x){if(!o.getSource().loaded())return;const T=this.proxiedCoords[o.id]=[],C=this.proxyCoords,R=o.getSource(),D=new a.Point(R.tileID.x,R.tileID.y)._div(1<<R.tileID.z),B=R.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((($,J)=>($.min.x=Math.min($.min.x,J.x-D.x),$.min.y=Math.min($.min.y,J.y-D.y),$.max.x=Math.max($.max.x,J.x-D.x),$.max.y=Math.max($.max.y,J.y-D.y),$)),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=($,J)=>{const oe=$.wrap+$.canonical.x/(1<<$.canonical.z),ce=$.canonical.y/(1<<$.canonical.z),he=a.EXTENT/(1<<$.canonical.z),de=J.wrap+J.canonical.x/(1<<J.canonical.z),me=J.canonical.y/(1<<J.canonical.z);return oe+he<de+B.min.x||oe>de+B.max.x||ce+he<me+B.min.y||ce>me+B.max.y};for(let $=0;$<C.length;$++){const J=C[$];for(let oe=0;oe<h.length;oe++){const ce=o.getTile(h[oe]);if(!ce||!ce.hasData()||G(J,ce.tileID))continue;const he=this._createProxiedId(J,ce,x[J.key]&&x[J.key][o.id]),de=this.proxyToSource[J.key][o.id];de?de.push(he):this.proxyToSource[J.key][o.id]=[he],T.push(he)}}}_createProxiedId(o,h,x){let T=this.orthoMatrix;if(x){const C=x.find((R=>R.key===h.tileID.key));if(C)return C}if(h.tileID.key!==o.key){const C=o.canonical.z-h.tileID.canonical.z;let R,D,B;T=a.create();const G=h.tileID.wrap-o.wrap<<o.overscaledZ;C>0?(R=a.EXTENT>>C,D=R*((h.tileID.canonical.x<<C)-o.canonical.x+G),B=R*((h.tileID.canonical.y<<C)-o.canonical.y)):(R=a.EXTENT<<-C,D=a.EXTENT*(h.tileID.canonical.x-(o.canonical.x+G<<-C)),B=a.EXTENT*(h.tileID.canonical.y-(o.canonical.y<<-C))),a.ortho(T,0,R,0,R,0,1),a.translate(T,T,[D,B,0])}return new dd(h.tileID,o.key,T)}_findTileCoveringTileID(o,h){let x=h.getTile(o);if(x&&x.hasData())return x;const T=this._findCoveringTileCache[h.id],C=T[o.key];if(x=C?h.getTileByID(C):null,x&&x.hasData()||C===null)return x;let R=x?x.tileID:o,D=R.overscaledZ;const B=h.getSource().minzoom,G=[];if(!C){const J=h.getSource().maxzoom;if(o.canonical.z>=J){const oe=o.canonical.z-J;h.getSource().reparseOverscaled?(D=Math.max(o.canonical.z+2,h.transform.tileZoom),R=new a.OverscaledTileID(D,o.wrap,J,o.canonical.x>>oe,o.canonical.y>>oe)):oe!==0&&(D=J,R=new a.OverscaledTileID(D,o.wrap,J,o.canonical.x>>oe,o.canonical.y>>oe))}R.key!==o.key&&(G.push(R.key),x=h.getTile(R))}const $=J=>{G.forEach((oe=>{T[oe]=J})),G.length=0};for(D-=1;D>=B&&(!x||!x.hasData());D--){x&&$(x.tileID.key);const J=R.calculateScaledKey(D);if(x=h.getTileByID(J),x&&x.hasData())break;const oe=T[J];if(oe===null)break;oe===void 0?G.push(J):x=h.getTileByID(oe)}return $(x?x.tileID.key:null),x&&x.hasData()?x:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let x=this._tilesDirty[o];x||(x=this._tilesDirty[o]={}),x[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=(function(h){let x=0;const T=new a.StructArrayLayout2ui4,C=131;for(let R=1;R<129;R++){for(let D=1;D<129;D++)x=R*C+D,T.emplaceBack(x,x+1),T.emplaceBack(x,x+C),T.emplaceBack(x+1,x+C),R===128&&T.emplaceBack(x+C,x+C+1);T.emplaceBack(x+1,x+1+C)}return T})();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Yn{static cacheKey(o,h,x,T){let C=`${h}${T?T.cacheKey:""}`;for(const R of x)o.usedDefines.includes(R)&&(C+=`/${R}`);return C}constructor(o,h,x,T,C,R){const D=o.gl;this.program=D.createProgram();const B=(function(Q){const le=[];for(let _e=0;_e<Q.length;_e++){if(Q[_e]===null)continue;const ve=Q[_e].split(" ");le.push(ve.pop())}return le})(x.staticAttributes),G=T?T.getBinderAttributes():[],$=B.concat(G);let J=T?T.defines():[];J=J.concat(R.map((Q=>`#define ${Q}`)));const oe=o.isWebGL2?`#version 300 es
`:"",ce=oe+J.concat(o.extStandardDerivatives&&oe.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(ru):ru,ru,od,tc.fragmentSource,So.fragmentSource,x.fragmentSource).join(`
`),he=oe+J.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,od,tc.vertexSource,So.vertexSource,Ki.vertexSource,x.vertexSource).join(`
`),de=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(de,ce),D.compileShader(de),D.attachShader(this.program,de);const me=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(me,he),D.compileShader(me),D.attachShader(this.program,me),this.attributes={},this.numAttributes=$.length;for(let Q=0;Q<this.numAttributes;Q++)$[Q]&&(D.bindAttribLocation(this.program,Q,$[Q]),this.attributes[$[Q]]=Q);D.linkProgram(this.program),D.deleteShader(me),D.deleteShader(de),this.fixedUniforms=C(o),this.binderUniforms=T?T.getUniforms(o):[],R.includes("TERRAIN")&&(this.terrainUniforms=(Q=>({u_dem:new a.Uniform1i(Q),u_dem_prev:new a.Uniform1i(Q),u_dem_unpack:new a.Uniform4f(Q),u_dem_tl:new a.Uniform2f(Q),u_dem_scale:new a.Uniform1f(Q),u_dem_tl_prev:new a.Uniform2f(Q),u_dem_scale_prev:new a.Uniform1f(Q),u_dem_size:new a.Uniform1f(Q),u_dem_lerp:new a.Uniform1f(Q),u_exaggeration:new a.Uniform1f(Q),u_depth:new a.Uniform1i(Q),u_depth_size_inv:new a.Uniform2f(Q),u_meter_to_dem:new a.Uniform1f(Q),u_label_plane_matrix_inv:new a.UniformMatrix4f(Q)}))(o)),R.includes("GLOBE")&&(this.globeUniforms=(Q=>({u_tile_tl_up:new a.Uniform3f(Q),u_tile_tr_up:new a.Uniform3f(Q),u_tile_br_up:new a.Uniform3f(Q),u_tile_bl_up:new a.Uniform3f(Q),u_tile_up_scale:new a.Uniform1f(Q)}))(o)),R.includes("FOG")&&(this.fogUniforms=(Q=>({u_fog_matrix:new a.UniformMatrix4f(Q),u_fog_range:new a.Uniform2f(Q),u_fog_color:new a.Uniform4f(Q),u_fog_horizon_blend:new a.Uniform1f(Q),u_fog_temporal_offset:new a.Uniform1f(Q),u_frustum_tl:new a.Uniform3f(Q),u_frustum_tr:new a.Uniform3f(Q),u_frustum_br:new a.Uniform3f(Q),u_frustum_bl:new a.Uniform3f(Q),u_globe_pos:new a.Uniform3f(Q),u_globe_radius:new a.Uniform1f(Q),u_globe_transition:new a.Uniform1f(Q),u_is_globe:new a.Uniform1i(Q),u_viewport:new a.Uniform2f(Q)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;const x=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)x[T]&&x[T].set(this.program,T,h[T])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;const x=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)x[T]&&x[T].set(this.program,T,h[T])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;const x=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)x[T].set(this.program,T,h[T])}}draw(o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de){const me=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(x),o.setStencilMode(T),o.setColorMode(C),o.setCullFace(R);for(const le of Object.keys(this.fixedUniforms))this.fixedUniforms[le].set(this.program,le,D[le]);he&&he.setUniforms(this.program,o,this.binderUniforms,oe,{zoom:ce});const Q={[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[h];for(const le of J.get()){const _e=le.vaos||(le.vaos={});(_e[B]||(_e[B]=new fp)).bind(o,this,G,he?he.getPaintVertexBuffers():[],$,le.vertexOffset,de||[]),me.drawElements(h,le.primitiveLength*Q,me.UNSIGNED_SHORT,le.primitiveOffset*Q*2)}}}function au(g,o){const h=Math.pow(2,o.tileID.overscaledZ),x=o.tileSize*Math.pow(2,g.transform.tileZoom)/h,T=x*(o.tileID.canonical.x+o.tileID.wrap*h),C=x*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/Fe(o,1,g.transform.tileZoom),u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const gp=a.create(),Fh=(g,o,h,x,T,C,R,D,B,G,$)=>{const J=o.style.light,oe=J.properties.get("position"),ce=[oe.x,oe.y,oe.z],he=a.create$1();J.properties.get("anchor")==="viewport"&&(a.fromRotation(he,-o.transform.angle),a.transformMat3(ce,ce,he));const de=J.properties.get("color"),me=o.transform,Q={u_matrix:g,u_lightpos:ce,u_lightintensity:J.properties.get("intensity"),u_lightcolor:[de.r,de.g,de.b],u_vertical_gradient:+h,u_opacity:x,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:gp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:C};return me.projection.name==="globe"&&(Q.u_tile_id=[R.canonical.x,R.canonical.y,1<<R.canonical.z],Q.u_zoom_transition=B,Q.u_inv_rot_matrix=$,Q.u_merc_center=G,Q.u_up_dir=me.projection.upVector(new a.CanonicalTileID(0,0,0),G[0]*a.EXTENT,G[1]*a.EXTENT),Q.u_height_lift=D),Q},yp=(g,o,h,x,T,C,R,D,B,G,$,J)=>{const oe=Fh(g,o,h,x,T,C,R,B,G,$,J),ce={u_height_factor:-Math.pow(2,R.overscaledZ)/D.tileSize/8};return a.extend(oe,au(o,D),ce)},fl=g=>({u_matrix:g}),Vh=(g,o,h)=>a.extend(fl(g),au(o,h)),sg=(g,o)=>({u_matrix:g,u_world:o}),Uh=(g,o,h,x)=>a.extend(Vh(g,o,h),{u_world:x}),lu=a.create(),$h=(g,o,h,x,T,C)=>{const R=g.transform,D=R.projection.name==="globe";let B;if(C.paint.get("circle-pitch-alignment")==="map")if(D){const $=a.globePixelsToTileUnits(R.zoom,o.canonical)*R._pixelsPerMercatorPixel;B=Float32Array.from([$,0,0,$])}else B=R.calculatePixelsToTileUnitsMatrix(h);else B=new Float32Array([R.pixelsToGLUnits[0],0,0,R.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:R.cameraToCenterDistance,u_matrix:g.translatePosMatrix(o.projMatrix,h,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:lu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){G.u_inv_rot_matrix=x,G.u_merc_center=T,G.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],G.u_zoom_transition=a.globeToMercatorTransition(R.zoom);const $=T[0]*a.EXTENT,J=T[1]*a.EXTENT;G.u_up_dir=R.projection.upVector(new a.CanonicalTileID(0,0,0),$,J)}return G},hd=g=>{const o=[];return g.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},fd=(g,o,h,x)=>{const T=a.EXTENT/h.tileSize;return{u_matrix:g,u_camera_to_center_distance:o.getCameraToCenterDistance(x),u_extrude_scale:[o.pixelsToGLUnits[0]/T,o.pixelsToGLUnits[1]/T]}},cu=(g,o,h=1)=>({u_matrix:g,u_color:o,u_overlay:0,u_overlay_scale:h}),Gh=a.create(),Hh=(g,o,h,x,T,C,R)=>{const D=g.transform,B=D.projection.name==="globe",G=B?a.globePixelsToTileUnits(D.zoom,o.canonical)*D._pixelsPerMercatorPixel:Fe(h,1,C),$={u_matrix:o.projMatrix,u_extrude_scale:G,u_intensity:R,u_inv_rot_matrix:Gh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){$.u_inv_rot_matrix=x,$.u_merc_center=T,$.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],$.u_zoom_transition=a.globeToMercatorTransition(D.zoom);const J=T[0]*a.EXTENT,oe=T[1]*a.EXTENT;$.u_up_dir=D.projection.upVector(new a.CanonicalTileID(0,0,0),J,oe)}return $},ic=(g,o,h,x,T,C,R)=>{const D=g.transform,B=D.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:Wh(g,o,h,x),u_pixels_to_tile_units:B,u_device_pixel_ratio:C,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:oc(h)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:sc(o,g.transform),u_alpha_discard_threshold:0,u_trim_offset:R}},uu=(g,o,h,x,T)=>{const C=g.transform;return{u_matrix:Wh(g,o,h,x),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:sc(o,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function sc(g,o){return 1/Fe(g,1,o.tileZoom)}function Wh(g,o,h,x){return g.translatePosMatrix(x||o.tileID.projMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function oc(g){const o=g.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const pd=(g,o,h,x,T,C)=>{return{u_matrix:g,u_tl_parent:o,u_scale_parent:h,u_fade_t:x.mix,u_opacity:x.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(D=T.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(R=T.paint.get("raster-contrast"),R>0?1/(1-R):1+R),u_spin_weights:bs(T.paint.get("raster-hue-rotate")),u_perspective_transform:C};var R,D};function bs(g){g*=Math.PI/180;const o=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const Na=a.create(),qh=(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de)=>{const me=T.transform,Q={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:me.width/me.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:R,u_coord_matrix:D,u_is_text:+B,u_pitch_with_map:+x,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Na,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Na,u_up_vector:[0,-1,0]};return de.name==="globe"&&(Q.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],Q.u_zoom_transition=J,Q.u_inv_rot_matrix=ce,Q.u_merc_center=oe,Q.u_camera_forward=me._camera.forward(),Q.u_ecef_origin=a.globeECEFOrigin(me.globeMatrix,$.toUnwrapped()),Q.u_tile_matrix=Float32Array.from(me.globeMatrix),Q.u_up_vector=he),Q},pl=(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de,me)=>a.extend(qh(g,o,h,x,T,C,R,D,B,G,J,oe,ce,he,de,me),{u_gamma_scale:x?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:1}),_p=(g,o,h,x,T,C,R,D,B,G,$,J,oe,ce,he,de)=>a.extend(pl(g,o,h,x,T,C,R,D,!0,B,!0,$,J,oe,ce,he,de),{u_texsize_icon:G,u_texture_icon:1}),md=(g,o,h)=>({u_matrix:g,u_opacity:o,u_color:h}),Zh=(g,o,h,x,T)=>a.extend((function(C,R,D){const B=R.imageManager.getPattern(C.toString()),{width:G,height:$}=R.imageManager.getPixelSize(),J=Math.pow(2,D.tileID.overscaledZ),oe=D.tileSize*Math.pow(2,R.transform.tileZoom)/J,ce=oe*(D.tileID.canonical.x+D.tileID.wrap*J),he=oe*D.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[G,$],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/Fe(D,1,R.transform.tileZoom),u_pixel_coord_upper:[ce>>16,he>>16],u_pixel_coord_lower:[65535&ce,65535&he]}})(x,h,T),{u_matrix:g,u_opacity:o}),du={fillExtrusion:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_height_factor:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g)}),fill:g=>({u_matrix:new a.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),fillOutline:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),collisionBox:g=>({u_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new a.UniformMatrix4f(g),u_inv_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_viewport_size:new a.Uniform2f(g)}),debug:g=>({u_color:new a.UniformColor(g),u_matrix:new a.UniformMatrix4f(g),u_overlay:new a.Uniform1i(g),u_overlay_scale:new a.Uniform1f(g)}),clippingMask:g=>({u_matrix:new a.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new a.Uniform1f(g),u_intensity:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),heatmapTexture:g=>({u_image:new a.Uniform1i(g),u_color_ramp:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g)}),hillshade:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_latrange:new a.Uniform2f(g),u_light:new a.Uniform2f(g),u_shadow:new a.UniformColor(g),u_highlight:new a.UniformColor(g),u_accent:new a.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_dimension:new a.Uniform2f(g),u_zoom:new a.Uniform1f(g),u_unpack:new a.Uniform4f(g)}),line:g=>({u_matrix:new a.UniformMatrix4f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_units_to_pixels:new a.Uniform2f(g),u_dash_image:new a.Uniform1i(g),u_gradient_image:new a.Uniform1i(g),u_image_height:new a.Uniform1f(g),u_texsize:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g),u_trim_offset:new a.Uniform2f(g)}),linePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_texsize:new a.Uniform2f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_units_to_pixels:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g)}),raster:g=>({u_matrix:new a.UniformMatrix4f(g),u_tl_parent:new a.Uniform2f(g),u_scale_parent:new a.Uniform1f(g),u_fade_t:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_image0:new a.Uniform1i(g),u_image1:new a.Uniform1i(g),u_brightness_low:new a.Uniform1f(g),u_brightness_high:new a.Uniform1f(g),u_saturation_factor:new a.Uniform1f(g),u_contrast_factor:new a.Uniform1f(g),u_spin_weights:new a.Uniform3f(g),u_perspective_transform:new a.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_texture:new a.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_is_halo:new a.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texsize_icon:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_texture_icon:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_is_halo:new a.Uniform1i(g)}),background:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_color:new a.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_pattern_tl:new a.Uniform2f(g),u_pattern_br:new a.Uniform2f(g),u_texsize:new a.Uniform2f(g),u_pattern_size:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),terrainRaster:Oh,terrainDepth:Oh,skybox:g=>({u_matrix:new a.UniformMatrix4f(g),u_sun_direction:new a.Uniform3f(g),u_cubemap:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new a.UniformMatrix4f(g),u_color_ramp:new a.Uniform1i(g),u_center_direction:new a.Uniform3f(g),u_radius:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new a.UniformMatrix3f(g),u_sun_direction:new a.Uniform3f(g),u_sun_intensity:new a.Uniform1f(g),u_color_tint_r:new a.Uniform4f(g),u_color_tint_m:new a.Uniform4f(g),u_luminance:new a.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new a.UniformMatrix4f(g),u_globe_matrix:new a.UniformMatrix4f(g),u_normalize_matrix:new a.UniformMatrix4f(g),u_merc_matrix:new a.UniformMatrix4f(g),u_zoom_transition:new a.Uniform1f(g),u_merc_center:new a.Uniform2f(g),u_image0:new a.Uniform1i(g),u_grid_matrix:new a.UniformMatrix3f(g),u_skirt_height:new a.Uniform1f(g),u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_globe_pos:new a.Uniform3f(g),u_globe_radius:new a.Uniform1f(g),u_viewport:new a.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_horizon:new a.Uniform1f(g),u_transition:new a.Uniform1f(g),u_fadeout_range:new a.Uniform1f(g),u_color:new a.Uniform4f(g),u_high_color:new a.Uniform4f(g),u_space_color:new a.Uniform4f(g),u_star_intensity:new a.Uniform1f(g),u_star_density:new a.Uniform1f(g),u_star_size:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g),u_horizon_angle:new a.Uniform1f(g),u_rotation_matrix:new a.UniformMatrix4f(g)})};let hu;function ac(g,o,h,x,T,C,R){const D=g.context,B=D.gl,G=g.transform,$=g.useProgram("collisionBox"),J=[];let oe=0,ce=0;for(let ve=0;ve<x.length;ve++){const Ne=x[ve],De=o.getTile(Ne),Re=De.getBucket(h);if(!Re)continue;const Ge=zs(Ne,Re,G);let $e=Ge;T[0]===0&&T[1]===0||($e=g.translatePosMatrix(Ge,De,T,C));const Ye=R?Re.textCollisionBox:Re.iconCollisionBox,At=Re.collisionCircleArray;if(At.length>0){const qe=a.create(),ct=$e;a.mul(qe,Re.placementInvProjMatrix,G.glCoordMatrix),a.mul(qe,qe,Re.placementViewportMatrix),J.push({circleArray:At,circleOffset:ce,transform:ct,invTransform:qe,projection:Re.getProjection()}),oe+=At.length/4,ce=oe}Ye&&(g.terrain&&g.terrain.setupElevationDraw(De,$),$.draw(D,B.LINES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,fd($e,G,De,Re.getProjection()),h.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,null,G.zoom,null,[Ye.collisionVertexBuffer,Ye.collisionVertexBufferExt]))}if(!R||!J.length)return;const he=g.useProgram("collisionCircle"),de=new a.StructArrayLayout2f1f2i16;de.resize(4*oe),de._trim();let me=0;for(const ve of J)for(let Ne=0;Ne<ve.circleArray.length/4;Ne++){const De=4*Ne,Re=ve.circleArray[De+0],Ge=ve.circleArray[De+1],$e=ve.circleArray[De+2],Ye=ve.circleArray[De+3];de.emplace(me++,Re,Ge,$e,Ye,0),de.emplace(me++,Re,Ge,$e,Ye,1),de.emplace(me++,Re,Ge,$e,Ye,2),de.emplace(me++,Re,Ge,$e,Ye,3)}(!hu||hu.length<2*oe)&&(hu=(function(ve){const Ne=2*ve,De=new a.StructArrayLayout3ui6;De.resize(Ne),De._trim();for(let Re=0;Re<Ne;Re++){const Ge=6*Re;De.uint16[Ge+0]=4*Re+0,De.uint16[Ge+1]=4*Re+1,De.uint16[Ge+2]=4*Re+2,De.uint16[Ge+3]=4*Re+2,De.uint16[Ge+4]=4*Re+3,De.uint16[Ge+5]=4*Re+0}return De})(oe));const Q=D.createIndexBuffer(hu,!0),le=D.createVertexBuffer(de,a.collisionCircleLayout.members,!0);for(const ve of J){const Ne={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(_e=G).getCameraToCenterDistance(ve.projection),u_viewport_size:[_e.width,_e.height]};he.draw(D,B.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,Ne,h.id,le,Q,a.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,G.zoom)}var _e;le.destroy(),Q.destroy()}const Xh=a.create();function Kh({width:g,height:o,anchor:h,textOffset:x,textScale:T},C){const{horizontalAlign:R,verticalAlign:D}=a.getAnchorAlignment(h),B=-(R-.5)*g,G=-(D-.5)*o,$=a.evaluateVariableOffset(h,x);return new a.Point((B/T+$[0])*C,(G/T+$[1])*C)}function og(g,o,h,x,T,C,R,D,B,G,$){const J=g.text.placedSymbolArray,oe=g.text.dynamicLayoutVertexArray,ce=g.icon.dynamicLayoutVertexArray,he={},de=g.getProjection(),me=Cr(D,de,C),Q=C.elevation,le=de.upVectorScale(D.canonical,C.center.lat,C.worldSize).metersToTile;oe.clear();for(let _e=0;_e<J.length;_e++){const ve=J.get(_e),{tileAnchorX:Ne,tileAnchorY:De,numGlyphs:Re}=ve,Ge=ve.hidden||!ve.crossTileID||g.allowVerticalPlacement&&!ve.placedOrientation?null:x[ve.crossTileID];if(Ge){let $e=0,Ye=0,At=0;if(Q){const It=Q?Q.getAtTileOffset(D,Ne,De):0,[en,_n,Wt]=de.upVector(D.canonical,Ne,De);$e=It*en*le,Ye=It*_n*le,At=It*Wt*le}let[qe,ct,Je,Ct]=Pi(ve.projectedAnchorX+$e,ve.projectedAnchorY+Ye,ve.projectedAnchorZ+At,h?me:R);const Ke=hp(C.getCameraToCenterDistance(de),Ct);let dt=T.evaluateSizeForFeature(g.textSizeData,G,ve)*Ke/a.ONE_EM;h&&(dt*=g.tilePixelRatio/B);const St=Kh(Ge,dt);h?({x:qe,y:ct,z:Je}=de.projectTilePoint(Ne+St.x,De+St.y,D.canonical),[qe,ct,Je]=Pi(qe+$e,ct+Ye,Je+At,R)):(o&&St._rotate(-C.angle),qe+=St.x,ct+=St.y,Je=0);const wt=g.allowVerticalPlacement&&ve.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let It=0;It<Re;It++)a.addDynamicAttributes(oe,qe,ct,Je,wt);$&&ve.associatedIconIndex>=0&&(he[ve.associatedIconIndex]={x:qe,y:ct,z:Je,angle:wt})}else js(Re,oe)}if($){ce.clear();const _e=g.icon.placedSymbolArray;for(let ve=0;ve<_e.length;ve++){const Ne=_e.get(ve),{numGlyphs:De}=Ne,Re=he[ve];if(Ne.hidden||!Re)js(De,ce);else{const{x:Ge,y:$e,z:Ye,angle:At}=Re;for(let qe=0;qe<De;qe++)a.addDynamicAttributes(ce,Ge,$e,Ye,At)}}g.icon.dynamicLayoutVertexBuffer.updateData(ce)}g.text.dynamicLayoutVertexBuffer.updateData(oe)}function Yh(g,o,h){return h.iconsInText&&o?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function xp(g,o,h,x,T,C,R,D,B,G,$,J){const oe=g.context,ce=oe.gl,he=g.transform,de=D==="map",me=B==="map",Q=de&&h.layout.get("symbol-placement")!=="point",le=de&&!me&&!Q,_e=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ve=!1;const Ne=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),De=[a.mercatorXfromLng(he.center.lng),a.mercatorYfromLat(he.center.lat)],Re=h.layout.get("text-variable-anchor"),Ge=he.projection.name==="globe",$e=[],Ye=[0,-1,0];let At=Ye;!Ge&&!he.mercatorFromTransition||de||(At=(function(qe){const ct=qe._camera.getWorldToCamera(qe.worldSize,1),Je=a.multiply([],ct,qe.globeMatrix);a.invert(Je,Je);const Ct=[0,0,0],Ke=[0,1,0,0];return a.transformMat4$1(Ke,Ke,Je),Ct[0]=Ke[0],Ct[1]=Ke[1],Ct[2]=Ke[2],a.normalize(Ct,Ct),Ct})(he));for(const qe of x){const ct=o.getTile(qe),Je=ct.getBucket(h);if(!Je||Je.projection.name==="mercator"&&Ge)continue;const Ct=T?Je.text:Je.icon;if(!Ct||Je.fullyClipped||!Ct.segments.get().length)continue;const Ke=Ct.programConfigurations.get(h.id),dt=T||Je.sdfIcons,St=T?Je.textSizeData:Je.iconSizeData,wt=me||he.pitch!==0,It=a.evaluateSizeForZoom(St,he.zoom);let en,_n,Wt,dn,jn=[0,0],Fn=null;if(T)_n=ct.glyphAtlasTexture,Wt=ce.LINEAR,en=ct.glyphAtlasTexture.size,Je.iconsInText&&(jn=ct.imageAtlasTexture.size,Fn=ct.imageAtlasTexture,dn=wt||g.options.rotating||g.options.zooming||St.kind==="composite"||St.kind==="camera"?ce.LINEAR:ce.NEAREST);else{const uo=h.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;_n=ct.imageAtlasTexture,Wt=dt||g.options.rotating||g.options.zooming||uo||wt?ce.LINEAR:ce.NEAREST,en=ct.imageAtlasTexture.size}const tn=Je.projection.name==="globe",Gn=tn?At:Ye,ar=tn?a.globeToMercatorTransition(he.zoom):0,lr=Cr(qe,Je.getProjection(),he),rr=he.calculatePixelsToTileUnitsMatrix(ct),Li=pt(lr,ct.tileID.canonical,me,de,he,Je.getProjection(),rr),$r=g.terrain&&me&&Q?a.invert(a.create(),Li):Xh,$s=ii(lr,ct.tileID.canonical,me,de,he,Je.getProjection(),rr),co=Re&&Je.hasTextData(),In=h.layout.get("icon-text-fit")!=="none"&&co&&Je.hasIconData();if(Q){const uo=he.elevation,ho=uo?uo.getAtTileOffsetFunc(qe,he.center.lat,he.worldSize,Je.getProjection()):null,Ao=bi(lr,ct.tileID.canonical,me,de,he,Je.getProjection(),rr);Xl(Je,lr,g,T,Ao,$s,me,G,ho,qe)}const pr=Q||T&&Re||In,er=g.translatePosMatrix(lr,ct,C,R),Gr=pr?Xh:Li,ji=g.translatePosMatrix($s,ct,C,R,!0),xr=Je.getProjection().createInversionMatrix(he,qe.canonical),hi=[];g.terrainRenderModeElevated()&&me&&hi.push("PITCH_WITH_MAP_TERRAIN"),tn&&hi.push("PROJECTION_GLOBE_VIEW"),pr&&hi.push("PROJECTED_POS_ON_VIEWPORT");const Dr=dt&&h.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Or;Or=dt?Je.iconsInText?_p(St.kind,It,le,me,g,er,Gr,ji,en,jn,qe,ar,De,xr,Gn,Je.getProjection()):pl(St.kind,It,le,me,g,er,Gr,ji,T,en,!0,qe,ar,De,xr,Gn,Je.getProjection()):qh(St.kind,It,le,me,g,er,Gr,ji,T,en,qe,ar,De,xr,Gn,Je.getProjection());const Kr={program:g.useProgram(Yh(dt,T,Je),Ke,hi),buffers:Ct,uniformValues:Or,atlasTexture:_n,atlasTextureIcon:Fn,atlasInterpolation:Wt,atlasInterpolationIcon:dn,isSDF:dt,hasHalo:Dr,tile:ct,labelPlaneMatrixInv:$r};if(_e&&Je.canOverlap){ve=!0;const uo=Ct.segments.get();for(const ho of uo)$e.push({segments:new a.SegmentVector([ho]),sortKey:ho.sortKey,state:Kr})}else $e.push({segments:Ct.segments,sortKey:0,state:Kr})}ve&&$e.sort(((qe,ct)=>qe.sortKey-ct.sortKey));for(const qe of $e){const ct=qe.state;if(g.terrain&&g.terrain.setupElevationDraw(ct.tile,ct.program,{useDepthForOcclusion:!Ge,labelPlaneMatrixInv:ct.labelPlaneMatrixInv}),oe.activeTexture.set(ce.TEXTURE0),ct.atlasTexture.bind(ct.atlasInterpolation,ce.CLAMP_TO_EDGE),ct.atlasTextureIcon&&(oe.activeTexture.set(ce.TEXTURE1),ct.atlasTextureIcon&&ct.atlasTextureIcon.bind(ct.atlasInterpolationIcon,ce.CLAMP_TO_EDGE)),ct.isSDF){const Je=ct.uniformValues;ct.hasHalo&&(Je.u_is_halo=1,fu(ct.buffers,qe.segments,h,g,ct.program,Ne,$,J,Je)),Je.u_is_halo=0}fu(ct.buffers,qe.segments,h,g,ct.program,Ne,$,J,ct.uniformValues)}}function fu(g,o,h,x,T,C,R,D,B){const G=x.context,$=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];T.draw(G,G.gl.TRIANGLES,C,R,D,a.CullFaceMode.disabled,B,h.id,g.layoutVertexBuffer,g.indexBuffer,o,h.paint,x.transform.zoom,g.programConfigurations.get(h.id),$)}function oo(g,o,h,x,T,C,R){const D=g.context.gl,B=h.paint.get("fill-pattern"),G=B&&B.constantOr(1);let $,J,oe,ce,he;R?(J=G&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=D.LINES):(J=G?"fillPattern":"fill",$=D.TRIANGLES);for(const de of x){const me=o.getTile(de);if(G&&!me.patternsLoaded())continue;const Q=me.getBucket(h);if(!Q)continue;g.prepareDrawTile();const le=Q.programConfigurations.get(h.id),_e=g.useProgram(J,le);G&&(g.context.activeTexture.set(D.TEXTURE0),me.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),le.updatePaintBuffers());const ve=B.constantOr(null);if(ve&&me.imageAtlas){const De=me.imageAtlas.patternPositions[ve.toString()];De&&le.setConstantPatternPositions(De)}const Ne=g.translatePosMatrix(de.projMatrix,me,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(R){ce=Q.indexBuffer2,he=Q.segments2;const De=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];oe=J==="fillOutlinePattern"&&G?Uh(Ne,g,me,De):sg(Ne,De)}else ce=Q.indexBuffer,he=Q.segments,oe=G?Vh(Ne,g,me):fl(Ne);g.prepareDrawProgram(g.context,_e,de.toUnwrapped()),_e.draw(g.context,$,T,g.stencilModeForClipping(de),C,a.CullFaceMode.disabled,oe,h.id,Q.layoutVertexBuffer,ce,he,h.paint,g.transform.zoom,le)}}function Ra(g,o,h,x,T,C,R){const D=g.context,B=D.gl,G=g.transform,$=h.paint.get("fill-extrusion-pattern"),J=$.constantOr(1),oe=h.paint.get("fill-extrusion-opacity"),ce=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],he=h.layout.get("fill-extrusion-edge-radius"),de=he>0&&!h.paint.get("fill-extrusion-rounded-roof"),me=de?0:he,Q=G.projection.name==="globe"?a.fillExtrusionHeightLift():0,le=G.projection.name==="globe",_e=le?a.globeToMercatorTransition(G.zoom):0,ve=[a.mercatorXfromLng(G.center.lng),a.mercatorYfromLat(G.center.lat)],Ne=[];le&&Ne.push("PROJECTION_GLOBE_VIEW"),ce[0]>0&&Ne.push("FAUX_AO"),de&&Ne.push("ZERO_ROOF_RADIUS");for(const De of x){const Re=o.getTile(De),Ge=Re.getBucket(h);if(!Ge||Ge.projection.name!==G.projection.name)continue;const $e=Ge.programConfigurations.get(h.id),Ye=g.useProgram(J?"fillExtrusionPattern":"fillExtrusion",$e,Ne);if(g.terrain){const dt=g.terrain;if(g.style.terrainSetForDrapingOnly())dt.setupElevationDraw(Re,Ye,{useMeterToDem:!0});else{if(!Ge.enableTerrain)continue;if(dt.setupElevationDraw(Re,Ye,{useMeterToDem:!0}),Jh(D,o,De,Ge,h,dt),!Ge.centroidVertexBuffer){const St=Ye.attributes.a_centroid_pos;St!==void 0&&B.vertexAttrib2f(St,0,0)}}}J&&(g.context.activeTexture.set(B.TEXTURE0),Re.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),$e.updatePaintBuffers());const At=$.constantOr(null);if(At&&Re.imageAtlas){const dt=Re.imageAtlas.patternPositions[At.toString()];dt&&$e.setConstantPatternPositions(dt)}const qe=g.translatePosMatrix(De.projMatrix,Re,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),ct=G.projection.createInversionMatrix(G,De.canonical),Je=h.paint.get("fill-extrusion-vertical-gradient"),Ct=J?yp(qe,g,Je,oe,ce,me,De,Re,Q,_e,ve,ct):Fh(qe,g,Je,oe,ce,me,De,Q,_e,ve,ct);g.prepareDrawProgram(D,Ye,De.toUnwrapped());const Ke=[];g.terrain&&Ke.push(Ge.centroidVertexBuffer),le&&Ke.push(Ge.layoutVertexExtBuffer),Ye.draw(D,D.gl.TRIANGLES,T,C,R,a.CullFaceMode.backCCW,Ct,h.id,Ge.layoutVertexBuffer,Ge.indexBuffer,Ge.segments,h.paint,g.transform.zoom,$e,Ke)}}function Jh(g,o,h,x,T,C){const R=[Q=>{let le=Q.canonical.x-1,_e=Q.wrap;return le<0&&(le=(1<<Q.canonical.z)-1,_e--),new a.OverscaledTileID(Q.overscaledZ,_e,Q.canonical.z,le,Q.canonical.y)},Q=>{let le=Q.canonical.x+1,_e=Q.wrap;return le===1<<Q.canonical.z&&(le=0,_e++),new a.OverscaledTileID(Q.overscaledZ,_e,Q.canonical.z,le,Q.canonical.y)},Q=>new a.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,(Q.canonical.y===0?1<<Q.canonical.z:Q.canonical.y)-1),Q=>new a.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,Q.canonical.y===(1<<Q.canonical.z)-1?0:Q.canonical.y+1)],D=Q=>{const le=o.getSource().minzoom,_e=Ne=>{const De=o.getTileByID(Ne);if(De&&De.hasData())return De.getBucket(T)},ve=[0,-1,1];for(const Ne of ve){if(Q.overscaledZ+Ne<le)continue;const De=_e(Q.calculateScaledKey(Q.overscaledZ+Ne));if(De)return De}},B=[0,0,0],G=(Q,le)=>(B[0]=Math.min(Q.min.y,le.min.y),B[1]=Math.max(Q.max.y,le.max.y),B[2]=a.EXTENT-le.min.x>Q.max.x?le.min.x-a.EXTENT:Q.max.x,B),$=(Q,le)=>(B[0]=Math.min(Q.min.x,le.min.x),B[1]=Math.max(Q.max.x,le.max.x),B[2]=a.EXTENT-le.min.y>Q.max.y?le.min.y-a.EXTENT:Q.max.y,B),J=[(Q,le)=>G(Q,le),(Q,le)=>G(le,Q),(Q,le)=>$(Q,le),(Q,le)=>$(le,Q)],oe=new a.Point(0,0);let ce,he,de;const me=(Q,le,_e,ve,Ne)=>{const De=[[ve?_e:Q,ve?Q:_e,0],[ve?_e:le,ve?le:_e,0]],Re=Ne<0?a.EXTENT+Ne:Ne,Ge=[ve?Re:(Q+le)/2,ve?(Q+le)/2:Re,0];return _e===0&&Ne<0||_e!==0&&Ne>0?C.getForTilePoints(de,[Ge],!0,he):De.push(Ge),C.getForTilePoints(h,De,!0,ce),Math.max(De[0][2],De[1][2],Ge[2])/C.exaggeration()};for(let Q=0;Q<4;Q++){const le=(Q<2?1:5)-Q,_e=x.borders[Q];if(_e.length===0)continue;const ve=de=R[Q](h),Ne=D(ve);if(!(Ne&&Ne instanceof a.FillExtrusionBucket&&Ne.enableTerrain)||x.borderDoneWithNeighborZ[Q]===Ne.canonical.z&&Ne.borderDoneWithNeighborZ[le]===x.canonical.z||(he=C.findDEMTileFor(ve),!he||!he.dem))continue;if(!ce){const $e=C.findDEMTileFor(h);if(!$e||!$e.dem)return;ce=$e}const De=Ne.borders[le];let Re=0;const Ge=Ne.borderDoneWithNeighborZ[le]!==x.canonical.z;if(x.canonical.z===Ne.canonical.z){for(let $e=0;$e<_e.length;$e++){const Ye=x.featuresOnBorder[_e[$e]],At=Ye.borders[Q];let qe;for(;Re<De.length&&(qe=Ne.featuresOnBorder[De[Re]],!(qe.borders[le][1]>At[0]+3));)Ge&&Ne.encodeCentroid(void 0,qe,!1),Re++;if(qe&&Re<De.length){const ct=Re;let Je=0;for(;!(qe.borders[le][0]>At[1]-3)&&(Je++,++Re!==De.length);)qe=Ne.featuresOnBorder[De[Re]];if(qe=Ne.featuresOnBorder[De[ct]],Ye.intersectsCount()>1||qe.intersectsCount()>1||Je!==1){Je!==1&&(Re=ct),x.encodeCentroid(void 0,Ye,!1),Ge&&Ne.encodeCentroid(void 0,qe,!1);continue}const Ct=J[Q](Ye,qe),Ke=Q%2?a.EXTENT-1:0;oe.x=me(Ct[0],Math.min(a.EXTENT-1,Ct[1]),Ke,Q<2,Ct[2]),oe.y=0,x.encodeCentroid(oe,Ye,!1),Ge&&Ne.encodeCentroid(oe,qe,!1)}else x.encodeCentroid(void 0,Ye,!1)}x.borderDoneWithNeighborZ[Q]=Ne.canonical.z,x.needsCentroidUpdate=!0,Ge&&(Ne.borderDoneWithNeighborZ[le]=x.canonical.z,Ne.needsCentroidUpdate=!0)}else{for(const $e of _e)x.encodeCentroid(void 0,x.featuresOnBorder[$e],!1);if(Ge){for(const $e of De)Ne.encodeCentroid(void 0,Ne.featuresOnBorder[$e],!1);Ne.borderDoneWithNeighborZ[le]=x.canonical.z,Ne.needsCentroidUpdate=!0}x.borderDoneWithNeighborZ[Q]=Ne.canonical.z,x.needsCentroidUpdate=!0}}(x.needsCentroidUpdate||!x.centroidVertexBuffer&&x.centroidVertexArray.length!==0)&&x.uploadCentroid(g)}const ml=new a.Color(1,0,0,1),vp=new a.Color(0,1,0,1),wp=new a.Color(0,0,1,1),Qh=new a.Color(1,0,1,1),ag=new a.Color(0,1,1,1);function lg(g,o,h){const x=g.context,T=g.transform,C=x.gl,R=T.projection.name==="globe",D=R?["PROJECTION_GLOBE_VIEW"]:null;let B=h.projMatrix;if(R&&a.globeToMercatorTransition(T.zoom)>0){const Ye=a.transitionTileAABBinECEF(h.canonical,T),At=a.globeDenormalizeECEF(Ye);B=a.multiply(new Float32Array(16),T.globeMatrix,At),a.multiply(B,T.projMatrix,B)}const G=g.useProgram("debug",null,D),$=o.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw($,G);const J=a.DepthMode.disabled,oe=a.StencilMode.disabled,ce=g.colorModeForRenderPass(),he="$debug";x.activeTexture.set(C.TEXTURE0),g.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),R?$._makeGlobeTileDebugBuffers(g.context,T):$._makeDebugTileBoundsBuffers(g.context,T.projection);const de=$._tileDebugBuffer||g.debugBuffer,me=$._tileDebugIndexBuffer||g.debugIndexBuffer,Q=$._tileDebugSegments||g.debugSegments;G.draw(x,C.LINE_STRIP,J,oe,ce,a.CullFaceMode.disabled,cu(B,a.Color.red),he,de,me,Q,null,null,null,[$._globeTileDebugBorderBuffer]);const le=$.latestRawTileData,_e=Math.floor((le&&le.byteLength||0)/1024),ve=o.getTile(h).tileSize,Ne=512/Math.min(ve,512)*(h.overscaledZ/T.zoom)*.5;let De=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(De+=` => ${h.overscaledZ}`),De+=` ${_e}kb`,(function(Ye,At){Ye.initDebugOverlayCanvas();const qe=Ye.debugOverlayCanvas,ct=Ye.context.gl,Je=Ye.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,qe.width,qe.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(At,5,5),Je.strokeText(At,5,5),Ye.debugOverlayTexture.update(qe),Ye.debugOverlayTexture.bind(ct.LINEAR,ct.CLAMP_TO_EDGE)})(g,De);const Re=$._tileDebugTextBuffer||g.debugBuffer,Ge=$._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,$e=$._tileDebugTextSegments||g.debugSegments;G.draw(x,C.TRIANGLES,J,oe,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,cu(B,a.Color.transparent,Ne),he,Re,Ge,$e,null,null,null,[$._globeTileDebugTextBuffer])}function gl(g,o,h,x){Wo(g,0,o+h/2,g.transform.width,h,x)}function lc(g,o,h,x){Wo(g,o-h/2,0,h,g.transform.height,x)}function Wo(g,o,h,x,T,C){const R=g.context,D=R.gl;D.enable(D.SCISSOR_TEST),D.scissor(o*a.exported.devicePixelRatio,h*a.exported.devicePixelRatio,x*a.exported.devicePixelRatio,T*a.exported.devicePixelRatio),R.clear({color:C}),D.disable(D.SCISSOR_TEST)}const gd=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:ef}=gd;function ao(g,o,h,x){g.emplaceBack(o,h,x)}class la{constructor(o){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,ao(this.vertexArray,-1,-1,1),ao(this.vertexArray,1,-1,1),ao(this.vertexArray,-1,1,1),ao(this.vertexArray,1,1,1),ao(this.vertexArray,-1,-1,-1),ao(this.vertexArray,1,-1,-1),ao(this.vertexArray,-1,1,-1),ao(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,ef),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function Ts(g,o,h,x,T,C){const R=g.gl,D=o.paint.get("sky-atmosphere-color"),B=o.paint.get("sky-atmosphere-halo-color"),G=o.paint.get("sky-atmosphere-sun-intensity"),$=((J,oe,ce,he,de)=>({u_matrix_3f:J,u_sun_direction:oe,u_sun_intensity:ce,u_color_tint_r:[he.r,he.g,he.b,he.a],u_color_tint_m:[de.r,de.g,de.b,de.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),x),T,G,D,B);R.framebufferTexture2D(R.FRAMEBUFFER,R.COLOR_ATTACHMENT0,R.TEXTURE_CUBE_MAP_POSITIVE_X+C,o.skyboxTexture,0),h.draw(g,R.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,$,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const cc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class pu{constructor(o){const h=new a.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const x=new a.StructArrayLayout3ui6;x.emplaceBack(0,1,2),x.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,cc.members),this.indexBuffer=o.createIndexBuffer(x),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Da={symbol:function(g,o,h,x,T){if(g.renderPass!=="translucent")return;const C=a.StencilMode.disabled,R=g.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&(function(D,B,G,$,J,oe,ce){const he=B.transform,de=J==="map",me=oe==="map";for(const Q of D){const le=$.getTile(Q),_e=le.getBucket(G);if(!_e||!_e.text||!_e.text.segments.get().length)continue;const ve=a.evaluateSizeForZoom(_e.textSizeData,he.zoom),Ne=Cr(Q,_e.getProjection(),he),De=he.calculatePixelsToTileUnitsMatrix(le),Re=pt(Ne,le.tileID.canonical,me,de,he,_e.getProjection(),De),Ge=G.layout.get("icon-text-fit")!=="none"&&_e.hasIconData();if(ve){const $e=Math.pow(2,he.zoom-le.tileID.overscaledZ);og(_e,de,me,ce,a.symbolSize,he,Re,Q,$e,ve,Ge)}}})(x,g,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),T),h.paint.get("icon-opacity").constantOr(1)!==0&&xp(g,o,h,x,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,R),h.paint.get("text-opacity").constantOr(1)!==0&&xp(g,o,h,x,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,R),o.map.showCollisionBoxes&&(ac(g,o,h,x,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),ac(g,o,h,x,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,h,x){if(g.renderPass!=="translucent")return;const T=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),R=h.paint.get("circle-stroke-opacity"),D=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)===0&&(C.constantOr(1)===0||R.constantOr(1)===0))return;const B=g.context,G=B.gl,$=g.transform,J=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),oe=a.StencilMode.disabled,ce=g.colorModeForRenderPass(),he=$.projection.name==="globe",de=[a.mercatorXfromLng($.center.lng),a.mercatorYfromLat($.center.lat)],me=[];for(let le=0;le<x.length;le++){const _e=x[le],ve=o.getTile(_e),Ne=ve.getBucket(h);if(!Ne||Ne.projection.name!==$.projection.name)continue;const De=Ne.programConfigurations.get(h.id),Re=hd(h);he&&Re.push("PROJECTION_GLOBE_VIEW");const Ge=g.useProgram("circle",De,Re),$e=Ne.layoutVertexBuffer,Ye=Ne.globeExtVertexBuffer,At=Ne.indexBuffer,qe=$.projection.createInversionMatrix($,_e.canonical),ct={programConfiguration:De,program:Ge,layoutVertexBuffer:$e,globeExtVertexBuffer:Ye,indexBuffer:At,uniformValues:$h(g,_e,ve,qe,de,h),tile:ve};if(D){const Je=Ne.segments.get();for(const Ct of Je)me.push({segments:new a.SegmentVector([Ct]),sortKey:Ct.sortKey,state:ct})}else me.push({segments:Ne.segments,sortKey:0,state:ct})}D&&me.sort(((le,_e)=>le.sortKey-_e.sortKey));const Q={useDepthForOcclusion:!he};for(const le of me){const{programConfiguration:_e,program:ve,layoutVertexBuffer:Ne,globeExtVertexBuffer:De,indexBuffer:Re,uniformValues:Ge,tile:$e}=le.state,Ye=le.segments;g.terrain&&g.terrain.setupElevationDraw($e,ve,Q),g.prepareDrawProgram(B,ve,$e.tileID.toUnwrapped()),ve.draw(B,G.TRIANGLES,J,oe,ce,a.CullFaceMode.disabled,Ge,h.id,Ne,Re,Ye,h.paint,$.zoom,_e,[De])}},heatmap:function(g,o,h,x){if(h.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const T=g.context,C=T.gl,R=a.StencilMode.disabled,D=new a.ColorMode([C.ONE,C.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ce,he,de,me){const Q=ce.gl,le=he.width*me,_e=he.height*me;ce.activeTexture.set(Q.TEXTURE1),ce.viewport.set([0,0,le,_e]);let ve=de.heatmapFbo;if(!ve||ve&&(ve.width!==le||ve.height!==_e)){ve&&ve.destroy();const Ne=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,Ne),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),ve=de.heatmapFbo=ce.createFramebuffer(le,_e,!1),(function(De,Re,Ge,$e,Ye,At){const qe=De.gl;qe.texImage2D(qe.TEXTURE_2D,0,De.isWebGL2&&De.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,Ye,At,0,qe.RGBA,De.extRenderToTextureHalfFloat?De.isWebGL2?qe.HALF_FLOAT:De.extTextureHalfFloat.HALF_FLOAT_OES:qe.UNSIGNED_BYTE,null),$e.colorAttachment.set(Ge)})(ce,0,Ne,ve,le,_e)}else Q.bindTexture(Q.TEXTURE_2D,ve.colorAttachment.get()),ce.bindFramebuffer.set(ve.framebuffer)})(T,g,h,g.transform.projection.name==="globe"?.5:.25),T.clear({color:a.Color.transparent});const B=g.transform,G=B.projection.name==="globe",$=G?["PROJECTION_GLOBE_VIEW"]:null,J=G?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,oe=[a.mercatorXfromLng(B.center.lng),a.mercatorYfromLat(B.center.lat)];for(let ce=0;ce<x.length;ce++){const he=x[ce];if(o.hasRenderableParent(he))continue;const de=o.getTile(he),me=de.getBucket(h);if(!me||me.projection.name!==B.projection.name)continue;const Q=me.programConfigurations.get(h.id),le=g.useProgram("heatmap",Q,$),{zoom:_e}=g.transform;g.terrain&&g.terrain.setupElevationDraw(de,le),g.prepareDrawProgram(T,le,he.toUnwrapped());const ve=B.projection.createInversionMatrix(B,he.canonical);le.draw(T,C.TRIANGLES,a.DepthMode.disabled,R,D,J,Hh(g,he,de,ve,oe,_e,h.paint.get("heatmap-intensity")),h.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,h.paint,g.transform.zoom,Q,G?[me.globeExtVertexBuffer]:null)}T.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),(function(T,C){const R=T.context,D=R.gl,B=C.heatmapFbo;if(!B)return;R.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,B.colorAttachment.get()),R.activeTexture.set(D.TEXTURE1);let G=C.colorRampTexture;G||(G=C.colorRampTexture=new a.Texture(R,C.colorRamp,D.RGBA)),G.bind(D.LINEAR,D.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(R,D.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,T.colorModeForRenderPass(),a.CullFaceMode.disabled,(($,J,oe,ce)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,C),C.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,C.paint,T.transform.zoom)})(g,h))},line:function(g,o,h,x){if(g.renderPass!=="translucent")return;const T=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(T.constantOr(1)===0||C.constantOr(1)===0)return;const R=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),D=g.colorModeForRenderPass(),B=g.terrain&&g.terrain.renderingToTexture?1:a.exported.devicePixelRatio,G=h.paint.get("line-dasharray"),$=G.constantOr(1),J=h.layout.get("line-cap"),oe=h.paint.get("line-pattern"),ce=oe.constantOr(1),he=h.paint.get("line-gradient"),de=ce?"linePattern":"line",me=g.context,Q=me.gl,le=(ve=>{const Ne=[];oc(ve)&&Ne.push("RENDER_LINE_DASH"),ve.paint.get("line-gradient")&&Ne.push("RENDER_LINE_GRADIENT");const De=ve.paint.get("line-trim-offset");De[0]===0&&De[1]===0||Ne.push("RENDER_LINE_TRIM_OFFSET");const Re=ve.paint.get("line-pattern").constantOr(1),Ge=ve.paint.get("line-opacity").constantOr(1)!==1;return!Re&&Ge&&Ne.push("RENDER_LINE_ALPHA_DISCARD"),Ne})(h);let _e=le.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(_e=!1);for(const ve of x){const Ne=o.getTile(ve);if(ce&&!Ne.patternsLoaded())continue;const De=Ne.getBucket(h);if(!De)continue;g.prepareDrawTile();const Re=De.programConfigurations.get(h.id),Ge=g.useProgram(de,Re,le),$e=oe.constantOr(null);if($e&&Ne.imageAtlas){const dt=Ne.imageAtlas.patternPositions[$e.toString()];dt&&Re.setConstantPatternPositions(dt)}const Ye=G.constantOr(null),At=J.constantOr(null);if(!ce&&Ye&&At&&Ne.lineAtlas){const dt=Ne.lineAtlas.getDash(Ye,At);dt&&Re.setConstantPatternPositions(dt)}let[qe,ct]=h.paint.get("line-trim-offset");(At==="round"||At==="square")&&qe!==ct&&(qe===0&&(qe-=1),ct===1&&(ct+=1));const Je=g.terrain?ve.projMatrix:null,Ct=ce?uu(g,Ne,h,Je,B):ic(g,Ne,h,Je,De.lineClipsArray.length,B,[qe,ct]);if(he){const dt=De.gradients[h.id];let St=dt.texture;if(h.gradientVersion!==dt.version){let wt=256;if(h.stepInterpolant){const It=o.getSource().maxzoom,en=ve.canonical.z===It?Math.ceil(1<<g.transform.maxZoom-ve.canonical.z):1;wt=a.clamp(a.nextPowerOfTwo(De.maxLineLength/a.EXTENT*1024*en),256,me.maxTextureSize)}dt.gradient=a.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:wt,image:dt.gradient||void 0,clips:De.lineClipsArray}),dt.texture?dt.texture.update(dt.gradient):dt.texture=new a.Texture(me,dt.gradient,Q.RGBA),dt.version=h.gradientVersion,St=dt.texture}me.activeTexture.set(Q.TEXTURE1),St.bind(h.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}$&&(me.activeTexture.set(Q.TEXTURE0),Ne.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Re.updatePaintBuffers()),ce&&(me.activeTexture.set(Q.TEXTURE0),Ne.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Re.updatePaintBuffers()),g.prepareDrawProgram(me,Ge,ve.toUnwrapped());const Ke=dt=>{Ge.draw(me,Q.TRIANGLES,R,dt,D,a.CullFaceMode.disabled,Ct,h.id,De.layoutVertexBuffer,De.indexBuffer,De.segments,h.paint,g.transform.zoom,Re,[De.layoutVertexBuffer2])};if(_e){const dt=g.stencilModeForClipping(ve).ref;dt===0&&g.terrain&&me.clear({stencil:0});const St={func:Q.EQUAL,mask:255};Ct.u_alpha_discard_threshold=.8,Ke(new a.StencilMode(St,dt,255,Q.KEEP,Q.KEEP,Q.INVERT)),Ct.u_alpha_discard_threshold=0,Ke(new a.StencilMode(St,dt,255,Q.KEEP,Q.KEEP,Q.KEEP))}else Ke(g.stencilModeForClipping(ve))}_e&&(g.resetStencilClippingMasks(),g.terrain&&me.clear({stencil:0}))},fill:function(g,o,h,x){const T=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(C.constantOr(1)===0)return;const R=g.colorModeForRenderPass(),D=h.paint.get("fill-pattern"),B=g.opaquePassEnabledForLayer()&&!D.constantOr(1)&&T.constantOr(a.Color.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===B){const G=g.depthModeForSublayer(1,g.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);oo(g,o,h,x,G,R,!1)}if(g.renderPass==="translucent"&&h.paint.get("fill-antialias")){const G=g.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);oo(g,o,h,x,G,R,!0)}},"fill-extrusion":function(g,o,h,x){const T=h.paint.get("fill-extrusion-opacity");if(T!==0&&g.renderPass==="translucent"){const C=new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);if(T!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Ra(g,o,h,x,C,a.StencilMode.disabled,a.ColorMode.disabled),Ra(g,o,h,x,C,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const R=g.colorModeForRenderPass();Ra(g,o,h,x,C,a.StencilMode.disabled,R)}}},hillshade:function(g,o,h,x){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const T=g.context,C=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),R=g.colorModeForRenderPass(),D=g.terrain&&g.terrain.renderingToTexture,[B,G]=g.renderPass!=="translucent"||D?[{},x]:g.stencilConfigForOverlap(x);for(const $ of G){const J=o.getTile($);if(J.needsHillshadePrepare&&g.renderPass==="offscreen")ad(g,J,h,C,a.StencilMode.disabled,R);else if(g.renderPass==="translucent"){const oe=D&&g.terrain?g.terrain.stencilModeForRTTOverlap($):B[$.overscaledZ];pp(g,$,J,h,C,oe,R)}}T.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,h,x,T,C){if(g.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!x.length)return;const R=g.context,D=R.gl,B=o.getSource(),G=g.useProgram("raster"),$=g.colorModeForRenderPass(),J=g.terrain&&g.terrain.renderingToTexture,[oe,ce]=B instanceof An||J?[{},x]:g.stencilConfigForOverlap(x),he=ce[ce.length-1].overscaledZ,de=!g.options.moving;for(const me of ce){const Q=J?a.DepthMode.disabled:g.depthModeForSublayer(me.overscaledZ-he,h.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,D.LESS),le=me.toUnwrapped(),_e=o.getTile(me);if(J&&(!_e||!_e.hasData()))continue;const ve=J?me.projMatrix:g.transform.calculateProjMatrix(le,de),Ne=g.terrain&&J?g.terrain.stencilModeForRTTOverlap(me):oe[me.overscaledZ],De=C?0:h.paint.get("raster-fade-duration");_e.registerFadeDuration(De);const Re=o.findLoadedParent(me,0),Ge=zh(_e,Re,o,g.transform,De);let $e,Ye;g.terrain&&g.terrain.prepareDrawTile();const At=h.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;R.activeTexture.set(D.TEXTURE0),_e.texture.bind(At,D.CLAMP_TO_EDGE),R.activeTexture.set(D.TEXTURE1),Re?(Re.texture.bind(At,D.CLAMP_TO_EDGE),$e=Math.pow(2,Re.tileID.overscaledZ-_e.tileID.overscaledZ),Ye=[_e.tileID.canonical.x*$e%1,_e.tileID.canonical.y*$e%1]):_e.texture.bind(At,D.CLAMP_TO_EDGE),_e.texture.useMipmap&&R.extTextureFilterAnisotropic&&g.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,R.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,R.extTextureFilterAnisotropicMax);const qe=pd(ve,Ye||[0,0],$e||1,Ge,h,B instanceof An?B.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(R,G,le),B instanceof An)B.boundsBuffer&&B.boundsSegments&&G.draw(R,D.TRIANGLES,Q,a.StencilMode.disabled,$,a.CullFaceMode.disabled,qe,h.id,B.boundsBuffer,g.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:ct,tileBoundsIndexBuffer:Je,tileBoundsSegments:Ct}=g.getTileBoundsBuffers(_e);G.draw(R,D.TRIANGLES,Q,Ne,$,a.CullFaceMode.disabled,qe,h.id,ct,Je,Ct)}}g.resetStencilClippingMasks()},background:function(g,o,h,x){const T=h.paint.get("background-color"),C=h.paint.get("background-opacity");if(C===0)return;const R=g.context,D=R.gl,B=g.transform,G=B.tileSize,$=h.paint.get("background-pattern");if(g.isPatternMissing($))return;const J=!$&&T.a===1&&C===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==J)return;const oe=a.StencilMode.disabled,ce=g.depthModeForSublayer(0,J==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),he=g.colorModeForRenderPass(),de=g.useProgram($?"backgroundPattern":"background");let me,Q=x;Q||(me=g.getBackgroundTiles(),Q=Object.values(me).map((le=>le.tileID))),$&&(R.activeTexture.set(D.TEXTURE0),g.imageManager.bind(g.context));for(const le of Q){const _e=le.toUnwrapped(),ve=x?le.projMatrix:g.transform.calculateProjMatrix(_e);g.prepareDrawTile();const Ne=o?o.getTile(le):me?me[le.key]:new a.Tile(le,G,B.zoom,g),De=$?Zh(ve,C,g,$,{tileID:le,tileSize:G}):md(ve,C,T);g.prepareDrawProgram(R,de,_e);const{tileBoundsBuffer:Re,tileBoundsIndexBuffer:Ge,tileBoundsSegments:$e}=g.getTileBoundsBuffers(Ne);de.draw(R,D.TRIANGLES,ce,oe,he,a.CullFaceMode.disabled,De,h.id,Re,Ge,$e)}},sky:function(g,o,h){const x=g.transform,T=x.projection.name==="mercator"||x.projection.name==="globe"?1:a.smoothstep(7,8,x.zoom),C=h.paint.get("sky-opacity")*T;if(C===0)return;const R=g.context,D=h.paint.get("sky-type"),B=new a.DepthMode(R.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),G=g.frameCounter/1e3%1;D==="atmosphere"?g.renderPass==="offscreen"?h.needsSkyboxCapture(g)&&((function($,J,oe,ce){const he=$.context,de=he.gl;let me=J.skyboxFbo;if(!me){me=J.skyboxFbo=he.createFramebuffer(32,32,!1),J.skyboxGeometry=new la(he),J.skyboxTexture=he.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,J.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let ve=0;ve<6;++ve)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}he.bindFramebuffer.set(me.framebuffer),he.viewport.set([0,0,32,32]);const Q=J.getCenter($,!0),le=$.useProgram("skyboxCapture"),_e=new Float64Array(16);a.identity(_e),a.rotateY(_e,_e,.5*-Math.PI),Ts(he,J,le,_e,Q,0),a.identity(_e),a.rotateY(_e,_e,.5*Math.PI),Ts(he,J,le,_e,Q,1),a.identity(_e),a.rotateX(_e,_e,.5*-Math.PI),Ts(he,J,le,_e,Q,2),a.identity(_e),a.rotateX(_e,_e,.5*Math.PI),Ts(he,J,le,_e,Q,3),a.identity(_e),Ts(he,J,le,_e,Q,4),a.identity(_e),a.rotateY(_e,_e,Math.PI),Ts(he,J,le,_e,Q,5),he.viewport.set([0,0,$.width,$.height])})(g,h),h.markSkyboxValid(g)):g.renderPass==="sky"&&(function($,J,oe,ce,he){const de=$.context,me=de.gl,Q=$.transform,le=$.useProgram("skybox");de.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,J.skyboxTexture);const _e=((ve,Ne,De,Re,Ge)=>({u_matrix:ve,u_sun_direction:Ne,u_cubemap:0,u_opacity:Re,u_temporal_offset:Ge}))(Q.skyboxMatrix,J.getCenter($,!1),0,ce,he);$.prepareDrawProgram(de,le),le.draw(de,me.TRIANGLES,oe,a.StencilMode.disabled,$.colorModeForRenderPass(),a.CullFaceMode.backCW,_e,"skybox",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)})(g,h,B,C,G):D==="gradient"&&g.renderPass==="sky"&&(function($,J,oe,ce,he){const de=$.context,me=de.gl,Q=$.transform,le=$.useProgram("skyboxGradient");J.skyboxGeometry||(J.skyboxGeometry=new la(de)),de.activeTexture.set(me.TEXTURE0);let _e=J.colorRampTexture;_e||(_e=J.colorRampTexture=new a.Texture(de,J.colorRamp,me.RGBA)),_e.bind(me.LINEAR,me.CLAMP_TO_EDGE);const ve=((Ne,De,Re,Ge,$e)=>({u_matrix:Ne,u_color_ramp:0,u_center_direction:De,u_radius:a.degToRad(Re),u_opacity:Ge,u_temporal_offset:$e}))(Q.skyboxMatrix,J.getCenter($,!1),J.paint.get("sky-gradient-radius"),ce,he);$.prepareDrawProgram(de,le),le.draw(de,me.TRIANGLES,oe,a.StencilMode.disabled,$.colorModeForRenderPass(),a.CullFaceMode.backCW,ve,"skyboxGradient",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)})(g,h,B,C,G)},debug:function(g,o,h){for(let x=0;x<h.length;x++)lg(g,o,h[x])},custom:function(g,o,h,x){const T=g.context,C=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&h.isLayerDraped()){if(g.renderPass==="offscreen"){const R=C.prerender;if(R){if(g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;R.call(C,T.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else R.call(C,T.gl,g.transform.customLayerMatrix());T.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const D=C.renderToTile;if(D){const B=x[0].canonical,G=new a.MercatorCoordinate(B.x+x[0].wrap*(1<<B.z),B.y,B.z);T.setDepthMode(a.DepthMode.disabled),T.setStencilMode(a.StencilMode.disabled),T.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),D.call(C,T.gl,G),T.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),T.setStencilMode(a.StencilMode.disabled);const R=C.renderingMode==="3d"?new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(T.setDepthMode(R),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;C.render(T.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else C.render(T.gl,g.transform.customLayerMatrix());T.setDirty(),g.setBaseState(),T.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class yl{constructor(o,h,x=!1){this.context=new Et(o,x),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,h){const x=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(x||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Bh(this,o));const T=this._terrain;this.transform.elevation=x?T:null,T.update(o,this.transform,h)}_updateFog(o){const h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[x,T]=h.getFovAdjustedRange(this.transform._fov);if(x>T)return void(this.transform.fogCullDistSq=null);const C=x+.78*(T-x);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,h){if(this.width=o*a.exported.devicePixelRatio,this.height=h*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const x of this.style.order)this.style._layers[x].resize()}setup(){const o=this.context,h=new a.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(a.EXTENT,0),h.emplaceBack(0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const x=new a.StructArrayLayout2i4;x.emplaceBack(0,0),x.emplaceBack(a.EXTENT,0),x.emplaceBack(0,a.EXTENT),x.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=o.createVertexBuffer(x,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const T=new a.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(T,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const C=new a.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(a.EXTENT,0,a.EXTENT,0),C.emplaceBack(0,a.EXTENT,0,a.EXTENT),C.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(C,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const R=new a.StructArrayLayout3ui6;R.emplaceBack(0,1,2),R.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(R);const D=new a.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])D.emplaceBack(G);this.debugIndexBuffer=o.createIndexBuffer(D),this.emptyTexture=new a.Texture(o,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=a.create();const B=this.context.gl;this.stencilClearMode=new a.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new pu(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,h.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,su(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,x){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!x||x.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const B of x)if(this._tileClippingMaskIDs[B.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=h.id;const T=this.context,C=T.gl;this.nextStencilID+x.length>256&&this.clearStencil(),T.setColorMode(a.ColorMode.disabled),T.setDepthMode(a.DepthMode.disabled);const R=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of x){const B=h.getTile(D),G=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:J,tileBoundsSegments:oe}=this.getTileBoundsBuffers(B);R.draw(T,C.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:C.ALWAYS,mask:0},G,255,C.KEEP,C.KEEP,C.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,su(D.projMatrix),"$clipping",$,J,oe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new a.StencilMode({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const h=this.context.gl;return new a.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,x=o.sort(((R,D)=>D.overscaledZ-R.overscaledZ)),T=x[x.length-1].overscaledZ,C=x[0].overscaledZ-T+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const R={};for(let D=0;D<C;D++)R[D+T]=new a.StencilMode({func:h.GEQUAL,mask:255},D+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=C,[R,x]}return[{[T]:a.StencilMode.disabled},x]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([o.CONSTANT_COLOR,o.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(o,h,x){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new a.DepthMode(x||this.context.gl.LEQUAL,h,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const x=this.style.order,T=this.style._sourceCaches;for(const G in T){const $=T[G];$.used&&$.prepare(this.context)}const C={},R={},D={};for(const G in T){const $=T[G];C[G]=$.getVisibleCoordinates(),R[G]=C[G].slice().reverse(),D[G]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<x.length;G++)if(this.style._layers[x[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(D),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of x){const $=this.style._layers[G],J=o._getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const oe=J?R[J.id]:void 0;($.type==="custom"||$.isSky()||oe&&oe.length)&&this.renderLayer(this,J,$,oe)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const B=this.terrain;if(B&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&B.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=x.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[x[this.currentLayer]],$=o._getLayerSourceCache(G);if(G.isSky())continue;const J=$?R[$.id]:void 0;this._renderTileClippingMasks(G,$,J),this.renderLayer(this,$,G,J)}if(this.style.fog&&this.transform.projection.supportsFog&&(function(G,$){const J=G.context,oe=J.gl,ce=G.transform,he=new a.DepthMode(oe.LEQUAL,a.DepthMode.ReadOnly,[0,1]),de=G.useProgram("globeAtmosphere",null,ce.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),me=a.globeToMercatorTransition(ce.zoom),Q=$.properties.get("color").toArray01(),le=$.properties.get("high-color").toArray01(),_e=$.properties.get("space-color").toArray01PremultipliedAlpha(),ve=a.identity$1([]);a.rotateY$1(ve,ve,-a.degToRad(ce._center.lng)),a.rotateX$1(ve,ve,a.degToRad(ce._center.lat)),a.rotateZ$1(ve,ve,ce.angle),a.rotateX$1(ve,ve,-ce._pitch);const Ne=a.fromQuat(new Float32Array(16),ve),De=a.mapValue($.properties.get("star-intensity"),0,1,0,.25),Re=5e-4,Ge=a.mapValue($.properties.get("horizon-blend"),0,1,Re,.25),$e=a.globeUseCustomAntiAliasing(G,J,ce)&&Ge===Re?ce.worldSize/(2*Math.PI*1.025)-1:ce.globeRadius,Ye=G.frameCounter/1e3%1,At=a.length(ce.globeCenterInViewSpace),qe=Math.sqrt(Math.pow(At,2)-Math.pow($e,2)),ct=Math.acos(qe/At),Je=((Ke,dt,St,wt,It,en,_n,Wt,dn,jn,Fn,tn,Gn,ar)=>({u_frustum_tl:Ke,u_frustum_tr:dt,u_frustum_br:St,u_frustum_bl:wt,u_horizon:It,u_transition:en,u_fadeout_range:_n,u_color:Wt,u_high_color:dn,u_space_color:jn,u_star_intensity:Fn,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:tn,u_horizon_angle:Gn,u_rotation_matrix:ar}))(ce.frustumCorners.TL,ce.frustumCorners.TR,ce.frustumCorners.BR,ce.frustumCorners.BL,ce.frustumCorners.horizon,me,Ge,Q,le,_e,De,Ye,ct,Ne);G.prepareDrawProgram(J,de);const Ct=G.atmosphereBuffer;Ct&&de.draw(J,oe.TRIANGLES,he,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,Je,"skybox",Ct.vertexBuffer,Ct.indexBuffer,Ct.segments)})(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<x.length;this.currentLayer++){const G=this.style._layers[x[this.currentLayer]],$=o._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,$,G,$?R[$.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<x.length;){const G=this.style._layers[x[this.currentLayer]],$=o._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const J=$?(G.type==="symbol"?D:R)[$.id]:void 0;this._renderTileClippingMasks(G,$,$?C[$.id]:void 0),this.renderLayer(this,$,G,J),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;a.values(this.style._layers).forEach(($=>{const J=o._getLayerSourceCache($);J&&!$.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<J.getSource().maxzoom)&&(G=J)})),G&&this.options.showTileBoundaries&&Da.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&(function(G){const $=G.transform.padding;gl(G,G.transform.height-($.top||0),3,ml),gl(G,$.bottom||0,3,vp),lc(G,$.left||0,3,wp),lc(G,G.transform.width-($.right||0),3,Qh);const J=G.transform.centerPoint;(function(oe,ce,he,de){Wo(oe,ce-1,he-10,2,20,de),Wo(oe,ce-10,he-1,20,2,de)})(G,J.x,G.transform.height-J.y,ag)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,h,x,T){x.isHidden(this.transform.zoom)||(x.type==="background"||x.type==="sky"||x.type==="custom"||T&&T.length)&&(this.id=x.id,this.gpuTimingStart(x),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(x.type)||o.terrain&&x.type==="custom")&&Da[x.type](o,h,x,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let x=this.gpuTimers[o.id];x||(x=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),x.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,x.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,h=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),o.beginQueryEXT(o.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const h={};for(const x in o){const T=o[x],C=this.context.extTimerQuery,R=C.getQueryObjectEXT(T.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(T.query),h[x]=R}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let x=0;for(const T of o)x+=h.getQueryObjectEXT(T,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(T);return x}translatePosMatrix(o,h,x,T,C){if(!x[0]&&!x[1])return o;const R=C?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(R){const G=Math.sin(R),$=Math.cos(R);x=[x[0]*$-x[1]*G,x[0]*G+x[1]*$]}const D=[C?x[0]:Fe(h,x[0],this.transform.zoom),C?x[1]:Fe(h,x[1],this.transform.zoom),0],B=new Float32Array(16);return a.translate(B,o,D),B}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,x=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),this.transform.projection.name==="globe"&&T.push("GLOBE"),h&&T.push("ZERO_EXAGGERATION"),x&&!o&&x.getOpacity(this.transform.pitch)!==0&&T.push("FOG"),o&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(o,h,x){this.cache=this.cache||{};const T=x||[],C=this.currentGlobalDefines().concat(T),R=Yn.cacheKey(iu[o],o,C,h);return this.cache[R]||(this.cache[R]=new Yn(this.context,o,iu[o],h,du[o],C)),this.cache[R]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,h,x){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const C=T.getOpacity(this.transform.pitch),R=((D,B,G,$,J,oe,ce,he,de,me,Q)=>{const le=D.transform,_e=B.properties.get("color").toArray01();_e[3]=$;const ve=D.frameCounter/1e3%1;return{u_fog_matrix:G?le.calculateFogTileMatrix(G):D.identityMat,u_fog_range:B.getFovAdjustedRange(le._fov),u_fog_color:_e,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:ve,u_frustum_tl:J,u_frustum_tr:oe,u_frustum_br:ce,u_frustum_bl:he,u_globe_pos:de,u_globe_radius:me,u_viewport:Q,u_globe_transition:a.globeToMercatorTransition(le.zoom),u_is_globe:+(le.projection.name==="globe")}})(this,T,x,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);h.setFogUniformValues(o,R)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,h=this._backgroundTiles={},x=this.transform.coveringTiles({tileSize:512});for(const T of x)h[T.key]=o[T.key]||new a.Tile(T,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class mu{constructor(o=0,h=0,x=0,T=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(x)||x<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=x,this.right=T}interpolate(o,h,x){return h.top!=null&&o.top!=null&&(this.top=a.number(o.top,h.top,x)),h.bottom!=null&&o.bottom!=null&&(this.bottom=a.number(o.bottom,h.bottom,x)),h.left!=null&&o.left!=null&&(this.left=a.number(o.left,h.left,x)),h.right!=null&&o.right!=null&&(this.right=a.number(o.right,h.right,x)),this}getCenter(o,h){const x=a.clamp((this.left+o-this.right)/2,0,o),T=a.clamp((this.top+h-this.bottom)/2,0,h);return new a.Point(x,T)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new mu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gu(g,o){const h=a.getColumn(g,3);a.fromQuat(g,o),a.setColumn(g,3,h)}function Qn(g,o){const h=a.identity$1([]);return a.rotateZ$1(h,h,-o),a.rotateX$1(h,h,-g),h}function uc(g,o){const h=[g[0],g[1],0],x=[o[0],o[1],0];if(a.length(h)>=1e-15){const R=a.normalize([],h);a.scale$2(x,R,a.dot(x,R)),o[0]=x[0],o[1]=x[1]}const T=a.cross([],o,g);if(a.len(T)<1e-15)return null;const C=Math.atan2(-T[1],T[0]);return Qn(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),C)}class ca{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){const h=o instanceof a.MercatorCoordinate?o:new a.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=a.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;const x=this.position,T=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(o)):0,C=a.MercatorCoordinate.fromLngLat(o,T),R=[C.x-x.x,C.y-x.y,C.z-x.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=uc(R,h)}setPitchBearing(o,h){this.orientation=Qn(a.degToRad(o),a.degToRad(-h))}}class dc{constructor(o,h){this._transform=a.identity([]),this.orientation=h,this.position=o}get mercatorPosition(){const o=this.position;return new a.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=a.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&a.setColumn(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||a.identity$1([]),o&&gu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=Qn(o,h),gu(this._transform,this._orientation)}forward(){const o=a.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){const x=new Float64Array(16);return a.invert(x,this.getWorldToCamera(o,h)),x}getWorldToCameraPosition(o,h,x){const T=this.position;a.scale$2(T,T,-o);const C=new Float64Array(16);return a.fromScaling(C,[x,x,x]),a.translate(C,C,T),C[10]*=h,C}getWorldToCamera(o,h){const x=new Float64Array(16),T=new Float64Array(4),C=this.position;return a.conjugate(T,this._orientation),a.scale$2(C,C,-o),a.fromQuat(x,T),a.translate(x,x,C),x[1]*=-1,x[5]*=-1,x[9]*=-1,x[13]*=-1,x[8]*=h,x[9]*=h,x[10]*=h,x[11]*=h,x}getCameraToClipPerspective(o,h,x,T){const C=new Float64Array(16);return a.perspective(C,o,h,x,T),C}getDistanceToElevation(o,h=!1){const x=o===0?0:a.mercatorZfromAltitude(o,h?a.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(x-this.position[2])/T[2]}clone(){return new dc([...this.position],[...this.orientation])}}function La(g,o){const h=yd(g.projection,g.zoom,g.width,g.height),x=(function(C,R,D,B,G){const $=new a.LngLat(D.lng-180*Fs,D.lat),J=new a.LngLat(D.lng+180*Fs,D.lat),oe=C.project($.lng,$.lat),ce=C.project(J.lng,J.lat),he=-Math.atan2(ce.y-oe.y,ce.x-oe.x),de=a.MercatorCoordinate.fromLngLat(D);de.y=a.clamp(de.y,-1+Fs,1-Fs);const me=de.toLngLat(),Q=C.project(me.lng,me.lat),le=a.MercatorCoordinate.fromLngLat(me);le.x+=Fs;const _e=le.toLngLat(),ve=C.project(_e.lng,_e.lat),Ne=yu(ve.x-Q.x,ve.y-Q.y,he),De=a.MercatorCoordinate.fromLngLat(me);De.y+=Fs;const Re=De.toLngLat(),Ge=C.project(Re.lng,Re.lat),$e=yu(Ge.x-Q.x,Ge.y-Q.y,he),Ye=Math.abs(Ne.x)/Math.abs($e.y),At=a.identity([]);a.rotateZ(At,At,-he*(1-(G?0:B)));const qe=a.identity([]);return a.scale(qe,qe,[1,1-(1-Ye)*B,1]),qe[4]=-$e.x/$e.y*B,a.rotateZ(qe,qe,he),a.multiply(qe,At,qe),qe})(g.projection,0,g.center,h,o),T=bp(g);return a.scale(x,x,[T,T,1]),x}function bp(g){const o=g.projection,h=yd(g.projection,g.zoom,g.width,g.height),x=Tp(o,g.center),T=Tp(o,a.LngLat.convert(o.center));return Math.pow(2,x*h+(1-h)*T)}function yd(g,o,h,x,T=1/0){const C=g.range;if(!C)return 0;const R=Math.min(T,Math.max(h,x)),D=Math.log(R/1024)/Math.LN2;return a.smoothstep(C[0]+D,C[1]+D,o)}const Fs=1/4e4;function Tp(g,o){const h=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),x=new a.LngLat(o.lng-180*Fs,h),T=new a.LngLat(o.lng+180*Fs,h),C=g.project(x.lng,h),R=g.project(T.lng,h),D=a.MercatorCoordinate.fromLngLat(x),B=a.MercatorCoordinate.fromLngLat(T),G=R.x-C.x,$=R.y-C.y,J=B.x-D.x,oe=B.y-D.y,ce=Math.sqrt((J*J+oe*oe)/(G*G+$*$));return Math.log(ce)/Math.LN2}function yu(g,o,h){const x=Math.cos(h),T=Math.sin(h);return{x:g*x-o*T,y:g*T+o*x}}class _l{constructor(o,h,x,T,C,R,D){this.tileSize=512,this._renderWorldCopies=C===void 0||C,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=x??0,this._maxPitch=T??60,this.setProjection(R),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new mu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new dc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new _l(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,h=!1){const x=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||x)&&this._updateCameraOnTerrain(),(o||x)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const x=!k(h,this.getProjection());return x&&this._calcMatrices(),this.mercatorFromTransition=!1,x}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const h=-o*Math.PI/180;var x;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(x=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(x[1]=0,x[2]=0),x[0]=1,x[3]=1,x),(function(T,C,R){var D=C[0],B=C[1],G=C[2],$=C[3],J=Math.sin(R),oe=Math.cos(R);T[0]=D*oe+G*J,T[1]=B*oe+$*J,T[2]=D*-J+G*oe,T[3]=B*-J+$*oe})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=a.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=a.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],x=this.horizonLineFromTop();let T=0,C=0;for(let R=0;R<h.length;R++){const D=new a.Point(h[R][0]*this.width,x+h[R][1]*(this.height-x)),B=o.pointCoordinate(D);if(!B)continue;const G=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);T+=B[3]*G,C+=G}return C===0?NaN:T/C}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),x=this.pixelsPerMeter/this.worldSize*h,T=this._mercatorZfromZoom(o),C=this._mercatorZfromZoom(this._maxZoom),R=Math.max(T-x,C);this._setZoom(this._zoomFromMercatorZ(R))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let x;x=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];const T=a.length(a.sub([],this._camera.position,x));return a.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!a.exactEquals(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){const x=[o.position.x,o.position.y,o.position.z];a.exactEquals$1(x,this._camera.position)||(this._setCameraPosition(x),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,h=new ca;return h.position=new a.MercatorCoordinate(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!a.length$1(o))return!1;a.normalize$1(o,o);const h=a.transformQuat([],[0,0,-1],o),x=a.transformQuat([],[0,-1,0],o);if(x[2]<0)return!1;const T=uc(h,x);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(o){const h=this.zoomScale(this.minZoom)*this.tileSize,x=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;o[2]=a.clamp(o[2],T/x,T/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,x){this._unmodified=!1,this._edgeInsets.interpolate(o,h,x),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new a.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const x=this.pointCoordinate(new a.Point(0,0)),T=this.pointCoordinate(new a.Point(this.width,0)),C=this.pointCoordinate(new a.Point(this.width,this.height)),R=this.pointCoordinate(new a.Point(0,this.height)),D=Math.floor(Math.min(x.x,T.x,C.x,R.x)),B=Math.floor(Math.max(x.x,T.x,C.x,R.x)),G=1;for(let $=D-G;$<=B+G;$++)$!==0&&h.push(new a.UnwrappedTileID($,o))}return h}coveringTiles(o){let h=this.coveringZoomLevel(o);const x=h,T=this.elevation&&!o.isTerrainDEM,C=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const R=this.locationCoordinate(this.center),D=this.center.lat,B=1<<h,G=[B*R.x,B*R.y,0],$=this.projection.name==="globe",J=!$,oe=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,J),ce=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),he=B*a.mercatorZfromAltitude(1,this.center.lat),de=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),me=[B*ce.x,B*ce.y,de*(J?1:he)],Q=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,_e=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ve=o.isTerrainDEM?-_e:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ne=this.projection.isReprojectedInTileSpace?bp(this):1,De=Ke=>{const St=new a.MercatorCoordinate(Ke.x+25e-6,Ke.y,Ke.z),wt=new a.MercatorCoordinate(Ke.x,Ke.y+25e-6,Ke.z),It=Ke.toLngLat(),en=St.toLngLat(),_n=wt.toLngLat(),Wt=this.locationCoordinate(It),dn=this.locationCoordinate(en),jn=this.locationCoordinate(_n),Fn=Math.hypot(dn.x-Wt.x,dn.y-Wt.y),tn=Math.hypot(jn.x-Wt.x,jn.y-Wt.y);return Math.sqrt(Fn*tn)*Ne/25e-6},Re=Ke=>{const dt=_e,St=ve;return{aabb:a.tileAABB(this,B,0,0,0,Ke,St,dt,this.projection),zoom:0,x:0,y:0,minZ:St,maxZ:dt,wrap:Ke,fullyVisible:!1}},Ge=[];let $e=[];const Ye=h,At=o.reparseOverscaled?x:h,qe=Ke=>Ke*Ke,ct=qe((de-this._centerAltitude)*he),Je=Ke=>{if(!this._elevation||!Ke.tileID||!C)return;const dt=this._elevation.getMinMaxForTile(Ke.tileID),St=Ke.aabb;dt?(St.min[2]=dt.min,St.max[2]=dt.max,St.center[2]=(St.min[2]+St.max[2])/2):(Ke.shouldSplit=Ct(Ke),Ke.shouldSplit||(St.min[2]=St.max[2]=St.center[2]=this._centerAltitude))},Ct=Ke=>{if(Ke.zoom<le)return!0;if(Ke.zoom===Ye)return!1;if(Ke.shouldSplit!=null)return Ke.shouldSplit;const dt=Ke.aabb.distanceX(me),St=Ke.aabb.distanceY(me);let wt=ct,It=1;if($){wt=qe(Ke.aabb.distanceZ(me));const Wt=Math.pow(2,Ke.zoom),dn=a.latFromMercatorY((Ke.y+1)/Wt),jn=a.latFromMercatorY(Ke.y/Wt),Fn=Math.min(Math.max(D,dn),jn),tn=a.circumferenceAtLatitude(Fn)/a.circumferenceAtLatitude(D);if(It=Fn===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,tn/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&Ke.zoom===Ye-1&&tn>=.9)return!0}else if(T&&(wt=qe(Ke.aabb.distanceZ(me)*he)),this.projection.isReprojectedInTileSpace&&x<=5){const Wt=Math.pow(2,Ke.zoom),dn=De(new a.MercatorCoordinate((Ke.x+.5)/Wt,(Ke.y+.5)/Wt));It=dn>.85?1:dn}const en=dt*dt+St*St+wt,_n=qe((1<<Ye-Ke.zoom)*Q*It*((Wt,dn)=>{if(dn*qe(.707)<Wt)return 1;const jn=Math.sqrt(dn/Wt);return jn/(1.4144271570014144+(Math.pow(1.1,jn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(wt,ct),en));return en<_n};if(this.renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)Ge.push(Re(-Ke)),Ge.push(Re(Ke));for(Ge.push(Re(0));Ge.length>0;){const Ke=Ge.pop(),dt=Ke.x,St=Ke.y;let wt=Ke.fullyVisible;if(!wt){const It=Ke.aabb.intersects(oe);if(It===0)continue;wt=It===2}if(Ke.zoom!==Ye&&Ct(Ke))for(let It=0;It<4;It++){const en=(dt<<1)+It%2,_n=(St<<1)+(It>>1),Wt={aabb:C?Ke.aabb.quadrant(It):a.tileAABB(this,B,Ke.zoom+1,en,_n,Ke.wrap,Ke.minZ,Ke.maxZ,this.projection),zoom:Ke.zoom+1,x:en,y:_n,wrap:Ke.wrap,fullyVisible:wt,tileID:void 0,shouldSplit:void 0,minZ:Ke.minZ,maxZ:Ke.maxZ};T&&!$&&(Wt.tileID=new a.OverscaledTileID(Ke.zoom+1===Ye?At:Ke.zoom+1,Ke.wrap,Ke.zoom+1,en,_n),Je(Wt)),Ge.push(Wt)}else{const It=Ke.zoom===Ye?At:Ke.zoom;if(o.minzoom&&o.minzoom>It)continue;const en=G[0]-(.5+dt+(Ke.wrap<<Ke.zoom))*(1<<h-Ke.zoom),_n=G[1]-.5-St,Wt=Ke.tileID?Ke.tileID:new a.OverscaledTileID(It,Ke.wrap,Ke.zoom,dt,St);$e.push({tileID:Wt,distanceSq:en*en+_n*_n})}}if(this.fogCullDistSq){const Ke=this.fogCullDistSq,dt=this.horizonLineFromTop();$e=$e.filter((St=>{const wt=[0,0,0,1],It=[a.EXTENT,a.EXTENT,0,1],en=this.calculateFogTileMatrix(St.tileID.toUnwrapped());a.transformMat4$1(wt,wt,en),a.transformMat4$1(It,It,en);const _n=a.getAABBPointSquareDist(wt,It);if(_n===0)return!0;let Wt=!1;const dn=this._elevation;if(dn&&_n>Ke&&dt!==0){const jn=this.calculateProjMatrix(St.tileID.toUnwrapped());let Fn;o.isTerrainDEM||(Fn=dn.getMinMaxForTile(St.tileID)),Fn||(Fn={min:ve,max:_e});const tn=a.furthestTileCorner(this.rotation),Gn=[tn[0]*a.EXTENT,tn[1]*a.EXTENT,Fn.max];a.transformMat4(Gn,Gn,jn),Wt=(1-Gn[1])*this.height*.5<dt}return _n<Ke||Wt}))}return $e.sort(((Ke,dt)=>Ke.distanceSq-dt.distanceSq)).map((Ke=>Ke.tileID))}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),x=this.projection.project(o.lng,h);return new a.Point(x.x*this.worldSize,x.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let x,T;const C=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;x=(h.x-C.x)/D,T=(h.y-C.y)/D}else{const D=this.pointCoordinate(h),B=this.pointCoordinate(C);x=D.x-B.x,T=D.y-B.y}const R=this.locationCoordinate(o);this.setLocation(new a.MercatorCoordinate(R.x-x,R.y-T))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,h){const x=h?a.mercatorZfromAltitude(h,o.lat):void 0,T=this.projection.project(o.lng,o.lat);return new a.MercatorCoordinate(T.x,T.y,x)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){const x=h??this._centerAltitude,T=[o.x,o.y,0,1],C=[o.x,o.y,1,1];a.transformMat4$1(T,T,this.pixelMatrixInverse),a.transformMat4$1(C,C,this.pixelMatrixInverse);const R=C[3];a.scale$1(T,T,1/T[3]),a.scale$1(C,C,1/R);const D=T[2],B=C[2];return{p0:T,p1:C,t:D===B?0:(x-D)/(B-D)}}screenPointToMercatorRay(o){const h=[o.x,o.y,0,1],x=[o.x,o.y,1,1];return a.transformMat4$1(h,h,this.pixelMatrixInverse),a.transformMat4$1(x,x,this.pixelMatrixInverse),a.scale$1(h,h,1/h[3]),a.scale$1(x,x,1/x[3]),h[2]=a.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,x[2]=a.mercatorZfromAltitude(x[2],this._center.lat)*this.worldSize,a.scale$1(h,h,1/this.worldSize),a.scale$1(x,x,1/this.worldSize),new a.Ray([h[0],h[1],h[2]],a.normalize([],a.sub([],x,h)))}rayIntersectionCoordinate(o){const{p0:h,p1:x,t:T}=o,C=a.mercatorZfromAltitude(h[2],this._center.lat),R=a.mercatorZfromAltitude(x[2],this._center.lat);return new a.MercatorCoordinate(a.number(h[0],x[0],T)/this.worldSize,a.number(h[1],x[1],T)/this.worldSize,a.number(C,R,T))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let h=this.projection.pointCoordinate3D(this,o.x,o.y);if(h)return new a.MercatorCoordinate(h[0],h[1],h[2]);let x=0,T=this.horizonLineFromTop();if(o.y>T)return this.pointCoordinate(o);const C=.02*T,R=o.clone();for(let D=0;D<10&&T-x>C;D++){R.y=a.number(x,T,.66);const B=this.projection.pointCoordinate3D(this,R.x,R.y);B?(T=R.y,h=B):x=R.y}return h?new a.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){const x=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,T=[o.x*this.worldSize,o.y*this.worldSize,x+o.toAltitude(),1];return a.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new a.Point(T[0]/T[3],T[1]/T[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:h}=this._edgeInsets,x=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,C=this.pointLocation3D(new a.Point(h,o)),R=this.pointLocation3D(new a.Point(T,o)),D=this.pointLocation3D(new a.Point(T,x)),B=this.pointLocation3D(new a.Point(h,x));let G=Math.min(C.lng,R.lng,D.lng,B.lng),$=Math.max(C.lng,R.lng,D.lng,B.lng),J=Math.min(C.lat,R.lat,D.lat,B.lat),oe=Math.max(C.lat,R.lat,D.lat,B.lat);const ce=Math.pow(2,-this.zoom)/16*270,he=this.projection.name==="globe"?1:4,de=(me,Q,le,_e,ve)=>{const Ne=(me+le)/2,De=(Q+_e)/2,Re=new a.Point(Ne,De),{lng:Ge,lat:$e}=this.pointLocation3D(Re),Ye=Math.max(0,G-Ge,J-$e,Ge-$,$e-oe);G=Math.min(G,Ge),$=Math.max($,Ge),J=Math.min(J,$e),oe=Math.max(oe,$e),(ve<he||Ye>ce)&&(de(me,Q,Ne,De,ve+1),de(Ne,De,le,_e,ve+1))};if(de(h,o,T,o,1),de(T,o,T,x,1),de(T,x,h,x,1),de(h,x,h,o,1),this.projection.name==="globe"){const[me,Q]=a.polesInViewport(this);me?(oe=90,$=180,G=-180):Q&&(J=-90,$=180,G=-180)}return new a.LngLatBounds(new a.LngLat(G,J),new a.LngLat($,oe))}_getBoundsRectangular(o,h){const{top:x,left:T}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,R=this.width-this._edgeInsets.right,D=new a.Point(T,x),B=new a.Point(R,x),G=new a.Point(R,C),$=new a.Point(T,C);let J=this.pointCoordinate(D,o),oe=this.pointCoordinate(B,o);const ce=this.pointCoordinate(G,h),he=this.pointCoordinate($,h),de=(me,Q)=>(Q.y-me.y)/(Q.x-me.x);return J.y>1&&oe.y>=0?J=new a.MercatorCoordinate((1-he.y)/de(he,J)+he.x,1):J.y<0&&oe.y<=1&&(J=new a.MercatorCoordinate(-he.y/de(he,J)+he.x,0)),oe.y>1&&J.y>=0?oe=new a.MercatorCoordinate((1-ce.y)/de(ce,oe)+ce.x,1):oe.y<0&&J.y<=1&&(oe=new a.MercatorCoordinate(-ce.y/de(ce,oe)+ce.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(he)).extend(this.coordinateLocation(ce))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=o.visibleDemTiles.reduce(((x,T)=>{if(T.dem){const C=T.dem.tree;x.min=Math.min(x.min,C.minimums[0]),x.max=Math.max(x.max,C.maximums[0])}return x}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,x=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,x):x}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){const h=o.key,x=this._distanceTileDataCache;if(x[h])return x[h];const T=o.canonical,C=1/this.height,R=this.cameraWorldSize,D=R/this.zoomScale(T.z),B=(T.x+Math.pow(2,T.z)*o.wrap)*D,G=T.y*D,$=this.point;$.x*=R/this.worldSize,$.y*=R/this.worldSize;const J=this.angle,oe=Math.sin(-J),ce=-Math.cos(-J);return x[h]={bearing:[oe,ce],center:[($.x-B)*C,($.y-G)*C],scale:D/a.EXTENT*C},x[h]}calculateFogTileMatrix(o){const h=o.key,x=this._fogTileMatrixCache;if(x[h])return x[h];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return a.multiply(T,this.worldToFogMatrix,T),x[h]=new Float32Array(T),x[h]}calculateProjMatrix(o,h=!1){const x=o.key,T=h?this._alignedProjMatrixCache:this._projMatrixCache;if(T[x])return T[x];const C=this.calculatePosMatrix(o,this.worldSize);return a.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,C),T[x]=new Float32Array(C),T[x]}calculatePixelsToTileUnitsMatrix(o){const h=o.tileID.key,x=this._pixelsToTileUnitsCache;if(x[h])return x[h];const T=(function(C,R){const{scale:D}=C.tileTransform,B=D*a.EXTENT/(C.tileSize*Math.pow(2,R.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return G=new Float32Array(4),oe=($=R.inverseAdjustmentMatrix)[1],ce=$[2],he=$[3],me=(J=[B,B])[1],G[0]=$[0]*(de=J[0]),G[1]=oe*de,G[2]=ce*me,G[3]=he*me,G;var G,$,J,oe,ce,he,de,me})(o,this);return x[h]=T,x[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,h=a.fromScaling([],[o,o,o]);return a.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const h=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,x=this._computeCameraPosition(h),T=this._camera.forward(),C=a.mercatorZfromAltitude(1,this._center.lat);x[2]/=C,T[2]/=C,a.normalize(T,T);const R=o.raycast(x,T,o.exaggeration());if(R){const D=a.scaleAndAdd([],x,T,R),B=new a.MercatorCoordinate(D[0],D[1],a.mercatorZfromAltitude(D[2],a.latFromMercatorY(D[1]))),G=(B.z+a.length([B.x-x[0],B.y-x[1],B.z-x[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const h=this._elevation,x=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(x),C=h.getAtPointOrZero(new a.MercatorCoordinate(...T)),R=this.pixelsPerMeter/this.worldSize*C,D=this._minimumHeightOverTerrain(),B=T[2]-R;if(B<=D)if(B<0||o){const G=this.locationCoordinate(this._center,this._centerAltitude),$=[T[0],T[1],G.z-T[2]],J=a.length($);$[2]-=(D-B)/this._pixelsPerMercatorPixel;const oe=a.length($);if(oe===0)return;a.scale$2($,$,J/oe*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],G.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const oe=this.center;return oe.lat=a.clamp(oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(oe.lng=a.clamp(oe.lng,this.minLng,this.maxLng)),this.center=oe,void(this._constraining=!1)}const h=this._unmodified,{x,y:T}=this.point;let C=0,R=x,D=T;const B=this.width/2,G=this.height/2,$=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(T-G<$&&(D=$+G),T+G>J&&(D=J-G),J-$<this.height&&(C=Math.max(C,this.height/(J-$)),D=(J+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const oe=this.worldMinX*this.scale,ce=this.worldMaxX*this.scale,he=this.worldSize/2-(oe+ce)/2;R=(x+he+this.worldSize)%this.worldSize-he,R-B<oe&&(R=oe+B),R+B>ce&&(R=ce-B),ce-oe<this.width&&(C=Math.max(C,this.width/(ce-oe)),R=(ce+oe)/2)}R===x&&D===T||(this.center=this.unproject(new a.Point(R,D))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const x=yd(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,x),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?h:1,C=this._camera.getWorldToCamera(this.worldSize,T),R=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);R[8]=2*-o.x/this.width,R[9]=2*o.y/this.height;let D=a.mul([],R,C);if(this.projection.isReprojectedInTileSpace){const De=this.locationCoordinate(this.center),Re=a.identity([]);a.translate(Re,Re,[De.x*this.worldSize,De.y*this.worldSize,0]),a.multiply(Re,Re,La(this)),a.translate(Re,Re,[-De.x*this.worldSize,-De.y*this.worldSize,0]),a.multiply(D,D,Re),this.inverseAdjustmentMatrix=(function(Ge){const $e=La(Ge,!0);return Ie([],[$e[0],$e[1],$e[4],$e[5]])})(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],D,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=D,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const B=a.invert([],R);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);a.identity(G),a.scale(G,G,[1,-1,1]),a.rotateX(G,G,this._pitch),a.rotateZ(G,G,this.angle);const $=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-o.x/this.width,$[9]=2*(o.y+J)/this.height,this.skyboxMatrix=a.multiply(G,$,G);const oe=this.point,ce=oe.x,he=oe.y,de=this.width%2/2,me=this.height%2/2,Q=Math.cos(this.angle),le=Math.sin(this.angle),_e=ce-Math.round(ce)+Q*de+le*me,ve=he-Math.round(he)+Q*me+le*de,Ne=new Float64Array(D);if(a.translate(Ne,Ne,[_e>.5?_e-1:_e,ve>.5?ve-1:ve,0]),this.alignedProjMatrix=Ne,D=a.create(),a.scale(D,D,[this.width/2,-this.height/2,1]),a.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=a.create(),a.scale(D,D,[1,-1,1]),a.translate(D,D,[-1,-1,0]),a.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=a.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const De=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(De,De,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,x=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,C=[o,o,h];a.scale$2(C,C,T),a.scale$2(x,x,-1),a.multiply$2(x,x,C);const R=a.create();a.translate(R,R,x),a.scale(R,R,C),this.mercatorFogMatrix=R,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,T)}_computeCameraPosition(o){const h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,x=this._camera.forward(),T=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-x[0]*C,T.y/this.worldSize-x[1]*C,o/this.worldSize*this._centerAltitude-x[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),x=this._camera.position[2],T=o[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(C=Math.min((h-x)/T,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,o,C),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,h=this._camera.forward(),{pitch:x,bearing:T}=this._camera.getPitchBearing(),C=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,R=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),D=Math.max((o[2]-C)/Math.cos(x),R),B=this._zoomFromMercatorZ(D);a.scaleAndAdd(o,o,h,D),this._pitch=a.clamp(x,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(T,-Math.PI,Math.PI),this._setZoom(a.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,x=a.GLOBE_ZOOM_THRESHOLD_MAX,T=0,C=1/0;for(;x-h>1e-6&&x>h;){const R=h+.5*(x-h),D=this.tileSize*Math.pow(2,R),B=this.getCameraToCenterDistance(this.projection,R,D),G=this.scaleZoom(B/(o*this.tileSize)),$=Math.abs(R-G);$<C&&(C=$,T=R),R<G?h=R:x=R}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){const x=Math.min(o.x,h.x),T=Math.max(o.x,h.x),C=Math.min(o.y,h.y),R=Math.max(o.y,h.y);if(C<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new a.Point(x,C),new a.Point(T,R),new a.Point(x,R),new a.Point(T,C)],B=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const $ of D){const J=this.pointRayIntersection($);if(J.t<0)return!0;const oe=this.rayIntersectionCoordinate(J);if(oe.x<B||oe.y<0||oe.x>G||oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(o,h){const x=a.length(a.sub([],this._camera.position,o)),T=this._zoomFromMercatorZ(x)+h;return x-this._mercatorZfromZoom(T)}getCameraPoint(){if(this.projection.name==="globe"){const o=(function([h,x,T],C){const R=[h,x,T,1];a.transformMat4$1(R,R,C);const D=R[3]=Math.max(R[3],1e-6);return R[0]/=D,R[1]/=D,R[2]/=D,R})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,o))}}getCameraToCenterDistance(o,h=this.zoom,x=this.worldSize){const T=yd(o,h,this.width,this.height,1024),C=o.pixelSpaceConversion(this.center.lat,x,T);return .5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(o,o,this.globeMatrix),o}}function gr(g,o){let h=!1,x=null;const T=()=>{x=null,h&&(g(),x=setTimeout(T,o),h=!1)};return()=>(h=!0,x||T(),x)}class _u{constructor(o){this._hashName=o&&encodeURIComponent(o),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=gr(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,a.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const h=ja(o);if(this._hashName){const x=this._hashName;let T=!1;const C=a.window.location.hash.slice(1).split("&").map((R=>{const D=R.split("=")[0];return D===x?(T=!0,`${D}=${h}`):R})).filter((R=>R));return T||C.push(`${x}=${h}`),`#${C.join("&")}`}return`#${h}`}_getCurrentHash(){const o=a.window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map((x=>x.split("="))).forEach((x=>{x[0]===this._hashName&&(h=x)})),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some((x=>isNaN(x)))){const x=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:x,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,o)}}function ja(g,o){const h=g.getCenter(),x=Math.round(100*g.getZoom())/100,T=Math.ceil((x*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,T),R=Math.round(h.lng*C)/C,D=Math.round(h.lat*C)/C,B=g.getBearing(),G=g.getPitch();let $=o?`/${R}/${D}/${x}`:`${x}/${D}/${R}`;return(B||G)&&($+="/"+Math.round(10*B)/10),G&&($+=`/${Math.round(G)}`),$}const ua={linearity:.3,easing:a.bezier(0,0,.3,1)},xu=a.extend({deceleration:2500,maxSpeed:1400},ua),hc=a.extend({deceleration:20,maxSpeed:1400},ua),zt=a.extend({deceleration:1e3,maxSpeed:360},ua),Ss=a.extend({deceleration:1e3,maxSpeed:90},ua);class xl{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=a.exported.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)h.zoom+=C.zoomDelta||0,h.bearing+=C.bearingDelta||0,h.pitch+=C.pitchDelta||0,C.panDelta&&h.pan._add(C.panDelta),C.around&&(h.around=C.around),C.pinchAround&&(h.pinchAround=C.pinchAround);const x=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(h.pan.mag()){const C=vu(h.pan.mag(),x,a.extend({},xu,o||{}));T.offset=h.pan.mult(C.amount/h.pan.mag()),T.center=this._map.transform.center,fc(T,C)}if(h.zoom){const C=vu(h.zoom,x,hc);T.zoom=this._map.transform.zoom+C.amount,fc(T,C)}if(h.bearing){const C=vu(h.bearing,x,zt);T.bearing=this._map.transform.bearing+a.clamp(C.amount,-179,179),fc(T,C)}if(h.pitch){const C=vu(h.pitch,x,Ss);T.pitch=this._map.transform.pitch+C.amount,fc(T,C)}if(T.zoom||T.bearing){const C=h.pinchAround===void 0?h.around:h.pinchAround;T.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function fc(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function vu(g,o,h){const{maxSpeed:x,linearity:T,deceleration:C}=h,R=a.clamp(g*T/(o/1e3),-x,x),D=Math.abs(R)/(C*T);return{easing:h.easing,duration:1e3*D,amount:R*(D/2)}}class Di extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x,T={}){const C=Ce(h.getCanvasContainer(),x),R=h.unproject(C);super(o,a.extend({point:C,lngLat:R,originalEvent:x},T)),this._defaultPrevented=!1,this.target=h}}class pc extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x){const T=o==="touchend"?x.changedTouches:x.touches,C=je(h.getCanvasContainer(),T),R=C.map((B=>h.unproject(B))),D=C.reduce(((B,G,$,J)=>B.add(G.div(J.length))),new a.Point(0,0));super(o,{points:C,point:D,lngLats:R,lngLat:h.unproject(D),originalEvent:x}),this._defaultPrevented=!1}}class vl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,x){super(o,{originalEvent:x}),this._defaultPrevented=!1}}class mc{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new vl(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Di(o.type,this._map,o))}mouseup(o){this._map.fire(new Di(o.type,this._map,o))}preclick(o){const h=a.extend({},o);h.type="preclick",this._map.fire(new Di(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Di(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Di(o.type,this._map,o))}mouseover(o){this._map.fire(new Di(o.type,this._map,o))}mouseout(o){this._map.fire(new Di(o.type,this._map,o))}touchstart(o){return this._firePreventable(new pc(o.type,this._map,o))}touchmove(o){this._map.fire(new pc(o.type,this._map,o))}touchend(o){this._map.fire(new pc(o.type,this._map,o))}touchcancel(o){this._map.fire(new pc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Di(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Di("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Di(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _d{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(ee(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const x=h,T=this._startPos,C=this._lastPos;if(!T||!C||C.equals(x)||!this._box&&x.dist(T)<this._clickTolerance)return;this._lastPos=x,this._box||(this._box=O("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const R=Math.min(T.x,x.x),D=Math.max(T.x,x.x),B=Math.min(T.y,x.y),G=Math.max(T.y,x.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${R}px,${B}px)`,this._box.style.width=D-R+"px",this._box.style.height=G-B+"px")}))}mouseupWindow(o,h){if(!this._active)return;const x=this._startPos,T=h;if(x&&o.button===0){if(this.reset(),xe(),x.x!==T.x||x.y!==T.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:C=>C.fitScreenCoordinates(x,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ie(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new a.Event(o,{originalEvent:h}))}}function yc(g,o){const h={};for(let x=0;x<g.length;x++)h[g[x].identifier]=o[x];return h}class Oa{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,x){(this.centroid||x.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),x.length===this.numTouches&&(this.centroid=(function(T){const C=new a.Point(0,0);for(const R of T)C._add(R);return C.div(T.length)})(h),this.touches=yc(x,h)))}touchmove(o,h,x){if(this.aborted||!this.centroid)return;const T=yc(x,h);for(const C in this.touches){const R=T[C];(!R||R.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(o,h,x){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),x.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class tf{constructor(o){this.singleTap=new Oa(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,x){this.singleTap.touchstart(o,h,x)}touchmove(o,h,x){this.singleTap.touchmove(o,h,x)}touchend(o,h,x){const T=this.singleTap.touchend(o,h,x);if(T){const C=o.timeStamp-this.lastTime<500,R=!this.lastTap||this.lastTap.dist(T)<30;if(C&&R||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class Sp{constructor(){this._zoomIn=new tf({numTouches:1,numTaps:2}),this._zoomOut=new tf({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,x){this._zoomIn.touchstart(o,h,x),this._zoomOut.touchstart(o,h,x)}touchmove(o,h,x){this._zoomIn.touchmove(o,h,x),this._zoomOut.touchmove(o,h,x)}touchend(o,h,x){const T=this._zoomIn.touchend(o,h,x),C=this._zoomOut.touchend(o,h,x);return T?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()+1,around:R.unproject(T)},{originalEvent:o})}):C?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:R=>R.easeTo({duration:300,zoom:R.getZoom()-1,around:R.unproject(C)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Ep={0:1,2:2};class _c{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const x=Ue(o);this._correctButton(o,x)&&(this._lastPoint=h,this._eventButton=x)}mousemoveWindow(o,h){const x=this._lastPoint;if(x){if(o.preventDefault(),this._eventButton!=null&&(function(T,C){const R=Ep[C];return T.buttons===void 0||(T.buttons&R)!==R})(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(x)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(x,h)}}mouseupWindow(o){this._lastPoint&&Ue(o)===this._eventButton&&(this._moved&&xe(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wu extends _c{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class qo extends _c{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const x=.8*(h.x-o.x);if(x)return this._active=!0,{bearingDelta:x}}contextmenu(o){o.preventDefault()}}class xd extends _c{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const x=-.5*(h.y-o.y);if(x)return this._active=!0,{pitchDelta:x}}contextmenu(o){o.preventDefault()}}class da{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(o,h,x){return this._calculateTransform(o,h,x)}touchmove(o,h,x){if(this._active&&!(x.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(x.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,x)}}touchend(o,h,x){this._calculateTransform(o,h,x),this._active&&x.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,x){x.length>0&&(this._active=!0);const T=yc(x,h),C=new a.Point(0,0),R=new a.Point(0,0);let D=0;for(const G in T){const $=T[G],J=this._touches[G];J&&(C._add($),R._add($.sub(J)),D++,T[G]=$)}if(this._touches=T,D<this._minTouches||!R.mag())return;const B=R.div(D);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(D),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=O("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class Es{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,x){return{}}touchstart(o,h,x){this._firstTwoTouches||x.length<2||(this._firstTwoTouches=[x[0].identifier,x[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,x){const T=this._firstTwoTouches;if(!T)return;o.preventDefault();const[C,R]=T,D=ha(x,h,C),B=ha(x,h,R);if(!D||!B)return;const G=this._aroundCenter?null:D.add(B).div(2);return this._move([D,B],G,o)}touchend(o,h,x){if(!this._firstTwoTouches)return;const[T,C]=this._firstTwoTouches,R=ha(x,h,T),D=ha(x,h,C);R&&D||(this._active&&xe(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function ha(g,o,h){for(let x=0;x<g.length;x++)if(g[x].identifier===h)return o[x]}function Eo(g,o){return Math.log(g/o)/Math.LN2}class vd extends Es{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const x=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(Eo(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:Eo(this._distance,x),pinchAround:h}}}function nf(g,o){return 180*g.angleWith(o)/Math.PI}class Cp extends Es{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const x=this._vector;if(this._vector=o[0].sub(o[1]),x&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:nf(this._vector,x),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,x=this._startVector;if(!x)return!1;const T=nf(o,x);return Math.abs(T)<h}}function Cs(g){return Math.abs(g.y)>Math.abs(g.x)}class xc extends Es{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,Cs(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,x){const T=this._lastPoints;if(!T)return;const C=o[0].sub(T[0]),R=o[1].sub(T[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&x.touches.length<3||(this._valid=this.gestureBeginsVertically(C,R,x.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(C.y+R.y)/2*-.5})}gestureBeginsVertically(o,h,x){if(this._valid!==void 0)return this._valid;const T=o.mag()>=2,C=h.mag()>=2;if(!T&&!C)return;if(!T||!C)return this._firstMove==null&&(this._firstMove=x),x-this._firstMove<100&&void 0;const R=o.y>0==h.y>0;return Cs(o)&&Cs(h)&&R}}const wl={panStep:100,bearingStep:15,pitchStep:10};class wd{constructor(){const o=wl;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,x=0,T=0,C=0,R=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?x=-1:(o.preventDefault(),C=-1);break;case 39:o.shiftKey?x=1:(o.preventDefault(),C=1);break;case 38:o.shiftKey?T=1:(o.preventDefault(),R=-1);break;case 40:o.shiftKey?T=-1:(o.preventDefault(),R=1);break;default:return}return this._rotationDisabled&&(x=0,T=0),{cameraAnimation:D=>{const B=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:bd,zoom:h?Math.round(B)+h*(o.shiftKey?2:1):B,bearing:D.getBearing()+x*this._bearingStep,pitch:D.getPitch()+T*this._pitchStep,offset:[-C*this._panStep,-R*this._panStep],center:D.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function bd(g){return g*(2-g)}const za=4.000244140625;class fa{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const x=a.exported.now(),T=x-(this._lastWheelEventTime||0);this._lastWheelEventTime=x,h!==0&&h%za==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(T*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=Ce(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>za?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&G!==0&&(G=1/G);const $=h(),J=Math.pow(2,$),oe=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(oe*G))),this._type==="wheel"&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const x=typeof this._targetZoom=="number"?this._targetZoom:h(),T=this._startZoom,C=this._easing;let R,D=!1;if(this._type==="wheel"&&T&&C){const B=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),G=C(B);R=a.number(T,x,G),B<1?this._frameId||(this._frameId=!0):D=!0}else R=x,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:R-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=a.ease;if(this._prevEase){const x=this._prevEase,T=(a.exported.now()-x.start)/x.duration,C=x.easing(T+.01)-x.easing(T),R=.27/Math.sqrt(C*C+1e-4)*.01,D=Math.sqrt(.0729-R*R);h=a.bezier(R,D,.25,1)}return this._prevEase={start:a.exported.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=O("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class Rr{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wn{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:x=>{x.easeTo({duration:300,zoom:x.getZoom()+(o.shiftKey?-1:1),around:x.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ba{constructor(){this._tap=new tf({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,x){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?x.length>0&&(this._swipePoint=h[0],this._swipeTouch=x[0].identifier):this._tap.touchstart(o,h,x))}touchmove(o,h,x){if(this._tapTime){if(this._swipePoint){if(x[0].identifier!==this._swipeTouch)return;const T=h[0],C=T.y-this._swipePoint.y;return this._swipePoint=T,o.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(o,h,x)}touchend(o,h,x){this._tapTime?this._swipePoint&&x.length===0&&this.reset():this._tap.touchend(o,h,x)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class $i{constructor(o,h,x){this._el=o,this._mousePan=h,this._touchPan=x}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class ks{constructor(o,h,x){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=x}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class bl{constructor(o,h,x,T){this._el=o,this._touchZoom=h,this._touchRotate=x,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Gi=g=>g.zoom||g.drag||g.pitch||g.rotate;class ls extends a.Event{}class Td{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){const x=a.sub([],h,o);this.radius=a.length(x[2]<0?a.div([],x,this.constants):[x[0],x[1],0])}projectRay(o){a.div(o,o,this.constants),a.normalize(o,o),a.mul$1(o,o,this.constants);const h=a.scale$2([],o,this.radius);if(h[2]>0){const x=a.scale$2([],[0,0,1],a.dot(h,[0,0,1])),T=a.scale$2([],a.normalize([],[h[0],h[1],0]),this.radius),C=a.add([],h,a.scale$2([],a.sub([],a.add([],T,x),h),2));h[0]=C[0],h[1]=C[1]}return h}}function lo(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class Co{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xl(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Td,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),a.bindAll(["handleEvent","handleWindowEvent"],this);const x=this._el;this._listeners=[[x,"touchstart",{passive:!0}],[x,"touchmove",{passive:!1}],[x,"touchend",void 0],[x,"touchcancel",void 0],[x,"mousedown",void 0],[x,"mousemove",void 0],[x,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[x,"mouseover",void 0],[x,"mouseout",void 0],[x,"dblclick",void 0],[x,"click",void 0],[x,"keydown",{capture:!1}],[x,"keyup",void 0],[x,"wheel",{passive:!1}],[x,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[T,C,R]of this._listeners)T.addEventListener(C,T===a.window.document?this.handleWindowEvent:this.handleEvent,R)}destroy(){for(const[o,h,x]of this._listeners)o.removeEventListener(h,o===a.window.document?this.handleWindowEvent:this.handleEvent,x)}_addDefaultHandlers(o){const h=this._map,x=h.getCanvasContainer();this._add("mapEvent",new mc(h,o));const T=h.boxZoom=new _d(h,o);this._add("boxZoom",T);const C=new Sp,R=new Wn;h.doubleClickZoom=new Rr(R,C),this._add("tapZoom",C),this._add("clickZoom",R);const D=new Ba;this._add("tapDragZoom",D);const B=h.touchPitch=new xc(h);this._add("touchPitch",B);const G=new qo(o),$=new xd(o);h.dragRotate=new ks(o,G,$),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const J=new wu(o),oe=new da(h,o);h.dragPan=new $i(x,J,oe),this._add("mousePan",J),this._add("touchPan",oe,["touchZoom","touchRotate"]);const ce=new Cp,he=new vd;h.touchZoomRotate=new bl(x,he,ce,D),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",he,["touchPan","touchRotate"]),this._add("blockableMapEvent",new gc(h));const de=h.scrollZoom=new fa(h,this);this._add("scrollZoom",de,["mousePan"]);const me=h.keyboard=new wd;this._add("keyboard",me);for(const Q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Q]&&h[Q].enable(o[Q])}_add(o,h,x){this._handlers.push({handlerName:o,handler:h,allowed:x}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Gi(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,x){for(const T in o)if(T!==x&&(!h||h.indexOf(T)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const x of o)this._el.contains(x.target)&&h.push(x);return h}handleEvent(o,h){this._updatingCamera=!0;const x=o.type==="renderFrame",T=x?void 0:o,C={needsRenderFrame:!1},R={},D={},B=o.touches?this._getMapTouches(o.touches):void 0,G=B?je(this._el,B):x?void 0:Ce(this._el,o);for(const{handlerName:oe,handler:ce,allowed:he}of this._handlers){if(!ce.isEnabled())continue;let de;this._blockedByActive(D,he,oe)?ce.reset():ce[h||o.type]&&(de=ce[h||o.type](o,G,B),this.mergeHandlerResult(C,R,de,oe,T),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ce.isActive())&&(D[oe]=ce)}const $={};for(const oe in this._previousActiveHandlers)D[oe]||($[oe]=T);this._previousActiveHandlers=D,(Object.keys($).length||lo(C))&&(this._changes.push([C,R,$]),this._triggerRenderFrame()),(Object.keys(D).length||lo(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=C;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(o,h,x,T,C){if(!x)return;a.extend(o,x);const R={handlerName:T,originalEvent:x.originalEvent||C};x.zoomDelta!==void 0&&(h.zoom=R),x.panDelta!==void 0&&(h.drag=R),x.pitchDelta!==void 0&&(h.pitch=R),x.bearingDelta!==void 0&&(h.rotate=R)}_applyChanges(){const o={},h={},x={};for(const[T,C,R]of this._changes)T.panDelta&&(o.panDelta=(o.panDelta||new a.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(o.around=T.around),T.aroundCoord!==void 0&&(o.aroundCoord=T.aroundCoord),T.pinchAround!==void 0&&(o.pinchAround=T.pinchAround),T.noInertia&&(o.noInertia=T.noInertia),a.extend(h,C),a.extend(x,R);this._updateMapTransform(o,h,x),this._changes=[]}_updateMapTransform(o,h,x){const T=this._map,C=T.transform,R=le=>[le.x,le.y,le.z];if((le=>{const _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!lo(o)){const le=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",le!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&T._stop(!0),!lo(o))return void this._fireEvents(h,x,!0);let{panDelta:D,zoomDelta:B,bearingDelta:G,pitchDelta:$,around:J,aroundCoord:oe,pinchAround:ce}=o;C._isCameraConstrained&&(B>0&&(B=0),C._isCameraConstrained=!1),ce!==void 0&&(J=ce),(B||(le=>h[le]&&!this._eventsInProgress[le])("drag"))&&J&&(this._dragOrigin=R(C.pointCoordinate3D(J)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",T._stop(!0),J=J||T.transform.centerPoint,G&&(C.bearing+=G),$&&(C.pitch+=$),C._updateCameraState();const he=[0,0,0];if(D)if(C.projection.name==="mercator"){const le=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(J).dir),_e=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(J.sub(D)).dir);he[0]=_e[0]-le[0],he[1]=_e[1]-le[1]}else{const le=C.pointCoordinate(J);if(C.projection.name==="globe"){D=D.rotate(-C.angle);const _e=C._pixelsPerMercatorPixel/C.worldSize;he[0]=-D.x*a.mercatorScale(a.latFromMercatorY(le.y))*_e,he[1]=-D.y*a.mercatorScale(C.center.lat)*_e}else{const _e=C.pointCoordinate(J.sub(D));le&&_e&&(he[0]=_e.x-le.x,he[1]=_e.y-le.y)}}const de=C.zoom,me=[0,0,0];if(B){const le=R(oe||C.pointCoordinate3D(J)),_e={dir:a.normalize([],a.sub([],le,C._camera.position))};if(_e.dir[2]<0){const ve=C.zoomDeltaToMovement(le,B);a.scale$2(me,_e.dir,ve)}}const Q=a.add(he,he,me);C._translateCameraConstrained(Q),B&&Math.abs(C.zoom-de)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,x,!0)}_fireEvents(o,h,x){const T=Gi(this._eventsInProgress),C=Gi(o),R={};for(const $ in o){const{originalEvent:J}=o[$];this._eventsInProgress[$]||(R[`${$}start`]=J),this._eventsInProgress[$]=o[$]}!T&&C&&this._fireEvent("movestart",C.originalEvent);for(const $ in R)this._fireEvent($,R[$]);C&&this._fireEvent("move",C.originalEvent);for(const $ in o){const{originalEvent:J}=o[$];this._fireEvent($,J)}const D={};let B;for(const $ in this._eventsInProgress){const{handlerName:J,originalEvent:oe}=this._eventsInProgress[$];this._handlersById[J].isActive()||(delete this._eventsInProgress[$],B=h[J]||oe,D[`${$}end`]=B)}for(const $ in D)this._fireEvent($,D[$]);const G=Gi(this._eventsInProgress);if(x&&(T||C)&&!G){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;$?(J($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:B})):(this._map.fire(new a.Event("moveend",{originalEvent:B})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new a.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((o=>{this._frameId=void 0,this.handleEvent(new ls("renderFrame",{timeStamp:o})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Zo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class bu extends a.Evented{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,x){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},h),x)}panTo(o,h,x){return this.easeTo(a.extend({center:o},h),x)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,x){return this.easeTo(a.extend({zoom:o},h),x)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,x){return this.easeTo(a.extend({bearing:o},h),x)}resetNorth(o,h){return this.rotateTo(0,a.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=a.LngLatBounds.convert(o);const x=h&&h.bearing||0,T=h&&h.pitch||0,C=o.getNorthWest(),R=o.getSouthEast();return this._cameraForBounds(this.transform,C,R,x,T,h)}_extendCameraOptions(o){const h={top:0,bottom:0,right:0,left:0};if(typeof(o=a.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const x=o.padding;o.padding={top:x,bottom:x,right:x,left:x}}return o.padding=a.extend(h,o.padding),o}_minimumAABBFrustumDistance(o,h){const x=h.max[0]-h.min[0],T=h.max[1]-h.min[1];return x/T>o.aspect?x/(2*Math.tan(.5*o.fovX)*o.aspect):T/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,x,T,C,R){const D=o.clone(),B=this._extendCameraOptions(R);D.bearing=T,D.pitch=C;const G=a.LngLat.convert(h),$=a.LngLat.convert(x),J=.5*(G.lat+$.lat),oe=.5*(G.lng+$.lng),ce=a.latLngToECEF(J,oe),he=a.normalize([],ce),de=a.normalize([],a.cross([],he,[0,1,0])),me=a.cross([],de,he),Q=[de[0],de[1],de[2],0,me[0],me[1],me[2],0,he[0],he[1],he[2],0,0,0,0,1],le=[ce,a.latLngToECEF(G.lat,G.lng),a.latLngToECEF($.lat,G.lng),a.latLngToECEF($.lat,$.lng),a.latLngToECEF(G.lat,$.lng),a.latLngToECEF(J,G.lng),a.latLngToECEF(J,$.lng),a.latLngToECEF(G.lat,oe),a.latLngToECEF($.lat,oe)];let _e=a.Aabb.fromPoints(le.map((wt=>[a.dot(de,wt),a.dot(me,wt),a.dot(he,wt)])));const ve=a.transformMat4([],_e.center,Q);a.squaredLength(ve)===0&&a.set(ve,0,0,1),a.normalize(ve,ve),a.scale$2(ve,ve,a.GLOBE_RADIUS),D.center=a.ecefToLatLng(ve);const Ne=D.getWorldToCameraMatrix(),De=a.invert(new Float64Array(16),Ne);_e=a.Aabb.applyTransform(_e,a.multiply([],Ne,Q)),a.transformMat4(ve,ve,Ne);const Re=.5*(_e.max[2]-_e.min[2]),Ge=this._minimumAABBFrustumDistance(D,_e),$e=a.scale$2([],[0,0,1],Re),Ye=a.add($e,ve,$e),At=Ge+(D.pitch===0?0:a.distance(ve,Ye)),qe=D.globeCenterInViewSpace,ct=a.sub([],ve,[qe[0],qe[1],qe[2]]);a.normalize(ct,ct),a.scale$2(ct,ct,At);const Je=a.add([],ve,ct);a.transformMat4(Je,Je,De);const Ct=a.earthRadius/a.GLOBE_RADIUS,Ke=a.length(Je),dt=a.mercatorZfromAltitude(Math.max(Ke*Ct-a.earthRadius,Number.EPSILON),0),St=Math.min(D.zoomFromMercatorZAdjusted(dt),B.maxZoom);return St>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"mercator"}),D.zoom=St,this._cameraForBounds(D,h,x,T,C,R)):{center:D.center,zoom:St,bearing:T,pitch:C}}queryTerrainElevation(o,h){const x=this.transform.elevation;return x?(h=a.extend({},{exaggerated:!0},h),x.getAtPoint(a.MercatorCoordinate.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,x,T,C,R){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,x,T,C,R);const D=o.clone(),B=this._extendCameraOptions(R),G=D.padding;D.bearing=T,D.pitch=C;const $=a.LngLat.convert(h),J=a.LngLat.convert(x),oe=new a.LngLat($.lng,J.lat),ce=new a.LngLat(J.lng,$.lat),he=D.project($),de=D.project(J),me=this.queryTerrainElevation($),Q=this.queryTerrainElevation(J),le=this.queryTerrainElevation(oe),_e=this.queryTerrainElevation(ce),ve=[[he.x,he.y,Math.min(me||0,Q||0,le||0,_e||0)],[de.x,de.y,Math.max(me||0,Q||0,le||0,_e||0)]];let Ne=a.Aabb.fromPoints(ve);const De=D.getWorldToCameraMatrix(),Re=a.invert(new Float64Array(16),De);Ne=a.Aabb.applyTransform(Ne,De);const Ge=a.sub([],Ne.max,Ne.min),$e=G.left||0,Ye=G.right||0,At=G.bottom||0,qe=G.top||0,{left:ct,right:Je,top:Ct,bottom:Ke}=B.padding,dt=.5*($e+Ye),St=.5*(qe+At),wt=Math.min(D.scaleZoom(D.scale*Math.min((D.width-($e+Ye+ct+Je))/Ge[0],(D.height-(At+qe+Ke+Ct))/Ge[1])),B.maxZoom),It=D.scale/D.zoomScale(wt);Ne=new a.Aabb([Ne.min[0]-(ct+dt)*It,Ne.min[1]-(Ke+St)*It,Ne.min[2]],[Ne.max[0]+(Je+dt)*It,Ne.max[1]+(Ct+St)*It,Ne.max[2]]);const en=.5*Ge[2],_n=this._minimumAABBFrustumDistance(D,Ne),Wt=[0,0,1,0];a.transformMat4$1(Wt,Wt,De),a.normalize$2(Wt,Wt);const dn=a.scale$2([],Wt,_n+en),jn=a.add([],Ne.center,dn),Fn=(typeof B.offset.x=="number"&&typeof B.offset.y=="number"?new a.Point(B.offset.x,B.offset.y):a.Point.convert(B.offset)).rotate(-a.degToRad(T));Ne.center[0]-=Fn.x*It,Ne.center[1]+=Fn.y*It,a.transformMat4(Ne.center,Ne.center,Re),a.transformMat4(jn,jn,Re);const tn=[Ne.center[0],Ne.center[1],jn[2]*D.pixelsPerMeter];a.scale$2(tn,tn,1/D.worldSize);const Gn=a.lngFromMercatorX(tn[0]),ar=a.latFromMercatorY(tn[1]),lr=Math.min(D._zoomFromMercatorZ(tn[2]),B.maxZoom),rr=new a.LngLat(Gn,ar);return D.mercatorFromTransition&&lr<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"globe"}),D.zoom=lr,this._cameraForBounds(D,h,x,T,C,R)):{center:rr,zoom:lr,bearing:T,pitch:C}}fitBounds(o,h,x){const T=this.cameraForBounds(o,h);return this._fitInternal(T,h,x)}fitScreenCoordinates(o,h,x,T,C){const R=a.Point.convert(o),D=a.Point.convert(h),B=new a.Point(Math.min(R.x,D.x),Math.min(R.y,D.y)),G=new a.Point(Math.max(R.x,D.x),Math.max(R.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(R,D))return this;const $=this.transform.pointLocation3D(B),J=this.transform.pointLocation3D(G),oe=this.transform.pointLocation3D(new a.Point(B.x,G.y)),ce=this.transform.pointLocation3D(new a.Point(G.x,B.y)),he=[Math.min($.lng,J.lng,oe.lng,ce.lng),Math.min($.lat,J.lat,oe.lat,ce.lat)],de=[Math.max($.lng,J.lng,oe.lng,ce.lng),Math.max($.lat,J.lat,oe.lat,ce.lat)],me=T&&T.pitch?T.pitch:this.getPitch(),Q=this._cameraForBounds(this.transform,he,de,x,me,T);return this._fitInternal(Q,T,C)}_fitInternal(o,h,x){return o?(delete(h=a.extend(o,h)).padding,h.linear?this.easeTo(h,x):this.flyTo(h,x)):this}jumpTo(o,h){this.stop();const x=o.preloadOnly?this.transform.clone():this.transform;let T=!1,C=!1,R=!1;return"zoom"in o&&x.zoom!==+o.zoom&&(T=!0,x.zoom=+o.zoom),o.center!==void 0&&(x.center=a.LngLat.convert(o.center)),"bearing"in o&&x.bearing!==+o.bearing&&(C=!0,x.bearing=+o.bearing),"pitch"in o&&x.pitch!==+o.pitch&&(R=!0,x.pitch=+o.pitch),o.padding==null||x.isPaddingEqual(o.padding)||(x.padding=o.padding),o.preloadOnly?(this._preloadTiles(x),this):(this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),T&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),C&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),R&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(Zo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){const x=this.transform;if(!x.projection.supportsFreeCamera)return a.warnOnce(Zo),this;this.stop();const T=x.zoom,C=x.pitch,R=x.bearing;x.setFreeCameraOptions(o);const D=T!==x.zoom,B=C!==x.pitch,G=R!==x.bearing;return this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),D&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),G&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),B&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const x=this.transform,T=this.getZoom(),C=this.getBearing(),R=this.getPitch(),D=this.getPadding(),B="zoom"in o?+o.zoom:T,G="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:R,J="padding"in o?o.padding:x.padding,oe=a.Point.convert(o.offset);let ce,he,de;if(x.projection.name==="globe"){const $e=a.MercatorCoordinate.fromLngLat(x.center),Ye=oe.rotate(-x.angle);$e.x+=Ye.x/x.worldSize,$e.y+=Ye.y/x.worldSize;const At=$e.toLngLat(),qe=a.LngLat.convert(o.center||At);this._normalizeCenter(qe),ce=x.centerPoint.add(Ye),he=new a.Point($e.x,$e.y).mult(x.worldSize),de=new a.Point(a.mercatorXfromLng(qe.lng),a.mercatorYfromLat(qe.lat)).mult(x.worldSize).sub(he)}else{ce=x.centerPoint.add(oe);const $e=x.pointLocation(ce),Ye=a.LngLat.convert(o.center||$e);this._normalizeCenter(Ye),he=x.project($e),de=x.project(Ye).sub(he)}const me=x.zoomScale(B-T);let Q,le;o.around&&(Q=a.LngLat.convert(o.around),le=x.locationPoint(Q));const _e=this._zooming||B!==T,ve=this._rotating||C!==G,Ne=this._pitching||$!==R,De=!x.isPaddingEqual(J),Re=$e=>Ye=>{if(_e&&($e.zoom=a.number(T,B,Ye)),ve&&($e.bearing=a.number(C,G,Ye)),Ne&&($e.pitch=a.number(R,$,Ye)),De&&($e.interpolatePadding(D,J,Ye),ce=$e.centerPoint.add(oe)),Q)$e.setLocationAtPoint(Q,le);else{const At=$e.zoomScale($e.zoom-T),qe=B>T?Math.min(2,me):Math.max(.5,me),ct=Math.pow(qe,1-Ye),Je=$e.unproject(he.add(de.mult(Ye*ct)).mult(At));$e.setLocationAtPoint($e.renderWorldCopies?Je.wrap():Je,ce)}return o.preloadOnly||this._fireMoveEvents(h),$e};if(o.preloadOnly){const $e=this._emulate(Re,o.duration,x);return this._preloadTiles($e),this}const Ge={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=ve,this._pitching=Ne,this._padding=De,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,Ge),this._ease(Re(x),($e=>{x.recenterOnTerrain(),this._afterEase(h,$e)}),o),this}_prepareEase(o,h,x={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||x.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!x.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!x.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!x.pitching&&this.fire(new a.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const x=this._zooming,T=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,x&&this.fire(new a.Event("zoomend",o)),T&&this.fire(new a.Event("rotateend",o)),C&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){const wt=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(wt,h)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);const x=this.transform,T=this.getZoom(),C=this.getBearing(),R=this.getPitch(),D=this.getPadding(),B="zoom"in o?a.clamp(+o.zoom,x.minZoom,x.maxZoom):T,G="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:R,J="padding"in o?o.padding:x.padding,oe=x.zoomScale(B-T),ce=a.Point.convert(o.offset);let he=x.centerPoint.add(ce);const de=x.pointLocation(he),me=a.LngLat.convert(o.center||de);this._normalizeCenter(me);const Q=x.project(de),le=x.project(me).sub(Q);let _e=o.curve;const ve=Math.max(x.width,x.height),Ne=ve/oe,De=le.mag();if("minZoom"in o){const wt=a.clamp(Math.min(o.minZoom,T,B),x.minZoom,x.maxZoom),It=ve/x.zoomScale(wt-T);_e=Math.sqrt(It/De*2)}const Re=_e*_e;function Ge(wt){const It=(Ne*Ne-ve*ve+(wt?-1:1)*Re*Re*De*De)/(2*(wt?Ne:ve)*Re*De);return Math.log(Math.sqrt(It*It+1)-It)}function $e(wt){return(Math.exp(wt)-Math.exp(-wt))/2}function Ye(wt){return(Math.exp(wt)+Math.exp(-wt))/2}const At=Ge(0);let qe=function(wt){return Ye(At)/Ye(At+_e*wt)},ct=function(wt){return ve*((Ye(At)*($e(It=At+_e*wt)/Ye(It))-$e(At))/Re)/De;var It},Je=(Ge(1)-At)/_e;if(Math.abs(De)<1e-6||!isFinite(Je)){if(Math.abs(ve-Ne)<1e-6)return this.easeTo(o,h);const wt=Ne<ve?-1:1;Je=Math.abs(Math.log(Ne/ve))/_e,ct=function(){return 0},qe=function(It){return Math.exp(wt*_e*It)}}o.duration="duration"in o?+o.duration:1e3*Je/("screenSpeed"in o?+o.screenSpeed/_e:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Ct=C!==G,Ke=$!==R,dt=!x.isPaddingEqual(J),St=wt=>It=>{const en=It*Je,_n=1/qe(en);wt.zoom=It===1?B:T+wt.scaleZoom(_n),Ct&&(wt.bearing=a.number(C,G,It)),Ke&&(wt.pitch=a.number(R,$,It)),dt&&(wt.interpolatePadding(D,J,It),he=wt.centerPoint.add(ce));const Wt=It===1?me:wt.unproject(Q.add(le.mult(ct(en))).mult(_n));return wt.setLocationAtPoint(wt.renderWorldCopies?Wt.wrap():Wt,he),wt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),wt};if(o.preloadOnly){const wt=this._emulate(St,o.duration,x);return this._preloadTiles(wt),this}return this._zooming=!0,this._rotating=Ct,this._pitching=Ke,this._padding=dt,this._prepareEase(h,!1),this._ease(St(x),(()=>this._afterEase(h)),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const x=this._onEaseEnd;this._onEaseEnd=void 0,x.call(this,h)}if(!o){const x=this.handlers;x&&x.stop(!1)}return this}_ease(o,h,x){x.animate===!1||x.duration===0?(o(1),h()):(this._easeStart=a.exported.now(),this._easeOptions=x,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=a.wrap(o,-180,180);const x=Math.abs(o-h);return Math.abs(o-360-h)<x&&(o-=360),Math.abs(o+360-h)<x&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const x=o.lng-h.center.lng;o.lng+=x>180?-360:x<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,x){const T=Math.ceil(15*h/1e3),C=[],R=o(x.clone());for(let D=0;D<=T;D++){const B=R(D/T);C.push(B.clone())}return C}}class Ft{constructor(o={}){this.options=o,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const h=this.options&&this.options.compact;return this._map=o,this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=O("button","mapboxgl-ctrl-attrib-button",this._container),O("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const x=this._map._getUIString(`AttributionControl.${h}`);o.setAttribute("aria-label",x),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",x)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(o){const x=h.reduce(((T,C,R)=>(C.value&&(T+=`${C.key}=${C.value}${R<h.length-1?"&":""}`),T)),"?");o.href=`${a.config.FEEDBACK_URL}/${x}#${ja(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const h=this._map.style._sourceCaches;for(const T in h){const C=h[T];if(C.used){const R=C.getSource();R.attribution&&o.indexOf(R.attribution)<0&&o.push(R.attribution)}}o.sort(((T,C)=>T.length-C.length)),o=o.filter(((T,C)=>{for(let R=C+1;R<o.length;R++)if(o[R].indexOf(T)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const x=o.join(" | ");x!==this._attribHTML&&(this._attribHTML=x,o.length?(this._innerContainer.innerHTML=x,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class vc{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=O("div","mapboxgl-ctrl");const h=O("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const h in o){const x=o[h].getSource();if(x.hasOwnProperty("mapbox_logo")&&!x.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Tu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,x=h?this._queue.concat(h):this._queue;for(const T of x)if(T.id===o)return void(T.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const x of h)if(!x.cancelled&&(x.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Tl(g,o,h){if(g=new a.LngLat(g.lng,g.lat),o){const x=new a.LngLat(g.lng-360,g.lat),T=new a.LngLat(g.lng+360,g.lat),C=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),R=h.locationPoint(g).distSqr(o),D=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint(x).distSqr(o)<R&&(D||Math.abs(x.lng-h.center.lng)<C)?g=x:h.locationPoint(T).distSqr(o)<R&&(D||Math.abs(T.lng-h.center.lng)<C)&&(g=T)}for(;Math.abs(g.lng-h.center.lng)>180;){const x=h.locationPoint(g);if(x.x>=0&&x.y>=0&&x.x<=h.width&&x.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const Sl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ot extends a.Evented{constructor(o,h){if(super(),(o instanceof a.window.HTMLElement||h)&&(o=a.extend({element:o},h)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=O("div");const T=41,C=27,R=K("svg",{display:"block",height:T*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${T}`},this._element),D=K("radialGradient",{id:"shadowGradient"},K("defs",{},R));K("stop",{offset:"10%","stop-opacity":.4},D),K("stop",{offset:"100%","stop-opacity":.05},D),K("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},R),K("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},R),K("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},R),K("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},R),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(T=>{T.preventDefault()})),this._element.addEventListener("mousedown",(T=>{T.preventDefault()}));const x=this._element.classList;for(const T in Sl)x.remove(`mapboxgl-marker-anchor-${T}`);x.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const h=o.code,x=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&x!==32&&x!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,x=this._element;this._popup&&(h===x||x.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,h=this._pos;if(!o||!h)return!1;const x=o.unproject(h),T=o.getFreeCameraOptions();if(!T.position)return!1;const C=T.position.toLngLat();return C.distanceTo(x)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();const x=o.unproject(h);let T;o._showingGlobe()&&a.isLngLatBehindGlobe(o.transform,this._lngLat)?T=0:(T=1-o._queryFogOpacity(x),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Sl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const o=this._pos,h=this._map,x=this.getPitchAlignment();if(!h||!o||x!=="map")return"";if(!h._showingGlobe()){const B=h.getPitch();return B?`rotateX(${B}deg)`:""}const T=a.radToDeg(a.globeTiltAtLngLat(h.transform,this._lngLat)),C=o.sub(a.globeCenterToScreenPoint(h.transform)),R=Math.abs(C.x)+Math.abs(C.y);if(R===0)return"";const D=T/R;return`rotateX(${-C.y*D}deg) rotateY(${C.x*D}deg)`}_calculateZTransform(){const o=this._pos,h=this._map;if(!h||!o)return"";let x=0;const T=this.getRotationAlignment();if(T==="map")if(h._showingGlobe()){const C=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),R=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);x=a.radToDeg(Math.atan2(R.y,R.x))-90}else x=-h.getBearing();else if(T==="horizon"){const C=a.smoothstep(4,6,h.getZoom()),R=a.globeCenterToScreenPoint(h.transform);R.y+=C*h.transform.height;const D=o.sub(R),B=a.radToDeg(Math.atan2(D.y,D.x));x=(B>90?B-270:B+90)*(1-C)}return x+=this._rotation,x?`rotateZ(${x}deg)`:""}_update(o){a.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Tl(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),o===!0?this._updateFrameId=a.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),h._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(o){return this._offset=a.Point.convert(o),this._update(),this}_onMove(o){const h=this._map;if(!h)return;const x=this._pointerdownPos,T=this._positionDelta;if(x&&T){if(!this._isDragging){const C=this._clickTolerance||h._clickTolerance;if(o.point.dist(x)<C)return;this._isDragging=!0}this._pos=o.point.sub(T),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(o){const h=this._map,x=this._pos;h&&x&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(x),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},wc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Su(g=new a.Point(0,0),o="bottom"){if(typeof g=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new a.Point(0,g);case"top-left":return new a.Point(h,h);case"top-right":return new a.Point(-h,h);case"bottom":return new a.Point(0,-g);case"bottom-left":return new a.Point(h,-h);case"bottom-right":return new a.Point(-h,-h);case"left":return new a.Point(g,0);case"right":return new a.Point(-g,0)}return new a.Point(0,0)}return g instanceof a.Point||Array.isArray(g)?a.Point.convert(g):a.Point.convert(g[o]||[0,0])}class bc{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const h=a.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,x){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+x}}const Vs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Us={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},El={showCompass:!0,showZoom:!0,visualizePitch:!1};class pa{constructor(o,h,x=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new qo({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,x&&(this.mousePitch=new xd({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),ee()}move(o,h){const x=this.map,T=this.mouseRotate.mousemoveWindow(o,h),C=T&&T.bearingDelta;if(C&&x.setBearing(x.getBearing()+C),this.mousePitch){const R=this.mousePitch.mousemoveWindow(o,h),D=R&&R.pitchDelta;D&&x.setPitch(x.getPitch()+D)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ie(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),Ce(this.element,o)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,Ce(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=je(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=je(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const ko={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},ma={maxWidth:100,unit:"metric"},Sd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Va={version:a.version,supported:M,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends bu{constructor(g){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(g=a.extend({},Us,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(g.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _l(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Tu,this._domRenderTaskQueue=new Tu,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Vs,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new bc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,typeof g.container=="string"){if(this._container=a.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new Co(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new _u(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,a.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new Ft({customAttribution:g.customAttribution})),this._logoControl=new vc,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new a.Event(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new a.Event(`${o.dataType}dataloading`,o))}))}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const x=this._controlPositions[o];return o.indexOf("bottom")!==-1?x.insertBefore(h,x.firstChild):x.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.Event("movestart",g)).fire(new a.Event("move",g)),this.fire(new a.Event("resize",g)),o&&this.fire(new a.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?a.window.navigator.language:Array.isArray(g)?g.length===0?void 0:g.map((o=>o==="auto"?a.window.navigator.language:o)):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let h;o==="globe"&&g.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),h=!0):o==="mercator"&&g.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;if(o=g.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(a.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(a.Point.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,h){if(g==="mouseenter"||g==="mouseover"){let x=!1;const T=R=>{const D=o.filter((G=>this.getLayer(G))),B=D.length?this.queryRenderedFeatures(R.point,{layers:D}):[];B.length?x||(x=!0,h.call(this,new Di(g,this,R.originalEvent,{features:B}))):x=!1},C=()=>{x=!1};return{layers:new Set(o),listener:h,delegates:{mousemove:T,mouseout:C}}}if(g==="mouseleave"||g==="mouseout"){let x=!1;const T=R=>{const D=o.filter((B=>this.getLayer(B)));(D.length?this.queryRenderedFeatures(R.point,{layers:D}):[]).length?x=!0:x&&(x=!1,h.call(this,new Di(g,this,R.originalEvent)))},C=R=>{x&&(x=!1,h.call(this,new Di(g,this,R.originalEvent)))};return{layers:new Set(o),listener:h,delegates:{mousemove:T,mouseout:C}}}{const x=T=>{const C=o.filter((D=>this.getLayer(D))),R=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];R.length&&(T.features=R,h.call(this,T),delete T.features)};return{layers:new Set(o),listener:h,delegates:{[g]:x}}}}on(g,o,h){if(h===void 0)return super.on(g,o);Array.isArray(o)||(o=[o]);const x=this._createDelegatedListener(g,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(x);for(const T in x.delegates)this.on(T,x.delegates[T]);return this}once(g,o,h){if(h===void 0)return super.once(g,o);Array.isArray(o)||(o=[o]);const x=this._createDelegatedListener(g,o,h);for(const T in x.delegates)this.once(T,x.delegates[T]);return this}off(g,o,h){if(h===void 0)return super.off(g,o);o=new Set(Array.isArray(o)?o:[o]);const x=(C,R)=>{if(C.size!==R.size)return!1;for(const D of C)if(!R.has(D))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[g]:void 0;return T&&(C=>{for(let R=0;R<C.length;R++){const D=C[R];if(D.listener===h&&x(D.layers,o)){for(const B in D.delegates)this.off(B,D.delegates[B]);return C.splice(R,1),this}}})(T),this}queryRenderedFeatures(g,o){return this.style?(o!==void 0||g===void 0||g instanceof a.Point||Array.isArray(g)||(o=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(g,o){return this.style.querySourceFeatures(g,o)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&a.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(g))}setStyle(g,o){return(o=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new io(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new io(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,o){if(typeof g=="string"){const h=this._requestManager.normalizeStyleURL(g),x=this._requestManager.transformRequest(h,a.ResourceType.Style);a.getJSON(x,((T,C)=>{T?this.fire(new a.ErrorEvent(T)):C&&this._updateDiff(C,o)}))}else typeof g=="object"&&this._updateDiff(g,o)}_updateDiff(g,o){try{this.style.setState(g)&&this._update(!0)}catch(h){a.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(g,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(g,o){return this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const o in g){const h=g[o]._tiles;for(const x in h){const T=h[x];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(g,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,h)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,o,{pixelRatio:h=1,sdf:x=!1,stretchX:T,stretchY:C,content:R}={}){if(this._lazyInitEmptyStyle(),o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap){const{width:D,height:B,data:G}=a.exported.getImageData(o);this.style.addImage(g,{data:new a.RGBAImage({width:D,height:B},G),pixelRatio:h,stretchX:T,stretchY:C,content:R,sdf:x,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:B}=o,G=o;this.style.addImage(g,{data:new a.RGBAImage({width:D,height:B},new Uint8Array(G.data)),pixelRatio:h,stretchX:T,stretchY:C,content:R,sdf:x,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g)}}updateImage(g,o){const h=this.style.getImage(g);if(!h)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const x=o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap?a.exported.getImageData(o):o,{width:T,height:C}=x;T!==void 0&&C!==void 0?T===h.data.width&&C===h.data.height?(h.data.replace(x.data,!(o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap)),this.style.updateImage(g,h)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${C})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,o){a.getImage(this._requestManager.transformRequest(g,a.ResourceType.Image),((h,x)=>{o(h,x instanceof a.window.HTMLImageElement?a.exported.getImageData(x):x)}))}listImages(){return this.style.listImages()}addLayer(g,o){return this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)}moveLayer(g,o){return this.style.moveLayer(g,o),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,o,h){return this.style.setLayerZoomRange(g,o,h),this._update(!0)}setFilter(g,o,h={}){return this.style.setFilter(g,o,h),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,o,h,x={}){return this.style.setPaintProperty(g,o,h,x),this._update(!0)}getPaintProperty(g,o){return this.style.getPaintProperty(g,o)}setLayoutProperty(g,o,h,x={}){return this.style.setLayoutProperty(g,o,h,x),this._update(!0)}getLayoutProperty(g,o){return this.style.getLayoutProperty(g,o)}setLight(g,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(g),this.transform):0}setFeatureState(g,o){return this.style.setFeatureState(g,o),this._update()}removeFeatureState(g,o){return this.style.removeFeatureState(g,o),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let h,x,T,C=this._container;for(;C&&(!x||!T);){const R=a.window.getComputedStyle(C).transform;R&&R!=="none"&&(h=R.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(x=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(T=h[3])),C=C.parentElement}this._containerWidth=x?Math.abs(g/x):g,this._containerHeight=T?Math.abs(o/T):o}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=O("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=O("div","mapboxgl-canvas-container",g);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=O("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=O("div","mapboxgl-control-container",g),x=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((T=>{x[T]=O("div",`mapboxgl-ctrl-${T}`,h)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const h=a.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=a.extend({},M.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",g),h=o||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);h?(this._useWebGL2&&!o&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(h,!0),this.painter=new yl(h,this.transform,!!o),this.on("data",(x=>{x.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),a.exported$1.testSupport(h)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;const h=this.painter.context.extTimerQuery,x=a.exported.now();if(this.listens("gpu-timing-frame")&&(o=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,B=this.transform.pitch,G=a.exported.now(),$=new a.EvaluationParameters(D,{now:G,fadeDuration:T,pitch:B,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(x),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(x),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const D=a.exported.now()-x;h.endQueryEXT(h.TIME_ELAPSED_EXT,o),setTimeout((()=>{const B=h.getQueryObjectEXT(o,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(o),this.fire(new a.Event("gpu-timing-frame",{cpuTime:D,gpuTime:B})),a.window.performance.mark("frame-gpu",{startTime:x,detail:{gpuTime:B}})}),50)}if(this.listens("gpu-timing-layer")){const D=this.painter.collectGpuTimers();setTimeout((()=>{const B=this.painter.queryGpuTimers(D);this.fire(new a.Event("gpu-timing-layer",{layerTimes:B}))}),50)}if(this.listens("gpu-timing-deferred-render")){const D=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const B=this.painter.queryGpuTimeDeferredRender(D);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:B}))}),50)}const R=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(R||this._repaint)this.triggerRepaint();else{const D=!this.isMoving()&&this.loaded();if(D&&(C=this._updateAverageElevation(x,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),D&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||R||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const h=x=>(this.transform.averageElevation=x,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const x=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=g;const R=Math.abs(x-T);if(R>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(T),h(T);this._averageElevation.easeTo(T,g,300)}else if(R>1e-4)return this._averageElevation.jumpTo(T),h(T)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(g=>{if(g&&(g.message===a.AUTH_ERR_MSG||g.status===401)){const o=this.painter.context.gl;a.storeAuthState(o,!1),this._logoControl instanceof vc&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const h=this.painter.context.gl,x=h.createFramebuffer();function T(C){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,C,0);const R=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,R),R}return h.bindFramebuffer(h.FRAMEBUFFER,x),this._canvasPixelComparison(T(g),o.canvasCopies.map(T),o.timeStamps)}_canvasPixelComparison(g,o,h){let x=h[1]-h[0];const T=g.length/4;for(let C=0;C<o.length;C++){const R=o[C];let D=0;for(let B=0;B<R.length;B+=4)R[B]===g[B]&&R[B+1]===g[B+1]&&R[B+2]===g[B+2]&&R[B+3]===g[B+3]&&(D+=1);x+=(h[C+2]-h[C+1])*(1-D/T)}return x}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.exported.frame((o=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)})))}_preloadTiles(g){const o=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(o,((h,x)=>h._preloadTiles(g,x)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,o){a.setCacheLimits(g,o)}get version(){return a.version}},NavigationControl:class{constructor(g){this.options=a.extend({},El,g),this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(o=>{this._map&&this._map.zoomIn({},{originalEvent:o})})),O("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(o=>{this._map&&this._map.zoomOut({},{originalEvent:o})})),O("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(o=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))})),this._compassIcon=O("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),h=o===g.getMaxZoom(),x=o===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=x,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",x.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=o)}))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new pa(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const h=O("button",g,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(g,o){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends a.Evented{constructor(g){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},ko,g),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=gr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then((h=>o(h.state!=="denied"))).catch((()=>o())):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),h=g.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",g)),this._finish()}}_updateCamera(g){const o=new a.LngLat(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,x=this._map.getBearing(),T=a.extend({bearing:x},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),T,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new a.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=a.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this._geolocateButton=O("button","mapboxgl-ctrl-geolocate",this._container),O("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O("div","mapboxgl-user-location"),this._dotElement.appendChild(O("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(O("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ot({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=O("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ot({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))}))}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((o=>{o==="granted"&&g()})).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ft,ScaleControl:class{constructor(g){this.options=a.extend({},ma,g),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,x=o._containerWidth/2-g/2,T=o.unproject([x,h]),C=o.unproject([x+g,h]),R=T.distanceTo(C);if(this.options.unit==="imperial"){const D=3.2808*R;D>5280?this._setScale(g,D/5280,"mile"):this._setScale(g,D,"foot")}else this.options.unit==="nautical"?this._setScale(g,R/1852,"nautical-mile"):R>=1e3?this._setScale(g,R/1e3,"kilometer"):this._setScale(g,R,"meter")}_setScale(g,o,h){this._map._requestDomTask((()=>{const x=(function(C){const R=Math.pow(10,`${Math.floor(C)}`.length-1);let D=C/R;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:(function(B){const G=Math.pow(10,Math.ceil(-Math.log(B)/Math.LN10));return Math.round(B*G)/G})(D),R*D})(o),T=x/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(x):`${x}&nbsp;${Sd[h]}`,this._container.style.width=g*T+"px"}))}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof a.window.HTMLElement?this._container=g.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=O("button","mapboxgl-ctrl-fullscreen",this._controlContainer);O("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(g){super(),this.options=a.extend(Object.create(Fa),g),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=a.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(a.window.document.createTextNode(g))}setHTML(g){const o=a.window.document.createDocumentFragment(),h=a.window.document.createElement("body");let x;for(h.innerHTML=g;x=h.firstChild,x;)o.appendChild(x);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=O("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const h=this._closeButton=O("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,h=this._container,x=this._pos;if(!o||!h||!x)return"bottom";const T=h.offsetWidth,C=h.offsetHeight,R=x.x<T/2,D=x.x>o.transform.width-T/2;if(x.y+g<C)return R?"top-left":D?"top-right":"top";if(x.y>o.transform.height-C){if(R)return"bottom-left";if(D)return"bottom-right"}return R?"left":D?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let x=this._container;if(x||(x=this._container=O("div","mapboxgl-popup",o.getContainer()),this._tip=O("div","mapboxgl-popup-tip",x),x.appendChild(h)),this.options.maxWidth&&x.style.maxWidth!==this.options.maxWidth&&(x.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tl(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const T=this._pos=this._trackPointer&&g?g:o.project(this._lngLat),C=Su(this.options.offset),R=this._anchor=this._getAnchor(C.y),D=Su(this.options.offset,R),B=T.add(D).round();o._requestDomTask((()=>{this._container&&R&&(this._container.style.transform=`${Sl[R]} translate(${B.x}px,${B.y}px)`)}))}if(!this._marker&&o._showingGlobe()){const T=a.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(wc);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Ot,Style:io,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:ca,Evented:a.Evented,config:a.config,prewarm:function(){ll().acquire(wo)},clearPrewarmedResources:function(){const g=as;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(wo),as=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(g){a.config.ACCESS_TOKEN=g},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(g){a.config.API_URL=g},get workerCount(){return wi.workerCount},set workerCount(g){wi.workerCount=g},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Va}));var b=m;return b}))})(Fx)),Fx.exports}var R3=JW();const zl=wb(R3),QW=HI({__proto__:null,default:zl},[R3]),KA={lat:21.038,lng:105.782},qT=[{id:"A1",name:"Building A1",nameVi:"A1",type:"building",lat:21.039716029400708,lng:105.7832080286106,description:"Ta nh A1 - Khu ging ng chnh",descriptionEn:"Building A1 - Main lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A2",name:"Building A2",nameVi:"A2",type:"building",lat:21.039241956752605,lng:105.78308893318581,description:"Ta nh A2 - Khu ging ng",descriptionEn:"Building A2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A3",name:"Building A3",nameVi:"A3",type:"building",lat:21.039111478563356,lng:105.78279039415679,description:"Ta nh A3 - Khu ging ng",descriptionEn:"Building A3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A4",name:"Building A4",nameVi:"A4",type:"building",lat:21.039805,lng:105.782784,description:"Ta nh A4 - Khu ging ng",descriptionEn:"Building A4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A5",name:"Building A5",nameVi:"A5",type:"building",lat:21.039853372191985,lng:105.78296008714364,description:"Ta nh A5 - Khu ging ng",descriptionEn:"Building A5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A6",name:"Building A6",nameVi:"A6",type:"building",lat:21.040221833014513,lng:105.78293897060121,description:"Ta nh A6 - Khu ging ng",descriptionEn:"Building A6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A7",name:"Building A7",nameVi:"A7",type:"building",lat:21.039954182925683,lng:105.78157815521064,description:"Ta nh A7 - Khu ging ng",descriptionEn:"Building A7 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A8",name:"Building A8",nameVi:"A8",type:"building",lat:21.040014,lng:105.781236,description:"Ta nh A8 - Khu ging ng",descriptionEn:"Building A8 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B1",name:"Building B1",nameVi:"B1",type:"building",lat:21.03806856546437,lng:105.78122336937986,description:"Ta nh B1 - Khu ging ng",descriptionEn:"Building B1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B2",name:"Building B2",nameVi:"B2",type:"building",lat:21.037537005578642,lng:105.78243174427888,description:"Ta nh B2 - Khu ging ng",descriptionEn:"Building B2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B3",name:"Building B3",nameVi:"B3",type:"building",lat:21.03842964478416,lng:105.78202247538536,description:"Ta nh B3 - Khu ging ng",descriptionEn:"Building B3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B4",name:"Building B4",nameVi:"B4",type:"building",lat:21.036848509166973,lng:105.78278135131,description:"Ta nh B4 - Khu ging ng",descriptionEn:"Building B4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C1",name:"Building C1",nameVi:"C1",type:"building",lat:21.039312040918517,lng:105.7816554858685,description:"Ta nh C1 - Khu ging ng",descriptionEn:"Building C1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C1T",name:"Building C1T",nameVi:"C1T",type:"building",lat:21.03837975944799,lng:105.78335962961887,description:"Ta nh C1T - Khu ging ng",descriptionEn:"Building C1T - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C2",name:"Building C2",nameVi:"C2",type:"building",lat:21.038700468933712,lng:105.7816178053169,description:"Ta nh C2 - Khu ging ng",descriptionEn:"Building C2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C3",name:"Building C3",nameVi:"C3",type:"building",lat:21.03897939011371,lng:105.78201374266945,description:"Ta nh C3 - Khu ging ng",descriptionEn:"Building C3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C4",name:"Building C4",nameVi:"C4",type:"building",lat:21.038673854494604,lng:105.78220222457082,description:"Ta nh C4 - Khu ging ng",descriptionEn:"Building C4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C5",name:"Building C5",nameVi:"C5",type:"building",lat:21.039211779923747,lng:105.78223646566244,description:"Ta nh C5 - Khu ging ng",descriptionEn:"Building C5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C6",name:"Building C6",nameVi:"C6",type:"building",lat:21.038969210374205,lng:105.7813646272462,description:"Ta nh C6 - Khu ging ng",descriptionEn:"Building C6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"D1",name:"Nguyen Van Dao Auditorium",nameVi:"Hi trng Nguyn Vn o",type:"building",lat:21.03745096834652,lng:105.78142828118075,description:"Hi trng Nguyn Vn o - Hi trng ln dnh cho s kin quan trng",descriptionEn:"Nguyen Van Dao Auditorium - Main auditorium for important events",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Hi trng","S kin"],tagsEn:["Auditorium","Events"]},{id:"D2",name:"VNU Administration Building D2",nameVi:"Nh iu hnh HQG D2",type:"building",lat:21.03766686313898,lng:105.78162505532134,description:"Nh iu hnh HQG - Ta nh hnh chnh",descriptionEn:"VNU Administration Building - Administrative office building",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["iu hnh","Hnh chnh"],tagsEn:["Administration","Office"]},{id:"E1",name:"Building E1",nameVi:"E1",type:"building",lat:21.037898547008368,lng:105.78265983816675,description:"Ta nh E1 - Khu ging ng",descriptionEn:"Building E1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E2",name:"Building E2",nameVi:"E2",type:"building",lat:21.038138125326725,lng:105.78250452675343,description:"Ta nh E2 - Khu ging ng",descriptionEn:"Building E2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E3",name:"Building E3",nameVi:"E3",type:"building",lat:21.038251539453896,lng:105.78267346560932,description:"Ta nh E3 - Khu ging ng",descriptionEn:"Building E3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E4",name:"Building E4",nameVi:"E4",type:"building",lat:21.038066515983516,lng:105.7828634652073,description:"Ta nh E4 - Khu ging ng",descriptionEn:"Building E4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E5",name:"Building E5",nameVi:"E5",type:"building",lat:21.03840666563933,lng:105.7827621403332,description:"Ta nh E5 - Khu ging ng v vn phng cc khoa",descriptionEn:"Building E5 - Lecture halls and faculty offices",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng","Vn phng"],tagsEn:["Lecture Hall","Office"]},{id:"G2",name:"Building G2",nameVi:"G2",type:"building",lat:21.038066718818,lng:105.7833562104258,description:"Ta nh G2 - Khu ging ng",descriptionEn:"Building G2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G3",name:"Building G3",nameVi:"G3",type:"building",lat:21.038096961578148,lng:105.78199566240357,description:"Ta nh G3 - Khu ging ng",descriptionEn:"Building G3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G4",name:"Building G4",nameVi:"G4",type:"building",lat:21.037036202500104,lng:105.7823262311631,description:"Ta nh G4 - Khu ging ng",descriptionEn:"Building G4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G5",name:"Building G5",nameVi:"G5",type:"building",lat:21.037865450192925,lng:105.7814600713798,description:"Ta nh G5 - Khu ging ng",descriptionEn:"Building G5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G6",name:"Building G6",nameVi:"G6",type:"building",lat:21.037614060236706,lng:105.78116710074528,description:"Ta nh G6 - Khu ging ng",descriptionEn:"Building G6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G7",name:"Building G7",nameVi:"G7",type:"building",lat:21.038435221135757,lng:105.78144892714266,description:"Ta nh G7 - Khu ging ng",descriptionEn:"Building G7 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G8",name:"Building G8",nameVi:"G8",type:"building",lat:21.038258438326096,lng:105.78144555504053,description:"Ta nh G8 - Khu ging ng",descriptionEn:"Building G8 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"14A",name:"Dormitory 14A",nameVi:"14A",type:"building",lat:21.04066869104366,lng:105.78216346177845,description:"K tc x 14A - Khu nh  sinh vin",descriptionEn:"Dormitory 14A - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14B",name:"Dormitory 14B",nameVi:"14B",type:"building",lat:21.040332429257745,lng:105.78213949275664,description:"K tc x 14B - Khu nh  sinh vin",descriptionEn:"Dormitory 14B - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14C",name:"Dormitory 14C",nameVi:"14C",type:"building",lat:21.04074140951343,lng:105.78145868466765,description:"K tc x 14C - Khu nh  sinh vin",descriptionEn:"Dormitory 14C - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14D",name:"Dormitory 14D",nameVi:"14D",type:"building",lat:21.040696062046877,lng:105.7830743587856,description:"K tc x 14D - Khu nh  sinh vin",descriptionEn:"Dormitory 14D - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"Y1",name:"Health Center Y1",nameVi:"Y1",type:"building",lat:21.040337761272482,lng:105.78160682814034,description:"Ta nh Y1 - Trm Y t phc v sinh vin v cn b",descriptionEn:"Building Y1 - Health center serving students and staff",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=800",tags:["Y t","Sc khe"],tagsEn:["Medical","Health"]},{id:"SANTHECHAT",name:"Sports Field",nameVi:"Sn gio dc th cht",type:"building",lat:21.039932683929663,lng:105.78187391466429,description:"Sn gio dc th cht - Khu vc th thao ngoi tri",descriptionEn:"Sports Field - Outdoor sports area for physical education",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=800",tags:["Th thao","Sn bng"],tagsEn:["Sports","Field"]},{id:"SUNWAH",name:"Sunwah Innovation Center",nameVi:"Sunwah",type:"building",lat:21.0373549,lng:105.782269,description:"Ta nh Sunwah - Trung tm i mi Sng to v Khi nghip",descriptionEn:"Sunwah Building - Innovation and Startup Center",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800",tags:["i mi","Sng to","Startup"],tagsEn:["Innovation","Creative","Startup"]},{id:"MB",name:"MB Bank ATM",nameVi:"MB Bank",type:"building",lat:21.038383769994525,lng:105.78252247352702,description:"Cy ATM MB Bank trong khun vin trng",descriptionEn:"MB Bank ATM located within campus",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800",tags:["ATM","Ngn hng"],tagsEn:["ATM","Bank"]},{id:"HO",name:"Campus Lake",nameVi:"H",type:"building",lat:21.039027854415934,lng:105.78167624551548,description:"H nc trong khun vin trng - Khu vc th gin",descriptionEn:"Campus lake - Relaxation area with scenic views",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",tags:["H","Th gin","Cnh quan"],tagsEn:["Lake","Relaxation","Landscape"]},{id:"CONG1",name:"Xuan Thuy Main Gate",nameVi:"Cng Xun Thy",type:"building",lat:21.036791579174974,lng:105.7820570664141,description:"Cng chnh vo trng t ng Xun Thy",descriptionEn:"Main entrance gate from Xuan Thuy Street",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"CONG2",name:"Pham Van Dong Gate",nameVi:"Cng PV",type:"building",lat:21.03964484205782,lng:105.78116818655224,description:"Cng ph vo trng t ng Phm Vn ng",descriptionEn:"Secondary entrance from Pham Van Dong Street",address:"Phm Vn ng, Cu Giy, H Ni",addressEn:"Pham Van Dong, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"CONGP",name:"Side Gate",nameVi:"Cng Ph",type:"building",lat:21.040888033109084,lng:105.78267112400499,description:"Cng ph - Li vo ph",descriptionEn:"Side Gate - Secondary entrance",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"BAOVEPV",name:"Security Post 2",nameVi:"Bo v 2",type:"building",lat:21.03938956724801,lng:105.78121276017191,description:"Trm bo v cng Phm Vn ng",descriptionEn:"Security post at Pham Van Dong Gate",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Bo v","An ninh"],tagsEn:["Security","Safety"]},{id:"BAOVEXT",name:"Security Post 1",nameVi:"Bo v 1",type:"building",lat:21.03686313635906,lng:105.78225545781584,description:"Trm bo v cng Xun Thy",descriptionEn:"Security post at Xuan Thuy Gate",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Bo v","An ninh"],tagsEn:["Security","Safety"]},{id:"P_14a",name:"Parking 14A",nameVi:"Nh xe 14a",type:"building",lat:21.040230778034413,lng:105.7825580783724,description:"Nh xe khu 14A - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14A - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_14b",name:"Parking 14B",nameVi:"Nh xe 14b",type:"building",lat:21.039751005110787,lng:105.78129100352783,description:"Nh xe khu 14B - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14B - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_14c",name:"Parking 14C",nameVi:"Nh xe 14c",type:"building",lat:21.040858639860403,lng:105.78277779365209,description:"Nh xe khu 14C - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14C - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_C",name:"Parking Zone C",nameVi:"Nh xe khu C",type:"building",lat:21.039486239165825,lng:105.7817145800708,description:"Nh xe khu C - Dnh cho sinh vin v ging vin",descriptionEn:"Parking Zone C - For students and faculty",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_E",name:"Parking Zone E",nameVi:"Nh xe khu E",type:"building",lat:21.037745684639646,lng:105.78264380795207,description:"Nh xe khu E - Dnh cho sinh vin v ging vin",descriptionEn:"Parking Zone E - For students and faculty",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_Car",name:"Car Parking Lot",nameVi:"Bi  xe  t",type:"building",lat:21.03726473275222,lng:105.78174321293005,description:"Bi  xe  t - Dnh cho ging vin v khch",descriptionEn:"Car Parking Lot - For faculty and visitors",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1506521781263-d8422e82f27a?w=800",tags:[" xe"," t"],tagsEn:["Parking","Car"]},{id:"C1",name:"Building C1",nameVi:"Nh C1",type:"lecture_hall",lat:21.006998,lng:105.843146,description:"Nh C1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"C2",name:"Building C2",nameVi:"Nh C2",type:"lecture_hall",lat:21.00648,lng:105.842316,description:"Nh C2 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C3",name:"Building C3",nameVi:"Nh C3",type:"lecture_hall",lat:21.006554,lng:105.84401,description:"Nh C3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"C4",name:"Building C4",nameVi:"Nh C4",type:"lecture_hall",lat:21.006179,lng:105.844041,description:"Nh C4 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"C5",name:"Building C5",nameVi:"Nh C5",type:"lecture_hall",lat:21.005763,lng:105.844036,description:"Nh C5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C6",name:"Building C6",nameVi:"Nh C6",type:"lecture_hall",lat:21.006173,lng:105.845011,description:"Nh C6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"C7",name:"Building C7",nameVi:"Nh C7",type:"lecture_hall",lat:21.005766,lng:105.844968,description:"Nh C7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"C8",name:"Building C8",nameVi:"Nh C8",type:"lecture_hall",lat:21.00529,lng:105.844926,description:"Nh C8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"C9",name:"Building C9",nameVi:"Nh C9",type:"lecture_hall",lat:21.005835,lng:105.842323,description:"Nh C9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C10",name:"Building C10",nameVi:"Nh C10",type:"lecture_hall",lat:21.005441,lng:105.844081,description:"Nh C10 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D1",name:"Building D1",nameVi:"Nh D1",type:"lecture_hall",lat:21.004879,lng:105.843412,description:"Nh D1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D2",name:"Building D2",nameVi:"Nh D2",type:"lecture_hall",lat:21.004719,lng:105.842118,description:"Nh D2 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"D3",name:"Building D3",nameVi:"Nh D3",type:"lecture_hall",lat:21.00475,lng:105.844982,description:"Nh D3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"D4",name:"Building D4",nameVi:"Nh D4",type:"lecture_hall",lat:21.004182,lng:105.842085,description:"Nh D4 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D5",name:"Building D5",nameVi:"Nh D5",type:"lecture_hall",lat:21.004334,lng:105.844972,description:"Nh D5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D6",name:"Building D6",nameVi:"Nh D6",type:"lecture_hall",lat:21.004323,lng:105.842682,description:"Nh D6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"D7",name:"Building D7",nameVi:"Nh D7",type:"lecture_hall",lat:21.004072,lng:105.844899,description:"Nh D7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"D8",name:"Building D8",nameVi:"Nh D8",type:"lecture_hall",lat:21.003964,lng:105.842679,description:"Nh D8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D9",name:"Building D9",nameVi:"Nh D9",type:"lecture_hall",lat:21.003806,lng:105.844114,description:"Nh D9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D3_5",name:"Building D3-5",nameVi:"Nh D3-5",type:"lecture_hall",lat:21.004583,lng:105.845289,description:"Nh D3-5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B1",name:"Building B1",nameVi:"Nh B1",type:"lecture_hall",lat:21.004447,lng:105.846614,description:"Nh B1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B3",name:"Building B3",nameVi:"Nh B3",type:"lecture_hall",lat:21.005613,lng:105.847615,description:"Nh B3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"B5",name:"Building B5",nameVi:"Nh B5",type:"lecture_hall",lat:21.006424,lng:105.846885,description:"Nh B5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"B5b",name:"Building B5b",nameVi:"Nh B5b",type:"lecture_hall",lat:21.006584,lng:105.846902,description:"Nh B5b - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B6",name:"Building B6",nameVi:"Nh B6",type:"lecture_hall",lat:21.006475,lng:105.846137,description:"Nh B6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B7",name:"Building B7",nameVi:"Nh B7",type:"lecture_hall",lat:21.006044,lng:105.846114,description:"Nh B7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"B7bis",name:"Building B7bis",nameVi:"Nh B7bis",type:"lecture_hall",lat:21.005663,lng:105.846131,description:"Nh B7bis - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"B8",name:"Building B8",nameVi:"Nh B8",type:"lecture_hall",lat:21.005223,lng:105.846116,description:"Nh B8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B9",name:"Building B9",nameVi:"Nh B9",type:"lecture_hall",lat:21.006216,lng:105.847031,description:"Nh B9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B13",name:"Building B13",nameVi:"Nh B13",type:"lecture_hall",lat:21.006686,lng:105.84762,description:"Nh B13 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"HO_TIEN",name:"Tien Lake",nameVi:"H Tin",type:"checkin",lat:21.004088,lng:105.843347,description:"H Tin - Khu vc cnh quan v th gin",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",tags:["HUST","H","Checkin"]},{id:"THU_VIEN",name:"Ta Quang Buu Library",nameVi:"Th vin T Quang Bu",type:"building",lat:21.004454,lng:105.844135,description:"Th vin T Quang Bu - Th vin ln nht Bch Khoa",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1507842217121-9e9f1929c5f7?w=800",tags:["HUST","Th vin","Hc tp"]},{id:"KTX_B10",name:"Dormitory B10",nameVi:"KTX B10",type:"housing",lat:21.005268,lng:105.847516,description:"K tc x B10 dnh cho sinh vin",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1555854877-bab0e564b8d5?w=800",tags:["HUST","KTX","Sinh vin"]},{id:"TRAM_XA",name:"Medical Station",nameVi:"Trm x",type:"building",lat:21.006605,lng:105.847562,description:"Trm y t trng i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=800",tags:["HUST","Y t"]},{id:"A15",name:"Canteen A15",nameVi:"Nh n A15",type:"food",lat:21.004362,lng:105.847608,description:"Nh n sinh vin A15",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1552566626-52f8b828add9?w=800",tags:["HUST","n ung"]},{id:"NHA_KHACH",name:"HUST Guesthouse",nameVi:"Nh khch BK",type:"housing",lat:21.004091,lng:105.8479,description:"Nh khch i hc Bch Khoa",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800",tags:["HUST","Lu tr"]},{id:"A17",name:"Building A17",nameVi:"Nh A17",type:"building",lat:21.003959,lng:105.847633,description:"Ta nh A17 - Vin S phm k thut",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Vn phng"]},{id:"G_PARABOL",name:"Parabol Gate",nameVi:"Cng Parabol",type:"checkin",lat:21.005082,lng:105.841626,description:"Cng Parabol - Biu tng ca Bch Khoa",address:"ng Gii Phng",image:"https://images.unsplash.com/photo-1621644813589-9a22f365922c?w=800",tags:["HUST","Cng","Checkin"]},{id:"G_B8",name:"B8 Gate",nameVi:"Cng B8",type:"checkin",lat:21.004978,lng:105.845616,description:"Cng B8 ng Trn i Ngha",address:"ng Trn i Ngha",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Cng"]},{id:"G_BAC",name:"North Gate",nameVi:"Cng Bc",type:"checkin",lat:21.007411,lng:105.843047,description:"Cng Trn i Ngha (Cng Bc)",address:"ng Trn i Ngha",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Cng"]}],YA="https://thodia-backend-1067502227654.asia-southeast1.run.app",eq=t=>{if(["food","cafe","entertainment","lecture_hall","office","housing","job","building","checkin"].includes(t))return t;switch(t){case"service":case"shop":return"job";case"school":case"university":return"lecture_hall";default:return"building"}},tq=()=>{const{data:t=[],isLoading:e,refetch:r}=Jb({queryKey:["approved_stores"],queryFn:async()=>{try{const[l,u]=await Promise.all([fetch(`${YA}/api/stores/approved`),fetch(`${YA}/api/vouchers/active`)]),m=await l.json(),v=await u.json();if(!Array.isArray(m))return[];const b=new Map;return Array.isArray(v)&&v.forEach(a=>{b.has(a.store_id)||b.set(a.store_id,a)}),m.map(a=>{const k=b.get(a.id),M=a.is_premium===!0;return{id:`user-store-${a.id}`,name:a.name_en||a.name_vi,nameVi:a.name_vi,type:eq(a.category),category:a.category,lat:a.lat,lng:a.lng,description:a.description_vi||"",address:a.address_vi,image:a.image_url||"https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=800",isSponsored:M,is_premium:M,hasVoucher:!!k,voucherText:k?.title_vi||k?.code,reviews:[]}})}catch(l){return console.error("Li ti d liu bn :",l),[]}},staleTime:6e4});return{storesAsLocations:t,isLoading:e,refetch:r}},t0=()=>localStorage.getItem("mapbox_token")||"pk.eyJ1IjoiYW5odGh1eTA0IiwiYSI6ImNta25kbnoweDBsYTkzZnNiMncxbnZscncifQ.3RK47LOR8WkYagYydkps1w",nq=t=>{localStorage.setItem("mapbox_token",t)},ui=P.forwardRef(({className:t,type:e,...r},l)=>_.jsx("input",{type:e,className:cn("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:l,...r}));ui.displayName="Input";const rq=({onSaved:t})=>{const[e,r]=P.useState(""),[l,u]=P.useState(null),{t:m}=ia(),v=()=>{const b=e.trim();if(!b){u(m("tokenEmptyError"));return}if(b.length<20){u(m("tokenTooShortError"));return}u(null),nq(b),t(b)};return _.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-border bg-card p-5 shadow-lg",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("div",{className:"text-4xl mb-2",children:""}),_.jsx("p",{className:"font-semibold text-foreground",children:m("mapboxTokenRequired")}),_.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m("mapboxTokenInstructions")})]}),_.jsxs("div",{className:"mt-4 space-y-3",children:[_.jsx(ui,{value:e,onChange:b=>r(b.target.value),placeholder:m("tokenPlaceholder"),"aria-label":"Mapbox Access Token"}),l&&_.jsx("p",{className:"text-sm text-destructive",children:l}),_.jsx(pn,{onClick:v,className:"w-full",children:m("saveTokenAndLoad")}),_.jsx("p",{className:"text-xs text-muted-foreground text-center",children:m("tokenSavedInBrowser")})]})]})},W1="https://thodia-backend-1067502227654.asia-southeast1.run.app",iq=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},sq=({userLocation:t,onViewStore:e})=>{const{user:r}=_o(),[l,u]=P.useState([]),[m,v]=P.useState(0),[b,a]=P.useState(!0),[k,M]=P.useState(new Set);P.useEffect(()=>{if(!t)return;(async()=>{try{const Z=await(await fetch(`${W1}/api/vouchers/active`)).json();if(!Array.isArray(Z))return;const Y=Z.map(ee=>({id:ee.id,code:ee.code,discount_value:ee.discount_value,discount_type:ee.discount_type,store:{id:ee.store_id,name_vi:ee.store_name,lat:ee.store_lat,lng:ee.store_lng,address_vi:ee.address_vi},distance:iq(t.lat,t.lng,ee.store_lat,ee.store_lng)})).filter(ee=>ee.distance<=10).sort((ee,ie)=>ee.distance-ie.distance);if(u(Y),r){const ie=await(await fetch(`${W1}/api/user-vouchers?userId=${r.uid}`)).json();if(Array.isArray(ie)){const pe=ie.map(xe=>xe.voucher_id||xe.id);M(new Set(pe))}}}catch(H){console.error("Li ti voucher:",H)}})()},[t,r]),P.useEffect(()=>{if(l.length<=1)return;const K=setInterval(()=>{v(H=>(H+1)%l.length)},6e3);return()=>clearInterval(K)},[l]);const L=async(K,H)=>{if(K.stopPropagation(),!r){Gt.error("Bn cn ng nhp  lu m!");return}if(!k.has(H.id)){M(Z=>new Set(Z).add(H.id)),Gt.success(" lu m vo v!");try{if(!(await fetch(`${W1}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.uid,voucherId:H.id})})).ok)throw new Error("Failed")}catch{M(Y=>{const ee=new Set(Y);return ee.delete(H.id),ee}),Gt.error("Li kt ni, vui lng th li")}}};if(!b||l.length===0)return null;const z=l[m],O=k.has(z.id);return _.jsx("div",{className:"fixed bottom-2 left-2 z-[40] w-[90%] md:w-80",children:_.jsx(Sa,{mode:"wait",children:_.jsxs(yr.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},exit:{x:-50,opacity:0},transition:{duration:.4},onClick:()=>e(z.store.lat,z.store.lng),className:"bg-white/95 backdrop-blur shadow-xl rounded-xl border border-gray-200 overflow-hidden relative cursor-pointer hover:shadow-2xl transition-all",children:[_.jsx("button",{onClick:K=>{K.stopPropagation(),a(!1)},className:"absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-600 rounded-full z-10",children:_.jsx(di,{className:"w-4 h-4"})}),_.jsxs("div",{className:"flex",children:[_.jsxs("div",{className:"w-16 bg-gradient-to-b from-primary to-blue-600 flex items-center justify-center text-white flex-col gap-1",children:[_.jsx(qm,{className:"w-6 h-6"}),_.jsx("span",{className:"text-[10px] font-bold",children:"Voucher"})]}),_.jsxs("div",{className:"flex-1 p-3",children:[_.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase truncate mb-0.5",children:z.store.name_vi}),_.jsxs("div",{className:"flex items-baseline gap-1 mb-2",children:[_.jsxs("span",{className:"text-xl font-black text-primary",children:["-",z.discount_value,z.discount_type==="percent"?"%":"k"]}),_.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:["#",z.code]})]}),_.jsxs("div",{className:"flex justify-between items-center mt-1",children:[_.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[_.jsx(Ai,{className:"w-3 h-3 mr-1"}),z.distance.toFixed(1),"km"]}),_.jsxs(pn,{size:"sm",variant:O?"outline":"default",className:`h-7 text-xs px-2 ${O?"text-green-600 border-green-200 bg-green-50":""}`,onClick:K=>L(K,z),children:[O?_.jsx(wh,{className:"w-3 h-3 mr-1"}):_.jsx(LO,{className:"w-3 h-3 mr-1"}),O?" lu":"Lu"]})]})]})]}),_.jsx(yr.div,{initial:{width:"0%"},animate:{width:"100%"},transition:{duration:6,ease:"linear"},className:"h-1 bg-primary/50 absolute bottom-0 left-0"})]},m)})})},oq=({type:t,isSelected:e,isSponsored:r,hasVoucher:l})=>{let u=Ai,m="#64748B";switch(t){case"lecture_hall":u=Mb,m="#0EA5E9";break;case"office":u=kb,m="#475569";break;case"cafe":u=Ab,m="#D97706";break;case"entertainment":u=Ib,m="#DB2777";break;case"food":u=t_,m="#F97316";break;case"housing":u=Pb,m="#3B82F6";break;case"job":u=oh,m="#8B5CF6";break;case"building":u=Rm,m="#10B981";break;case"checkin":u=AM,m="#EC4899";break;default:u=Ai,m="#64748B"}const v=e?46:r?32:26,b=e?24:r?16:14,a=e?3:1.5;return _.jsxs("div",{className:"relative flex flex-col items-center justify-center transition-all duration-300 group cursor-pointer",style:{transform:e?"scale(1.15) translateY(-10px)":"scale(1)",zIndex:e?50:10},children:[_.jsx("div",{style:{width:v,height:v,backgroundColor:e?m:"white",border:`${a}px solid ${e?"white":m}`,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:e?`0 10px 25px -5px ${m}90`:"0 2px 4px 0 rgba(0,0,0,0.15)"},children:_.jsx(u,{size:b,color:e?"white":m,strokeWidth:2.5})}),(e||r)&&_.jsx("div",{style:{width:0,height:0,borderLeft:`${e?6:4}px solid transparent`,borderRight:`${e?6:4}px solid transparent`,borderTop:`${e?8:6}px solid ${m}`,marginTop:-1,filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.1))"}}),l&&_.jsx("div",{className:"absolute -top-1.5 -right-1.5 bg-yellow-400 border border-white rounded-full p-0.5 shadow-sm animate-bounce z-[60]",children:_.jsx(ah,{size:e?10:8,fill:"white",className:"text-white"})})]})},aq=({selectedLocation:t,onSelectLocation:e,activeCategories:r,flyToLocation:l,routeInfo:u,routeOrigin:m,routeDestination:v,multiStopRoute:b,isMultiStopMode:a,onUserLocationUpdate:k})=>{const{language:M}=ia(),{storesAsLocations:L}=tq(),z=P.useRef(null),O=P.useRef(null),K=P.useRef([]),H=P.useRef(null),Z=P.useRef(null),Y=P.useRef(null),[ee,ie]=P.useState(!1),[pe,xe]=P.useState(null),[Ce,je]=P.useState(!1),[Ue,et]=P.useState(null),Ie="route-line",ot="route-arrows",ut="route-source";P.useEffect(()=>{const vt=t0();xe(vt),je(!0)},[]);const gt=vt=>{xe(vt)};P.useEffect(()=>{if(!z.current||O.current||!pe)return;zl.accessToken=pe,O.current=new zl.Map({container:z.current,style:"mapbox://styles/mapbox/streets-v12",center:[KA.lng,KA.lat],zoom:16,pitch:45,bearing:-17.6}),O.current.addControl(new zl.NavigationControl,"bottom-right");const vt=new zl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return O.current.addControl(vt,"bottom-right"),vt.on("geolocate",st=>{const nt={lat:st.coords.latitude,lng:st.coords.longitude};et(nt),k&&k(nt)}),O.current.on("load",()=>{ie(!0),vt.trigger()}),O.current.on("click",st=>{Y.current&&(Y.current.remove(),Y.current=null);const nt=O.current?.queryRenderedFeatures(st.point,{layers:["poi-label"]});if(nt&&nt.length>0){const ze=nt[0],Se=ze.properties?.name||"a im cha c tn",We=ze.geometry.coordinates.slice(),fe=document.createElement("div");fe.className="poi-highlight-marker",mm.createRoot(fe).render(_.jsxs("div",{className:"relative -top-4 animate-bounce",children:[_.jsx(Ai,{size:46,className:"text-red-600 fill-white drop-shadow-2xl",strokeWidth:2.5}),_.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-4 h-2 bg-black/20 blur-[3px] rounded-full"})]}));const lt=new zl.Marker({element:fe,anchor:"bottom"}).setLngLat(We).addTo(O.current);Y.current=lt,O.current?.flyTo({center:We,zoom:17,pitch:50,duration:1e3,offset:[0,150]});const Tt={id:String(ze.id),name:Se,nameVi:Se,address:"a im trn bn ",description:"a im tm thy t Mapbox",lat:We[1],lng:We[0],type:"checkin",category:"checkin",image:null,is_premium:!1};e(Tt)}}),O.current.on("mouseenter","poi-label",()=>{O.current&&(O.current.getCanvas().style.cursor="pointer")}),O.current.on("mouseleave","poi-label",()=>{O.current&&(O.current.getCanvas().style.cursor="")}),()=>{O.current?.remove(),O.current=null}},[pe]),P.useEffect(()=>{if(!O.current||!ee||(K.current.forEach(({marker:ze,root:Se})=>{Se.unmount(),ze.remove()}),K.current=[],!!u||!!b))return;[...qT,...L].filter(ze=>r.includes(ze.type)).forEach(ze=>{const Se=document.createElement("div");Se.className="custom-marker-container";const We=mm.createRoot(Se),fe=t?.id===ze.id;if(We.render(_.jsx(oq,{type:ze.type,isSelected:fe,isSponsored:ze.isSponsored||!1,hasVoucher:ze.hasVoucher})),ze.type==="building"||fe){const lt=document.createElement("div"),Tt=M==="en"&&ze.name?ze.name:ze.nameVi;lt.innerHTML=`<div class="px-2 py-1 bg-slate-900/90 text-white text-[10px] font-bold rounded shadow-lg backdrop-blur-sm mt-2 whitespace-nowrap transform -translate-x-1/2 left-1/2 relative">${Tt}</div>`,Se.appendChild(lt)}Se.addEventListener("click",lt=>{lt.stopPropagation(),e(ze)});const Fe=new zl.Marker({element:Se,anchor:"bottom"}).setLngLat([ze.lng,ze.lat]).addTo(O.current);K.current.push({marker:Fe,root:We})})},[r,ee,t,e,M,L,u,b]),P.useEffect(()=>{!O.current||!l||O.current.flyTo({center:[l.lng,l.lat],zoom:18,pitch:60,duration:1500})},[l]),P.useEffect(()=>{if(!O.current||!ee)return;O.current.getLayer(ot)&&O.current.removeLayer(ot),O.current.getLayer(Ie)&&O.current.removeLayer(Ie),O.current.getSource(ut)&&O.current.removeSource(ut),H.current&&(H.current.remove(),H.current=null),Z.current&&(Z.current.remove(),Z.current=null);const vt=a?b:u;if(!vt?.geometry)return;if(O.current.addSource(ut,{type:"geojson",data:{type:"Feature",properties:{},geometry:vt.geometry}}),O.current.addLayer({id:Ie,type:"line",source:ut,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":a?"#8b5cf6":"#3b82f6","line-width":6,"line-opacity":.8}}),O.current.addLayer({id:ot,type:"symbol",source:ut,layout:{"symbol-placement":"line","symbol-spacing":80,"icon-image":"arrow-right","icon-size":.6,"icon-allow-overlap":!0,"icon-ignore-placement":!0}}),!O.current.hasImage("arrow-right")){const nt='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>',ze=new Image(24,24);ze.onload=()=>{O.current&&!O.current.hasImage("arrow-right")&&O.current.addImage("arrow-right",ze)},ze.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(nt)}if(m){const nt=document.createElement("div");mm.createRoot(nt).render(_.jsx("div",{className:"w-5 h-5 bg-blue-600 border-2 border-white rounded-full shadow-md animate-pulse"})),H.current=new zl.Marker({element:nt}).setLngLat(m).addTo(O.current)}if(!a&&v){const nt=document.createElement("div");mm.createRoot(nt).render(_.jsx("div",{className:"flex flex-col items-center pb-2",children:_.jsx(Ai,{size:32,className:"text-red-600 drop-shadow-md fill-red-600"})})),Z.current=new zl.Marker({element:nt,anchor:"bottom"}).setLngLat(v).addTo(O.current)}const st=vt.geometry.coordinates;if(st&&st.length>0){const nt=st.reduce((ze,Se)=>ze.extend(Se),new zl.LngLatBounds(st[0],st[0]));O.current.fitBounds(nt,{padding:{top:150,bottom:300,left:50,right:50},duration:1e3})}},[u,b,a,m,v,ee]);const ft=(vt,st)=>{if(O.current){tempMarkerRef.current&&tempMarkerRef.current.remove(),O.current.flyTo({center:[st,vt],zoom:17,pitch:50,duration:1500});const nt=document.createElement("div");mm.createRoot(nt).render(_.jsx(Ai,{size:40,className:"text-red-500 fill-red-500 animate-bounce"})),tempMarkerRef.current=new zl.Marker({element:nt,anchor:"bottom"}).setLngLat([st,vt]).addTo(O.current)}};return Ce?pe?_.jsxs("div",{className:"relative w-full h-full",children:[_.jsx("div",{ref:z,className:"w-full h-full"}),Ue&&_.jsx(sq,{userLocation:Ue,onViewStore:ft})]}):_.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:_.jsx(rq,{onSaved:gt})}):_.jsx("div",{className:"w-full h-full flex items-center justify-center",children:_.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},lq="https://thodia-backend-1067502227654.asia-southeast1.run.app",sy=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D"),q1=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},cq=({onLocationSelect:t,onFocus:e,onBlur:r,placeholder:l="Tm a im...",userLocation:u,resultContainerStyle:m})=>{const[v,b]=P.useState(""),[a,k]=P.useState([]),[M,L]=P.useState(!1),[z,O]=P.useState(!1),[K,H]=P.useState(!1),Z=P.useRef(null),Y=P.useRef(null),ee=P.useRef(null);P.useEffect(()=>{const Ce=je=>{Z.current&&!Z.current.contains(je.target)&&(O(!1),r&&r())};return document.addEventListener("mousedown",Ce),()=>document.removeEventListener("mousedown",Ce)},[r]),P.useEffect(()=>{if(!v){k([]),H(!1);return}O(!0),L(!0),H(!1);const Ce=setTimeout(async()=>{const je=sy(v).toLowerCase().trim(),Ue=qT.filter(ot=>{const ut=sy(ot.name).toLowerCase(),gt=sy(ot.nameVi||"").toLowerCase();return ut.includes(je)||gt.includes(je)}).map(ot=>({id:`local-${ot.id}`,name:ot.nameVi||ot.name,address:ot.address||"i hc Bch Khoa HN",lat:ot.lat,lng:ot.lng,source:"local",type:ot.type,originalData:ot,distance:u?q1(u.lat,u.lng,ot.lat,ot.lng):0})),et=t0();ee.current&&ee.current.abort(),ee.current=new AbortController;const Ie=ee.current.signal;try{let ot=[],ut=[];try{const ft=await fetch(`${lq}/api/search/stores?q=${encodeURIComponent(v)}`,{signal:Ie});if(ft.ok){const vt=await ft.json();Array.isArray(vt)&&(ot=vt.map(st=>({id:`db-${st.id}`,name:st.name_vi,address:st.address_vi,lat:st.lat,lng:st.lng,source:"database",type:st.category,originalData:st,distance:u?q1(u.lat,u.lng,st.lat,st.lng):0})))}}catch(ft){console.error("Li gi API search:",ft)}if(et){const ft=u?`&proximity=${u.lng},${u.lat}`:"",vt=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(v)}.json?access_token=${et}&country=vn&autocomplete=true&limit=10&language=vi&types=poi,address${ft}`,st=await fetch(vt,{signal:Ie});if(st.ok){const nt=await st.json();nt.features&&(ut=nt.features.map(ze=>({id:ze.id,name:ze.text,address:ze.place_name?.replace(ze.text+", ","").replace(", Vietnam",""),lat:ze.center[1],lng:ze.center[0],source:"mapbox",type:"checkin",originalData:{id:ze.id,name:ze.text,nameVi:ze.text,address:ze.place_name,lat:ze.center[1],lng:ze.center[0],type:"checkin",isMapboxResult:!0},distance:u?q1(u.lat,u.lng,ze.center[1],ze.center[0]):0})))}}const gt=[...Ue,...ot,...ut];gt.sort((ft,vt)=>{const st=sy(ft.name).toLowerCase()===je,nt=sy(vt.name).toLowerCase()===je;return st&&!nt?-1:!st&&nt?1:(ft.distance||0)-(vt.distance||0)}),k(gt)}catch(ot){ot.name!=="AbortError"&&console.error("Li tm kim:",ot)}finally{Ie.aborted||L(!1)}},400);return()=>clearTimeout(Ce)},[v,u]);const ie=Ce=>{b(Ce.name),k([]),O(!1),Y.current&&Y.current.blur(),t(Ce.originalData)},pe=()=>{b(""),k([]),Y.current&&Y.current.focus()},xe=Ce=>Ce===void 0?"":Ce<1?`${(Ce*1e3).toFixed(0)}m`:`${Ce.toFixed(1)}km`;return _.jsxs("div",{ref:Z,className:"relative w-full pointer-events-auto z-[50]",children:[z&&_.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-[1px] z-[-1] md:hidden",onClick:()=>O(!1)}),_.jsxs("div",{className:"relative flex items-center bg-white rounded-full shadow-md border border-gray-200 h-12 overflow-hidden transition-all duration-200 focus-within:shadow-lg focus-within:border-blue-300",children:[_.jsx("div",{className:"pl-4 pr-2 text-gray-400",children:M?_.jsx(ki,{className:"w-5 h-5 animate-spin text-blue-500"}):_.jsx(Pv,{className:"w-5 h-5"})}),_.jsx(ui,{ref:Y,className:"border-none shadow-none focus-visible:ring-0 focus-visible:ring-offset-0 h-full bg-transparent text-base px-2 placeholder:text-gray-400 w-full",placeholder:l,value:v,onChange:Ce=>b(Ce.target.value),onFocus:()=>O(!0),style:{fontSize:"16px"}}),v&&_.jsx(pn,{variant:"ghost",size:"icon",className:"h-9 w-9 mr-1 hover:bg-gray-100 rounded-full active:scale-95 transition-transform",onMouseDown:Ce=>{Ce.preventDefault(),pe()},children:_.jsx(di,{className:"h-5 w-5 text-gray-500"})})]}),z&&(a.length>0||M&&v||K)&&_.jsx("div",{className:`
            bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden 
            flex flex-col
            fixed top-[70px] left-2 right-2 max-h-[50vh]
            md:absolute md:top-full md:left-0 md:right-0 md:mt-2 md:max-h-[60vh]
            z-[100]
          `,children:_.jsxs("div",{className:"overflow-y-auto overscroll-contain",children:[K&&_.jsxs("div",{className:"p-3 bg-red-50 text-red-600 text-sm flex items-center gap-2 border-b border-red-100",children:[_.jsx(_O,{className:"w-4 h-4"}),_.jsx("span",{children:"Cha nhp Mapbox Token!"})]}),M&&a.length===0&&!K&&_.jsxs("div",{className:"p-4 text-center text-gray-400 text-sm flex items-center justify-center gap-2 py-8",children:[_.jsx(ki,{className:"w-5 h-5 animate-spin"})," ang tm kim..."]}),_.jsx("div",{className:"py-1",children:a.map(Ce=>_.jsxs("button",{onMouseDown:je=>{je.preventDefault(),ie(Ce)},className:"w-full text-left px-4 py-3 hover:bg-blue-50 active:bg-blue-100 transition-colors flex items-start gap-3 border-b border-gray-50 last:border-0 group",children:[_.jsx("div",{className:`mt-0.5 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm ${Ce.source==="local"?"bg-blue-100 text-blue-600":Ce.source==="database"?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-600"}`,children:Ce.source==="local"||Ce.source==="database"?_.jsx(Rm,{className:"w-4 h-4"}):_.jsx(Ai,{className:"w-4 h-4"})}),_.jsxs("div",{className:"min-w-0 flex-1",children:[_.jsxs("div",{className:"flex justify-between items-start gap-2",children:[_.jsx("h4",{className:"font-semibold text-gray-800 text-sm line-clamp-1 group-hover:text-blue-700",children:Ce.name}),u&&_.jsxs("div",{className:"flex items-center text-[10px] text-blue-600 font-bold bg-blue-50 px-1.5 py-0.5 rounded-md flex-shrink-0 whitespace-nowrap",children:[_.jsx(Hx,{className:"w-3 h-3 mr-0.5"}),xe(Ce.distance)]})]}),_.jsxs("p",{className:"text-xs text-gray-500 line-clamp-1 mt-0.5 flex items-center gap-1.5",children:[Ce.source==="local"&&_.jsx("span",{className:"bg-blue-100 text-blue-700 px-1 rounded-[3px] text-[9px] font-bold uppercase tracking-wider",children:"Trng"}),_.jsx("span",{className:"truncate",children:Ce.address})]})]})]},`${Ce.source}-${Ce.id}`))})]})}),z&&!M&&v&&a.length===0&&!K&&_.jsx("div",{className:`
              bg-white rounded-xl shadow-lg p-4 text-center text-gray-500 text-sm 
              fixed top-[70px] left-2 right-2 
              md:absolute md:top-full md:left-0 md:right-0 md:mt-2
              z-[100]
            `,children:"Khng tm thy a im no ph hp."})]})},uq=({activeCategories:t,onToggleCategory:e})=>{const{t:r}=ia(),l=[{type:"lecture_hall",labelKey:"lecture_hall",icon:Mb},{type:"office",labelKey:"office",icon:kb},{type:"food",labelKey:"food",icon:t_},{type:"cafe",labelKey:"cafe",icon:Ab},{type:"entertainment",labelKey:"entertainment",icon:Ib},{type:"housing",labelKey:"housing",icon:Pb},{type:"job",labelKey:"job",icon:oh},{type:"building",labelKey:"building",icon:Rm}];return _.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-1 scrollbar-hide",children:l.map(({type:u,labelKey:m,icon:v})=>{const b=t.includes(u);return _.jsxs(yr.button,{onClick:()=>e(u),className:cn("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all",b?"bg-primary text-primary-foreground shadow-md":"bg-card/90 backdrop-blur-sm text-muted-foreground border border-border hover:bg-muted"),whileTap:{scale:.95},children:[_.jsx(v,{className:"w-3.5 h-3.5"}),_.jsx("span",{children:r(m)})]},u)})})},Z1="https://thodia-backend-1067502227654.asia-southeast1.run.app",D3=()=>{const{user:t}=_o(),e=zv(),r=t?.uid,{data:l=[],isLoading:u}=Jb({queryKey:["favorites",r],queryFn:async()=>{if(!r)return[];try{const k=await fetch(`${Z1}/api/favorites?userId=${r}`),M=await k.json();if(!k.ok)throw new Error("Failed to fetch favorites");return M.map(L=>({id:L.location_id,name:L.location_name_en||L.location_name,nameVi:L.location_name,type:L.location_type,lat:L.location_lat,lng:L.location_lng,address:"",description:"",image:"https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=800",isSponsored:!1,hasVoucher:!1}))}catch(k){return console.error(k),[]}},enabled:!!r}),m=Bl({mutationFn:async k=>{if(!r)throw new Error("Vui lng ng nhp");const M=k.id.toString();if(!(await fetch(`${Z1}/api/favorites`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,locationId:M,name:k.nameVi||k.name,nameEn:k.name||null,lat:k.lat,lng:k.lng,type:k.type})})).ok)throw new Error("Li khi thm yu thch")},onSuccess:()=>{e.invalidateQueries({queryKey:["favorites"]}),Gt.success(" thm vo yu thch ")},onError:k=>Gt.error(k.message)}),v=Bl({mutationFn:async k=>{if(!r)throw new Error("Vui lng ng nhp");if(!(await fetch(`${Z1}/api/favorites/${k}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r})})).ok)throw new Error("Li khi xa yu thch")},onSuccess:()=>{e.invalidateQueries({queryKey:["favorites"]}),Gt.info(" xa khi yu thch")},onError:k=>Gt.error(k.message)}),b=k=>l.some(M=>M.id.toString()===k.toString()),a=k=>{b(k.id)?v.mutate(k.id):m.mutate(k)};return{favorites:l,isLoading:u,addFavorite:m.mutate,removeFavorite:v.mutate,isFavorite:b,toggleFavorite:a,isAdding:m.isPending}};var X1="focusScope.autoFocusOnMount",K1="focusScope.autoFocusOnUnmount",JA={bubbles:!1,cancelable:!0},dq="FocusScope",n0=P.forwardRef((t,e)=>{const{loop:r=!1,trapped:l=!1,onMountAutoFocus:u,onUnmountAutoFocus:m,...v}=t,[b,a]=P.useState(null),k=Ui(u),M=Ui(m),L=P.useRef(null),z=or(e,H=>a(H)),O=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(l){let H=function(ie){if(O.paused||!b)return;const pe=ie.target;b.contains(pe)?L.current=pe:Yd(L.current,{select:!0})},Z=function(ie){if(O.paused||!b)return;const pe=ie.relatedTarget;pe!==null&&(b.contains(pe)||Yd(L.current,{select:!0}))},Y=function(ie){if(document.activeElement===document.body)for(const xe of ie)xe.removedNodes.length>0&&Yd(b)};document.addEventListener("focusin",H),document.addEventListener("focusout",Z);const ee=new MutationObserver(Y);return b&&ee.observe(b,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",H),document.removeEventListener("focusout",Z),ee.disconnect()}}},[l,b,O.paused]),P.useEffect(()=>{if(b){eI.add(O);const H=document.activeElement;if(!b.contains(H)){const Y=new CustomEvent(X1,JA);b.addEventListener(X1,k),b.dispatchEvent(Y),Y.defaultPrevented||(hq(yq(L3(b)),{select:!0}),document.activeElement===H&&Yd(b))}return()=>{b.removeEventListener(X1,k),setTimeout(()=>{const Y=new CustomEvent(K1,JA);b.addEventListener(K1,M),b.dispatchEvent(Y),Y.defaultPrevented||Yd(H??document.body,{select:!0}),b.removeEventListener(K1,M),eI.remove(O)},0)}}},[b,k,M,O]);const K=P.useCallback(H=>{if(!r&&!l||O.paused)return;const Z=H.key==="Tab"&&!H.altKey&&!H.ctrlKey&&!H.metaKey,Y=document.activeElement;if(Z&&Y){const ee=H.currentTarget,[ie,pe]=fq(ee);ie&&pe?!H.shiftKey&&Y===pe?(H.preventDefault(),r&&Yd(ie,{select:!0})):H.shiftKey&&Y===ie&&(H.preventDefault(),r&&Yd(pe,{select:!0})):Y===ee&&H.preventDefault()}},[r,l,O.paused]);return _.jsx(Mn.div,{tabIndex:-1,...v,ref:z,onKeyDown:K})});n0.displayName=dq;function hq(t,{select:e=!1}={}){const r=document.activeElement;for(const l of t)if(Yd(l,{select:e}),document.activeElement!==r)return}function fq(t){const e=L3(t),r=QA(e,t),l=QA(e.reverse(),t);return[r,l]}function L3(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const u=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||u?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function QA(t,e){for(const r of t)if(!pq(r,{upTo:e}))return r}function pq(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function mq(t){return t instanceof HTMLInputElement&&"select"in t}function Yd(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&mq(t)&&e&&t.select()}}var eI=gq();function gq(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=tI(t,e),t.unshift(e)},remove(e){t=tI(t,e),t[0]?.resume()}}}function tI(t,e){const r=[...t],l=r.indexOf(e);return l!==-1&&r.splice(l,1),r}function yq(t){return t.filter(e=>e.tagName!=="A")}var Y1=0;function ZT(){P.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??nI()),document.body.insertAdjacentElement("beforeend",t[1]??nI()),Y1++,()=>{Y1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Y1--}},[])}function nI(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Fc=function(){return Fc=Object.assign||function(e){for(var r,l=1,u=arguments.length;l<u;l++){r=arguments[l];for(var m in r)Object.prototype.hasOwnProperty.call(r,m)&&(e[m]=r[m])}return e},Fc.apply(this,arguments)};function j3(t,e){var r={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(t);u<l.length;u++)e.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(t,l[u])&&(r[l[u]]=t[l[u]]);return r}function _q(t,e,r){if(r||arguments.length===2)for(var l=0,u=e.length,m;l<u;l++)(m||!(l in e))&&(m||(m=Array.prototype.slice.call(e,0,l)),m[l]=e[l]);return t.concat(m||Array.prototype.slice.call(e))}var Vx="right-scroll-bar-position",Ux="width-before-scroll-bar",xq="with-scroll-bars-hidden",vq="--removed-body-scroll-bar-size";function J1(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function wq(t,e){var r=P.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(l){var u=r.value;u!==l&&(r.value=l,r.callback(l,u))}}}})[0];return r.callback=e,r.facade}var bq=typeof window<"u"?P.useLayoutEffect:P.useEffect,rI=new WeakMap;function Tq(t,e){var r=wq(null,function(l){return t.forEach(function(u){return J1(u,l)})});return bq(function(){var l=rI.get(r);if(l){var u=new Set(l),m=new Set(t),v=r.current;u.forEach(function(b){m.has(b)||J1(b,null)}),m.forEach(function(b){u.has(b)||J1(b,v)})}rI.set(r,t)},[t]),r}function Sq(t){return t}function Eq(t,e){e===void 0&&(e=Sq);var r=[],l=!1,u={read:function(){if(l)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(m){var v=e(m,l);return r.push(v),function(){r=r.filter(function(b){return b!==v})}},assignSyncMedium:function(m){for(l=!0;r.length;){var v=r;r=[],v.forEach(m)}r={push:function(b){return m(b)},filter:function(){return r}}},assignMedium:function(m){l=!0;var v=[];if(r.length){var b=r;r=[],b.forEach(m),v=r}var a=function(){var M=v;v=[],M.forEach(m)},k=function(){return Promise.resolve().then(a)};k(),r={push:function(M){v.push(M),k()},filter:function(M){return v=v.filter(M),r}}}};return u}function Cq(t){t===void 0&&(t={});var e=Eq(null);return e.options=Fc({async:!0,ssr:!1},t),e}var O3=function(t){var e=t.sideCar,r=j3(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var l=e.read();if(!l)throw new Error("Sidecar medium not found");return P.createElement(l,Fc({},r))};O3.isSideCarExport=!0;function kq(t,e){return t.useMedium(e),O3}var z3=Cq(),Q1=function(){},r0=P.forwardRef(function(t,e){var r=P.useRef(null),l=P.useState({onScrollCapture:Q1,onWheelCapture:Q1,onTouchMoveCapture:Q1}),u=l[0],m=l[1],v=t.forwardProps,b=t.children,a=t.className,k=t.removeScrollBar,M=t.enabled,L=t.shards,z=t.sideCar,O=t.noRelative,K=t.noIsolation,H=t.inert,Z=t.allowPinchZoom,Y=t.as,ee=Y===void 0?"div":Y,ie=t.gapMode,pe=j3(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),xe=z,Ce=Tq([r,e]),je=Fc(Fc({},pe),u);return P.createElement(P.Fragment,null,M&&P.createElement(xe,{sideCar:z3,removeScrollBar:k,shards:L,noRelative:O,noIsolation:K,inert:H,setCallbacks:m,allowPinchZoom:!!Z,lockRef:r,gapMode:ie}),v?P.cloneElement(P.Children.only(b),Fc(Fc({},je),{ref:Ce})):P.createElement(ee,Fc({},je,{className:a,ref:Ce}),b))});r0.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};r0.classNames={fullWidth:Ux,zeroRight:Vx};var Aq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Iq(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Aq();return e&&t.setAttribute("nonce",e),t}function Mq(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Pq(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Nq=function(){var t=0,e=null;return{add:function(r){t==0&&(e=Iq())&&(Mq(e,r),Pq(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Rq=function(){var t=Nq();return function(e,r){P.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},B3=function(){var t=Rq(),e=function(r){var l=r.styles,u=r.dynamic;return t(l,u),null};return e},Dq={left:0,top:0,right:0,gap:0},ew=function(t){return parseInt(t||"",10)||0},Lq=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],l=e[t==="padding"?"paddingTop":"marginTop"],u=e[t==="padding"?"paddingRight":"marginRight"];return[ew(r),ew(l),ew(u)]},jq=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Dq;var e=Lq(t),r=document.documentElement.clientWidth,l=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,l-r+e[2]-e[0])}},Oq=B3(),Nm="data-scroll-locked",zq=function(t,e,r,l){var u=t.left,m=t.top,v=t.right,b=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(xq,` {
   overflow: hidden `).concat(l,`;
   padding-right: `).concat(b,"px ").concat(l,`;
  }
  body[`).concat(Nm,`] {
    overflow: hidden `).concat(l,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(l,";"),r==="margin"&&`
    padding-left: `.concat(u,`px;
    padding-top: `).concat(m,`px;
    padding-right: `).concat(v,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(b,"px ").concat(l,`;
    `),r==="padding"&&"padding-right: ".concat(b,"px ").concat(l,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Vx,` {
    right: `).concat(b,"px ").concat(l,`;
  }
  
  .`).concat(Ux,` {
    margin-right: `).concat(b,"px ").concat(l,`;
  }
  
  .`).concat(Vx," .").concat(Vx,` {
    right: 0 `).concat(l,`;
  }
  
  .`).concat(Ux," .").concat(Ux,` {
    margin-right: 0 `).concat(l,`;
  }
  
  body[`).concat(Nm,`] {
    `).concat(vq,": ").concat(b,`px;
  }
`)},iI=function(){var t=parseInt(document.body.getAttribute(Nm)||"0",10);return isFinite(t)?t:0},Bq=function(){P.useEffect(function(){return document.body.setAttribute(Nm,(iI()+1).toString()),function(){var t=iI()-1;t<=0?document.body.removeAttribute(Nm):document.body.setAttribute(Nm,t.toString())}},[])},Fq=function(t){var e=t.noRelative,r=t.noImportant,l=t.gapMode,u=l===void 0?"margin":l;Bq();var m=P.useMemo(function(){return jq(u)},[u]);return P.createElement(Oq,{styles:zq(m,!e,u,r?"":"!important")})},lb=!1;if(typeof window<"u")try{var wx=Object.defineProperty({},"passive",{get:function(){return lb=!0,!0}});window.addEventListener("test",wx,wx),window.removeEventListener("test",wx,wx)}catch{lb=!1}var dm=lb?{passive:!1}:!1,Vq=function(t){return t.tagName==="TEXTAREA"},F3=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!Vq(t)&&r[e]==="visible")},Uq=function(t){return F3(t,"overflowY")},$q=function(t){return F3(t,"overflowX")},sI=function(t,e){var r=e.ownerDocument,l=e;do{typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&(l=l.host);var u=V3(t,l);if(u){var m=U3(t,l),v=m[1],b=m[2];if(v>b)return!0}l=l.parentNode}while(l&&l!==r.body);return!1},Gq=function(t){var e=t.scrollTop,r=t.scrollHeight,l=t.clientHeight;return[e,r,l]},Hq=function(t){var e=t.scrollLeft,r=t.scrollWidth,l=t.clientWidth;return[e,r,l]},V3=function(t,e){return t==="v"?Uq(e):$q(e)},U3=function(t,e){return t==="v"?Gq(e):Hq(e)},Wq=function(t,e){return t==="h"&&e==="rtl"?-1:1},qq=function(t,e,r,l,u){var m=Wq(t,window.getComputedStyle(e).direction),v=m*l,b=r.target,a=e.contains(b),k=!1,M=v>0,L=0,z=0;do{if(!b)break;var O=U3(t,b),K=O[0],H=O[1],Z=O[2],Y=H-Z-m*K;(K||Y)&&V3(t,b)&&(L+=Y,z+=K);var ee=b.parentNode;b=ee&&ee.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ee.host:ee}while(!a&&b!==document.body||a&&(e.contains(b)||e===b));return(M&&Math.abs(L)<1||!M&&Math.abs(z)<1)&&(k=!0),k},bx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},oI=function(t){return[t.deltaX,t.deltaY]},aI=function(t){return t&&"current"in t?t.current:t},Zq=function(t,e){return t[0]===e[0]&&t[1]===e[1]},Xq=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Kq=0,hm=[];function Yq(t){var e=P.useRef([]),r=P.useRef([0,0]),l=P.useRef(),u=P.useState(Kq++)[0],m=P.useState(B3)[0],v=P.useRef(t);P.useEffect(function(){v.current=t},[t]),P.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(u));var H=_q([t.lockRef.current],(t.shards||[]).map(aI),!0).filter(Boolean);return H.forEach(function(Z){return Z.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),H.forEach(function(Z){return Z.classList.remove("allow-interactivity-".concat(u))})}}},[t.inert,t.lockRef.current,t.shards]);var b=P.useCallback(function(H,Z){if("touches"in H&&H.touches.length===2||H.type==="wheel"&&H.ctrlKey)return!v.current.allowPinchZoom;var Y=bx(H),ee=r.current,ie="deltaX"in H?H.deltaX:ee[0]-Y[0],pe="deltaY"in H?H.deltaY:ee[1]-Y[1],xe,Ce=H.target,je=Math.abs(ie)>Math.abs(pe)?"h":"v";if("touches"in H&&je==="h"&&Ce.type==="range")return!1;var Ue=window.getSelection(),et=Ue&&Ue.anchorNode,Ie=et?et===Ce||et.contains(Ce):!1;if(Ie)return!1;var ot=sI(je,Ce);if(!ot)return!0;if(ot?xe=je:(xe=je==="v"?"h":"v",ot=sI(je,Ce)),!ot)return!1;if(!l.current&&"changedTouches"in H&&(ie||pe)&&(l.current=xe),!xe)return!0;var ut=l.current||xe;return qq(ut,Z,H,ut==="h"?ie:pe)},[]),a=P.useCallback(function(H){var Z=H;if(!(!hm.length||hm[hm.length-1]!==m)){var Y="deltaY"in Z?oI(Z):bx(Z),ee=e.current.filter(function(xe){return xe.name===Z.type&&(xe.target===Z.target||Z.target===xe.shadowParent)&&Zq(xe.delta,Y)})[0];if(ee&&ee.should){Z.cancelable&&Z.preventDefault();return}if(!ee){var ie=(v.current.shards||[]).map(aI).filter(Boolean).filter(function(xe){return xe.contains(Z.target)}),pe=ie.length>0?b(Z,ie[0]):!v.current.noIsolation;pe&&Z.cancelable&&Z.preventDefault()}}},[]),k=P.useCallback(function(H,Z,Y,ee){var ie={name:H,delta:Z,target:Y,should:ee,shadowParent:Jq(Y)};e.current.push(ie),setTimeout(function(){e.current=e.current.filter(function(pe){return pe!==ie})},1)},[]),M=P.useCallback(function(H){r.current=bx(H),l.current=void 0},[]),L=P.useCallback(function(H){k(H.type,oI(H),H.target,b(H,t.lockRef.current))},[]),z=P.useCallback(function(H){k(H.type,bx(H),H.target,b(H,t.lockRef.current))},[]);P.useEffect(function(){return hm.push(m),t.setCallbacks({onScrollCapture:L,onWheelCapture:L,onTouchMoveCapture:z}),document.addEventListener("wheel",a,dm),document.addEventListener("touchmove",a,dm),document.addEventListener("touchstart",M,dm),function(){hm=hm.filter(function(H){return H!==m}),document.removeEventListener("wheel",a,dm),document.removeEventListener("touchmove",a,dm),document.removeEventListener("touchstart",M,dm)}},[]);var O=t.removeScrollBar,K=t.inert;return P.createElement(P.Fragment,null,K?P.createElement(m,{styles:Xq(u)}):null,O?P.createElement(Fq,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Jq(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Qq=kq(z3,Yq);var i0=P.forwardRef(function(t,e){return P.createElement(r0,Fc({},t,{ref:e,sideCar:Qq}))});i0.classNames=r0.classNames;var eZ=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},fm=new WeakMap,Tx=new WeakMap,Sx={},tw=0,$3=function(t){return t&&(t.host||$3(t.parentNode))},tZ=function(t,e){return e.map(function(r){if(t.contains(r))return r;var l=$3(r);return l&&t.contains(l)?l:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},nZ=function(t,e,r,l){var u=tZ(e,Array.isArray(t)?t:[t]);Sx[r]||(Sx[r]=new WeakMap);var m=Sx[r],v=[],b=new Set,a=new Set(u),k=function(L){!L||b.has(L)||(b.add(L),k(L.parentNode))};u.forEach(k);var M=function(L){!L||a.has(L)||Array.prototype.forEach.call(L.children,function(z){if(b.has(z))M(z);else try{var O=z.getAttribute(l),K=O!==null&&O!=="false",H=(fm.get(z)||0)+1,Z=(m.get(z)||0)+1;fm.set(z,H),m.set(z,Z),v.push(z),H===1&&K&&Tx.set(z,!0),Z===1&&z.setAttribute(r,"true"),K||z.setAttribute(l,"true")}catch(Y){console.error("aria-hidden: cannot operate on ",z,Y)}})};return M(e),b.clear(),tw++,function(){v.forEach(function(L){var z=fm.get(L)-1,O=m.get(L)-1;fm.set(L,z),m.set(L,O),z||(Tx.has(L)||L.removeAttribute(l),Tx.delete(L)),O||L.removeAttribute(r)}),tw--,tw||(fm=new WeakMap,fm=new WeakMap,Tx=new WeakMap,Sx={})}},XT=function(t,e,r){r===void 0&&(r="data-aria-hidden");var l=Array.from(Array.isArray(t)?t:[t]),u=eZ(t);return u?(l.push.apply(l,Array.from(u.querySelectorAll("[aria-live], script"))),nZ(l,u,r,"aria-hidden")):function(){return null}};function rZ(t){const e=iZ(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(oZ);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function iZ(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=lZ(u),b=aZ(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var sZ=Symbol("radix.slottable");function oZ(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sZ}function aZ(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function lZ(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var s0="Dialog",[G3]=sl(s0),[cZ,ql]=G3(s0),H3=t=>{const{__scopeDialog:e,children:r,open:l,defaultOpen:u,onOpenChange:m,modal:v=!0}=t,b=P.useRef(null),a=P.useRef(null),[k,M]=fh({prop:l,defaultProp:u??!1,onChange:m,caller:s0});return _.jsx(cZ,{scope:e,triggerRef:b,contentRef:a,contentId:$c(),titleId:$c(),descriptionId:$c(),open:k,onOpenChange:M,onOpenToggle:P.useCallback(()=>M(L=>!L),[M]),modal:v,children:r})};H3.displayName=s0;var W3="DialogTrigger",q3=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(W3,r),m=or(e,u.triggerRef);return _.jsx(Mn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":u.open,"aria-controls":u.contentId,"data-state":JT(u.open),...l,ref:m,onClick:Xt(t.onClick,u.onOpenToggle)})});q3.displayName=W3;var KT="DialogPortal",[uZ,Z3]=G3(KT,{forceMount:void 0}),X3=t=>{const{__scopeDialog:e,forceMount:r,children:l,container:u}=t,m=ql(KT,e);return _.jsx(uZ,{scope:e,forceMount:r,children:P.Children.map(l,v=>_.jsx(zo,{present:r||m.open,children:_.jsx(Yy,{asChild:!0,container:u,children:v})}))})};X3.displayName=KT;var mv="DialogOverlay",K3=P.forwardRef((t,e)=>{const r=Z3(mv,t.__scopeDialog),{forceMount:l=r.forceMount,...u}=t,m=ql(mv,t.__scopeDialog);return m.modal?_.jsx(zo,{present:l||m.open,children:_.jsx(hZ,{...u,ref:e})}):null});K3.displayName=mv;var dZ=rZ("DialogOverlay.RemoveScroll"),hZ=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(mv,r);return _.jsx(i0,{as:dZ,allowPinchZoom:!0,shards:[u.contentRef],children:_.jsx(Mn.div,{"data-state":JT(u.open),...l,ref:e,style:{pointerEvents:"auto",...l.style}})})}),ep="DialogContent",Y3=P.forwardRef((t,e)=>{const r=Z3(ep,t.__scopeDialog),{forceMount:l=r.forceMount,...u}=t,m=ql(ep,t.__scopeDialog);return _.jsx(zo,{present:l||m.open,children:m.modal?_.jsx(fZ,{...u,ref:e}):_.jsx(pZ,{...u,ref:e})})});Y3.displayName=ep;var fZ=P.forwardRef((t,e)=>{const r=ql(ep,t.__scopeDialog),l=P.useRef(null),u=or(e,r.contentRef,l);return P.useEffect(()=>{const m=l.current;if(m)return XT(m)},[]),_.jsx(J3,{...t,ref:u,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Xt(t.onCloseAutoFocus,m=>{m.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Xt(t.onPointerDownOutside,m=>{const v=m.detail.originalEvent,b=v.button===0&&v.ctrlKey===!0;(v.button===2||b)&&m.preventDefault()}),onFocusOutside:Xt(t.onFocusOutside,m=>m.preventDefault())})}),pZ=P.forwardRef((t,e)=>{const r=ql(ep,t.__scopeDialog),l=P.useRef(!1),u=P.useRef(!1);return _.jsx(J3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:m=>{t.onCloseAutoFocus?.(m),m.defaultPrevented||(l.current||r.triggerRef.current?.focus(),m.preventDefault()),l.current=!1,u.current=!1},onInteractOutside:m=>{t.onInteractOutside?.(m),m.defaultPrevented||(l.current=!0,m.detail.originalEvent.type==="pointerdown"&&(u.current=!0));const v=m.target;r.triggerRef.current?.contains(v)&&m.preventDefault(),m.detail.originalEvent.type==="focusin"&&u.current&&m.preventDefault()}})}),J3=P.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:l,onOpenAutoFocus:u,onCloseAutoFocus:m,...v}=t,b=ql(ep,r),a=P.useRef(null),k=or(e,a);return ZT(),_.jsxs(_.Fragment,{children:[_.jsx(n0,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:u,onUnmountAutoFocus:m,children:_.jsx(Wm,{role:"dialog",id:b.contentId,"aria-describedby":b.descriptionId,"aria-labelledby":b.titleId,"data-state":JT(b.open),...v,ref:k,onDismiss:()=>b.onOpenChange(!1)})}),_.jsxs(_.Fragment,{children:[_.jsx(mZ,{titleId:b.titleId}),_.jsx(yZ,{contentRef:a,descriptionId:b.descriptionId})]})]})}),YT="DialogTitle",Q3=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(YT,r);return _.jsx(Mn.h2,{id:u.titleId,...l,ref:e})});Q3.displayName=YT;var eD="DialogDescription",tD=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(eD,r);return _.jsx(Mn.p,{id:u.descriptionId,...l,ref:e})});tD.displayName=eD;var nD="DialogClose",rD=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(nD,r);return _.jsx(Mn.button,{type:"button",...l,ref:e,onClick:Xt(t.onClick,()=>u.onOpenChange(!1))})});rD.displayName=nD;function JT(t){return t?"open":"closed"}var iD="DialogTitleWarning",[tQ,sD]=yj(iD,{contentName:ep,titleName:YT,docsSlug:"dialog"}),mZ=({titleId:t})=>{const e=sD(iD),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return P.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},gZ="DialogDescriptionWarning",yZ=({contentRef:t,descriptionId:e})=>{const l=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${sD(gZ).contentName}}.`;return P.useEffect(()=>{const u=t.current?.getAttribute("aria-describedby");e&&u&&(document.getElementById(e)||console.warn(l))},[l,t,e]),null},oD=H3,_Z=q3,aD=X3,o0=K3,a0=Y3,l0=Q3,c0=tD,lD=rD;const u0=oD,xZ=aD,cD=P.forwardRef(({className:t,...e},r)=>_.jsx(o0,{ref:r,className:cn("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));cD.displayName=o0.displayName;const m_=P.forwardRef(({className:t,children:e,...r},l)=>_.jsxs(xZ,{children:[_.jsx(cD,{}),_.jsxs(a0,{ref:l,className:cn("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,_.jsxs(lD,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[_.jsx(di,{className:"h-4 w-4"}),_.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));m_.displayName=a0.displayName;const QT=({className:t,...e})=>_.jsx("div",{className:cn("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});QT.displayName="DialogHeader";const eS=({className:t,...e})=>_.jsx("div",{className:cn("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});eS.displayName="DialogFooter";const g_=P.forwardRef(({className:t,...e},r)=>_.jsx(l0,{ref:r,className:cn("text-lg font-semibold leading-none tracking-tight",t),...e}));g_.displayName=l0.displayName;const vZ=P.forwardRef(({className:t,...e},r)=>_.jsx(c0,{ref:r,className:cn("text-sm text-muted-foreground",t),...e}));vZ.displayName=c0.displayName;var nw="rovingFocusGroup.onEntryFocus",wZ={bubbles:!1,cancelable:!0},y_="RovingFocusGroup",[cb,uD,bZ]=Cv(y_),[TZ,d0]=sl(y_,[bZ]),[SZ,EZ]=TZ(y_),dD=P.forwardRef((t,e)=>_.jsx(cb.Provider,{scope:t.__scopeRovingFocusGroup,children:_.jsx(cb.Slot,{scope:t.__scopeRovingFocusGroup,children:_.jsx(CZ,{...t,ref:e})})}));dD.displayName=y_;var CZ=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:l,loop:u=!1,dir:m,currentTabStopId:v,defaultCurrentTabStopId:b,onCurrentTabStopIdChange:a,onEntryFocus:k,preventScrollOnEntryFocus:M=!1,...L}=t,z=P.useRef(null),O=or(e,z),K=p_(m),[H,Z]=fh({prop:v,defaultProp:b??null,onChange:a,caller:y_}),[Y,ee]=P.useState(!1),ie=Ui(k),pe=uD(r),xe=P.useRef(!1),[Ce,je]=P.useState(0);return P.useEffect(()=>{const Ue=z.current;if(Ue)return Ue.addEventListener(nw,ie),()=>Ue.removeEventListener(nw,ie)},[ie]),_.jsx(SZ,{scope:r,orientation:l,dir:K,loop:u,currentTabStopId:H,onItemFocus:P.useCallback(Ue=>Z(Ue),[Z]),onItemShiftTab:P.useCallback(()=>ee(!0),[]),onFocusableItemAdd:P.useCallback(()=>je(Ue=>Ue+1),[]),onFocusableItemRemove:P.useCallback(()=>je(Ue=>Ue-1),[]),children:_.jsx(Mn.div,{tabIndex:Y||Ce===0?-1:0,"data-orientation":l,...L,ref:O,style:{outline:"none",...t.style},onMouseDown:Xt(t.onMouseDown,()=>{xe.current=!0}),onFocus:Xt(t.onFocus,Ue=>{const et=!xe.current;if(Ue.target===Ue.currentTarget&&et&&!Y){const Ie=new CustomEvent(nw,wZ);if(Ue.currentTarget.dispatchEvent(Ie),!Ie.defaultPrevented){const ot=pe().filter(st=>st.focusable),ut=ot.find(st=>st.active),gt=ot.find(st=>st.id===H),vt=[ut,gt,...ot].filter(Boolean).map(st=>st.ref.current);pD(vt,M)}}xe.current=!1}),onBlur:Xt(t.onBlur,()=>ee(!1))})})}),hD="RovingFocusGroupItem",fD=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:l=!0,active:u=!1,tabStopId:m,children:v,...b}=t,a=$c(),k=m||a,M=EZ(hD,r),L=M.currentTabStopId===k,z=uD(r),{onFocusableItemAdd:O,onFocusableItemRemove:K,currentTabStopId:H}=M;return P.useEffect(()=>{if(l)return O(),()=>K()},[l,O,K]),_.jsx(cb.ItemSlot,{scope:r,id:k,focusable:l,active:u,children:_.jsx(Mn.span,{tabIndex:L?0:-1,"data-orientation":M.orientation,...b,ref:e,onMouseDown:Xt(t.onMouseDown,Z=>{l?M.onItemFocus(k):Z.preventDefault()}),onFocus:Xt(t.onFocus,()=>M.onItemFocus(k)),onKeyDown:Xt(t.onKeyDown,Z=>{if(Z.key==="Tab"&&Z.shiftKey){M.onItemShiftTab();return}if(Z.target!==Z.currentTarget)return;const Y=IZ(Z,M.orientation,M.dir);if(Y!==void 0){if(Z.metaKey||Z.ctrlKey||Z.altKey||Z.shiftKey)return;Z.preventDefault();let ie=z().filter(pe=>pe.focusable).map(pe=>pe.ref.current);if(Y==="last")ie.reverse();else if(Y==="prev"||Y==="next"){Y==="prev"&&ie.reverse();const pe=ie.indexOf(Z.currentTarget);ie=M.loop?MZ(ie,pe+1):ie.slice(pe+1)}setTimeout(()=>pD(ie))}}),children:typeof v=="function"?v({isCurrentTabStop:L,hasTabStop:H!=null}):v})})});fD.displayName=hD;var kZ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function AZ(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function IZ(t,e,r){const l=AZ(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(l))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(l)))return kZ[l]}function pD(t,e=!1){const r=document.activeElement;for(const l of t)if(l===r||(l.focus({preventScroll:e}),document.activeElement!==r))return}function MZ(t,e){return t.map((r,l)=>t[(e+l)%t.length])}var mD=dD,gD=fD,h0="Tabs",[PZ]=sl(h0,[d0]),yD=d0(),[NZ,tS]=PZ(h0),_D=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,onValueChange:u,defaultValue:m,orientation:v="horizontal",dir:b,activationMode:a="automatic",...k}=t,M=p_(b),[L,z]=fh({prop:l,onChange:u,defaultProp:m??"",caller:h0});return _.jsx(NZ,{scope:r,baseId:$c(),value:L,onValueChange:z,orientation:v,dir:M,activationMode:a,children:_.jsx(Mn.div,{dir:M,"data-orientation":v,...k,ref:e})})});_D.displayName=h0;var xD="TabsList",vD=P.forwardRef((t,e)=>{const{__scopeTabs:r,loop:l=!0,...u}=t,m=tS(xD,r),v=yD(r);return _.jsx(mD,{asChild:!0,...v,orientation:m.orientation,dir:m.dir,loop:l,children:_.jsx(Mn.div,{role:"tablist","aria-orientation":m.orientation,...u,ref:e})})});vD.displayName=xD;var wD="TabsTrigger",bD=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,disabled:u=!1,...m}=t,v=tS(wD,r),b=yD(r),a=ED(v.baseId,l),k=CD(v.baseId,l),M=l===v.value;return _.jsx(gD,{asChild:!0,...b,focusable:!u,active:M,children:_.jsx(Mn.button,{type:"button",role:"tab","aria-selected":M,"aria-controls":k,"data-state":M?"active":"inactive","data-disabled":u?"":void 0,disabled:u,id:a,...m,ref:e,onMouseDown:Xt(t.onMouseDown,L=>{!u&&L.button===0&&L.ctrlKey===!1?v.onValueChange(l):L.preventDefault()}),onKeyDown:Xt(t.onKeyDown,L=>{[" ","Enter"].includes(L.key)&&v.onValueChange(l)}),onFocus:Xt(t.onFocus,()=>{const L=v.activationMode!=="manual";!M&&!u&&L&&v.onValueChange(l)})})})});bD.displayName=wD;var TD="TabsContent",SD=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,forceMount:u,children:m,...v}=t,b=tS(TD,r),a=ED(b.baseId,l),k=CD(b.baseId,l),M=l===b.value,L=P.useRef(M);return P.useEffect(()=>{const z=requestAnimationFrame(()=>L.current=!1);return()=>cancelAnimationFrame(z)},[]),_.jsx(zo,{present:u||M,children:({present:z})=>_.jsx(Mn.div,{"data-state":M?"active":"inactive","data-orientation":b.orientation,role:"tabpanel","aria-labelledby":a,hidden:!z,id:k,tabIndex:0,...v,ref:e,style:{...t.style,animationDuration:L.current?"0s":void 0},children:z&&m})})});SD.displayName=TD;function ED(t,e){return`${t}-trigger-${e}`}function CD(t,e){return`${t}-content-${e}`}var RZ=_D,kD=vD,AD=bD,ID=SD;const Gy=RZ,Fm=P.forwardRef(({className:t,...e},r)=>_.jsx(kD,{ref:r,className:cn("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Fm.displayName=kD.displayName;const Vi=P.forwardRef(({className:t,...e},r)=>_.jsx(AD,{ref:r,className:cn("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));Vi.displayName=AD.displayName;const Ps=P.forwardRef(({className:t,...e},r)=>_.jsx(ID,{ref:r,className:cn("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Ps.displayName=ID.displayName;const yh=P.forwardRef(({className:t,...e},r)=>_.jsx("textarea",{className:cn("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));yh.displayName="Textarea";function DZ(t,e=[]){let r=[];function l(m,v){const b=P.createContext(v);b.displayName=m+"Context";const a=r.length;r=[...r,v];const k=L=>{const{scope:z,children:O,...K}=L,H=z?.[t]?.[a]||b,Z=P.useMemo(()=>K,Object.values(K));return _.jsx(H.Provider,{value:Z,children:O})};k.displayName=m+"Provider";function M(L,z){const O=z?.[t]?.[a]||b,K=P.useContext(O);if(K)return K;if(v!==void 0)return v;throw new Error(`\`${L}\` must be used within \`${m}\``)}return[k,M]}const u=()=>{const m=r.map(v=>P.createContext(v));return function(b){const a=b?.[t]||m;return P.useMemo(()=>({[`__scope${t}`]:{...b,[t]:a}}),[b,a])}};return u.scopeName=t,[l,LZ(u,...e)]}function LZ(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const l=t.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(m){const v=l.reduce((b,{useScope:a,scopeName:k})=>{const L=a(m)[`__scope${k}`];return{...b,...L}},{});return P.useMemo(()=>({[`__scope${e.scopeName}`]:v}),[v])}};return r.scopeName=e.scopeName,r}var jZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],nS=jZ.reduce((t,e)=>{const r=UT(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{}),rw={exports:{}},iw={};var lI;function OZ(){if(lI)return iw;lI=1;var t=Sv();function e(L,z){return L===z&&(L!==0||1/L===1/z)||L!==L&&z!==z}var r=typeof Object.is=="function"?Object.is:e,l=t.useState,u=t.useEffect,m=t.useLayoutEffect,v=t.useDebugValue;function b(L,z){var O=z(),K=l({inst:{value:O,getSnapshot:z}}),H=K[0].inst,Z=K[1];return m(function(){H.value=O,H.getSnapshot=z,a(H)&&Z({inst:H})},[L,O,z]),u(function(){return a(H)&&Z({inst:H}),L(function(){a(H)&&Z({inst:H})})},[L]),v(O),O}function a(L){var z=L.getSnapshot;L=L.value;try{var O=z();return!r(L,O)}catch{return!0}}function k(L,z){return z()}var M=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?k:b;return iw.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:M,iw}var cI;function zZ(){return cI||(cI=1,rw.exports=OZ()),rw.exports}var BZ=zZ();function FZ(){return BZ.useSyncExternalStore(VZ,()=>!0,()=>!1)}function VZ(){return()=>{}}var rS="Avatar",[UZ]=DZ(rS),[$Z,MD]=UZ(rS),PD=P.forwardRef((t,e)=>{const{__scopeAvatar:r,...l}=t,[u,m]=P.useState("idle");return _.jsx($Z,{scope:r,imageLoadingStatus:u,onImageLoadingStatusChange:m,children:_.jsx(nS.span,{...l,ref:e})})});PD.displayName=rS;var ND="AvatarImage",RD=P.forwardRef((t,e)=>{const{__scopeAvatar:r,src:l,onLoadingStatusChange:u=()=>{},...m}=t,v=MD(ND,r),b=GZ(l,m),a=Ui(k=>{u(k),v.onImageLoadingStatusChange(k)});return Wi(()=>{b!=="idle"&&a(b)},[b,a]),b==="loaded"?_.jsx(nS.img,{...m,ref:e,src:l}):null});RD.displayName=ND;var DD="AvatarFallback",LD=P.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:l,...u}=t,m=MD(DD,r),[v,b]=P.useState(l===void 0);return P.useEffect(()=>{if(l!==void 0){const a=window.setTimeout(()=>b(!0),l);return()=>window.clearTimeout(a)}},[l]),v&&m.imageLoadingStatus!=="loaded"?_.jsx(nS.span,{...u,ref:e}):null});LD.displayName=DD;function uI(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function GZ(t,{referrerPolicy:e,crossOrigin:r}){const l=FZ(),u=P.useRef(null),m=l?(u.current||(u.current=new window.Image),u.current):null,[v,b]=P.useState(()=>uI(m,t));return Wi(()=>{b(uI(m,t))},[m,t]),Wi(()=>{const a=L=>()=>{b(L)};if(!m)return;const k=a("loaded"),M=a("error");return m.addEventListener("load",k),m.addEventListener("error",M),e&&(m.referrerPolicy=e),typeof r=="string"&&(m.crossOrigin=r),()=>{m.removeEventListener("load",k),m.removeEventListener("error",M)}},[m,r,e]),v}var jD=PD,OD=RD,zD=LD;const iS=P.forwardRef(({className:t,...e},r)=>_.jsx(jD,{ref:r,className:cn("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));iS.displayName=jD.displayName;const BD=P.forwardRef(({className:t,...e},r)=>_.jsx(OD,{ref:r,className:cn("aspect-square h-full w-full",t),...e}));BD.displayName=OD.displayName;const sS=P.forwardRef(({className:t,...e},r)=>_.jsx(zD,{ref:r,className:cn("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));sS.displayName=zD.displayName;const dI="https://thodia-backend-1067502227654.asia-southeast1.run.app",FD=({storeId:t})=>{const{user:e}=_o(),[r,l]=P.useState([]),[u,m]=P.useState(5),[v,b]=P.useState(""),[a,k]=P.useState(!1),M=async()=>{if(!t)return;const O=String(t);try{const H=await(await fetch(`${dI}/api/reviews/list/${O}`)).json();Array.isArray(H)&&l(H)}catch(K){console.error("Li ti review:",K)}};P.useEffect(()=>{M()},[t]);const L=async()=>{if(!e){Gt.error("Vui lng ng nhp  nh gi!");return}if(!v.trim()){Gt.error("Vui lng nhp ni dung nh gi.");return}k(!0);try{const O=String(t);if(!(await fetch(`${dI}/api/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:O,userId:e.uid,rating:u,comment:v})})).ok)throw new Error("Failed");Gt.success("Cm n nh gi ca bn!"),window.dispatchEvent(new CustomEvent("review_updated",{detail:O})),b(""),m(5),M()}catch(O){console.error(O),Gt.error("Khng gi c nh gi")}finally{k(!1)}},z=r.length>0?(r.reduce((O,K)=>O+K.rating,0)/r.length).toFixed(1):"0.0";return _.jsxs("div",{className:"space-y-6",children:[_.jsxs("div",{className:"bg-orange-50 p-4 rounded-xl flex items-center gap-4 border border-orange-100",children:[_.jsxs("div",{className:"text-center",children:[_.jsx("h3",{className:"text-3xl font-black text-orange-600",children:z}),_.jsx("div",{className:"flex gap-0.5 justify-center my-1",children:[1,2,3,4,5].map(O=>_.jsx(ah,{className:`w-3 h-3 ${O<=Number(z)?"fill-orange-500 text-orange-500":"text-gray-300"}`},O))}),_.jsxs("p",{className:"text-xs text-gray-500",children:[r.length," nh gi"]})]}),_.jsx("div",{className:"flex-1 h-full w-[1px] bg-orange-200 mx-2"}),_.jsx("div",{className:"flex-1 text-sm text-gray-600 italic",children:'"Hy  li nh gi  gip cng ng tm c nhng a im tt nht nh!"'})]}),e?_.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[_.jsxs("h4",{className:"font-bold text-gray-800 mb-2 flex items-center gap-2",children:[_.jsx(Iy,{className:"w-4 h-4"})," Vit nh gi ca bn"]}),_.jsxs("div",{className:"flex gap-1 mb-3",children:[[1,2,3,4,5].map(O=>_.jsx("button",{onClick:()=>m(O),className:"transition-transform hover:scale-110 focus:outline-none",children:_.jsx(ah,{className:`w-6 h-6 ${O<=u?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},O)),_.jsx("span",{className:"ml-2 text-sm font-medium text-gray-500 pt-1",children:u===5?"Tuyt vi":u===4?"Hi lng":u===3?"Bnh thng":"T"})]}),_.jsx(yh,{placeholder:"Chia s tri nghim ca bn v a im ny...",value:v,onChange:O=>b(O.target.value),className:"min-h-[80px] mb-3 bg-gray-50"}),_.jsx("div",{className:"flex justify-end",children:_.jsxs(pn,{size:"sm",onClick:L,disabled:a,className:"bg-orange-500 hover:bg-orange-600 text-white",children:[a?_.jsx(ki,{className:"w-4 h-4 animate-spin mr-2"}):_.jsx(jO,{className:"w-4 h-4 mr-2"}),a?"ang gi...":"Gi nh gi"]})})]}):_.jsx("div",{className:"text-center p-4 bg-gray-100 rounded-xl text-sm text-gray-500",children:"Vui lng ng nhp  vit nh gi."}),_.jsx("div",{className:"space-y-4",children:r.length===0?_.jsx("p",{className:"text-center text-gray-400 py-4",children:"Cha c nh gi no."}):r.map(O=>_.jsxs("div",{className:"border-b pb-4 last:border-0",children:[_.jsxs("div",{className:"flex justify-between items-start mb-1",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(iS,{className:"w-8 h-8",children:_.jsx(sS,{className:"bg-blue-100 text-blue-600 text-xs",children:"U"})}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-bold text-gray-900",children:"Ngi dng n danh"}),_.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(K=>_.jsx(ah,{className:`w-3 h-3 ${K<=O.rating?"fill-yellow-400 text-yellow-400":"text-gray-200"}`},K))})]})]}),_.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(O.created_at).toLocaleDateString("vi-VN")})]}),_.jsx("p",{className:"text-sm text-gray-600 pl-10 mt-1",children:O.comment})]},O.id))})]})};var HZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],WZ=HZ.reduce((t,e)=>{const r=UT(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),_.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{}),qZ="Label",VD=P.forwardRef((t,e)=>_.jsx(WZ.label,{...t,ref:e,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));VD.displayName=qZ;var UD=VD;const ZZ=Qy("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ci=P.forwardRef(({className:t,...e},r)=>_.jsx(UD,{ref:r,className:cn(ZZ(),t),...e}));ci.displayName=UD.displayName;function XZ(t){const e=KZ(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(JZ);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function KZ(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=eX(u),b=QZ(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var YZ=Symbol("radix.slottable");function JZ(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===YZ}function QZ(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function eX(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function $D(t){const e=P.useRef({value:t,previous:t});return P.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var tX=[" ","Enter","ArrowUp","ArrowDown"],nX=[" ","Enter"],tp="Select",[f0,p0,rX]=Cv(tp),[ig]=sl(tp,[rX,Ym]),m0=Ym(),[iX,Ch]=ig(tp),[sX,oX]=ig(tp),GD=t=>{const{__scopeSelect:e,children:r,open:l,defaultOpen:u,onOpenChange:m,value:v,defaultValue:b,onValueChange:a,dir:k,name:M,autoComplete:L,disabled:z,required:O,form:K}=t,H=m0(e),[Z,Y]=P.useState(null),[ee,ie]=P.useState(null),[pe,xe]=P.useState(!1),Ce=p_(k),[je,Ue]=fh({prop:l,defaultProp:u??!1,onChange:m,caller:tp}),[et,Ie]=fh({prop:v,defaultProp:b,onChange:a,caller:tp}),ot=P.useRef(null),ut=Z?K||!!Z.closest("form"):!0,[gt,ft]=P.useState(new Set),vt=Array.from(gt).map(st=>st.props.value).join(";");return _.jsx(lP,{...H,children:_.jsxs(iX,{required:O,scope:e,trigger:Z,onTriggerChange:Y,valueNode:ee,onValueNodeChange:ie,valueNodeHasChildren:pe,onValueNodeHasChildrenChange:xe,contentId:$c(),value:et,onValueChange:Ie,open:je,onOpenChange:Ue,dir:Ce,triggerPointerDownPosRef:ot,disabled:z,children:[_.jsx(f0.Provider,{scope:e,children:_.jsx(sX,{scope:t.__scopeSelect,onNativeOptionAdd:P.useCallback(st=>{ft(nt=>new Set(nt).add(st))},[]),onNativeOptionRemove:P.useCallback(st=>{ft(nt=>{const ze=new Set(nt);return ze.delete(st),ze})},[]),children:r})}),ut?_.jsxs(p4,{"aria-hidden":!0,required:O,tabIndex:-1,name:M,autoComplete:L,value:et,onChange:st=>Ie(st.target.value),disabled:z,form:K,children:[et===void 0?_.jsx("option",{value:""}):null,Array.from(gt)]},vt):null]})})};GD.displayName=tp;var HD="SelectTrigger",WD=P.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:l=!1,...u}=t,m=m0(r),v=Ch(HD,r),b=v.disabled||l,a=or(e,v.onTriggerChange),k=p0(r),M=P.useRef("touch"),[L,z,O]=g4(H=>{const Z=k().filter(ie=>!ie.disabled),Y=Z.find(ie=>ie.value===v.value),ee=y4(Z,H,Y);ee!==void 0&&v.onValueChange(ee.value)}),K=H=>{b||(v.onOpenChange(!0),O()),H&&(v.triggerPointerDownPosRef.current={x:Math.round(H.pageX),y:Math.round(H.pageY)})};return _.jsx($b,{asChild:!0,...m,children:_.jsx(Mn.button,{type:"button",role:"combobox","aria-controls":v.contentId,"aria-expanded":v.open,"aria-required":v.required,"aria-autocomplete":"none",dir:v.dir,"data-state":v.open?"open":"closed",disabled:b,"data-disabled":b?"":void 0,"data-placeholder":m4(v.value)?"":void 0,...u,ref:a,onClick:Xt(u.onClick,H=>{H.currentTarget.focus(),M.current!=="mouse"&&K(H)}),onPointerDown:Xt(u.onPointerDown,H=>{M.current=H.pointerType;const Z=H.target;Z.hasPointerCapture(H.pointerId)&&Z.releasePointerCapture(H.pointerId),H.button===0&&H.ctrlKey===!1&&H.pointerType==="mouse"&&(K(H),H.preventDefault())}),onKeyDown:Xt(u.onKeyDown,H=>{const Z=L.current!=="";!(H.ctrlKey||H.altKey||H.metaKey)&&H.key.length===1&&z(H.key),!(Z&&H.key===" ")&&tX.includes(H.key)&&(K(),H.preventDefault())})})})});WD.displayName=HD;var qD="SelectValue",ZD=P.forwardRef((t,e)=>{const{__scopeSelect:r,className:l,style:u,children:m,placeholder:v="",...b}=t,a=Ch(qD,r),{onValueNodeHasChildrenChange:k}=a,M=m!==void 0,L=or(e,a.onValueNodeChange);return Wi(()=>{k(M)},[k,M]),_.jsx(Mn.span,{...b,ref:L,style:{pointerEvents:"none"},children:m4(a.value)?_.jsx(_.Fragment,{children:v}):m})});ZD.displayName=qD;var aX="SelectIcon",XD=P.forwardRef((t,e)=>{const{__scopeSelect:r,children:l,...u}=t;return _.jsx(Mn.span,{"aria-hidden":!0,...u,ref:e,children:l||""})});XD.displayName=aX;var lX="SelectPortal",KD=t=>_.jsx(Yy,{asChild:!0,...t});KD.displayName=lX;var np="SelectContent",YD=P.forwardRef((t,e)=>{const r=Ch(np,t.__scopeSelect),[l,u]=P.useState();if(Wi(()=>{u(new DocumentFragment)},[]),!r.open){const m=l;return m?vh.createPortal(_.jsx(JD,{scope:t.__scopeSelect,children:_.jsx(f0.Slot,{scope:t.__scopeSelect,children:_.jsx("div",{children:t.children})})}),m):null}return _.jsx(QD,{...t,ref:e})});YD.displayName=np;var Vl=10,[JD,kh]=ig(np),cX="SelectContentImpl",uX=XZ("SelectContent.RemoveScroll"),QD=P.forwardRef((t,e)=>{const{__scopeSelect:r,position:l="item-aligned",onCloseAutoFocus:u,onEscapeKeyDown:m,onPointerDownOutside:v,side:b,sideOffset:a,align:k,alignOffset:M,arrowPadding:L,collisionBoundary:z,collisionPadding:O,sticky:K,hideWhenDetached:H,avoidCollisions:Z,...Y}=t,ee=Ch(np,r),[ie,pe]=P.useState(null),[xe,Ce]=P.useState(null),je=or(e,xt=>pe(xt)),[Ue,et]=P.useState(null),[Ie,ot]=P.useState(null),ut=p0(r),[gt,ft]=P.useState(!1),vt=P.useRef(!1);P.useEffect(()=>{if(ie)return XT(ie)},[ie]),ZT();const st=P.useCallback(xt=>{const[Zt,...vn]=ut().map(Yt=>Yt.ref.current),[on]=vn.slice(-1),Sn=document.activeElement;for(const Yt of xt)if(Yt===Sn||(Yt?.scrollIntoView({block:"nearest"}),Yt===Zt&&xe&&(xe.scrollTop=0),Yt===on&&xe&&(xe.scrollTop=xe.scrollHeight),Yt?.focus(),document.activeElement!==Sn))return},[ut,xe]),nt=P.useCallback(()=>st([Ue,ie]),[st,Ue,ie]);P.useEffect(()=>{gt&&nt()},[gt,nt]);const{onOpenChange:ze,triggerPointerDownPosRef:Se}=ee;P.useEffect(()=>{if(ie){let xt={x:0,y:0};const Zt=on=>{xt={x:Math.abs(Math.round(on.pageX)-(Se.current?.x??0)),y:Math.abs(Math.round(on.pageY)-(Se.current?.y??0))}},vn=on=>{xt.x<=10&&xt.y<=10?on.preventDefault():ie.contains(on.target)||ze(!1),document.removeEventListener("pointermove",Zt),Se.current=null};return Se.current!==null&&(document.addEventListener("pointermove",Zt),document.addEventListener("pointerup",vn,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Zt),document.removeEventListener("pointerup",vn,{capture:!0})}}},[ie,ze,Se]),P.useEffect(()=>{const xt=()=>ze(!1);return window.addEventListener("blur",xt),window.addEventListener("resize",xt),()=>{window.removeEventListener("blur",xt),window.removeEventListener("resize",xt)}},[ze]);const[We,fe]=g4(xt=>{const Zt=ut().filter(Sn=>!Sn.disabled),vn=Zt.find(Sn=>Sn.ref.current===document.activeElement),on=y4(Zt,xt,vn);on&&setTimeout(()=>on.ref.current.focus())}),Fe=P.useCallback((xt,Zt,vn)=>{const on=!vt.current&&!vn;(ee.value!==void 0&&ee.value===Zt||on)&&(et(xt),on&&(vt.current=!0))},[ee.value]),lt=P.useCallback(()=>ie?.focus(),[ie]),Tt=P.useCallback((xt,Zt,vn)=>{const on=!vt.current&&!vn;(ee.value!==void 0&&ee.value===Zt||on)&&ot(xt)},[ee.value]),Kt=l==="popper"?ub:e4,sn=Kt===ub?{side:b,sideOffset:a,align:k,alignOffset:M,arrowPadding:L,collisionBoundary:z,collisionPadding:O,sticky:K,hideWhenDetached:H,avoidCollisions:Z}:{};return _.jsx(JD,{scope:r,content:ie,viewport:xe,onViewportChange:Ce,itemRefCallback:Fe,selectedItem:Ue,onItemLeave:lt,itemTextRefCallback:Tt,focusSelectedItem:nt,selectedItemText:Ie,position:l,isPositioned:gt,searchRef:We,children:_.jsx(i0,{as:uX,allowPinchZoom:!0,children:_.jsx(n0,{asChild:!0,trapped:ee.open,onMountAutoFocus:xt=>{xt.preventDefault()},onUnmountAutoFocus:Xt(u,xt=>{ee.trigger?.focus({preventScroll:!0}),xt.preventDefault()}),children:_.jsx(Wm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:m,onPointerDownOutside:v,onFocusOutside:xt=>xt.preventDefault(),onDismiss:()=>ee.onOpenChange(!1),children:_.jsx(Kt,{role:"listbox",id:ee.contentId,"data-state":ee.open?"open":"closed",dir:ee.dir,onContextMenu:xt=>xt.preventDefault(),...Y,...sn,onPlaced:()=>ft(!0),ref:je,style:{display:"flex",flexDirection:"column",outline:"none",...Y.style},onKeyDown:Xt(Y.onKeyDown,xt=>{const Zt=xt.ctrlKey||xt.altKey||xt.metaKey;if(xt.key==="Tab"&&xt.preventDefault(),!Zt&&xt.key.length===1&&fe(xt.key),["ArrowUp","ArrowDown","Home","End"].includes(xt.key)){let on=ut().filter(Sn=>!Sn.disabled).map(Sn=>Sn.ref.current);if(["ArrowUp","End"].includes(xt.key)&&(on=on.slice().reverse()),["ArrowUp","ArrowDown"].includes(xt.key)){const Sn=xt.target,Yt=on.indexOf(Sn);on=on.slice(Yt+1)}setTimeout(()=>st(on)),xt.preventDefault()}})})})})})})});QD.displayName=cX;var dX="SelectItemAlignedPosition",e4=P.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:l,...u}=t,m=Ch(np,r),v=kh(np,r),[b,a]=P.useState(null),[k,M]=P.useState(null),L=or(e,je=>M(je)),z=p0(r),O=P.useRef(!1),K=P.useRef(!0),{viewport:H,selectedItem:Z,selectedItemText:Y,focusSelectedItem:ee}=v,ie=P.useCallback(()=>{if(m.trigger&&m.valueNode&&b&&k&&H&&Z&&Y){const je=m.trigger.getBoundingClientRect(),Ue=k.getBoundingClientRect(),et=m.valueNode.getBoundingClientRect(),Ie=Y.getBoundingClientRect();if(m.dir!=="rtl"){const Sn=Ie.left-Ue.left,Yt=et.left-Sn,nr=je.left-Yt,Xn=je.width+nr,_i=Math.max(Xn,Ue.width),Kn=window.innerWidth-Vl,Er=ab(Yt,[Vl,Math.max(Vl,Kn-_i)]);b.style.minWidth=Xn+"px",b.style.left=Er+"px"}else{const Sn=Ue.right-Ie.right,Yt=window.innerWidth-et.right-Sn,nr=window.innerWidth-je.right-Yt,Xn=je.width+nr,_i=Math.max(Xn,Ue.width),Kn=window.innerWidth-Vl,Er=ab(Yt,[Vl,Math.max(Vl,Kn-_i)]);b.style.minWidth=Xn+"px",b.style.right=Er+"px"}const ot=z(),ut=window.innerHeight-Vl*2,gt=H.scrollHeight,ft=window.getComputedStyle(k),vt=parseInt(ft.borderTopWidth,10),st=parseInt(ft.paddingTop,10),nt=parseInt(ft.borderBottomWidth,10),ze=parseInt(ft.paddingBottom,10),Se=vt+st+gt+ze+nt,We=Math.min(Z.offsetHeight*5,Se),fe=window.getComputedStyle(H),Fe=parseInt(fe.paddingTop,10),lt=parseInt(fe.paddingBottom,10),Tt=je.top+je.height/2-Vl,Kt=ut-Tt,sn=Z.offsetHeight/2,xt=Z.offsetTop+sn,Zt=vt+st+xt,vn=Se-Zt;if(Zt<=Tt){const Sn=ot.length>0&&Z===ot[ot.length-1].ref.current;b.style.bottom="0px";const Yt=k.clientHeight-H.offsetTop-H.offsetHeight,nr=Math.max(Kt,sn+(Sn?lt:0)+Yt+nt),Xn=Zt+nr;b.style.height=Xn+"px"}else{const Sn=ot.length>0&&Z===ot[0].ref.current;b.style.top="0px";const nr=Math.max(Tt,vt+H.offsetTop+(Sn?Fe:0)+sn)+vn;b.style.height=nr+"px",H.scrollTop=Zt-Tt+H.offsetTop}b.style.margin=`${Vl}px 0`,b.style.minHeight=We+"px",b.style.maxHeight=ut+"px",l?.(),requestAnimationFrame(()=>O.current=!0)}},[z,m.trigger,m.valueNode,b,k,H,Z,Y,m.dir,l]);Wi(()=>ie(),[ie]);const[pe,xe]=P.useState();Wi(()=>{k&&xe(window.getComputedStyle(k).zIndex)},[k]);const Ce=P.useCallback(je=>{je&&K.current===!0&&(ie(),ee?.(),K.current=!1)},[ie,ee]);return _.jsx(fX,{scope:r,contentWrapper:b,shouldExpandOnScrollRef:O,onScrollButtonChange:Ce,children:_.jsx("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:pe},children:_.jsx(Mn.div,{...u,ref:L,style:{boxSizing:"border-box",maxHeight:"100%",...u.style}})})})});e4.displayName=dX;var hX="SelectPopperPosition",ub=P.forwardRef((t,e)=>{const{__scopeSelect:r,align:l="start",collisionPadding:u=Vl,...m}=t,v=m0(r);return _.jsx(Gb,{...v,...m,ref:e,align:l,collisionPadding:u,style:{boxSizing:"border-box",...m.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});ub.displayName=hX;var[fX,oS]=ig(np,{}),db="SelectViewport",t4=P.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:l,...u}=t,m=kh(db,r),v=oS(db,r),b=or(e,m.onViewportChange),a=P.useRef(0);return _.jsxs(_.Fragment,{children:[_.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),_.jsx(f0.Slot,{scope:r,children:_.jsx(Mn.div,{"data-radix-select-viewport":"",role:"presentation",...u,ref:b,style:{position:"relative",flex:1,overflow:"hidden auto",...u.style},onScroll:Xt(u.onScroll,k=>{const M=k.currentTarget,{contentWrapper:L,shouldExpandOnScrollRef:z}=v;if(z?.current&&L){const O=Math.abs(a.current-M.scrollTop);if(O>0){const K=window.innerHeight-Vl*2,H=parseFloat(L.style.minHeight),Z=parseFloat(L.style.height),Y=Math.max(H,Z);if(Y<K){const ee=Y+O,ie=Math.min(K,ee),pe=ee-ie;L.style.height=ie+"px",L.style.bottom==="0px"&&(M.scrollTop=pe>0?pe:0,L.style.justifyContent="flex-end")}}}a.current=M.scrollTop})})})]})});t4.displayName=db;var n4="SelectGroup",[pX,mX]=ig(n4),gX=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=$c();return _.jsx(pX,{scope:r,id:u,children:_.jsx(Mn.div,{role:"group","aria-labelledby":u,...l,ref:e})})});gX.displayName=n4;var r4="SelectLabel",i4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=mX(r4,r);return _.jsx(Mn.div,{id:u.id,...l,ref:e})});i4.displayName=r4;var gv="SelectItem",[yX,s4]=ig(gv),o4=P.forwardRef((t,e)=>{const{__scopeSelect:r,value:l,disabled:u=!1,textValue:m,...v}=t,b=Ch(gv,r),a=kh(gv,r),k=b.value===l,[M,L]=P.useState(m??""),[z,O]=P.useState(!1),K=or(e,ee=>a.itemRefCallback?.(ee,l,u)),H=$c(),Z=P.useRef("touch"),Y=()=>{u||(b.onValueChange(l),b.onOpenChange(!1))};if(l==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return _.jsx(yX,{scope:r,value:l,disabled:u,textId:H,isSelected:k,onItemTextChange:P.useCallback(ee=>{L(ie=>ie||(ee?.textContent??"").trim())},[]),children:_.jsx(f0.ItemSlot,{scope:r,value:l,disabled:u,textValue:M,children:_.jsx(Mn.div,{role:"option","aria-labelledby":H,"data-highlighted":z?"":void 0,"aria-selected":k&&z,"data-state":k?"checked":"unchecked","aria-disabled":u||void 0,"data-disabled":u?"":void 0,tabIndex:u?void 0:-1,...v,ref:K,onFocus:Xt(v.onFocus,()=>O(!0)),onBlur:Xt(v.onBlur,()=>O(!1)),onClick:Xt(v.onClick,()=>{Z.current!=="mouse"&&Y()}),onPointerUp:Xt(v.onPointerUp,()=>{Z.current==="mouse"&&Y()}),onPointerDown:Xt(v.onPointerDown,ee=>{Z.current=ee.pointerType}),onPointerMove:Xt(v.onPointerMove,ee=>{Z.current=ee.pointerType,u?a.onItemLeave?.():Z.current==="mouse"&&ee.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Xt(v.onPointerLeave,ee=>{ee.currentTarget===document.activeElement&&a.onItemLeave?.()}),onKeyDown:Xt(v.onKeyDown,ee=>{a.searchRef?.current!==""&&ee.key===" "||(nX.includes(ee.key)&&Y(),ee.key===" "&&ee.preventDefault())})})})})});o4.displayName=gv;var dy="SelectItemText",a4=P.forwardRef((t,e)=>{const{__scopeSelect:r,className:l,style:u,...m}=t,v=Ch(dy,r),b=kh(dy,r),a=s4(dy,r),k=oX(dy,r),[M,L]=P.useState(null),z=or(e,Y=>L(Y),a.onItemTextChange,Y=>b.itemTextRefCallback?.(Y,a.value,a.disabled)),O=M?.textContent,K=P.useMemo(()=>_.jsx("option",{value:a.value,disabled:a.disabled,children:O},a.value),[a.disabled,a.value,O]),{onNativeOptionAdd:H,onNativeOptionRemove:Z}=k;return Wi(()=>(H(K),()=>Z(K)),[H,Z,K]),_.jsxs(_.Fragment,{children:[_.jsx(Mn.span,{id:a.textId,...m,ref:z}),a.isSelected&&v.valueNode&&!v.valueNodeHasChildren?vh.createPortal(m.children,v.valueNode):null]})});a4.displayName=dy;var l4="SelectItemIndicator",c4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t;return s4(l4,r).isSelected?_.jsx(Mn.span,{"aria-hidden":!0,...l,ref:e}):null});c4.displayName=l4;var hb="SelectScrollUpButton",u4=P.forwardRef((t,e)=>{const r=kh(hb,t.__scopeSelect),l=oS(hb,t.__scopeSelect),[u,m]=P.useState(!1),v=or(e,l.onScrollButtonChange);return Wi(()=>{if(r.viewport&&r.isPositioned){let b=function(){const k=a.scrollTop>0;m(k)};const a=r.viewport;return b(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[r.viewport,r.isPositioned]),u?_.jsx(h4,{...t,ref:v,onAutoScroll:()=>{const{viewport:b,selectedItem:a}=r;b&&a&&(b.scrollTop=b.scrollTop-a.offsetHeight)}}):null});u4.displayName=hb;var fb="SelectScrollDownButton",d4=P.forwardRef((t,e)=>{const r=kh(fb,t.__scopeSelect),l=oS(fb,t.__scopeSelect),[u,m]=P.useState(!1),v=or(e,l.onScrollButtonChange);return Wi(()=>{if(r.viewport&&r.isPositioned){let b=function(){const k=a.scrollHeight-a.clientHeight,M=Math.ceil(a.scrollTop)<k;m(M)};const a=r.viewport;return b(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[r.viewport,r.isPositioned]),u?_.jsx(h4,{...t,ref:v,onAutoScroll:()=>{const{viewport:b,selectedItem:a}=r;b&&a&&(b.scrollTop=b.scrollTop+a.offsetHeight)}}):null});d4.displayName=fb;var h4=P.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:l,...u}=t,m=kh("SelectScrollButton",r),v=P.useRef(null),b=p0(r),a=P.useCallback(()=>{v.current!==null&&(window.clearInterval(v.current),v.current=null)},[]);return P.useEffect(()=>()=>a(),[a]),Wi(()=>{b().find(M=>M.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[b]),_.jsx(Mn.div,{"aria-hidden":!0,...u,ref:e,style:{flexShrink:0,...u.style},onPointerDown:Xt(u.onPointerDown,()=>{v.current===null&&(v.current=window.setInterval(l,50))}),onPointerMove:Xt(u.onPointerMove,()=>{m.onItemLeave?.(),v.current===null&&(v.current=window.setInterval(l,50))}),onPointerLeave:Xt(u.onPointerLeave,()=>{a()})})}),_X="SelectSeparator",f4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t;return _.jsx(Mn.div,{"aria-hidden":!0,...l,ref:e})});f4.displayName=_X;var pb="SelectArrow",xX=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=m0(r),m=Ch(pb,r),v=kh(pb,r);return m.open&&v.position==="popper"?_.jsx(Hb,{...u,...l,ref:e}):null});xX.displayName=pb;var vX="SelectBubbleInput",p4=P.forwardRef(({__scopeSelect:t,value:e,...r},l)=>{const u=P.useRef(null),m=or(l,u),v=$D(e);return P.useEffect(()=>{const b=u.current;if(!b)return;const a=window.HTMLSelectElement.prototype,M=Object.getOwnPropertyDescriptor(a,"value").set;if(v!==e&&M){const L=new Event("change",{bubbles:!0});M.call(b,e),b.dispatchEvent(L)}},[v,e]),_.jsx(Mn.select,{...r,style:{...YI,...r.style},ref:m,defaultValue:e})});p4.displayName=vX;function m4(t){return t===""||t===void 0}function g4(t){const e=Ui(t),r=P.useRef(""),l=P.useRef(0),u=P.useCallback(v=>{const b=r.current+v;e(b),(function a(k){r.current=k,window.clearTimeout(l.current),k!==""&&(l.current=window.setTimeout(()=>a(""),1e3))})(b)},[e]),m=P.useCallback(()=>{r.current="",window.clearTimeout(l.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(l.current),[]),[r,u,m]}function y4(t,e,r){const u=e.length>1&&Array.from(e).every(k=>k===e[0])?e[0]:e,m=r?t.indexOf(r):-1;let v=wX(t,Math.max(m,0));u.length===1&&(v=v.filter(k=>k!==r));const a=v.find(k=>k.textValue.toLowerCase().startsWith(u.toLowerCase()));return a!==r?a:void 0}function wX(t,e){return t.map((r,l)=>t[(e+l)%t.length])}var bX=GD,_4=WD,TX=ZD,SX=XD,EX=KD,x4=YD,CX=t4,v4=i4,w4=o4,kX=a4,AX=c4,b4=u4,T4=d4,S4=f4;const E4=bX,C4=TX,aS=P.forwardRef(({className:t,children:e,...r},l)=>_.jsxs(_4,{ref:l,className:cn("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,_.jsx(SX,{asChild:!0,children:_.jsx(qf,{className:"h-4 w-4 opacity-50"})})]}));aS.displayName=_4.displayName;const k4=P.forwardRef(({className:t,...e},r)=>_.jsx(b4,{ref:r,className:cn("flex cursor-default items-center justify-center py-1",t),...e,children:_.jsx(Dm,{className:"h-4 w-4"})}));k4.displayName=b4.displayName;const A4=P.forwardRef(({className:t,...e},r)=>_.jsx(T4,{ref:r,className:cn("flex cursor-default items-center justify-center py-1",t),...e,children:_.jsx(qf,{className:"h-4 w-4"})}));A4.displayName=T4.displayName;const lS=P.forwardRef(({className:t,children:e,position:r="popper",...l},u)=>_.jsx(EX,{children:_.jsxs(x4,{ref:u,className:cn("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[_.jsx(k4,{}),_.jsx(CX,{className:cn("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),_.jsx(A4,{})]})}));lS.displayName=x4.displayName;const IX=P.forwardRef(({className:t,...e},r)=>_.jsx(v4,{ref:r,className:cn("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));IX.displayName=v4.displayName;const Qa=P.forwardRef(({className:t,children:e,...r},l)=>_.jsxs(w4,{ref:l,className:cn("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(AX,{children:_.jsx(wh,{className:"h-4 w-4"})})}),_.jsx(kX,{children:e})]}));Qa.displayName=w4.displayName;const MX=P.forwardRef(({className:t,...e},r)=>_.jsx(S4,{ref:r,className:cn("-mx-1 my-1 h-px bg-muted",t),...e}));MX.displayName=S4.displayName;const PX="modulepreload",NX=function(t){return"/"+t},hI={},RX=function(e,r,l){let u=Promise.resolve();if(r&&r.length>0){let k=function(M){return Promise.all(M.map(L=>Promise.resolve(L).then(z=>({status:"fulfilled",value:z}),z=>({status:"rejected",reason:z}))))};var v=k;document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),a=b?.nonce||b?.getAttribute("nonce");u=k(r.map(M=>{if(M=NX(M),M in hI)return;hI[M]=!0;const L=M.endsWith(".css"),z=L?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${M}"]${z}`))return;const O=document.createElement("link");if(O.rel=L?"stylesheet":PX,L||(O.as="script"),O.crossOrigin="",O.href=M,a&&O.setAttribute("nonce",a),document.head.appendChild(O),L)return new Promise((K,H)=>{O.addEventListener("load",K),O.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${M}`)))})}))}function m(b){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=b,window.dispatchEvent(a),!a.defaultPrevented)throw b}return u.then(b=>{for(const a of b||[])a.status==="rejected"&&m(a.reason);return e().catch(m)})},DX=P.createContext(null);function LX(t,e){const r=Array.isArray(t)?t[0]:t?t.x:0,l=Array.isArray(t)?t[1]:t?t.y:0,u=Array.isArray(e)?e[0]:e?e.x:0,m=Array.isArray(e)?e[1]:e?e.y:0;return r===u&&l===m}function Uu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Uu(t[r],e[r]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),l=Object.keys(e);if(r.length!==l.length)return!1;for(const u of r)if(!e.hasOwnProperty(u)||!Uu(t[u],e[u]))return!1;return!0}return!1}function jX(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function fI(t,e){if(!t.getProjection)return;const r=t.getProjection(),l=e.getProjection();Uu(r,l)||e.setProjection(r)}function pI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function mI(t,e){const r=e.viewState||e;let l=!1;if("longitude"in r&&"latitude"in r){const u=t.center;t.center=new u.constructor(r.longitude,r.latitude),l=l||u!==t.center}if("zoom"in r){const u=t.zoom;t.zoom=r.zoom,l=l||u!==t.zoom}if("bearing"in r){const u=t.bearing;t.bearing=r.bearing,l=l||u!==t.bearing}if("pitch"in r){const u=t.pitch;t.pitch=r.pitch,l=l||u!==t.pitch}return r.padding&&!t.isPaddingEqual(r.padding)&&(l=!0,t.padding=r.padding),l}const OX=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function gI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const l of t.layers)e[l.id]=l;const r=t.layers.map(l=>{let u=null;"interactive"in l&&(u=Object.assign({},l),delete u.interactive);const m=e[l.ref];if(m){u=u||Object.assign({},l),delete u.ref;for(const v of OX)v in m&&(u[v]=m[v])}return u||l});return{...t,layers:r}}var yI={};const _I={version:8,sources:{},layers:[]},xI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},sw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},vI={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},zX=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],BX=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Vm{constructor(e,r,l){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=u=>{const m=this.props[vI[u.type]];m?m(u):u.type==="error"&&console.error(u.error)},this._onPointerEvent=u=>{(u.type==="mousemove"||u.type==="mouseout")&&this._updateHover(u);const m=this.props[xI[u.type]];m&&(this.props.interactiveLayerIds&&u.type!=="mouseover"&&u.type!=="mouseout"&&(u.features=this._hoveredFeatures||this._queryRenderedFeatures(u.point)),m(u),delete u.features)},this._onCameraEvent=u=>{if(!this._internalUpdate){const m=this.props[sw[u.type]];m&&m(u)}u.type in this._deferredEvents&&(this._deferredEvents[u.type]=!1)},this._MapClass=e,this.props=r,this._initialize(l)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const r=this.props;this.props=e;const l=this._updateSettings(e,r);l&&this._createShadowTransform(this._map);const u=this._updateSize(e),m=this._updateViewState(e,!0);this._updateStyle(e,r),this._updateStyleComponents(e,r),this._updateHandlers(e,r),(l||u||m&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){const l=Vm.savedMaps.pop();if(!l)return null;const u=l.map,m=u.getContainer();for(r.className=m.className;m.childNodes.length>0;)r.appendChild(m.childNodes[0]);u._container=r;const v=u._resizeObserver;v&&(v.disconnect(),v.observe(r)),l.setProps({...e,styleDiffing:!1}),u.resize();const{initialViewState:b}=e;return b&&(b.bounds?u.fitBounds(b.bounds,{...b.fitBoundsOptions,duration:0}):l._updateViewState(b,!1)),u.isStyleLoaded()?u.fire("load"):u.once("styledata",()=>u.fire("load")),u._update(),l}_initialize(e){const{props:r}=this,{mapStyle:l=_I}=r,u={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||FX()||null,container:e,style:gI(l)},m=u.initialViewState||u.viewState||u;if(Object.assign(u,{center:[m.longitude||0,m.latitude||0],zoom:m.zoom||0,pitch:m.pitch||0,bearing:m.bearing||0}),r.gl){const M=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=M,r.gl)}const v=new this._MapClass(u);m.padding&&v.setPadding(m.padding),r.cursor&&(v.getCanvas().style.cursor=r.cursor),this._createShadowTransform(v);const b=v._render;v._render=M=>{this._inRender=!0,b.call(v,M),this._inRender=!1};const a=v._renderTaskQueue.run;v._renderTaskQueue.run=M=>{a.call(v._renderTaskQueue,M),this._onBeforeRepaint()},v.on("render",()=>this._onAfterRepaint());const k=v.fire;v.fire=this._fireEvent.bind(this,k),v.on("resize",()=>{this._renderTransform.resize(v.transform.width,v.transform.height)}),v.on("styledata",()=>{this._updateStyleComponents(this.props,{}),fI(v.transform,this._renderTransform)}),v.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const M in xI)v.on(M,this._onPointerEvent);for(const M in sw)v.on(M,this._onCameraEvent);for(const M in vI)v.on(M,this._onEvent);this._map=v}recycle(){const r=this.map.getContainer().querySelector("[mapboxgl-children]");r?.remove(),Vm.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const r=jX(e.transform);e.painter.transform=r,this._renderTransform=r}_updateSize(e){const{viewState:r}=e;if(r){const l=this._map;if(r.width!==l.transform.width||r.height!==l.transform.height)return l.resize(),!0}return!1}_updateViewState(e,r){if(this._internalUpdate)return!1;const l=this._map,u=this._renderTransform,{zoom:m,pitch:v,bearing:b}=u,a=l.isMoving();a&&(u.cameraElevationReference="sea");const k=mI(u,{...pI(l.transform),...e});if(a&&(u.cameraElevationReference="ground"),k&&r){const M=this._deferredEvents;M.move=!0,M.zoom||(M.zoom=m!==u.zoom),M.rotate||(M.rotate=b!==u.bearing),M.pitch||(M.pitch=v!==u.pitch)}return a||mI(l.transform,e),k}_updateSettings(e,r){const l=this._map;let u=!1;for(const m of zX)if(m in e&&!Uu(e[m],r[m])){u=!0;const v=l[`set${m[0].toUpperCase()}${m.slice(1)}`];v?.call(l,e[m])}return u}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){const{mapStyle:l=_I,styleDiffing:u=!0}=e,m={diff:u};return"localIdeographFontFamily"in e&&(m.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(gI(l),m),!0}return!1}_updateStyleComponents(e,r){const l=this._map;let u=!1;return l.isStyleLoaded()&&("light"in e&&l.setLight&&!Uu(e.light,r.light)&&(u=!0,l.setLight(e.light)),"fog"in e&&l.setFog&&!Uu(e.fog,r.fog)&&(u=!0,l.setFog(e.fog)),"terrain"in e&&l.setTerrain&&!Uu(e.terrain,r.terrain)&&(!e.terrain||l.getSource(e.terrain.source))&&(u=!0,l.setTerrain(e.terrain))),u}_updateHandlers(e,r){var l,u;const m=this._map;let v=!1;for(const b of BX){const a=(l=e[b])!==null&&l!==void 0?l:!0,k=(u=r[b])!==null&&u!==void 0?u:!0;Uu(a,k)||(v=!0,a?m[b].enable(a):m[b].disable())}return v}_queryRenderedFeatures(e){const r=this._map,l=r.transform,{interactiveLayerIds:u=[]}=this.props;try{return r.transform=this._renderTransform,r.queryRenderedFeatures(e,{layers:u.filter(r.getLayer.bind(r))})}catch{return[]}finally{r.transform=l}}_updateHover(e){var r;const{props:l}=this;if(l.interactiveLayerIds&&(l.onMouseMove||l.onMouseEnter||l.onMouseLeave)){const m=e.type,v=((r=this._hoveredFeatures)===null||r===void 0?void 0:r.length)>0,b=this._queryRenderedFeatures(e.point),a=b.length>0;!a&&v&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=b,a&&!v&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=m}else this._hoveredFeatures=null}_fireEvent(e,r,l){const u=this._map,m=u.transform,v=typeof r=="string"?r:r.type;return v==="move"&&this._updateViewState(this.props,!1),v in sw&&(typeof r=="object"&&(r.viewState=pI(m)),this._map.isMoving())?(u.transform=this._renderTransform,e.call(u,r,l),u.transform=m,u):(e.call(u,r,l),u)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const l in this._deferredEvents)this._deferredEvents[l]&&e.fire(l);this._internalUpdate=!1;const r=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{fI(this._renderTransform,r),e.transform=r}}}Vm.savedMaps=[];function FX(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||yI.MapboxAccessToken}catch{}try{t=t||yI.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const VX=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function UX(t){if(!t)return null;const e=t.map,r={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:l=>{const u=e.transform;e.transform=t.transform;const m=e.project(l);return e.transform=u,m},unproject:l=>{const u=e.transform;e.transform=t.transform;const m=e.unproject(l);return e.transform=u,m},queryTerrainElevation:(l,u)=>{const m=e.transform;e.transform=t.transform;const v=e.queryTerrainElevation(l,u);return e.transform=m,v},queryRenderedFeatures:(l,u)=>{const m=e.transform;e.transform=t.transform;const v=e.queryRenderedFeatures(l,u);return e.transform=m,v}};for(const l of $X(e))!(l in r)&&!VX.includes(l)&&(r[l]=e[l].bind(e));return r}function $X(t){const e=new Set;let r=t;for(;r;){for(const l of Object.getOwnPropertyNames(r))l[0]!=="_"&&typeof t[l]=="function"&&l!=="fire"&&l!=="setEventedParent"&&e.add(l);r=Object.getPrototypeOf(r)}return Array.from(e)}const GX=typeof document<"u"?P.useLayoutEffect:P.useEffect,HX=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function WX(t,e){for(const l of HX)l in e&&(t[l]=e[l]);const{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;r&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(r,l=>{l&&console.error(l)},!0)}const g0=P.createContext(null);function qX(t,e,r){const l=P.useContext(DX),[u,m]=P.useState(null),v=P.useRef(),{current:b}=P.useRef({mapLib:null,map:null});P.useEffect(()=>{const M=t.mapLib;let L=!0,z;return Promise.resolve(M||r).then(O=>{if(!L)return;if(!O)throw new Error("Invalid mapLib");const K="Map"in O?O:O.default;if(!K.Map)throw new Error("Invalid mapLib");if(WX(K,t),!K.supported||K.supported(t))t.reuseMaps&&(z=Vm.reuse(t,v.current)),z||(z=new Vm(K.Map,t,v.current)),b.map=UX(z),b.mapLib=K,m(z),l?.onMapMount(b.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(O=>{const{onError:K}=t;K?K({type:"error",target:null,originalEvent:null,error:O}):console.error(O)}),()=>{L=!1,z&&(l?.onMapUnmount(t.id),t.reuseMaps?z.recycle():z.destroy())}},[]),GX(()=>{u&&u.setProps(t)}),P.useImperativeHandle(e,()=>b.map,[u]);const a=P.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),k={height:"100%"};return P.createElement("div",{id:t.id,ref:v,style:a},u&&P.createElement(g0.Provider,{value:b},P.createElement("div",{"mapboxgl-children":"",style:k},t.children)))}const ZX=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function lp(t,e){if(!t||!e)return;const r=t.style;for(const l in e){const u=e[l];Number.isFinite(u)&&!ZX.test(l)?r[l]=`${u}px`:r[l]=u}}function XX(t,e){const{map:r,mapLib:l}=P.useContext(g0),u=P.useRef({props:t});u.current.props=t;const m=P.useMemo(()=>{let H=!1;P.Children.forEach(t.children,ee=>{ee&&(H=!0)});const Z={...t,element:H?document.createElement("div"):null},Y=new l.Marker(Z);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",ee=>{var ie,pe;(pe=(ie=u.current.props).onClick)===null||pe===void 0||pe.call(ie,{type:"click",target:Y,originalEvent:ee})}),Y.on("dragstart",ee=>{var ie,pe;const xe=ee;xe.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDragStart)===null||pe===void 0||pe.call(ie,xe)}),Y.on("drag",ee=>{var ie,pe;const xe=ee;xe.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDrag)===null||pe===void 0||pe.call(ie,xe)}),Y.on("dragend",ee=>{var ie,pe;const xe=ee;xe.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDragEnd)===null||pe===void 0||pe.call(ie,xe)}),Y},[]);P.useEffect(()=>(m.addTo(r.getMap()),()=>{m.remove()}),[]);const{longitude:v,latitude:b,offset:a,style:k,draggable:M=!1,popup:L=null,rotation:z=0,rotationAlignment:O="auto",pitchAlignment:K="auto"}=t;return P.useEffect(()=>{lp(m.getElement(),k)},[k]),P.useImperativeHandle(e,()=>m,[]),(m.getLngLat().lng!==v||m.getLngLat().lat!==b)&&m.setLngLat([v,b]),a&&!LX(m.getOffset(),a)&&m.setOffset(a),m.isDraggable()!==M&&m.setDraggable(M),m.getRotation()!==z&&m.setRotation(z),m.getRotationAlignment()!==O&&m.setRotationAlignment(O),m.getPitchAlignment()!==K&&m.setPitchAlignment(K),m.getPopup()!==L&&m.setPopup(L),vh.createPortal(t.children,m.getElement())}const KX=P.memo(P.forwardRef(XX));function wI(t){return new Set(t?t.trim().split(/\s+/):[])}function YX(t,e){const{map:r,mapLib:l}=P.useContext(g0),u=P.useMemo(()=>document.createElement("div"),[]),m=P.useRef({props:t});m.current.props=t;const v=P.useMemo(()=>{const b={...t},a=new l.Popup(b);return a.setLngLat([t.longitude,t.latitude]),a.once("open",k=>{var M,L;(L=(M=m.current.props).onOpen)===null||L===void 0||L.call(M,k)}),a},[]);if(P.useEffect(()=>{const b=a=>{var k,M;(M=(k=m.current.props).onClose)===null||M===void 0||M.call(k,a)};return v.on("close",b),v.setDOMContent(u).addTo(r.getMap()),()=>{v.off("close",b),v.isOpen()&&v.remove()}},[]),P.useEffect(()=>{lp(v.getElement(),t.style)},[t.style]),P.useImperativeHandle(e,()=>v,[]),v.isOpen()&&((v.getLngLat().lng!==t.longitude||v.getLngLat().lat!==t.latitude)&&v.setLngLat([t.longitude,t.latitude]),t.offset&&!Uu(v.options.offset,t.offset)&&v.setOffset(t.offset),(v.options.anchor!==t.anchor||v.options.maxWidth!==t.maxWidth)&&(v.options.anchor=t.anchor,v.setMaxWidth(t.maxWidth)),v.options.className!==t.className)){const b=wI(v.options.className),a=wI(t.className);for(const k of b)a.has(k)||v.removeClassName(k);for(const k of a)b.has(k)||v.addClassName(k);v.options.className=t.className}return vh.createPortal(t.children,u)}P.memo(P.forwardRef(YX));function __(t,e,r,l){const u=P.useContext(g0),m=P.useMemo(()=>t(u),[]);return P.useEffect(()=>{const v=e,b=null,a=typeof e=="function"?e:null,{map:k}=u;return k.hasControl(m)||(k.addControl(m,v?.position),b&&b(u)),()=>{a&&a(u),k.hasControl(m)&&k.removeControl(m)}},[]),m}function JX(t){const e=__(({mapLib:r})=>new r.AttributionControl(t),{position:t.position});return P.useEffect(()=>{lp(e._container,t.style)},[t.style]),null}P.memo(JX);function QX(t){const e=__(({mapLib:r})=>new r.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return P.useEffect(()=>{lp(e._controlContainer,t.style)},[t.style]),null}P.memo(QX);function eK(t,e){const r=P.useRef({props:t}),l=__(({mapLib:u})=>{const m=new u.GeolocateControl(t),v=m._setupUI;return m._setupUI=b=>{m._container.hasChildNodes()||v(b)},m.on("geolocate",b=>{var a,k;(k=(a=r.current.props).onGeolocate)===null||k===void 0||k.call(a,b)}),m.on("error",b=>{var a,k;(k=(a=r.current.props).onError)===null||k===void 0||k.call(a,b)}),m.on("outofmaxbounds",b=>{var a,k;(k=(a=r.current.props).onOutOfMaxBounds)===null||k===void 0||k.call(a,b)}),m.on("trackuserlocationstart",b=>{var a,k;(k=(a=r.current.props).onTrackUserLocationStart)===null||k===void 0||k.call(a,b)}),m.on("trackuserlocationend",b=>{var a,k;(k=(a=r.current.props).onTrackUserLocationEnd)===null||k===void 0||k.call(a,b)}),m},{position:t.position});return r.current.props=t,P.useImperativeHandle(e,()=>l,[]),P.useEffect(()=>{lp(l._container,t.style)},[t.style]),null}P.memo(P.forwardRef(eK));function tK(t){const e=__(({mapLib:r})=>new r.NavigationControl(t),{position:t.position});return P.useEffect(()=>{lp(e._container,t.style)},[t.style]),null}const nK=P.memo(tK);function rK(t){const e=__(({mapLib:m})=>new m.ScaleControl(t),{position:t.position}),r=P.useRef(t),l=r.current;r.current=t;const{style:u}=t;return t.maxWidth!==void 0&&t.maxWidth!==l.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==l.unit&&e.setUnit(t.unit),P.useEffect(()=>{lp(e._container,u)},[u]),null}P.memo(rK);const iK=RX(()=>Promise.resolve().then(()=>QW),void 0),sK=P.forwardRef(function(e,r){return qX(e,r,iK)}),oK=KX,aK=nK,lK=void 0,cK=({isOpen:t,onClose:e,onConfirm:r,initialLat:l,initialLng:u})=>{const m=P.useRef(null),v=P.useRef(null),[b,a]=P.useState({latitude:l||21.0285,longitude:u||105.8542,zoom:15}),[k,M]=P.useState({lat:l||21.0285,lng:u||105.8542}),[L,z]=P.useState(""),[O,K]=P.useState([]),[H,Z]=P.useState(!1),[Y,ee]=P.useState(!1);P.useEffect(()=>{if(t){const Ie=l||21.0285,ot=u||105.8542;M({lat:Ie,lng:ot}),a(ut=>({...ut,latitude:Ie,longitude:ot})),l&&u?Ue(Ie,ot):z(""),K([]),setTimeout(()=>m.current?.resize(),200)}},[t,l,u]);const ie=(Ie,ot)=>{m.current?.flyTo({center:[ot,Ie],zoom:16,duration:1500,essential:!0})},pe=Ie=>{const ot=Ie.target.value;z(ot),v.current&&clearTimeout(v.current),ot.length>2?(Z(!0),v.current=setTimeout(async()=>{try{const gt=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(ot)}&countrycodes=vn&limit=5&addressdetails=1`)).json();K(gt)}catch(ut){console.error(ut)}finally{Z(!1)}},500)):(K([]),Z(!1))},xe=Ie=>{const ot=parseFloat(Ie.lat),ut=parseFloat(Ie.lon);M({lat:ot,lng:ut}),ie(ot,ut),z(Ie.display_name),K([])},Ce=Ie=>{const{lng:ot,lat:ut}=Ie.lngLat;M({lat:ut,lng:ot})},je=async Ie=>{const{lng:ot,lat:ut}=Ie.lngLat;M({lat:ut,lng:ot}),await Ue(ut,ot)},Ue=async(Ie,ot)=>{ee(!0);try{const gt=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${Ie}&lon=${ot}&zoom=18&addressdetails=1`)).json();gt&&gt.display_name&&z(gt.display_name)}catch(ut){console.error("Li ly a ch:",ut)}finally{ee(!1)}},et=()=>{r(k.lat,k.lng,L),e()};return _.jsx(u0,{open:t,onOpenChange:e,children:_.jsxs(m_,{className:"max-w-2xl h-[85vh] flex flex-col p-0 gap-0 z-[110]",children:[_.jsx(QT,{className:"p-4 border-b",children:_.jsx(g_,{children:"Chn v tr"})}),_.jsxs("div",{className:"flex-1 relative w-full h-full bg-gray-100",children:[_.jsxs("div",{className:"absolute top-4 left-4 right-14 z-20 flex flex-col gap-1",children:[_.jsxs("div",{className:"flex shadow-xl rounded-lg overflow-hidden bg-white ring-1 ring-gray-200",children:[_.jsx(ui,{value:L,onChange:pe,placeholder:"Tm kim a ch...",className:"h-11 bg-white border-0 rounded-none focus-visible:ring-0 pl-4 text-base"}),_.jsx("div",{className:"flex items-center justify-center px-3 bg-white text-gray-400",children:H||Y?_.jsx(ki,{className:"w-5 h-5 animate-spin text-primary"}):L?_.jsx("button",{onClick:()=>{z(""),K([])},children:_.jsx(di,{className:"w-5 h-5 hover:text-red-500"})}):_.jsx(Pv,{className:"w-5 h-5"})})]}),O.length>0&&_.jsx("div",{className:"bg-white rounded-lg shadow-2xl border overflow-hidden max-h-60 overflow-y-auto mt-1 animate-in fade-in slide-in-from-top-2",children:O.map((Ie,ot)=>_.jsxs("div",{onClick:()=>xe(Ie),className:"p-3 text-sm hover:bg-blue-50 cursor-pointer border-b last:border-0 flex items-start gap-3 transition-colors",children:[_.jsx("div",{className:"bg-gray-100 p-1.5 rounded-full flex-shrink-0 mt-0.5",children:_.jsx(Ai,{className:"w-4 h-4 text-red-500"})}),_.jsxs("div",{className:"flex flex-col",children:[_.jsx("span",{className:"font-medium text-gray-900 line-clamp-1",children:Ie.name||Ie.display_name.split(",")[0]}),_.jsx("span",{className:"text-xs text-gray-500 line-clamp-2",children:Ie.display_name})]})]},ot))})]}),_.jsxs(sK,{ref:m,...b,onMove:Ie=>a(Ie.viewState),mapStyle:"mapbox://styles/mapbox/streets-v12",mapboxAccessToken:lK,className:"w-full h-full",style:{width:"100%",height:"100%"},children:[_.jsx(aK,{position:"bottom-right"}),_.jsx(oK,{latitude:k.lat,longitude:k.lng,anchor:"bottom",draggable:!0,onDrag:Ce,onDragEnd:je,children:_.jsxs("div",{className:"relative flex flex-col items-center group cursor-grab active:cursor-grabbing hover:scale-110 transition-transform",children:[_.jsx("div",{className:"absolute -top-8 bg-black/80 text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Ko ti"}),_.jsx(Ai,{className:"w-12 h-12 text-red-600 drop-shadow-2xl fill-white"}),_.jsx("div",{className:"w-3 h-1 bg-black/30 rounded-full blur-[2px]"})]})})]}),_.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur px-4 py-2 rounded-full shadow-lg border text-xs font-medium text-gray-600 pointer-events-none flex items-center gap-2",children:Y?_.jsxs(_.Fragment,{children:[_.jsx(ki,{className:"w-3 h-3 animate-spin"})," ang ly a ch..."]}):"Ko th ghim   cp nht a ch"})]}),_.jsxs(eS,{className:"p-4 border-t bg-white",children:[_.jsx(pn,{variant:"ghost",onClick:e,children:"Hy"}),_.jsxs(pn,{onClick:et,className:"gap-2 bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[_.jsx(Ai,{className:"w-4 h-4"})," Xc nhn v tr ny"]})]})]})})},bI="https://thodia-backend-1067502227654.asia-southeast1.run.app",cS=({isOpen:t,onClose:e,onSubmit:r,initialData:l,isSubmitting:u,customStoreId:m,onUpgradeClick:v})=>{const{user:b}=_o(),M=l?.is_premium===!0||!!m,[L,z]=P.useState({name_vi:"",address_vi:"",phone:"",description_vi:"",category:"cafe",image_url:"",lat:21.0285,lng:105.8542}),[O,K]=P.useState(null),[H,Z]=P.useState(""),[Y,ee]=P.useState([]),[ie,pe]=P.useState([]),[xe,Ce]=P.useState([]),[je,Ue]=P.useState(!1),[et,Ie]=P.useState(!1);P.useEffect(()=>{if(t)if(l){z({name_vi:l.name_vi||l.nameVi||"",address_vi:l.address_vi||l.address||"",phone:l.phone||"",description_vi:l.description_vi||l.description||"",category:l.category||l.type||"cafe",image_url:l.image_url||l.image||"",lat:l.lat||21.0285,lng:l.lng||105.8542}),Z(l.image_url||l.image||""),K(null);const vt=m||l.id;if(vt&&M){const st=String(vt).replace("user-store-","");fetch(`${bI}/api/stores/${st}/gallery`).then(nt=>nt.json()).then(nt=>{Array.isArray(nt)&&Ce(nt)}).catch(console.error)}}else z({name_vi:"",address_vi:"",phone:"",description_vi:"",category:"cafe",image_url:"",lat:21.0285,lng:105.8542}),Z(""),K(null),ee([]),pe([]),Ce([])},[t,l,m,M]);const ot=(vt,st,nt)=>{z(ze=>({...ze,lat:vt,lng:st,address_vi:nt||ze.address_vi})),Gt.success(" cp nht v tr!")},ut=vt=>{const st=vt.target.files?.[0];st&&(K(st),Z(URL.createObjectURL(st)))},gt=vt=>{const st=vt.target.files;if(st){const nt=Array.from(st);if(xe.length+Y.length+nt.length>10){Gt.error("Ti a 10 nh trong th vin.");return}ee(We=>[...We,...nt]);const Se=nt.map(We=>URL.createObjectURL(We));pe(We=>[...We,...Se])}},ft=async vt=>{vt.preventDefault(),Ie(!0);try{const st=m||l?.id,nt=new FormData;if(nt.append("userId",b?.uid||""),st&&nt.append("id",String(st).replace("user-store-","")),nt.append("name_vi",L.name_vi),nt.append("address_vi",L.address_vi),nt.append("phone",L.phone),nt.append("category",L.category),nt.append("lat",String(L.lat)),nt.append("lng",String(L.lng)),nt.append("image_url",L.image_url),M&&nt.append("description_vi",L.description_vi),m?nt.append("is_premium","true"):nt.append("is_premium",l?.is_premium?"true":"false"),O&&nt.append("avatar",O),M&&Y.length>0&&Y.forEach(Se=>{nt.append("gallery",Se)}),!(await fetch(`${bI}/api/stores/save`,{method:"POST",body:nt})).ok)throw new Error("Li lu d liu");Gt.success(m?" cp nht a im!":" lu ca hng!"),r&&await r(L),e()}catch(st){console.error(st),Gt.error("C li xy ra: "+st.message)}finally{Ie(!1)}};return _.jsxs(_.Fragment,{children:[_.jsx(u0,{open:t,onOpenChange:e,children:_.jsxs(m_,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-white p-0 gap-0 rounded-xl z-[100]",children:[_.jsxs(QT,{className:"p-6 border-b sticky top-0 bg-white z-20 flex flex-row items-center justify-between",children:[_.jsx(g_,{className:"text-xl font-bold",children:m?"Chnh sa a im (Admin)":l?"Chnh sa ca hng":"Thm ca hng mi"}),M?_.jsxs("span",{className:"flex items-center gap-1 text-xs font-bold bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full border border-yellow-200 shadow-sm animate-pulse",children:[_.jsx(nl,{className:"w-3 h-3 fill-yellow-500 text-yellow-500"})," PREMIUM STORE"]}):_.jsx("span",{className:"text-xs font-bold bg-gray-100 text-gray-500 px-2 py-1 rounded-full border border-gray-200",children:"Gi Min Ph"})]}),_.jsxs("form",{onSubmit:ft,className:"p-6 space-y-6",children:[_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[_.jsxs("div",{className:"md:col-span-4 space-y-3",children:[_.jsxs(ci,{className:"font-semibold",children:["nh i din ",_.jsx("span",{className:"text-green-600 text-xs font-normal",children:"(Min ph)"})]}),_.jsxs("div",{className:"aspect-square w-full rounded-2xl border-2 border-dashed border-gray-300 bg-gray-50 flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all relative overflow-hidden group",onClick:()=>document.getElementById("avatar-input")?.click(),children:[H?_.jsxs(_.Fragment,{children:[_.jsx("img",{src:H,className:"w-full h-full object-cover"}),_.jsxs("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:[_.jsx(TO,{className:"text-white w-8 h-8"}),_.jsx("span",{className:"text-white text-xs font-medium absolute bottom-4",children:"i nh"})]})]}):_.jsxs(_.Fragment,{children:[_.jsx(hC,{className:"w-10 h-10 text-gray-400 mb-2"}),_.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"Ti nh ln"})]}),_.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",onChange:ut,className:"hidden"})]})]}),_.jsxs("div",{className:"md:col-span-8 space-y-4",children:[_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{className:"space-y-2",children:[_.jsxs(ci,{children:["Tn a im ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{required:!0,value:L.name_vi,onChange:vt=>z({...L,name_vi:vt.target.value})})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsxs(ci,{children:["Danh mc ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsxs(E4,{value:L.category,onValueChange:vt=>z({...L,category:vt}),children:[_.jsx(aS,{className:"bg-white",children:_.jsx(C4,{placeholder:"Chn danh mc"})}),_.jsxs(lS,{className:"max-h-[300px] bg-white z-[200]",children:[_.jsx(Qa,{value:"food",children:"Qun n"}),_.jsx(Qa,{value:"cafe",children:"Caf"}),_.jsx(Qa,{value:"entertainment",children:"Vui chi"}),_.jsx(Qa,{value:"lecture_hall",children:"Ging ng"}),_.jsx(Qa,{value:"office",children:"Vn phng"}),_.jsx(Qa,{value:"housing",children:"Nh tr"}),_.jsx(Qa,{value:"job",children:"Vic lm"}),_.jsx(Qa,{value:"building",children:"Ta nh"}),_.jsx(Qa,{value:"checkin",children:"Check-in"})]})]})]})]}),_.jsxs("div",{className:"space-y-2",children:[_.jsx(ci,{children:"Lin h & V tr"}),_.jsxs("div",{className:"flex gap-2",children:[_.jsx("div",{className:"flex-1",children:_.jsx(ui,{value:L.phone,onChange:vt=>z({...L,phone:vt.target.value}),placeholder:"S in thoi..."})}),_.jsxs(pn,{type:"button",className:"bg-blue-600 text-white min-w-[140px] gap-2",onClick:()=>Ue(!0),children:[_.jsx(Ai,{className:"w-4 h-4"})," ",L.lat?"Sa v tr":"Chn v tr"]})]}),_.jsxs("div",{className:"bg-gray-50 border rounded-md p-2 text-sm flex items-start gap-2",children:[_.jsx(Ai,{className:L.lat?"w-4 h-4 text-green-600 mt-0.5":"w-4 h-4 text-gray-400 mt-0.5"}),_.jsx("span",{className:"font-medium text-gray-800 flex-1",children:L.address_vi||"Cha chn v tr"})]})]}),_.jsxs("div",{className:"space-y-2 relative",children:[_.jsxs(ci,{className:"flex items-center gap-2 font-semibold",children:["M t / Gii thiu",!M&&_.jsx(Ay,{className:"w-3.5 h-3.5 text-yellow-600"})]}),_.jsxs("div",{className:"relative",children:[_.jsx(yh,{rows:3,value:L.description_vi,onChange:vt=>z({...L,description_vi:vt.target.value}),disabled:!M,placeholder:M?"Nhp m t...":"Nng cp VIP  vit m t chi tit, gii thiu v qun...",className:M?"":"bg-gray-100 text-gray-400 resize-none blur-[1px]"}),!M&&_.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:_.jsxs(pn,{type:"button",size:"sm",onClick:v,className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white hover:from-yellow-500 hover:to-orange-600 shadow-md transform hover:scale-105 transition-all",children:[_.jsx(nl,{className:"w-4 h-4 mr-1"})," M kha M t"]})})]})]})]}),_.jsxs("div",{className:"col-span-full space-y-3 pt-4 border-t relative",children:[_.jsxs("div",{className:"flex justify-between items-center",children:[_.jsxs(ci,{className:"text-base font-semibold flex items-center gap-2",children:["Th vin nh VIP",!M&&_.jsx(Ay,{className:"w-4 h-4 text-gray-400"})]}),M?_.jsxs(_.Fragment,{children:[_.jsxs(pn,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("gallery-input")?.click(),disabled:xe.length+Y.length>=10,children:[_.jsx(hC,{className:"w-4 h-4 mr-2"})," Thm nh"]}),_.jsx("input",{id:"gallery-input",type:"file",multiple:!0,accept:"image/*",onChange:gt,className:"hidden"})]}):_.jsx("span",{className:"text-xs text-red-500 font-medium bg-red-50 px-2 py-1 rounded",children:"Tnh nng VIP"})]}),_.jsxs("div",{className:`flex gap-4 overflow-x-auto pb-4 pt-2 scrollbar-thin scrollbar-thumb-gray-200 ${M?"":"opacity-40 pointer-events-none select-none filter blur-[2px]"}`,children:[!M&&[1,2,3,4].map(vt=>_.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-lg bg-gray-200 animate-pulse"},vt)),M&&xe.map(vt=>_.jsx("div",{className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden border group",children:_.jsx("img",{src:vt.image_url,className:"w-full h-full object-cover transition-transform group-hover:scale-110"})},vt.id)),M&&ie.map((vt,st)=>_.jsx("div",{className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden border",children:_.jsx("img",{src:vt,className:"w-full h-full object-cover"})},st))]}),!M&&_.jsx("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-white/60 backdrop-blur-sm rounded-xl border border-dashed border-gray-300",children:_.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-xl flex flex-col items-center border border-yellow-100 max-w-xs text-center",children:[_.jsx("div",{className:"bg-yellow-100 p-3 rounded-full mb-3",children:_.jsx(nl,{className:"w-6 h-6 text-yellow-600 fill-yellow-600"})}),_.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-1",children:"Th vin nh VIP"}),_.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"ng ti 10 nh Menu & Khng gian  thu ht khch hng gp 3 ln!"}),_.jsx(pn,{type:"button",size:"sm",onClick:v,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full font-bold shadow-lg shadow-yellow-200",children:"Nng cp ngay"})]})})]})]}),_.jsxs(eS,{className:"pt-4 border-t sticky bottom-0 bg-white z-20",children:[_.jsx(pn,{type:"button",variant:"ghost",onClick:e,children:"Hy"}),_.jsxs(pn,{type:"submit",disabled:et||u,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-md",children:[(et||u)&&_.jsx(ki,{className:"w-4 h-4 mr-2 animate-spin"}),"Lu thng tin"]})]})]})]})}),_.jsx(cK,{isOpen:je,onClose:()=>Ue(!1),onConfirm:ot,initialLat:L.lat,initialLng:L.lng})]})},Lf="https://thodia-backend-1067502227654.asia-southeast1.run.app",I4=({isOpen:t,onClose:e,location:r,onNavigate:l})=>{if(!r)return null;const{user:u}=_o(),[m,v]=P.useState("info"),[b,a]=P.useState(r),[k,M]=P.useState([]),[L,z]=P.useState([]),[O,K]=P.useState([]),[H,Z]=P.useState(new Set),[Y,ee]=P.useState(0),[ie,pe]=P.useState(0),[xe,Ce]=P.useState(!0),[je,Ue]=P.useState(!1),et=String(r.id).replace("user-store-",""),ot=b?.user_id===u?.uid||u?.email==="admin@gmail.com";P.useEffect(()=>{t&&r&&ut()},[t,r.id,u]);const ut=async()=>{Ce(!0);try{const lt=await(await fetch(`${Lf}/api/stores/${et}/public`)).json()||r;a(lt);const[Tt,Kt,sn,xt]=await Promise.all([fetch(`${Lf}/api/stores/${et}/menu`),fetch(`${Lf}/api/stores/${et}/gallery`),fetch(`${Lf}/api/store-vouchers/${et}`),fetch(`${Lf}/api/reviews/list/${et}`)]),Zt=await Tt.json(),vn=await Kt.json(),on=await sn.json(),Sn=await xt.json();if(Array.isArray(Zt)&&z(Zt),Array.isArray(vn)&&K(vn),Array.isArray(on)&&M(on),Array.isArray(Sn)&&Sn.length>0){const nr=Sn.reduce((Xn,_i)=>Xn+_i.rating,0)/Sn.length;ee(Number(nr.toFixed(1))),pe(Sn.length)}else ee(0),pe(0);if(u){const nr=await(await fetch(`${Lf}/api/user-vouchers?userId=${u.uid}`)).json();if(Array.isArray(nr)){const Xn=new Set(nr.map(_i=>_i.voucher_id||_i.id));Z(Xn)}}}catch(fe){console.error("Li ti d liu chi tit:",fe)}finally{Ce(!1)}},gt=async()=>{await ut()},ft=async fe=>{if(!u){Gt.error("Vui lng ng nhp  lu voucher!");return}if(!H.has(fe.id)){Z(Fe=>new Set(Fe).add(fe.id)),Gt.success(" lu voucher vo v!");try{if(!(await fetch(`${Lf}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u.uid,voucherId:fe.id})})).ok)throw new Error("Failed")}catch{Z(lt=>{const Tt=new Set(lt);return Tt.delete(fe.id),Tt}),Gt.error("Khng th lu voucher lc ny")}}},vt=b.image_url||b.image||"https://images.unsplash.com/photo-1554118811-1e0d58224f24",st=b.name_vi||b.nameVi||b.name||"a im cha c tn",nt=b.address_vi||b.address||"ang cp nht a ch",ze=b.phone||r.phone||"Cha cp nht",Se=b.open_hours_vi||"08:00 - 22:00",We=b.description_vi||b.description;return _.jsxs(_.Fragment,{children:[_.jsx(u0,{open:t,onOpenChange:e,children:_.jsxs(m_,{className:"max-w-2xl h-[90vh] p-0 bg-white gap-0 border-none rounded-2xl overflow-hidden z-[100] flex flex-col focus:outline-none",children:[_.jsx(g_,{className:"sr-only",children:st}),xe?_.jsx("div",{className:"flex-1 flex items-center justify-center",children:_.jsx(ki,{className:"w-8 h-8 animate-spin text-primary"})}):_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"relative h-48 bg-gray-200 flex-shrink-0",children:[_.jsx("img",{src:vt,className:"w-full h-full object-cover",alt:st,onError:fe=>{fe.currentTarget.src="https://placehold.co/600x400?text=No+Image"}}),_.jsx("button",{onClick:e,className:"absolute top-4 right-4 bg-black/50 p-1.5 rounded-full text-white hover:bg-black/70 transition-colors z-10",children:_.jsx(di,{className:"w-5 h-5"})}),ot&&_.jsxs(pn,{size:"sm",className:"absolute bottom-4 right-4 bg-white/90 text-black hover:bg-white shadow-md border backdrop-blur-sm",onClick:()=>Ue(!0),children:[_.jsx(CM,{className:"w-3.5 h-3.5 mr-2"})," Chnh sa"]})]}),_.jsxs("div",{className:"pt-4 px-6 pb-2 flex-shrink-0",children:[_.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-tight",children:st}),_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[_.jsx(ah,{className:`w-4 h-4 ${Y>0?"fill-yellow-500 text-yellow-500":"text-gray-300"}`}),_.jsx("span",{className:"font-bold text-gray-900",children:Y>0?Y:"Cha c nh gi"}),ie>0&&_.jsxs("span",{children:["(",ie,")"]}),_.jsx("span",{className:"capitalize px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:b.category||b.type||"a im"})]}),_.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[_.jsx(Mv,{className:"w-4 h-4 text-green-600"})," ",_.jsx("span",{children:Se})]}),_.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[_.jsx(e_,{className:"w-4 h-4 text-blue-600"})," ",_.jsx("span",{children:ze})]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-2",children:[_.jsx(Ai,{className:"w-4 h-4 flex-shrink-0 text-red-500"}),_.jsx("span",{className:"truncate",children:nt})]})]}),_.jsxs(Gy,{defaultValue:"info",className:"flex-1 flex flex-col min-h-0",value:m,onValueChange:v,children:[_.jsx("div",{className:"px-6 border-b flex-shrink-0 bg-white sticky top-0 z-10",children:_.jsxs(Fm,{className:"w-full justify-start bg-transparent h-12 p-0 gap-6 overflow-x-auto no-scrollbar",children:[_.jsx(Vi,{value:"info",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:"Thng tin"}),_.jsxs(Vi,{value:"menu",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Thc n (",L.length,")"]}),_.jsxs(Vi,{value:"vouchers",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Voucher (",k.length,")"]}),_.jsxs(Vi,{value:"gallery",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh (",O.length,")"]}),_.jsxs(Vi,{value:"reviews",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh gi (",ie,")"]})]})}),_.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4 scroll-smooth",children:[_.jsx(Ps,{value:"info",className:"m-0 focus:outline-none",children:_.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border space-y-3",children:[_.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[_.jsx(Rb,{className:"w-4 h-4 text-blue-500"})," Gii thiu"]}),_.jsx("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-wrap",children:We||"Cha c m t chi tit v a im ny."})]})}),_.jsx(Ps,{value:"menu",className:"space-y-4 m-0 focus:outline-none",children:L.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(t_,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Cha cp nht thc n."})]}):_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:L.map(fe=>_.jsxs("div",{className:"bg-white p-2 rounded-xl border flex gap-3 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:_.jsx("img",{src:fe.image_url||"https://placehold.co/100x100",className:"w-full h-full object-cover",alt:fe.name,onError:Fe=>{Fe.currentTarget.src="https://placehold.co/100x100?text=Food"}})}),_.jsxs("div",{className:"flex-1 py-1 flex flex-col justify-between",children:[_.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-2",children:fe.name_vi||fe.name}),_.jsxs("span",{className:"font-bold text-primary block",children:[fe.price?new Intl.NumberFormat("vi-VN").format(Number(fe.price)):0,""]})]})]},fe.id))})}),_.jsx(Ps,{value:"vouchers",className:"space-y-3 m-0 focus:outline-none",children:k.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(qm,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Khng c m gim gi no."})]}):k.map(fe=>{const Fe=H.has(fe.id);return _.jsx("div",{className:"bg-white rounded-xl border border-dashed border-orange-200 p-4 shadow-sm relative group hover:border-orange-400 transition-colors",children:_.jsxs("div",{className:"flex gap-4 items-center",children:[_.jsxs("div",{className:"w-16 h-16 bg-orange-50 rounded-lg flex flex-col items-center justify-center border border-orange-100 text-orange-600 flex-shrink-0",children:[_.jsx("span",{className:"text-xl font-black",children:fe.discount_value}),_.jsx("span",{className:"text-xs font-bold uppercase",children:fe.discount_type==="percent"?"%":"k"})]}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h4",{className:"font-bold text-gray-900 truncate",children:fe.title_vi}),_.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:["M: ",_.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded text-gray-700 font-bold",children:fe.code})]})]}),_.jsx(pn,{onClick:()=>ft(fe),disabled:Fe,size:"sm",className:`shrink-0 ${Fe?"bg-green-100 text-green-700 hover:bg-green-200":"bg-orange-500 text-white hover:bg-orange-600"}`,children:Fe?_.jsxs(_.Fragment,{children:[_.jsx(wh,{className:"w-4 h-4 mr-1"}),"  lu"]}):"Lu m"})]})},fe.id)})}),_.jsx(Ps,{value:"gallery",className:"m-0 focus:outline-none",children:O.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(Nb,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Cha c hnh nh no khc."})]}):_.jsx("div",{className:"grid grid-cols-3 gap-2",children:O.map(fe=>_.jsx("div",{className:"aspect-square rounded-xl overflow-hidden border bg-gray-100 cursor-pointer hover:opacity-90",children:_.jsx("img",{src:fe.image_url,className:"w-full h-full object-cover",alt:""})},fe.id))})}),_.jsx(Ps,{value:"reviews",className:"m-0 focus:outline-none",children:_.jsx(FD,{storeId:et})})]})]})]})]})}),je&&_.jsx(cS,{isOpen:je,onClose:()=>Ue(!1),onSubmit:gt,initialData:b,customStoreId:et})]})},Ex="https://thodia-backend-1067502227654.asia-southeast1.run.app",uK={food:"m thc",cafe:"Caf",entertainment:"Vui chi",lecture_hall:"Ging ng",office:"Vn phng",housing:"Nh tr",job:"Vic lm",building:"Ta nh",checkin:"Check-in"},dK=({location:t,onClose:e,onNavigate:r,onOpenDetail:l,onClaim:u})=>{const{language:m}=ia(),{user:v}=_o(),{isFavorite:b,toggleFavorite:a}=D3(),k=b(t.id),M=t.is_premium,L=String(t.id),O=!(L.startsWith("user-store-")||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(L)),K=L.replace("user-store-",""),[H,Z]=P.useState({rating:0,count:0}),[Y,ee]=P.useState(!1);P.useEffect(()=>{const Se=async(fe=!1)=>{if(!fe&&t.reviews&&t.reviews.length>0){const Fe=t.reviews.reduce((lt,Tt)=>lt+Tt.rating,0);Z({rating:Number((Fe/t.reviews.length).toFixed(1)),count:t.reviews.length});return}if(!(O&&!fe)){ee(!0);try{const lt=await(await fetch(`${Ex}/api/reviews/${K}`)).json();if(Array.isArray(lt)&&lt.length>0){const Tt=lt.reduce((Kt,sn)=>Kt+sn.rating,0);Z({rating:Number((Tt/lt.length).toFixed(1)),count:lt.length})}else!fe&&t.rating?Z({rating:t.rating,count:t.reviews?.length||0}):Z({rating:0,count:0})}catch(Fe){console.error("Li ti rating:",Fe)}finally{ee(!1)}}};Se();const We=fe=>{String(fe.detail)===String(K)&&Se(!0)};return window.addEventListener("review_updated",We),()=>window.removeEventListener("review_updated",We)},[t.id,K,O]);const[ie,pe]=P.useState([]),[xe,Ce]=P.useState(new Set),[je,Ue]=P.useState(!1),[et,Ie]=P.useState(!1),[ot,ut]=P.useState(!1);P.useEffect(()=>{(async()=>{if(O){pe([]);return}Ue(!0);try{const fe=await(await fetch(`${Ex}/api/store-vouchers/${K}`)).json();if(Array.isArray(fe)&&fe.length>0){if(pe(fe),v){const lt=await(await fetch(`${Ex}/api/user-vouchers?userId=${v.uid}`)).json();if(Array.isArray(lt)){const Tt=new Set(lt.map(Kt=>Kt.voucher_id||Kt.id));Ce(Tt)}}}else pe([])}catch(We){console.error("Li ti voucher:",We)}finally{Ue(!1)}})()},[t.id,K,v,O]);const gt=async Se=>{if(!v){Gt.error("Vui lng ng nhp  lu u i!");return}if(!xe.has(Se.id)){Ce(We=>new Set(We).add(Se.id)),Gt.success(" lu u i vo v!");try{if(!(await fetch(`${Ex}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:v.uid,voucherId:Se.id})})).ok)throw new Error("Failed")}catch{Ce(fe=>{const Fe=new Set(fe);return Fe.delete(Se.id),Fe}),Gt.error("Li khi lu, vui lng th li.")}}},ft=()=>{ut(!0),setTimeout(()=>{r(t),ut(!1)},500)},vt=()=>{l?l(t):Ie(!0)},st=m==="en"&&t.name?t.name:t.nameVi,nt=m==="en"&&t.descriptionEn?t.descriptionEn:t.description,ze=uK[t.category||t.type]||"a im";return _.jsxs(_.Fragment,{children:[_.jsxs(yr.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl shadow-2xl z-[60] max-h-[85vh] overflow-y-auto md:max-w-md md:left-auto md:right-4 md:bottom-4 md:rounded-3xl border border-gray-100 scrollbar-hide",onClick:Se=>Se.stopPropagation(),children:[_.jsxs("div",{className:"relative h-48 w-full bg-gray-200 cursor-pointer group",onClick:vt,children:[_.jsx("img",{src:t.image||"https://images.unsplash.com/photo-1554118811-1e0d58224f24",alt:st,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"eager",onError:Se=>{Se.currentTarget.src="https://placehold.co/600x400?text=No+Image"}}),_.jsx("button",{onClick:Se=>{Se.stopPropagation(),e()},className:"absolute top-4 right-4 w-8 h-8 bg-black/40 hover:bg-black/60 rounded-full flex items-center justify-center text-white backdrop-blur-md transition-colors z-10",children:_.jsx(di,{className:"w-5 h-5"})}),_.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2 z-10",children:[_.jsx("div",{className:"px-3 py-1 bg-white/90 backdrop-blur-sm text-xs font-bold rounded-full uppercase tracking-wider text-gray-800 shadow-sm border border-white/50",children:ze}),M&&_.jsxs("div",{className:"px-2 py-1 bg-gradient-to-r from-yellow-300 to-yellow-500 text-yellow-900 text-xs font-bold rounded-full flex items-center gap-1 shadow-sm border border-white/50 animate-pulse",children:[_.jsx(nl,{className:"w-3 h-3 fill-yellow-900"}),"VIP"]})]}),_.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent pointer-events-none"})]}),_.jsxs("div",{className:"p-6 pb-24 md:pb-6 relative",children:[_.jsxs("div",{className:"flex justify-between items-start mb-2 gap-3",children:[_.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-tight flex-1 line-clamp-2",onClick:vt,children:st}),_.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[Y?_.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded-lg border border-gray-100",children:[_.jsx(ki,{className:"w-3 h-3 animate-spin text-gray-400"}),_.jsx("span",{className:"text-[10px] text-gray-400",children:"Loading..."})]}):Number(H.rating)>0?_.jsxs("div",{className:"flex items-center gap-1 bg-yellow-50 px-2 py-1 rounded-lg border border-yellow-100",children:[_.jsx(ah,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),_.jsx("span",{className:"font-bold text-sm text-yellow-700",children:H.rating}),_.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",H.count,")"]})]}):_.jsx("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded-lg border border-gray-100",children:_.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"Cha c nh gi"})}),_.jsx("button",{onClick:Se=>{Se.stopPropagation(),a(t)},className:"p-2 rounded-full hover:bg-red-50 active:scale-95 transition-all group",children:_.jsx($f,{className:`w-5 h-5 transition-colors ${k?"fill-red-500 text-red-500":"text-gray-400 group-hover:text-red-400"}`})})]})]}),_.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-6",children:[_.jsx(Ai,{className:"w-4 h-4 mt-1 flex-shrink-0 text-primary"}),_.jsx("p",{className:"text-sm font-medium",children:t.address||"ang cp nht a ch..."})]}),_.jsx("div",{className:"mb-6",children:_.jsxs(pn,{className:"w-full h-12 text-base font-bold bg-primary hover:bg-primary/90 text-white shadow-lg shadow-primary/20 rounded-xl transition-transform active:scale-[0.98]",onClick:ft,disabled:ot,children:[ot?_.jsx(ki,{className:"w-5 h-5 animate-spin mr-2"}):_.jsx(Hx,{className:"w-5 h-5 mr-2"}),ot?"ang tm ng...":"Ch ng n y"]})}),O&&_.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-100 rounded-2xl flex flex-col gap-3",children:[_.jsxs("div",{className:"flex items-start gap-3",children:[_.jsx("div",{className:"p-2 bg-white rounded-full text-blue-600 shadow-sm",children:_.jsx(nl,{size:16})}),_.jsxs("div",{children:[_.jsx("p",{className:"text-sm font-bold text-blue-900",children:"Bn l ch a im ny?"}),_.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"Xc minh ngay  qun l thng tin, hnh nh v to u i."})]})]}),_.jsx(pn,{variant:"outline",className:"w-full bg-white text-blue-600 border-blue-200 hover:bg-blue-600 hover:text-white h-10 text-xs font-bold rounded-xl transition-all",onClick:()=>u?.(t),children:"Xc nhn ch s hu"})]}),je?_.jsx("div",{className:"h-20 bg-gray-50 rounded-xl mb-6 flex items-center justify-center border border-dashed border-gray-200",children:_.jsx(ki,{className:"w-4 h-4 animate-spin text-gray-300"})}):ie.length>0&&_.jsxs("div",{className:"mb-6 space-y-3",children:[_.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm uppercase tracking-wide",children:[_.jsx(qm,{className:"w-4 h-4 text-orange-500"})," u i ang c (",ie.length,")"]}),ie.slice(0,2).map(Se=>{const We=xe.has(Se.id);return _.jsxs("div",{className:"group relative border border-orange-100 bg-gradient-to-r from-orange-50 to-white rounded-xl p-3 flex items-center justify-between shadow-sm hover:shadow-md transition-all",children:[_.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[_.jsxs("div",{className:"w-12 h-12 bg-white text-orange-600 rounded-lg flex items-center justify-center font-bold text-sm flex-col shadow-sm border border-orange-100 shrink-0",children:[_.jsx("span",{children:Se.discount_value}),_.jsx("span",{className:"text-[10px] leading-none",children:Se.discount_type==="percent"?"%":"k"})]}),_.jsxs("div",{className:"min-w-0",children:[_.jsx("p",{className:"font-bold text-sm text-gray-900 truncate pr-2",children:Se.title_vi}),_.jsxs("p",{className:"text-[10px] text-gray-500 font-mono bg-white inline-block px-1 rounded border border-gray-100",children:["Code: ",Se.code]})]})]}),_.jsx(pn,{size:"sm",variant:We?"ghost":"default",className:`h-8 px-3 text-xs rounded-lg font-bold shrink-0 transition-all ${We?"text-green-600 bg-green-50 hover:bg-green-100 hover:text-green-700":"bg-orange-500 hover:bg-orange-600 text-white shadow-orange-200 shadow-md"}`,onClick:()=>gt(Se),disabled:We,children:We?" lu":"Lu"})]},Se.id)})]}),_.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[_.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[_.jsx(Mv,{className:"w-4 h-4 text-gray-400"}),_.jsx("span",{children:"08:00 - 22:00 (M ca)"})]}),t.phone&&_.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[_.jsx(e_,{className:"w-4 h-4 text-gray-400"}),_.jsx("a",{href:`tel:${t.phone}`,className:"hover:text-primary transition-colors",children:t.phone})]})]}),nt&&_.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:_.jsx("p",{className:"text-sm text-gray-600 leading-relaxed line-clamp-3",children:nt})}),_.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-gray-100 rounded-b-3xl md:rounded-b-3xl z-20",children:_.jsxs(pn,{variant:"secondary",className:"w-full h-12 font-bold text-gray-800 bg-gray-100 hover:bg-gray-200 border-none shadow-sm flex items-center justify-center gap-2 rounded-xl",onClick:vt,children:[M?"Xem Menu & nh ca hng":"Xem chi tit y ",_.jsx(Cb,{className:"w-4 h-4"})]})})]})]}),_.jsx(I4,{isOpen:et,onClose:()=>Ie(!1),location:t})]})},hK=()=>{const[t,e]=P.useState({origin:null,destination:null,route:null,isLoading:!1,error:null,transportMode:"walking",routePreference:"shortest"}),r=P.useCallback(v=>{e(b=>({...b,transportMode:v}))},[]),l=P.useCallback(v=>{e(b=>({...b,routePreference:v}))},[]),u=P.useCallback(async(v,b,a="walking",k="shortest")=>{e(M=>({...M,origin:v,destination:b,transportMode:a,routePreference:k,isLoading:!0,error:null}));try{const M=t0(),z=await fetch(`https://api.mapbox.com/directions/v5/mapbox/${a==="walking"?"walking":a==="cycling"?"cycling":"driving"}/${v[0]},${v[1]};${b[0]},${b[1]}?geometries=geojson&steps=true&overview=full&alternatives=true&access_token=${M}`);if(!z.ok)throw new Error("Failed to fetch directions");const O=await z.json();if(O.routes&&O.routes.length>0){const H=[...O.routes].sort((Y,ee)=>k==="shortest"?Y.distance-ee.distance:Y.duration-ee.duration)[0],Z=[];H.legs&&H.legs.length>0&&H.legs.forEach(Y=>{Y.steps&&Y.steps.forEach(ee=>{Z.push({instruction:ee.maneuver?.instruction||"",distance:ee.distance,duration:ee.duration,maneuver:{type:ee.maneuver?.type||"",modifier:ee.maneuver?.modifier}})})}),e(Y=>({...Y,route:{distance:H.distance,duration:H.duration,geometry:H.geometry,steps:Z},isLoading:!1}))}else throw new Error("No route found")}catch(M){e(L=>({...L,error:M instanceof Error?M.message:"Unknown error",isLoading:!1}))}},[]),m=P.useCallback(()=>{e(v=>({origin:null,destination:null,route:null,isLoading:!1,error:null,transportMode:v.transportMode,routePreference:v.routePreference}))},[]);return{...t,getDirections:u,clearDirections:m,setTransportMode:r,setRoutePreference:l}},Cx=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(1)} km`,fK=(t,e)=>{if(e==="en")return t;let r=t;const l=[[/Turn left/gi,"R tri"],[/Turn right/gi,"R phi"],[/Turn slight left/gi,"R nh sang tri"],[/Turn slight right/gi,"R nh sang phi"],[/Turn sharp left/gi,"R gp sang tri"],[/Turn sharp right/gi,"R gp sang phi"],[/Slight left/gi,"R nh sang tri"],[/Slight right/gi,"R nh sang phi"],[/Sharp left/gi,"R gp sang tri"],[/Sharp right/gi,"R gp sang phi"],[/Continue straight/gi,"Tip tc i thng"],[/Continue on/gi,"Tip tc theo"],[/Continue/gi,"Tip tc"],[/Go straight/gi,"i thng"],[/Head (north|south|east|west)/gi,"i v hng $1"],[/north/gi,"bc"],[/south/gi,"nam"],[/east/gi,"ng"],[/west/gi,"ty"],[/northeast/gi,"ng bc"],[/northwest/gi,"ty bc"],[/southeast/gi,"ng nam"],[/southwest/gi,"ty nam"],[/You have arrived at your destination/gi,"Bn  n im ch"],[/You have arrived/gi,"Bn  n ni"],[/Arrive at/gi,"n"],[/Your destination is on the left/gi,"im n  bn tri"],[/Your destination is on the right/gi,"im n  bn phi"],[/destination/gi,"im n"],[/Make a U-turn/gi,"Quay u"],[/U-turn/gi,"Quay u"],[/Enter the roundabout/gi,"i vo vng xuyn"],[/Exit the roundabout/gi,"Ra khi vng xuyn"],[/roundabout/gi,"vng xuyn"],[/Take the exit/gi,"i theo li ra"],[/Merge/gi,"Nhp ln"],[/Fork left/gi,"R tri ti ng ba"],[/Fork right/gi,"R phi ti ng ba"],[/Keep left/gi,"i bn tri"],[/Keep right/gi,"i bn phi"],[/for (\d+) meters/gi,"trong $1 mt"],[/for (\d+) m/gi,"trong $1 mt"],[/for (\d+\.?\d*) kilometers/gi,"trong $1 km"],[/for (\d+\.?\d*) km/gi,"trong $1 km"],[/onto/gi,"vo"],[/on the left/gi," bn tri"],[/on the right/gi," bn phi"],[/on your left/gi,"bn tri bn"],[/on your right/gi,"bn phi bn"],[/at the end of the road/gi," cui ng"],[/at the intersection/gi,"ti ng t"]];for(const[u,m]of l)r=r.replace(u,m);return r},TI=(t,e)=>{switch(t){case"turn":return e==="left"||e==="slight left"||e==="sharp left"?_.jsx(m1,{className:"w-4 h-4"}):e==="right"||e==="slight right"||e==="sharp right"?_.jsx(g1,{className:"w-4 h-4"}):_.jsx(dC,{className:"w-4 h-4"});case"depart":return _.jsx(Ai,{className:"w-4 h-4"});case"arrive":return _.jsx(IO,{className:"w-4 h-4"});case"merge":case"on ramp":case"off ramp":return e?.includes("left")?_.jsx(Iv,{className:"w-4 h-4"}):_.jsx(Cb,{className:"w-4 h-4"});case"fork":return e?.includes("left")?_.jsx(m1,{className:"w-4 h-4"}):_.jsx(g1,{className:"w-4 h-4"});case"end of road":return e?.includes("left")?_.jsx(m1,{className:"w-4 h-4"}):_.jsx(g1,{className:"w-4 h-4"});default:return _.jsx(dC,{className:"w-4 h-4"})}},pK=({routeInfo:t,destinationName:e,isLoading:r,transportMode:l,routePreference:u,currentStepIndex:m=0,distanceToNextStep:v=0,isTracking:b=!1,userAccuracy:a,onClose:k,onChangeTransportMode:M,onChangeRoutePreference:L,onAddStop:z})=>{const{t:O,language:K}=ia(),[H,Z]=P.useState(!1),[Y,ee]=P.useState(!1),ie=je=>fK(je,K)||O("continueStright"),pe=je=>{const Ue=Math.round(je/60);return Ue>=60?`${Math.floor(Ue/60)}g ${Ue%60}p`:`${Ue} pht`},xe=t.steps[m],Ce=[{mode:"walking",icon:TM,labelKey:"walking"},{mode:"cycling",icon:vM,labelKey:"cycling"},{mode:"driving",icon:wM,labelKey:"driving"}];return Y?_.jsx(yr.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:_.jsxs("button",{onClick:()=>ee(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-card/95 backdrop-blur-sm rounded-full shadow-lg border border-border",children:[_.jsx(Hx,{className:"w-4 h-4 text-primary"}),_.jsx("span",{className:"text-xs font-medium text-foreground truncate flex-1 text-left",children:e}),_.jsx("span",{className:"text-xs font-bold text-primary",children:Cx(t.distance)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:pe(t.duration)}),_.jsx(qf,{className:"w-3.5 h-3.5 text-muted-foreground"})]})}):_.jsx(yr.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:_.jsxs("div",{className:"bg-card/95 backdrop-blur-sm rounded-xl shadow-lg border border-border p-2",children:[_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(Hx,{className:"w-4 h-4 text-primary flex-shrink-0"}),_.jsx("span",{className:"text-xs font-medium text-foreground truncate flex-1",children:e}),_.jsx("div",{className:"flex bg-muted/50 rounded-md p-0.5",children:Ce.map(({mode:je,icon:Ue})=>_.jsx("button",{onClick:()=>M(je),className:cn("p-1 rounded transition-all",l===je?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"),children:_.jsx(Ue,{className:"w-3 h-3"})},je))}),_.jsx("span",{className:"text-xs font-bold text-primary",children:Cx(t.distance)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:pe(t.duration)}),z&&_.jsx("button",{onClick:z,className:"p-1 hover:bg-blue-100 text-blue-600 rounded transition-colors",title:"Thm im dng",children:_.jsx(xm,{className:"w-3.5 h-3.5"})}),t.steps?.length>0&&_.jsx("button",{onClick:()=>Z(!H),className:"p-1 hover:bg-muted rounded",children:H?_.jsx(Dm,{className:"w-3.5 h-3.5 text-muted-foreground"}):_.jsx(qf,{className:"w-3.5 h-3.5 text-muted-foreground"})}),_.jsx("button",{onClick:()=>ee(!0),className:"p-1 hover:bg-muted rounded",children:_.jsx(Dm,{className:"w-3.5 h-3.5 text-muted-foreground"})}),_.jsx("button",{onClick:k,className:"p-1 hover:bg-destructive/20 rounded",children:_.jsx(di,{className:"w-3.5 h-3.5 text-muted-foreground"})})]}),r&&_.jsx("div",{className:"flex items-center justify-center py-2",children:_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})}),b&&xe&&_.jsxs("div",{className:"mt-2 p-2 bg-primary/10 rounded-lg flex items-center gap-2",children:[_.jsx("div",{className:"w-5 h-5 bg-primary rounded-full flex items-center justify-center flex-shrink-0 text-primary-foreground",children:TI(xe.maneuver.type,xe.maneuver.modifier)}),_.jsx("p",{className:"text-xs text-foreground flex-1 truncate",children:ie(xe.instruction)}),v>0&&_.jsx("span",{className:"text-xs text-primary font-medium",children:Cx(v)})]}),_.jsx(Sa,{children:H&&t.steps&&_.jsx(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:_.jsx(e0,{className:"max-h-40 mt-2 border-t border-border pt-2",children:_.jsx("div",{className:"space-y-1",children:t.steps.map((je,Ue)=>{const et=b&&Ue===m,Ie=b&&Ue<m;return _.jsxs("div",{className:cn("flex items-center gap-2 p-1.5 rounded-lg text-xs",et?"bg-primary/20":Ie?"opacity-50":"bg-muted/30"),children:[_.jsx("div",{className:cn("w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 text-[10px]",et||Ue===0?"bg-primary text-primary-foreground":Ue===t.steps.length-1?"bg-destructive text-destructive-foreground":"bg-muted text-muted-foreground"),children:Ie?"":TI(je.maneuver.type,je.maneuver.modifier)}),_.jsx("span",{className:"flex-1 truncate text-foreground",children:ie(je.instruction)}),_.jsx("span",{className:"text-muted-foreground",children:Cx(je.distance)})]},Ue)})})})})})]})})},mK=()=>{const[t,e]=P.useState({origin:null,waypoints:[],route:null,isLoading:!1,error:null,transportMode:"walking"}),r=P.useCallback(k=>{e(M=>({...M,transportMode:k}))},[]),l=P.useCallback(k=>{e(M=>({...M,waypoints:[...M.waypoints,k]}))},[]),u=P.useCallback(k=>{e(M=>({...M,waypoints:M.waypoints.filter((L,z)=>z!==k)}))},[]),m=P.useCallback(k=>{e(M=>({...M,waypoints:k}))},[]),v=P.useCallback(()=>{e(k=>({...k,waypoints:[],route:null}))},[]),b=P.useCallback(async(k,M,L="walking")=>{if(M.length!==0){e(z=>({...z,origin:k,waypoints:M,transportMode:L,isLoading:!0,error:null}));try{const z=t0(),O=L==="walking"?"walking":L==="cycling"?"cycling":"driving",K=[k,...M],H=K.map(ee=>`${ee.coordinates[0]},${ee.coordinates[1]}`).join(";"),Z=await fetch(`https://api.mapbox.com/directions/v5/mapbox/${O}/${H}?geometries=geojson&steps=true&overview=full&access_token=${z}`);if(!Z.ok)throw new Error("Failed to fetch directions");const Y=await Z.json();if(Y.routes&&Y.routes.length>0){const ee=Y.routes[0],ie=ee.legs.map((pe,xe)=>{const Ce=pe.steps?.map(je=>({instruction:je.maneuver?.instruction||"",distance:je.distance,duration:je.duration,maneuver:{type:je.maneuver?.type||"",modifier:je.maneuver?.modifier}}))||[];return{distance:pe.distance,duration:pe.duration,steps:Ce,originName:xe===0?k.name:M[xe-1].name,destinationName:M[xe].name}});e(pe=>({...pe,route:{totalDistance:ee.distance,totalDuration:ee.duration,geometry:ee.geometry,legs:ie,waypoints:K},isLoading:!1}))}else throw new Error("No route found")}catch(z){e(O=>({...O,error:z instanceof Error?z.message:"Unknown error",isLoading:!1}))}}},[]),a=P.useCallback(()=>{e({origin:null,waypoints:[],route:null,isLoading:!1,error:null,transportMode:t.transportMode})},[t.transportMode]);return{...t,addWaypoint:l,removeWaypoint:u,reorderWaypoints:m,clearWaypoints:v,getMultiStopDirections:b,clearRoute:a,setTransportMode:r}},ow=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(1)} km`,SI=(t,e="vi")=>{const r=Math.round(t/60),l=e==="vi"?"pht":"min",u=e==="vi"?"gi":"hr";if(r<60)return`${r} ${l}`;const m=Math.floor(r/60),v=r%60;return`${m} ${u} ${v} ${l}`},gK=({routeInfo:t,waypoints:e,isLoading:r,transportMode:l,onClose:u,onChangeTransportMode:m,onRemoveWaypoint:v,onReorderWaypoints:b,onAddStop:a,isAddingStop:k})=>{const{t:M,language:L}=ia(),[z,O]=P.useState(null),[K,H]=P.useState(!1),[Z,Y]=P.useState(!1),ee=t?.waypoints.slice(1)||[],ie=[{mode:"walking",icon:TM,labelKey:"walking"},{mode:"cycling",icon:vM,labelKey:"cycling"},{mode:"driving",icon:wM,labelKey:"driving"}];return Z?_.jsx(yr.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:_.jsxs("button",{onClick:()=>Y(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-card/95 backdrop-blur-sm rounded-full shadow-lg border border-border",children:[_.jsx(fC,{className:"w-4 h-4 text-purple-500"}),_.jsxs("span",{className:"text-xs font-medium text-foreground",children:[e.length," ",L==="vi"?"im":"stops"]}),t&&_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"text-xs font-bold text-purple-600",children:ow(t.totalDistance)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:SI(t.totalDuration,L)})]}),_.jsx(qf,{className:"w-3.5 h-3.5 text-muted-foreground ml-auto"})]})}):_.jsx(yr.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:_.jsxs("div",{className:"bg-card/95 backdrop-blur-sm rounded-xl shadow-lg border border-border p-2",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(fC,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}),_.jsxs("span",{className:"text-xs font-medium text-foreground",children:[e.length," ",L==="vi"?"im":"stops"]}),_.jsx("div",{className:"flex bg-muted/50 rounded-md p-0.5",children:ie.map(({mode:pe,icon:xe})=>_.jsx("button",{onClick:()=>m(pe),className:cn("p-1 rounded transition-all",l===pe?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"),children:_.jsx(xe,{className:"w-3 h-3"})},pe))}),t&&_.jsxs(_.Fragment,{children:[_.jsx("span",{className:"text-xs font-bold text-purple-600",children:ow(t.totalDistance)}),_.jsx("span",{className:"text-xs text-muted-foreground",children:SI(t.totalDuration,L)})]}),_.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[_.jsx("button",{onClick:()=>Y(!0),className:"p-1 hover:bg-muted rounded",children:_.jsx(Dm,{className:"w-3.5 h-3.5 text-muted-foreground"})}),_.jsx("button",{onClick:u,className:"p-1 hover:bg-destructive/20 rounded",children:_.jsx(di,{className:"w-3.5 h-3.5 text-muted-foreground"})})]})]}),_.jsx(e0,{className:"max-h-28 mb-2",children:_.jsxs("div",{className:"space-y-1",children:[t?.waypoints[0]&&_.jsxs("div",{className:"flex items-center gap-1.5 p-1 bg-muted/30 rounded-lg",children:[_.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center text-white text-[10px]",children:""}),_.jsx("span",{className:"text-[10px] text-foreground truncate flex-1",children:t.waypoints[0].name})]}),ee.length>0&&_.jsx(dW,{axis:"y",values:ee,onReorder:b,className:"space-y-1",children:ee.map((pe,xe)=>{const Ce=xe===ee.length-1;return _.jsx(vW,{value:pe,onDragStart:()=>H(!0),onDragEnd:()=>H(!1),className:"cursor-grab active:cursor-grabbing",whileDrag:{scale:1.02,zIndex:50},children:_.jsxs("div",{className:cn("flex items-center gap-1.5 p-1 rounded-lg",K?"bg-muted":"bg-muted/30"),children:[_.jsx(PO,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),_.jsx("div",{className:cn("w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold text-white",Ce?"bg-destructive":"bg-primary"),children:Ce?"":xe+1}),_.jsx("span",{className:"text-[10px] text-foreground truncate flex-1",children:pe.name}),t?.legs[xe]&&_.jsx("span",{className:"text-[10px] text-muted-foreground",children:ow(t.legs[xe].distance)}),_.jsx("button",{onClick:je=>{je.stopPropagation(),v(xe)},className:"w-4 h-4 hover:bg-destructive/20 rounded flex items-center justify-center",children:_.jsx(lh,{className:"w-2.5 h-2.5 text-destructive"})})]})},pe.name+xe)})})]})}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsxs(pn,{onClick:a,variant:"outline",size:"sm",className:"h-6 text-[10px] border-dashed flex-1",disabled:k,children:[_.jsx(xm,{className:"w-3 h-3 mr-1"}),k?L==="vi"?"Chn...":"Select...":L==="vi"?"Thm im":"Add stop"]}),r&&_.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]})]})})};var Sr;(function(t){t.assertEqual=u=>{};function e(u){}t.assertIs=e;function r(u){throw new Error}t.assertNever=r,t.arrayToEnum=u=>{const m={};for(const v of u)m[v]=v;return m},t.getValidEnumValues=u=>{const m=t.objectKeys(u).filter(b=>typeof u[u[b]]!="number"),v={};for(const b of m)v[b]=u[b];return t.objectValues(v)},t.objectValues=u=>t.objectKeys(u).map(function(m){return u[m]}),t.objectKeys=typeof Object.keys=="function"?u=>Object.keys(u):u=>{const m=[];for(const v in u)Object.prototype.hasOwnProperty.call(u,v)&&m.push(v);return m},t.find=(u,m)=>{for(const v of u)if(m(v))return v},t.isInteger=typeof Number.isInteger=="function"?u=>Number.isInteger(u):u=>typeof u=="number"&&Number.isFinite(u)&&Math.floor(u)===u;function l(u,m=" | "){return u.map(v=>typeof v=="string"?`'${v}'`:v).join(m)}t.joinValues=l,t.jsonStringifyReplacer=(u,m)=>typeof m=="bigint"?m.toString():m})(Sr||(Sr={}));var EI;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(EI||(EI={}));const xn=Sr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jd=t=>{switch(typeof t){case"undefined":return xn.undefined;case"string":return xn.string;case"number":return Number.isNaN(t)?xn.nan:xn.number;case"boolean":return xn.boolean;case"function":return xn.function;case"bigint":return xn.bigint;case"symbol":return xn.symbol;case"object":return Array.isArray(t)?xn.array:t===null?xn.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?xn.promise:typeof Map<"u"&&t instanceof Map?xn.map:typeof Set<"u"&&t instanceof Set?xn.set:typeof Date<"u"&&t instanceof Date?xn.date:xn.object;default:return xn.unknown}},Ht=Sr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Qu extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=l=>{this.issues=[...this.issues,l]},this.addIssues=(l=[])=>{this.issues=[...this.issues,...l]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(m){return m.message},l={_errors:[]},u=m=>{for(const v of m.issues)if(v.code==="invalid_union")v.unionErrors.map(u);else if(v.code==="invalid_return_type")u(v.returnTypeError);else if(v.code==="invalid_arguments")u(v.argumentsError);else if(v.path.length===0)l._errors.push(r(v));else{let b=l,a=0;for(;a<v.path.length;){const k=v.path[a];a===v.path.length-1?(b[k]=b[k]||{_errors:[]},b[k]._errors.push(r(v))):b[k]=b[k]||{_errors:[]},b=b[k],a++}}};return u(this),l}static assert(e){if(!(e instanceof Qu))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Sr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},l=[];for(const u of this.issues)if(u.path.length>0){const m=u.path[0];r[m]=r[m]||[],r[m].push(e(u))}else l.push(e(u));return{formErrors:l,fieldErrors:r}}get formErrors(){return this.flatten()}}Qu.create=t=>new Qu(t);const mb=(t,e)=>{let r;switch(t.code){case Ht.invalid_type:t.received===xn.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Ht.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Sr.jsonStringifyReplacer)}`;break;case Ht.unrecognized_keys:r=`Unrecognized key(s) in object: ${Sr.joinValues(t.keys,", ")}`;break;case Ht.invalid_union:r="Invalid input";break;case Ht.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Sr.joinValues(t.options)}`;break;case Ht.invalid_enum_value:r=`Invalid enum value. Expected ${Sr.joinValues(t.options)}, received '${t.received}'`;break;case Ht.invalid_arguments:r="Invalid function arguments";break;case Ht.invalid_return_type:r="Invalid function return type";break;case Ht.invalid_date:r="Invalid date";break;case Ht.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Sr.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Ht.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Ht.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Ht.custom:r="Invalid input";break;case Ht.invalid_intersection_types:r="Intersection results could not be merged";break;case Ht.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Ht.not_finite:r="Number must be finite";break;default:r=e.defaultError,Sr.assertNever(t)}return{message:r}};let yK=mb;function _K(){return yK}const xK=t=>{const{data:e,path:r,errorMaps:l,issueData:u}=t,m=[...r,...u.path||[]],v={...u,path:m};if(u.message!==void 0)return{...u,path:m,message:u.message};let b="";const a=l.filter(k=>!!k).slice().reverse();for(const k of a)b=k(v,{data:e,defaultError:b}).message;return{...u,path:m,message:b}};function an(t,e){const r=_K(),l=xK({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===mb?void 0:mb].filter(u=>!!u)});t.common.issues.push(l)}class Ca{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const l=[];for(const u of r){if(u.status==="aborted")return qn;u.status==="dirty"&&e.dirty(),l.push(u.value)}return{status:e.value,value:l}}static async mergeObjectAsync(e,r){const l=[];for(const u of r){const m=await u.key,v=await u.value;l.push({key:m,value:v})}return Ca.mergeObjectSync(e,l)}static mergeObjectSync(e,r){const l={};for(const u of r){const{key:m,value:v}=u;if(m.status==="aborted"||v.status==="aborted")return qn;m.status==="dirty"&&e.dirty(),v.status==="dirty"&&e.dirty(),m.value!=="__proto__"&&(typeof v.value<"u"||u.alwaysSet)&&(l[m.value]=v.value)}return{status:e.value,value:l}}}const qn=Object.freeze({status:"aborted"}),hy=t=>({status:"dirty",value:t}),al=t=>({status:"valid",value:t}),CI=t=>t.status==="aborted",kI=t=>t.status==="dirty",Um=t=>t.status==="valid",yv=t=>typeof Promise<"u"&&t instanceof Promise;var Tn;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(Tn||(Tn={}));class _h{constructor(e,r,l,u){this._cachedPath=[],this.parent=e,this.data=r,this._path=l,this._key=u}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const AI=(t,e)=>{if(Um(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Qu(t.common.issues);return this._error=r,this._error}}};function fr(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:l,description:u}=t;if(e&&(r||l))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:u}:{errorMap:(v,b)=>{const{message:a}=t;return v.code==="invalid_enum_value"?{message:a??b.defaultError}:typeof b.data>"u"?{message:a??l??b.defaultError}:v.code!=="invalid_type"?{message:b.defaultError}:{message:a??r??b.defaultError}},description:u}}class vr{get description(){return this._def.description}_getType(e){return Jd(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Jd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ca,ctx:{common:e.parent.common,data:e.data,parsedType:Jd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(yv(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const l=this.safeParse(e,r);if(l.success)return l.data;throw l.error}safeParse(e,r){const l={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)},u=this._parseSync({data:e,path:l.path,parent:l});return AI(l,u)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)};if(!this["~standard"].async)try{const l=this._parseSync({data:e,path:[],parent:r});return Um(l)?{value:l.value}:{issues:r.common.issues}}catch(l){l?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(l=>Um(l)?{value:l.value}:{issues:r.common.issues})}async parseAsync(e,r){const l=await this.safeParseAsync(e,r);if(l.success)return l.data;throw l.error}async safeParseAsync(e,r){const l={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)},u=this._parse({data:e,path:l.path,parent:l}),m=await(yv(u)?u:Promise.resolve(u));return AI(l,m)}refine(e,r){const l=u=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(u):r;return this._refinement((u,m)=>{const v=e(u),b=()=>m.addIssue({code:Ht.custom,...l(u)});return typeof Promise<"u"&&v instanceof Promise?v.then(a=>a?!0:(b(),!1)):v?!0:(b(),!1)})}refinement(e,r){return this._refinement((l,u)=>e(l)?!0:(u.addIssue(typeof r=="function"?r(l,u):r),!1))}_refinement(e){return new Gm({schema:this,typeName:Zn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return hh.create(this,this._def)}nullable(){return Hm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zc.create(this)}promise(){return wv.create(this,this._def)}or(e){return xv.create([this,e],this._def)}and(e){return vv.create(this,e,this._def)}transform(e){return new Gm({...fr(this._def),schema:this,typeName:Zn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new yb({...fr(this._def),innerType:this,defaultValue:r,typeName:Zn.ZodDefault})}brand(){return new UK({typeName:Zn.ZodBranded,type:this,...fr(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new _b({...fr(this._def),innerType:this,catchValue:r,typeName:Zn.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return uS.create(this,e)}readonly(){return xb.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const vK=/^c[^\s-]{8,}$/i,wK=/^[0-9a-z]+$/,bK=/^[0-9A-HJKMNP-TV-Z]{26}$/i,TK=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,SK=/^[a-z0-9_-]{21}$/i,EK=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,CK=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,kK=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,AK="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let aw;const IK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,MK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,PK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,NK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,RK=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,DK=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,M4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",LK=new RegExp(`^${M4}$`);function P4(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function jK(t){return new RegExp(`^${P4(t)}$`)}function OK(t){let e=`${M4}T${P4(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function zK(t,e){return!!((e==="v4"||!e)&&IK.test(t)||(e==="v6"||!e)&&PK.test(t))}function BK(t,e){if(!EK.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const l=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),u=JSON.parse(atob(l));return!(typeof u!="object"||u===null||"typ"in u&&u?.typ!=="JWT"||!u.alg||e&&u.alg!==e)}catch{return!1}}function FK(t,e){return!!((e==="v4"||!e)&&MK.test(t)||(e==="v6"||!e)&&NK.test(t))}class sh extends vr{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==xn.string){const m=this._getOrReturnCtx(e);return an(m,{code:Ht.invalid_type,expected:xn.string,received:m.parsedType}),qn}const l=new Ca;let u;for(const m of this._def.checks)if(m.kind==="min")e.data.length<m.value&&(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.too_small,minimum:m.value,type:"string",inclusive:!0,exact:!1,message:m.message}),l.dirty());else if(m.kind==="max")e.data.length>m.value&&(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.too_big,maximum:m.value,type:"string",inclusive:!0,exact:!1,message:m.message}),l.dirty());else if(m.kind==="length"){const v=e.data.length>m.value,b=e.data.length<m.value;(v||b)&&(u=this._getOrReturnCtx(e,u),v?an(u,{code:Ht.too_big,maximum:m.value,type:"string",inclusive:!0,exact:!0,message:m.message}):b&&an(u,{code:Ht.too_small,minimum:m.value,type:"string",inclusive:!0,exact:!0,message:m.message}),l.dirty())}else if(m.kind==="email")kK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"email",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="emoji")aw||(aw=new RegExp(AK,"u")),aw.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"emoji",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="uuid")TK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"uuid",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="nanoid")SK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"nanoid",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="cuid")vK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"cuid",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="cuid2")wK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"cuid2",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="ulid")bK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"ulid",code:Ht.invalid_string,message:m.message}),l.dirty());else if(m.kind==="url")try{new URL(e.data)}catch{u=this._getOrReturnCtx(e,u),an(u,{validation:"url",code:Ht.invalid_string,message:m.message}),l.dirty()}else m.kind==="regex"?(m.regex.lastIndex=0,m.regex.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"regex",code:Ht.invalid_string,message:m.message}),l.dirty())):m.kind==="trim"?e.data=e.data.trim():m.kind==="includes"?e.data.includes(m.value,m.position)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:{includes:m.value,position:m.position},message:m.message}),l.dirty()):m.kind==="toLowerCase"?e.data=e.data.toLowerCase():m.kind==="toUpperCase"?e.data=e.data.toUpperCase():m.kind==="startsWith"?e.data.startsWith(m.value)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:{startsWith:m.value},message:m.message}),l.dirty()):m.kind==="endsWith"?e.data.endsWith(m.value)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:{endsWith:m.value},message:m.message}),l.dirty()):m.kind==="datetime"?OK(m).test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:"datetime",message:m.message}),l.dirty()):m.kind==="date"?LK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:"date",message:m.message}),l.dirty()):m.kind==="time"?jK(m).test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.invalid_string,validation:"time",message:m.message}),l.dirty()):m.kind==="duration"?CK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"duration",code:Ht.invalid_string,message:m.message}),l.dirty()):m.kind==="ip"?zK(e.data,m.version)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"ip",code:Ht.invalid_string,message:m.message}),l.dirty()):m.kind==="jwt"?BK(e.data,m.alg)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"jwt",code:Ht.invalid_string,message:m.message}),l.dirty()):m.kind==="cidr"?FK(e.data,m.version)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"cidr",code:Ht.invalid_string,message:m.message}),l.dirty()):m.kind==="base64"?RK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"base64",code:Ht.invalid_string,message:m.message}),l.dirty()):m.kind==="base64url"?DK.test(e.data)||(u=this._getOrReturnCtx(e,u),an(u,{validation:"base64url",code:Ht.invalid_string,message:m.message}),l.dirty()):Sr.assertNever(m);return{status:l.value,value:e.data}}_regex(e,r,l){return this.refinement(u=>e.test(u),{validation:r,code:Ht.invalid_string,...Tn.errToObj(l)})}_addCheck(e){return new sh({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Tn.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Tn.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Tn.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Tn.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Tn.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Tn.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Tn.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Tn.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Tn.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Tn.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Tn.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Tn.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Tn.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...Tn.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...Tn.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...Tn.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...Tn.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...Tn.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...Tn.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...Tn.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...Tn.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...Tn.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...Tn.errToObj(r)})}nonempty(e){return this.min(1,Tn.errToObj(e))}trim(){return new sh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new sh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new sh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}sh.create=t=>new sh({checks:[],typeName:Zn.ZodString,coerce:t?.coerce??!1,...fr(t)});function VK(t,e){const r=(t.toString().split(".")[1]||"").length,l=(e.toString().split(".")[1]||"").length,u=r>l?r:l,m=Number.parseInt(t.toFixed(u).replace(".","")),v=Number.parseInt(e.toFixed(u).replace(".",""));return m%v/10**u}class Hy extends vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==xn.number){const m=this._getOrReturnCtx(e);return an(m,{code:Ht.invalid_type,expected:xn.number,received:m.parsedType}),qn}let l;const u=new Ca;for(const m of this._def.checks)m.kind==="int"?Sr.isInteger(e.data)||(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.invalid_type,expected:"integer",received:"float",message:m.message}),u.dirty()):m.kind==="min"?(m.inclusive?e.data<m.value:e.data<=m.value)&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.too_small,minimum:m.value,type:"number",inclusive:m.inclusive,exact:!1,message:m.message}),u.dirty()):m.kind==="max"?(m.inclusive?e.data>m.value:e.data>=m.value)&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.too_big,maximum:m.value,type:"number",inclusive:m.inclusive,exact:!1,message:m.message}),u.dirty()):m.kind==="multipleOf"?VK(e.data,m.value)!==0&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.not_multiple_of,multipleOf:m.value,message:m.message}),u.dirty()):m.kind==="finite"?Number.isFinite(e.data)||(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.not_finite,message:m.message}),u.dirty()):Sr.assertNever(m);return{status:u.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,Tn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Tn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Tn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Tn.toString(r))}setLimit(e,r,l,u){return new Hy({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:l,message:Tn.toString(u)}]})}_addCheck(e){return new Hy({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Tn.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Tn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Tn.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:Tn.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Tn.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Tn.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Sr.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const l of this._def.checks){if(l.kind==="finite"||l.kind==="int"||l.kind==="multipleOf")return!0;l.kind==="min"?(r===null||l.value>r)&&(r=l.value):l.kind==="max"&&(e===null||l.value<e)&&(e=l.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Hy.create=t=>new Hy({checks:[],typeName:Zn.ZodNumber,coerce:t?.coerce||!1,...fr(t)});class Wy extends vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==xn.bigint)return this._getInvalidInput(e);let l;const u=new Ca;for(const m of this._def.checks)m.kind==="min"?(m.inclusive?e.data<m.value:e.data<=m.value)&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.too_small,type:"bigint",minimum:m.value,inclusive:m.inclusive,message:m.message}),u.dirty()):m.kind==="max"?(m.inclusive?e.data>m.value:e.data>=m.value)&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.too_big,type:"bigint",maximum:m.value,inclusive:m.inclusive,message:m.message}),u.dirty()):m.kind==="multipleOf"?e.data%m.value!==BigInt(0)&&(l=this._getOrReturnCtx(e,l),an(l,{code:Ht.not_multiple_of,multipleOf:m.value,message:m.message}),u.dirty()):Sr.assertNever(m);return{status:u.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return an(r,{code:Ht.invalid_type,expected:xn.bigint,received:r.parsedType}),qn}gte(e,r){return this.setLimit("min",e,!0,Tn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,Tn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,Tn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,Tn.toString(r))}setLimit(e,r,l,u){return new Wy({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:l,message:Tn.toString(u)}]})}_addCheck(e){return new Wy({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Tn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Tn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Tn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Tn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:Tn.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}Wy.create=t=>new Wy({checks:[],typeName:Zn.ZodBigInt,coerce:t?.coerce??!1,...fr(t)});class II extends vr{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==xn.boolean){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.boolean,received:l.parsedType}),qn}return al(e.data)}}II.create=t=>new II({typeName:Zn.ZodBoolean,coerce:t?.coerce||!1,...fr(t)});class _v extends vr{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==xn.date){const m=this._getOrReturnCtx(e);return an(m,{code:Ht.invalid_type,expected:xn.date,received:m.parsedType}),qn}if(Number.isNaN(e.data.getTime())){const m=this._getOrReturnCtx(e);return an(m,{code:Ht.invalid_date}),qn}const l=new Ca;let u;for(const m of this._def.checks)m.kind==="min"?e.data.getTime()<m.value&&(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.too_small,message:m.message,inclusive:!0,exact:!1,minimum:m.value,type:"date"}),l.dirty()):m.kind==="max"?e.data.getTime()>m.value&&(u=this._getOrReturnCtx(e,u),an(u,{code:Ht.too_big,message:m.message,inclusive:!0,exact:!1,maximum:m.value,type:"date"}),l.dirty()):Sr.assertNever(m);return{status:l.value,value:new Date(e.data.getTime())}}_addCheck(e){return new _v({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:Tn.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:Tn.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}_v.create=t=>new _v({checks:[],coerce:t?.coerce||!1,typeName:Zn.ZodDate,...fr(t)});class MI extends vr{_parse(e){if(this._getType(e)!==xn.symbol){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.symbol,received:l.parsedType}),qn}return al(e.data)}}MI.create=t=>new MI({typeName:Zn.ZodSymbol,...fr(t)});class PI extends vr{_parse(e){if(this._getType(e)!==xn.undefined){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.undefined,received:l.parsedType}),qn}return al(e.data)}}PI.create=t=>new PI({typeName:Zn.ZodUndefined,...fr(t)});class NI extends vr{_parse(e){if(this._getType(e)!==xn.null){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.null,received:l.parsedType}),qn}return al(e.data)}}NI.create=t=>new NI({typeName:Zn.ZodNull,...fr(t)});class RI extends vr{constructor(){super(...arguments),this._any=!0}_parse(e){return al(e.data)}}RI.create=t=>new RI({typeName:Zn.ZodAny,...fr(t)});class DI extends vr{constructor(){super(...arguments),this._unknown=!0}_parse(e){return al(e.data)}}DI.create=t=>new DI({typeName:Zn.ZodUnknown,...fr(t)});class xh extends vr{_parse(e){const r=this._getOrReturnCtx(e);return an(r,{code:Ht.invalid_type,expected:xn.never,received:r.parsedType}),qn}}xh.create=t=>new xh({typeName:Zn.ZodNever,...fr(t)});class LI extends vr{_parse(e){if(this._getType(e)!==xn.undefined){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.void,received:l.parsedType}),qn}return al(e.data)}}LI.create=t=>new LI({typeName:Zn.ZodVoid,...fr(t)});class Zc extends vr{_parse(e){const{ctx:r,status:l}=this._processInputParams(e),u=this._def;if(r.parsedType!==xn.array)return an(r,{code:Ht.invalid_type,expected:xn.array,received:r.parsedType}),qn;if(u.exactLength!==null){const v=r.data.length>u.exactLength.value,b=r.data.length<u.exactLength.value;(v||b)&&(an(r,{code:v?Ht.too_big:Ht.too_small,minimum:b?u.exactLength.value:void 0,maximum:v?u.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:u.exactLength.message}),l.dirty())}if(u.minLength!==null&&r.data.length<u.minLength.value&&(an(r,{code:Ht.too_small,minimum:u.minLength.value,type:"array",inclusive:!0,exact:!1,message:u.minLength.message}),l.dirty()),u.maxLength!==null&&r.data.length>u.maxLength.value&&(an(r,{code:Ht.too_big,maximum:u.maxLength.value,type:"array",inclusive:!0,exact:!1,message:u.maxLength.message}),l.dirty()),r.common.async)return Promise.all([...r.data].map((v,b)=>u.type._parseAsync(new _h(r,v,r.path,b)))).then(v=>Ca.mergeArray(l,v));const m=[...r.data].map((v,b)=>u.type._parseSync(new _h(r,v,r.path,b)));return Ca.mergeArray(l,m)}get element(){return this._def.type}min(e,r){return new Zc({...this._def,minLength:{value:e,message:Tn.toString(r)}})}max(e,r){return new Zc({...this._def,maxLength:{value:e,message:Tn.toString(r)}})}length(e,r){return new Zc({...this._def,exactLength:{value:e,message:Tn.toString(r)}})}nonempty(e){return this.min(1,e)}}Zc.create=(t,e)=>new Zc({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Zn.ZodArray,...fr(e)});function gm(t){if(t instanceof gs){const e={};for(const r in t.shape){const l=t.shape[r];e[r]=hh.create(gm(l))}return new gs({...t._def,shape:()=>e})}else return t instanceof Zc?new Zc({...t._def,type:gm(t.element)}):t instanceof hh?hh.create(gm(t.unwrap())):t instanceof Hm?Hm.create(gm(t.unwrap())):t instanceof rp?rp.create(t.items.map(e=>gm(e))):t}class gs extends vr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Sr.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==xn.object){const k=this._getOrReturnCtx(e);return an(k,{code:Ht.invalid_type,expected:xn.object,received:k.parsedType}),qn}const{status:l,ctx:u}=this._processInputParams(e),{shape:m,keys:v}=this._getCached(),b=[];if(!(this._def.catchall instanceof xh&&this._def.unknownKeys==="strip"))for(const k in u.data)v.includes(k)||b.push(k);const a=[];for(const k of v){const M=m[k],L=u.data[k];a.push({key:{status:"valid",value:k},value:M._parse(new _h(u,L,u.path,k)),alwaysSet:k in u.data})}if(this._def.catchall instanceof xh){const k=this._def.unknownKeys;if(k==="passthrough")for(const M of b)a.push({key:{status:"valid",value:M},value:{status:"valid",value:u.data[M]}});else if(k==="strict")b.length>0&&(an(u,{code:Ht.unrecognized_keys,keys:b}),l.dirty());else if(k!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const k=this._def.catchall;for(const M of b){const L=u.data[M];a.push({key:{status:"valid",value:M},value:k._parse(new _h(u,L,u.path,M)),alwaysSet:M in u.data})}}return u.common.async?Promise.resolve().then(async()=>{const k=[];for(const M of a){const L=await M.key,z=await M.value;k.push({key:L,value:z,alwaysSet:M.alwaysSet})}return k}).then(k=>Ca.mergeObjectSync(l,k)):Ca.mergeObjectSync(l,a)}get shape(){return this._def.shape()}strict(e){return Tn.errToObj,new gs({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,l)=>{const u=this._def.errorMap?.(r,l).message??l.defaultError;return r.code==="unrecognized_keys"?{message:Tn.errToObj(e).message??u}:{message:u}}}:{}})}strip(){return new gs({...this._def,unknownKeys:"strip"})}passthrough(){return new gs({...this._def,unknownKeys:"passthrough"})}extend(e){return new gs({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new gs({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Zn.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new gs({...this._def,catchall:e})}pick(e){const r={};for(const l of Sr.objectKeys(e))e[l]&&this.shape[l]&&(r[l]=this.shape[l]);return new gs({...this._def,shape:()=>r})}omit(e){const r={};for(const l of Sr.objectKeys(this.shape))e[l]||(r[l]=this.shape[l]);return new gs({...this._def,shape:()=>r})}deepPartial(){return gm(this)}partial(e){const r={};for(const l of Sr.objectKeys(this.shape)){const u=this.shape[l];e&&!e[l]?r[l]=u:r[l]=u.optional()}return new gs({...this._def,shape:()=>r})}required(e){const r={};for(const l of Sr.objectKeys(this.shape))if(e&&!e[l])r[l]=this.shape[l];else{let m=this.shape[l];for(;m instanceof hh;)m=m._def.innerType;r[l]=m}return new gs({...this._def,shape:()=>r})}keyof(){return N4(Sr.objectKeys(this.shape))}}gs.create=(t,e)=>new gs({shape:()=>t,unknownKeys:"strip",catchall:xh.create(),typeName:Zn.ZodObject,...fr(e)});gs.strictCreate=(t,e)=>new gs({shape:()=>t,unknownKeys:"strict",catchall:xh.create(),typeName:Zn.ZodObject,...fr(e)});gs.lazycreate=(t,e)=>new gs({shape:t,unknownKeys:"strip",catchall:xh.create(),typeName:Zn.ZodObject,...fr(e)});class xv extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l=this._def.options;function u(m){for(const b of m)if(b.result.status==="valid")return b.result;for(const b of m)if(b.result.status==="dirty")return r.common.issues.push(...b.ctx.common.issues),b.result;const v=m.map(b=>new Qu(b.ctx.common.issues));return an(r,{code:Ht.invalid_union,unionErrors:v}),qn}if(r.common.async)return Promise.all(l.map(async m=>{const v={...r,common:{...r.common,issues:[]},parent:null};return{result:await m._parseAsync({data:r.data,path:r.path,parent:v}),ctx:v}})).then(u);{let m;const v=[];for(const a of l){const k={...r,common:{...r.common,issues:[]},parent:null},M=a._parseSync({data:r.data,path:r.path,parent:k});if(M.status==="valid")return M;M.status==="dirty"&&!m&&(m={result:M,ctx:k}),k.common.issues.length&&v.push(k.common.issues)}if(m)return r.common.issues.push(...m.ctx.common.issues),m.result;const b=v.map(a=>new Qu(a));return an(r,{code:Ht.invalid_union,unionErrors:b}),qn}}get options(){return this._def.options}}xv.create=(t,e)=>new xv({options:t,typeName:Zn.ZodUnion,...fr(e)});function gb(t,e){const r=Jd(t),l=Jd(e);if(t===e)return{valid:!0,data:t};if(r===xn.object&&l===xn.object){const u=Sr.objectKeys(e),m=Sr.objectKeys(t).filter(b=>u.indexOf(b)!==-1),v={...t,...e};for(const b of m){const a=gb(t[b],e[b]);if(!a.valid)return{valid:!1};v[b]=a.data}return{valid:!0,data:v}}else if(r===xn.array&&l===xn.array){if(t.length!==e.length)return{valid:!1};const u=[];for(let m=0;m<t.length;m++){const v=t[m],b=e[m],a=gb(v,b);if(!a.valid)return{valid:!1};u.push(a.data)}return{valid:!0,data:u}}else return r===xn.date&&l===xn.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class vv extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e),u=(m,v)=>{if(CI(m)||CI(v))return qn;const b=gb(m.value,v.value);return b.valid?((kI(m)||kI(v))&&r.dirty(),{status:r.value,value:b.data}):(an(l,{code:Ht.invalid_intersection_types}),qn)};return l.common.async?Promise.all([this._def.left._parseAsync({data:l.data,path:l.path,parent:l}),this._def.right._parseAsync({data:l.data,path:l.path,parent:l})]).then(([m,v])=>u(m,v)):u(this._def.left._parseSync({data:l.data,path:l.path,parent:l}),this._def.right._parseSync({data:l.data,path:l.path,parent:l}))}}vv.create=(t,e,r)=>new vv({left:t,right:e,typeName:Zn.ZodIntersection,...fr(r)});class rp extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.array)return an(l,{code:Ht.invalid_type,expected:xn.array,received:l.parsedType}),qn;if(l.data.length<this._def.items.length)return an(l,{code:Ht.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),qn;!this._def.rest&&l.data.length>this._def.items.length&&(an(l,{code:Ht.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const m=[...l.data].map((v,b)=>{const a=this._def.items[b]||this._def.rest;return a?a._parse(new _h(l,v,l.path,b)):null}).filter(v=>!!v);return l.common.async?Promise.all(m).then(v=>Ca.mergeArray(r,v)):Ca.mergeArray(r,m)}get items(){return this._def.items}rest(e){return new rp({...this._def,rest:e})}}rp.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new rp({items:t,typeName:Zn.ZodTuple,rest:null,...fr(e)})};class jI extends vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.map)return an(l,{code:Ht.invalid_type,expected:xn.map,received:l.parsedType}),qn;const u=this._def.keyType,m=this._def.valueType,v=[...l.data.entries()].map(([b,a],k)=>({key:u._parse(new _h(l,b,l.path,[k,"key"])),value:m._parse(new _h(l,a,l.path,[k,"value"]))}));if(l.common.async){const b=new Map;return Promise.resolve().then(async()=>{for(const a of v){const k=await a.key,M=await a.value;if(k.status==="aborted"||M.status==="aborted")return qn;(k.status==="dirty"||M.status==="dirty")&&r.dirty(),b.set(k.value,M.value)}return{status:r.value,value:b}})}else{const b=new Map;for(const a of v){const k=a.key,M=a.value;if(k.status==="aborted"||M.status==="aborted")return qn;(k.status==="dirty"||M.status==="dirty")&&r.dirty(),b.set(k.value,M.value)}return{status:r.value,value:b}}}}jI.create=(t,e,r)=>new jI({valueType:e,keyType:t,typeName:Zn.ZodMap,...fr(r)});class qy extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.set)return an(l,{code:Ht.invalid_type,expected:xn.set,received:l.parsedType}),qn;const u=this._def;u.minSize!==null&&l.data.size<u.minSize.value&&(an(l,{code:Ht.too_small,minimum:u.minSize.value,type:"set",inclusive:!0,exact:!1,message:u.minSize.message}),r.dirty()),u.maxSize!==null&&l.data.size>u.maxSize.value&&(an(l,{code:Ht.too_big,maximum:u.maxSize.value,type:"set",inclusive:!0,exact:!1,message:u.maxSize.message}),r.dirty());const m=this._def.valueType;function v(a){const k=new Set;for(const M of a){if(M.status==="aborted")return qn;M.status==="dirty"&&r.dirty(),k.add(M.value)}return{status:r.value,value:k}}const b=[...l.data.values()].map((a,k)=>m._parse(new _h(l,a,l.path,k)));return l.common.async?Promise.all(b).then(a=>v(a)):v(b)}min(e,r){return new qy({...this._def,minSize:{value:e,message:Tn.toString(r)}})}max(e,r){return new qy({...this._def,maxSize:{value:e,message:Tn.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}qy.create=(t,e)=>new qy({valueType:t,minSize:null,maxSize:null,typeName:Zn.ZodSet,...fr(e)});class OI extends vr{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}OI.create=(t,e)=>new OI({getter:t,typeName:Zn.ZodLazy,...fr(e)});class zI extends vr{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return an(r,{received:r.data,code:Ht.invalid_literal,expected:this._def.value}),qn}return{status:"valid",value:e.data}}get value(){return this._def.value}}zI.create=(t,e)=>new zI({value:t,typeName:Zn.ZodLiteral,...fr(e)});function N4(t,e){return new $m({values:t,typeName:Zn.ZodEnum,...fr(e)})}class $m extends vr{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),l=this._def.values;return an(r,{expected:Sr.joinValues(l),received:r.parsedType,code:Ht.invalid_type}),qn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),l=this._def.values;return an(r,{received:r.data,code:Ht.invalid_enum_value,options:l}),qn}return al(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return $m.create(e,{...this._def,...r})}exclude(e,r=this._def){return $m.create(this.options.filter(l=>!e.includes(l)),{...this._def,...r})}}$m.create=N4;class BI extends vr{_parse(e){const r=Sr.getValidEnumValues(this._def.values),l=this._getOrReturnCtx(e);if(l.parsedType!==xn.string&&l.parsedType!==xn.number){const u=Sr.objectValues(r);return an(l,{expected:Sr.joinValues(u),received:l.parsedType,code:Ht.invalid_type}),qn}if(this._cache||(this._cache=new Set(Sr.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const u=Sr.objectValues(r);return an(l,{received:l.data,code:Ht.invalid_enum_value,options:u}),qn}return al(e.data)}get enum(){return this._def.values}}BI.create=(t,e)=>new BI({values:t,typeName:Zn.ZodNativeEnum,...fr(e)});class wv extends vr{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==xn.promise&&r.common.async===!1)return an(r,{code:Ht.invalid_type,expected:xn.promise,received:r.parsedType}),qn;const l=r.parsedType===xn.promise?r.data:Promise.resolve(r.data);return al(l.then(u=>this._def.type.parseAsync(u,{path:r.path,errorMap:r.common.contextualErrorMap})))}}wv.create=(t,e)=>new wv({type:t,typeName:Zn.ZodPromise,...fr(e)});class Gm extends vr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Zn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:l}=this._processInputParams(e),u=this._def.effect||null,m={addIssue:v=>{an(l,v),v.fatal?r.abort():r.dirty()},get path(){return l.path}};if(m.addIssue=m.addIssue.bind(m),u.type==="preprocess"){const v=u.transform(l.data,m);if(l.common.async)return Promise.resolve(v).then(async b=>{if(r.value==="aborted")return qn;const a=await this._def.schema._parseAsync({data:b,path:l.path,parent:l});return a.status==="aborted"?qn:a.status==="dirty"||r.value==="dirty"?hy(a.value):a});{if(r.value==="aborted")return qn;const b=this._def.schema._parseSync({data:v,path:l.path,parent:l});return b.status==="aborted"?qn:b.status==="dirty"||r.value==="dirty"?hy(b.value):b}}if(u.type==="refinement"){const v=b=>{const a=u.refinement(b,m);if(l.common.async)return Promise.resolve(a);if(a instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return b};if(l.common.async===!1){const b=this._def.schema._parseSync({data:l.data,path:l.path,parent:l});return b.status==="aborted"?qn:(b.status==="dirty"&&r.dirty(),v(b.value),{status:r.value,value:b.value})}else return this._def.schema._parseAsync({data:l.data,path:l.path,parent:l}).then(b=>b.status==="aborted"?qn:(b.status==="dirty"&&r.dirty(),v(b.value).then(()=>({status:r.value,value:b.value}))))}if(u.type==="transform")if(l.common.async===!1){const v=this._def.schema._parseSync({data:l.data,path:l.path,parent:l});if(!Um(v))return qn;const b=u.transform(v.value,m);if(b instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:b}}else return this._def.schema._parseAsync({data:l.data,path:l.path,parent:l}).then(v=>Um(v)?Promise.resolve(u.transform(v.value,m)).then(b=>({status:r.value,value:b})):qn);Sr.assertNever(u)}}Gm.create=(t,e,r)=>new Gm({schema:t,typeName:Zn.ZodEffects,effect:e,...fr(r)});Gm.createWithPreprocess=(t,e,r)=>new Gm({schema:e,effect:{type:"preprocess",transform:t},typeName:Zn.ZodEffects,...fr(r)});class hh extends vr{_parse(e){return this._getType(e)===xn.undefined?al(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}hh.create=(t,e)=>new hh({innerType:t,typeName:Zn.ZodOptional,...fr(e)});class Hm extends vr{_parse(e){return this._getType(e)===xn.null?al(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Hm.create=(t,e)=>new Hm({innerType:t,typeName:Zn.ZodNullable,...fr(e)});class yb extends vr{_parse(e){const{ctx:r}=this._processInputParams(e);let l=r.data;return r.parsedType===xn.undefined&&(l=this._def.defaultValue()),this._def.innerType._parse({data:l,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}yb.create=(t,e)=>new yb({innerType:t,typeName:Zn.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...fr(e)});class _b extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l={...r,common:{...r.common,issues:[]}},u=this._def.innerType._parse({data:l.data,path:l.path,parent:{...l}});return yv(u)?u.then(m=>({status:"valid",value:m.status==="valid"?m.value:this._def.catchValue({get error(){return new Qu(l.common.issues)},input:l.data})})):{status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new Qu(l.common.issues)},input:l.data})}}removeCatch(){return this._def.innerType}}_b.create=(t,e)=>new _b({innerType:t,typeName:Zn.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...fr(e)});class FI extends vr{_parse(e){if(this._getType(e)!==xn.nan){const l=this._getOrReturnCtx(e);return an(l,{code:Ht.invalid_type,expected:xn.nan,received:l.parsedType}),qn}return{status:"valid",value:e.data}}}FI.create=t=>new FI({typeName:Zn.ZodNaN,...fr(t)});class UK extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l=r.data;return this._def.type._parse({data:l,path:r.path,parent:r})}unwrap(){return this._def.type}}class uS extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.common.async)return(async()=>{const m=await this._def.in._parseAsync({data:l.data,path:l.path,parent:l});return m.status==="aborted"?qn:m.status==="dirty"?(r.dirty(),hy(m.value)):this._def.out._parseAsync({data:m.value,path:l.path,parent:l})})();{const u=this._def.in._parseSync({data:l.data,path:l.path,parent:l});return u.status==="aborted"?qn:u.status==="dirty"?(r.dirty(),{status:"dirty",value:u.value}):this._def.out._parseSync({data:u.value,path:l.path,parent:l})}}static create(e,r){return new uS({in:e,out:r,typeName:Zn.ZodPipeline})}}class xb extends vr{_parse(e){const r=this._def.innerType._parse(e),l=u=>(Um(u)&&(u.value=Object.freeze(u.value)),u);return yv(r)?r.then(u=>l(u)):l(r)}unwrap(){return this._def.innerType}}xb.create=(t,e)=>new xb({innerType:t,typeName:Zn.ZodReadonly,...fr(e)});var Zn;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Zn||(Zn={}));const R4=sh.create;xh.create;Zc.create;xv.create;vv.create;rp.create;$m.create;wv.create;hh.create;Hm.create;const $K=R4().email("Email khng hp l"),GK=R4().min(6,"Mt khu phi c t nht 6 k t"),HK=({isOpen:t,onClose:e})=>{const[r,l]=P.useState("login"),[u,m]=P.useState(""),[v,b]=P.useState(""),[a,k]=P.useState(""),[M,L]=P.useState(!1),{signIn:z,signUp:O}=_o(),{language:K}=ia(),H=sp(),Z=async ie=>{ie.preventDefault(),k("");const pe=$K.safeParse(u);if(!pe.success){k(pe.error.errors[0].message);return}const xe=GK.safeParse(v);if(!xe.success){k(xe.error.errors[0].message);return}L(!0);try{let Ce;if(r==="login"?Ce=await z(u,v):Ce=await O(u,v),console.log("Kt qu Auth:",Ce),Ce&&Ce.error){const je=Ce.error.message||JSON.stringify(Ce.error);je.includes("Invalid login credentials")||je.includes("auth/invalid-credential")?k(K==="vi"?"Sai email hoc mt khu":"Invalid email or password"):je.includes("User already registered")||je.includes("auth/email-already-in-use")?k(K==="vi"?"Email ny  c ng k":"Email already registered"):k(je)}else console.log("ng nhp/ng k thnh cng!"),e(),m(""),b(""),k(""),u==="admin@gmail.com"&&H("/admin")}catch(Ce){console.error("Li Exception:",Ce);let je="C li xy ra, vui lng th li.";Ce.code==="auth/invalid-credential"&&(je="Sai email hoc mt khu."),Ce.code==="auth/email-already-in-use"&&(je="Email ny  c s dng."),k(je)}finally{L(!1)}},ee={vi:{login:"ng nhp",signup:"ng k",email:"Email",password:"Mt khu",noAccount:"Cha c ti khon?",hasAccount:" c ti khon?",signupNow:"ng k ngay",loginNow:"ng nhp",welcome:"Cho mng bn",createAccount:"To ti khon",saveFavorites:"Lu a im yu thch trn mi thit b"},en:{login:"Login",signup:"Sign up",email:"Email",password:"Password",noAccount:"Don't have an account?",hasAccount:"Already have an account?",signupNow:"Sign up now",loginNow:"Login",welcome:"Welcome back",createAccount:"Create account",saveFavorites:"Save favorite locations across all devices"}}[K];return t?_.jsx(Sa,{children:_.jsx(yr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:e,children:_.jsxs(yr.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md bg-background rounded-3xl shadow-2xl overflow-hidden",onClick:ie=>ie.stopPropagation(),children:[_.jsxs("div",{className:"relative p-6 pb-4 bg-gradient-to-br from-primary to-primary/80",children:[_.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:_.jsx(di,{className:"w-4 h-4 text-white"})}),_.jsx("div",{className:"flex items-center gap-3 mb-2",children:_.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/20 flex items-center justify-center",children:_.jsx(Iy,{className:"w-6 h-6 text-white"})})}),_.jsx("h2",{className:"text-2xl font-bold text-white",children:r==="login"?ee.welcome:ee.createAccount}),_.jsx("p",{className:"text-white/80 text-sm mt-1",children:ee.saveFavorites})]}),_.jsxs("form",{onSubmit:Z,className:"p-6 space-y-4",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsxs("div",{className:"relative",children:[_.jsx(SM,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),_.jsx(ui,{type:"email",placeholder:ee.email,value:u,onChange:ie=>m(ie.target.value),className:"pl-12 h-14 rounded-2xl border-2 text-base",required:!0})]}),_.jsxs("div",{className:"relative",children:[_.jsx(Ay,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),_.jsx(ui,{type:"password",placeholder:ee.password,value:v,onChange:ie=>b(ie.target.value),className:"pl-12 h-14 rounded-2xl border-2 text-base",required:!0})]})]}),a&&_.jsx(yr.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-destructive text-sm text-center",children:a}),_.jsx(pn,{type:"submit",disabled:M,className:"w-full h-14 text-base font-semibold rounded-2xl",children:M?_.jsx(ki,{className:"w-5 h-5 animate-spin"}):r==="login"?ee.login:ee.signup}),_.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[r==="login"?ee.noAccount:ee.hasAccount," ",_.jsx("button",{type:"button",onClick:()=>{l(r==="login"?"signup":"login"),k("")},className:"text-primary font-semibold hover:underline",children:r==="login"?ee.signupNow:ee.loginNow})]})]})]})})}):null},kx="https://thodia-backend-1067502227654.asia-southeast1.run.app",WK=({isOpen:t,onClose:e,onSelectLocation:r,onNavigate:l,onLoginClick:u})=>{const{user:m}=_o(),[v,b]=P.useState([]),[a,k]=P.useState([]),[M,L]=P.useState(!0),z=async()=>{if(m){L(!0);try{const ee=await(await fetch(`${kx}/api/favorites?userId=${m.uid}`)).json();if(Array.isArray(ee)){const xe=ee.map(Ce=>({id:Ce.location_id,name:Ce.location_name_en||Ce.location_name,nameVi:Ce.location_name,lat:Ce.location_lat,lng:Ce.location_lng,type:Ce.location_type||"checkin",address:"a im  lu",description:"",image:""}));b(xe)}const pe=await(await fetch(`${kx}/api/user-vouchers?userId=${m.uid}`)).json();if(Array.isArray(pe)){const xe=pe.map(Ce=>({id:Ce.saved_id,voucher:{id:Ce.id,code:Ce.code,title_vi:Ce.title_vi,discount_value:Ce.discount_value,discount_type:Ce.discount_type,store:{id:Ce.store_id,name_vi:Ce.store_name,lat:Ce.lat,lng:Ce.lng,address_vi:Ce.address_vi,image_url:Ce.image_url}}}));k(xe)}}catch(Y){console.error(" Li ti d liu:",Y),Gt.error("Khng th ti danh sch yu thch")}finally{L(!1)}}};P.useEffect(()=>{t&&z()},[m,t]);const O=async(Y,ee)=>{Y.stopPropagation(),b(ie=>ie.filter(pe=>pe.id!==ee));try{await fetch(`${kx}/api/favorites/${ee}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m?.uid})}),Gt.success(" xa khi yu thch")}catch{Gt.error("Li khi xa, vui lng th li"),z()}},K=async(Y,ee)=>{Y.stopPropagation();const ie=[...a];k(pe=>pe.filter(xe=>xe.id!==ee));try{if(!(await fetch(`${kx}/api/user-vouchers/${ee}`,{method:"DELETE"})).ok)throw new Error("Failed");Gt.success(" xa voucher")}catch{k(ie),Gt.error("Khng xa c voucher")}},H=Y=>{l?l(Y):r&&r(Y),e()},Z=Y=>{const ee=Y.voucher.store,ie={id:ee.id,nameVi:ee.name_vi,name:ee.name_vi,lat:ee.lat,lng:ee.lng,type:"food",address:ee.address_vi,description:`u i: Gim ${Y.voucher.discount_value}${Y.voucher.discount_type==="percent"?"%":"k"} - Code: ${Y.voucher.code}`,image:ee.image_url||"https://placehold.co/600x400?text=Store"};H(ie),Gt.info(`ang dn ng n: ${ee.name_vi}`)};return t?_.jsxs("div",{className:"fixed inset-y-0 left-0 z-[60] w-full md:w-[400px] bg-white shadow-2xl transform transition-transform duration-300 ease-in-out flex flex-col border-r",children:[_.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50/80 backdrop-blur-sm sticky top-0 z-10",children:[_.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2 text-gray-800",children:[_.jsx($f,{className:"w-5 h-5 text-red-500 fill-red-500"}),"Kho lu tr"]}),_.jsx(pn,{variant:"ghost",size:"icon",onClick:e,className:"rounded-full hover:bg-gray-200",children:_.jsx(di,{className:"w-5 h-5"})})]}),_.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:m?_.jsxs(Gy,{defaultValue:"locations",className:"w-full h-full flex flex-col",children:[_.jsx("div",{className:"px-4 pt-4 pb-2",children:_.jsxs(Fm,{className:"grid w-full grid-cols-2 bg-gray-100/80 p-1 rounded-xl",children:[_.jsx(Vi,{value:"locations",className:"rounded-lg text-sm font-medium data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"a im"}),_.jsxs(Vi,{value:"vouchers",className:"rounded-lg text-sm font-medium data-[state=active]:bg-white data-[state=active]:shadow-sm",children:["Voucher ",_.jsx("span",{className:"ml-1.5 text-xs bg-primary/10 text-primary px-1.5 py-0.5 rounded-full",children:a.length})]})]})}),_.jsx(Ps,{value:"locations",className:"flex-1 overflow-y-auto px-4 pb-4 pt-2 space-y-3",children:M?_.jsx("div",{className:"flex justify-center py-8",children:_.jsx(ki,{className:"w-6 h-6 animate-spin text-primary"})}):v.length===0?_.jsxs("div",{className:"text-center py-10 space-y-3",children:[_.jsx(Ai,{className:"w-10 h-10 text-gray-200 mx-auto"}),_.jsx("p",{className:"text-gray-400 text-sm",children:"Bn cha lu a im no."})]}):v.map(Y=>_.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-100 rounded-xl hover:border-primary/50 hover:shadow-md cursor-pointer transition-all group",onClick:()=>H(Y),children:[_.jsx("div",{className:"bg-red-50 p-2.5 rounded-full text-red-500 flex-shrink-0 group-hover:scale-105 transition-transform",children:_.jsx($f,{className:"w-5 h-5 fill-current"})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h4",{className:"font-bold text-sm truncate text-gray-900",children:Y.nameVi}),_.jsx("p",{className:"text-xs text-gray-500 truncate",children:Y.address||"a im trn bn "})]}),_.jsx(pn,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-red-600 hover:bg-red-50 rounded-full",onClick:ee=>O(ee,Y.id),children:_.jsx(lh,{className:"w-4 h-4"})})]},Y.id))}),_.jsx(Ps,{value:"vouchers",className:"flex-1 overflow-y-auto px-4 pb-4 pt-2 space-y-3",children:M?_.jsx("div",{className:"flex justify-center py-8",children:_.jsx(ki,{className:"w-6 h-6 animate-spin text-primary"})}):a.length===0?_.jsxs("div",{className:"text-center py-10 space-y-3",children:[_.jsx(qm,{className:"w-10 h-10 text-gray-200 mx-auto"}),_.jsx("p",{className:"text-gray-400 text-sm",children:"V voucher trng."})]}):a.map(Y=>_.jsxs("div",{className:"relative bg-white border border-dashed border-primary/30 rounded-xl overflow-hidden shadow-sm hover:shadow-md hover:border-primary transition-all group cursor-pointer",onClick:()=>Z(Y),children:[_.jsxs("div",{className:"flex items-stretch h-24",children:[_.jsxs("div",{className:"bg-primary/5 w-24 flex flex-col items-center justify-center p-2 border-r border-dashed border-primary/30 shrink-0",children:[_.jsxs("span",{className:"text-2xl font-black text-primary leading-none",children:[Y.voucher.discount_value,_.jsx("span",{className:"text-sm font-bold",children:Y.voucher.discount_type==="percent"?"%":"k"})]}),_.jsx("span",{className:"text-[10px] text-primary/70 font-bold uppercase mt-1 text-center",children:"Gim gi"})]}),_.jsxs("div",{className:"flex-1 p-3 min-w-0 flex flex-col justify-between",children:[_.jsxs("div",{children:[_.jsx("h4",{className:"font-bold text-sm truncate text-gray-900",title:Y.voucher.store.name_vi,children:Y.voucher.store.name_vi}),_.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1 mt-0.5",children:Y.voucher.title_vi})]}),_.jsxs("div",{className:"flex items-center justify-between mt-2",children:[_.jsx("code",{className:"bg-gray-50 border px-1.5 py-0.5 rounded text-[11px] font-mono font-bold text-gray-600",children:Y.voucher.code}),_.jsxs("span",{className:"text-xs text-primary font-bold flex items-center group-hover:underline",children:["Dng ngay ",_.jsx(EO,{className:"w-3 h-3 ml-1"})]})]})]})]}),_.jsx("button",{onClick:ee=>K(ee,Y.id),className:"absolute top-1 right-1 p-1.5 text-gray-400/50 hover:text-red-500 hover:bg-red-50 rounded-full transition-all z-10",title:"Xa voucher",children:_.jsx(lh,{className:"w-3.5 h-3.5"})})]},Y.id))})]}):_.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 p-6",children:[_.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:_.jsx($f,{className:"w-8 h-8 text-gray-400"})}),_.jsxs("div",{children:[_.jsx("h3",{className:"font-bold text-gray-900",children:"Cha ng nhp"}),_.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ng nhp  ng b a im v voucher ca bn."})]}),_.jsx(pn,{onClick:u,className:"rounded-xl font-bold",children:"ng nhp ngay"})]})})]}):null},Bc="https://thodia-backend-1067502227654.asia-southeast1.run.app",dS=()=>{const{user:t}=_o(),e=zv(),{data:r=[],isLoading:l,refetch:u}=Jb({queryKey:["user_stores",t?.uid],queryFn:async()=>{if(!t)return[];try{const ee=await(await fetch(`${Bc}/api/user-stores?userId=${t.uid}`)).json();return Array.isArray(ee)?ee:[]}catch(Y){return console.error(Y),[]}},enabled:!!t}),m=Bl({mutationFn:async Y=>null,onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Gt.success(" gi yu cu to ca hng!")}}),v=Bl({mutationFn:async({id:Y,data:ee})=>null,onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Gt.success(" cp nht ca hng!")}}),b=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/stores/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Gt.success(" xa ca hng!")},onError:Y=>Gt.error("Li xa: "+Y.message)}),a=async Y=>{try{const ie=await(await fetch(`${Bc}/api/stores/${Y}/menu`)).json();return Array.isArray(ie)?ie:[]}catch{return[]}},k=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/menu-items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" thm mn mi"),onError:Y=>Gt.error("Li thm mn: "+Y.message)}),M=Bl({mutationFn:async({id:Y,data:ee})=>{if(!(await fetch(`${Bc}/api/menu-items/${Y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" cp nht mn"),onError:Y=>Gt.error("Li cp nht: "+Y.message)}),L=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/menu-items/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" xa mn n")}),z=async Y=>{try{const ie=await(await fetch(`${Bc}/api/stores/${Y}/vouchers-all`)).json();return Array.isArray(ie)?ie:[]}catch{return[]}},O=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/vouchers/active`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" to voucher"),onError:Y=>Gt.error("Li to voucher: "+Y.message)}),K=Bl({mutationFn:async({id:Y,data:ee})=>{if(!(await fetch(`${Bc}/api/vouchers/${Y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" cp nht voucher"),onError:Y=>Gt.error("Li cp nht: "+Y.message)}),H=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/vouchers/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>Gt.success(" xa voucher")}),Z=async(Y,ee="common")=>URL.createObjectURL(Y);return{stores:r,isLoading:l,fetchStores:u,createStore:m.mutateAsync,updateStore:async(Y,ee)=>await v.mutateAsync({id:Y,data:ee}),deleteStore:b.mutateAsync,fetchMenuItems:a,createMenuItem:k.mutateAsync,updateMenuItem:async(Y,ee)=>await M.mutateAsync({id:Y,data:ee}),deleteMenuItem:L.mutateAsync,fetchVouchers:z,createVoucher:O.mutateAsync,updateVoucher:async(Y,ee)=>await K.mutateAsync({id:Y,data:ee}),deleteVoucher:H.mutateAsync,uploadImage:Z}};var y0="Switch",[qK]=sl(y0),[ZK,XK]=qK(y0),D4=P.forwardRef((t,e)=>{const{__scopeSwitch:r,name:l,checked:u,defaultChecked:m,required:v,disabled:b,value:a="on",onCheckedChange:k,form:M,...L}=t,[z,O]=P.useState(null),K=or(e,ie=>O(ie)),H=P.useRef(!1),Z=z?M||!!z.closest("form"):!0,[Y,ee]=fh({prop:u,defaultProp:m??!1,onChange:k,caller:y0});return _.jsxs(ZK,{scope:r,checked:Y,disabled:b,children:[_.jsx(Mn.button,{type:"button",role:"switch","aria-checked":Y,"aria-required":v,"data-state":z4(Y),"data-disabled":b?"":void 0,disabled:b,value:a,...L,ref:K,onClick:Xt(t.onClick,ie=>{ee(pe=>!pe),Z&&(H.current=ie.isPropagationStopped(),H.current||ie.stopPropagation())})}),Z&&_.jsx(O4,{control:z,bubbles:!H.current,name:l,value:a,checked:Y,required:v,disabled:b,form:M,style:{transform:"translateX(-100%)"}})]})});D4.displayName=y0;var L4="SwitchThumb",j4=P.forwardRef((t,e)=>{const{__scopeSwitch:r,...l}=t,u=XK(L4,r);return _.jsx(Mn.span,{"data-state":z4(u.checked),"data-disabled":u.disabled?"":void 0,...l,ref:e})});j4.displayName=L4;var KK="SwitchBubbleInput",O4=P.forwardRef(({__scopeSwitch:t,control:e,checked:r,bubbles:l=!0,...u},m)=>{const v=P.useRef(null),b=or(v,m),a=$D(r),k=JM(e);return P.useEffect(()=>{const M=v.current;if(!M)return;const L=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(L,"checked").set;if(a!==r&&O){const K=new Event("click",{bubbles:l});O.call(M,r),M.dispatchEvent(K)}},[a,r,l]),_.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...u,tabIndex:-1,ref:b,style:{...u.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});O4.displayName=KK;function z4(t){return t?"checked":"unchecked"}var B4=D4,YK=j4;const hS=P.forwardRef(({className:t,...e},r)=>_.jsx(B4,{className:cn("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...e,ref:r,children:_.jsx(YK,{className:cn("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));hS.displayName=B4.displayName;const JK=({storeId:t,item:e,onClose:r,onSuccess:l})=>{const{language:u}=ia(),{createMenuItem:m,updateMenuItem:v,uploadImage:b}=dS(),a=P.useRef(null),[k,M]=P.useState(!1),[L,z]=P.useState(e?.image_url||null),[O,K]=P.useState(null),[H,Z]=P.useState({name_vi:e?.name_vi||"",name_en:e?.name_en||"",description_vi:e?.description_vi||"",description_en:e?.description_en||"",price:e?.price||0,is_available:e?.is_available??!0,sort_order:e?.sort_order||0}),Y=ie=>{const pe=ie.target.files?.[0];if(pe){K(pe);const xe=new FileReader;xe.onloadend=()=>{z(xe.result)},xe.readAsDataURL(pe)}},ee=async ie=>{ie.preventDefault(),M(!0);try{let pe=e?.image_url||null;if(O){const Ce=await b(O,"menu");Ce&&(pe=Ce)}const xe={store_id:t,...H,image_url:pe};e?await v(e.id,xe):await m(xe),l(),r()}catch(pe){console.error("Error saving menu item:",pe)}finally{M(!1)}};return _.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"bg-muted/50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsx("h4",{className:"font-semibold",children:e?u==="vi"?"Chnh sa mn":"Edit Item":u==="vi"?"Thm mn mi":"Add New Item"}),_.jsx("button",{onClick:r,className:"p-1 hover:bg-muted rounded-full",children:_.jsx(di,{className:"w-4 h-4"})})]}),_.jsxs("form",{onSubmit:ee,className:"space-y-3",children:[_.jsx("div",{onClick:()=>a.current?.click(),className:"border-2 border-dashed rounded-lg p-3 text-center cursor-pointer hover:border-primary transition-colors",children:L?_.jsx("img",{src:L,alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mx-auto"}):_.jsxs("div",{className:"py-2 text-muted-foreground",children:[_.jsx(Nb,{className:"w-8 h-8 mx-auto mb-1 opacity-50"}),_.jsx("p",{className:"text-xs",children:u==="vi"?"Thm nh":"Add image"})]})}),_.jsx("input",{ref:a,type:"file",accept:"image/*",onChange:Y,className:"hidden"}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Tn mn (VI) *"}),_.jsx(ui,{value:H.name_vi,onChange:ie=>Z(pe=>({...pe,name_vi:ie.target.value})),placeholder:"Tn mn",required:!0,className:"h-9"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Name (EN)"}),_.jsx(ui,{value:H.name_en,onChange:ie=>Z(pe=>({...pe,name_en:ie.target.value})),placeholder:"Item name",className:"h-9"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"M t (VI)"}),_.jsx(yh,{value:H.description_vi,onChange:ie=>Z(pe=>({...pe,description_vi:ie.target.value})),placeholder:"M t",rows:2,className:"text-sm"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Description (EN)"}),_.jsx(yh,{value:H.description_en,onChange:ie=>Z(pe=>({...pe,description_en:ie.target.value})),placeholder:"Description",rows:2,className:"text-sm"})]})]}),_.jsxs("div",{className:"flex gap-3 items-end",children:[_.jsxs("div",{className:"flex-1",children:[_.jsxs(ci,{className:"text-xs flex items-center gap-1",children:[_.jsx(SO,{className:"w-3 h-3"})," ",u==="vi"?"Gi (VN)":"Price (VND)"]}),_.jsx(ui,{type:"number",value:H.price,onChange:ie=>Z(pe=>({...pe,price:parseInt(ie.target.value)||0})),className:"h-9"})]}),_.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[_.jsx(hS,{checked:H.is_available,onCheckedChange:ie=>Z(pe=>({...pe,is_available:ie}))}),_.jsx(ci,{className:"text-xs",children:u==="vi"?"Cn hng":"Available"})]})]}),_.jsxs("div",{className:"flex gap-2 pt-2",children:[_.jsx(pn,{type:"button",variant:"ghost",onClick:r,size:"sm",className:"flex-1",children:u==="vi"?"Hy":"Cancel"}),_.jsx(pn,{type:"submit",disabled:k,size:"sm",className:"flex-1",children:k?"...":e?u==="vi"?"Cp nht":"Update":u==="vi"?"Thm":"Add"})]})]})]})},QK=({storeId:t,voucher:e,onClose:r,onSuccess:l})=>{const{language:u}=ia(),{createVoucher:m,updateVoucher:v}=dS(),[b,a]=P.useState(!1),[k,M]=P.useState({code:e?.code||"",title_vi:e?.title_vi||"",title_en:e?.title_en||"",description_vi:e?.description_vi||"",description_en:e?.description_en||"",discount_type:e?.discount_type||"percent",discount_value:e?.discount_value||10,min_order:e?.min_order||0,max_uses:e?.max_uses||null,is_active:e?.is_active??!0,start_date:e?.start_date?new Date(e.start_date).toISOString().split("T")[0]:"",end_date:e?.end_date?new Date(e.end_date).toISOString().split("T")[0]:""}),L=async z=>{z.preventDefault(),a(!0);try{const O={store_id:t,code:k.code.toUpperCase(),title_vi:k.title_vi,title_en:k.title_en||null,description_vi:k.description_vi||null,description_en:k.description_en||null,discount_type:k.discount_type,discount_value:k.discount_value,min_order:k.min_order||null,max_uses:k.max_uses||null,is_active:k.is_active,start_date:k.start_date?new Date(k.start_date).toISOString():null,end_date:k.end_date?new Date(k.end_date).toISOString():null};e?await v(e.id,O):await m(O),l(),r()}catch(O){console.error("Error saving voucher:",O)}finally{a(!1)}};return _.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"bg-muted/50 rounded-xl p-4 mb-4",children:[_.jsxs("div",{className:"flex items-center justify-between mb-4",children:[_.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[_.jsx(kM,{className:"w-4 h-4 text-accent"}),e?u==="vi"?"Chnh sa voucher":"Edit Voucher":u==="vi"?"To voucher mi":"Create New Voucher"]}),_.jsx("button",{onClick:r,className:"p-1 hover:bg-muted rounded-full",children:_.jsx(di,{className:"w-4 h-4"})})]}),_.jsxs("form",{onSubmit:L,className:"space-y-3",children:[_.jsxs("div",{children:[_.jsxs(ci,{className:"text-xs",children:[u==="vi"?"M voucher":"Voucher Code"," *"]}),_.jsx(ui,{value:k.code,onChange:z=>M(O=>({...O,code:z.target.value.toUpperCase()})),placeholder:"GIAM20",required:!0,className:"h-9 uppercase"})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Tiu  (VI) *"}),_.jsx(ui,{value:k.title_vi,onChange:z=>M(O=>({...O,title_vi:z.target.value})),placeholder:"Gim 20%",required:!0,className:"h-9"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Title (EN)"}),_.jsx(ui,{value:k.title_en,onChange:z=>M(O=>({...O,title_en:z.target.value})),placeholder:"20% off",className:"h-9"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"M t (VI)"}),_.jsx(yh,{value:k.description_vi,onChange:z=>M(O=>({...O,description_vi:z.target.value})),placeholder:"p dng cho n t 50k",rows:2,className:"text-sm"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:"Description (EN)"}),_.jsx(yh,{value:k.description_en,onChange:z=>M(O=>({...O,description_en:z.target.value})),placeholder:"Valid for orders over 50k",rows:2,className:"text-sm"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:u==="vi"?"Loi gim gi":"Discount Type"}),_.jsxs(E4,{value:k.discount_type,onValueChange:z=>M(O=>({...O,discount_type:z})),children:[_.jsx(aS,{className:"h-9",children:_.jsx(C4,{})}),_.jsxs(lS,{children:[_.jsx(Qa,{value:"percent",children:_.jsxs("span",{className:"flex items-center gap-1",children:[_.jsx(DO,{className:"w-3 h-3"})," ",u==="vi"?"Phn trm":"Percentage"]})}),_.jsx(Qa,{value:"fixed",children:u==="vi"?"C nh (VN)":"Fixed (VND)"})]})]})]}),_.jsxs("div",{children:[_.jsxs(ci,{className:"text-xs",children:[u==="vi"?"Gi tr":"Value"," ",k.discount_type==="percent"?"(%)":"(VN)"]}),_.jsx(ui,{type:"number",value:k.discount_value,onChange:z=>M(O=>({...O,discount_value:parseInt(z.target.value)||0})),className:"h-9"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:u==="vi"?"n ti thiu (VN)":"Min Order (VND)"}),_.jsx(ui,{type:"number",value:k.min_order,onChange:z=>M(O=>({...O,min_order:parseInt(z.target.value)||0})),className:"h-9"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:u==="vi"?"S ln s dng ti a":"Max Uses"}),_.jsx(ui,{type:"number",value:k.max_uses||"",onChange:z=>M(O=>({...O,max_uses:z.target.value?parseInt(z.target.value):null})),placeholder:u==="vi"?"Khng gii hn":"Unlimited",className:"h-9"})]})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:u==="vi"?"Ngy bt u":"Start Date"}),_.jsx(ui,{type:"date",value:k.start_date,onChange:z=>M(O=>({...O,start_date:z.target.value})),className:"h-9"})]}),_.jsxs("div",{children:[_.jsx(ci,{className:"text-xs",children:u==="vi"?"Ngy kt thc":"End Date"}),_.jsx(ui,{type:"date",value:k.end_date,onChange:z=>M(O=>({...O,end_date:z.target.value})),className:"h-9"})]})]}),_.jsxs("div",{className:"flex items-center gap-2",children:[_.jsx(hS,{checked:k.is_active,onCheckedChange:z=>M(O=>({...O,is_active:z}))}),_.jsx(ci,{className:"text-sm",children:u==="vi"?"Kch hot voucher":"Activate voucher"})]}),_.jsxs("div",{className:"flex gap-2 pt-2",children:[_.jsx(pn,{type:"button",variant:"ghost",onClick:r,size:"sm",className:"flex-1",children:u==="vi"?"Hy":"Cancel"}),_.jsx(pn,{type:"submit",disabled:b,size:"sm",className:"flex-1",children:b?"...":e?u==="vi"?"Cp nht":"Update":u==="vi"?"To":"Create"})]})]})]})},pm="https://thodia-backend-1067502227654.asia-southeast1.run.app",eY={pending:"bg-yellow-500/20 text-yellow-600",approved:"bg-green-500/20 text-green-600",rejected:"bg-red-500/20 text-red-600"},tY={pending:{vi:"Ch duyt",en:"Pending"},approved:{vi:" duyt",en:"Approved"},rejected:{vi:"T chi",en:"Rejected"}},nY=({isOpen:t,onClose:e,onLoginClick:r})=>{const{language:l}=ia(),{user:u}=_o(),{stores:m,isLoading:v,fetchStores:b}=dS(),[a,k]=P.useState(!1),[M,L]=P.useState(null),[z,O]=P.useState(null),[K,H]=P.useState("menu"),[Z,Y]=P.useState([]),[ee,ie]=P.useState([]),[pe,xe]=P.useState(!1),[Ce,je]=P.useState(!1),[Ue,et]=P.useState(null),[Ie,ot]=P.useState(null),[ut,gt]=P.useState(!1);P.useEffect(()=>{z&&ft(z)},[z]);const ft=async fe=>{try{const[Fe,lt]=await Promise.all([fetch(`${pm}/api/stores/${fe}/menu`),fetch(`${pm}/api/stores/${fe}/vouchers-all`)]),Tt=await Fe.json(),Kt=await lt.json();Y(Array.isArray(Tt)?Tt:[]),ie(Array.isArray(Kt)?Kt:[])}catch(Fe){console.error(Fe)}},vt=async()=>{try{await b()}catch(fe){console.error(fe)}k(!1),L(null)},st=async fe=>{if(confirm(l==="vi"?"Bn c chc mun xa ca hng ny?":"Are you sure?"))try{await fetch(`${pm}/api/stores/${fe}`,{method:"DELETE"}),b()}catch{alert("Li khi xa ca hng")}},nt=async fe=>{if(confirm(l==="vi"?"Xa mn ny?":"Delete this item?"))try{await fetch(`${pm}/api/menu-items/${fe}`,{method:"DELETE"}),z&&ft(z)}catch{alert("Li xa mn")}},ze=async fe=>{if(confirm(l==="vi"?"Xa voucher ny?":"Delete this voucher?"))try{await fetch(`${pm}/api/vouchers/${fe}`,{method:"DELETE"}),z&&ft(z)}catch{alert("Li xa voucher")}},Se=async fe=>{gt(!0);try{const Fe=await fetch(`${pm}/api/payment/create-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:fe,type:"vip",categoryId:1,returnUrl:window.location.href,cancelUrl:window.location.href})}),lt=await Fe.json();if(!Fe.ok)throw new Error(lt.error);if(lt&&lt.checkoutUrl)window.location.href=lt.checkoutUrl;else throw new Error("Khng ly c link thanh ton")}catch(Fe){alert("Li: "+Fe.message)}finally{gt(!1)}},We=fe=>new Intl.NumberFormat("vi-VN").format(fe)+"";return t?_.jsxs(_.Fragment,{children:[_.jsx(yr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-transparent pointer-events-none",onClick:e}),_.jsxs(yr.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed right-0 top-0 bottom-0 w-full max-w-md bg-background z-50 shadow-2xl flex flex-col bg-white",children:[_.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[_.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[_.jsx(Vc,{className:"w-5 h-5 text-primary"}),l==="vi"?"Ca hng ca ti":"My Stores"]}),_.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:_.jsx(di,{className:"w-5 h-5"})})]}),_.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50/50",children:u?v?_.jsx("div",{className:"text-center py-12",children:_.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"})}):m.length===0?_.jsxs("div",{className:"text-center py-12",children:[_.jsx(Vc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),_.jsx("p",{className:"text-muted-foreground mb-4",children:l==="vi"?"Bn cha c ca hng no":"You don't have any stores yet"}),_.jsxs(pn,{onClick:()=>k(!0),children:[_.jsx(xm,{className:"w-4 h-4 mr-2"}),l==="vi"?"Thm ca hng":"Add Store"]})]}):_.jsxs("div",{className:"space-y-4",children:[m.map(fe=>{const Fe=fe.is_premium===!0;return _.jsxs("div",{className:"border bg-white rounded-xl overflow-hidden shadow-sm relative",children:[Fe&&_.jsxs("div",{className:"absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-[10px] font-bold px-2 py-0.5 rounded-bl-lg z-10 flex items-center gap-1",children:[_.jsx(nl,{className:"w-3 h-3 fill-yellow-900"})," VIP"]}),_.jsxs("div",{className:"p-4",children:[_.jsxs("div",{className:"flex gap-3",children:[_.jsx("div",{className:"w-16 h-16 flex-shrink-0",children:fe.image_url?_.jsx("img",{src:fe.image_url,alt:fe.name_vi,className:"w-full h-full rounded-lg object-cover border",onError:lt=>{lt.currentTarget.src="https://placehold.co/100x100?text=No+Img"}}):_.jsx("div",{className:"w-full h-full rounded-lg bg-gray-100 flex items-center justify-center border",children:_.jsx(Vc,{className:"w-6 h-6 text-gray-400"})})}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("div",{className:"flex items-start justify-between gap-2",children:_.jsx("h3",{className:"font-semibold truncate text-gray-900 pr-8",children:l==="en"&&fe.name_en?fe.name_en:fe.name_vi})}),_.jsx("div",{className:"flex items-center gap-2 mt-1",children:_.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${eY[fe.status]}`,children:tY[fe.status]?.[l]||fe.status})}),_.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[_.jsx(Ai,{className:"w-3 h-3 flex-shrink-0"}),_.jsx("span",{className:"truncate",children:l==="en"&&fe.address_en?fe.address_en:fe.address_vi})]})]})]}),_.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-3 border-t",children:[_.jsxs(pn,{variant:"outline",size:"sm",onClick:()=>{L(fe),k(!0)},className:"flex-1 h-8 text-xs",children:[_.jsx(y1,{className:"w-3 h-3 mr-1"}),l==="vi"?"Sa":"Edit"]}),_.jsx(pn,{variant:"outline",size:"sm",onClick:()=>st(fe.id),className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-50 border-red-200",children:_.jsx(lh,{className:"w-3 h-3"})}),_.jsx(pn,{variant:"ghost",size:"sm",onClick:()=>O(z===fe.id?null:fe.id),className:"h-8 w-8 p-0",children:z===fe.id?_.jsx(Dm,{className:"w-4 h-4"}):_.jsx(qf,{className:"w-4 h-4"})})]})]}),_.jsx(Sa,{children:z===fe.id&&_.jsxs(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t bg-gray-50",children:[_.jsxs("div",{className:"flex border-b bg-white",children:[_.jsxs("button",{onClick:()=>H("menu"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${K==="menu"?"border-b-2 border-primary text-primary":"text-gray-500 hover:text-gray-800"}`,children:[_.jsx(FO,{className:"w-4 h-4"}),"Menu (",Z.length,")"]}),_.jsxs("button",{onClick:()=>H("voucher"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${K==="voucher"?"border-b-2 border-primary text-primary":"text-gray-500 hover:text-gray-800"}`,children:[_.jsx(kM,{className:"w-4 h-4"}),"Voucher (",ee.length,")"]})]}),_.jsx("div",{className:"p-4",children:K==="menu"?_.jsxs(_.Fragment,{children:[_.jsx(Sa,{children:pe&&_.jsx(JK,{storeId:fe.id,item:Ue,onClose:()=>{xe(!1),et(null)},onSuccess:()=>ft(fe.id)})}),!pe&&(Fe?_.jsxs(pn,{variant:"outline",size:"sm",onClick:()=>xe(!0),className:"w-full mb-3 bg-white border-dashed border-2 hover:border-primary hover:text-primary",children:[_.jsx(xm,{className:"w-4 h-4 mr-1"}),l==="vi"?"Thm mn mi":"Add Item"]}):_.jsxs("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[_.jsx(Ay,{className:"w-5 h-5 mx-auto text-yellow-600 mb-1"}),_.jsx("p",{className:"text-xs font-medium text-yellow-800 mb-2",children:"Tnh nng Menu ch dnh cho VIP"}),_.jsxs(pn,{size:"sm",onClick:()=>Se(fe.id),disabled:ut,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full",children:[ut?_.jsx(ki,{className:"w-3 h-3 animate-spin"}):_.jsx(nl,{className:"w-3 h-3 mr-1"}),"Nng cp ngay (5.000)"]})]})),_.jsx("div",{className:"space-y-2",children:Z.map(lt=>_.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white rounded-lg border shadow-sm",children:[_.jsx("img",{src:lt.image_url||"https://placehold.co/100x100?text=Food",alt:lt.name_vi,className:"w-12 h-12 rounded-lg object-cover bg-gray-100",onError:Tt=>{Tt.currentTarget.src="https://placehold.co/100x100?text=Food"}}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("p",{className:"font-medium text-sm truncate text-gray-900",children:l==="en"&&lt.name_en?lt.name_en:lt.name_vi}),_.jsx("p",{className:"text-xs text-primary font-bold",children:We(lt.price)})]}),_.jsxs("div",{className:"flex gap-1",children:[_.jsx("button",{onClick:()=>{et(lt),xe(!0)},className:"p-1.5 hover:bg-gray-100 rounded text-gray-600",children:_.jsx(y1,{className:"w-3 h-3"})}),_.jsx("button",{onClick:()=>nt(lt.id),className:"p-1.5 hover:bg-red-50 rounded text-red-500",children:_.jsx(lh,{className:"w-3 h-3"})})]})]},lt.id))})]}):_.jsxs(_.Fragment,{children:[_.jsx(Sa,{children:Ce&&_.jsx(QK,{storeId:fe.id,voucher:Ie,onClose:()=>{je(!1),ot(null)},onSuccess:()=>ft(fe.id)})}),!Ce&&(Fe?_.jsxs(pn,{variant:"outline",size:"sm",onClick:()=>je(!0),className:"w-full mb-3 bg-white border-dashed border-2 hover:border-primary hover:text-primary",children:[_.jsx(xm,{className:"w-4 h-4 mr-1"}),l==="vi"?"To voucher mi":"Create Voucher"]}):_.jsxs("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[_.jsx(Ay,{className:"w-5 h-5 mx-auto text-yellow-600 mb-1"}),_.jsx("p",{className:"text-xs font-medium text-yellow-800 mb-2",children:"Tnh nng Voucher ch dnh cho VIP"}),_.jsxs(pn,{size:"sm",onClick:()=>Se(fe.id),disabled:ut,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full",children:[ut?_.jsx(ki,{className:"w-3 h-3 animate-spin"}):_.jsx(nl,{className:"w-3 h-3 mr-1"}),"Nng cp ngay (5.000)"]})]})),_.jsx("div",{className:"space-y-2",children:ee.map(lt=>_.jsx("div",{className:"p-3 bg-white rounded-lg border border-dashed border-primary/30",children:_.jsxs("div",{className:"flex items-start justify-between gap-2",children:[_.jsxs("div",{children:[_.jsx("div",{className:"flex items-center gap-2",children:_.jsx("span",{className:"font-mono text-xs font-bold bg-primary/10 text-primary px-2 py-0.5 rounded",children:lt.code})}),_.jsx("p",{className:"text-sm font-medium mt-1 text-gray-900",children:l==="en"&&lt.title_en?lt.title_en:lt.title_vi}),_.jsxs("p",{className:"text-xs text-gray-500",children:["Gim: ",lt.discount_type==="percent"?`${lt.discount_value}%`:We(lt.discount_value)]})]}),_.jsxs("div",{className:"flex gap-1",children:[_.jsx("button",{onClick:()=>{ot(lt),je(!0)},className:"p-1.5 hover:bg-gray-100 rounded text-gray-600",children:_.jsx(y1,{className:"w-3 h-3"})}),_.jsx("button",{onClick:()=>ze(lt.id),className:"p-1.5 hover:bg-red-50 rounded text-red-500",children:_.jsx(lh,{className:"w-3 h-3"})})]})]})},lt.id))})]})})]})})]},fe.id)}),_.jsxs(pn,{onClick:()=>k(!0),className:"w-full shadow-lg",children:[_.jsx(xm,{className:"w-4 h-4 mr-2"}),l==="vi"?"Thm ca hng mi":"Add New Store"]})]}):_.jsxs("div",{className:"text-center py-12",children:[_.jsx(Vc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),_.jsx("p",{className:"text-muted-foreground mb-4",children:l==="vi"?"ng nhp  qun l ca hng":"Login to manage your stores"}),_.jsx(pn,{onClick:r,children:l==="vi"?"ng nhp":"Login"})]})})]}),_.jsx(cS,{isOpen:a,onClose:()=>{k(!1),L(null)},initialData:M,onSubmit:vt,isSubmitting:v,onUpgradeClick:()=>{M?Se(M.id):alert("Vui lng lu ca hng trc khi nng cp!")}})]}):null};function rY(t){const e=iY(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(oY);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return _.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return _.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function iY(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=lY(u),b=aY(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var sY=Symbol("radix.slottable");function oY(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===sY}function aY(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function lY(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var vb=["Enter"," "],cY=["ArrowDown","PageUp","Home"],F4=["ArrowUp","PageDown","End"],uY=[...cY,...F4],dY={ltr:[...vb,"ArrowRight"],rtl:[...vb,"ArrowLeft"]},hY={ltr:["ArrowLeft"],rtl:["ArrowRight"]},x_="Menu",[Zy,fY,pY]=Cv(x_),[cp,V4]=sl(x_,[pY,Ym,d0]),_0=Ym(),U4=d0(),[mY,up]=cp(x_),[gY,v_]=cp(x_),$4=t=>{const{__scopeMenu:e,open:r=!1,children:l,dir:u,onOpenChange:m,modal:v=!0}=t,b=_0(e),[a,k]=P.useState(null),M=P.useRef(!1),L=Ui(m),z=p_(u);return P.useEffect(()=>{const O=()=>{M.current=!0,document.addEventListener("pointerdown",K,{capture:!0,once:!0}),document.addEventListener("pointermove",K,{capture:!0,once:!0})},K=()=>M.current=!1;return document.addEventListener("keydown",O,{capture:!0}),()=>{document.removeEventListener("keydown",O,{capture:!0}),document.removeEventListener("pointerdown",K,{capture:!0}),document.removeEventListener("pointermove",K,{capture:!0})}},[]),_.jsx(lP,{...b,children:_.jsx(mY,{scope:e,open:r,onOpenChange:L,content:a,onContentChange:k,children:_.jsx(gY,{scope:e,onClose:P.useCallback(()=>L(!1),[L]),isUsingKeyboardRef:M,dir:z,modal:v,children:l})})})};$4.displayName=x_;var yY="MenuAnchor",fS=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t,u=_0(r);return _.jsx($b,{...u,...l,ref:e})});fS.displayName=yY;var pS="MenuPortal",[_Y,G4]=cp(pS,{forceMount:void 0}),H4=t=>{const{__scopeMenu:e,forceMount:r,children:l,container:u}=t,m=up(pS,e);return _.jsx(_Y,{scope:e,forceMount:r,children:_.jsx(zo,{present:r||m.open,children:_.jsx(Yy,{asChild:!0,container:u,children:l})})})};H4.displayName=pS;var il="MenuContent",[xY,mS]=cp(il),W4=P.forwardRef((t,e)=>{const r=G4(il,t.__scopeMenu),{forceMount:l=r.forceMount,...u}=t,m=up(il,t.__scopeMenu),v=v_(il,t.__scopeMenu);return _.jsx(Zy.Provider,{scope:t.__scopeMenu,children:_.jsx(zo,{present:l||m.open,children:_.jsx(Zy.Slot,{scope:t.__scopeMenu,children:v.modal?_.jsx(vY,{...u,ref:e}):_.jsx(wY,{...u,ref:e})})})})}),vY=P.forwardRef((t,e)=>{const r=up(il,t.__scopeMenu),l=P.useRef(null),u=or(e,l);return P.useEffect(()=>{const m=l.current;if(m)return XT(m)},[]),_.jsx(gS,{...t,ref:u,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Xt(t.onFocusOutside,m=>m.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),wY=P.forwardRef((t,e)=>{const r=up(il,t.__scopeMenu);return _.jsx(gS,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),bY=rY("MenuContent.ScrollLock"),gS=P.forwardRef((t,e)=>{const{__scopeMenu:r,loop:l=!1,trapFocus:u,onOpenAutoFocus:m,onCloseAutoFocus:v,disableOutsidePointerEvents:b,onEntryFocus:a,onEscapeKeyDown:k,onPointerDownOutside:M,onFocusOutside:L,onInteractOutside:z,onDismiss:O,disableOutsideScroll:K,...H}=t,Z=up(il,r),Y=v_(il,r),ee=_0(r),ie=U4(r),pe=fY(r),[xe,Ce]=P.useState(null),je=P.useRef(null),Ue=or(e,je,Z.onContentChange),et=P.useRef(0),Ie=P.useRef(""),ot=P.useRef(0),ut=P.useRef(null),gt=P.useRef("right"),ft=P.useRef(0),vt=K?i0:P.Fragment,st=K?{as:bY,allowPinchZoom:!0}:void 0,nt=Se=>{const We=Ie.current+Se,fe=pe().filter(xt=>!xt.disabled),Fe=document.activeElement,lt=fe.find(xt=>xt.ref.current===Fe)?.textValue,Tt=fe.map(xt=>xt.textValue),Kt=DY(Tt,We,lt),sn=fe.find(xt=>xt.textValue===Kt)?.ref.current;(function xt(Zt){Ie.current=Zt,window.clearTimeout(et.current),Zt!==""&&(et.current=window.setTimeout(()=>xt(""),1e3))})(We),sn&&setTimeout(()=>sn.focus())};P.useEffect(()=>()=>window.clearTimeout(et.current),[]),ZT();const ze=P.useCallback(Se=>gt.current===ut.current?.side&&jY(Se,ut.current?.area),[]);return _.jsx(xY,{scope:r,searchRef:Ie,onItemEnter:P.useCallback(Se=>{ze(Se)&&Se.preventDefault()},[ze]),onItemLeave:P.useCallback(Se=>{ze(Se)||(je.current?.focus(),Ce(null))},[ze]),onTriggerLeave:P.useCallback(Se=>{ze(Se)&&Se.preventDefault()},[ze]),pointerGraceTimerRef:ot,onPointerGraceIntentChange:P.useCallback(Se=>{ut.current=Se},[]),children:_.jsx(vt,{...st,children:_.jsx(n0,{asChild:!0,trapped:u,onMountAutoFocus:Xt(m,Se=>{Se.preventDefault(),je.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:v,children:_.jsx(Wm,{asChild:!0,disableOutsidePointerEvents:b,onEscapeKeyDown:k,onPointerDownOutside:M,onFocusOutside:L,onInteractOutside:z,onDismiss:O,children:_.jsx(mD,{asChild:!0,...ie,dir:Y.dir,orientation:"vertical",loop:l,currentTabStopId:xe,onCurrentTabStopIdChange:Ce,onEntryFocus:Xt(a,Se=>{Y.isUsingKeyboardRef.current||Se.preventDefault()}),preventScrollOnEntryFocus:!0,children:_.jsx(Gb,{role:"menu","aria-orientation":"vertical","data-state":lL(Z.open),"data-radix-menu-content":"",dir:Y.dir,...ee,...H,ref:Ue,style:{outline:"none",...H.style},onKeyDown:Xt(H.onKeyDown,Se=>{const fe=Se.target.closest("[data-radix-menu-content]")===Se.currentTarget,Fe=Se.ctrlKey||Se.altKey||Se.metaKey,lt=Se.key.length===1;fe&&(Se.key==="Tab"&&Se.preventDefault(),!Fe&&lt&&nt(Se.key));const Tt=je.current;if(Se.target!==Tt||!uY.includes(Se.key))return;Se.preventDefault();const sn=pe().filter(xt=>!xt.disabled).map(xt=>xt.ref.current);F4.includes(Se.key)&&sn.reverse(),NY(sn)}),onBlur:Xt(t.onBlur,Se=>{Se.currentTarget.contains(Se.target)||(window.clearTimeout(et.current),Ie.current="")}),onPointerMove:Xt(t.onPointerMove,Xy(Se=>{const We=Se.target,fe=ft.current!==Se.clientX;if(Se.currentTarget.contains(We)&&fe){const Fe=Se.clientX>ft.current?"right":"left";gt.current=Fe,ft.current=Se.clientX}}))})})})})})})});W4.displayName=il;var TY="MenuGroup",yS=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return _.jsx(Mn.div,{role:"group",...l,ref:e})});yS.displayName=TY;var SY="MenuLabel",q4=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return _.jsx(Mn.div,{...l,ref:e})});q4.displayName=SY;var bv="MenuItem",VI="menu.itemSelect",x0=P.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:l,...u}=t,m=P.useRef(null),v=v_(bv,t.__scopeMenu),b=mS(bv,t.__scopeMenu),a=or(e,m),k=P.useRef(!1),M=()=>{const L=m.current;if(!r&&L){const z=new CustomEvent(VI,{bubbles:!0,cancelable:!0});L.addEventListener(VI,O=>l?.(O),{once:!0}),bb(L,z),z.defaultPrevented?k.current=!1:v.onClose()}};return _.jsx(Z4,{...u,ref:a,disabled:r,onClick:Xt(t.onClick,M),onPointerDown:L=>{t.onPointerDown?.(L),k.current=!0},onPointerUp:Xt(t.onPointerUp,L=>{k.current||L.currentTarget?.click()}),onKeyDown:Xt(t.onKeyDown,L=>{const z=b.searchRef.current!=="";r||z&&L.key===" "||vb.includes(L.key)&&(L.currentTarget.click(),L.preventDefault())})})});x0.displayName=bv;var Z4=P.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:l=!1,textValue:u,...m}=t,v=mS(bv,r),b=U4(r),a=P.useRef(null),k=or(e,a),[M,L]=P.useState(!1),[z,O]=P.useState("");return P.useEffect(()=>{const K=a.current;K&&O((K.textContent??"").trim())},[m.children]),_.jsx(Zy.ItemSlot,{scope:r,disabled:l,textValue:u??z,children:_.jsx(gD,{asChild:!0,...b,focusable:!l,children:_.jsx(Mn.div,{role:"menuitem","data-highlighted":M?"":void 0,"aria-disabled":l||void 0,"data-disabled":l?"":void 0,...m,ref:k,onPointerMove:Xt(t.onPointerMove,Xy(K=>{l?v.onItemLeave(K):(v.onItemEnter(K),K.defaultPrevented||K.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Xt(t.onPointerLeave,Xy(K=>v.onItemLeave(K))),onFocus:Xt(t.onFocus,()=>L(!0)),onBlur:Xt(t.onBlur,()=>L(!1))})})})}),EY="MenuCheckboxItem",X4=P.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:l,...u}=t;return _.jsx(eL,{scope:t.__scopeMenu,checked:r,children:_.jsx(x0,{role:"menuitemcheckbox","aria-checked":Tv(r)?"mixed":r,...u,ref:e,"data-state":xS(r),onSelect:Xt(u.onSelect,()=>l?.(Tv(r)?!0:!r),{checkForDefaultPrevented:!1})})})});X4.displayName=EY;var K4="MenuRadioGroup",[CY,kY]=cp(K4,{value:void 0,onValueChange:()=>{}}),Y4=P.forwardRef((t,e)=>{const{value:r,onValueChange:l,...u}=t,m=Ui(l);return _.jsx(CY,{scope:t.__scopeMenu,value:r,onValueChange:m,children:_.jsx(yS,{...u,ref:e})})});Y4.displayName=K4;var J4="MenuRadioItem",Q4=P.forwardRef((t,e)=>{const{value:r,...l}=t,u=kY(J4,t.__scopeMenu),m=r===u.value;return _.jsx(eL,{scope:t.__scopeMenu,checked:m,children:_.jsx(x0,{role:"menuitemradio","aria-checked":m,...l,ref:e,"data-state":xS(m),onSelect:Xt(l.onSelect,()=>u.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});Q4.displayName=J4;var _S="MenuItemIndicator",[eL,AY]=cp(_S,{checked:!1}),tL=P.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:l,...u}=t,m=AY(_S,r);return _.jsx(zo,{present:l||Tv(m.checked)||m.checked===!0,children:_.jsx(Mn.span,{...u,ref:e,"data-state":xS(m.checked)})})});tL.displayName=_S;var IY="MenuSeparator",nL=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return _.jsx(Mn.div,{role:"separator","aria-orientation":"horizontal",...l,ref:e})});nL.displayName=IY;var MY="MenuArrow",rL=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t,u=_0(r);return _.jsx(Hb,{...u,...l,ref:e})});rL.displayName=MY;var PY="MenuSub",[nQ,iL]=cp(PY),fy="MenuSubTrigger",sL=P.forwardRef((t,e)=>{const r=up(fy,t.__scopeMenu),l=v_(fy,t.__scopeMenu),u=iL(fy,t.__scopeMenu),m=mS(fy,t.__scopeMenu),v=P.useRef(null),{pointerGraceTimerRef:b,onPointerGraceIntentChange:a}=m,k={__scopeMenu:t.__scopeMenu},M=P.useCallback(()=>{v.current&&window.clearTimeout(v.current),v.current=null},[]);return P.useEffect(()=>M,[M]),P.useEffect(()=>{const L=b.current;return()=>{window.clearTimeout(L),a(null)}},[b,a]),_.jsx(fS,{asChild:!0,...k,children:_.jsx(Z4,{id:u.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":u.contentId,"data-state":lL(r.open),...t,ref:ed(e,u.onTriggerChange),onClick:L=>{t.onClick?.(L),!(t.disabled||L.defaultPrevented)&&(L.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Xt(t.onPointerMove,Xy(L=>{m.onItemEnter(L),!L.defaultPrevented&&!t.disabled&&!r.open&&!v.current&&(m.onPointerGraceIntentChange(null),v.current=window.setTimeout(()=>{r.onOpenChange(!0),M()},100))})),onPointerLeave:Xt(t.onPointerLeave,Xy(L=>{M();const z=r.content?.getBoundingClientRect();if(z){const O=r.content?.dataset.side,K=O==="right",H=K?-5:5,Z=z[K?"left":"right"],Y=z[K?"right":"left"];m.onPointerGraceIntentChange({area:[{x:L.clientX+H,y:L.clientY},{x:Z,y:z.top},{x:Y,y:z.top},{x:Y,y:z.bottom},{x:Z,y:z.bottom}],side:O}),window.clearTimeout(b.current),b.current=window.setTimeout(()=>m.onPointerGraceIntentChange(null),300)}else{if(m.onTriggerLeave(L),L.defaultPrevented)return;m.onPointerGraceIntentChange(null)}})),onKeyDown:Xt(t.onKeyDown,L=>{const z=m.searchRef.current!=="";t.disabled||z&&L.key===" "||dY[l.dir].includes(L.key)&&(r.onOpenChange(!0),r.content?.focus(),L.preventDefault())})})})});sL.displayName=fy;var oL="MenuSubContent",aL=P.forwardRef((t,e)=>{const r=G4(il,t.__scopeMenu),{forceMount:l=r.forceMount,...u}=t,m=up(il,t.__scopeMenu),v=v_(il,t.__scopeMenu),b=iL(oL,t.__scopeMenu),a=P.useRef(null),k=or(e,a);return _.jsx(Zy.Provider,{scope:t.__scopeMenu,children:_.jsx(zo,{present:l||m.open,children:_.jsx(Zy.Slot,{scope:t.__scopeMenu,children:_.jsx(gS,{id:b.contentId,"aria-labelledby":b.triggerId,...u,ref:k,align:"start",side:v.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:M=>{v.isUsingKeyboardRef.current&&a.current?.focus(),M.preventDefault()},onCloseAutoFocus:M=>M.preventDefault(),onFocusOutside:Xt(t.onFocusOutside,M=>{M.target!==b.trigger&&m.onOpenChange(!1)}),onEscapeKeyDown:Xt(t.onEscapeKeyDown,M=>{v.onClose(),M.preventDefault()}),onKeyDown:Xt(t.onKeyDown,M=>{const L=M.currentTarget.contains(M.target),z=hY[v.dir].includes(M.key);L&&z&&(m.onOpenChange(!1),b.trigger?.focus(),M.preventDefault())})})})})})});aL.displayName=oL;function lL(t){return t?"open":"closed"}function Tv(t){return t==="indeterminate"}function xS(t){return Tv(t)?"indeterminate":t?"checked":"unchecked"}function NY(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function RY(t,e){return t.map((r,l)=>t[(e+l)%t.length])}function DY(t,e,r){const u=e.length>1&&Array.from(e).every(k=>k===e[0])?e[0]:e,m=r?t.indexOf(r):-1;let v=RY(t,Math.max(m,0));u.length===1&&(v=v.filter(k=>k!==r));const a=v.find(k=>k.toLowerCase().startsWith(u.toLowerCase()));return a!==r?a:void 0}function LY(t,e){const{x:r,y:l}=t;let u=!1;for(let m=0,v=e.length-1;m<e.length;v=m++){const b=e[m],a=e[v],k=b.x,M=b.y,L=a.x,z=a.y;M>l!=z>l&&r<(L-k)*(l-M)/(z-M)+k&&(u=!u)}return u}function jY(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return LY(r,e)}function Xy(t){return e=>e.pointerType==="mouse"?t(e):void 0}var OY=$4,zY=fS,BY=H4,FY=W4,VY=yS,UY=q4,$Y=x0,GY=X4,HY=Y4,WY=Q4,qY=tL,ZY=nL,XY=rL,KY=sL,YY=aL,v0="DropdownMenu",[JY]=sl(v0,[V4]),Bo=V4(),[QY,cL]=JY(v0),uL=t=>{const{__scopeDropdownMenu:e,children:r,dir:l,open:u,defaultOpen:m,onOpenChange:v,modal:b=!0}=t,a=Bo(e),k=P.useRef(null),[M,L]=fh({prop:u,defaultProp:m??!1,onChange:v,caller:v0});return _.jsx(QY,{scope:e,triggerId:$c(),triggerRef:k,contentId:$c(),open:M,onOpenChange:L,onOpenToggle:P.useCallback(()=>L(z=>!z),[L]),modal:b,children:_.jsx(OY,{...a,open:M,onOpenChange:L,dir:l,modal:b,children:r})})};uL.displayName=v0;var dL="DropdownMenuTrigger",hL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:l=!1,...u}=t,m=cL(dL,r),v=Bo(r);return _.jsx(zY,{asChild:!0,...v,children:_.jsx(Mn.button,{type:"button",id:m.triggerId,"aria-haspopup":"menu","aria-expanded":m.open,"aria-controls":m.open?m.contentId:void 0,"data-state":m.open?"open":"closed","data-disabled":l?"":void 0,disabled:l,...u,ref:ed(e,m.triggerRef),onPointerDown:Xt(t.onPointerDown,b=>{!l&&b.button===0&&b.ctrlKey===!1&&(m.onOpenToggle(),m.open||b.preventDefault())}),onKeyDown:Xt(t.onKeyDown,b=>{l||(["Enter"," "].includes(b.key)&&m.onOpenToggle(),b.key==="ArrowDown"&&m.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(b.key)&&b.preventDefault())})})})});hL.displayName=dL;var eJ="DropdownMenuPortal",fL=t=>{const{__scopeDropdownMenu:e,...r}=t,l=Bo(e);return _.jsx(BY,{...l,...r})};fL.displayName=eJ;var pL="DropdownMenuContent",mL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=cL(pL,r),m=Bo(r),v=P.useRef(!1);return _.jsx(FY,{id:u.contentId,"aria-labelledby":u.triggerId,...m,...l,ref:e,onCloseAutoFocus:Xt(t.onCloseAutoFocus,b=>{v.current||u.triggerRef.current?.focus(),v.current=!1,b.preventDefault()}),onInteractOutside:Xt(t.onInteractOutside,b=>{const a=b.detail.originalEvent,k=a.button===0&&a.ctrlKey===!0,M=a.button===2||k;(!u.modal||M)&&(v.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});mL.displayName=pL;var tJ="DropdownMenuGroup",nJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(VY,{...u,...l,ref:e})});nJ.displayName=tJ;var rJ="DropdownMenuLabel",gL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(UY,{...u,...l,ref:e})});gL.displayName=rJ;var iJ="DropdownMenuItem",yL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx($Y,{...u,...l,ref:e})});yL.displayName=iJ;var sJ="DropdownMenuCheckboxItem",_L=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(GY,{...u,...l,ref:e})});_L.displayName=sJ;var oJ="DropdownMenuRadioGroup",aJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(HY,{...u,...l,ref:e})});aJ.displayName=oJ;var lJ="DropdownMenuRadioItem",xL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(WY,{...u,...l,ref:e})});xL.displayName=lJ;var cJ="DropdownMenuItemIndicator",vL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(qY,{...u,...l,ref:e})});vL.displayName=cJ;var uJ="DropdownMenuSeparator",wL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(ZY,{...u,...l,ref:e})});wL.displayName=uJ;var dJ="DropdownMenuArrow",hJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(XY,{...u,...l,ref:e})});hJ.displayName=dJ;var fJ="DropdownMenuSubTrigger",bL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(KY,{...u,...l,ref:e})});bL.displayName=fJ;var pJ="DropdownMenuSubContent",TL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=Bo(r);return _.jsx(YY,{...u,...l,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});TL.displayName=pJ;var mJ=uL,gJ=hL,yJ=fL,SL=mL,EL=gL,CL=yL,kL=_L,AL=xL,IL=vL,ML=wL,PL=bL,NL=TL;const _J=mJ,xJ=gJ,vJ=P.forwardRef(({className:t,inset:e,children:r,...l},u)=>_.jsxs(PL,{ref:u,className:cn("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...l,children:[r,_.jsx(bM,{className:"ml-auto h-4 w-4"})]}));vJ.displayName=PL.displayName;const wJ=P.forwardRef(({className:t,...e},r)=>_.jsx(NL,{ref:r,className:cn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));wJ.displayName=NL.displayName;const RL=P.forwardRef(({className:t,sideOffset:e=4,...r},l)=>_.jsx(yJ,{children:_.jsx(SL,{ref:l,sideOffset:e,className:cn("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));RL.displayName=SL.displayName;const py=P.forwardRef(({className:t,inset:e,...r},l)=>_.jsx(CL,{ref:l,className:cn("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...r}));py.displayName=CL.displayName;const bJ=P.forwardRef(({className:t,children:e,checked:r,...l},u)=>_.jsxs(kL,{ref:u,className:cn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:r,...l,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(IL,{children:_.jsx(wh,{className:"h-4 w-4"})})}),e]}));bJ.displayName=kL.displayName;const TJ=P.forwardRef(({className:t,children:e,...r},l)=>_.jsxs(AL,{ref:l,className:cn("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[_.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:_.jsx(IL,{children:_.jsx(bO,{className:"h-2 w-2 fill-current"})})}),e]}));TJ.displayName=AL.displayName;const DL=P.forwardRef(({className:t,inset:e,...r},l)=>_.jsx(EL,{ref:l,className:cn("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...r}));DL.displayName=EL.displayName;const $x=P.forwardRef(({className:t,...e},r)=>_.jsx(ML,{ref:r,className:cn("-mx-1 my-1 h-px bg-muted",t),...e}));$x.displayName=ML.displayName;const UI="https://thodia-backend-1067502227654.asia-southeast1.run.app",SJ=({onLoginClick:t,onFavoritesClick:e,onStoresClick:r})=>{const{user:l,signOut:u}=_o(),{language:m}=ia(),v=sp(),[b,a]=P.useState(!1),[k,M]=P.useState([]),[L,z]=P.useState(!1),[O,K]=P.useState(null);P.useEffect(()=>{l&&(async()=>{try{const je=await(await fetch(`${UI}/api/user-stores?userId=${l.uid}`)).json();Array.isArray(je)&&M(je)}catch(Ce){console.error("Li ly danh sch ca hng:",Ce)}})()},[l]);const H=(xe,Ce)=>{if(!k||k.length===0){alert("Bn cha c ca hng no! Hy to ca hng trc.");return}k.length===1?Z(k[0].id,xe,Ce):(K({type:xe,packageType:Ce}),z(!0))},Z=async(xe,Ce,je)=>{a(!0),z(!1);try{const Ue=await fetch(`${UI}/api/payment/create-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:xe,userId:l?.uid,type:Ce,packageType:je,returnUrl:window.location.href,cancelUrl:window.location.href})}),et=await Ue.json();if(!Ue.ok)throw new Error(et.error||"Li to thanh ton");if(et&&et.checkoutUrl)window.location.href=et.checkoutUrl;else throw new Error("Khng ly c link thanh ton")}catch(Ue){console.error(Ue),alert("Li: "+(Ue.message||"C li xy ra"))}finally{a(!1)}},Y=async()=>{try{await u()}catch(xe){console.warn("Li ng xut:",xe)}finally{localStorage.clear(),window.location.reload()}};if(!l)return _.jsxs(_.Fragment,{children:[_.jsx(pn,{variant:"outline",size:"icon",onClick:t,className:"md:hidden w-10 h-10 rounded-full border-gray-200 bg-white shadow-sm active:scale-95 transition-all text-gray-700 hover:text-green-600 hover:border-green-600",children:_.jsx(wO,{className:"w-6 h-6"})}),_.jsxs(pn,{onClick:t,variant:"default",className:"hidden md:flex gap-2 shadow-lg rounded-xl font-semibold bg-white text-black hover:bg-gray-100 border border-gray-200",children:[_.jsx(Iy,{className:"w-4 h-4"}),m==="vi"?"ng nhp":"Login"]})]});const ee=l.email,ie=ee?ee[0].toUpperCase():"U",pe=l.photoURL;return _.jsxs(_.Fragment,{children:[_.jsxs(_J,{children:[_.jsx(xJ,{asChild:!0,children:_.jsx(pn,{variant:"secondary",className:"relative w-10 h-10 rounded-full p-0 overflow-hidden shadow-lg border-2 border-white cursor-pointer hover:ring-2 hover:ring-green-500 transition-all",children:_.jsxs(iS,{className:"h-full w-full",children:[_.jsx(BD,{src:pe||void 0}),_.jsx(sS,{className:"bg-green-600 text-white font-bold",children:ie})]})})}),_.jsxs(RL,{align:"end",className:"w-64 rounded-xl p-2 mt-2 bg-white shadow-xl border border-gray-100 z-[200]",children:[_.jsx(DL,{children:_.jsxs("div",{className:"flex flex-col space-y-1",children:[_.jsx("p",{className:"text-sm font-medium leading-none",children:m==="vi"?"Ti khon":"Account"}),_.jsx("p",{className:"text-xs leading-none text-muted-foreground truncate font-normal text-gray-500",children:ee})]})}),_.jsx($x,{className:"my-1 bg-gray-100"}),_.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 mb-2 border border-gray-100",children:[_.jsx("p",{className:"text-[10px] uppercase text-gray-500 font-bold mb-2 pl-1",children:m==="vi"?"Nng cp ca hng":"Upgrade Store"}),_.jsxs("button",{disabled:b,onClick:()=>H("vip"),className:"w-full flex items-center gap-2 text-xs font-semibold text-yellow-700 bg-yellow-100 hover:bg-yellow-200 p-2 rounded mb-2 transition-colors",children:[b?_.jsx(ki,{className:"w-3 h-3 animate-spin"}):_.jsx(nl,{className:"w-3 h-3 fill-yellow-600"}),"VIP"]}),_.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[_.jsxs("button",{disabled:b,onClick:()=>H("ad","week"),className:"flex flex-col items-center justify-center gap-1 text-[10px] font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 p-1.5 rounded transition-colors",children:[b?_.jsx(ki,{className:"w-3 h-3 animate-spin"}):_.jsx(Gx,{className:"w-3 h-3"}),"QC Tun"]}),_.jsxs("button",{disabled:b,onClick:()=>H("ad","month"),className:"flex flex-col items-center justify-center gap-1 text-[10px] font-medium text-indigo-700 bg-indigo-50 hover:bg-indigo-100 p-1.5 rounded transition-colors",children:[b?_.jsx(ki,{className:"w-3 h-3 animate-spin"}):_.jsx(Gx,{className:"w-3 h-3"}),"QC Thng"]})]})]}),ee==="admin@gmail.com"&&_.jsxs(_.Fragment,{children:[_.jsxs(py,{onClick:()=>v("/admin"),className:"cursor-pointer font-bold text-blue-600 bg-blue-50 focus:bg-blue-100 rounded-lg p-2 mb-1",children:[_.jsx(zO,{className:"mr-2 h-4 w-4"}),_.jsx("span",{children:"Admin Dashboard"})]}),_.jsx($x,{className:"my-1 bg-gray-100"})]}),_.jsxs(py,{onClick:e,className:"cursor-pointer rounded-lg hover:bg-gray-50 p-2",children:[_.jsx($f,{className:"mr-2 h-4 w-4 text-red-500"}),_.jsx("span",{children:m==="vi"?"a im yu thch":"Favorite Locations"})]}),_.jsxs(py,{onClick:r,className:"cursor-pointer rounded-lg hover:bg-gray-50 p-2",children:[_.jsx(Vc,{className:"mr-2 h-4 w-4 text-orange-500"}),_.jsx("span",{children:m==="vi"?"Ca hng ca ti":"My Stores"})]}),_.jsx($x,{className:"my-1 bg-gray-100"}),_.jsxs(py,{onClick:Y,className:"cursor-pointer text-red-600 focus:text-red-600 focus:bg-red-50 rounded-lg p-2",children:[_.jsx(fw,{className:"mr-2 h-4 w-4"}),_.jsx("span",{children:m==="vi"?"ng xut":"Log out"})]})]})]}),L&&_.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:_.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in duration-200",children:[_.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[_.jsx("h3",{className:"font-bold text-gray-800",children:"Chn ca hng  nng cp"}),_.jsx("button",{onClick:()=>z(!1),className:"p-1 hover:bg-gray-200 rounded-full",children:_.jsx(di,{className:"w-5 h-5 text-gray-500"})})]}),_.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-2",children:k.map(xe=>_.jsxs("button",{onClick:()=>O&&Z(xe.id,O.type,O.packageType),className:"w-full text-left p-3 rounded-xl border hover:border-blue-500 hover:bg-blue-50 transition-all group relative",children:[_.jsx("div",{className:"font-bold text-gray-900 group-hover:text-blue-700",children:xe.name_vi}),_.jsx("div",{className:"text-xs text-gray-500 truncate",children:xe.address_vi}),xe.is_premium&&O?.type==="vip"&&_.jsx("span",{className:"absolute top-3 right-3 text-[10px] bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full font-bold",children:" VIP"})]},xe.id))})]})})]})},EJ=({compact:t=!1})=>{const{language:e,setLanguage:r}=ia(),l=[{code:"vi",label:"VI",labelFull:"Ting Vit",flag:""},{code:"en",label:"EN",labelFull:"English",flag:""}];return t?_.jsx("div",{className:"flex items-center bg-card/90 backdrop-blur-sm rounded-full shadow-md border border-border overflow-hidden",children:l.map(({code:u,flag:m})=>_.jsxs(yr.button,{onClick:()=>r(u),className:cn("relative flex items-center justify-center w-8 h-8 text-sm transition-colors duration-200",e===u?"text-primary-foreground":"text-muted-foreground hover:text-foreground"),whileTap:{scale:.9},children:[e===u&&_.jsx(yr.div,{layoutId:"language-active-bg-compact",className:"absolute inset-0.5 bg-primary rounded-full",initial:!1,transition:{type:"spring",stiffness:400,damping:30}}),_.jsx(yr.span,{className:"relative z-10 text-base",animate:{scale:e===u?1.1:.9},children:m})]},u))}):_.jsx("div",{className:"flex items-center bg-card rounded-2xl shadow-lg border-2 border-border overflow-hidden",children:l.map(({code:u,label:m,labelFull:v,flag:b})=>_.jsxs(yr.button,{onClick:()=>r(u),className:cn("relative flex items-center gap-2 px-4 py-2.5 text-sm font-semibold transition-colors duration-200",e===u?"text-primary-foreground":"text-muted-foreground hover:text-foreground"),title:v,whileTap:{scale:.95},children:[e===u&&_.jsx(yr.div,{layoutId:"language-active-bg",className:"absolute inset-0 bg-primary",initial:!1,transition:{type:"spring",stiffness:400,damping:30}}),_.jsx(yr.span,{className:"relative z-10 text-lg",animate:{scale:e===u?1.1:1,rotate:e===u?[0,-10,10,0]:0},transition:{duration:.3},children:b}),_.jsx("span",{className:"relative z-10 font-bold",children:m})]},u))})},CJ="https://thodia-backend-1067502227654.asia-southeast1.run.app",kJ=({isOpen:t,onClose:e,data:r})=>{const{user:l}=_o(),[u,m]=P.useState(!1),[v,b]=P.useState({phone:"",email:"",role:"Ch s hu",message:""}),[a,k]=P.useState([]);if(P.useEffect(()=>{t&&(b({phone:"",role:"Ch s hu",message:"",email:l?.email||""}),k([]))},[t,l]),!t||!r)return null;const M=O=>{if(O.target.files){const K=Array.from(O.target.files);if(a.length+K.length>5){Gt.error("Ch c ti ln ti a 5 nh minh chng");return}k(H=>[...H,...K])}},L=O=>{k(K=>K.filter((H,Z)=>Z!==O))},z=async O=>{if(O.preventDefault(),a.length===0){Gt.error("Vui lng ti ln t nht 1 nh bng chng");return}if(!l){Gt.error("Vui lng ng nhp");return}m(!0);try{const K=new FormData;K.append("userId",l.uid),K.append("mapboxId",String(r.mapboxId)),K.append("mapboxName",r.name),K.append("mapboxAddress",r.address||""),K.append("lat",String(r.lat)),K.append("lng",String(r.lng)),K.append("phone",v.phone),K.append("email",v.email),K.append("role",v.role),K.append("message",v.message),a.forEach(Z=>{K.append("proofFiles",Z)});const H=await fetch(`${CJ}/api/claims/submit`,{method:"POST",body:K});if(!H.ok){const Z=await H.json();throw new Error(Z.error||"Gi tht bi")}Gt.success(" gi yu cu xc minh!",{description:"Admin s xem xt thng tin v phn hi sm nht."}),e()}catch(K){console.error(K),Gt.error("Li: "+K.message)}finally{m(!1)}};return _.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:_.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[_.jsxs("div",{className:"px-6 py-4 border-b bg-gray-50 flex justify-between items-center shrink-0",children:[_.jsxs("div",{children:[_.jsx("h3",{className:"font-bold text-lg text-gray-800",children:"Xc nhn ch s hu"}),_.jsxs("p",{className:"text-xs text-gray-500",children:["Gi thng tin xc minh cho: ",_.jsx("span",{className:"font-semibold text-blue-600",children:r.name})]})]}),_.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-200 rounded-full transition-colors",children:_.jsx(di,{size:20,className:"text-gray-500"})})]}),_.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[_.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Vai tr ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsxs("select",{className:"w-full mt-1 p-2.5 border border-gray-300 rounded-lg text-sm outline-none bg-white",value:v.role,onChange:O=>b({...v,role:O.target.value}),children:[_.jsx("option",{children:"Ch s hu"}),_.jsx("option",{children:"Qun l ca hng"}),_.jsx("option",{children:"Nhn vin i din"})]})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["S in thoi ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx("input",{type:"tel",required:!0,placeholder:"0912xxxxxx",className:"w-full mt-1 p-2.5 border border-gray-300 rounded-lg text-sm outline-none",value:v.phone,onChange:O=>b({...v,phone:O.target.value})})]})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-sm font-medium text-gray-700",children:["Email lin h ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx("input",{type:"email",required:!0,className:"w-full mt-1 p-2.5 border border-gray-300 rounded-lg text-sm outline-none",value:v.email,onChange:O=>b({...v,email:O.target.value})})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["nh bng chng (Giy php KD, Menu...) ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[a.map((O,K)=>_.jsxs("div",{className:"relative aspect-square rounded-lg overflow-hidden border border-gray-200 group",children:[_.jsx("img",{src:URL.createObjectURL(O),className:"w-full h-full object-cover",alt:"preview"}),_.jsx("button",{type:"button",onClick:()=>L(K),className:"absolute top-1 right-1 bg-red-500 text-white p-1 rounded-full opacity-0 group-hover:opacity-100",children:_.jsx(di,{size:12})})]},K)),a.length<5&&_.jsxs("label",{className:"border-2 border-dashed border-gray-300 rounded-lg flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 aspect-square",children:[_.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:M,className:"hidden"}),_.jsx(BO,{size:20,className:"text-gray-400 mb-1"}),_.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"Thm nh"})]})]})]}),_.jsxs("div",{children:[_.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Li nhn"}),_.jsx("textarea",{rows:3,className:"w-full mt-1 p-2.5 border border-gray-300 rounded-lg text-sm outline-none",placeholder:"Ghi ch thm...",value:v.message,onChange:O=>b({...v,message:O.target.value})})]})]}),_.jsxs("div",{className:"p-4 border-t bg-gray-50 flex gap-3 shrink-0",children:[_.jsx("button",{onClick:e,className:"flex-1 px-4 py-2.5 bg-white border border-gray-300 hover:bg-gray-100 text-gray-700 font-medium rounded-xl text-sm",children:"Hy b"}),_.jsx("button",{onClick:z,disabled:u,className:"flex-1 px-4 py-2.5 bg-blue-600 hover:bg-blue-700 text-white font-medium rounded-xl text-sm flex items-center justify-center gap-2",children:u?_.jsx(ki,{className:"animate-spin",size:18}):"Gi xc minh"})]})]})})},AJ=oD,IJ=_Z,MJ=aD,LL=P.forwardRef(({className:t,...e},r)=>_.jsx(o0,{className:cn("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:r}));LL.displayName=o0.displayName;const PJ=Qy("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),jL=P.forwardRef(({side:t="right",className:e,children:r,...l},u)=>_.jsxs(MJ,{children:[_.jsx(LL,{}),_.jsxs(a0,{ref:u,className:cn(PJ({side:t}),e),...l,children:[r,_.jsxs(lD,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[_.jsx(di,{className:"h-4 w-4"}),_.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));jL.displayName=a0.displayName;const OL=({className:t,...e})=>_.jsx("div",{className:cn("flex flex-col space-y-2 text-center sm:text-left",t),...e});OL.displayName="SheetHeader";const zL=P.forwardRef(({className:t,...e},r)=>_.jsx(l0,{ref:r,className:cn("text-lg font-semibold text-foreground",t),...e}));zL.displayName=l0.displayName;const NJ=P.forwardRef(({className:t,...e},r)=>_.jsx(c0,{ref:r,className:cn("text-sm text-muted-foreground",t),...e}));NJ.displayName=c0.displayName;const RJ=({children:t})=>{const e=sp(),r=[{icon:_.jsx(EM,{className:"w-5 h-5 text-blue-500"}),label:"Bn ",desc:"Trang ch tm kim",path:"/"},{icon:_.jsx(oh,{className:"w-5 h-5 text-green-600"}),label:"Vic lm",desc:"Tm vic & Tuyn dng Free",path:"/jobs"},{icon:_.jsx(Rb,{className:"w-5 h-5 text-gray-500"}),label:"Gii thiu",desc:"V ThodiaUni",path:"/about"}];return _.jsxs(AJ,{children:[_.jsx(IJ,{asChild:!0,children:t}),_.jsxs(jL,{side:"left",className:"w-[300px] sm:w-[350px] p-0 flex flex-col h-full",children:[_.jsx(OL,{className:"p-6 bg-gradient-to-br from-green-50 to-white border-b",children:_.jsxs(zL,{className:"flex items-center gap-3",children:[_.jsx("img",{src:"/logo.png",className:"w-12 h-12 rounded-xl object-contain bg-white shadow-sm border"}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"text-green-700 font-black text-xl tracking-tight",children:"ThodiaUni"}),_.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Menu chnh"})]})]})}),_.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3 space-y-1",children:r.map((l,u)=>_.jsxs(pn,{variant:"ghost",className:"w-full justify-between h-auto py-3 px-3 hover:bg-green-50 rounded-xl group",onClick:()=>e(l.path),children:[_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center group-hover:bg-white group-hover:shadow-sm transition-all",children:l.icon}),_.jsxs("div",{className:"text-left",children:[_.jsx("div",{className:"font-bold text-gray-800 text-sm",children:l.label}),_.jsx("div",{className:"text-[10px] text-gray-500 font-normal",children:l.desc})]})]}),_.jsx(bM,{className:"w-4 h-4 text-gray-300 group-hover:text-green-600"})]},u))}),_.jsxs("div",{className:"p-4 bg-gray-50 mt-auto border-t",children:[_.jsxs("div",{className:"bg-white p-4 rounded-xl border border-blue-100 shadow-sm",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[_.jsx(Vc,{className:"w-4 h-4 text-blue-600"}),_.jsx("h4",{className:"text-blue-700 font-bold text-sm",children:"Dnh cho Ch Shop"})]}),_.jsxs("p",{className:"text-xs text-gray-600 mb-3 leading-relaxed",children:["ng tin tuyn dng nhn vin hon ton ",_.jsx("strong",{children:"Min ph"})," ngay trn ThodiaUni."]}),_.jsx(pn,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold text-xs h-8",onClick:()=>e("/jobs"),children:"ng tin ngay"})]}),_.jsx("div",{className:"text-center mt-4 text-[10px] text-gray-400",children:"Ver 1.0.2  Made with "})]})]})]})},DJ=(t,e,r,l)=>{const m=(r-t)*Math.PI/180,v=(l-e)*Math.PI/180,b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(v/2)*Math.sin(v/2);return 6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},LJ=(t,e)=>{let r=1/0,l=0;for(let u=0;u<e.length;u++){const m=e[u],v=DJ(t[1],t[0],m[1],m[0]);v<r&&(r=v,l=u)}return{distance:r,segmentIndex:l}},jJ=({steps:t,routeGeometry:e,isNavigating:r,userLocation:l,onOffRoute:u})=>{const[m,v]=P.useState({currentStepIndex:0,distanceToNextStep:0,isOffRoute:!1,isTracking:!1}),b=50,a=P.useCallback((k,M)=>{const{distance:L,segmentIndex:z}=LJ(k,M),O=L>b;let K=0,H=0;for(let Y=0;Y<t.length;Y++){K+=t[Y].distance;const ee=z/M.length,ie=K/t.reduce((pe,xe)=>pe+xe.distance,0);if(ee<=ie){H=Y;break}H=Y}let Z=0;if(H<t.length){let Y=0;for(let Ce=0;Ce<H;Ce++)Y+=t[Ce].distance;const ee=t[H]?.distance||0,ie=z/M.length,pe=t.reduce((Ce,je)=>Ce+je.distance,0),xe=ie*pe;Z=Math.max(0,Y+ee-xe)}return{currentStepIndex:H,distanceToNextStep:Z,isOffRoute:O}},[t,b]);return P.useEffect(()=>{if(!r||!l||!e){v(L=>({...L,isTracking:!1}));return}const k=[l.lng,l.lat],M=a(k,e.coordinates);v(L=>{const z={...L,isTracking:!0,...M};return M.isOffRoute&&!L.isOffRoute&&u&&u(),z})},[r,l?.lat,l?.lng,e,t,u]),m},$I=()=>{const{t,language:e}=ia(),{id:r}=tV(),l=sp(),[u,m]=P.useState(null),v=P.useRef(null),[b,a]=P.useState(null),[k,M]=P.useState(null),[L,z]=P.useState(null),[O,K]=P.useState(null),[H,Z]=P.useState(["building","food","housing","job","lecture_hall","office","cafe","entertainment","checkin"]),[Y,ee]=P.useState(!1),[ie,pe]=P.useState(!1),[xe,Ce]=P.useState(!1),[je,Ue]=P.useState(!1),[et,Ie]=P.useState(null),[ot,ut]=P.useState(null),[gt,ft]=P.useState(""),[vt,st]=P.useState(!1),[nt,ze]=P.useState(!1),[Se,We]=P.useState(!1),[fe,Fe]=P.useState(!1),[lt,Tt]=P.useState(!1),[Kt,sn]=P.useState(null),{favorites:xt}=D3(),{route:Zt,isLoading:vn,getDirections:on,clearDirections:Sn,transportMode:Yt,setTransportMode:nr,routePreference:Xn,setRoutePreference:_i,origin:Kn,destination:Er}=hK(),{route:Ks,waypoints:xi,isLoading:Zr,transportMode:ti,addWaypoint:is,removeWaypoint:qi,reorderWaypoints:Ns,getMultiStopDirections:xs,clearRoute:Vr,setTransportMode:ss}=mK();P.useEffect(()=>{if(!r){M(null),document.title="ThodiaUni - Bn  i hc";return}const ue=qT.find(Te=>String(Te.id)===r);if(ue){M(ue),K(ue),document.title=`${e==="en"?ue.name:ue.nameVi} | ThodiaUni`;return}if(k&&String(k.id)===r){const Te=e==="en"&&k.name?k.name:k.nameVi;document.title=`${Te} | ThodiaUni`}},[r,e]),P.useEffect(()=>{if(!navigator.geolocation)return;const ue=navigator.geolocation.watchPosition(Te=>{const we={lat:Te.coords.latitude,lng:Te.coords.longitude};m(we),v.current=we},Te=>console.warn("Li GPS:",Te),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0});return()=>navigator.geolocation.clearWatch(ue)},[]);const vi=P.useCallback(ue=>{a(ue)},[]),Rs=P.useCallback(()=>{a(null)},[]),Zi=P.useCallback(()=>{Ue(!0),ee(!0),Gt.info(e==="vi"?"Hy chn im n tip theo":"Select the next stop")},[e]),Ii=P.useCallback((ue,Te)=>{if(je||xe){const we={coordinates:[ue.lng,ue.lat],name:e==="en"&&ue.name?ue.name:ue.nameVi,location:ue};let Oe=[...xi];if(Oe.length===0&&ot){const Le={coordinates:ot,name:gt||"im dng 1"};Oe.push(Le),is(Le)}if(Oe.push(we),is(we),Ue(!1),ee(!1),ie&&(pe(!1),Sn()),Ce(!0),v.current){const Be={coordinates:[v.current.lng,v.current.lat],name:e==="vi"?"V tr ca bn":"Your location"};xs(Be,Oe,ti)}return}M(ue),K(ue),Te&&z(Te),l(`/place/${ue.id}`)},[je,xe,ie,is,xi,e,xs,ti,ot,gt,Sn,l]),xo=P.useCallback(ue=>{sn({mapboxId:String(ue.id),name:ue.nameVi||ue.name||"a im",address:ue.address,lat:ue.lat,lng:ue.lng}),Tt(!0)},[]),Ys=P.useCallback(()=>{l("/"),z(null)},[l]),Mi=P.useCallback((ue,Te="walking")=>{l("/"),z(null),Ce(!1),Vr();const we=[ue.lng,ue.lat];if(ut(we),v.current){const Oe=[v.current.lng,v.current.lat];Ie(Oe),on(Oe,we,Te),pe(!0)}else Gt.info(e==="vi"?"ang ly v tr...":"Locating..."),navigator.geolocation.getCurrentPosition(Oe=>{const Be=[Oe.coords.longitude,Oe.coords.latitude];Ie(Be),on(Be,we,Te),pe(!0)})},[on,e,Vr,l]),os=P.useCallback(ue=>{const Te=e==="en"&&ue.name?ue.name:ue.nameVi;ft(Te),Mi(ue)},[Mi,e]),ni=P.useCallback(()=>{Sn(),Ie(null),ut(null),pe(!1),Ce(!1),Vr()},[Sn,Vr]),Ds=P.useCallback(ue=>{Z(Te=>Te.includes(ue)?Te.filter(we=>we!==ue):[...Te,ue])},[]),{currentStepIndex:Js,distanceToNextStep:vo,isTracking:be}=jJ({steps:Zt?.steps||[],routeGeometry:Zt?.geometry||null,isNavigating:ie,userLocation:u,onOffRoute:()=>{if(v.current&&Er){Gt.warning(t("offRouteWarning"));const ue=[v.current.lng,v.current.lat];Ie(ue),on(ue,Er,Yt,Xn)}}}),ne=P.useCallback(()=>{Ue(!0),Gt.info(e==="vi"?"Chn im dng tip theo trn bn ":"Select next stop on the map")},[e]),re=P.useCallback(ue=>{Fe(!0)},[]);return _.jsxs("div",{className:"relative h-screen w-full overflow-hidden bg-background",children:[_.jsx("div",{className:"absolute inset-0",children:_.jsx(aq,{selectedLocation:k,onSelectLocation:Ii,activeCategories:H,flyToLocation:O,routeInfo:Zt,routeOrigin:et,routeDestination:ot,onClearRoute:ni,multiStopRoute:Ks,isMultiStopMode:xe})}),_.jsx("div",{className:"absolute inset-x-0 top-0 h-40 bg-gradient-to-b from-background/80 via-background/40 to-transparent pointer-events-none"}),_.jsx("div",{className:"absolute top-0 left-0 right-0 safe-top z-[50]",children:_.jsxs("div",{className:"px-3 pt-3",children:[_.jsxs(yr.div,{className:"flex items-center gap-2 mb-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1},children:[_.jsx(RJ,{children:_.jsxs("div",{className:"flex flex-col items-center justify-center cursor-pointer mr-2 group",children:[_.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-lg flex items-center justify-center overflow-hidden border-2 border-green-700 group-hover:scale-105 transition-transform z-10",children:_.jsx("img",{src:"/logo.png",alt:"ThodiaUni Logo",className:"w-full h-full object-cover"})}),_.jsx("span",{className:"text-[9px] font-black text-white bg-green-700 px-2 py-[1px] rounded-sm -mt-2 z-20 shadow-sm tracking-wider border border-white uppercase",children:"Menu"})]})}),_.jsx("div",{className:"flex-1 min-w-0",children:_.jsx(cq,{onLocationSelect:Ii,userLocation:u,onFocus:()=>ee(!0),onBlur:()=>ee(!1)})}),_.jsxs("button",{onClick:()=>ze(!0),className:"relative w-9 h-9 rounded-xl bg-muted flex items-center justify-center hover:bg-muted/80 transition-colors shadow-sm",children:[_.jsx($f,{className:"w-5 h-5 text-muted-foreground"}),xt.length>0&&_.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:xt.length>9?"9+":xt.length})]}),_.jsx(SJ,{onLoginClick:()=>st(!0),onFavoritesClick:()=>ze(!0),onStoresClick:()=>We(!0)}),_.jsx(EJ,{compact:!0})]}),_.jsx(Sa,{children:!Y&&!ie&&!xe&&_.jsx(yr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:.2},className:"ml-2",children:_.jsx(uq,{activeCategories:H,onToggleCategory:Ds})})})]})}),_.jsx(Sa,{children:xe&&_.jsx(gK,{routeInfo:Ks,waypoints:xi,isLoading:Zr,transportMode:ti,onClose:ni,onChangeTransportMode:ue=>{if(ss(ue),v.current){const Te={coordinates:[v.current.lng,v.current.lat],name:"Your location"};xs(Te,xi,ue)}},onRemoveWaypoint:ue=>{qi(ue);const Te=xi.filter((we,Oe)=>Oe!==ue);if(Te.length===0)ni();else if(v.current){const we={coordinates:[v.current.lng,v.current.lat],name:"Your location"};xs(we,Te,ti)}},onReorderWaypoints:Ns,onAddStop:ne,isAddingStop:je})}),_.jsx(Sa,{children:ie&&Zt&&!xe&&_.jsx(pK,{routeInfo:Zt,destinationName:gt,isLoading:vn,transportMode:Yt,routePreference:Xn,currentStepIndex:Js,distanceToNextStep:vo,isTracking:be,userAccuracy:null,onClose:ni,onChangeTransportMode:ue=>{nr(ue),Kn&&Er&&on(Kn,Er,ue,Xn)},onChangeRoutePreference:ue=>{_i(ue),Kn&&Er&&on(Kn,Er,Yt,ue)},onAddStop:Zi})}),_.jsx(Sa,{children:k&&!xe&&_.jsx(dK,{location:k,department:L,onClose:Ys,onNavigate:os,onOpenDetail:vi,onLoginClick:()=>st(!0),onPromoteClick:re,onClaim:xo})}),_.jsx(Sa,{children:b&&_.jsx(I4,{location:b,isOpen:!!b,onClose:Rs,onNavigate:()=>os(b)})}),_.jsx(kJ,{isOpen:lt,onClose:()=>Tt(!1),data:Kt}),_.jsx(HK,{isOpen:vt,onClose:()=>st(!1)}),_.jsx(WK,{isOpen:nt,onClose:()=>ze(!1),onSelectLocation:Ii,onNavigate:os,onLoginClick:()=>{ze(!1),st(!0)}}),_.jsx(nY,{isOpen:Se,onClose:()=>We(!1),onLoginClick:()=>{We(!1),st(!0)}}),!ie&&_.jsx(KW,{onSelectLocation:Ii,userLocation:u})]})},Ax="https://thodia-backend-1067502227654.asia-southeast1.run.app",OJ=()=>{const{user:t}=_o(),[e,r]=P.useState([]),[l,u]=P.useState(!0),[m,v]=P.useState(!1),[b,a]=P.useState("pending"),k=P.useCallback(async()=>{if(!t)return v(!1),!1;try{const H=(await(await fetch(`${Ax}/api/admin/check?userId=${t.uid}`)).json()).isAdmin===!0;return v(H),H}catch(O){return console.error("Li kim tra admin:",O),v(!1),!1}},[t]),M=P.useCallback(async()=>{if(!t){r([]),u(!1);return}try{const K=await(await fetch(`${Ax}/api/admin/stores?status=${b}`)).json();if(Array.isArray(K))r(K);else throw new Error("Invalid data format")}catch(O){console.error("Li ti danh sch ca hng:",O),Gt.error("Khng th ti danh sch ca hng")}finally{u(!1)}},[t,b]);return P.useEffect(()=>{(async()=>await k()?await M():u(!1))()},[k,M]),{stores:e,isLoading:l,isAdmin:m,filter:b,setFilter:a,fetchStores:M,updateStoreStatus:async(O,K)=>{try{if(!(await fetch(`${Ax}/api/admin/stores/${O}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:K})})).ok)throw new Error("Failed to update");r(Z=>Z.map(Y=>Y.id===O?{...Y,status:K}:Y)),b==="pending"&&r(Z=>Z.filter(Y=>Y.id!==O)),Gt.success(K==="approved"?" duyt xong!":" t chi!")}catch(H){console.error("Li Update:",H),Gt.error("Li kt ni server")}},deleteStore:async O=>{try{if(!(await fetch(`${Ax}/api/stores/${O}`,{method:"DELETE"})).ok)throw new Error("Failed to delete");return r(H=>H.filter(Z=>Z.id!==O)),Gt.success(" xa ca hng!"),!0}catch(K){return console.error("Error deleting store:",K),Gt.error("Khng th xa ca hng"),!1}}}},zJ=Qy("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Ky({className:t,variant:e,...r}){return _.jsx("div",{className:cn(zJ({variant:e}),t),...r})}const ym=P.forwardRef(({className:t,...e},r)=>_.jsx("div",{ref:r,className:cn("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));ym.displayName="Card";const my=P.forwardRef(({className:t,...e},r)=>_.jsx("div",{ref:r,className:cn("flex flex-col space-y-1.5 p-6",t),...e}));my.displayName="CardHeader";const gy=P.forwardRef(({className:t,...e},r)=>_.jsx("h3",{ref:r,className:cn("text-2xl font-semibold leading-none tracking-tight",t),...e}));gy.displayName="CardTitle";const yy=P.forwardRef(({className:t,...e},r)=>_.jsx("p",{ref:r,className:cn("text-sm text-muted-foreground",t),...e}));yy.displayName="CardDescription";const _m=P.forwardRef(({className:t,...e},r)=>_.jsx("div",{ref:r,className:cn("p-6 pt-0",t),...e}));_m.displayName="CardContent";const BJ=P.forwardRef(({className:t,...e},r)=>_.jsx("div",{ref:r,className:cn("flex items-center p-6 pt-0",t),...e}));BJ.displayName="CardFooter";const jf="https://thodia-backend-1067502227654.asia-southeast1.run.app",FJ=({isOpen:t,onClose:e,location:r})=>{if(!r)return null;const{user:l}=_o(),[u,m]=P.useState("info"),[v,b]=P.useState(r),[a,k]=P.useState([]),[M,L]=P.useState([]),[z,O]=P.useState([]),[K,H]=P.useState(new Set),[Z,Y]=P.useState(0),[ee,ie]=P.useState(0),[pe,xe]=P.useState(!0),[Ce,je]=P.useState(!1),Ue=String(r.id).replace("user-store-",""),Ie=v?.user_id===l?.uid||l?.email==="admin@gmail.com";P.useEffect(()=>{t&&r&&ot()},[t,r.id,l]);const ot=async()=>{xe(!0);try{const Fe=await(await fetch(`${jf}/api/stores/${Ue}/public`)).json()||r;b(Fe);const[lt,Tt,Kt,sn]=await Promise.all([fetch(`${jf}/api/stores/${Ue}/menu`),fetch(`${jf}/api/stores/${Ue}/gallery`),fetch(`${jf}/api/store-vouchers/${Ue}`),fetch(`${jf}/api/reviews/list/${Ue}`)]),xt=await lt.json(),Zt=await Tt.json(),vn=await Kt.json(),on=await sn.json();if(Array.isArray(xt)&&L(xt),Array.isArray(Zt)&&O(Zt),Array.isArray(vn)&&k(vn),Array.isArray(on)&&on.length>0){const Yt=on.reduce((nr,Xn)=>nr+Xn.rating,0)/on.length;Y(Number(Yt.toFixed(1))),ie(on.length)}else Y(0),ie(0);if(l){const Yt=await(await fetch(`${jf}/api/user-vouchers?userId=${l.uid}`)).json();if(Array.isArray(Yt)){const nr=new Set(Yt.map(Xn=>Xn.id||Xn.voucher_id));H(nr)}}}catch(We){console.error("Li ti d liu chi tit:",We)}finally{xe(!1)}},ut=async()=>{await ot()},gt=async We=>{if(!l){Gt.error("Vui lng ng nhp  lu voucher!");return}if(!K.has(We.id)){H(fe=>new Set(fe).add(We.id)),Gt.success(" lu voucher vo v!");try{if(!(await fetch(`${jf}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:l.uid,voucherId:We.id})})).ok)throw new Error("Failed")}catch{H(Fe=>{const lt=new Set(Fe);return lt.delete(We.id),lt}),Gt.error("Khng th lu voucher lc ny")}}},ft=v.image_url||v.image||"https://images.unsplash.com/photo-1554118811-1e0d58224f24",vt=v.name_vi||v.nameVi||v.name||"a im cha c tn",st=v.address_vi||v.address||"ang cp nht a ch",nt=v.phone||r.phone||"Cha cp nht",ze=v.open_hours_vi||"08:00 - 22:00",Se=v.description_vi||v.description;return _.jsxs(_.Fragment,{children:[_.jsx(u0,{open:t,onOpenChange:e,children:_.jsxs(m_,{className:"max-w-2xl h-[90vh] p-0 bg-white gap-0 border-none rounded-2xl overflow-hidden z-[100] flex flex-col focus:outline-none",children:[_.jsx(g_,{className:"sr-only",children:vt}),pe?_.jsx("div",{className:"flex-1 flex items-center justify-center",children:_.jsx(ki,{className:"w-8 h-8 animate-spin text-primary"})}):_.jsxs(_.Fragment,{children:[_.jsxs("div",{className:"relative h-48 bg-gray-200 flex-shrink-0",children:[_.jsx("img",{src:ft,className:"w-full h-full object-cover",alt:vt,onError:We=>{We.currentTarget.src="https://placehold.co/600x400?text=No+Image"}}),_.jsx("button",{onClick:e,className:"absolute top-4 right-4 bg-black/50 p-1.5 rounded-full text-white hover:bg-black/70 transition-colors z-10",children:_.jsx(di,{className:"w-5 h-5"})}),Ie&&_.jsxs(pn,{size:"sm",className:"absolute bottom-4 right-4 bg-white/90 text-black hover:bg-white shadow-md border backdrop-blur-sm",onClick:()=>je(!0),children:[_.jsx(CM,{className:"w-3.5 h-3.5 mr-2"})," Chnh sa"]})]}),_.jsxs("div",{className:"pt-4 px-6 pb-2 flex-shrink-0",children:[_.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-tight",children:vt}),_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[_.jsx(ah,{className:`w-4 h-4 ${Z>0?"fill-yellow-500 text-yellow-500":"text-gray-300"}`}),_.jsx("span",{className:"font-bold text-gray-900",children:Z>0?Z:"Cha c nh gi"}),ee>0&&_.jsxs("span",{children:["(",ee,")"]}),_.jsx("span",{className:"capitalize px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:v.category||v.type||"a im"})]}),_.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[_.jsx(Mv,{className:"w-4 h-4 text-green-600"})," ",_.jsx("span",{children:ze})]}),_.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[_.jsx(e_,{className:"w-4 h-4 text-blue-600"})," ",_.jsx("span",{children:nt})]})]}),_.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-2",children:[_.jsx(Ai,{className:"w-4 h-4 flex-shrink-0 text-red-500"}),_.jsx("span",{className:"truncate",children:st})]})]}),_.jsxs(Gy,{defaultValue:"info",className:"flex-1 flex flex-col min-h-0",value:u,onValueChange:m,children:[_.jsx("div",{className:"px-6 border-b flex-shrink-0 bg-white sticky top-0 z-10",children:_.jsxs(Fm,{className:"w-full justify-start bg-transparent h-12 p-0 gap-6 overflow-x-auto no-scrollbar",children:[_.jsx(Vi,{value:"info",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:"Thng tin"}),_.jsxs(Vi,{value:"menu",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Thc n (",M.length,")"]}),_.jsxs(Vi,{value:"vouchers",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Voucher (",a.length,")"]}),_.jsxs(Vi,{value:"gallery",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh (",z.length,")"]}),_.jsxs(Vi,{value:"reviews",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh gi (",ee,")"]})]})}),_.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4 scroll-smooth",children:[_.jsx(Ps,{value:"info",className:"m-0 focus:outline-none",children:_.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border space-y-3",children:[_.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[_.jsx(Rb,{className:"w-4 h-4 text-blue-500"})," Gii thiu"]}),_.jsx("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-wrap",children:Se||"Cha c m t chi tit v a im ny."})]})}),_.jsx(Ps,{value:"menu",className:"space-y-4 m-0 focus:outline-none",children:M.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(t_,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Cha cp nht thc n."})]}):_.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:M.map(We=>_.jsxs("div",{className:"bg-white p-2 rounded-xl border flex gap-3 hover:shadow-md transition-shadow",children:[_.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:_.jsx("img",{src:We.image_url||"https://placehold.co/100x100",className:"w-full h-full object-cover",alt:We.name,onError:fe=>{fe.currentTarget.src="https://placehold.co/100x100?text=Food"}})}),_.jsxs("div",{className:"flex-1 py-1 flex flex-col justify-between",children:[_.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-2",children:We.name_vi||We.name}),_.jsxs("span",{className:"font-bold text-primary block",children:[We.price?new Intl.NumberFormat("vi-VN").format(Number(We.price)):0,""]})]})]},We.id))})}),_.jsx(Ps,{value:"vouchers",className:"space-y-3 m-0 focus:outline-none",children:a.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(qm,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Khng c m gim gi no."})]}):a.map(We=>{const fe=K.has(We.id);return _.jsx("div",{className:"bg-white rounded-xl border border-dashed border-orange-200 p-4 shadow-sm relative group hover:border-orange-400 transition-colors",children:_.jsxs("div",{className:"flex gap-4 items-center",children:[_.jsxs("div",{className:"w-16 h-16 bg-orange-50 rounded-lg flex flex-col items-center justify-center border border-orange-100 text-orange-600 flex-shrink-0",children:[_.jsx("span",{className:"text-xl font-black",children:We.discount_value}),_.jsx("span",{className:"text-xs font-bold uppercase",children:We.discount_type==="percent"?"%":"k"})]}),_.jsxs("div",{className:"flex-1 min-w-0",children:[_.jsx("h4",{className:"font-bold text-gray-900 truncate",children:We.title_vi}),_.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:["M: ",_.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded text-gray-700 font-bold",children:We.code})]})]}),_.jsx(pn,{onClick:()=>gt(We),disabled:fe,size:"sm",className:`shrink-0 ${fe?"bg-green-100 text-green-700 hover:bg-green-200":"bg-orange-500 text-white hover:bg-orange-600"}`,children:fe?_.jsxs(_.Fragment,{children:[_.jsx(wh,{className:"w-4 h-4 mr-1"}),"  lu"]}):"Lu m"})]})},We.id)})}),_.jsx(Ps,{value:"gallery",className:"m-0 focus:outline-none",children:z.length===0?_.jsxs("div",{className:"text-center py-12 text-gray-400",children:[_.jsx(Nb,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),_.jsx("p",{children:"Cha c hnh nh no khc."})]}):_.jsx("div",{className:"grid grid-cols-3 gap-2",children:z.map(We=>_.jsx("div",{className:"aspect-square rounded-xl overflow-hidden border bg-gray-100 cursor-pointer hover:opacity-90",children:_.jsx("img",{src:We.image_url,className:"w-full h-full object-cover",alt:""})},We.id))})}),_.jsx(Ps,{value:"reviews",className:"m-0 focus:outline-none",children:_.jsx(FD,{storeId:Ue})})]})]})]})]})}),Ce&&_.jsx(cS,{isOpen:Ce,onClose:()=>je(!1),onSubmit:ut,initialData:v,customStoreId:Ue})]})},lw="https://thodia-backend-1067502227654.asia-southeast1.run.app",VJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),[u,m]=P.useState(null),v=async()=>{l(!0);try{const M=await(await fetch(`${lw}/api/admin/claims`)).json();Array.isArray(M)?e(M):Gt.error("Li d liu t server")}catch(k){console.error(k),Gt.error("Khng ti c danh sch yu cu")}finally{l(!1)}};P.useEffect(()=>{v()},[]);const b=async k=>{let M=`Xc nhn duyt quyn s hu cho "${k.mapbox_name}"?`;if(k.existingStore&&(M=` CNH BO QUAN TRNG!

a im ny ang thuc s hu ca: ${k.existingStore.owner_email}

Bn c chc chn mun CHUYN QUYN S HU sang cho: ${k.profiles?.email}?`),!!confirm(M))try{if(Gt.loading("ang x l..."),!(await fetch(`${lw}/api/admin/claims/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:k.id,mapboxId:k.mapbox_id,userId:k.user_id,mapboxName:k.mapbox_name,mapboxAddress:k.mapbox_address,lat:k.lat,lng:k.lng,role:k.role,phone:k.phone,proofImageUrl:k.proof_image_url})})).ok)throw new Error("Server error");Gt.dismiss(),Gt.success("Duyt thnh cng!"),v()}catch(L){Gt.dismiss(),Gt.error("Li khi duyt: "+L.message)}},a=async k=>{if(confirm("T chi yu cu ny?"))try{if(!(await fetch(`${lw}/api/admin/claims/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:k})})).ok)throw new Error("Failed");Gt.success(" t chi."),v()}catch{Gt.error("Li khi t chi")}};return r?_.jsx("div",{className:"p-12 flex justify-center",children:_.jsx(ki,{className:"animate-spin text-blue-600 w-8 h-8"})}):_.jsxs("div",{className:"space-y-8",children:[_.jsx("div",{className:"flex items-center justify-between",children:_.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[_.jsx(gO,{className:"text-blue-600"}),"Duyt xc minh ch s hu (",t.length,")"]})}),t.length===0?_.jsx("div",{className:"p-12 text-center bg-gray-50 rounded-xl border border-dashed text-gray-400",children:"Hin khng c yu cu no ang ch x l."}):_.jsx("div",{className:"grid gap-8",children:t.map(k=>_.jsxs("div",{className:"bg-white border rounded-xl shadow-sm overflow-hidden",children:[_.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b flex justify-between items-start",children:[_.jsxs("div",{children:[_.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[_.jsx(Ai,{className:"text-blue-600 w-5 h-5"})," ",k.mapbox_name]}),_.jsx("p",{className:"text-sm text-gray-500 ml-7",children:k.mapbox_address})]}),_.jsx(Ky,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100 border-yellow-200",children:"Pending"})]}),_.jsxs("div",{className:"p-6",children:[_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[_.jsxs("div",{className:`flex-1 p-4 rounded-lg border-2 ${k.existingStore?"bg-orange-50 border-orange-200":"bg-gray-50 border-dashed border-gray-200"}`,children:[_.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-3 text-gray-500",children:k.existingStore?" CH S HU HIN TI":"TNH TRNG: CHA C CH"}),k.existingStore?_.jsxs("div",{className:"space-y-2",children:[_.jsxs("div",{className:"flex items-center gap-2 text-gray-800 font-bold",children:[_.jsx(Iy,{size:16})," ",k.existingStore.owner_email]}),_.jsxs("div",{className:"text-sm text-gray-600 pl-6",children:["Tn qun: ",k.existingStore.name_vi]}),k.existingStore.is_verified&&_.jsx(Ky,{className:"bg-green-100 text-green-700 border-green-200 ml-6",children:" xc minh"})]}):_.jsxs("div",{className:"flex items-center gap-2 text-gray-400 py-2",children:[_.jsx(Vc,{size:20})," y l a im mi"]})]}),_.jsx("div",{className:"flex items-center justify-center",children:_.jsx("div",{className:"bg-blue-50 p-2 rounded-full text-blue-400",children:_.jsx(Cb,{size:24})})}),_.jsxs("div",{className:"flex-1 p-4 rounded-lg border-2 border-blue-200 bg-blue-50/30",children:[_.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-3 text-blue-600",children:"NGI YU CU (CH MI)"}),_.jsxs("div",{className:"space-y-2 text-sm",children:[_.jsxs("div",{className:"flex items-center gap-2 font-bold text-gray-900",children:[_.jsx(Iy,{size:16,className:"text-blue-500"})," ",k.profiles?.email||"Unknown User"]}),_.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 pl-6 mt-2",children:[_.jsxs("div",{className:"text-gray-600",children:[_.jsx("span",{className:"font-semibold",children:"Vai tr:"})," ",k.role]}),_.jsxs("div",{className:"text-gray-600",children:[_.jsx("span",{className:"font-semibold",children:"ST:"})," ",k.phone||"---"]}),_.jsxs("div",{className:"text-gray-600 col-span-2",children:[_.jsx("span",{className:"font-semibold",children:"Email LH:"})," ",k.email||"---"]})]}),_.jsxs("div",{className:"mt-3 bg-white p-2.5 rounded border border-blue-100 text-gray-600 italic text-xs",children:['"Li nhn: ',k.message||"Khng c",'"']})]})]})]}),_.jsxs("div",{className:"border-t pt-4",children:[_.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase mb-3",children:["NH BNG CHNG (",k.proof_images?.length||(k.proof_image_url?1:0),")"]}),_.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2",children:[k.proof_images&&k.proof_images.length>0?k.proof_images.map((M,L)=>_.jsxs("div",{className:"w-24 h-24 flex-shrink-0 border rounded-lg overflow-hidden cursor-pointer hover:ring-2 ring-blue-500 relative bg-gray-100 group",onClick:()=>m(M),children:[_.jsx("img",{src:M,className:"w-full h-full object-cover",loading:"lazy",onError:z=>z.currentTarget.style.display="none"}),_.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-300",children:_.jsx(NO,{size:20})}),_.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:_.jsx(RO,{className:"text-white opacity-0 group-hover:opacity-100 w-5 h-5 drop-shadow-md"})})]},L)):k.proof_image_url&&_.jsx("div",{className:"w-24 h-24 flex-shrink-0 border rounded-lg overflow-hidden cursor-pointer bg-gray-100",onClick:()=>m(k.proof_image_url),children:_.jsx("img",{src:k.proof_image_url,className:"w-full h-full object-cover"})}),!k.proof_images?.length&&!k.proof_image_url&&_.jsx("span",{className:"text-sm text-red-400 italic bg-red-50 px-3 py-1 rounded",children:"Ngi dng khng ti ln nh no."})]})]})]}),_.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t flex justify-end gap-3",children:[_.jsxs(pn,{variant:"outline",onClick:()=>a(k.id),className:"text-red-600 border-red-200 hover:bg-red-50",children:[_.jsx(di,{className:"w-4 h-4 mr-2"})," T chi"]}),_.jsxs(pn,{onClick:()=>b(k),className:"bg-green-600 hover:bg-green-700 text-white shadow-sm min-w-[140px]",children:[_.jsx(wh,{className:"w-4 h-4 mr-2"}),k.existingStore?"Chuyn quyn s hu":"Duyt & To mi"]})]})]},k.id))}),u&&_.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>m(null),children:_.jsxs("div",{className:"relative max-w-5xl w-full max-h-screen flex items-center justify-center p-2",children:[_.jsx("img",{src:u,alt:"Full Proof",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl border border-gray-700"}),_.jsx("button",{onClick:()=>m(null),className:"absolute top-4 right-4 bg-white/20 hover:bg-white/40 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:_.jsx(di,{size:32})})]})})]})},Wf="https://thodia-backend-1067502227654.asia-southeast1.run.app",UJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),u=async()=>{l(!0);try{const b=await(await fetch(`${Wf}/api/admin/ads`)).json();Array.isArray(b)&&e(b)}catch(v){console.error(v),Gt.error("Li ti qung co")}finally{l(!1)}};P.useEffect(()=>{u()},[]);const m=async v=>{if(confirm("Hy qung co ny?"))try{await fetch(`${Wf}/api/admin/ads/cancel/${v}`,{method:"PUT"}),Gt.success(" hy qung co"),e(b=>b.filter(a=>a.id!==v))}catch{Gt.error("Li khi hy")}};return _.jsxs("div",{className:"space-y-4",children:[r?_.jsx("div",{className:"flex justify-center p-8",children:_.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-600 rounded-full border-t-transparent"})}):t.length===0?_.jsx("div",{className:"text-gray-500 text-center py-12 bg-gray-50 rounded-xl border border-dashed",children:"Hin khng c ca hng no chy qung co."}):null,_.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.map(v=>{const b=new Date(v.ad_expiry),a=new Date,k=Math.ceil((b.getTime()-a.getTime())/(1e3*60*60*24)),M=k<0;return _.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden shadow-sm flex flex-col hover:shadow-md transition-shadow",children:[_.jsxs("div",{className:"h-32 bg-gray-100 relative group",children:[_.jsx("img",{src:v.image_url,className:"w-full h-full object-cover",onError:L=>L.currentTarget.src="https://placehold.co/400x200"}),_.jsxs("div",{className:"absolute top-2 right-2 bg-gradient-to-r from-pink-500 to-red-500 text-white text-[10px] font-bold px-2 py-1 rounded shadow-md flex items-center gap-1",children:[_.jsx(Gx,{size:12})," ang chy"]})]}),_.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[_.jsx("h4",{className:"font-bold text-gray-800 text-lg mb-1 line-clamp-1",children:v.name_vi}),_.jsxs("p",{className:"text-xs text-gray-500 mb-4 truncate flex items-center gap-1",children:[_.jsx(IM,{size:12})," ",v.user_email]}),_.jsxs("div",{className:"mt-auto space-y-3",children:[_.jsxs("div",{className:"flex items-center justify-between text-sm bg-blue-50 p-2 rounded text-blue-800 border border-blue-100",children:[_.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[_.jsx(yO,{className:"w-3 h-3"})," Ht hn:"]}),_.jsx("span",{className:"font-bold",children:b.toLocaleDateString("vi-VN")})]}),_.jsx("div",{className:`text-center text-xs font-bold ${M?"text-red-500":"text-green-600"}`,children:M?" ht hn":`Cn li ${k} ngy`}),_.jsxs(pn,{variant:"outline",className:"w-full text-red-600 border-red-200 hover:bg-red-50 h-8 text-xs",onClick:()=>m(v.id),children:[_.jsx(di,{className:"w-3 h-3 mr-2"})," Dng Qung Co"]})]})]})]},v.id)})})]})},$J=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),u=async()=>{l(!0);try{const a=await(await fetch(`${Wf}/api/admin/jobs`)).json();Array.isArray(a)&&e(a)}catch{Gt.error("Li ti tin tuyn dng")}finally{l(!1)}};P.useEffect(()=>{u()},[]);const m=async b=>{if(confirm("Xa tin ny?"))try{await fetch(`${Wf}/api/admin/jobs/${b}`,{method:"DELETE"}),e(a=>a.filter(k=>k.id!==b)),Gt.success(" xa")}catch{Gt.error("Li xa")}},v=async(b,a)=>{try{await fetch(`${Wf}/api/admin/jobs/${b}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})}),e(k=>k.map(M=>M.id===b?{...M,status:a}:M)),Gt.success(` cp nht: ${a}`)}catch{Gt.error("Li cp nht")}};return _.jsxs("div",{className:"space-y-4",children:[t.length===0&&_.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c tin tuyn dng no."}),t.map(b=>_.jsxs("div",{className:"bg-white p-4 rounded-lg border flex flex-col md:flex-row justify-between gap-4 shadow-sm hover:shadow-md transition-shadow",children:[_.jsxs("div",{className:"flex-1",children:[_.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[_.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:b.title}),_.jsx(Ky,{className:b.status==="approved"?"bg-green-100 text-green-700":b.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700",children:b.status==="approved"?" duyt":b.status==="rejected"?"T chi":"Ch duyt"})]}),_.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:[b.shop_name," ",_.jsx("span",{className:"text-gray-400",children:"|"})," ",b.salary]}),_.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:b.description}),_.jsxs("p",{className:"text-[10px] text-gray-400 mt-2",children:["Ngy ng: ",new Date(b.created_at).toLocaleDateString("vi-VN")]})]}),_.jsxs("div",{className:"flex items-center gap-2 border-t md:border-t-0 md:border-l pt-3 md:pt-0 md:pl-4",children:[b.status==="pending"&&_.jsxs(_.Fragment,{children:[_.jsxs(pn,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>v(b.id,"approved"),children:[_.jsx(wh,{className:"w-4 h-4 mr-1"})," Duyt"]}),_.jsxs(pn,{size:"sm",variant:"outline",className:"border-red-200 text-red-600 hover:bg-red-50",onClick:()=>v(b.id,"rejected"),children:[_.jsx(di,{className:"w-4 h-4 mr-1"})," B"]})]}),_.jsx(pn,{size:"icon",variant:"ghost",className:"text-red-500 hover:bg-red-50",onClick:()=>m(b.id),children:_.jsx(lh,{className:"w-4 h-4"})})]})]},b.id))]})},GJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0);P.useEffect(()=>{(async()=>{l(!0);try{const b=await(await fetch(`${Wf}/api/admin/users`)).json();Array.isArray(b)&&e(b)}catch{console.error("Li ti users")}finally{l(!1)}})()},[]);const u=async m=>{if(confirm("Cnh bo: Xa user s mt ht d liu lin quan!"))try{await fetch(`${Wf}/api/admin/users/${m}`,{method:"DELETE"}),e(v=>v.filter(b=>b.id!==m)),Gt.success(" xa h s")}catch{Gt.error("Li xa user")}};return r?_.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti danh sch ngi dng..."}):_.jsx("div",{className:"bg-white rounded-lg border overflow-hidden shadow-sm",children:_.jsx("div",{className:"overflow-x-auto",children:_.jsxs("table",{className:"w-full text-sm text-left",children:[_.jsx("thead",{className:"bg-gray-50 border-b",children:_.jsxs("tr",{children:[_.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"User / Email"}),_.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"Trng thi"}),_.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"Ngy tham gia"}),_.jsx("th",{className:"p-4 text-right text-gray-600 font-bold",children:"Hnh ng"})]})}),_.jsx("tbody",{className:"divide-y",children:t.map(m=>_.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[_.jsxs("td",{className:"p-4",children:[_.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[m.email,m.isVip&&_.jsxs("span",{className:"bg-yellow-100 text-yellow-700 text-[10px] px-1.5 py-0.5 rounded border border-yellow-200 flex items-center gap-1 shadow-sm",children:[_.jsx(nl,{className:"w-3 h-3 fill-yellow-600"})," VIP"]})]}),_.jsx("div",{className:"text-xs text-gray-500",children:m.username||"Cha t tn"}),_.jsx("div",{className:"text-[10px] text-gray-400 font-mono mt-0.5",children:m.id})]}),_.jsx("td",{className:"p-4",children:_.jsx(Ky,{variant:"outline",className:m.isVip?"border-yellow-500 text-yellow-700 bg-yellow-50":"text-gray-500",children:m.isVip?"Premium User":"Thnh vin"})}),_.jsx("td",{className:"p-4 text-gray-500",children:new Date(m.created_at).toLocaleDateString("vi-VN")}),_.jsx("td",{className:"p-4 text-right",children:_.jsx(pn,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>u(m.id),children:_.jsx(lh,{className:"w-4 h-4"})})})]},m.id))})]})})})},HJ=()=>{const{stores:t,isLoading:e,isAdmin:r,setFilter:l,updateStoreStatus:u,deleteStore:m}=OJ(),{signOut:v}=_o(),b=sp(),[a,k]=P.useState(null),[M,L]=P.useState(!1);P.useEffect(()=>{!e&&!r&&b("/")},[r,e,b]);const z=async H=>await u(H,"approved"),O=async H=>await u(H,"rejected"),K=H=>{k(H),L(!0)};return e?_.jsx("div",{className:"flex items-center justify-center min-h-screen",children:_.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-600 border-t-transparent rounded-full"})}):r?_.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8 font-sans text-gray-900",children:_.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[_.jsxs("div",{className:"flex justify-between items-center bg-white p-6 rounded-xl shadow-sm border",children:[_.jsxs("div",{className:"flex items-center gap-4",children:[_.jsx(pn,{variant:"ghost",size:"icon",onClick:()=>b("/"),children:_.jsx(Iv,{className:"w-5 h-5"})}),_.jsxs("div",{children:[_.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),_.jsx("p",{className:"text-muted-foreground text-sm",children:"H thng qun l ThodiaUni"})]})]}),_.jsxs(pn,{variant:"destructive",onClick:()=>v(),className:"shadow-red-200 shadow-lg",children:[_.jsx(fw,{className:"w-4 h-4 mr-2"}),"ng xut"]})]}),_.jsxs(Gy,{defaultValue:"stores",className:"w-full",children:[_.jsxs(Fm,{className:"grid w-full grid-cols-5 mb-8 h-12 bg-white border shadow-sm rounded-lg p-1",children:[_.jsxs(Vi,{value:"stores",className:"text-sm font-medium data-[state=active]:bg-green-50 data-[state=active]:text-green-700",children:[_.jsx(Vc,{className:"w-4 h-4 mr-2"})," Ca hng"]}),_.jsxs(Vi,{value:"ads",className:"text-sm font-medium data-[state=active]:bg-pink-50 data-[state=active]:text-pink-700",children:[_.jsx(Gx,{className:"w-4 h-4 mr-2"})," Qung co"]}),_.jsxs(Vi,{value:"jobs",className:"text-sm font-medium data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[_.jsx(oh,{className:"w-4 h-4 mr-2"})," Tuyn dng"]}),_.jsxs(Vi,{value:"users",className:"text-sm font-medium data-[state=active]:bg-purple-50 data-[state=active]:text-purple-700",children:[_.jsx(IM,{className:"w-4 h-4 mr-2"})," Ngi dng"]}),_.jsxs(Vi,{value:"claims",className:"text-sm font-medium data-[state=active]:bg-orange-50 data-[state=active]:text-orange-700",children:[_.jsx(OO,{className:"w-4 h-4 mr-2"})," Xc minh"]})]}),_.jsx(Ps,{value:"stores",children:_.jsxs(ym,{className:"border-none shadow-md",children:[_.jsxs(my,{children:[_.jsx(gy,{children:"Danh sch ca hng"}),_.jsxs(yy,{children:["Hin c ",t.length," ca hng trong h thng."]})]}),_.jsx(_m,{children:_.jsxs(Gy,{defaultValue:"pending",className:"w-full",onValueChange:H=>l(H),children:[_.jsxs(Fm,{className:"mb-6 bg-gray-100 w-full justify-start overflow-x-auto",children:[_.jsx(Vi,{value:"pending",children:"Ch duyt"}),_.jsx(Vi,{value:"approved",children:" duyt"}),_.jsx(Vi,{value:"rejected",children:"T chi"}),_.jsx(Vi,{value:"all",children:"Tt c"})]}),_.jsx("div",{className:"grid gap-4",children:t.length===0?_.jsx("p",{className:"text-center py-12 text-muted-foreground",children:"Khng c d liu"}):t.map(H=>_.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-white border rounded-xl p-4 hover:shadow-md transition-all",children:[_.jsxs("div",{className:"w-full md:w-32 h-32 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 relative",children:[_.jsx("img",{src:H.image_url||"https://placehold.co/400x400?text=Store",className:"w-full h-full object-cover",onError:Z=>{Z.currentTarget.src="https://placehold.co/400x400?text=No+Image"}}),H.is_premium&&_.jsxs("span",{className:"absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-[10px] font-bold px-1.5 rounded flex items-center gap-1 shadow-sm",children:[_.jsx(nl,{className:"w-3 h-3 fill-current"})," VIP"]})]}),_.jsxs("div",{className:"flex-1 space-y-2",children:[_.jsxs("div",{className:"flex justify-between items-start",children:[_.jsx("h3",{className:"font-bold text-lg text-gray-800",children:H.name_vi}),_.jsx(Ky,{className:H.status==="approved"?"bg-green-100 text-green-700":H.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700",children:H.status==="approved"?"Hot ng":H.status==="rejected"?" kha":"Ch duyt"})]}),_.jsxs("p",{className:"text-sm text-gray-600 flex gap-2",children:[_.jsx(Ai,{className:"w-4 h-4 text-gray-400"})," ",H.address_vi]}),_.jsxs("p",{className:"text-xs text-gray-400",children:["Owner: ",H.user_email]})]}),_.jsxs("div",{className:"flex flex-col gap-2 justify-center border-t md:border-t-0 md:border-l pt-4 md:pt-0 md:pl-4 min-w-[140px]",children:[_.jsxs(pn,{variant:"outline",size:"sm",onClick:()=>K(H),children:[_.jsx(CO,{className:"w-4 h-4 mr-2"})," Chi tit"]}),H.status==="pending"&&_.jsxs(_.Fragment,{children:[_.jsxs(pn,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>z(H.id),children:[_.jsx(wh,{className:"w-4 h-4 mr-2"})," Duyt"]}),_.jsxs(pn,{size:"sm",variant:"destructive",onClick:()=>O(H.id),children:[_.jsx(di,{className:"w-4 h-4 mr-2"})," T chi"]})]}),H.status!=="pending"&&_.jsxs(pn,{size:"sm",variant:"ghost",onClick:()=>m(H.id),className:"text-red-600 hover:bg-red-50",children:[_.jsx(fw,{className:"w-4 h-4 mr-2"})," Xa"]})]})]},H.id))})]})})]})}),_.jsx(Ps,{value:"ads",children:_.jsxs(ym,{className:"border-none shadow-md",children:[_.jsxs(my,{children:[_.jsx(gy,{children:"Qung co ang chy"}),_.jsx(yy,{children:"Qun l cc chin dch qung co ca ca hng."})]}),_.jsx(_m,{children:_.jsx(UJ,{})})]})}),_.jsx(Ps,{value:"jobs",children:_.jsxs(ym,{className:"border-none shadow-md",children:[_.jsxs(my,{children:[_.jsx(gy,{children:"Tin tuyn dng"}),_.jsx(yy,{children:"Duyt v qun l cc bi ng tm vic lm."})]}),_.jsx(_m,{children:_.jsx($J,{})})]})}),_.jsx(Ps,{value:"users",children:_.jsxs(ym,{className:"border-none shadow-md",children:[_.jsxs(my,{children:[_.jsx(gy,{children:"Danh sch ngi dng"}),_.jsx(yy,{children:"Qun l ti khon trong h thng."})]}),_.jsx(_m,{children:_.jsx(GJ,{})})]})}),_.jsx(Ps,{value:"claims",children:_.jsx(ym,{className:"border-none shadow-md",children:_.jsx(_m,{className:"pt-6",children:_.jsx(VJ,{})})})})]}),_.jsx(FJ,{isOpen:M,onClose:()=>L(!1),store:a})]})}):null},WJ=()=>{const t=Uv();return P.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),_.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:_.jsxs("div",{className:"text-center",children:[_.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),_.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),_.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},GI="https://thodia-backend-1067502227654.asia-southeast1.run.app",qJ=()=>{const t=sp(),{user:e}=_o(),[r,l]=P.useState(!1),[u,m]=P.useState("Tt c"),[v,b]=P.useState(null),[a,k]=P.useState([]),[M,L]=P.useState(!0),[z,O]=P.useState(!1);P.useEffect(()=>{(async()=>{L(!0);try{const ee=await(await fetch(`${GI}/api/jobs/approved`)).json();Array.isArray(ee)?k(ee):Gt.error("Li d liu t server")}catch(Y){console.error("Li ly tin:",Y),Gt.error("Khng ti c danh sch vic lm.")}finally{L(!1)}})()},[]);const K=async Z=>{if(Z.preventDefault(),!e){Gt.error("Vui lng ng nhp  ng tin!");return}O(!0);const Y=new FormData(Z.target),ee={title:Y.get("title"),shop_name:Y.get("shopName"),address:Y.get("address"),phone:Y.get("phone"),salary:Y.get("salary"),type:Y.get("type"),description:Y.get("description"),user_id:e.uid};try{if(!(await fetch(`${GI}/api/jobs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed to post job");Gt.success("ng tin thnh cng! Tin ca bn ang ch Admin duyt."),l(!1)}catch{Gt.error("Li ng tin, vui lng th li.")}finally{O(!1)}},H=Z=>{b(v===Z?null:Z)};return _.jsxs("div",{className:"min-h-screen bg-gray-50 pb-24 font-sans text-gray-800",children:[_.jsxs("div",{className:"bg-white sticky top-0 z-40 border-b shadow-sm",children:[_.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[_.jsxs("div",{className:"flex items-center gap-3",children:[_.jsx(pn,{variant:"ghost",size:"icon",onClick:()=>t("/"),className:"-ml-2 hover:bg-gray-100 rounded-full",children:_.jsx(Iv,{className:"w-5 h-5 text-gray-600"})}),_.jsxs("div",{children:[_.jsx("h1",{className:"font-bold text-lg text-gray-800 leading-none",children:"Vic lm"}),_.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"C hi cho sinh vin"})]})]}),_.jsxs(pn,{onClick:()=>{e?l(!0):Gt.error("Bn cn ng nhp  ng tin")},className:"bg-green-600 hover:bg-green-700 text-white gap-1.5 h-9 px-4 text-xs font-bold rounded-full shadow-lg shadow-green-200 active:scale-95 transition-all",children:[_.jsx(vO,{className:"w-4 h-4"}),"ng tin Free"]})]}),_.jsxs("div",{className:"px-4 pb-3 space-y-3",children:[_.jsxs("div",{className:"relative group",children:[_.jsx(Pv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-green-600 transition-colors"}),_.jsx(ui,{placeholder:"Tm vic (phc v, pha ch...)",className:"pl-9 bg-gray-100 border-transparent h-10 text-sm focus-visible:ring-1 focus-visible:ring-green-500 transition-all"})]}),_.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 no-scrollbar",style:{scrollbarWidth:"none"},children:["Tt c","Part-time","Full-time","Ca ti","Gn trng"].map(Z=>_.jsx("button",{onClick:()=>m(Z),className:`px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${u===Z?"bg-green-600 text-white border-green-600 shadow-sm":"bg-white text-gray-600 border-gray-200 hover:border-green-400"}`,children:Z},Z))})]})]}),_.jsxs("div",{className:"p-4 space-y-3",children:[M?_.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-gray-400 gap-2",children:[_.jsx(ki,{className:"w-6 h-6 animate-spin text-green-600"}),_.jsx("span",{className:"text-xs",children:"ang ti tin tuyn dng..."})]}):a.length===0?_.jsxs("div",{className:"text-center py-10 text-gray-400 text-sm bg-white rounded-xl border border-dashed",children:["Cha c tin tuyn dng no c duyt.",_.jsx("br",{}),"Hy l ngi u tin ng tin!"]}):a.map(Z=>_.jsxs(yr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[_.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>H(Z.id),children:[_.jsxs("div",{className:"flex justify-between items-start mb-2",children:[_.jsx("h3",{className:"font-bold text-gray-900 text-base line-clamp-1",children:Z.title}),_.jsx("span",{className:"text-green-700 font-extrabold text-sm bg-green-50 px-2 py-0.5 rounded ml-2 whitespace-nowrap",children:Z.salary})]}),_.jsxs("div",{className:"flex flex-col gap-1 mb-3",children:[_.jsxs("div",{className:"flex items-center gap-1.5 text-gray-700 text-sm font-semibold",children:[_.jsx(Rm,{className:"w-3.5 h-3.5 text-blue-500"}),Z.shop_name]}),_.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500 text-xs",children:[_.jsx(Ai,{className:"w-3.5 h-3.5 text-gray-400"}),Z.address]})]}),_.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[_.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded border border-gray-100",children:[_.jsx(Mv,{className:"w-3 h-3 text-orange-500"}),new Date(Z.created_at).toLocaleDateString("vi-VN")]}),_.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded border border-gray-100",children:[_.jsx(oh,{className:"w-3 h-3 text-purple-500"}),Z.type]})]})]}),_.jsx(Sa,{children:v===Z.id&&_.jsxs(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-gray-50 border-t border-gray-100 px-4 pb-4 pt-2",children:[_.jsxs("div",{className:"mb-4",children:[_.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-1 flex items-center gap-1",children:[_.jsx(AO,{className:"w-3 h-3"})," M t cng vic"]}),_.jsx("p",{className:"text-sm text-gray-700 leading-relaxed bg-white p-2 rounded border border-gray-200 whitespace-pre-line",children:Z.description})]}),_.jsx("div",{className:"flex gap-3",children:_.jsxs("a",{href:`tel:${Z.phone}`,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 rounded-lg flex items-center justify-center gap-2 transition-colors shadow-sm",children:[_.jsx(e_,{className:"w-4 h-4"}),"Gi in (",Z.phone,")"]})})]})}),v!==Z.id&&_.jsx("div",{onClick:()=>H(Z.id),className:"bg-gray-50 py-1.5 text-center text-[10px] text-gray-500 font-medium border-t border-gray-100 hover:bg-gray-100 cursor-pointer transition-colors",children:" Xem chi tit & Lin h"})]},Z.id)),_.jsx("div",{className:"h-10 text-center text-xs text-gray-400",children:"Ht danh sch"})]}),r&&_.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[_.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:()=>l(!1)}),_.jsxs(yr.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl relative z-10 flex flex-col max-h-[85vh]",children:[_.jsxs("div",{className:"bg-green-600 p-4 rounded-t-2xl text-white flex justify-between items-center sticky top-0 z-20",children:[_.jsxs("div",{children:[_.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[_.jsx(oh,{className:"w-5 h-5"}),"ng tin tuyn dng"]}),_.jsx("p",{className:"text-xs text-green-100 opacity-90",children:"Tip cn hng nghn sinh vin quanh y"})]}),_.jsx("button",{onClick:()=>l(!1),className:"p-1.5 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:_.jsx(di,{className:"w-5 h-5 text-white"})})]}),_.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6",children:_.jsxs("form",{id:"post-job-form",onSubmit:K,className:"space-y-6",children:[_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase flex items-center gap-2 border-b pb-1",children:[_.jsx(Rm,{className:"w-4 h-4 text-green-600"}),"Thng tin ca hng"]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["Tn ca hng/qun ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{name:"shopName",placeholder:"VD: Tr sa Gong Cha",required:!0,className:"bg-gray-50"})]}),_.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["S in thoi lin h ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{name:"phone",placeholder:"09xxxx...",required:!0,className:"bg-gray-50",type:"tel"})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["a ch c th ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{name:"address",placeholder:"S nh, ng...",required:!0,className:"bg-gray-50"})]})]})]}),_.jsxs("div",{className:"space-y-3",children:[_.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase flex items-center gap-2 border-b pb-1",children:[_.jsx(oh,{className:"w-4 h-4 text-green-600"}),"Chi tit cng vic"]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["V tr cn tuyn ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{name:"title",placeholder:"VD: Nhn vin phc v ca ti",required:!0,className:"bg-gray-50 font-medium"})]}),_.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["Mc lng ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(ui,{name:"salary",placeholder:"VD: 25k/h",required:!0,className:"bg-gray-50"})]}),_.jsxs("div",{children:[_.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:"Hnh thc"}),_.jsxs("select",{name:"type",className:"w-full h-10 border rounded-md px-2 text-sm bg-gray-50 outline-none focus:ring-1 focus:ring-green-500 border-input",children:[_.jsx("option",{value:"Part-time",children:"Part-time"}),_.jsx("option",{value:"Full-time",children:"Full-time"}),_.jsx("option",{value:"Freelance",children:"Freelance"})]})]})]}),_.jsxs("div",{children:[_.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["M t cng vic & Yu cu ",_.jsx("span",{className:"text-red-500",children:"*"})]}),_.jsx(yh,{name:"description",className:"bg-gray-50 min-h-[100px] text-sm leading-relaxed",placeholder:`- Thi gian lm vic...
- Yu cu...`,required:!0})]})]})]})}),_.jsxs("div",{className:"p-4 border-t bg-gray-50 rounded-b-2xl flex gap-3 sticky bottom-0 z-20",children:[_.jsx(pn,{type:"button",variant:"outline",className:"flex-1 border-gray-300",onClick:()=>l(!1),children:"Hy b"}),_.jsxs(pn,{type:"submit",form:"post-job-form",disabled:z,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold shadow-lg shadow-green-200",children:[z?_.jsx(ki,{className:"w-4 h-4 mr-2 animate-spin"}):_.jsx(xO,{className:"w-4 h-4 mr-2"}),"ng tin ngay"]})]})]})]})]})},ZJ=new d6,XJ=()=>{const t=Uv();return P.useEffect(()=>{window.gtag&&window.gtag("config","G-ZCMPN5RBRS",{page_path:t.pathname+t.search})},[t]),null},KJ=()=>_.jsx(h6,{client:ZJ,children:_.jsx(wV,{children:_.jsx(FF,{children:_.jsxs(S$,{children:[_.jsx(bz,{}),_.jsx(eB,{}),_.jsxs(vV,{children:[_.jsx(XJ,{}),_.jsxs(yV,{children:[_.jsx(Of,{path:"/",element:_.jsx($I,{})}),_.jsx(Of,{path:"/place/:id",element:_.jsx($I,{})}),_.jsx(Of,{path:"/about",element:_.jsx(PW,{})}),_.jsx(Of,{path:"/admin",element:_.jsx(HJ,{})}),_.jsx(Of,{path:"*",element:_.jsx(WJ,{})}),_.jsx(Of,{path:"/jobs",element:_.jsx(qJ,{})})]})]})]})})})});mm.createRoot(document.getElementById("root")).render(_.jsx(KJ,{}));
