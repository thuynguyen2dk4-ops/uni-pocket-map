function UI(t,e){for(var r=0;r<e.length;r++){const l=e[r];if(typeof l!="string"&&!Array.isArray(l)){for(const u in l)if(u!=="default"&&!(u in t)){const m=Object.getOwnPropertyDescriptor(l,u);m&&Object.defineProperty(t,u,m.get?m:{enumerable:!0,get:()=>l[u]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))l(u);new MutationObserver(u=>{for(const m of u)if(m.type==="childList")for(const v of m.addedNodes)v.tagName==="LINK"&&v.rel==="modulepreload"&&l(v)}).observe(document,{childList:!0,subtree:!0});function r(u){const m={};return u.integrity&&(m.integrity=u.integrity),u.referrerPolicy&&(m.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?m.credentials="include":u.crossOrigin==="anonymous"?m.credentials="omit":m.credentials="same-origin",m}function l(u){if(u.ep)return;u.ep=!0;const m=r(u);fetch(u.href,m)}})();function xb(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var i1={exports:{}},Jg={},s1={exports:{}},ur={};var WE;function tj(){if(WE)return ur;WE=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),l=Symbol.for("react.strict_mode"),u=Symbol.for("react.profiler"),m=Symbol.for("react.provider"),v=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),a=Symbol.for("react.suspense"),k=Symbol.for("react.memo"),M=Symbol.for("react.lazy"),L=Symbol.iterator;function z(he){return he===null||typeof he!="object"?null:(he=L&&he[L]||he["@@iterator"],typeof he=="function"?he:null)}var O={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},K=Object.assign,H={};function Z(he,Fe,it){this.props=he,this.context=Fe,this.refs=H,this.updater=it||O}Z.prototype.isReactComponent={},Z.prototype.setState=function(he,Fe){if(typeof he!="object"&&typeof he!="function"&&he!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,he,Fe,"setState")},Z.prototype.forceUpdate=function(he){this.updater.enqueueForceUpdate(this,he,"forceUpdate")};function Y(){}Y.prototype=Z.prototype;function ee(he,Fe,it){this.props=he,this.context=Fe,this.refs=H,this.updater=it||O}var ie=ee.prototype=new Y;ie.constructor=ee,K(ie,Z.prototype),ie.isPureReactComponent=!0;var pe=Array.isArray,we=Object.prototype.hasOwnProperty,ke={current:null},ze={key:!0,ref:!0,__self:!0,__source:!0};function Ge(he,Fe,it){var vt,Wt={},rn=null,wt=null;if(Fe!=null)for(vt in Fe.ref!==void 0&&(wt=Fe.ref),Fe.key!==void 0&&(rn=""+Fe.key),Fe)we.call(Fe,vt)&&!ze.hasOwnProperty(vt)&&(Wt[vt]=Fe[vt]);var Kt=arguments.length-2;if(Kt===1)Wt.children=it;else if(1<Kt){for(var Tn=Array(Kt),fn=0;fn<Kt;fn++)Tn[fn]=arguments[fn+2];Wt.children=Tn}if(he&&he.defaultProps)for(vt in Kt=he.defaultProps,Kt)Wt[vt]===void 0&&(Wt[vt]=Kt[vt]);return{$$typeof:t,type:he,key:rn,ref:wt,props:Wt,_owner:ke.current}}function tt(he,Fe){return{$$typeof:t,type:he.type,key:Fe,ref:he.ref,props:he.props,_owner:he._owner}}function Pe(he){return typeof he=="object"&&he!==null&&he.$$typeof===t}function ot(he){var Fe={"=":"=0",":":"=2"};return"$"+he.replace(/[=:]/g,function(it){return Fe[it]})}var ut=/\/+/g;function gt(he,Fe){return typeof he=="object"&&he!==null&&he.key!=null?ot(""+he.key):Fe.toString(36)}function ht(he,Fe,it,vt,Wt){var rn=typeof he;(rn==="undefined"||rn==="boolean")&&(he=null);var wt=!1;if(he===null)wt=!0;else switch(rn){case"string":case"number":wt=!0;break;case"object":switch(he.$$typeof){case t:case e:wt=!0}}if(wt)return wt=he,Wt=Wt(wt),he=vt===""?"."+gt(wt,0):vt,pe(Wt)?(it="",he!=null&&(it=he.replace(ut,"$&/")+"/"),ht(Wt,Fe,it,"",function(fn){return fn})):Wt!=null&&(Pe(Wt)&&(Wt=tt(Wt,it+(!Wt.key||wt&&wt.key===Wt.key?"":(""+Wt.key).replace(ut,"$&/")+"/")+he)),Fe.push(Wt)),1;if(wt=0,vt=vt===""?".":vt+":",pe(he))for(var Kt=0;Kt<he.length;Kt++){rn=he[Kt];var Tn=vt+gt(rn,Kt);wt+=ht(rn,Fe,it,Tn,Wt)}else if(Tn=z(he),typeof Tn=="function")for(he=Tn.call(he),Kt=0;!(rn=he.next()).done;)rn=rn.value,Tn=vt+gt(rn,Kt++),wt+=ht(rn,Fe,it,Tn,Wt);else if(rn==="object")throw Fe=String(he),Error("Objects are not valid as a React child (found: "+(Fe==="[object Object]"?"object with keys {"+Object.keys(he).join(", ")+"}":Fe)+"). If you meant to render a collection of children, use an array instead.");return wt}function Lt(he,Fe,it){if(he==null)return he;var vt=[],Wt=0;return ht(he,vt,"","",function(rn){return Fe.call(it,rn,Wt++)}),vt}function mt(he){if(he._status===-1){var Fe=he._result;Fe=Fe(),Fe.then(function(it){(he._status===0||he._status===-1)&&(he._status=1,he._result=it)},function(it){(he._status===0||he._status===-1)&&(he._status=2,he._result=it)}),he._status===-1&&(he._status=0,he._result=Fe)}if(he._status===1)return he._result.default;throw he._result}var pt={current:null},Ae={transition:null},xe={ReactCurrentDispatcher:pt,ReactCurrentBatchConfig:Ae,ReactCurrentOwner:ke};function We(){throw Error("act(...) is not supported in production builds of React.")}return ur.Children={map:Lt,forEach:function(he,Fe,it){Lt(he,function(){Fe.apply(this,arguments)},it)},count:function(he){var Fe=0;return Lt(he,function(){Fe++}),Fe},toArray:function(he){return Lt(he,function(Fe){return Fe})||[]},only:function(he){if(!Pe(he))throw Error("React.Children.only expected to receive a single React element child.");return he}},ur.Component=Z,ur.Fragment=r,ur.Profiler=u,ur.PureComponent=ee,ur.StrictMode=l,ur.Suspense=a,ur.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=xe,ur.act=We,ur.cloneElement=function(he,Fe,it){if(he==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+he+".");var vt=K({},he.props),Wt=he.key,rn=he.ref,wt=he._owner;if(Fe!=null){if(Fe.ref!==void 0&&(rn=Fe.ref,wt=ke.current),Fe.key!==void 0&&(Wt=""+Fe.key),he.type&&he.type.defaultProps)var Kt=he.type.defaultProps;for(Tn in Fe)we.call(Fe,Tn)&&!ze.hasOwnProperty(Tn)&&(vt[Tn]=Fe[Tn]===void 0&&Kt!==void 0?Kt[Tn]:Fe[Tn])}var Tn=arguments.length-2;if(Tn===1)vt.children=it;else if(1<Tn){Kt=Array(Tn);for(var fn=0;fn<Tn;fn++)Kt[fn]=arguments[fn+2];vt.children=Kt}return{$$typeof:t,type:he.type,key:Wt,ref:rn,props:vt,_owner:wt}},ur.createContext=function(he){return he={$$typeof:v,_currentValue:he,_currentValue2:he,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},he.Provider={$$typeof:m,_context:he},he.Consumer=he},ur.createElement=Ge,ur.createFactory=function(he){var Fe=Ge.bind(null,he);return Fe.type=he,Fe},ur.createRef=function(){return{current:null}},ur.forwardRef=function(he){return{$$typeof:b,render:he}},ur.isValidElement=Pe,ur.lazy=function(he){return{$$typeof:M,_payload:{_status:-1,_result:he},_init:mt}},ur.memo=function(he,Fe){return{$$typeof:k,type:he,compare:Fe===void 0?null:Fe}},ur.startTransition=function(he){var Fe=Ae.transition;Ae.transition={};try{he()}finally{Ae.transition=Fe}},ur.unstable_act=We,ur.useCallback=function(he,Fe){return pt.current.useCallback(he,Fe)},ur.useContext=function(he){return pt.current.useContext(he)},ur.useDebugValue=function(){},ur.useDeferredValue=function(he){return pt.current.useDeferredValue(he)},ur.useEffect=function(he,Fe){return pt.current.useEffect(he,Fe)},ur.useId=function(){return pt.current.useId()},ur.useImperativeHandle=function(he,Fe,it){return pt.current.useImperativeHandle(he,Fe,it)},ur.useInsertionEffect=function(he,Fe){return pt.current.useInsertionEffect(he,Fe)},ur.useLayoutEffect=function(he,Fe){return pt.current.useLayoutEffect(he,Fe)},ur.useMemo=function(he,Fe){return pt.current.useMemo(he,Fe)},ur.useReducer=function(he,Fe,it){return pt.current.useReducer(he,Fe,it)},ur.useRef=function(he){return pt.current.useRef(he)},ur.useState=function(he){return pt.current.useState(he)},ur.useSyncExternalStore=function(he,Fe,it){return pt.current.useSyncExternalStore(he,Fe,it)},ur.useTransition=function(){return pt.current.useTransition()},ur.version="18.3.1",ur}var qE;function xv(){return qE||(qE=1,s1.exports=tj()),s1.exports}var ZE;function nj(){if(ZE)return Jg;ZE=1;var t=xv(),e=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,u=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,m={key:!0,ref:!0,__self:!0,__source:!0};function v(b,a,k){var M,L={},z=null,O=null;k!==void 0&&(z=""+k),a.key!==void 0&&(z=""+a.key),a.ref!==void 0&&(O=a.ref);for(M in a)l.call(a,M)&&!m.hasOwnProperty(M)&&(L[M]=a[M]);if(b&&b.defaultProps)for(M in a=b.defaultProps,a)L[M]===void 0&&(L[M]=a[M]);return{$$typeof:e,type:b,key:z,ref:O,props:L,_owner:u.current}}return Jg.Fragment=r,Jg.jsx=v,Jg.jsxs=v,Jg}var XE;function rj(){return XE||(XE=1,i1.exports=nj()),i1.exports}var x=rj(),nx={},o1={exports:{}},ta={},a1={exports:{}},l1={};var KE;function ij(){return KE||(KE=1,(function(t){function e(Ae,xe){var We=Ae.length;Ae.push(xe);e:for(;0<We;){var he=We-1>>>1,Fe=Ae[he];if(0<u(Fe,xe))Ae[he]=xe,Ae[We]=Fe,We=he;else break e}}function r(Ae){return Ae.length===0?null:Ae[0]}function l(Ae){if(Ae.length===0)return null;var xe=Ae[0],We=Ae.pop();if(We!==xe){Ae[0]=We;e:for(var he=0,Fe=Ae.length,it=Fe>>>1;he<it;){var vt=2*(he+1)-1,Wt=Ae[vt],rn=vt+1,wt=Ae[rn];if(0>u(Wt,We))rn<Fe&&0>u(wt,Wt)?(Ae[he]=wt,Ae[rn]=We,he=rn):(Ae[he]=Wt,Ae[vt]=We,he=vt);else if(rn<Fe&&0>u(wt,We))Ae[he]=wt,Ae[rn]=We,he=rn;else break e}}return xe}function u(Ae,xe){var We=Ae.sortIndex-xe.sortIndex;return We!==0?We:Ae.id-xe.id}if(typeof performance=="object"&&typeof performance.now=="function"){var m=performance;t.unstable_now=function(){return m.now()}}else{var v=Date,b=v.now();t.unstable_now=function(){return v.now()-b}}var a=[],k=[],M=1,L=null,z=3,O=!1,K=!1,H=!1,Z=typeof setTimeout=="function"?setTimeout:null,Y=typeof clearTimeout=="function"?clearTimeout:null,ee=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function ie(Ae){for(var xe=r(k);xe!==null;){if(xe.callback===null)l(k);else if(xe.startTime<=Ae)l(k),xe.sortIndex=xe.expirationTime,e(a,xe);else break;xe=r(k)}}function pe(Ae){if(H=!1,ie(Ae),!K)if(r(a)!==null)K=!0,mt(we);else{var xe=r(k);xe!==null&&pt(pe,xe.startTime-Ae)}}function we(Ae,xe){K=!1,H&&(H=!1,Y(Ge),Ge=-1),O=!0;var We=z;try{for(ie(xe),L=r(a);L!==null&&(!(L.expirationTime>xe)||Ae&&!ot());){var he=L.callback;if(typeof he=="function"){L.callback=null,z=L.priorityLevel;var Fe=he(L.expirationTime<=xe);xe=t.unstable_now(),typeof Fe=="function"?L.callback=Fe:L===r(a)&&l(a),ie(xe)}else l(a);L=r(a)}if(L!==null)var it=!0;else{var vt=r(k);vt!==null&&pt(pe,vt.startTime-xe),it=!1}return it}finally{L=null,z=We,O=!1}}var ke=!1,ze=null,Ge=-1,tt=5,Pe=-1;function ot(){return!(t.unstable_now()-Pe<tt)}function ut(){if(ze!==null){var Ae=t.unstable_now();Pe=Ae;var xe=!0;try{xe=ze(!0,Ae)}finally{xe?gt():(ke=!1,ze=null)}}else ke=!1}var gt;if(typeof ee=="function")gt=function(){ee(ut)};else if(typeof MessageChannel<"u"){var ht=new MessageChannel,Lt=ht.port2;ht.port1.onmessage=ut,gt=function(){Lt.postMessage(null)}}else gt=function(){Z(ut,0)};function mt(Ae){ze=Ae,ke||(ke=!0,gt())}function pt(Ae,xe){Ge=Z(function(){Ae(t.unstable_now())},xe)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(Ae){Ae.callback=null},t.unstable_continueExecution=function(){K||O||(K=!0,mt(we))},t.unstable_forceFrameRate=function(Ae){0>Ae||125<Ae?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):tt=0<Ae?Math.floor(1e3/Ae):5},t.unstable_getCurrentPriorityLevel=function(){return z},t.unstable_getFirstCallbackNode=function(){return r(a)},t.unstable_next=function(Ae){switch(z){case 1:case 2:case 3:var xe=3;break;default:xe=z}var We=z;z=xe;try{return Ae()}finally{z=We}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(Ae,xe){switch(Ae){case 1:case 2:case 3:case 4:case 5:break;default:Ae=3}var We=z;z=Ae;try{return xe()}finally{z=We}},t.unstable_scheduleCallback=function(Ae,xe,We){var he=t.unstable_now();switch(typeof We=="object"&&We!==null?(We=We.delay,We=typeof We=="number"&&0<We?he+We:he):We=he,Ae){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=We+Fe,Ae={id:M++,callback:xe,priorityLevel:Ae,startTime:We,expirationTime:Fe,sortIndex:-1},We>he?(Ae.sortIndex=We,e(k,Ae),r(a)===null&&Ae===r(k)&&(H?(Y(Ge),Ge=-1):H=!0,pt(pe,We-he))):(Ae.sortIndex=Fe,e(a,Ae),K||O||(K=!0,mt(we))),Ae},t.unstable_shouldYield=ot,t.unstable_wrapCallback=function(Ae){var xe=z;return function(){var We=z;z=xe;try{return Ae.apply(this,arguments)}finally{z=We}}}})(l1)),l1}var YE;function sj(){return YE||(YE=1,a1.exports=ij()),a1.exports}var JE;function oj(){if(JE)return ta;JE=1;var t=xv(),e=sj();function r(d){for(var p="https://reactjs.org/docs/error-decoder.html?invariant="+d,S=1;S<arguments.length;S++)p+="&args[]="+encodeURIComponent(arguments[S]);return"Minified React error #"+d+"; visit "+p+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,u={};function m(d,p){v(d,p),v(d+"Capture",p)}function v(d,p){for(u[d]=p,d=0;d<p.length;d++)l.add(p[d])}var b=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),a=Object.prototype.hasOwnProperty,k=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,M={},L={};function z(d){return a.call(L,d)?!0:a.call(M,d)?!1:k.test(d)?L[d]=!0:(M[d]=!0,!1)}function O(d,p,S,R){if(S!==null&&S.type===0)return!1;switch(typeof p){case"function":case"symbol":return!0;case"boolean":return R?!1:S!==null?!S.acceptsBooleans:(d=d.toLowerCase().slice(0,5),d!=="data-"&&d!=="aria-");default:return!1}}function K(d,p,S,R){if(p===null||typeof p>"u"||O(d,p,S,R))return!0;if(R)return!1;if(S!==null)switch(S.type){case 3:return!p;case 4:return p===!1;case 5:return isNaN(p);case 6:return isNaN(p)||1>p}return!1}function H(d,p,S,R,F,W,se){this.acceptsBooleans=p===2||p===3||p===4,this.attributeName=R,this.attributeNamespace=F,this.mustUseProperty=S,this.propertyName=d,this.type=p,this.sanitizeURL=W,this.removeEmptyString=se}var Z={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(d){Z[d]=new H(d,0,!1,d,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(d){var p=d[0];Z[p]=new H(p,1,!1,d[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(d){Z[d]=new H(d,2,!1,d.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(d){Z[d]=new H(d,2,!1,d,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(d){Z[d]=new H(d,3,!1,d.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(d){Z[d]=new H(d,3,!0,d,null,!1,!1)}),["capture","download"].forEach(function(d){Z[d]=new H(d,4,!1,d,null,!1,!1)}),["cols","rows","size","span"].forEach(function(d){Z[d]=new H(d,6,!1,d,null,!1,!1)}),["rowSpan","start"].forEach(function(d){Z[d]=new H(d,5,!1,d.toLowerCase(),null,!1,!1)});var Y=/[\-:]([a-z])/g;function ee(d){return d[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(d){var p=d.replace(Y,ee);Z[p]=new H(p,1,!1,d,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(d){Z[d]=new H(d,1,!1,d.toLowerCase(),null,!1,!1)}),Z.xlinkHref=new H("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(d){Z[d]=new H(d,1,!1,d.toLowerCase(),null,!0,!0)});function ie(d,p,S,R){var F=Z.hasOwnProperty(p)?Z[p]:null;(F!==null?F.type!==0:R||!(2<p.length)||p[0]!=="o"&&p[0]!=="O"||p[1]!=="n"&&p[1]!=="N")&&(K(p,S,F,R)&&(S=null),R||F===null?z(p)&&(S===null?d.removeAttribute(p):d.setAttribute(p,""+S)):F.mustUseProperty?d[F.propertyName]=S===null?F.type===3?!1:"":S:(p=F.attributeName,R=F.attributeNamespace,S===null?d.removeAttribute(p):(F=F.type,S=F===3||F===4&&S===!0?"":""+S,R?d.setAttributeNS(R,p,S):d.setAttribute(p,S))))}var pe=t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,we=Symbol.for("react.element"),ke=Symbol.for("react.portal"),ze=Symbol.for("react.fragment"),Ge=Symbol.for("react.strict_mode"),tt=Symbol.for("react.profiler"),Pe=Symbol.for("react.provider"),ot=Symbol.for("react.context"),ut=Symbol.for("react.forward_ref"),gt=Symbol.for("react.suspense"),ht=Symbol.for("react.suspense_list"),Lt=Symbol.for("react.memo"),mt=Symbol.for("react.lazy"),pt=Symbol.for("react.offscreen"),Ae=Symbol.iterator;function xe(d){return d===null||typeof d!="object"?null:(d=Ae&&d[Ae]||d["@@iterator"],typeof d=="function"?d:null)}var We=Object.assign,he;function Fe(d){if(he===void 0)try{throw Error()}catch(S){var p=S.stack.trim().match(/\n( *(at )?)/);he=p&&p[1]||""}return`
`+he+d}var it=!1;function vt(d,p){if(!d||it)return"";it=!0;var S=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(p)if(p=function(){throw Error()},Object.defineProperty(p.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(p,[])}catch(st){var R=st}Reflect.construct(d,[],p)}else{try{p.call()}catch(st){R=st}d.call(p.prototype)}else{try{throw Error()}catch(st){R=st}d()}}catch(st){if(st&&R&&typeof st.stack=="string"){for(var F=st.stack.split(`
`),W=R.stack.split(`
`),se=F.length-1,Ie=W.length-1;1<=se&&0<=Ie&&F[se]!==W[Ie];)Ie--;for(;1<=se&&0<=Ie;se--,Ie--)if(F[se]!==W[Ie]){if(se!==1||Ie!==1)do if(se--,Ie--,0>Ie||F[se]!==W[Ie]){var Ve=`
`+F[se].replace(" at new "," at ");return d.displayName&&Ve.includes("<anonymous>")&&(Ve=Ve.replace("<anonymous>",d.displayName)),Ve}while(1<=se&&0<=Ie);break}}}finally{it=!1,Error.prepareStackTrace=S}return(d=d?d.displayName||d.name:"")?Fe(d):""}function Wt(d){switch(d.tag){case 5:return Fe(d.type);case 16:return Fe("Lazy");case 13:return Fe("Suspense");case 19:return Fe("SuspenseList");case 0:case 2:case 15:return d=vt(d.type,!1),d;case 11:return d=vt(d.type.render,!1),d;case 1:return d=vt(d.type,!0),d;default:return""}}function rn(d){if(d==null)return null;if(typeof d=="function")return d.displayName||d.name||null;if(typeof d=="string")return d;switch(d){case ze:return"Fragment";case ke:return"Portal";case tt:return"Profiler";case Ge:return"StrictMode";case gt:return"Suspense";case ht:return"SuspenseList"}if(typeof d=="object")switch(d.$$typeof){case ot:return(d.displayName||"Context")+".Consumer";case Pe:return(d._context.displayName||"Context")+".Provider";case ut:var p=d.render;return d=d.displayName,d||(d=p.displayName||p.name||"",d=d!==""?"ForwardRef("+d+")":"ForwardRef"),d;case Lt:return p=d.displayName||null,p!==null?p:rn(d.type)||"Memo";case mt:p=d._payload,d=d._init;try{return rn(d(p))}catch{}}return null}function wt(d){var p=d.type;switch(d.tag){case 24:return"Cache";case 9:return(p.displayName||"Context")+".Consumer";case 10:return(p._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return d=p.render,d=d.displayName||d.name||"",p.displayName||(d!==""?"ForwardRef("+d+")":"ForwardRef");case 7:return"Fragment";case 5:return p;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return rn(p);case 8:return p===Ge?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof p=="function")return p.displayName||p.name||null;if(typeof p=="string")return p}return null}function Kt(d){switch(typeof d){case"boolean":case"number":case"string":case"undefined":return d;case"object":return d;default:return""}}function Tn(d){var p=d.type;return(d=d.nodeName)&&d.toLowerCase()==="input"&&(p==="checkbox"||p==="radio")}function fn(d){var p=Tn(d)?"checked":"value",S=Object.getOwnPropertyDescriptor(d.constructor.prototype,p),R=""+d[p];if(!d.hasOwnProperty(p)&&typeof S<"u"&&typeof S.get=="function"&&typeof S.set=="function"){var F=S.get,W=S.set;return Object.defineProperty(d,p,{configurable:!0,get:function(){return F.call(this)},set:function(se){R=""+se,W.call(this,se)}}),Object.defineProperty(d,p,{enumerable:S.enumerable}),{getValue:function(){return R},setValue:function(se){R=""+se},stopTracking:function(){d._valueTracker=null,delete d[p]}}}}function Cn(d){d._valueTracker||(d._valueTracker=fn(d))}function tn(d){if(!d)return!1;var p=d._valueTracker;if(!p)return!0;var S=p.getValue(),R="";return d&&(R=Tn(d)?d.checked?"true":"false":d.value),d=R,d!==S?(p.setValue(d),!0):!1}function mr(d){if(d=d||(typeof document<"u"?document:void 0),typeof d>"u")return null;try{return d.activeElement||d.body}catch{return d.body}}function hr(d,p){var S=p.checked;return We({},p,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:S??d._wrapperState.initialChecked})}function _i(d,p){var S=p.defaultValue==null?"":p.defaultValue,R=p.checked!=null?p.checked:p.defaultChecked;S=Kt(p.value!=null?p.value:S),d._wrapperState={initialChecked:R,initialValue:S,controlled:p.type==="checkbox"||p.type==="radio"?p.checked!=null:p.value!=null}}function Xn(d,p){p=p.checked,p!=null&&ie(d,"checked",p,!1)}function Er(d,p){Xn(d,p);var S=Kt(p.value),R=p.type;if(S!=null)R==="number"?(S===0&&d.value===""||d.value!=S)&&(d.value=""+S):d.value!==""+S&&(d.value=""+S);else if(R==="submit"||R==="reset"){d.removeAttribute("value");return}p.hasOwnProperty("value")?xi(d,p.type,S):p.hasOwnProperty("defaultValue")&&xi(d,p.type,Kt(p.defaultValue)),p.checked==null&&p.defaultChecked!=null&&(d.defaultChecked=!!p.defaultChecked)}function Xs(d,p,S){if(p.hasOwnProperty("value")||p.hasOwnProperty("defaultValue")){var R=p.type;if(!(R!=="submit"&&R!=="reset"||p.value!==void 0&&p.value!==null))return;p=""+d._wrapperState.initialValue,S||p===d.value||(d.value=p),d.defaultValue=p}S=d.name,S!==""&&(d.name=""),d.defaultChecked=!!d._wrapperState.initialChecked,S!==""&&(d.name=S)}function xi(d,p,S){(p!=="number"||mr(d.ownerDocument)!==d)&&(S==null?d.defaultValue=""+d._wrapperState.initialValue:d.defaultValue!==""+S&&(d.defaultValue=""+S))}var Zr=Array.isArray;function ni(d,p,S,R){if(d=d.options,p){p={};for(var F=0;F<S.length;F++)p["$"+S[F]]=!0;for(S=0;S<d.length;S++)F=p.hasOwnProperty("$"+d[S].value),d[S].selected!==F&&(d[S].selected=F),F&&R&&(d[S].defaultSelected=!0)}else{for(S=""+Kt(S),p=null,F=0;F<d.length;F++){if(d[F].value===S){d[F].selected=!0,R&&(d[F].defaultSelected=!0);return}p!==null||d[F].disabled||(p=d[F])}p!==null&&(p.selected=!0)}}function rs(d,p){if(p.dangerouslySetInnerHTML!=null)throw Error(r(91));return We({},p,{value:void 0,defaultValue:void 0,children:""+d._wrapperState.initialValue})}function Wi(d,p){var S=p.value;if(S==null){if(S=p.children,p=p.defaultValue,S!=null){if(p!=null)throw Error(r(92));if(Zr(S)){if(1<S.length)throw Error(r(93));S=S[0]}p=S}p==null&&(p=""),S=p}d._wrapperState={initialValue:Kt(S)}}function Ms(d,p){var S=Kt(p.value),R=Kt(p.defaultValue);S!=null&&(S=""+S,S!==d.value&&(d.value=S),p.defaultValue==null&&d.defaultValue!==S&&(d.defaultValue=S)),R!=null&&(d.defaultValue=""+R)}function _s(d){var p=d.textContent;p===d._wrapperState.initialValue&&p!==""&&p!==null&&(d.value=p)}function Vr(d){switch(d){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function is(d,p){return d==null||d==="http://www.w3.org/1999/xhtml"?Vr(p):d==="http://www.w3.org/2000/svg"&&p==="foreignObject"?"http://www.w3.org/1999/xhtml":d}var vi,Ps=(function(d){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(p,S,R,F){MSApp.execUnsafeLocalFunction(function(){return d(p,S,R,F)})}:d})(function(d,p){if(d.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in d)d.innerHTML=p;else{for(vi=vi||document.createElement("div"),vi.innerHTML="<svg>"+p.valueOf().toString()+"</svg>",p=vi.firstChild;d.firstChild;)d.removeChild(d.firstChild);for(;p.firstChild;)d.appendChild(p.firstChild)}});function qi(d,p){if(p){var S=d.firstChild;if(S&&S===d.lastChild&&S.nodeType===3){S.nodeValue=p;return}}d.textContent=p}var ki={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},yo=["Webkit","ms","Moz","O"];Object.keys(ki).forEach(function(d){yo.forEach(function(p){p=p+d.charAt(0).toUpperCase()+d.substring(1),ki[p]=ki[d]})});function Ks(d,p,S){return p==null||typeof p=="boolean"||p===""?"":S||typeof p!="number"||p===0||ki.hasOwnProperty(d)&&ki[d]?(""+p).trim():p+"px"}function Ai(d,p){d=d.style;for(var S in p)if(p.hasOwnProperty(S)){var R=S.indexOf("--")===0,F=Ks(S,p[S],R);S==="float"&&(S="cssFloat"),R?d.setProperty(S,F):d[S]=F}}var ss=We({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ri(d,p){if(p){if(ss[d]&&(p.children!=null||p.dangerouslySetInnerHTML!=null))throw Error(r(137,d));if(p.dangerouslySetInnerHTML!=null){if(p.children!=null)throw Error(r(60));if(typeof p.dangerouslySetInnerHTML!="object"||!("__html"in p.dangerouslySetInnerHTML))throw Error(r(61))}if(p.style!=null&&typeof p.style!="object")throw Error(r(62))}}function Rs(d,p){if(d.indexOf("-")===-1)return typeof p.is=="string";switch(d){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ys=null;function _o(d){return d=d.target||d.srcElement||window,d.correspondingUseElement&&(d=d.correspondingUseElement),d.nodeType===3?d.parentNode:d}var Te=null,ne=null,re=null;function ue(d){if(d=xc(d)){if(typeof Te!="function")throw Error(r(280));var p=d.stateNode;p&&(p=wd(p),Te(d.stateNode,d.type,p))}}function Se(d){ne?re?re.push(d):re=[d]:ne=d}function be(){if(ne){var d=ne,p=re;if(re=ne=null,ue(d),p)for(d=0;d<p.length;d++)ue(p[d])}}function Oe(d,p){return d(p)}function Be(){}var je=!1;function Ze(d,p,S){if(je)return d(p,S);je=!0;try{return Oe(d,p,S)}finally{je=!1,(ne!==null||re!==null)&&(Be(),be())}}function St(d,p){var S=d.stateNode;if(S===null)return null;var R=wd(S);if(R===null)return null;S=R[p];e:switch(p){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(R=!R.disabled)||(d=d.type,R=!(d==="button"||d==="input"||d==="select"||d==="textarea")),d=!R;break e;default:d=!1}if(d)return null;if(S&&typeof S!="function")throw Error(r(231,p,typeof S));return S}var Rt=!1;if(b)try{var bt={};Object.defineProperty(bt,"passive",{get:function(){Rt=!0}}),window.addEventListener("test",bt,bt),window.removeEventListener("test",bt,bt)}catch{Rt=!1}function vn(d,p,S,R,F,W,se,Ie,Ve){var st=Array.prototype.slice.call(arguments,3);try{p.apply(S,st)}catch(Dt){this.onError(Dt)}}var An=!1,kn=null,Pn=!1,$n=null,jr={onError:function(d){An=!0,kn=d}};function ii(d,p,S,R,F,W,se,Ie,Ve){An=!1,kn=null,vn.apply(jr,arguments)}function Zi(d,p,S,R,F,W,se,Ie,Ve){if(ii.apply(this,arguments),An){if(An){var st=kn;An=!1,kn=null}else throw Error(r(198));Pn||(Pn=!0,$n=st)}}function Rr(d){var p=d,S=d;if(d.alternate)for(;p.return;)p=p.return;else{d=p;do p=d,(p.flags&4098)!==0&&(S=p.return),d=p.return;while(d)}return p.tag===3?S:null}function xo(d){if(d.tag===13){var p=d.memoizedState;if(p===null&&(d=d.alternate,d!==null&&(p=d.memoizedState)),p!==null)return p.dehydrated}return null}function wi(d){if(Rr(d)!==d)throw Error(r(188))}function os(d){var p=d.alternate;if(!p){if(p=Rr(d),p===null)throw Error(r(188));return p!==d?null:d}for(var S=d,R=p;;){var F=S.return;if(F===null)break;var W=F.alternate;if(W===null){if(R=F.return,R!==null){S=R;continue}break}if(F.child===W.child){for(W=F.child;W;){if(W===S)return wi(F),d;if(W===R)return wi(F),p;W=W.sibling}throw Error(r(188))}if(S.return!==R.return)S=F,R=W;else{for(var se=!1,Ie=F.child;Ie;){if(Ie===S){se=!0,S=F,R=W;break}if(Ie===R){se=!0,R=F,S=W;break}Ie=Ie.sibling}if(!se){for(Ie=W.child;Ie;){if(Ie===S){se=!0,S=W,R=F;break}if(Ie===R){se=!0,R=W,S=F;break}Ie=Ie.sibling}if(!se)throw Error(r(189))}}if(S.alternate!==R)throw Error(r(190))}if(S.tag!==3)throw Error(r(188));return S.stateNode.current===S?d:p}function ll(d){return d=os(d),d!==null?up(d):null}function up(d){if(d.tag===5||d.tag===6)return d;for(d=d.child;d!==null;){var p=up(d);if(p!==null)return p;d=d.sibling}return null}var Ch=e.unstable_scheduleCallback,nr=e.unstable_cancelCallback,kh=e.unstable_shouldYield,Qc=e.unstable_requestPaint,Ur=e.unstable_now,nd=e.unstable_getCurrentPriorityLevel,Js=e.unstable_ImmediatePriority,Bo=e.unstable_UserBlockingPriority,Zl=e.unstable_NormalPriority,Ah=e.unstable_LowPriority,ka=e.unstable_IdlePriority,Qs=null,xs=null;function dt(d){if(xs&&typeof xs.onCommitFiberRoot=="function")try{xs.onCommitFiberRoot(Qs,d,void 0,(d.current.flags&128)===128)}catch{}}var bi=Math.clz32?Math.clz32:dp,si=Math.log,Ii=Math.LN2;function dp(d){return d>>>=0,d===0?32:31-(si(d)/Ii|0)|0}var Ns=64,Xl=4194304;function Kl(d){switch(d&-d){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return d&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return d&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return d}}function ia(d,p){var S=d.pendingLanes;if(S===0)return 0;var R=0,F=d.suspendedLanes,W=d.pingedLanes,se=S&268435455;if(se!==0){var Ie=se&~F;Ie!==0?R=Kl(Ie):(W&=se,W!==0&&(R=Kl(W)))}else se=S&~F,se!==0?R=Kl(se):W!==0&&(R=Kl(W));if(R===0)return 0;if(p!==0&&p!==R&&(p&F)===0&&(F=R&-R,W=p&-p,F>=W||F===16&&(W&4194240)!==0))return p;if((R&4)!==0&&(R|=S&16),p=d.entangledLanes,p!==0)for(d=d.entanglements,p&=R;0<p;)S=31-bi(p),F=1<<S,R|=d[S],p&=~F;return R}function Ut(d,p){switch(d){case 1:case 2:case 4:return p+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Hn(d,p){for(var S=d.suspendedLanes,R=d.pingedLanes,F=d.expirationTimes,W=d.pendingLanes;0<W;){var se=31-bi(W),Ie=1<<se,Ve=F[se];Ve===-1?((Ie&S)===0||(Ie&R)!==0)&&(F[se]=Ut(Ie,p)):Ve<=p&&(d.expiredLanes|=Ie),W&=~Ie}}function Bn(d){return d=d.pendingLanes&-1073741825,d!==0?d:d&1073741824?1073741824:0}function vs(){var d=Ns;return Ns<<=1,(Ns&4194240)===0&&(Ns=64),d}function Ds(d){for(var p=[],S=0;31>S;S++)p.push(d);return p}function Rn(d,p,S){d.pendingLanes|=p,p!==536870912&&(d.suspendedLanes=0,d.pingedLanes=0),d=d.eventTimes,p=31-bi(p),d[p]=S}function Ls(d,p){var S=d.pendingLanes&~p;d.pendingLanes=p,d.suspendedLanes=0,d.pingedLanes=0,d.expiredLanes&=p,d.mutableReadLanes&=p,d.entangledLanes&=p,p=d.entanglements;var R=d.eventTimes;for(d=d.expirationTimes;0<S;){var F=31-bi(S),W=1<<F;p[F]=0,R[F]=-1,d[F]=-1,S&=~W}}function cl(d,p){var S=d.entangledLanes|=p;for(d=d.entanglements;S;){var R=31-bi(S),F=1<<R;F&p|d[R]&p&&(d[R]|=p),S&=~F}}var rr=0;function js(d){return d&=-d,1<d?4<d?(d&268435455)!==0?16:536870912:4:1}var Cr,rd,Fo,Yl,Jl,eu=!1,tu=[],eo=null,to=null,vo=null,Vo=new Map,Mi=new Map,_r=[],Ih="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function id(d,p){switch(d){case"focusin":case"focusout":eo=null;break;case"dragenter":case"dragleave":to=null;break;case"mouseover":case"mouseout":vo=null;break;case"pointerover":case"pointerout":Vo.delete(p.pointerId);break;case"gotpointercapture":case"lostpointercapture":Mi.delete(p.pointerId)}}function Pi(d,p,S,R,F,W){return d===null||d.nativeEvent!==W?(d={blockedOn:p,domEventName:S,eventSystemFlags:R,nativeEvent:W,targetContainers:[F]},p!==null&&(p=xc(p),p!==null&&rd(p)),d):(d.eventSystemFlags|=R,p=d.targetContainers,F!==null&&p.indexOf(F)===-1&&p.push(F),d)}function no(d,p,S,R,F){switch(p){case"focusin":return eo=Pi(eo,d,p,S,R,F),!0;case"dragenter":return to=Pi(to,d,p,S,R,F),!0;case"mouseover":return vo=Pi(vo,d,p,S,R,F),!0;case"pointerover":var W=F.pointerId;return Vo.set(W,Pi(Vo.get(W)||null,d,p,S,R,F)),!0;case"gotpointercapture":return W=F.pointerId,Mi.set(W,Pi(Mi.get(W)||null,d,p,S,R,F)),!0}return!1}function Mh(d){var p=Es(d.target);if(p!==null){var S=Rr(p);if(S!==null){if(p=S.tag,p===13){if(p=xo(S),p!==null){d.blockedOn=p,Jl(d.priority,function(){Fo(S)});return}}else if(p===3&&S.stateNode.current.memoizedState.isDehydrated){d.blockedOn=S.tag===3?S.stateNode.containerInfo:null;return}}}d.blockedOn=null}function Aa(d){if(d.blockedOn!==null)return!1;for(var p=d.targetContainers;0<p.length;){var S=Rh(d.domEventName,d.eventSystemFlags,p[0],d.nativeEvent);if(S===null){S=d.nativeEvent;var R=new S.constructor(S.type,S);Ys=R,S.target.dispatchEvent(R),Ys=null}else return p=xc(S),p!==null&&rd(p),d.blockedOn=S,!1;p.shift()}return!0}function Br(d,p,S){Aa(d)&&S.delete(p)}function nu(){eu=!1,eo!==null&&Aa(eo)&&(eo=null),to!==null&&Aa(to)&&(to=null),vo!==null&&Aa(vo)&&(vo=null),Vo.forEach(Br),Mi.forEach(Br)}function ul(d,p){d.blockedOn===p&&(d.blockedOn=null,eu||(eu=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,nu)))}function wo(d){function p(F){return ul(F,d)}if(0<tu.length){ul(tu[0],d);for(var S=1;S<tu.length;S++){var R=tu[S];R.blockedOn===d&&(R.blockedOn=null)}}for(eo!==null&&ul(eo,d),to!==null&&ul(to,d),vo!==null&&ul(vo,d),Vo.forEach(p),Mi.forEach(p),S=0;S<_r.length;S++)R=_r[S],R.blockedOn===d&&(R.blockedOn=null);for(;0<_r.length&&(S=_r[0],S.blockedOn===null);)Mh(S),S.blockedOn===null&&_r.shift()}var Xr=pe.ReactCurrentBatchConfig,Ql=!0;function Ph(d,p,S,R){var F=rr,W=Xr.transition;Xr.transition=null;try{rr=1,Uo(d,p,S,R)}finally{rr=F,Xr.transition=W}}function sa(d,p,S,R){var F=rr,W=Xr.transition;Xr.transition=null;try{rr=4,Uo(d,p,S,R)}finally{rr=F,Xr.transition=W}}function Uo(d,p,S,R){if(Ql){var F=Rh(d,p,S,R);if(F===null)hc(d,p,R,dl,S),id(d,R);else if(no(F,d,p,S,R))R.stopPropagation();else if(id(d,R),p&4&&-1<Ih.indexOf(d)){for(;F!==null;){var W=xc(F);if(W!==null&&Cr(W),W=Rh(d,p,S,R),W===null&&hc(d,p,R,dl,S),W===F)break;F=W}F!==null&&R.stopPropagation()}else hc(d,p,R,null,S)}}var dl=null;function Rh(d,p,S,R){if(dl=null,d=_o(R),d=Es(d),d!==null)if(p=Rr(d),p===null)d=null;else if(S=p.tag,S===13){if(d=xo(p),d!==null)return d;d=null}else if(S===3){if(p.stateNode.current.memoizedState.isDehydrated)return p.tag===3?p.stateNode.containerInfo:null;d=null}else p!==d&&(d=null);return dl=d,null}function sd(d){switch(d){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(nd()){case Js:return 1;case Bo:return 4;case Zl:case Ah:return 16;case ka:return 536870912;default:return 16}default:return 16}}var Os=null,ro=null,ec=null;function Ia(){if(ec)return ec;var d,p=ro,S=p.length,R,F="value"in Os?Os.value:Os.textContent,W=F.length;for(d=0;d<S&&p[d]===F[d];d++);var se=S-d;for(R=1;R<=se&&p[S-R]===F[W-R];R++);return ec=F.slice(d,1<R?1-R:void 0)}function io(d){var p=d.keyCode;return"charCode"in d?(d=d.charCode,d===0&&p===13&&(d=13)):d=p,d===10&&(d=13),32<=d||d===13?d:0}function Ma(){return!0}function $o(){return!1}function Xi(d){function p(S,R,F,W,se){this._reactName=S,this._targetInst=F,this.type=R,this.nativeEvent=W,this.target=se,this.currentTarget=null;for(var Ie in d)d.hasOwnProperty(Ie)&&(S=d[Ie],this[Ie]=S?S(W):W[Ie]);return this.isDefaultPrevented=(W.defaultPrevented!=null?W.defaultPrevented:W.returnValue===!1)?Ma:$o,this.isPropagationStopped=$o,this}return We(p.prototype,{preventDefault:function(){this.defaultPrevented=!0;var S=this.nativeEvent;S&&(S.preventDefault?S.preventDefault():typeof S.returnValue!="unknown"&&(S.returnValue=!1),this.isDefaultPrevented=Ma)},stopPropagation:function(){var S=this.nativeEvent;S&&(S.stopPropagation?S.stopPropagation():typeof S.cancelBubble!="unknown"&&(S.cancelBubble=!0),this.isPropagationStopped=Ma)},persist:function(){},isPersistent:Ma}),p}var bo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(d){return d.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hl=Xi(bo),tc=We({},bo,{view:0,detail:0}),od=Xi(tc),ru,iu,Go,Yn=We({},tc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ou,button:0,buttons:0,relatedTarget:function(d){return d.relatedTarget===void 0?d.fromElement===d.srcElement?d.toElement:d.fromElement:d.relatedTarget},movementX:function(d){return"movementX"in d?d.movementX:(d!==Go&&(Go&&d.type==="mousemove"?(ru=d.screenX-Go.screenX,iu=d.screenY-Go.screenY):iu=ru=0,Go=d),ru)},movementY:function(d){return"movementY"in d?d.movementY:iu}}),hp=Xi(Yn),Nh=We({},Yn,{dataTransfer:0}),fp=Xi(Nh),Dh=We({},tc,{relatedTarget:0}),ad=Xi(Dh),Lh=We({},bo,{animationName:0,elapsedTime:0,pseudoElement:0}),nc=Xi(Lh),ld=We({},bo,{clipboardData:function(d){return"clipboardData"in d?d.clipboardData:window.clipboardData}}),rc=Xi(ld),oa=We({},bo,{data:0}),Pa=Xi(oa),cd={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},pp={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},su={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function jh(d){var p=this.nativeEvent;return p.getModifierState?p.getModifierState(d):(d=su[d])?!!p[d]:!1}function ou(){return jh}var ud=We({},tc,{key:function(d){if(d.key){var p=cd[d.key]||d.key;if(p!=="Unidentified")return p}return d.type==="keypress"?(d=io(d),d===13?"Enter":String.fromCharCode(d)):d.type==="keydown"||d.type==="keyup"?pp[d.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ou,charCode:function(d){return d.type==="keypress"?io(d):0},keyCode:function(d){return d.type==="keydown"||d.type==="keyup"?d.keyCode:0},which:function(d){return d.type==="keypress"?io(d):d.type==="keydown"||d.type==="keyup"?d.keyCode:0}}),dd=Xi(ud),Oh=We({},Yn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Kn=Xi(Oh),au=We({},tc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ou}),mp=Xi(au),zh=We({},bo,{propertyName:0,elapsedTime:0,pseudoElement:0}),gp=Xi(zh),fl=We({},Yn,{deltaX:function(d){return"deltaX"in d?d.deltaX:"wheelDeltaX"in d?-d.wheelDeltaX:0},deltaY:function(d){return"deltaY"in d?d.deltaY:"wheelDeltaY"in d?-d.wheelDeltaY:"wheelDelta"in d?-d.wheelDelta:0},deltaZ:0,deltaMode:0}),Bh=Xi(fl),ng=[9,13,27,32],Fh=b&&"CompositionEvent"in window,lu=null;b&&"documentMode"in document&&(lu=document.documentMode);var Vh=b&&"TextEvent"in window&&!lu,hd=b&&(!Fh||lu&&8<lu&&11>=lu),fd=" ",cu=!1;function Uh(d,p){switch(d){case"keyup":return ng.indexOf(p.keyCode)!==-1;case"keydown":return p.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function $h(d){return d=d.detail,typeof d=="object"&&"data"in d?d.data:null}var ic=!1;function uu(d,p){switch(d){case"compositionend":return $h(p);case"keypress":return p.which!==32?null:(cu=!0,fd);case"textInput":return d=p.data,d===fd&&cu?null:d;default:return null}}function sc(d,p){if(ic)return d==="compositionend"||!Fh&&Uh(d,p)?(d=Ia(),ec=ro=Os=null,ic=!1,d):null;switch(d){case"paste":return null;case"keypress":if(!(p.ctrlKey||p.altKey||p.metaKey)||p.ctrlKey&&p.altKey){if(p.char&&1<p.char.length)return p.char;if(p.which)return String.fromCharCode(p.which)}return null;case"compositionend":return hd&&p.locale!=="ko"?null:p.data;default:return null}}var Gh={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oc(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p==="input"?!!Gh[d.type]:p==="textarea"}function pd(d,p,S,R){Se(R),p=Ts(p,"onChange"),0<p.length&&(S=new hl("onChange","change",null,S,R),d.push({event:S,listeners:p}))}var ws=null,Ra=null;function Hh(d){_l(d,0)}function pl(d){var p=wl(d);if(tn(p))return d}function yp(d,p){if(d==="change")return p}var md=!1;if(b){var Wh;if(b){var du="oninput"in document;if(!du){var hu=document.createElement("div");hu.setAttribute("oninput","return;"),du=typeof hu.oninput=="function"}Wh=du}else Wh=!1;md=Wh&&(!document.documentMode||9<document.documentMode)}function ac(){ws&&(ws.detachEvent("onpropertychange",qh),Ra=ws=null)}function qh(d){if(d.propertyName==="value"&&pl(Ra)){var p=[];pd(p,Ra,d,_o(d)),Ze(Hh,p)}}function Zh(d,p,S){d==="focusin"?(ac(),ws=p,Ra=S,ws.attachEvent("onpropertychange",qh)):d==="focusout"&&ac()}function rg(d){if(d==="selectionchange"||d==="keyup"||d==="keydown")return pl(Ra)}function Xh(d,p){if(d==="click")return pl(p)}function _p(d,p){if(d==="input"||d==="change")return pl(p)}function fu(d,p){return d===p&&(d!==0||1/d===1/p)||d!==d&&p!==p}var so=typeof Object.is=="function"?Object.is:fu;function Na(d,p){if(so(d,p))return!0;if(typeof d!="object"||d===null||typeof p!="object"||p===null)return!1;var S=Object.keys(d),R=Object.keys(p);if(S.length!==R.length)return!1;for(R=0;R<S.length;R++){var F=S[R];if(!a.call(p,F)||!so(d[F],p[F]))return!1}return!0}function Kh(d){for(;d&&d.firstChild;)d=d.firstChild;return d}function ml(d,p){var S=Kh(d);d=0;for(var R;S;){if(S.nodeType===3){if(R=d+S.textContent.length,d<=p&&R>=p)return{node:S,offset:p-d};d=R}e:{for(;S;){if(S.nextSibling){S=S.nextSibling;break e}S=S.parentNode}S=void 0}S=Kh(S)}}function xp(d,p){return d&&p?d===p?!0:d&&d.nodeType===3?!1:p&&p.nodeType===3?xp(d,p.parentNode):"contains"in d?d.contains(p):d.compareDocumentPosition?!!(d.compareDocumentPosition(p)&16):!1:!1}function vp(){for(var d=window,p=mr();p instanceof d.HTMLIFrameElement;){try{var S=typeof p.contentWindow.location.href=="string"}catch{S=!1}if(S)d=p.contentWindow;else break;p=mr(d.document)}return p}function Yh(d){var p=d&&d.nodeName&&d.nodeName.toLowerCase();return p&&(p==="input"&&(d.type==="text"||d.type==="search"||d.type==="tel"||d.type==="url"||d.type==="password")||p==="textarea"||d.contentEditable==="true")}function ig(d){var p=vp(),S=d.focusedElem,R=d.selectionRange;if(p!==S&&S&&S.ownerDocument&&xp(S.ownerDocument.documentElement,S)){if(R!==null&&Yh(S)){if(p=R.start,d=R.end,d===void 0&&(d=p),"selectionStart"in S)S.selectionStart=p,S.selectionEnd=Math.min(d,S.value.length);else if(d=(p=S.ownerDocument||document)&&p.defaultView||window,d.getSelection){d=d.getSelection();var F=S.textContent.length,W=Math.min(R.start,F);R=R.end===void 0?W:Math.min(R.end,F),!d.extend&&W>R&&(F=R,R=W,W=F),F=ml(S,W);var se=ml(S,R);F&&se&&(d.rangeCount!==1||d.anchorNode!==F.node||d.anchorOffset!==F.offset||d.focusNode!==se.node||d.focusOffset!==se.offset)&&(p=p.createRange(),p.setStart(F.node,F.offset),d.removeAllRanges(),W>R?(d.addRange(p),d.extend(se.node,se.offset)):(p.setEnd(se.node,se.offset),d.addRange(p)))}}for(p=[],d=S;d=d.parentNode;)d.nodeType===1&&p.push({element:d,left:d.scrollLeft,top:d.scrollTop});for(typeof S.focus=="function"&&S.focus(),S=0;S<p.length;S++)d=p[S],d.element.scrollLeft=d.left,d.element.scrollTop=d.top}}var sg=b&&"documentMode"in document&&11>=document.documentMode,gl=null,lc=null,Ho=null,gd=!1;function Jh(d,p,S){var R=S.window===S?S.document:S.nodeType===9?S:S.ownerDocument;gd||gl==null||gl!==mr(R)||(R=gl,"selectionStart"in R&&Yh(R)?R={start:R.selectionStart,end:R.selectionEnd}:(R=(R.ownerDocument&&R.ownerDocument.defaultView||window).getSelection(),R={anchorNode:R.anchorNode,anchorOffset:R.anchorOffset,focusNode:R.focusNode,focusOffset:R.focusOffset}),Ho&&Na(Ho,R)||(Ho=R,R=Ts(lc,"onSelect"),0<R.length&&(p=new hl("onSelect","select",null,p,S),d.push({event:p,listeners:R}),p.target=gl)))}function oo(d,p){var S={};return S[d.toLowerCase()]=p.toLowerCase(),S["Webkit"+d]="webkit"+p,S["Moz"+d]="moz"+p,S}var aa={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionend:oo("Transition","TransitionEnd")},bs={},cc={};b&&(cc=document.createElement("div").style,"AnimationEvent"in window||(delete aa.animationend.animation,delete aa.animationiteration.animation,delete aa.animationstart.animation),"TransitionEvent"in window||delete aa.transitionend.transition);function pu(d){if(bs[d])return bs[d];if(!aa[d])return d;var p=aa[d],S;for(S in p)if(p.hasOwnProperty(S)&&S in cc)return bs[d]=p[S];return d}var Da=pu("animationend"),yl=pu("animationiteration"),mu=pu("animationstart"),gu=pu("transitionend"),Jn=new Map,uc="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function la(d,p){Jn.set(d,p),m(p,[d])}for(var dc=0;dc<uc.length;dc++){var La=uc[dc],wp=La.toLowerCase(),yd=La[0].toUpperCase()+La.slice(1);la(wp,"on"+yd)}la(Da,"onAnimationEnd"),la(yl,"onAnimationIteration"),la(mu,"onAnimationStart"),la("dblclick","onDoubleClick"),la("focusin","onFocus"),la("focusout","onBlur"),la(gu,"onTransitionEnd"),v("onMouseEnter",["mouseout","mouseover"]),v("onMouseLeave",["mouseout","mouseover"]),v("onPointerEnter",["pointerout","pointerover"]),v("onPointerLeave",["pointerout","pointerover"]),m("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),m("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),m("onBeforeInput",["compositionend","keypress","textInput","paste"]),m("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),m("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zs="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),bp=new Set("cancel close invalid load scroll toggle".split(" ").concat(zs));function yu(d,p,S){var R=d.type||"unknown-event";d.currentTarget=S,Zi(R,p,void 0,d),d.currentTarget=null}function _l(d,p){p=(p&4)!==0;for(var S=0;S<d.length;S++){var R=d[S],F=R.event;R=R.listeners;e:{var W=void 0;if(p)for(var se=R.length-1;0<=se;se--){var Ie=R[se],Ve=Ie.instance,st=Ie.currentTarget;if(Ie=Ie.listener,Ve!==W&&F.isPropagationStopped())break e;yu(F,Ie,st),W=Ve}else for(se=0;se<R.length;se++){if(Ie=R[se],Ve=Ie.instance,st=Ie.currentTarget,Ie=Ie.listener,Ve!==W&&F.isPropagationStopped())break e;yu(F,Ie,st),W=Ve}}}if(Pn)throw d=$n,Pn=!1,$n=null,d}function gr(d,p){var S=p[vd];S===void 0&&(S=p[vd]=new Set);var R=d+"__bubble";S.has(R)||(xu(p,d,2,!1),S.add(R))}function _u(d,p,S){var R=0;p&&(R|=4),xu(S,d,R,p)}var ja="_reactListening"+Math.random().toString(36).slice(2);function ca(d){if(!d[ja]){d[ja]=!0,l.forEach(function(S){S!=="selectionchange"&&(bp.has(S)||_u(S,!1,d),_u(S,!0,d))});var p=d.nodeType===9?d:d.ownerDocument;p===null||p[ja]||(p[ja]=!0,_u("selectionchange",!1,p))}}function xu(d,p,S,R){switch(sd(p)){case 1:var F=Ph;break;case 4:F=sa;break;default:F=Uo}S=F.bind(null,p,S,d),F=void 0,!Rt||p!=="touchstart"&&p!=="touchmove"&&p!=="wheel"||(F=!0),R?F!==void 0?d.addEventListener(p,S,{capture:!0,passive:F}):d.addEventListener(p,S,!0):F!==void 0?d.addEventListener(p,S,{passive:F}):d.addEventListener(p,S,!1)}function hc(d,p,S,R,F){var W=R;if((p&1)===0&&(p&2)===0&&R!==null)e:for(;;){if(R===null)return;var se=R.tag;if(se===3||se===4){var Ie=R.stateNode.containerInfo;if(Ie===F||Ie.nodeType===8&&Ie.parentNode===F)break;if(se===4)for(se=R.return;se!==null;){var Ve=se.tag;if((Ve===3||Ve===4)&&(Ve=se.stateNode.containerInfo,Ve===F||Ve.nodeType===8&&Ve.parentNode===F))return;se=se.return}for(;Ie!==null;){if(se=Es(Ie),se===null)return;if(Ve=se.tag,Ve===5||Ve===6){R=W=se;continue e}Ie=Ie.parentNode}}R=R.return}Ze(function(){var st=W,Dt=_o(S),jt=[];e:{var Mt=Jn.get(d);if(Mt!==void 0){var sn=hl,hn=d;switch(d){case"keypress":if(io(S)===0)break e;case"keydown":case"keyup":sn=dd;break;case"focusin":hn="focus",sn=ad;break;case"focusout":hn="blur",sn=ad;break;case"beforeblur":case"afterblur":sn=ad;break;case"click":if(S.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":sn=hp;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":sn=fp;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":sn=mp;break;case Da:case yl:case mu:sn=nc;break;case gu:sn=gp;break;case"scroll":sn=od;break;case"wheel":sn=Bh;break;case"copy":case"cut":case"paste":sn=rc;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":sn=Kn}var pn=(p&4)!==0,gi=!pn&&d==="scroll",et=pn?Mt!==null?Mt+"Capture":null:Mt;pn=[];for(var He=st,rt;He!==null;){rt=He;var Vt=rt.stateNode;if(rt.tag===5&&Vt!==null&&(rt=Vt,et!==null&&(Vt=St(He,et),Vt!=null&&pn.push(zt(He,Vt,rt)))),gi)break;He=He.return}0<pn.length&&(Mt=new sn(Mt,hn,null,S,Dt),jt.push({event:Mt,listeners:pn}))}}if((p&7)===0){e:{if(Mt=d==="mouseover"||d==="pointerover",sn=d==="mouseout"||d==="pointerout",Mt&&S!==Ys&&(hn=S.relatedTarget||S.fromElement)&&(Es(hn)||hn[To]))break e;if((sn||Mt)&&(Mt=Dt.window===Dt?Dt:(Mt=Dt.ownerDocument)?Mt.defaultView||Mt.parentWindow:window,sn?(hn=S.relatedTarget||S.toElement,sn=st,hn=hn?Es(hn):null,hn!==null&&(gi=Rr(hn),hn!==gi||hn.tag!==5&&hn.tag!==6)&&(hn=null)):(sn=null,hn=st),sn!==hn)){if(pn=hp,Vt="onMouseLeave",et="onMouseEnter",He="mouse",(d==="pointerout"||d==="pointerover")&&(pn=Kn,Vt="onPointerLeave",et="onPointerEnter",He="pointer"),gi=sn==null?Mt:wl(sn),rt=hn==null?Mt:wl(hn),Mt=new pn(Vt,He+"leave",sn,S,Dt),Mt.target=gi,Mt.relatedTarget=rt,Vt=null,Es(Dt)===st&&(pn=new pn(et,He+"enter",hn,S,Dt),pn.target=rt,pn.relatedTarget=gi,Vt=pn),gi=Vt,sn&&hn)t:{for(pn=sn,et=hn,He=0,rt=pn;rt;rt=xl(rt))He++;for(rt=0,Vt=et;Vt;Vt=xl(Vt))rt++;for(;0<He-rt;)pn=xl(pn),He--;for(;0<rt-He;)et=xl(et),rt--;for(;He--;){if(pn===et||et!==null&&pn===et.alternate)break t;pn=xl(pn),et=xl(et)}pn=null}else pn=null;sn!==null&&fc(jt,Mt,sn,pn,!1),hn!==null&&gi!==null&&fc(jt,gi,hn,pn,!0)}}e:{if(Mt=st?wl(st):window,sn=Mt.nodeName&&Mt.nodeName.toLowerCase(),sn==="select"||sn==="input"&&Mt.type==="file")var mn=yp;else if(oc(Mt))if(md)mn=_p;else{mn=rg;var Sn=Zh}else(sn=Mt.nodeName)&&sn.toLowerCase()==="input"&&(Mt.type==="checkbox"||Mt.type==="radio")&&(mn=Xh);if(mn&&(mn=mn(d,st))){pd(jt,mn,S,Dt);break e}Sn&&Sn(d,Mt,st),d==="focusout"&&(Sn=Mt._wrapperState)&&Sn.controlled&&Mt.type==="number"&&xi(Mt,"number",Mt.value)}switch(Sn=st?wl(st):window,d){case"focusin":(oc(Sn)||Sn.contentEditable==="true")&&(gl=Sn,lc=st,Ho=null);break;case"focusout":Ho=lc=gl=null;break;case"mousedown":gd=!0;break;case"contextmenu":case"mouseup":case"dragend":gd=!1,Jh(jt,S,Dt);break;case"selectionchange":if(sg)break;case"keydown":case"keyup":Jh(jt,S,Dt)}var En;if(Fh)e:{switch(d){case"compositionstart":var Vn="onCompositionStart";break e;case"compositionend":Vn="onCompositionEnd";break e;case"compositionupdate":Vn="onCompositionUpdate";break e}Vn=void 0}else ic?Uh(d,S)&&(Vn="onCompositionEnd"):d==="keydown"&&S.keyCode===229&&(Vn="onCompositionStart");Vn&&(hd&&S.locale!=="ko"&&(ic||Vn!=="onCompositionStart"?Vn==="onCompositionEnd"&&ic&&(En=Ia()):(Os=Dt,ro="value"in Os?Os.value:Os.textContent,ic=!0)),Sn=Ts(st,Vn),0<Sn.length&&(Vn=new Pa(Vn,d,null,S,Dt),jt.push({event:Vn,listeners:Sn}),En?Vn.data=En:(En=$h(S),En!==null&&(Vn.data=En)))),(En=Vh?uu(d,S):sc(d,S))&&(st=Ts(st,"onBeforeInput"),0<st.length&&(Dt=new Pa("onBeforeInput","beforeinput",null,S,Dt),jt.push({event:Dt,listeners:st}),Dt.data=En))}_l(jt,p)})}function zt(d,p,S){return{instance:d,listener:p,currentTarget:S}}function Ts(d,p){for(var S=p+"Capture",R=[];d!==null;){var F=d,W=F.stateNode;F.tag===5&&W!==null&&(F=W,W=St(d,S),W!=null&&R.unshift(zt(d,W,F)),W=St(d,p),W!=null&&R.push(zt(d,W,F))),d=d.return}return R}function xl(d){if(d===null)return null;do d=d.return;while(d&&d.tag!==5);return d||null}function fc(d,p,S,R,F){for(var W=p._reactName,se=[];S!==null&&S!==R;){var Ie=S,Ve=Ie.alternate,st=Ie.stateNode;if(Ve!==null&&Ve===R)break;Ie.tag===5&&st!==null&&(Ie=st,F?(Ve=St(S,W),Ve!=null&&se.unshift(zt(S,Ve,Ie))):F||(Ve=St(S,W),Ve!=null&&se.push(zt(S,Ve,Ie)))),S=S.return}se.length!==0&&d.push({event:p,listeners:se})}var vu=/\r\n?/g,Ri=/\u0000|\uFFFD/g;function pc(d){return(typeof d=="string"?d:""+d).replace(vu,`
`).replace(Ri,"")}function vl(d,p,S){if(p=pc(p),pc(d)!==p&&S)throw Error(r(425))}function mc(){}var gc=null,_d=null;function yc(d,p){return d==="textarea"||d==="noscript"||typeof p.children=="string"||typeof p.children=="number"||typeof p.dangerouslySetInnerHTML=="object"&&p.dangerouslySetInnerHTML!==null&&p.dangerouslySetInnerHTML.__html!=null}var Oa=typeof setTimeout=="function"?setTimeout:void 0,Qh=typeof clearTimeout=="function"?clearTimeout:void 0,Tp=typeof Promise=="function"?Promise:void 0,Sp=typeof queueMicrotask=="function"?queueMicrotask:typeof Tp<"u"?function(d){return Tp.resolve(null).then(d).catch(_c)}:Oa;function _c(d){setTimeout(function(){throw d})}function wu(d,p){var S=p,R=0;do{var F=S.nextSibling;if(d.removeChild(S),F&&F.nodeType===8)if(S=F.data,S==="/$"){if(R===0){d.removeChild(F),wo(p);return}R--}else S!=="$"&&S!=="$?"&&S!=="$!"||R++;S=F}while(S);wo(p)}function Wo(d){for(;d!=null;d=d.nextSibling){var p=d.nodeType;if(p===1||p===3)break;if(p===8){if(p=d.data,p==="$"||p==="$!"||p==="$?")break;if(p==="/$")return null}}return d}function xd(d){d=d.previousSibling;for(var p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="$"||S==="$!"||S==="$?"){if(p===0)return d;p--}else S==="/$"&&p++}d=d.previousSibling}return null}var ua=Math.random().toString(36).slice(2),Ss="__reactFiber$"+ua,da="__reactProps$"+ua,To="__reactContainer$"+ua,vd="__reactEvents$"+ua,ef="__reactListeners$"+ua,Ep="__reactHandles$"+ua;function Es(d){var p=d[Ss];if(p)return p;for(var S=d.parentNode;S;){if(p=S[To]||S[Ss]){if(S=p.alternate,p.child!==null||S!==null&&S.child!==null)for(d=xd(d);d!==null;){if(S=d[Ss])return S;d=xd(d)}return p}d=S,S=d.parentNode}return null}function xc(d){return d=d[Ss]||d[To],!d||d.tag!==5&&d.tag!==6&&d.tag!==13&&d.tag!==3?null:d}function wl(d){if(d.tag===5||d.tag===6)return d.stateNode;throw Error(r(33))}function wd(d){return d[da]||null}var bd=[],za=-1;function ha(d){return{current:d}}function Nr(d){0>za||(d.current=bd[za],bd[za]=null,za--)}function Wn(d,p){za++,bd[za]=d.current,d.current=p}var Ba={},Ui=ha(Ba),Cs=ha(!1),bl=Ba;function $i(d,p){var S=d.type.contextTypes;if(!S)return Ba;var R=d.stateNode;if(R&&R.__reactInternalMemoizedUnmaskedChildContext===p)return R.__reactInternalMemoizedMaskedChildContext;var F={},W;for(W in S)F[W]=p[W];return R&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=p,d.__reactInternalMemoizedMaskedChildContext=F),F}function as(d){return d=d.childContextTypes,d!=null}function Td(){Nr(Cs),Nr(Ui)}function ao(d,p,S){if(Ui.current!==Ba)throw Error(r(168));Wn(Ui,p),Wn(Cs,S)}function So(d,p,S){var R=d.stateNode;if(p=p.childContextTypes,typeof R.getChildContext!="function")return S;R=R.getChildContext();for(var F in R)if(!(F in p))throw Error(r(108,wt(d)||"Unknown",F));return We({},S,R)}function qo(d){return d=(d=d.stateNode)&&d.__reactInternalMemoizedMergedChildContext||Ba,bl=Ui.current,Wn(Ui,d),Wn(Cs,Cs.current),!0}function bu(d,p,S){var R=d.stateNode;if(!R)throw Error(r(169));S?(d=So(d,p,bl),R.__reactInternalMemoizedMergedChildContext=d,Nr(Cs),Nr(Ui),Wn(Ui,d)):Nr(Cs),Wn(Cs,S)}var Ft=null,vc=!1,Tu=!1;function Tl(d){Ft===null?Ft=[d]:Ft.push(d)}function Sl(d){vc=!0,Tl(d)}function Ot(){if(!Tu&&Ft!==null){Tu=!0;var d=0,p=rr;try{var S=Ft;for(rr=1;d<S.length;d++){var R=S[d];do R=R(!0);while(R!==null)}Ft=null,vc=!1}catch(F){throw Ft!==null&&(Ft=Ft.slice(d+1)),Ch(Js,Ot),F}finally{rr=p,Tu=!1}}return null}var Fa=[],wc=0,Su=null,bc=0,Bs=[],Fs=0,El=null,fa=1,Eo="";function pa(d,p){Fa[wc++]=bc,Fa[wc++]=Su,Su=d,bc=p}function Sd(d,p,S){Bs[Fs++]=fa,Bs[Fs++]=Eo,Bs[Fs++]=El,El=d;var R=fa;d=Eo;var F=32-bi(R)-1;R&=~(1<<F),S+=1;var W=32-bi(p)+F;if(30<W){var se=F-F%5;W=(R&(1<<se)-1).toString(32),R>>=se,F-=se,fa=1<<32-bi(p)+F|S<<F|R,Eo=W+d}else fa=1<<W|S<<F|R,Eo=d}function Va(d){d.return!==null&&(pa(d,1),Sd(d,1,0))}function g(d){for(;d===Su;)Su=Fa[--wc],Fa[wc]=null,bc=Fa[--wc],Fa[wc]=null;for(;d===El;)El=Bs[--Fs],Bs[Fs]=null,Eo=Bs[--Fs],Bs[Fs]=null,fa=Bs[--Fs],Bs[Fs]=null}var o=null,h=null,_=!1,T=null;function C(d,p){var S=Ji(5,null,null,0);S.elementType="DELETED",S.stateNode=p,S.return=d,p=d.deletions,p===null?(d.deletions=[S],d.flags|=16):p.push(S)}function N(d,p){switch(d.tag){case 5:var S=d.type;return p=p.nodeType!==1||S.toLowerCase()!==p.nodeName.toLowerCase()?null:p,p!==null?(d.stateNode=p,o=d,h=Wo(p.firstChild),!0):!1;case 6:return p=d.pendingProps===""||p.nodeType!==3?null:p,p!==null?(d.stateNode=p,o=d,h=null,!0):!1;case 13:return p=p.nodeType!==8?null:p,p!==null?(S=El!==null?{id:fa,overflow:Eo}:null,d.memoizedState={dehydrated:p,treeContext:S,retryLane:1073741824},S=Ji(18,null,null,0),S.stateNode=p,S.return=d,d.child=S,o=d,h=null,!0):!1;default:return!1}}function D(d){return(d.mode&1)!==0&&(d.flags&128)===0}function B(d){if(_){var p=h;if(p){var S=p;if(!N(d,p)){if(D(d))throw Error(r(418));p=Wo(S.nextSibling);var R=o;p&&N(d,p)?C(R,S):(d.flags=d.flags&-4097|2,_=!1,o=d)}}else{if(D(d))throw Error(r(418));d.flags=d.flags&-4097|2,_=!1,o=d}}}function G(d){for(d=d.return;d!==null&&d.tag!==5&&d.tag!==3&&d.tag!==13;)d=d.return;o=d}function $(d){if(d!==o)return!1;if(!_)return G(d),_=!0,!1;var p;if((p=d.tag!==3)&&!(p=d.tag!==5)&&(p=d.type,p=p!=="head"&&p!=="body"&&!yc(d.type,d.memoizedProps)),p&&(p=h)){if(D(d))throw J(),Error(r(418));for(;p;)C(d,p),p=Wo(p.nextSibling)}if(G(d),d.tag===13){if(d=d.memoizedState,d=d!==null?d.dehydrated:null,!d)throw Error(r(317));e:{for(d=d.nextSibling,p=0;d;){if(d.nodeType===8){var S=d.data;if(S==="/$"){if(p===0){h=Wo(d.nextSibling);break e}p--}else S!=="$"&&S!=="$!"&&S!=="$?"||p++}d=d.nextSibling}h=null}}else h=o?Wo(d.stateNode.nextSibling):null;return!0}function J(){for(var d=h;d;)d=Wo(d.nextSibling)}function oe(){h=o=null,_=!1}function ce(d){T===null?T=[d]:T.push(d)}var fe=pe.ReactCurrentBatchConfig;function de(d,p,S){if(d=S.ref,d!==null&&typeof d!="function"&&typeof d!="object"){if(S._owner){if(S=S._owner,S){if(S.tag!==1)throw Error(r(309));var R=S.stateNode}if(!R)throw Error(r(147,d));var F=R,W=""+d;return p!==null&&p.ref!==null&&typeof p.ref=="function"&&p.ref._stringRef===W?p.ref:(p=function(se){var Ie=F.refs;se===null?delete Ie[W]:Ie[W]=se},p._stringRef=W,p)}if(typeof d!="string")throw Error(r(284));if(!S._owner)throw Error(r(290,d))}return d}function me(d,p){throw d=Object.prototype.toString.call(p),Error(r(31,d==="[object Object]"?"object with keys {"+Object.keys(p).join(", ")+"}":d))}function Q(d){var p=d._init;return p(d._payload)}function le(d){function p(et,He){if(d){var rt=et.deletions;rt===null?(et.deletions=[He],et.flags|=16):rt.push(He)}}function S(et,He){if(!d)return null;for(;He!==null;)p(et,He),He=He.sibling;return null}function R(et,He){for(et=new Map;He!==null;)He.key!==null?et.set(He.key,He):et.set(He.index,He),He=He.sibling;return et}function F(et,He){return et=Nc(et,He),et.index=0,et.sibling=null,et}function W(et,He,rt){return et.index=rt,d?(rt=et.alternate,rt!==null?(rt=rt.index,rt<He?(et.flags|=2,He):rt):(et.flags|=2,He)):(et.flags|=1048576,He)}function se(et){return d&&et.alternate===null&&(et.flags|=2),et}function Ie(et,He,rt,Vt){return He===null||He.tag!==6?(He=Ig(rt,et.mode,Vt),He.return=et,He):(He=F(He,rt),He.return=et,He)}function Ve(et,He,rt,Vt){var mn=rt.type;return mn===ze?Dt(et,He,rt.props.children,Vt,rt.key):He!==null&&(He.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===mt&&Q(mn)===He.type)?(Vt=F(He,rt.props),Vt.ref=de(et,He,rt),Vt.return=et,Vt):(Vt=qp(rt.type,rt.key,rt.props,null,et.mode,Vt),Vt.ref=de(et,He,rt),Vt.return=et,Vt)}function st(et,He,rt,Vt){return He===null||He.tag!==4||He.stateNode.containerInfo!==rt.containerInfo||He.stateNode.implementation!==rt.implementation?(He=Mg(rt,et.mode,Vt),He.return=et,He):(He=F(He,rt.children||[]),He.return=et,He)}function Dt(et,He,rt,Vt,mn){return He===null||He.tag!==7?(He=Ou(rt,et.mode,Vt,mn),He.return=et,He):(He=F(He,rt),He.return=et,He)}function jt(et,He,rt){if(typeof He=="string"&&He!==""||typeof He=="number")return He=Ig(""+He,et.mode,rt),He.return=et,He;if(typeof He=="object"&&He!==null){switch(He.$$typeof){case we:return rt=qp(He.type,He.key,He.props,null,et.mode,rt),rt.ref=de(et,null,He),rt.return=et,rt;case ke:return He=Mg(He,et.mode,rt),He.return=et,He;case mt:var Vt=He._init;return jt(et,Vt(He._payload),rt)}if(Zr(He)||xe(He))return He=Ou(He,et.mode,rt,null),He.return=et,He;me(et,He)}return null}function Mt(et,He,rt,Vt){var mn=He!==null?He.key:null;if(typeof rt=="string"&&rt!==""||typeof rt=="number")return mn!==null?null:Ie(et,He,""+rt,Vt);if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case we:return rt.key===mn?Ve(et,He,rt,Vt):null;case ke:return rt.key===mn?st(et,He,rt,Vt):null;case mt:return mn=rt._init,Mt(et,He,mn(rt._payload),Vt)}if(Zr(rt)||xe(rt))return mn!==null?null:Dt(et,He,rt,Vt,null);me(et,rt)}return null}function sn(et,He,rt,Vt,mn){if(typeof Vt=="string"&&Vt!==""||typeof Vt=="number")return et=et.get(rt)||null,Ie(He,et,""+Vt,mn);if(typeof Vt=="object"&&Vt!==null){switch(Vt.$$typeof){case we:return et=et.get(Vt.key===null?rt:Vt.key)||null,Ve(He,et,Vt,mn);case ke:return et=et.get(Vt.key===null?rt:Vt.key)||null,st(He,et,Vt,mn);case mt:var Sn=Vt._init;return sn(et,He,rt,Sn(Vt._payload),mn)}if(Zr(Vt)||xe(Vt))return et=et.get(rt)||null,Dt(He,et,Vt,mn,null);me(He,Vt)}return null}function hn(et,He,rt,Vt){for(var mn=null,Sn=null,En=He,Vn=He=0,Qi=null;En!==null&&Vn<rt.length;Vn++){En.index>Vn?(Qi=En,En=null):Qi=En.sibling;var lr=Mt(et,En,rt[Vn],Vt);if(lr===null){En===null&&(En=Qi);break}d&&En&&lr.alternate===null&&p(et,En),He=W(lr,He,Vn),Sn===null?mn=lr:Sn.sibling=lr,Sn=lr,En=Qi}if(Vn===rt.length)return S(et,En),_&&pa(et,Vn),mn;if(En===null){for(;Vn<rt.length;Vn++)En=jt(et,rt[Vn],Vt),En!==null&&(He=W(En,He,Vn),Sn===null?mn=En:Sn.sibling=En,Sn=En);return _&&pa(et,Vn),mn}for(En=R(et,En);Vn<rt.length;Vn++)Qi=sn(En,et,Vn,rt[Vn],Vt),Qi!==null&&(d&&Qi.alternate!==null&&En.delete(Qi.key===null?Vn:Qi.key),He=W(Qi,He,Vn),Sn===null?mn=Qi:Sn.sibling=Qi,Sn=Qi);return d&&En.forEach(function(Jo){return p(et,Jo)}),_&&pa(et,Vn),mn}function pn(et,He,rt,Vt){var mn=xe(rt);if(typeof mn!="function")throw Error(r(150));if(rt=mn.call(rt),rt==null)throw Error(r(151));for(var Sn=mn=null,En=He,Vn=He=0,Qi=null,lr=rt.next();En!==null&&!lr.done;Vn++,lr=rt.next()){En.index>Vn?(Qi=En,En=null):Qi=En.sibling;var Jo=Mt(et,En,lr.value,Vt);if(Jo===null){En===null&&(En=Qi);break}d&&En&&Jo.alternate===null&&p(et,En),He=W(Jo,He,Vn),Sn===null?mn=Jo:Sn.sibling=Jo,Sn=Jo,En=Qi}if(lr.done)return S(et,En),_&&pa(et,Vn),mn;if(En===null){for(;!lr.done;Vn++,lr=rt.next())lr=jt(et,lr.value,Vt),lr!==null&&(He=W(lr,He,Vn),Sn===null?mn=lr:Sn.sibling=lr,Sn=lr);return _&&pa(et,Vn),mn}for(En=R(et,En);!lr.done;Vn++,lr=rt.next())lr=sn(En,et,Vn,lr.value,Vt),lr!==null&&(d&&lr.alternate!==null&&En.delete(lr.key===null?Vn:lr.key),He=W(lr,He,Vn),Sn===null?mn=lr:Sn.sibling=lr,Sn=lr);return d&&En.forEach(function(j_){return p(et,j_)}),_&&pa(et,Vn),mn}function gi(et,He,rt,Vt){if(typeof rt=="object"&&rt!==null&&rt.type===ze&&rt.key===null&&(rt=rt.props.children),typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case we:e:{for(var mn=rt.key,Sn=He;Sn!==null;){if(Sn.key===mn){if(mn=rt.type,mn===ze){if(Sn.tag===7){S(et,Sn.sibling),He=F(Sn,rt.props.children),He.return=et,et=He;break e}}else if(Sn.elementType===mn||typeof mn=="object"&&mn!==null&&mn.$$typeof===mt&&Q(mn)===Sn.type){S(et,Sn.sibling),He=F(Sn,rt.props),He.ref=de(et,Sn,rt),He.return=et,et=He;break e}S(et,Sn);break}else p(et,Sn);Sn=Sn.sibling}rt.type===ze?(He=Ou(rt.props.children,et.mode,Vt,rt.key),He.return=et,et=He):(Vt=qp(rt.type,rt.key,rt.props,null,et.mode,Vt),Vt.ref=de(et,He,rt),Vt.return=et,et=Vt)}return se(et);case ke:e:{for(Sn=rt.key;He!==null;){if(He.key===Sn)if(He.tag===4&&He.stateNode.containerInfo===rt.containerInfo&&He.stateNode.implementation===rt.implementation){S(et,He.sibling),He=F(He,rt.children||[]),He.return=et,et=He;break e}else{S(et,He);break}else p(et,He);He=He.sibling}He=Mg(rt,et.mode,Vt),He.return=et,et=He}return se(et);case mt:return Sn=rt._init,gi(et,He,Sn(rt._payload),Vt)}if(Zr(rt))return hn(et,He,rt,Vt);if(xe(rt))return pn(et,He,rt,Vt);me(et,rt)}return typeof rt=="string"&&rt!==""||typeof rt=="number"?(rt=""+rt,He!==null&&He.tag===6?(S(et,He.sibling),He=F(He,rt),He.return=et,et=He):(S(et,He),He=Ig(rt,et.mode,Vt),He.return=et,et=He),se(et)):S(et,He)}return gi}var _e=le(!0),ve=le(!1),Ne=ha(null),Le=null,De=null,$e=null;function Ue(){$e=De=Le=null}function Ye(d){var p=Ne.current;Nr(Ne),d._currentValue=p}function kt(d,p,S){for(;d!==null;){var R=d.alternate;if((d.childLanes&p)!==p?(d.childLanes|=p,R!==null&&(R.childLanes|=p)):R!==null&&(R.childLanes&p)!==p&&(R.childLanes|=p),d===S)break;d=d.return}}function qe(d,p){Le=d,$e=De=null,d=d.dependencies,d!==null&&d.firstContext!==null&&((d.lanes&p)!==0&&(Ki=!0),d.firstContext=null)}function at(d){var p=d._currentValue;if($e!==d)if(d={context:d,memoizedValue:p,next:null},De===null){if(Le===null)throw Error(r(308));De=d,Le.dependencies={lanes:0,firstContext:d}}else De=De.next=d;return p}var Je=null;function Et(d){Je===null?Je=[d]:Je.push(d)}function Ke(d,p,S,R){var F=p.interleaved;return F===null?(S.next=S,Et(p)):(S.next=F.next,F.next=S),p.interleaved=S,lt(d,R)}function lt(d,p){d.lanes|=p;var S=d.alternate;for(S!==null&&(S.lanes|=p),S=d,d=d.return;d!==null;)d.childLanes|=p,S=d.alternate,S!==null&&(S.childLanes|=p),S=d,d=d.return;return S.tag===3?S.stateNode:null}var Tt=!1;function xt(d){d.updateQueue={baseState:d.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function At(d,p){d=d.updateQueue,p.updateQueue===d&&(p.updateQueue={baseState:d.baseState,firstBaseUpdate:d.firstBaseUpdate,lastBaseUpdate:d.lastBaseUpdate,shared:d.shared,effects:d.effects})}function Qt(d,p){return{eventTime:d,lane:p,tag:0,payload:null,callback:null,next:null}}function yn(d,p,S){var R=d.updateQueue;if(R===null)return null;if(R=R.shared,(dn&2)!==0){var F=R.pending;return F===null?p.next=p:(p.next=F.next,F.next=p),R.pending=p,lt(d,S)}return F=R.interleaved,F===null?(p.next=p,Et(R)):(p.next=F.next,F.next=p),R.interleaved=p,lt(d,S)}function qt(d,p,S){if(p=p.updateQueue,p!==null&&(p=p.shared,(S&4194240)!==0)){var R=p.lanes;R&=d.pendingLanes,S|=R,p.lanes=S,cl(d,S)}}function un(d,p){var S=d.updateQueue,R=d.alternate;if(R!==null&&(R=R.updateQueue,S===R)){var F=null,W=null;if(S=S.firstBaseUpdate,S!==null){do{var se={eventTime:S.eventTime,lane:S.lane,tag:S.tag,payload:S.payload,callback:S.callback,next:null};W===null?F=W=se:W=W.next=se,S=S.next}while(S!==null);W===null?F=W=p:W=W.next=p}else F=W=p;S={baseState:R.baseState,firstBaseUpdate:F,lastBaseUpdate:W,shared:R.shared,effects:R.effects},d.updateQueue=S;return}d=S.lastBaseUpdate,d===null?S.firstBaseUpdate=p:d.next=p,S.lastBaseUpdate=p}function jn(d,p,S,R){var F=d.updateQueue;Tt=!1;var W=F.firstBaseUpdate,se=F.lastBaseUpdate,Ie=F.shared.pending;if(Ie!==null){F.shared.pending=null;var Ve=Ie,st=Ve.next;Ve.next=null,se===null?W=st:se.next=st,se=Ve;var Dt=d.alternate;Dt!==null&&(Dt=Dt.updateQueue,Ie=Dt.lastBaseUpdate,Ie!==se&&(Ie===null?Dt.firstBaseUpdate=st:Ie.next=st,Dt.lastBaseUpdate=Ve))}if(W!==null){var jt=F.baseState;se=0,Dt=st=Ve=null,Ie=W;do{var Mt=Ie.lane,sn=Ie.eventTime;if((R&Mt)===Mt){Dt!==null&&(Dt=Dt.next={eventTime:sn,lane:0,tag:Ie.tag,payload:Ie.payload,callback:Ie.callback,next:null});e:{var hn=d,pn=Ie;switch(Mt=p,sn=S,pn.tag){case 1:if(hn=pn.payload,typeof hn=="function"){jt=hn.call(sn,jt,Mt);break e}jt=hn;break e;case 3:hn.flags=hn.flags&-65537|128;case 0:if(hn=pn.payload,Mt=typeof hn=="function"?hn.call(sn,jt,Mt):hn,Mt==null)break e;jt=We({},jt,Mt);break e;case 2:Tt=!0}}Ie.callback!==null&&Ie.lane!==0&&(d.flags|=64,Mt=F.effects,Mt===null?F.effects=[Ie]:Mt.push(Ie))}else sn={eventTime:sn,lane:Mt,tag:Ie.tag,payload:Ie.payload,callback:Ie.callback,next:null},Dt===null?(st=Dt=sn,Ve=jt):Dt=Dt.next=sn,se|=Mt;if(Ie=Ie.next,Ie===null){if(Ie=F.shared.pending,Ie===null)break;Mt=Ie,Ie=Mt.next,Mt.next=null,F.lastBaseUpdate=Mt,F.shared.pending=null}}while(!0);if(Dt===null&&(Ve=jt),F.baseState=Ve,F.firstBaseUpdate=st,F.lastBaseUpdate=Dt,p=F.shared.interleaved,p!==null){F=p;do se|=F.lane,F=F.next;while(F!==p)}else W===null&&(F.shared.lanes=0);Yr|=se,d.lanes=se,d.memoizedState=jt}}function Fn(d,p,S){if(d=p.effects,p.effects=null,d!==null)for(p=0;p<d.length;p++){var R=d[p],F=R.callback;if(F!==null){if(R.callback=null,R=S,typeof F!="function")throw Error(r(191,F));F.call(R)}}}var en={},Gn=ha(en),sr=ha(en),or=ha(en);function tr(d){if(d===en)throw Error(r(174));return d}function Ni(d,p){switch(Wn(or,p),Wn(sr,d),Wn(Gn,en),d=p.nodeType,d){case 9:case 11:p=(p=p.documentElement)?p.namespaceURI:is(null,"");break;default:d=d===8?p.parentNode:p,p=d.namespaceURI||null,d=d.tagName,p=is(p,d)}Nr(Gn),Wn(Gn,p)}function $r(){Nr(Gn),Nr(sr),Nr(or)}function Vs(d){tr(or.current);var p=tr(Gn.current),S=is(p,d.type);p!==S&&(Wn(sr,d),Wn(Gn,S))}function lo(d){sr.current===d&&(Nr(Gn),Nr(sr))}var In=ha(0);function fr(d){for(var p=d;p!==null;){if(p.tag===13){var S=p.memoizedState;if(S!==null&&(S=S.dehydrated,S===null||S.data==="$?"||S.data==="$!"))return p}else if(p.tag===19&&p.memoizedProps.revealOrder!==void 0){if((p.flags&128)!==0)return p}else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return null;p=p.return}p.sibling.return=p.return,p=p.sibling}return null}var Qn=[];function Gr(){for(var d=0;d<Qn.length;d++)Qn[d]._workInProgressVersionPrimary=null;Qn.length=0}var Di=pe.ReactCurrentDispatcher,xr=pe.ReactCurrentBatchConfig,hi=0,Dr=null,Or=null,Kr=null,co=!1,uo=!1,Co=0,Ed=0;function fi(){throw Error(r(321))}function Eu(d,p){if(p===null)return!1;for(var S=0;S<p.length&&S<d.length;S++)if(!so(d[S],p[S]))return!1;return!0}function Cp(d,p,S,R,F,W){if(hi=W,Dr=p,p.memoizedState=null,p.updateQueue=null,p.lanes=0,Di.current=d===null||d.memoizedState===null?b_:T_,d=S(R,F),uo){W=0;do{if(uo=!1,Co=0,25<=W)throw Error(r(301));W+=1,Kr=Or=null,p.updateQueue=null,Di.current=ga,d=S(R,F)}while(uo)}if(Di.current=ls,p=Or!==null&&Or.next!==null,hi=0,Kr=Or=Dr=null,co=!1,p)throw Error(r(300));return d}function kp(){var d=Co!==0;return Co=0,d}function Ua(){var d={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Kr===null?Dr.memoizedState=Kr=d:Kr=Kr.next=d,Kr}function ho(){if(Or===null){var d=Dr.alternate;d=d!==null?d.memoizedState:null}else d=Or.next;var p=Kr===null?Dr.memoizedState:Kr.next;if(p!==null)Kr=p,Or=d;else{if(d===null)throw Error(r(310));Or=d,d={memoizedState:Or.memoizedState,baseState:Or.baseState,baseQueue:Or.baseQueue,queue:Or.queue,next:null},Kr===null?Dr.memoizedState=Kr=d:Kr=Kr.next=d}return Kr}function Tc(d,p){return typeof p=="function"?p(d):p}function Ap(d){var p=ho(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var R=Or,F=R.baseQueue,W=S.pending;if(W!==null){if(F!==null){var se=F.next;F.next=W.next,W.next=se}R.baseQueue=F=W,S.pending=null}if(F!==null){W=F.next,R=R.baseState;var Ie=se=null,Ve=null,st=W;do{var Dt=st.lane;if((hi&Dt)===Dt)Ve!==null&&(Ve=Ve.next={lane:0,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null}),R=st.hasEagerState?st.eagerState:d(R,st.action);else{var jt={lane:Dt,action:st.action,hasEagerState:st.hasEagerState,eagerState:st.eagerState,next:null};Ve===null?(Ie=Ve=jt,se=R):Ve=Ve.next=jt,Dr.lanes|=Dt,Yr|=Dt}st=st.next}while(st!==null&&st!==W);Ve===null?se=R:Ve.next=Ie,so(R,p.memoizedState)||(Ki=!0),p.memoizedState=R,p.baseState=se,p.baseQueue=Ve,S.lastRenderedState=R}if(d=S.interleaved,d!==null){F=d;do W=F.lane,Dr.lanes|=W,Yr|=W,F=F.next;while(F!==d)}else F===null&&(S.lanes=0);return[p.memoizedState,S.dispatch]}function tf(d){var p=ho(),S=p.queue;if(S===null)throw Error(r(311));S.lastRenderedReducer=d;var R=S.dispatch,F=S.pending,W=p.memoizedState;if(F!==null){S.pending=null;var se=F=F.next;do W=d(W,se.action),se=se.next;while(se!==F);so(W,p.memoizedState)||(Ki=!0),p.memoizedState=W,p.baseQueue===null&&(p.baseState=W),S.lastRenderedState=W}return[W,R]}function nf(){}function $a(d,p){var S=Dr,R=ho(),F=p(),W=!so(R.memoizedState,F);if(W&&(R.memoizedState=F,Ki=!0),R=R.queue,Ga(ag.bind(null,S,R,d),[d]),R.getSnapshot!==p||W||Kr!==null&&Kr.memoizedState.tag&1){if(S.flags|=2048,Cu(9,og.bind(null,S,R,F,p),void 0,null),ji===null)throw Error(r(349));(hi&30)!==0||rf(S,p,F)}return F}function rf(d,p,S){d.flags|=16384,d={getSnapshot:p,value:S},p=Dr.updateQueue,p===null?(p={lastEffect:null,stores:null},Dr.updateQueue=p,p.stores=[d]):(S=p.stores,S===null?p.stores=[d]:S.push(d))}function og(d,p,S,R){p.value=S,p.getSnapshot=R,m_(p)&&g_(d)}function ag(d,p,S){return S(function(){m_(p)&&g_(d)})}function m_(d){var p=d.getSnapshot;d=d.value;try{var S=p();return!so(d,S)}catch{return!0}}function g_(d){var p=lt(d,1);p!==null&&va(p,d,1,-1)}function y_(d){var p=Ua();return typeof d=="function"&&(d=d()),p.memoizedState=p.baseState=d,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Tc,lastRenderedState:d},p.queue=d,d=d.dispatch=oi.bind(null,Dr,d),[p.memoizedState,d]}function Cu(d,p,S,R){return d={tag:d,create:p,destroy:S,deps:R,next:null},p=Dr.updateQueue,p===null?(p={lastEffect:null,stores:null},Dr.updateQueue=p,p.lastEffect=d.next=d):(S=p.lastEffect,S===null?p.lastEffect=d.next=d:(R=S.next,S.next=d,d.next=R,p.lastEffect=d)),d}function Cd(){return ho().memoizedState}function Cl(d,p,S,R){var F=Ua();Dr.flags|=d,F.memoizedState=Cu(1|p,S,void 0,R===void 0?null:R)}function Zo(d,p,S,R){var F=ho();R=R===void 0?null:R;var W=void 0;if(Or!==null){var se=Or.memoizedState;if(W=se.destroy,R!==null&&Eu(R,se.deps)){F.memoizedState=Cu(p,S,W,R);return}}Dr.flags|=d,F.memoizedState=Cu(1|p,S,W,R)}function Xo(d,p){return Cl(8390656,8,d,p)}function Ga(d,p){return Zo(2048,8,d,p)}function kl(d,p){return Zo(4,2,d,p)}function Sc(d,p){return Zo(4,4,d,p)}function __(d,p){if(typeof p=="function")return d=d(),p(d),function(){p(null)};if(p!=null)return d=d(),p.current=d,function(){p.current=null}}function x_(d,p,S){return S=S!=null?S.concat([d]):null,Zo(4,4,__.bind(null,p,d),S)}function lg(){}function v_(d,p){var S=ho();p=p===void 0?null:p;var R=S.memoizedState;return R!==null&&p!==null&&Eu(p,R[1])?R[0]:(S.memoizedState=[d,p],d)}function cg(d,p){var S=ho();p=p===void 0?null:p;var R=S.memoizedState;return R!==null&&p!==null&&Eu(p,R[1])?R[0]:(d=d(),S.memoizedState=[d,p],d)}function ug(d,p,S){return(hi&21)===0?(d.baseState&&(d.baseState=!1,Ki=!0),d.memoizedState=S):(so(S,p)||(S=vs(),Dr.lanes|=S,Yr|=S,d.baseState=!0),p)}function ma(d,p){var S=rr;rr=S!==0&&4>S?S:4,d(!0);var R=xr.transition;xr.transition={};try{d(!1),p()}finally{rr=S,xr.transition=R}}function w_(){return ho().memoizedState}function _0(d,p,S){var R=Ka(d);if(S={lane:R,action:S,hasEagerState:!1,eagerState:null,next:null},an(d))Al(p,S);else if(S=Ke(d,p,S,R),S!==null){var F=Gs();va(S,d,R,F),sf(S,p,R)}}function oi(d,p,S){var R=Ka(d),F={lane:R,action:S,hasEagerState:!1,eagerState:null,next:null};if(an(d))Al(p,F);else{var W=d.alternate;if(d.lanes===0&&(W===null||W.lanes===0)&&(W=p.lastRenderedReducer,W!==null))try{var se=p.lastRenderedState,Ie=W(se,S);if(F.hasEagerState=!0,F.eagerState=Ie,so(Ie,se)){var Ve=p.interleaved;Ve===null?(F.next=F,Et(p)):(F.next=Ve.next,Ve.next=F),p.interleaved=F;return}}catch{}S=Ke(d,p,F,R),S!==null&&(F=Gs(),va(S,d,R,F),sf(S,p,R))}}function an(d){var p=d.alternate;return d===Dr||p!==null&&p===Dr}function Al(d,p){uo=co=!0;var S=d.pending;S===null?p.next=p:(p.next=S.next,S.next=p),d.pending=p}function sf(d,p,S){if((S&4194240)!==0){var R=p.lanes;R&=d.pendingLanes,S|=R,p.lanes=S,cl(d,S)}}var ls={readContext:at,useCallback:fi,useContext:fi,useEffect:fi,useImperativeHandle:fi,useInsertionEffect:fi,useLayoutEffect:fi,useMemo:fi,useReducer:fi,useRef:fi,useState:fi,useDebugValue:fi,useDeferredValue:fi,useTransition:fi,useMutableSource:fi,useSyncExternalStore:fi,useId:fi,unstable_isNewReconciler:!1},b_={readContext:at,useCallback:function(d,p){return Ua().memoizedState=[d,p===void 0?null:p],d},useContext:at,useEffect:Xo,useImperativeHandle:function(d,p,S){return S=S!=null?S.concat([d]):null,Cl(4194308,4,__.bind(null,p,d),S)},useLayoutEffect:function(d,p){return Cl(4194308,4,d,p)},useInsertionEffect:function(d,p){return Cl(4,2,d,p)},useMemo:function(d,p){var S=Ua();return p=p===void 0?null:p,d=d(),S.memoizedState=[d,p],d},useReducer:function(d,p,S){var R=Ua();return p=S!==void 0?S(p):p,R.memoizedState=R.baseState=p,d={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:d,lastRenderedState:p},R.queue=d,d=d.dispatch=_0.bind(null,Dr,d),[R.memoizedState,d]},useRef:function(d){var p=Ua();return d={current:d},p.memoizedState=d},useState:y_,useDebugValue:lg,useDeferredValue:function(d){return Ua().memoizedState=d},useTransition:function(){var d=y_(!1),p=d[0];return d=ma.bind(null,d[1]),Ua().memoizedState=d,[p,d]},useMutableSource:function(){},useSyncExternalStore:function(d,p,S){var R=Dr,F=Ua();if(_){if(S===void 0)throw Error(r(407));S=S()}else{if(S=p(),ji===null)throw Error(r(349));(hi&30)!==0||rf(R,p,S)}F.memoizedState=S;var W={value:S,getSnapshot:p};return F.queue=W,Xo(ag.bind(null,R,W,d),[d]),R.flags|=2048,Cu(9,og.bind(null,R,W,S,p),void 0,null),S},useId:function(){var d=Ua(),p=ji.identifierPrefix;if(_){var S=Eo,R=fa;S=(R&~(1<<32-bi(R)-1)).toString(32)+S,p=":"+p+"R"+S,S=Co++,0<S&&(p+="H"+S.toString(32)),p+=":"}else S=Ed++,p=":"+p+"r"+S.toString(32)+":";return d.memoizedState=p},unstable_isNewReconciler:!1},T_={readContext:at,useCallback:v_,useContext:at,useEffect:Ga,useImperativeHandle:x_,useInsertionEffect:kl,useLayoutEffect:Sc,useMemo:cg,useReducer:Ap,useRef:Cd,useState:function(){return Ap(Tc)},useDebugValue:lg,useDeferredValue:function(d){var p=ho();return ug(p,Or.memoizedState,d)},useTransition:function(){var d=Ap(Tc)[0],p=ho().memoizedState;return[d,p]},useMutableSource:nf,useSyncExternalStore:$a,useId:w_,unstable_isNewReconciler:!1},ga={readContext:at,useCallback:v_,useContext:at,useEffect:Ga,useImperativeHandle:x_,useInsertionEffect:kl,useLayoutEffect:Sc,useMemo:cg,useReducer:tf,useRef:Cd,useState:function(){return tf(Tc)},useDebugValue:lg,useDeferredValue:function(d){var p=ho();return Or===null?p.memoizedState=d:ug(p,Or.memoizedState,d)},useTransition:function(){var d=tf(Tc)[0],p=ho().memoizedState;return[d,p]},useMutableSource:nf,useSyncExternalStore:$a,useId:w_,unstable_isNewReconciler:!1};function ko(d,p){if(d&&d.defaultProps){p=We({},p),d=d.defaultProps;for(var S in d)p[S]===void 0&&(p[S]=d[S]);return p}return p}function Il(d,p,S,R){p=d.memoizedState,S=S(R,p),S=S==null?p:We({},p,S),d.memoizedState=S,d.lanes===0&&(d.updateQueue.baseState=S)}var Ec={isMounted:function(d){return(d=d._reactInternals)?Rr(d)===d:!1},enqueueSetState:function(d,p,S){d=d._reactInternals;var R=Gs(),F=Ka(d),W=Qt(R,F);W.payload=p,S!=null&&(W.callback=S),p=yn(d,W,F),p!==null&&(va(p,d,F,R),qt(p,d,F))},enqueueReplaceState:function(d,p,S){d=d._reactInternals;var R=Gs(),F=Ka(d),W=Qt(R,F);W.tag=1,W.payload=p,S!=null&&(W.callback=S),p=yn(d,W,F),p!==null&&(va(p,d,F,R),qt(p,d,F))},enqueueForceUpdate:function(d,p){d=d._reactInternals;var S=Gs(),R=Ka(d),F=Qt(S,R);F.tag=2,p!=null&&(F.callback=p),p=yn(d,F,R),p!==null&&(va(p,d,R,S),qt(p,d,R))}};function Cc(d,p,S,R,F,W,se){return d=d.stateNode,typeof d.shouldComponentUpdate=="function"?d.shouldComponentUpdate(R,W,se):p.prototype&&p.prototype.isPureReactComponent?!Na(S,R)||!Na(F,W):!0}function Ip(d,p,S){var R=!1,F=Ba,W=p.contextType;return typeof W=="object"&&W!==null?W=at(W):(F=as(p)?bl:Ui.current,R=p.contextTypes,W=(R=R!=null)?$i(d,F):Ba),p=new p(S,W),d.memoizedState=p.state!==null&&p.state!==void 0?p.state:null,p.updater=Ec,d.stateNode=p,p._reactInternals=d,R&&(d=d.stateNode,d.__reactInternalMemoizedUnmaskedChildContext=F,d.__reactInternalMemoizedMaskedChildContext=W),p}function of(d,p,S,R){d=p.state,typeof p.componentWillReceiveProps=="function"&&p.componentWillReceiveProps(S,R),typeof p.UNSAFE_componentWillReceiveProps=="function"&&p.UNSAFE_componentWillReceiveProps(S,R),p.state!==d&&Ec.enqueueReplaceState(p,p.state,null)}function Mp(d,p,S,R){var F=d.stateNode;F.props=S,F.state=d.memoizedState,F.refs={},xt(d);var W=p.contextType;typeof W=="object"&&W!==null?F.context=at(W):(W=as(p)?bl:Ui.current,F.context=$i(d,W)),F.state=d.memoizedState,W=p.getDerivedStateFromProps,typeof W=="function"&&(Il(d,p,W,S),F.state=d.memoizedState),typeof p.getDerivedStateFromProps=="function"||typeof F.getSnapshotBeforeUpdate=="function"||typeof F.UNSAFE_componentWillMount!="function"&&typeof F.componentWillMount!="function"||(p=F.state,typeof F.componentWillMount=="function"&&F.componentWillMount(),typeof F.UNSAFE_componentWillMount=="function"&&F.UNSAFE_componentWillMount(),p!==F.state&&Ec.enqueueReplaceState(F,F.state,null),jn(d,S,F,R),F.state=d.memoizedState),typeof F.componentDidMount=="function"&&(d.flags|=4194308)}function ku(d,p){try{var S="",R=p;do S+=Wt(R),R=R.return;while(R);var F=S}catch(W){F=`
Error generating stack: `+W.message+`
`+W.stack}return{value:d,source:p,stack:F,digest:null}}function dg(d,p,S){return{value:d,source:null,stack:S??null,digest:p??null}}function af(d,p){try{console.error(p.value)}catch(S){setTimeout(function(){throw S})}}var S_=typeof WeakMap=="function"?WeakMap:Map;function kd(d,p,S){S=Qt(-1,S),S.tag=3,S.payload={element:null};var R=p.value;return S.callback=function(){yf||(yf=!0,wg=R),af(d,p)},S}function Au(d,p,S){S=Qt(-1,S),S.tag=3;var R=d.type.getDerivedStateFromError;if(typeof R=="function"){var F=p.value;S.payload=function(){return R(F)},S.callback=function(){af(d,p)}}var W=d.stateNode;return W!==null&&typeof W.componentDidCatch=="function"&&(S.callback=function(){af(d,p),typeof R!="function"&&(As===null?As=new Set([this]):As.add(this));var se=p.stack;this.componentDidCatch(p.value,{componentStack:se!==null?se:""})}),S}function Ha(d,p,S){var R=d.pingCache;if(R===null){R=d.pingCache=new S_;var F=new Set;R.set(p,F)}else F=R.get(p),F===void 0&&(F=new Set,R.set(p,F));F.has(S)||(F.add(S),d=Ag.bind(null,d,p,S),p.then(d,d))}function Pp(d){do{var p;if((p=d.tag===13)&&(p=d.memoizedState,p=p!==null?p.dehydrated!==null:!0),p)return d;d=d.return}while(d!==null);return null}function hg(d,p,S,R,F){return(d.mode&1)===0?(d===p?d.flags|=65536:(d.flags|=128,S.flags|=131072,S.flags&=-52805,S.tag===1&&(S.alternate===null?S.tag=17:(p=Qt(-1,1),p.tag=2,yn(S,p,1))),S.lanes|=1),d):(d.flags|=65536,d.lanes=F,d)}var lf=pe.ReactCurrentOwner,Ki=!1;function zr(d,p,S,R){p.child=d===null?ve(p,null,S,R):_e(p,d.child,S,R)}function Ad(d,p,S,R,F){S=S.render;var W=p.ref;return qe(p,F),R=Cp(d,p,S,R,W,F),S=kp(),d!==null&&!Ki?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~F,Wa(d,p,F)):(_&&S&&Va(p),p.flags|=1,zr(d,p,R,F),p.child)}function cs(d,p,S,R,F){if(d===null){var W=S.type;return typeof W=="function"&&!ju(W)&&W.defaultProps===void 0&&S.compare===null&&S.defaultProps===void 0?(p.tag=15,p.type=W,Ao(d,p,W,R,F)):(d=qp(S.type,null,R,p,p.mode,F),d.ref=p.ref,d.return=p,p.child=d)}if(W=d.child,(d.lanes&F)===0){var se=W.memoizedProps;if(S=S.compare,S=S!==null?S:Na,S(se,R)&&d.ref===p.ref)return Wa(d,p,F)}return p.flags|=1,d=Nc(W,R),d.ref=p.ref,d.return=p,p.child=d}function Ao(d,p,S,R,F){if(d!==null){var W=d.memoizedProps;if(Na(W,R)&&d.ref===p.ref)if(Ki=!1,p.pendingProps=R=W,(d.lanes&F)!==0)(d.flags&131072)!==0&&(Ki=!0);else return p.lanes=d.lanes,Wa(d,p,F)}return Np(d,p,S,R,F)}function Rp(d,p,S){var R=p.pendingProps,F=R.children,W=d!==null?d.memoizedState:null;if(R.mode==="hidden")if((p.mode&1)===0)p.memoizedState={baseLanes:0,cachePool:null,transitions:null},Wn(Yi,ai),ai|=S;else{if((S&1073741824)===0)return d=W!==null?W.baseLanes|S:S,p.lanes=p.childLanes=1073741824,p.memoizedState={baseLanes:d,cachePool:null,transitions:null},p.updateQueue=null,Wn(Yi,ai),ai|=d,null;p.memoizedState={baseLanes:0,cachePool:null,transitions:null},R=W!==null?W.baseLanes:S,Wn(Yi,ai),ai|=R}else W!==null?(R=W.baseLanes|S,p.memoizedState=null):R=S,Wn(Yi,ai),ai|=R;return zr(d,p,F,S),p.child}function Hr(d,p){var S=p.ref;(d===null&&S!==null||d!==null&&d.ref!==S)&&(p.flags|=512,p.flags|=2097152)}function Np(d,p,S,R,F){var W=as(S)?bl:Ui.current;return W=$i(p,W),qe(p,F),S=Cp(d,p,S,R,W,F),R=kp(),d!==null&&!Ki?(p.updateQueue=d.updateQueue,p.flags&=-2053,d.lanes&=~F,Wa(d,p,F)):(_&&R&&Va(p),p.flags|=1,zr(d,p,S,F),p.child)}function Id(d,p,S,R,F){if(as(S)){var W=!0;qo(p)}else W=!1;if(qe(p,F),p.stateNode===null)uf(d,p),Ip(p,S,R),Mp(p,S,R,F),R=!0;else if(d===null){var se=p.stateNode,Ie=p.memoizedProps;se.props=Ie;var Ve=se.context,st=S.contextType;typeof st=="object"&&st!==null?st=at(st):(st=as(S)?bl:Ui.current,st=$i(p,st));var Dt=S.getDerivedStateFromProps,jt=typeof Dt=="function"||typeof se.getSnapshotBeforeUpdate=="function";jt||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Ie!==R||Ve!==st)&&of(p,se,R,st),Tt=!1;var Mt=p.memoizedState;se.state=Mt,jn(p,R,se,F),Ve=p.memoizedState,Ie!==R||Mt!==Ve||Cs.current||Tt?(typeof Dt=="function"&&(Il(p,S,Dt,R),Ve=p.memoizedState),(Ie=Tt||Cc(p,S,Ie,R,Mt,Ve,st))?(jt||typeof se.UNSAFE_componentWillMount!="function"&&typeof se.componentWillMount!="function"||(typeof se.componentWillMount=="function"&&se.componentWillMount(),typeof se.UNSAFE_componentWillMount=="function"&&se.UNSAFE_componentWillMount()),typeof se.componentDidMount=="function"&&(p.flags|=4194308)):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),p.memoizedProps=R,p.memoizedState=Ve),se.props=R,se.state=Ve,se.context=st,R=Ie):(typeof se.componentDidMount=="function"&&(p.flags|=4194308),R=!1)}else{se=p.stateNode,At(d,p),Ie=p.memoizedProps,st=p.type===p.elementType?Ie:ko(p.type,Ie),se.props=st,jt=p.pendingProps,Mt=se.context,Ve=S.contextType,typeof Ve=="object"&&Ve!==null?Ve=at(Ve):(Ve=as(S)?bl:Ui.current,Ve=$i(p,Ve));var sn=S.getDerivedStateFromProps;(Dt=typeof sn=="function"||typeof se.getSnapshotBeforeUpdate=="function")||typeof se.UNSAFE_componentWillReceiveProps!="function"&&typeof se.componentWillReceiveProps!="function"||(Ie!==jt||Mt!==Ve)&&of(p,se,R,Ve),Tt=!1,Mt=p.memoizedState,se.state=Mt,jn(p,R,se,F);var hn=p.memoizedState;Ie!==jt||Mt!==hn||Cs.current||Tt?(typeof sn=="function"&&(Il(p,S,sn,R),hn=p.memoizedState),(st=Tt||Cc(p,S,st,R,Mt,hn,Ve)||!1)?(Dt||typeof se.UNSAFE_componentWillUpdate!="function"&&typeof se.componentWillUpdate!="function"||(typeof se.componentWillUpdate=="function"&&se.componentWillUpdate(R,hn,Ve),typeof se.UNSAFE_componentWillUpdate=="function"&&se.UNSAFE_componentWillUpdate(R,hn,Ve)),typeof se.componentDidUpdate=="function"&&(p.flags|=4),typeof se.getSnapshotBeforeUpdate=="function"&&(p.flags|=1024)):(typeof se.componentDidUpdate!="function"||Ie===d.memoizedProps&&Mt===d.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Ie===d.memoizedProps&&Mt===d.memoizedState||(p.flags|=1024),p.memoizedProps=R,p.memoizedState=hn),se.props=R,se.state=hn,se.context=Ve,R=st):(typeof se.componentDidUpdate!="function"||Ie===d.memoizedProps&&Mt===d.memoizedState||(p.flags|=4),typeof se.getSnapshotBeforeUpdate!="function"||Ie===d.memoizedProps&&Mt===d.memoizedState||(p.flags|=1024),R=!1)}return Io(d,p,S,R,W,F)}function Io(d,p,S,R,F,W){Hr(d,p);var se=(p.flags&128)!==0;if(!R&&!se)return F&&bu(p,S,!1),Wa(d,p,W);R=p.stateNode,lf.current=p;var Ie=se&&typeof S.getDerivedStateFromError!="function"?null:R.render();return p.flags|=1,d!==null&&se?(p.child=_e(p,d.child,null,W),p.child=_e(p,null,Ie,W)):zr(d,p,Ie,W),p.memoizedState=R.state,F&&bu(p,S,!0),p.child}function E_(d){var p=d.stateNode;p.pendingContext?ao(d,p.pendingContext,p.pendingContext!==p.context):p.context&&ao(d,p.context,!1),Ni(d,p.containerInfo)}function C_(d,p,S,R,F){return oe(),ce(F),p.flags|=256,zr(d,p,S,R),p.child}var Dp={dehydrated:null,treeContext:null,retryLane:0};function Lp(d){return{baseLanes:d,cachePool:null,transitions:null}}function kc(d,p,S){var R=p.pendingProps,F=In.current,W=!1,se=(p.flags&128)!==0,Ie;if((Ie=se)||(Ie=d!==null&&d.memoizedState===null?!1:(F&2)!==0),Ie?(W=!0,p.flags&=-129):(d===null||d.memoizedState!==null)&&(F|=1),Wn(In,F&1),d===null)return B(p),d=p.memoizedState,d!==null&&(d=d.dehydrated,d!==null)?((p.mode&1)===0?p.lanes=1:d.data==="$!"?p.lanes=8:p.lanes=1073741824,null):(se=R.children,d=R.fallback,W?(R=p.mode,W=p.child,se={mode:"hidden",children:se},(R&1)===0&&W!==null?(W.childLanes=0,W.pendingProps=se):W=Zp(se,R,0,null),d=Ou(d,R,S,null),W.return=p,d.return=p,W.sibling=d,p.child=W,p.child.memoizedState=Lp(S),p.memoizedState=Dp,d):jp(p,se));if(F=d.memoizedState,F!==null&&(Ie=F.dehydrated,Ie!==null))return k_(d,p,se,R,Ie,F,S);if(W){W=R.fallback,se=p.mode,F=d.child,Ie=F.sibling;var Ve={mode:"hidden",children:R.children};return(se&1)===0&&p.child!==F?(R=p.child,R.childLanes=0,R.pendingProps=Ve,p.deletions=null):(R=Nc(F,Ve),R.subtreeFlags=F.subtreeFlags&14680064),Ie!==null?W=Nc(Ie,W):(W=Ou(W,se,S,null),W.flags|=2),W.return=p,R.return=p,R.sibling=W,p.child=R,R=W,W=p.child,se=d.child.memoizedState,se=se===null?Lp(S):{baseLanes:se.baseLanes|S,cachePool:null,transitions:se.transitions},W.memoizedState=se,W.childLanes=d.childLanes&~S,p.memoizedState=Dp,R}return W=d.child,d=W.sibling,R=Nc(W,{mode:"visible",children:R.children}),(p.mode&1)===0&&(R.lanes=S),R.return=p,R.sibling=null,d!==null&&(S=p.deletions,S===null?(p.deletions=[d],p.flags|=16):S.push(d)),p.child=R,p.memoizedState=null,R}function jp(d,p){return p=Zp({mode:"visible",children:p},d.mode,0,null),p.return=d,d.child=p}function cf(d,p,S,R){return R!==null&&ce(R),_e(p,d.child,null,S),d=jp(p,p.pendingProps.children),d.flags|=2,p.memoizedState=null,d}function k_(d,p,S,R,F,W,se){if(S)return p.flags&256?(p.flags&=-257,R=dg(Error(r(422))),cf(d,p,se,R)):p.memoizedState!==null?(p.child=d.child,p.flags|=128,null):(W=R.fallback,F=p.mode,R=Zp({mode:"visible",children:R.children},F,0,null),W=Ou(W,F,se,null),W.flags|=2,R.return=p,W.return=p,R.sibling=W,p.child=R,(p.mode&1)!==0&&_e(p,d.child,null,se),p.child.memoizedState=Lp(se),p.memoizedState=Dp,W);if((p.mode&1)===0)return cf(d,p,se,null);if(F.data==="$!"){if(R=F.nextSibling&&F.nextSibling.dataset,R)var Ie=R.dgst;return R=Ie,W=Error(r(419)),R=dg(W,R,void 0),cf(d,p,se,R)}if(Ie=(se&d.childLanes)!==0,Ki||Ie){if(R=ji,R!==null){switch(se&-se){case 4:F=2;break;case 16:F=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:F=32;break;case 536870912:F=268435456;break;default:F=0}F=(F&(R.suspendedLanes|se))!==0?0:F,F!==0&&F!==W.retryLane&&(W.retryLane=F,lt(d,F),va(R,d,F,-1))}return Sg(),R=dg(Error(r(421))),cf(d,p,se,R)}return F.data==="$?"?(p.flags|=128,p.child=d.child,p=S0.bind(null,d),F._reactRetry=p,null):(d=W.treeContext,h=Wo(F.nextSibling),o=p,_=!0,T=null,d!==null&&(Bs[Fs++]=fa,Bs[Fs++]=Eo,Bs[Fs++]=El,fa=d.id,Eo=d.overflow,El=p),p=jp(p,R.children),p.flags|=4096,p)}function fg(d,p,S){d.lanes|=p;var R=d.alternate;R!==null&&(R.lanes|=p),kt(d.return,p,S)}function pg(d,p,S,R,F){var W=d.memoizedState;W===null?d.memoizedState={isBackwards:p,rendering:null,renderingStartTime:0,last:R,tail:S,tailMode:F}:(W.isBackwards=p,W.rendering=null,W.renderingStartTime=0,W.last=R,W.tail=S,W.tailMode=F)}function A_(d,p,S){var R=p.pendingProps,F=R.revealOrder,W=R.tail;if(zr(d,p,R.children,S),R=In.current,(R&2)!==0)R=R&1|2,p.flags|=128;else{if(d!==null&&(d.flags&128)!==0)e:for(d=p.child;d!==null;){if(d.tag===13)d.memoizedState!==null&&fg(d,S,p);else if(d.tag===19)fg(d,S,p);else if(d.child!==null){d.child.return=d,d=d.child;continue}if(d===p)break e;for(;d.sibling===null;){if(d.return===null||d.return===p)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}R&=1}if(Wn(In,R),(p.mode&1)===0)p.memoizedState=null;else switch(F){case"forwards":for(S=p.child,F=null;S!==null;)d=S.alternate,d!==null&&fr(d)===null&&(F=S),S=S.sibling;S=F,S===null?(F=p.child,p.child=null):(F=S.sibling,S.sibling=null),pg(p,!1,F,S,W);break;case"backwards":for(S=null,F=p.child,p.child=null;F!==null;){if(d=F.alternate,d!==null&&fr(d)===null){p.child=F;break}d=F.sibling,F.sibling=S,S=F,F=d}pg(p,!0,S,null,W);break;case"together":pg(p,!1,null,null,void 0);break;default:p.memoizedState=null}return p.child}function uf(d,p){(p.mode&1)===0&&d!==null&&(d.alternate=null,p.alternate=null,p.flags|=2)}function Wa(d,p,S){if(d!==null&&(p.dependencies=d.dependencies),Yr|=p.lanes,(S&p.childLanes)===0)return null;if(d!==null&&p.child!==d.child)throw Error(r(153));if(p.child!==null){for(d=p.child,S=Nc(d,d.pendingProps),p.child=S,S.return=p;d.sibling!==null;)d=d.sibling,S=S.sibling=Nc(d,d.pendingProps),S.return=p;S.sibling=null}return p.child}function df(d,p,S){switch(p.tag){case 3:E_(p),oe();break;case 5:Vs(p);break;case 1:as(p.type)&&qo(p);break;case 4:Ni(p,p.stateNode.containerInfo);break;case 10:var R=p.type._context,F=p.memoizedProps.value;Wn(Ne,R._currentValue),R._currentValue=F;break;case 13:if(R=p.memoizedState,R!==null)return R.dehydrated!==null?(Wn(In,In.current&1),p.flags|=128,null):(S&p.child.childLanes)!==0?kc(d,p,S):(Wn(In,In.current&1),d=Wa(d,p,S),d!==null?d.sibling:null);Wn(In,In.current&1);break;case 19:if(R=(S&p.childLanes)!==0,(d.flags&128)!==0){if(R)return A_(d,p,S);p.flags|=128}if(F=p.memoizedState,F!==null&&(F.rendering=null,F.tail=null,F.lastEffect=null),Wn(In,In.current),R)break;return null;case 22:case 23:return p.lanes=0,Rp(d,p,S)}return Wa(d,p,S)}var Op,hf,zp,us;Op=function(d,p){for(var S=p.child;S!==null;){if(S.tag===5||S.tag===6)d.appendChild(S.stateNode);else if(S.tag!==4&&S.child!==null){S.child.return=S,S=S.child;continue}if(S===p)break;for(;S.sibling===null;){if(S.return===null||S.return===p)return;S=S.return}S.sibling.return=S.return,S=S.sibling}},hf=function(){},zp=function(d,p,S,R){var F=d.memoizedProps;if(F!==R){d=p.stateNode,tr(Gn.current);var W=null;switch(S){case"input":F=hr(d,F),R=hr(d,R),W=[];break;case"select":F=We({},F,{value:void 0}),R=We({},R,{value:void 0}),W=[];break;case"textarea":F=rs(d,F),R=rs(d,R),W=[];break;default:typeof F.onClick!="function"&&typeof R.onClick=="function"&&(d.onclick=mc)}ri(S,R);var se;S=null;for(st in F)if(!R.hasOwnProperty(st)&&F.hasOwnProperty(st)&&F[st]!=null)if(st==="style"){var Ie=F[st];for(se in Ie)Ie.hasOwnProperty(se)&&(S||(S={}),S[se]="")}else st!=="dangerouslySetInnerHTML"&&st!=="children"&&st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&st!=="autoFocus"&&(u.hasOwnProperty(st)?W||(W=[]):(W=W||[]).push(st,null));for(st in R){var Ve=R[st];if(Ie=F?.[st],R.hasOwnProperty(st)&&Ve!==Ie&&(Ve!=null||Ie!=null))if(st==="style")if(Ie){for(se in Ie)!Ie.hasOwnProperty(se)||Ve&&Ve.hasOwnProperty(se)||(S||(S={}),S[se]="");for(se in Ve)Ve.hasOwnProperty(se)&&Ie[se]!==Ve[se]&&(S||(S={}),S[se]=Ve[se])}else S||(W||(W=[]),W.push(st,S)),S=Ve;else st==="dangerouslySetInnerHTML"?(Ve=Ve?Ve.__html:void 0,Ie=Ie?Ie.__html:void 0,Ve!=null&&Ie!==Ve&&(W=W||[]).push(st,Ve)):st==="children"?typeof Ve!="string"&&typeof Ve!="number"||(W=W||[]).push(st,""+Ve):st!=="suppressContentEditableWarning"&&st!=="suppressHydrationWarning"&&(u.hasOwnProperty(st)?(Ve!=null&&st==="onScroll"&&gr("scroll",d),W||Ie===Ve||(W=[])):(W=W||[]).push(st,Ve))}S&&(W=W||[]).push("style",S);var st=W;(p.updateQueue=st)&&(p.flags|=4)}},us=function(d,p,S,R){S!==R&&(p.flags|=4)};function Iu(d,p){if(!_)switch(d.tailMode){case"hidden":p=d.tail;for(var S=null;p!==null;)p.alternate!==null&&(S=p),p=p.sibling;S===null?d.tail=null:S.sibling=null;break;case"collapsed":S=d.tail;for(var R=null;S!==null;)S.alternate!==null&&(R=S),S=S.sibling;R===null?p||d.tail===null?d.tail=null:d.tail.sibling=null:R.sibling=null}}function ds(d){var p=d.alternate!==null&&d.alternate.child===d.child,S=0,R=0;if(p)for(var F=d.child;F!==null;)S|=F.lanes|F.childLanes,R|=F.subtreeFlags&14680064,R|=F.flags&14680064,F.return=d,F=F.sibling;else for(F=d.child;F!==null;)S|=F.lanes|F.childLanes,R|=F.subtreeFlags,R|=F.flags,F.return=d,F=F.sibling;return d.subtreeFlags|=R,d.childLanes=S,p}function qa(d,p,S){var R=p.pendingProps;switch(g(p),p.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ds(p),null;case 1:return as(p.type)&&Td(),ds(p),null;case 3:return R=p.stateNode,$r(),Nr(Cs),Nr(Ui),Gr(),R.pendingContext&&(R.context=R.pendingContext,R.pendingContext=null),(d===null||d.child===null)&&($(p)?p.flags|=4:d===null||d.memoizedState.isDehydrated&&(p.flags&256)===0||(p.flags|=1024,T!==null&&(Pl(T),T=null))),hf(d,p),ds(p),null;case 5:lo(p);var F=tr(or.current);if(S=p.type,d!==null&&p.stateNode!=null)zp(d,p,S,R,F),d.ref!==p.ref&&(p.flags|=512,p.flags|=2097152);else{if(!R){if(p.stateNode===null)throw Error(r(166));return ds(p),null}if(d=tr(Gn.current),$(p)){R=p.stateNode,S=p.type;var W=p.memoizedProps;switch(R[Ss]=p,R[da]=W,d=(p.mode&1)!==0,S){case"dialog":gr("cancel",R),gr("close",R);break;case"iframe":case"object":case"embed":gr("load",R);break;case"video":case"audio":for(F=0;F<zs.length;F++)gr(zs[F],R);break;case"source":gr("error",R);break;case"img":case"image":case"link":gr("error",R),gr("load",R);break;case"details":gr("toggle",R);break;case"input":_i(R,W),gr("invalid",R);break;case"select":R._wrapperState={wasMultiple:!!W.multiple},gr("invalid",R);break;case"textarea":Wi(R,W),gr("invalid",R)}ri(S,W),F=null;for(var se in W)if(W.hasOwnProperty(se)){var Ie=W[se];se==="children"?typeof Ie=="string"?R.textContent!==Ie&&(W.suppressHydrationWarning!==!0&&vl(R.textContent,Ie,d),F=["children",Ie]):typeof Ie=="number"&&R.textContent!==""+Ie&&(W.suppressHydrationWarning!==!0&&vl(R.textContent,Ie,d),F=["children",""+Ie]):u.hasOwnProperty(se)&&Ie!=null&&se==="onScroll"&&gr("scroll",R)}switch(S){case"input":Cn(R),Xs(R,W,!0);break;case"textarea":Cn(R),_s(R);break;case"select":case"option":break;default:typeof W.onClick=="function"&&(R.onclick=mc)}R=F,p.updateQueue=R,R!==null&&(p.flags|=4)}else{se=F.nodeType===9?F:F.ownerDocument,d==="http://www.w3.org/1999/xhtml"&&(d=Vr(S)),d==="http://www.w3.org/1999/xhtml"?S==="script"?(d=se.createElement("div"),d.innerHTML="<script><\/script>",d=d.removeChild(d.firstChild)):typeof R.is=="string"?d=se.createElement(S,{is:R.is}):(d=se.createElement(S),S==="select"&&(se=d,R.multiple?se.multiple=!0:R.size&&(se.size=R.size))):d=se.createElementNS(d,S),d[Ss]=p,d[da]=R,Op(d,p,!1,!1),p.stateNode=d;e:{switch(se=Rs(S,R),S){case"dialog":gr("cancel",d),gr("close",d),F=R;break;case"iframe":case"object":case"embed":gr("load",d),F=R;break;case"video":case"audio":for(F=0;F<zs.length;F++)gr(zs[F],d);F=R;break;case"source":gr("error",d),F=R;break;case"img":case"image":case"link":gr("error",d),gr("load",d),F=R;break;case"details":gr("toggle",d),F=R;break;case"input":_i(d,R),F=hr(d,R),gr("invalid",d);break;case"option":F=R;break;case"select":d._wrapperState={wasMultiple:!!R.multiple},F=We({},R,{value:void 0}),gr("invalid",d);break;case"textarea":Wi(d,R),F=rs(d,R),gr("invalid",d);break;default:F=R}ri(S,F),Ie=F;for(W in Ie)if(Ie.hasOwnProperty(W)){var Ve=Ie[W];W==="style"?Ai(d,Ve):W==="dangerouslySetInnerHTML"?(Ve=Ve?Ve.__html:void 0,Ve!=null&&Ps(d,Ve)):W==="children"?typeof Ve=="string"?(S!=="textarea"||Ve!=="")&&qi(d,Ve):typeof Ve=="number"&&qi(d,""+Ve):W!=="suppressContentEditableWarning"&&W!=="suppressHydrationWarning"&&W!=="autoFocus"&&(u.hasOwnProperty(W)?Ve!=null&&W==="onScroll"&&gr("scroll",d):Ve!=null&&ie(d,W,Ve,se))}switch(S){case"input":Cn(d),Xs(d,R,!1);break;case"textarea":Cn(d),_s(d);break;case"option":R.value!=null&&d.setAttribute("value",""+Kt(R.value));break;case"select":d.multiple=!!R.multiple,W=R.value,W!=null?ni(d,!!R.multiple,W,!1):R.defaultValue!=null&&ni(d,!!R.multiple,R.defaultValue,!0);break;default:typeof F.onClick=="function"&&(d.onclick=mc)}switch(S){case"button":case"input":case"select":case"textarea":R=!!R.autoFocus;break e;case"img":R=!0;break e;default:R=!1}}R&&(p.flags|=4)}p.ref!==null&&(p.flags|=512,p.flags|=2097152)}return ds(p),null;case 6:if(d&&p.stateNode!=null)us(d,p,d.memoizedProps,R);else{if(typeof R!="string"&&p.stateNode===null)throw Error(r(166));if(S=tr(or.current),tr(Gn.current),$(p)){if(R=p.stateNode,S=p.memoizedProps,R[Ss]=p,(W=R.nodeValue!==S)&&(d=o,d!==null))switch(d.tag){case 3:vl(R.nodeValue,S,(d.mode&1)!==0);break;case 5:d.memoizedProps.suppressHydrationWarning!==!0&&vl(R.nodeValue,S,(d.mode&1)!==0)}W&&(p.flags|=4)}else R=(S.nodeType===9?S:S.ownerDocument).createTextNode(R),R[Ss]=p,p.stateNode=R}return ds(p),null;case 13:if(Nr(In),R=p.memoizedState,d===null||d.memoizedState!==null&&d.memoizedState.dehydrated!==null){if(_&&h!==null&&(p.mode&1)!==0&&(p.flags&128)===0)J(),oe(),p.flags|=98560,W=!1;else if(W=$(p),R!==null&&R.dehydrated!==null){if(d===null){if(!W)throw Error(r(318));if(W=p.memoizedState,W=W!==null?W.dehydrated:null,!W)throw Error(r(317));W[Ss]=p}else oe(),(p.flags&128)===0&&(p.memoizedState=null),p.flags|=4;ds(p),W=!1}else T!==null&&(Pl(T),T=null),W=!0;if(!W)return p.flags&65536?p:null}return(p.flags&128)!==0?(p.lanes=S,p):(R=R!==null,R!==(d!==null&&d.memoizedState!==null)&&R&&(p.child.flags|=8192,(p.mode&1)!==0&&(d===null||(In.current&1)!==0?ar===0&&(ar=3):Sg())),p.updateQueue!==null&&(p.flags|=4),ds(p),null);case 4:return $r(),hf(d,p),d===null&&ca(p.stateNode.containerInfo),ds(p),null;case 10:return Ye(p.type._context),ds(p),null;case 17:return as(p.type)&&Td(),ds(p),null;case 19:if(Nr(In),W=p.memoizedState,W===null)return ds(p),null;if(R=(p.flags&128)!==0,se=W.rendering,se===null)if(R)Iu(W,!1);else{if(ar!==0||d!==null&&(d.flags&128)!==0)for(d=p.child;d!==null;){if(se=fr(d),se!==null){for(p.flags|=128,Iu(W,!1),R=se.updateQueue,R!==null&&(p.updateQueue=R,p.flags|=4),p.subtreeFlags=0,R=S,S=p.child;S!==null;)W=S,d=R,W.flags&=14680066,se=W.alternate,se===null?(W.childLanes=0,W.lanes=d,W.child=null,W.subtreeFlags=0,W.memoizedProps=null,W.memoizedState=null,W.updateQueue=null,W.dependencies=null,W.stateNode=null):(W.childLanes=se.childLanes,W.lanes=se.lanes,W.child=se.child,W.subtreeFlags=0,W.deletions=null,W.memoizedProps=se.memoizedProps,W.memoizedState=se.memoizedState,W.updateQueue=se.updateQueue,W.type=se.type,d=se.dependencies,W.dependencies=d===null?null:{lanes:d.lanes,firstContext:d.firstContext}),S=S.sibling;return Wn(In,In.current&1|2),p.child}d=d.sibling}W.tail!==null&&Ur()>Ld&&(p.flags|=128,R=!0,Iu(W,!1),p.lanes=4194304)}else{if(!R)if(d=fr(se),d!==null){if(p.flags|=128,R=!0,S=d.updateQueue,S!==null&&(p.updateQueue=S,p.flags|=4),Iu(W,!0),W.tail===null&&W.tailMode==="hidden"&&!se.alternate&&!_)return ds(p),null}else 2*Ur()-W.renderingStartTime>Ld&&S!==1073741824&&(p.flags|=128,R=!0,Iu(W,!1),p.lanes=4194304);W.isBackwards?(se.sibling=p.child,p.child=se):(S=W.last,S!==null?S.sibling=se:p.child=se,W.last=se)}return W.tail!==null?(p=W.tail,W.rendering=p,W.tail=p.sibling,W.renderingStartTime=Ur(),p.sibling=null,S=In.current,Wn(In,R?S&1|2:S&1),p):(ds(p),null);case 22:case 23:return Hp(),R=p.memoizedState!==null,d!==null&&d.memoizedState!==null!==R&&(p.flags|=8192),R&&(p.mode&1)!==0?(ai&1073741824)!==0&&(ds(p),p.subtreeFlags&6&&(p.flags|=8192)):ds(p),null;case 24:return null;case 25:return null}throw Error(r(156,p.tag))}function x0(d,p){switch(g(p),p.tag){case 1:return as(p.type)&&Td(),d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 3:return $r(),Nr(Cs),Nr(Ui),Gr(),d=p.flags,(d&65536)!==0&&(d&128)===0?(p.flags=d&-65537|128,p):null;case 5:return lo(p),null;case 13:if(Nr(In),d=p.memoizedState,d!==null&&d.dehydrated!==null){if(p.alternate===null)throw Error(r(340));oe()}return d=p.flags,d&65536?(p.flags=d&-65537|128,p):null;case 19:return Nr(In),null;case 4:return $r(),null;case 10:return Ye(p.type._context),null;case 22:case 23:return Hp(),null;case 24:return null;default:return null}}var Za=!1,Li=!1,Ko=typeof WeakSet=="function"?WeakSet:Set,Yt=null;function Md(d,p){var S=d.ref;if(S!==null)if(typeof S=="function")try{S(null)}catch(R){mi(d,p,R)}else S.current=null}function Pd(d,p,S){try{S()}catch(R){mi(d,p,R)}}var mg=!1;function v0(d,p){if(gc=Ql,d=vp(),Yh(d)){if("selectionStart"in d)var S={start:d.selectionStart,end:d.selectionEnd};else e:{S=(S=d.ownerDocument)&&S.defaultView||window;var R=S.getSelection&&S.getSelection();if(R&&R.rangeCount!==0){S=R.anchorNode;var F=R.anchorOffset,W=R.focusNode;R=R.focusOffset;try{S.nodeType,W.nodeType}catch{S=null;break e}var se=0,Ie=-1,Ve=-1,st=0,Dt=0,jt=d,Mt=null;t:for(;;){for(var sn;jt!==S||F!==0&&jt.nodeType!==3||(Ie=se+F),jt!==W||R!==0&&jt.nodeType!==3||(Ve=se+R),jt.nodeType===3&&(se+=jt.nodeValue.length),(sn=jt.firstChild)!==null;)Mt=jt,jt=sn;for(;;){if(jt===d)break t;if(Mt===S&&++st===F&&(Ie=se),Mt===W&&++Dt===R&&(Ve=se),(sn=jt.nextSibling)!==null)break;jt=Mt,Mt=jt.parentNode}jt=sn}S=Ie===-1||Ve===-1?null:{start:Ie,end:Ve}}else S=null}S=S||{start:0,end:0}}else S=null;for(_d={focusedElem:d,selectionRange:S},Ql=!1,Yt=p;Yt!==null;)if(p=Yt,d=p.child,(p.subtreeFlags&1028)!==0&&d!==null)d.return=p,Yt=d;else for(;Yt!==null;){p=Yt;try{var hn=p.alternate;if((p.flags&1024)!==0)switch(p.tag){case 0:case 11:case 15:break;case 1:if(hn!==null){var pn=hn.memoizedProps,gi=hn.memoizedState,et=p.stateNode,He=et.getSnapshotBeforeUpdate(p.elementType===p.type?pn:ko(p.type,pn),gi);et.__reactInternalSnapshotBeforeUpdate=He}break;case 3:var rt=p.stateNode.containerInfo;rt.nodeType===1?rt.textContent="":rt.nodeType===9&&rt.documentElement&&rt.removeChild(rt.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(r(163))}}catch(Vt){mi(p,p.return,Vt)}if(d=p.sibling,d!==null){d.return=p.return,Yt=d;break}Yt=p.return}return hn=mg,mg=!1,hn}function Mu(d,p,S){var R=p.updateQueue;if(R=R!==null?R.lastEffect:null,R!==null){var F=R=R.next;do{if((F.tag&d)===d){var W=F.destroy;F.destroy=void 0,W!==void 0&&Pd(p,S,W)}F=F.next}while(F!==R)}}function Mo(d,p){if(p=p.updateQueue,p=p!==null?p.lastEffect:null,p!==null){var S=p=p.next;do{if((S.tag&d)===d){var R=S.create;S.destroy=R()}S=S.next}while(S!==p)}}function Ml(d){var p=d.ref;if(p!==null){var S=d.stateNode;d.tag,d=S,typeof p=="function"?p(d):p.current=d}}function gg(d){var p=d.alternate;p!==null&&(d.alternate=null,gg(p)),d.child=null,d.deletions=null,d.sibling=null,d.tag===5&&(p=d.stateNode,p!==null&&(delete p[Ss],delete p[da],delete p[vd],delete p[ef],delete p[Ep])),d.stateNode=null,d.return=null,d.dependencies=null,d.memoizedProps=null,d.memoizedState=null,d.pendingProps=null,d.stateNode=null,d.updateQueue=null}function yg(d){return d.tag===5||d.tag===3||d.tag===4}function I_(d){e:for(;;){for(;d.sibling===null;){if(d.return===null||yg(d.return))return null;d=d.return}for(d.sibling.return=d.return,d=d.sibling;d.tag!==5&&d.tag!==6&&d.tag!==18;){if(d.flags&2||d.child===null||d.tag===4)continue e;d.child.return=d,d=d.child}if(!(d.flags&2))return d.stateNode}}function Rd(d,p,S){var R=d.tag;if(R===5||R===6)d=d.stateNode,p?S.nodeType===8?S.parentNode.insertBefore(d,p):S.insertBefore(d,p):(S.nodeType===8?(p=S.parentNode,p.insertBefore(d,S)):(p=S,p.appendChild(d)),S=S._reactRootContainer,S!=null||p.onclick!==null||(p.onclick=mc));else if(R!==4&&(d=d.child,d!==null))for(Rd(d,p,S),d=d.sibling;d!==null;)Rd(d,p,S),d=d.sibling}function ff(d,p,S){var R=d.tag;if(R===5||R===6)d=d.stateNode,p?S.insertBefore(d,p):S.appendChild(d);else if(R!==4&&(d=d.child,d!==null))for(ff(d,p,S),d=d.sibling;d!==null;)ff(d,p,S),d=d.sibling}var pi=null,ks=!1;function Yo(d,p,S){for(S=S.child;S!==null;)pf(d,p,S),S=S.sibling}function pf(d,p,S){if(xs&&typeof xs.onCommitFiberUnmount=="function")try{xs.onCommitFiberUnmount(Qs,S)}catch{}switch(S.tag){case 5:Li||Md(S,p);case 6:var R=pi,F=ks;pi=null,Yo(d,p,S),pi=R,ks=F,pi!==null&&(ks?(d=pi,S=S.stateNode,d.nodeType===8?d.parentNode.removeChild(S):d.removeChild(S)):pi.removeChild(S.stateNode));break;case 18:pi!==null&&(ks?(d=pi,S=S.stateNode,d.nodeType===8?wu(d.parentNode,S):d.nodeType===1&&wu(d,S),wo(d)):wu(pi,S.stateNode));break;case 4:R=pi,F=ks,pi=S.stateNode.containerInfo,ks=!0,Yo(d,p,S),pi=R,ks=F;break;case 0:case 11:case 14:case 15:if(!Li&&(R=S.updateQueue,R!==null&&(R=R.lastEffect,R!==null))){F=R=R.next;do{var W=F,se=W.destroy;W=W.tag,se!==void 0&&((W&2)!==0||(W&4)!==0)&&Pd(S,p,se),F=F.next}while(F!==R)}Yo(d,p,S);break;case 1:if(!Li&&(Md(S,p),R=S.stateNode,typeof R.componentWillUnmount=="function"))try{R.props=S.memoizedProps,R.state=S.memoizedState,R.componentWillUnmount()}catch(Ie){mi(S,p,Ie)}Yo(d,p,S);break;case 21:Yo(d,p,S);break;case 22:S.mode&1?(Li=(R=Li)||S.memoizedState!==null,Yo(d,p,S),Li=R):Yo(d,p,S);break;default:Yo(d,p,S)}}function _g(d){var p=d.updateQueue;if(p!==null){d.updateQueue=null;var S=d.stateNode;S===null&&(S=d.stateNode=new Ko),p.forEach(function(R){var F=E0.bind(null,d,R);S.has(R)||(S.add(R),R.then(F,F))})}}function Us(d,p){var S=p.deletions;if(S!==null)for(var R=0;R<S.length;R++){var F=S[R];try{var W=d,se=p,Ie=se;e:for(;Ie!==null;){switch(Ie.tag){case 5:pi=Ie.stateNode,ks=!1;break e;case 3:pi=Ie.stateNode.containerInfo,ks=!0;break e;case 4:pi=Ie.stateNode.containerInfo,ks=!0;break e}Ie=Ie.return}if(pi===null)throw Error(r(160));pf(W,se,F),pi=null,ks=!1;var Ve=F.alternate;Ve!==null&&(Ve.return=null),F.return=null}catch(st){mi(F,p,st)}}if(p.subtreeFlags&12854)for(p=p.child;p!==null;)Bp(p,d),p=p.sibling}function Bp(d,p){var S=d.alternate,R=d.flags;switch(d.tag){case 0:case 11:case 14:case 15:if(Us(p,d),ya(d),R&4){try{Mu(3,d,d.return),Mo(3,d)}catch(pn){mi(d,d.return,pn)}try{Mu(5,d,d.return)}catch(pn){mi(d,d.return,pn)}}break;case 1:Us(p,d),ya(d),R&512&&S!==null&&Md(S,S.return);break;case 5:if(Us(p,d),ya(d),R&512&&S!==null&&Md(S,S.return),d.flags&32){var F=d.stateNode;try{qi(F,"")}catch(pn){mi(d,d.return,pn)}}if(R&4&&(F=d.stateNode,F!=null)){var W=d.memoizedProps,se=S!==null?S.memoizedProps:W,Ie=d.type,Ve=d.updateQueue;if(d.updateQueue=null,Ve!==null)try{Ie==="input"&&W.type==="radio"&&W.name!=null&&Xn(F,W),Rs(Ie,se);var st=Rs(Ie,W);for(se=0;se<Ve.length;se+=2){var Dt=Ve[se],jt=Ve[se+1];Dt==="style"?Ai(F,jt):Dt==="dangerouslySetInnerHTML"?Ps(F,jt):Dt==="children"?qi(F,jt):ie(F,Dt,jt,st)}switch(Ie){case"input":Er(F,W);break;case"textarea":Ms(F,W);break;case"select":var Mt=F._wrapperState.wasMultiple;F._wrapperState.wasMultiple=!!W.multiple;var sn=W.value;sn!=null?ni(F,!!W.multiple,sn,!1):Mt!==!!W.multiple&&(W.defaultValue!=null?ni(F,!!W.multiple,W.defaultValue,!0):ni(F,!!W.multiple,W.multiple?[]:"",!1))}F[da]=W}catch(pn){mi(d,d.return,pn)}}break;case 6:if(Us(p,d),ya(d),R&4){if(d.stateNode===null)throw Error(r(162));F=d.stateNode,W=d.memoizedProps;try{F.nodeValue=W}catch(pn){mi(d,d.return,pn)}}break;case 3:if(Us(p,d),ya(d),R&4&&S!==null&&S.memoizedState.isDehydrated)try{wo(p.containerInfo)}catch(pn){mi(d,d.return,pn)}break;case 4:Us(p,d),ya(d);break;case 13:Us(p,d),ya(d),F=d.child,F.flags&8192&&(W=F.memoizedState!==null,F.stateNode.isHidden=W,!W||F.alternate!==null&&F.alternate.memoizedState!==null||(gf=Ur())),R&4&&_g(d);break;case 22:if(Dt=S!==null&&S.memoizedState!==null,d.mode&1?(Li=(st=Li)||Dt,Us(p,d),Li=st):Us(p,d),ya(d),R&8192){if(st=d.memoizedState!==null,(d.stateNode.isHidden=st)&&!Dt&&(d.mode&1)!==0)for(Yt=d,Dt=d.child;Dt!==null;){for(jt=Yt=Dt;Yt!==null;){switch(Mt=Yt,sn=Mt.child,Mt.tag){case 0:case 11:case 14:case 15:Mu(4,Mt,Mt.return);break;case 1:Md(Mt,Mt.return);var hn=Mt.stateNode;if(typeof hn.componentWillUnmount=="function"){R=Mt,S=Mt.return;try{p=R,hn.props=p.memoizedProps,hn.state=p.memoizedState,hn.componentWillUnmount()}catch(pn){mi(R,S,pn)}}break;case 5:Md(Mt,Mt.return);break;case 22:if(Mt.memoizedState!==null){vg(jt);continue}}sn!==null?(sn.return=Mt,Yt=sn):vg(jt)}Dt=Dt.sibling}e:for(Dt=null,jt=d;;){if(jt.tag===5){if(Dt===null){Dt=jt;try{F=jt.stateNode,st?(W=F.style,typeof W.setProperty=="function"?W.setProperty("display","none","important"):W.display="none"):(Ie=jt.stateNode,Ve=jt.memoizedProps.style,se=Ve!=null&&Ve.hasOwnProperty("display")?Ve.display:null,Ie.style.display=Ks("display",se))}catch(pn){mi(d,d.return,pn)}}}else if(jt.tag===6){if(Dt===null)try{jt.stateNode.nodeValue=st?"":jt.memoizedProps}catch(pn){mi(d,d.return,pn)}}else if((jt.tag!==22&&jt.tag!==23||jt.memoizedState===null||jt===d)&&jt.child!==null){jt.child.return=jt,jt=jt.child;continue}if(jt===d)break e;for(;jt.sibling===null;){if(jt.return===null||jt.return===d)break e;Dt===jt&&(Dt=null),jt=jt.return}Dt===jt&&(Dt=null),jt.sibling.return=jt.return,jt=jt.sibling}}break;case 19:Us(p,d),ya(d),R&4&&_g(d);break;case 21:break;default:Us(p,d),ya(d)}}function ya(d){var p=d.flags;if(p&2){try{e:{for(var S=d.return;S!==null;){if(yg(S)){var R=S;break e}S=S.return}throw Error(r(160))}switch(R.tag){case 5:var F=R.stateNode;R.flags&32&&(qi(F,""),R.flags&=-33);var W=I_(d);ff(d,W,F);break;case 3:case 4:var se=R.stateNode.containerInfo,Ie=I_(d);Rd(d,Ie,se);break;default:throw Error(r(161))}}catch(Ve){mi(d,d.return,Ve)}d.flags&=-3}p&4096&&(d.flags&=-4097)}function Nd(d,p,S){Yt=d,xg(d)}function xg(d,p,S){for(var R=(d.mode&1)!==0;Yt!==null;){var F=Yt,W=F.child;if(F.tag===22&&R){var se=F.memoizedState!==null||Za;if(!se){var Ie=F.alternate,Ve=Ie!==null&&Ie.memoizedState!==null||Li;Ie=Za;var st=Li;if(Za=se,(Li=Ve)&&!st)for(Yt=F;Yt!==null;)se=Yt,Ve=se.child,se.tag===22&&se.memoizedState!==null?M_(F):Ve!==null?(Ve.return=se,Yt=Ve):M_(F);for(;W!==null;)Yt=W,xg(W),W=W.sibling;Yt=F,Za=Ie,Li=st}Fp(d)}else(F.subtreeFlags&8772)!==0&&W!==null?(W.return=F,Yt=W):Fp(d)}}function Fp(d){for(;Yt!==null;){var p=Yt;if((p.flags&8772)!==0){var S=p.alternate;try{if((p.flags&8772)!==0)switch(p.tag){case 0:case 11:case 15:Li||Mo(5,p);break;case 1:var R=p.stateNode;if(p.flags&4&&!Li)if(S===null)R.componentDidMount();else{var F=p.elementType===p.type?S.memoizedProps:ko(p.type,S.memoizedProps);R.componentDidUpdate(F,S.memoizedState,R.__reactInternalSnapshotBeforeUpdate)}var W=p.updateQueue;W!==null&&Fn(p,W,R);break;case 3:var se=p.updateQueue;if(se!==null){if(S=null,p.child!==null)switch(p.child.tag){case 5:S=p.child.stateNode;break;case 1:S=p.child.stateNode}Fn(p,se,S)}break;case 5:var Ie=p.stateNode;if(S===null&&p.flags&4){S=Ie;var Ve=p.memoizedProps;switch(p.type){case"button":case"input":case"select":case"textarea":Ve.autoFocus&&S.focus();break;case"img":Ve.src&&(S.src=Ve.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(p.memoizedState===null){var st=p.alternate;if(st!==null){var Dt=st.memoizedState;if(Dt!==null){var jt=Dt.dehydrated;jt!==null&&wo(jt)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(r(163))}Li||p.flags&512&&Ml(p)}catch(Mt){mi(p,p.return,Mt)}}if(p===d){Yt=null;break}if(S=p.sibling,S!==null){S.return=p.return,Yt=S;break}Yt=p.return}}function vg(d){for(;Yt!==null;){var p=Yt;if(p===d){Yt=null;break}var S=p.sibling;if(S!==null){S.return=p.return,Yt=S;break}Yt=p.return}}function M_(d){for(;Yt!==null;){var p=Yt;try{switch(p.tag){case 0:case 11:case 15:var S=p.return;try{Mo(4,p)}catch(Ve){mi(p,S,Ve)}break;case 1:var R=p.stateNode;if(typeof R.componentDidMount=="function"){var F=p.return;try{R.componentDidMount()}catch(Ve){mi(p,F,Ve)}}var W=p.return;try{Ml(p)}catch(Ve){mi(p,W,Ve)}break;case 5:var se=p.return;try{Ml(p)}catch(Ve){mi(p,se,Ve)}}}catch(Ve){mi(p,p.return,Ve)}if(p===d){Yt=null;break}var Ie=p.sibling;if(Ie!==null){Ie.return=p.return,Yt=Ie;break}Yt=p.return}}var w0=Math.ceil,Ac=pe.ReactCurrentDispatcher,Vp=pe.ReactCurrentOwner,Gi=pe.ReactCurrentBatchConfig,dn=0,ji=null,kr=null,Fr=0,ai=0,Yi=ha(0),ar=0,Dd=null,Yr=0,mf=0,Ic=0,Pu=null,$s=null,gf=0,Ld=1/0,_a=null,yf=!1,wg=null,As=null,Xa=!1,xa=null,Ru=0,Nu=0,Up=null,$p=-1,_f=0;function Gs(){return(dn&6)!==0?Ur():$p!==-1?$p:$p=Ur()}function Ka(d){return(d.mode&1)===0?1:(dn&2)!==0&&Fr!==0?Fr&-Fr:fe.transition!==null?(_f===0&&(_f=vs()),_f):(d=rr,d!==0||(d=window.event,d=d===void 0?16:sd(d.type)),d)}function va(d,p,S,R){if(50<Nu)throw Nu=0,Up=null,Error(r(185));Rn(d,S,R),((dn&2)===0||d!==ji)&&(d===ji&&((dn&2)===0&&(mf|=S),ar===4&&Mc(d,Fr)),Is(d,R),S===1&&dn===0&&(p.mode&1)===0&&(Ld=Ur()+500,vc&&Ot()))}function Is(d,p){var S=d.callbackNode;Hn(d,p);var R=ia(d,d===ji?Fr:0);if(R===0)S!==null&&nr(S),d.callbackNode=null,d.callbackPriority=0;else if(p=R&-R,d.callbackPriority!==p){if(S!=null&&nr(S),p===1)d.tag===0?Sl(Du.bind(null,d)):Tl(Du.bind(null,d)),Sp(function(){(dn&6)===0&&Ot()}),S=null;else{switch(js(R)){case 1:S=Js;break;case 4:S=Bo;break;case 16:S=Zl;break;case 536870912:S=ka;break;default:S=Zl}S=vf(S,bg.bind(null,d))}d.callbackPriority=p,d.callbackNode=S}}function bg(d,p){if($p=-1,_f=0,(dn&6)!==0)throw Error(r(327));var S=d.callbackNode;if(fo()&&d.callbackNode!==S)return null;var R=ia(d,d===ji?Fr:0);if(R===0)return null;if((R&30)!==0||(R&d.expiredLanes)!==0||p)p=xf(d,R);else{p=R;var F=dn;dn|=2;var W=Tg();(ji!==d||Fr!==p)&&(_a=null,Ld=Ur()+500,Lu(d,p));do try{T0();break}catch(Ie){R_(d,Ie)}while(!0);Ue(),Ac.current=W,dn=F,kr!==null?p=0:(ji=null,Fr=0,p=ar)}if(p!==0){if(p===2&&(F=Bn(d),F!==0&&(R=F,p=Gp(d,F))),p===1)throw S=Dd,Lu(d,0),Mc(d,R),Is(d,Ur()),S;if(p===6)Mc(d,R);else{if(F=d.current.alternate,(R&30)===0&&!P_(F)&&(p=xf(d,R),p===2&&(W=Bn(d),W!==0&&(R=W,p=Gp(d,W))),p===1))throw S=Dd,Lu(d,0),Mc(d,R),Is(d,Ur()),S;switch(d.finishedWork=F,d.finishedLanes=R,p){case 0:case 1:throw Error(r(345));case 2:Rc(d,$s,_a);break;case 3:if(Mc(d,R),(R&130023424)===R&&(p=gf+500-Ur(),10<p)){if(ia(d,0)!==0)break;if(F=d.suspendedLanes,(F&R)!==R){Gs(),d.pingedLanes|=d.suspendedLanes&F;break}d.timeoutHandle=Oa(Rc.bind(null,d,$s,_a),p);break}Rc(d,$s,_a);break;case 4:if(Mc(d,R),(R&4194240)===R)break;for(p=d.eventTimes,F=-1;0<R;){var se=31-bi(R);W=1<<se,se=p[se],se>F&&(F=se),R&=~W}if(R=F,R=Ur()-R,R=(120>R?120:480>R?480:1080>R?1080:1920>R?1920:3e3>R?3e3:4320>R?4320:1960*w0(R/1960))-R,10<R){d.timeoutHandle=Oa(Rc.bind(null,d,$s,_a),R);break}Rc(d,$s,_a);break;case 5:Rc(d,$s,_a);break;default:throw Error(r(329))}}}return Is(d,Ur()),d.callbackNode===S?bg.bind(null,d):null}function Gp(d,p){var S=Pu;return d.current.memoizedState.isDehydrated&&(Lu(d,p).flags|=256),d=xf(d,p),d!==2&&(p=$s,$s=S,p!==null&&Pl(p)),d}function Pl(d){$s===null?$s=d:$s.push.apply($s,d)}function P_(d){for(var p=d;;){if(p.flags&16384){var S=p.updateQueue;if(S!==null&&(S=S.stores,S!==null))for(var R=0;R<S.length;R++){var F=S[R],W=F.getSnapshot;F=F.value;try{if(!so(W(),F))return!1}catch{return!1}}}if(S=p.child,p.subtreeFlags&16384&&S!==null)S.return=p,p=S;else{if(p===d)break;for(;p.sibling===null;){if(p.return===null||p.return===d)return!0;p=p.return}p.sibling.return=p.return,p=p.sibling}}return!0}function Mc(d,p){for(p&=~Ic,p&=~mf,d.suspendedLanes|=p,d.pingedLanes&=~p,d=d.expirationTimes;0<p;){var S=31-bi(p),R=1<<S;d[S]=-1,p&=~R}}function Du(d){if((dn&6)!==0)throw Error(r(327));fo();var p=ia(d,0);if((p&1)===0)return Is(d,Ur()),null;var S=xf(d,p);if(d.tag!==0&&S===2){var R=Bn(d);R!==0&&(p=R,S=Gp(d,R))}if(S===1)throw S=Dd,Lu(d,0),Mc(d,p),Is(d,Ur()),S;if(S===6)throw Error(r(345));return d.finishedWork=d.current.alternate,d.finishedLanes=p,Rc(d,$s,_a),Is(d,Ur()),null}function jd(d,p){var S=dn;dn|=1;try{return d(p)}finally{dn=S,dn===0&&(Ld=Ur()+500,vc&&Ot())}}function Pc(d){xa!==null&&xa.tag===0&&(dn&6)===0&&fo();var p=dn;dn|=1;var S=Gi.transition,R=rr;try{if(Gi.transition=null,rr=1,d)return d()}finally{rr=R,Gi.transition=S,dn=p,(dn&6)===0&&Ot()}}function Hp(){ai=Yi.current,Nr(Yi)}function Lu(d,p){d.finishedWork=null,d.finishedLanes=0;var S=d.timeoutHandle;if(S!==-1&&(d.timeoutHandle=-1,Qh(S)),kr!==null)for(S=kr.return;S!==null;){var R=S;switch(g(R),R.tag){case 1:R=R.type.childContextTypes,R!=null&&Td();break;case 3:$r(),Nr(Cs),Nr(Ui),Gr();break;case 5:lo(R);break;case 4:$r();break;case 13:Nr(In);break;case 19:Nr(In);break;case 10:Ye(R.type._context);break;case 22:case 23:Hp()}S=S.return}if(ji=d,kr=d=Nc(d.current,null),Fr=ai=p,ar=0,Dd=null,Ic=mf=Yr=0,$s=Pu=null,Je!==null){for(p=0;p<Je.length;p++)if(S=Je[p],R=S.interleaved,R!==null){S.interleaved=null;var F=R.next,W=S.pending;if(W!==null){var se=W.next;W.next=F,R.next=se}S.pending=R}Je=null}return d}function R_(d,p){do{var S=kr;try{if(Ue(),Di.current=ls,co){for(var R=Dr.memoizedState;R!==null;){var F=R.queue;F!==null&&(F.pending=null),R=R.next}co=!1}if(hi=0,Kr=Or=Dr=null,uo=!1,Co=0,Vp.current=null,S===null||S.return===null){ar=1,Dd=p,kr=null;break}e:{var W=d,se=S.return,Ie=S,Ve=p;if(p=Fr,Ie.flags|=32768,Ve!==null&&typeof Ve=="object"&&typeof Ve.then=="function"){var st=Ve,Dt=Ie,jt=Dt.tag;if((Dt.mode&1)===0&&(jt===0||jt===11||jt===15)){var Mt=Dt.alternate;Mt?(Dt.updateQueue=Mt.updateQueue,Dt.memoizedState=Mt.memoizedState,Dt.lanes=Mt.lanes):(Dt.updateQueue=null,Dt.memoizedState=null)}var sn=Pp(se);if(sn!==null){sn.flags&=-257,hg(sn,se,Ie,W,p),sn.mode&1&&Ha(W,st,p),p=sn,Ve=st;var hn=p.updateQueue;if(hn===null){var pn=new Set;pn.add(Ve),p.updateQueue=pn}else hn.add(Ve);break e}else{if((p&1)===0){Ha(W,st,p),Sg();break e}Ve=Error(r(426))}}else if(_&&Ie.mode&1){var gi=Pp(se);if(gi!==null){(gi.flags&65536)===0&&(gi.flags|=256),hg(gi,se,Ie,W,p),ce(ku(Ve,Ie));break e}}W=Ve=ku(Ve,Ie),ar!==4&&(ar=2),Pu===null?Pu=[W]:Pu.push(W),W=se;do{switch(W.tag){case 3:W.flags|=65536,p&=-p,W.lanes|=p;var et=kd(W,Ve,p);un(W,et);break e;case 1:Ie=Ve;var He=W.type,rt=W.stateNode;if((W.flags&128)===0&&(typeof He.getDerivedStateFromError=="function"||rt!==null&&typeof rt.componentDidCatch=="function"&&(As===null||!As.has(rt)))){W.flags|=65536,p&=-p,W.lanes|=p;var Vt=Au(W,Ie,p);un(W,Vt);break e}}W=W.return}while(W!==null)}Cg(S)}catch(mn){p=mn,kr===S&&S!==null&&(kr=S=S.return);continue}break}while(!0)}function Tg(){var d=Ac.current;return Ac.current=ls,d===null?ls:d}function Sg(){(ar===0||ar===3||ar===2)&&(ar=4),ji===null||(Yr&268435455)===0&&(mf&268435455)===0||Mc(ji,Fr)}function xf(d,p){var S=dn;dn|=2;var R=Tg();(ji!==d||Fr!==p)&&(_a=null,Lu(d,p));do try{b0();break}catch(F){R_(d,F)}while(!0);if(Ue(),dn=S,Ac.current=R,kr!==null)throw Error(r(261));return ji=null,Fr=0,ar}function b0(){for(;kr!==null;)Eg(kr)}function T0(){for(;kr!==null&&!kh();)Eg(kr)}function Eg(d){var p=Wp(d.alternate,d,ai);d.memoizedProps=d.pendingProps,p===null?Cg(d):kr=p,Vp.current=null}function Cg(d){var p=d;do{var S=p.alternate;if(d=p.return,(p.flags&32768)===0){if(S=qa(S,p,ai),S!==null){kr=S;return}}else{if(S=x0(S,p),S!==null){S.flags&=32767,kr=S;return}if(d!==null)d.flags|=32768,d.subtreeFlags=0,d.deletions=null;else{ar=6,kr=null;return}}if(p=p.sibling,p!==null){kr=p;return}kr=p=d}while(p!==null);ar===0&&(ar=5)}function Rc(d,p,S){var R=rr,F=Gi.transition;try{Gi.transition=null,rr=1,kg(d,p,S,R)}finally{Gi.transition=F,rr=R}return null}function kg(d,p,S,R){do fo();while(xa!==null);if((dn&6)!==0)throw Error(r(327));S=d.finishedWork;var F=d.finishedLanes;if(S===null)return null;if(d.finishedWork=null,d.finishedLanes=0,S===d.current)throw Error(r(177));d.callbackNode=null,d.callbackPriority=0;var W=S.lanes|S.childLanes;if(Ls(d,W),d===ji&&(kr=ji=null,Fr=0),(S.subtreeFlags&2064)===0&&(S.flags&2064)===0||Xa||(Xa=!0,vf(Zl,function(){return fo(),null})),W=(S.flags&15990)!==0,(S.subtreeFlags&15990)!==0||W){W=Gi.transition,Gi.transition=null;var se=rr;rr=1;var Ie=dn;dn|=4,Vp.current=null,v0(d,S),Bp(S,d),ig(_d),Ql=!!gc,_d=gc=null,d.current=S,Nd(S),Qc(),dn=Ie,rr=se,Gi.transition=W}else d.current=S;if(Xa&&(Xa=!1,xa=d,Ru=F),W=d.pendingLanes,W===0&&(As=null),dt(S.stateNode),Is(d,Ur()),p!==null)for(R=d.onRecoverableError,S=0;S<p.length;S++)F=p[S],R(F.value,{componentStack:F.stack,digest:F.digest});if(yf)throw yf=!1,d=wg,wg=null,d;return(Ru&1)!==0&&d.tag!==0&&fo(),W=d.pendingLanes,(W&1)!==0?d===Up?Nu++:(Nu=0,Up=d):Nu=0,Ot(),null}function fo(){if(xa!==null){var d=js(Ru),p=Gi.transition,S=rr;try{if(Gi.transition=null,rr=16>d?16:d,xa===null)var R=!1;else{if(d=xa,xa=null,Ru=0,(dn&6)!==0)throw Error(r(331));var F=dn;for(dn|=4,Yt=d.current;Yt!==null;){var W=Yt,se=W.child;if((Yt.flags&16)!==0){var Ie=W.deletions;if(Ie!==null){for(var Ve=0;Ve<Ie.length;Ve++){var st=Ie[Ve];for(Yt=st;Yt!==null;){var Dt=Yt;switch(Dt.tag){case 0:case 11:case 15:Mu(8,Dt,W)}var jt=Dt.child;if(jt!==null)jt.return=Dt,Yt=jt;else for(;Yt!==null;){Dt=Yt;var Mt=Dt.sibling,sn=Dt.return;if(gg(Dt),Dt===st){Yt=null;break}if(Mt!==null){Mt.return=sn,Yt=Mt;break}Yt=sn}}}var hn=W.alternate;if(hn!==null){var pn=hn.child;if(pn!==null){hn.child=null;do{var gi=pn.sibling;pn.sibling=null,pn=gi}while(pn!==null)}}Yt=W}}if((W.subtreeFlags&2064)!==0&&se!==null)se.return=W,Yt=se;else e:for(;Yt!==null;){if(W=Yt,(W.flags&2048)!==0)switch(W.tag){case 0:case 11:case 15:Mu(9,W,W.return)}var et=W.sibling;if(et!==null){et.return=W.return,Yt=et;break e}Yt=W.return}}var He=d.current;for(Yt=He;Yt!==null;){se=Yt;var rt=se.child;if((se.subtreeFlags&2064)!==0&&rt!==null)rt.return=se,Yt=rt;else e:for(se=He;Yt!==null;){if(Ie=Yt,(Ie.flags&2048)!==0)try{switch(Ie.tag){case 0:case 11:case 15:Mo(9,Ie)}}catch(mn){mi(Ie,Ie.return,mn)}if(Ie===se){Yt=null;break e}var Vt=Ie.sibling;if(Vt!==null){Vt.return=Ie.return,Yt=Vt;break e}Yt=Ie.return}}if(dn=F,Ot(),xs&&typeof xs.onPostCommitFiberRoot=="function")try{xs.onPostCommitFiberRoot(Qs,d)}catch{}R=!0}return R}finally{rr=S,Gi.transition=p}}return!1}function Hs(d,p,S){p=ku(S,p),p=kd(d,p,1),d=yn(d,p,1),p=Gs(),d!==null&&(Rn(d,1,p),Is(d,p))}function mi(d,p,S){if(d.tag===3)Hs(d,d,S);else for(;p!==null;){if(p.tag===3){Hs(p,d,S);break}else if(p.tag===1){var R=p.stateNode;if(typeof p.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(As===null||!As.has(R))){d=ku(S,d),d=Au(p,d,1),p=yn(p,d,1),d=Gs(),p!==null&&(Rn(p,1,d),Is(p,d));break}}p=p.return}}function Ag(d,p,S){var R=d.pingCache;R!==null&&R.delete(p),p=Gs(),d.pingedLanes|=d.suspendedLanes&S,ji===d&&(Fr&S)===S&&(ar===4||ar===3&&(Fr&130023424)===Fr&&500>Ur()-gf?Lu(d,0):Ic|=S),Is(d,p)}function N_(d,p){p===0&&((d.mode&1)===0?p=1:(p=Xl,Xl<<=1,(Xl&130023424)===0&&(Xl=4194304)));var S=Gs();d=lt(d,p),d!==null&&(Rn(d,p,S),Is(d,S))}function S0(d){var p=d.memoizedState,S=0;p!==null&&(S=p.retryLane),N_(d,S)}function E0(d,p){var S=0;switch(d.tag){case 13:var R=d.stateNode,F=d.memoizedState;F!==null&&(S=F.retryLane);break;case 19:R=d.stateNode;break;default:throw Error(r(314))}R!==null&&R.delete(p),N_(d,S)}var Wp;Wp=function(d,p,S){if(d!==null)if(d.memoizedProps!==p.pendingProps||Cs.current)Ki=!0;else{if((d.lanes&S)===0&&(p.flags&128)===0)return Ki=!1,df(d,p,S);Ki=(d.flags&131072)!==0}else Ki=!1,_&&(p.flags&1048576)!==0&&Sd(p,bc,p.index);switch(p.lanes=0,p.tag){case 2:var R=p.type;uf(d,p),d=p.pendingProps;var F=$i(p,Ui.current);qe(p,S),F=Cp(null,p,R,d,F,S);var W=kp();return p.flags|=1,typeof F=="object"&&F!==null&&typeof F.render=="function"&&F.$$typeof===void 0?(p.tag=1,p.memoizedState=null,p.updateQueue=null,as(R)?(W=!0,qo(p)):W=!1,p.memoizedState=F.state!==null&&F.state!==void 0?F.state:null,xt(p),F.updater=Ec,p.stateNode=F,F._reactInternals=p,Mp(p,R,d,S),p=Io(null,p,R,!0,W,S)):(p.tag=0,_&&W&&Va(p),zr(null,p,F,S),p=p.child),p;case 16:R=p.elementType;e:{switch(uf(d,p),d=p.pendingProps,F=R._init,R=F(R._payload),p.type=R,F=p.tag=C0(R),d=ko(R,d),F){case 0:p=Np(null,p,R,d,S);break e;case 1:p=Id(null,p,R,d,S);break e;case 11:p=Ad(null,p,R,d,S);break e;case 14:p=cs(null,p,R,ko(R.type,d),S);break e}throw Error(r(306,R,""))}return p;case 0:return R=p.type,F=p.pendingProps,F=p.elementType===R?F:ko(R,F),Np(d,p,R,F,S);case 1:return R=p.type,F=p.pendingProps,F=p.elementType===R?F:ko(R,F),Id(d,p,R,F,S);case 3:e:{if(E_(p),d===null)throw Error(r(387));R=p.pendingProps,W=p.memoizedState,F=W.element,At(d,p),jn(p,R,null,S);var se=p.memoizedState;if(R=se.element,W.isDehydrated)if(W={element:R,isDehydrated:!1,cache:se.cache,pendingSuspenseBoundaries:se.pendingSuspenseBoundaries,transitions:se.transitions},p.updateQueue.baseState=W,p.memoizedState=W,p.flags&256){F=ku(Error(r(423)),p),p=C_(d,p,R,S,F);break e}else if(R!==F){F=ku(Error(r(424)),p),p=C_(d,p,R,S,F);break e}else for(h=Wo(p.stateNode.containerInfo.firstChild),o=p,_=!0,T=null,S=ve(p,null,R,S),p.child=S;S;)S.flags=S.flags&-3|4096,S=S.sibling;else{if(oe(),R===F){p=Wa(d,p,S);break e}zr(d,p,R,S)}p=p.child}return p;case 5:return Vs(p),d===null&&B(p),R=p.type,F=p.pendingProps,W=d!==null?d.memoizedProps:null,se=F.children,yc(R,F)?se=null:W!==null&&yc(R,W)&&(p.flags|=32),Hr(d,p),zr(d,p,se,S),p.child;case 6:return d===null&&B(p),null;case 13:return kc(d,p,S);case 4:return Ni(p,p.stateNode.containerInfo),R=p.pendingProps,d===null?p.child=_e(p,null,R,S):zr(d,p,R,S),p.child;case 11:return R=p.type,F=p.pendingProps,F=p.elementType===R?F:ko(R,F),Ad(d,p,R,F,S);case 7:return zr(d,p,p.pendingProps,S),p.child;case 8:return zr(d,p,p.pendingProps.children,S),p.child;case 12:return zr(d,p,p.pendingProps.children,S),p.child;case 10:e:{if(R=p.type._context,F=p.pendingProps,W=p.memoizedProps,se=F.value,Wn(Ne,R._currentValue),R._currentValue=se,W!==null)if(so(W.value,se)){if(W.children===F.children&&!Cs.current){p=Wa(d,p,S);break e}}else for(W=p.child,W!==null&&(W.return=p);W!==null;){var Ie=W.dependencies;if(Ie!==null){se=W.child;for(var Ve=Ie.firstContext;Ve!==null;){if(Ve.context===R){if(W.tag===1){Ve=Qt(-1,S&-S),Ve.tag=2;var st=W.updateQueue;if(st!==null){st=st.shared;var Dt=st.pending;Dt===null?Ve.next=Ve:(Ve.next=Dt.next,Dt.next=Ve),st.pending=Ve}}W.lanes|=S,Ve=W.alternate,Ve!==null&&(Ve.lanes|=S),kt(W.return,S,p),Ie.lanes|=S;break}Ve=Ve.next}}else if(W.tag===10)se=W.type===p.type?null:W.child;else if(W.tag===18){if(se=W.return,se===null)throw Error(r(341));se.lanes|=S,Ie=se.alternate,Ie!==null&&(Ie.lanes|=S),kt(se,S,p),se=W.sibling}else se=W.child;if(se!==null)se.return=W;else for(se=W;se!==null;){if(se===p){se=null;break}if(W=se.sibling,W!==null){W.return=se.return,se=W;break}se=se.return}W=se}zr(d,p,F.children,S),p=p.child}return p;case 9:return F=p.type,R=p.pendingProps.children,qe(p,S),F=at(F),R=R(F),p.flags|=1,zr(d,p,R,S),p.child;case 14:return R=p.type,F=ko(R,p.pendingProps),F=ko(R.type,F),cs(d,p,R,F,S);case 15:return Ao(d,p,p.type,p.pendingProps,S);case 17:return R=p.type,F=p.pendingProps,F=p.elementType===R?F:ko(R,F),uf(d,p),p.tag=1,as(R)?(d=!0,qo(p)):d=!1,qe(p,S),Ip(p,R,F),Mp(p,R,F,S),Io(null,p,R,!0,d,S);case 19:return A_(d,p,S);case 22:return Rp(d,p,S)}throw Error(r(156,p.tag))};function vf(d,p){return Ch(d,p)}function D_(d,p,S,R){this.tag=d,this.key=S,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=p,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ji(d,p,S,R){return new D_(d,p,S,R)}function ju(d){return d=d.prototype,!(!d||!d.isReactComponent)}function C0(d){if(typeof d=="function")return ju(d)?1:0;if(d!=null){if(d=d.$$typeof,d===ut)return 11;if(d===Lt)return 14}return 2}function Nc(d,p){var S=d.alternate;return S===null?(S=Ji(d.tag,p,d.key,d.mode),S.elementType=d.elementType,S.type=d.type,S.stateNode=d.stateNode,S.alternate=d,d.alternate=S):(S.pendingProps=p,S.type=d.type,S.flags=0,S.subtreeFlags=0,S.deletions=null),S.flags=d.flags&14680064,S.childLanes=d.childLanes,S.lanes=d.lanes,S.child=d.child,S.memoizedProps=d.memoizedProps,S.memoizedState=d.memoizedState,S.updateQueue=d.updateQueue,p=d.dependencies,S.dependencies=p===null?null:{lanes:p.lanes,firstContext:p.firstContext},S.sibling=d.sibling,S.index=d.index,S.ref=d.ref,S}function qp(d,p,S,R,F,W){var se=2;if(R=d,typeof d=="function")ju(d)&&(se=1);else if(typeof d=="string")se=5;else e:switch(d){case ze:return Ou(S.children,F,W,p);case Ge:se=8,F|=8;break;case tt:return d=Ji(12,S,p,F|2),d.elementType=tt,d.lanes=W,d;case gt:return d=Ji(13,S,p,F),d.elementType=gt,d.lanes=W,d;case ht:return d=Ji(19,S,p,F),d.elementType=ht,d.lanes=W,d;case pt:return Zp(S,F,W,p);default:if(typeof d=="object"&&d!==null)switch(d.$$typeof){case Pe:se=10;break e;case ot:se=9;break e;case ut:se=11;break e;case Lt:se=14;break e;case mt:se=16,R=null;break e}throw Error(r(130,d==null?d:typeof d,""))}return p=Ji(se,S,p,F),p.elementType=d,p.type=R,p.lanes=W,p}function Ou(d,p,S,R){return d=Ji(7,d,R,p),d.lanes=S,d}function Zp(d,p,S,R){return d=Ji(22,d,R,p),d.elementType=pt,d.lanes=S,d.stateNode={isHidden:!1},d}function Ig(d,p,S){return d=Ji(6,d,null,p),d.lanes=S,d}function Mg(d,p,S){return p=Ji(4,d.children!==null?d.children:[],d.key,p),p.lanes=S,p.stateNode={containerInfo:d.containerInfo,pendingChildren:null,implementation:d.implementation},p}function Pg(d,p,S,R,F){this.tag=p,this.containerInfo=d,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ds(0),this.expirationTimes=Ds(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ds(0),this.identifierPrefix=R,this.onRecoverableError=F,this.mutableSourceEagerHydrationData=null}function Rg(d,p,S,R,F,W,se,Ie,Ve){return d=new Pg(d,p,S,Ie,Ve),p===1?(p=1,W===!0&&(p|=8)):p=0,W=Ji(3,null,null,p),d.current=W,W.stateNode=d,W.memoizedState={element:R,isDehydrated:S,cache:null,transitions:null,pendingSuspenseBoundaries:null},xt(W),d}function Od(d,p,S){var R=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ke,key:R==null?null:""+R,children:d,containerInfo:p,implementation:S}}function L_(d){if(!d)return Ba;d=d._reactInternals;e:{if(Rr(d)!==d||d.tag!==1)throw Error(r(170));var p=d;do{switch(p.tag){case 3:p=p.stateNode.context;break e;case 1:if(as(p.type)){p=p.stateNode.__reactInternalMemoizedMergedChildContext;break e}}p=p.return}while(p!==null);throw Error(r(171))}if(d.tag===1){var S=d.type;if(as(S))return So(d,S,p)}return p}function Jr(d,p,S,R,F,W,se,Ie,Ve){return d=Rg(S,R,!0,d,F,W,se,Ie,Ve),d.context=L_(null),S=d.current,R=Gs(),F=Ka(S),W=Qt(R,F),W.callback=p??null,yn(S,W,F),d.current.lanes=F,Rn(d,F,R),Is(d,R),d}function zu(d,p,S,R){var F=p.current,W=Gs(),se=Ka(F);return S=L_(S),p.context===null?p.context=S:p.pendingContext=S,p=Qt(W,se),p.payload={element:d},R=R===void 0?null:R,R!==null&&(p.callback=R),d=yn(F,p,se),d!==null&&(va(d,F,se,W),qt(d,F,se)),se}function wf(d){return d=d.current,d.child?(d.child.tag===5,d.child.stateNode):null}function bf(d,p){if(d=d.memoizedState,d!==null&&d.dehydrated!==null){var S=d.retryLane;d.retryLane=S!==0&&S<p?S:p}}function zd(d,p){bf(d,p),(d=d.alternate)&&bf(d,p)}function Tf(){return null}var Ng=typeof reportError=="function"?reportError:function(d){console.error(d)};function Xp(d){this._internalRoot=d}Dc.prototype.render=Xp.prototype.render=function(d){var p=this._internalRoot;if(p===null)throw Error(r(409));zu(d,p,null,null)},Dc.prototype.unmount=Xp.prototype.unmount=function(){var d=this._internalRoot;if(d!==null){this._internalRoot=null;var p=d.containerInfo;Pc(function(){zu(null,d,null,null)}),p[To]=null}};function Dc(d){this._internalRoot=d}Dc.prototype.unstable_scheduleHydration=function(d){if(d){var p=Yl();d={blockedOn:null,target:d,priority:p};for(var S=0;S<_r.length&&p!==0&&p<_r[S].priority;S++);_r.splice(S,0,d),S===0&&Mh(d)}};function Sf(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)}function Bd(d){return!(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11&&(d.nodeType!==8||d.nodeValue!==" react-mount-point-unstable "))}function Kp(){}function k0(d,p,S,R,F){if(F){if(typeof R=="function"){var W=R;R=function(){var st=wf(se);W.call(st)}}var se=Jr(p,R,d,0,null,!1,!1,"",Kp);return d._reactRootContainer=se,d[To]=se.current,ca(d.nodeType===8?d.parentNode:d),Pc(),se}for(;F=d.lastChild;)d.removeChild(F);if(typeof R=="function"){var Ie=R;R=function(){var st=wf(Ve);Ie.call(st)}}var Ve=Rg(d,0,!1,null,null,!1,!1,"",Kp);return d._reactRootContainer=Ve,d[To]=Ve.current,ca(d.nodeType===8?d.parentNode:d),Pc(function(){zu(p,Ve,S,R)}),Ve}function Ef(d,p,S,R,F){var W=S._reactRootContainer;if(W){var se=W;if(typeof F=="function"){var Ie=F;F=function(){var Ve=wf(se);Ie.call(Ve)}}zu(p,se,d,F)}else se=k0(S,p,d,F,R);return wf(se)}Cr=function(d){switch(d.tag){case 3:var p=d.stateNode;if(p.current.memoizedState.isDehydrated){var S=Kl(p.pendingLanes);S!==0&&(cl(p,S|1),Is(p,Ur()),(dn&6)===0&&(Ld=Ur()+500,Ot()))}break;case 13:Pc(function(){var R=lt(d,1);if(R!==null){var F=Gs();va(R,d,1,F)}}),zd(d,1)}},rd=function(d){if(d.tag===13){var p=lt(d,134217728);if(p!==null){var S=Gs();va(p,d,134217728,S)}zd(d,134217728)}},Fo=function(d){if(d.tag===13){var p=Ka(d),S=lt(d,p);if(S!==null){var R=Gs();va(S,d,p,R)}zd(d,p)}},Yl=function(){return rr},Jl=function(d,p){var S=rr;try{return rr=d,p()}finally{rr=S}},Te=function(d,p,S){switch(p){case"input":if(Er(d,S),p=S.name,S.type==="radio"&&p!=null){for(S=d;S.parentNode;)S=S.parentNode;for(S=S.querySelectorAll("input[name="+JSON.stringify(""+p)+'][type="radio"]'),p=0;p<S.length;p++){var R=S[p];if(R!==d&&R.form===d.form){var F=wd(R);if(!F)throw Error(r(90));tn(R),Er(R,F)}}}break;case"textarea":Ms(d,S);break;case"select":p=S.value,p!=null&&ni(d,!!S.multiple,p,!1)}},Oe=jd,Be=Pc;var Cf={usingClientEntryPoint:!1,Events:[xc,wl,wd,Se,be,jd]},kf={findFiberByHostInstance:Es,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Dg={bundleType:kf.bundleType,version:kf.version,rendererPackageName:kf.rendererPackageName,rendererConfig:kf.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:pe.ReactCurrentDispatcher,findHostInstanceByFiber:function(d){return d=ll(d),d===null?null:d.stateNode},findFiberByHostInstance:kf.findFiberByHostInstance||Tf,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Yp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Yp.isDisabled&&Yp.supportsFiber)try{Qs=Yp.inject(Dg),xs=Yp}catch{}}return ta.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Cf,ta.createPortal=function(d,p){var S=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Sf(p))throw Error(r(200));return Od(d,p,null,S)},ta.createRoot=function(d,p){if(!Sf(d))throw Error(r(299));var S=!1,R="",F=Ng;return p!=null&&(p.unstable_strictMode===!0&&(S=!0),p.identifierPrefix!==void 0&&(R=p.identifierPrefix),p.onRecoverableError!==void 0&&(F=p.onRecoverableError)),p=Rg(d,1,!1,null,null,S,!1,R,F),d[To]=p.current,ca(d.nodeType===8?d.parentNode:d),new Xp(p)},ta.findDOMNode=function(d){if(d==null)return null;if(d.nodeType===1)return d;var p=d._reactInternals;if(p===void 0)throw typeof d.render=="function"?Error(r(188)):(d=Object.keys(d).join(","),Error(r(268,d)));return d=ll(p),d=d===null?null:d.stateNode,d},ta.flushSync=function(d){return Pc(d)},ta.hydrate=function(d,p,S){if(!Bd(p))throw Error(r(200));return Ef(null,d,p,!0,S)},ta.hydrateRoot=function(d,p,S){if(!Sf(d))throw Error(r(405));var R=S!=null&&S.hydratedSources||null,F=!1,W="",se=Ng;if(S!=null&&(S.unstable_strictMode===!0&&(F=!0),S.identifierPrefix!==void 0&&(W=S.identifierPrefix),S.onRecoverableError!==void 0&&(se=S.onRecoverableError)),p=Jr(p,null,d,1,S??null,F,!1,W,se),d[To]=p.current,ca(d),R)for(d=0;d<R.length;d++)S=R[d],F=S._getVersion,F=F(S._source),p.mutableSourceEagerHydrationData==null?p.mutableSourceEagerHydrationData=[S,F]:p.mutableSourceEagerHydrationData.push(S,F);return new Dc(p)},ta.render=function(d,p,S){if(!Bd(p))throw Error(r(200));return Ef(null,d,p,!1,S)},ta.unmountComponentAtNode=function(d){if(!Bd(d))throw Error(r(40));return d._reactRootContainer?(Pc(function(){Ef(null,null,d,!1,function(){d._reactRootContainer=null,d[To]=null})}),!0):!1},ta.unstable_batchedUpdates=jd,ta.unstable_renderSubtreeIntoContainer=function(d,p,S,R){if(!Bd(S))throw Error(r(200));if(d==null||d._reactInternals===void 0)throw Error(r(38));return Ef(d,p,S,!1,R)},ta.version="18.3.1-next-f1338f8080-20240426",ta}var QE;function $I(){if(QE)return o1.exports;QE=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),o1.exports=oj(),o1.exports}var eC;function aj(){if(eC)return nx;eC=1;var t=$I();return nx.createRoot=t.createRoot,nx.hydrateRoot=t.hydrateRoot,nx}var pm=aj(),P=xv();const Zt=xb(P),vv=UI({__proto__:null,default:Zt},[P]),lj=1,cj=1e6;let c1=0;function uj(){return c1=(c1+1)%Number.MAX_SAFE_INTEGER,c1.toString()}const u1=new Map,tC=t=>{if(u1.has(t))return;const e=setTimeout(()=>{u1.delete(t),my({type:"REMOVE_TOAST",toastId:t})},cj);u1.set(t,e)},dj=(t,e)=>{switch(e.type){case"ADD_TOAST":return{...t,toasts:[e.toast,...t.toasts].slice(0,lj)};case"UPDATE_TOAST":return{...t,toasts:t.toasts.map(r=>r.id===e.toast.id?{...r,...e.toast}:r)};case"DISMISS_TOAST":{const{toastId:r}=e;return r?tC(r):t.toasts.forEach(l=>{tC(l.id)}),{...t,toasts:t.toasts.map(l=>l.id===r||r===void 0?{...l,open:!1}:l)}}case"REMOVE_TOAST":return e.toastId===void 0?{...t,toasts:[]}:{...t,toasts:t.toasts.filter(r=>r.id!==e.toastId)}}},Tx=[];let Sx={toasts:[]};function my(t){Sx=dj(Sx,t),Tx.forEach(e=>{e(Sx)})}function hj({...t}){const e=uj(),r=u=>my({type:"UPDATE_TOAST",toast:{...u,id:e}}),l=()=>my({type:"DISMISS_TOAST",toastId:e});return my({type:"ADD_TOAST",toast:{...t,id:e,open:!0,onOpenChange:u=>{u||l()}}}),{id:e,dismiss:l,update:r}}function fj(){const[t,e]=P.useState(Sx);return P.useEffect(()=>(Tx.push(e),()=>{const r=Tx.indexOf(e);r>-1&&Tx.splice(r,1)}),[t]),{...t,toast:hj,dismiss:r=>my({type:"DISMISS_TOAST",toastId:r})}}var xh=$I();const GI=xb(xh);function Xt(t,e,{checkForDefaultPrevented:r=!0}={}){return function(u){if(t?.(u),r===!1||!u.defaultPrevented)return e?.(u)}}function nC(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function ed(...t){return e=>{let r=!1;const l=t.map(u=>{const m=nC(u,e);return!r&&typeof m=="function"&&(r=!0),m});if(r)return()=>{for(let u=0;u<l.length;u++){const m=l[u];typeof m=="function"?m():nC(t[u],null)}}}}function ir(...t){return P.useCallback(ed(...t),t)}function pj(t,e){const r=P.createContext(e),l=m=>{const{children:v,...b}=m,a=P.useMemo(()=>b,Object.values(b));return x.jsx(r.Provider,{value:a,children:v})};l.displayName=t+"Provider";function u(m){const v=P.useContext(r);if(v)return v;if(e!==void 0)return e;throw new Error(`\`${m}\` must be used within \`${t}\``)}return[l,u]}function sl(t,e=[]){let r=[];function l(m,v){const b=P.createContext(v),a=r.length;r=[...r,v];const k=L=>{const{scope:z,children:O,...K}=L,H=z?.[t]?.[a]||b,Z=P.useMemo(()=>K,Object.values(K));return x.jsx(H.Provider,{value:Z,children:O})};k.displayName=m+"Provider";function M(L,z){const O=z?.[t]?.[a]||b,K=P.useContext(O);if(K)return K;if(v!==void 0)return v;throw new Error(`\`${L}\` must be used within \`${m}\``)}return[k,M]}const u=()=>{const m=r.map(v=>P.createContext(v));return function(b){const a=b?.[t]||m;return P.useMemo(()=>({[`__scope${t}`]:{...b,[t]:a}}),[b,a])}};return u.scopeName=t,[l,mj(u,...e)]}function mj(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const l=t.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(m){const v=l.reduce((b,{useScope:a,scopeName:k})=>{const L=a(m)[`__scope${k}`];return{...b,...L}},{});return P.useMemo(()=>({[`__scope${e.scopeName}`]:v}),[v])}};return r.scopeName=e.scopeName,r}function rC(t){const e=gj(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(_j);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function gj(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=vj(u),b=xj(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var yj=Symbol("radix.slottable");function _j(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===yj}function xj(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function vj(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function wv(t){const e=t+"CollectionProvider",[r,l]=sl(e),[u,m]=r(e,{collectionRef:{current:null},itemMap:new Map}),v=H=>{const{scope:Z,children:Y}=H,ee=Zt.useRef(null),ie=Zt.useRef(new Map).current;return x.jsx(u,{scope:Z,itemMap:ie,collectionRef:ee,children:Y})};v.displayName=e;const b=t+"CollectionSlot",a=rC(b),k=Zt.forwardRef((H,Z)=>{const{scope:Y,children:ee}=H,ie=m(b,Y),pe=ir(Z,ie.collectionRef);return x.jsx(a,{ref:pe,children:ee})});k.displayName=b;const M=t+"CollectionItemSlot",L="data-radix-collection-item",z=rC(M),O=Zt.forwardRef((H,Z)=>{const{scope:Y,children:ee,...ie}=H,pe=Zt.useRef(null),we=ir(Z,pe),ke=m(M,Y);return Zt.useEffect(()=>(ke.itemMap.set(pe,{ref:pe,...ie}),()=>{ke.itemMap.delete(pe)})),x.jsx(z,{[L]:"",ref:we,children:ee})});O.displayName=M;function K(H){const Z=m(t+"CollectionConsumer",H);return Zt.useCallback(()=>{const ee=Z.collectionRef.current;if(!ee)return[];const ie=Array.from(ee.querySelectorAll(`[${L}]`));return Array.from(Z.itemMap.values()).sort((ke,ze)=>ie.indexOf(ke.ref.current)-ie.indexOf(ze.ref.current))},[Z.collectionRef,Z.itemMap])}return[{Provider:v,Slot:k,ItemSlot:O},K,l]}function wj(t){const e=bj(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(Sj);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function bj(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=Cj(u),b=Ej(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var Tj=Symbol("radix.slottable");function Sj(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===Tj}function Ej(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function Cj(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var kj=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],Mn=kj.reduce((t,e)=>{const r=wj(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{});function vb(t,e){t&&xh.flushSync(()=>t.dispatchEvent(e))}function Bi(t){const e=P.useRef(t);return P.useEffect(()=>{e.current=t}),P.useMemo(()=>(...r)=>e.current?.(...r),[])}function Aj(t,e=globalThis?.document){const r=Bi(t);P.useEffect(()=>{const l=u=>{u.key==="Escape"&&r(u)};return e.addEventListener("keydown",l,{capture:!0}),()=>e.removeEventListener("keydown",l,{capture:!0})},[r,e])}var Ij="DismissableLayer",aw="dismissableLayer.update",Mj="dismissableLayer.pointerDownOutside",Pj="dismissableLayer.focusOutside",iC,HI=P.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Gm=P.forwardRef((t,e)=>{const{disableOutsidePointerEvents:r=!1,onEscapeKeyDown:l,onPointerDownOutside:u,onFocusOutside:m,onInteractOutside:v,onDismiss:b,...a}=t,k=P.useContext(HI),[M,L]=P.useState(null),z=M?.ownerDocument??globalThis?.document,[,O]=P.useState({}),K=ir(e,ze=>L(ze)),H=Array.from(k.layers),[Z]=[...k.layersWithOutsidePointerEventsDisabled].slice(-1),Y=H.indexOf(Z),ee=M?H.indexOf(M):-1,ie=k.layersWithOutsidePointerEventsDisabled.size>0,pe=ee>=Y,we=Nj(ze=>{const Ge=ze.target,tt=[...k.branches].some(Pe=>Pe.contains(Ge));!pe||tt||(u?.(ze),v?.(ze),ze.defaultPrevented||b?.())},z),ke=Dj(ze=>{const Ge=ze.target;[...k.branches].some(Pe=>Pe.contains(Ge))||(m?.(ze),v?.(ze),ze.defaultPrevented||b?.())},z);return Aj(ze=>{ee===k.layers.size-1&&(l?.(ze),!ze.defaultPrevented&&b&&(ze.preventDefault(),b()))},z),P.useEffect(()=>{if(M)return r&&(k.layersWithOutsidePointerEventsDisabled.size===0&&(iC=z.body.style.pointerEvents,z.body.style.pointerEvents="none"),k.layersWithOutsidePointerEventsDisabled.add(M)),k.layers.add(M),sC(),()=>{r&&k.layersWithOutsidePointerEventsDisabled.size===1&&(z.body.style.pointerEvents=iC)}},[M,z,r,k]),P.useEffect(()=>()=>{M&&(k.layers.delete(M),k.layersWithOutsidePointerEventsDisabled.delete(M),sC())},[M,k]),P.useEffect(()=>{const ze=()=>O({});return document.addEventListener(aw,ze),()=>document.removeEventListener(aw,ze)},[]),x.jsx(Mn.div,{...a,ref:K,style:{pointerEvents:ie?pe?"auto":"none":void 0,...t.style},onFocusCapture:Xt(t.onFocusCapture,ke.onFocusCapture),onBlurCapture:Xt(t.onBlurCapture,ke.onBlurCapture),onPointerDownCapture:Xt(t.onPointerDownCapture,we.onPointerDownCapture)})});Gm.displayName=Ij;var Rj="DismissableLayerBranch",WI=P.forwardRef((t,e)=>{const r=P.useContext(HI),l=P.useRef(null),u=ir(e,l);return P.useEffect(()=>{const m=l.current;if(m)return r.branches.add(m),()=>{r.branches.delete(m)}},[r.branches]),x.jsx(Mn.div,{...t,ref:u})});WI.displayName=Rj;function Nj(t,e=globalThis?.document){const r=Bi(t),l=P.useRef(!1),u=P.useRef(()=>{});return P.useEffect(()=>{const m=b=>{if(b.target&&!l.current){let a=function(){qI(Mj,r,k,{discrete:!0})};const k={originalEvent:b};b.pointerType==="touch"?(e.removeEventListener("click",u.current),u.current=a,e.addEventListener("click",u.current,{once:!0})):a()}else e.removeEventListener("click",u.current);l.current=!1},v=window.setTimeout(()=>{e.addEventListener("pointerdown",m)},0);return()=>{window.clearTimeout(v),e.removeEventListener("pointerdown",m),e.removeEventListener("click",u.current)}},[e,r]),{onPointerDownCapture:()=>l.current=!0}}function Dj(t,e=globalThis?.document){const r=Bi(t),l=P.useRef(!1);return P.useEffect(()=>{const u=m=>{m.target&&!l.current&&qI(Pj,r,{originalEvent:m},{discrete:!1})};return e.addEventListener("focusin",u),()=>e.removeEventListener("focusin",u)},[e,r]),{onFocusCapture:()=>l.current=!0,onBlurCapture:()=>l.current=!1}}function sC(){const t=new CustomEvent(aw);document.dispatchEvent(t)}function qI(t,e,r,{discrete:l}){const u=r.originalEvent.target,m=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:r});e&&u.addEventListener(t,e,{once:!0}),l?vb(u,m):u.dispatchEvent(m)}var Lj=Gm,jj=WI,Hi=globalThis?.document?P.useLayoutEffect:()=>{},Oj="Portal",Zy=P.forwardRef((t,e)=>{const{container:r,...l}=t,[u,m]=P.useState(!1);Hi(()=>m(!0),[]);const v=r||u&&globalThis?.document?.body;return v?GI.createPortal(x.jsx(Mn.div,{...l,ref:e}),v):null});Zy.displayName=Oj;function zj(t,e){return P.useReducer((r,l)=>e[r][l]??r,t)}var jo=t=>{const{present:e,children:r}=t,l=Bj(e),u=typeof r=="function"?r({present:l.isPresent}):P.Children.only(r),m=ir(l.ref,Fj(u));return typeof r=="function"||l.isPresent?P.cloneElement(u,{ref:m}):null};jo.displayName="Presence";function Bj(t){const[e,r]=P.useState(),l=P.useRef(null),u=P.useRef(t),m=P.useRef("none"),v=t?"mounted":"unmounted",[b,a]=zj(v,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return P.useEffect(()=>{const k=rx(l.current);m.current=b==="mounted"?k:"none"},[b]),Hi(()=>{const k=l.current,M=u.current;if(M!==t){const z=m.current,O=rx(k);t?a("MOUNT"):O==="none"||k?.display==="none"?a("UNMOUNT"):a(M&&z!==O?"ANIMATION_OUT":"UNMOUNT"),u.current=t}},[t,a]),Hi(()=>{if(e){let k;const M=e.ownerDocument.defaultView??window,L=O=>{const H=rx(l.current).includes(CSS.escape(O.animationName));if(O.target===e&&H&&(a("ANIMATION_END"),!u.current)){const Z=e.style.animationFillMode;e.style.animationFillMode="forwards",k=M.setTimeout(()=>{e.style.animationFillMode==="forwards"&&(e.style.animationFillMode=Z)})}},z=O=>{O.target===e&&(m.current=rx(l.current))};return e.addEventListener("animationstart",z),e.addEventListener("animationcancel",L),e.addEventListener("animationend",L),()=>{M.clearTimeout(k),e.removeEventListener("animationstart",z),e.removeEventListener("animationcancel",L),e.removeEventListener("animationend",L)}}else a("ANIMATION_END")},[e,a]),{isPresent:["mounted","unmountSuspended"].includes(b),ref:P.useCallback(k=>{l.current=k?getComputedStyle(k):null,r(k)},[])}}function rx(t){return t?.animationName||"none"}function Fj(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var Vj=vv[" useInsertionEffect ".trim().toString()]||Hi;function hh({prop:t,defaultProp:e,onChange:r=()=>{},caller:l}){const[u,m,v]=Uj({defaultProp:e,onChange:r}),b=t!==void 0,a=b?t:u;{const M=P.useRef(t!==void 0);P.useEffect(()=>{const L=M.current;L!==b&&console.warn(`${l} is changing from ${L?"controlled":"uncontrolled"} to ${b?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),M.current=b},[b,l])}const k=P.useCallback(M=>{if(b){const L=$j(M)?M(t):M;L!==t&&v.current?.(L)}else m(M)},[b,t,m,v]);return[a,k]}function Uj({defaultProp:t,onChange:e}){const[r,l]=P.useState(t),u=P.useRef(r),m=P.useRef(e);return Vj(()=>{m.current=e},[e]),P.useEffect(()=>{u.current!==r&&(m.current?.(r),u.current=r)},[r,u]),[r,l,m]}function $j(t){return typeof t=="function"}var ZI=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Gj="VisuallyHidden",bv=P.forwardRef((t,e)=>x.jsx(Mn.span,{...t,ref:e,style:{...ZI,...t.style}}));bv.displayName=Gj;var Hj=bv,wb="ToastProvider",[bb,Wj,qj]=wv("Toast"),[XI]=sl("Toast",[qj]),[Zj,Tv]=XI(wb),KI=t=>{const{__scopeToast:e,label:r="Notification",duration:l=5e3,swipeDirection:u="right",swipeThreshold:m=50,children:v}=t,[b,a]=P.useState(null),[k,M]=P.useState(0),L=P.useRef(!1),z=P.useRef(!1);return r.trim()||console.error(`Invalid prop \`label\` supplied to \`${wb}\`. Expected non-empty \`string\`.`),x.jsx(bb.Provider,{scope:e,children:x.jsx(Zj,{scope:e,label:r,duration:l,swipeDirection:u,swipeThreshold:m,toastCount:k,viewport:b,onViewportChange:a,onToastAdd:P.useCallback(()=>M(O=>O+1),[]),onToastRemove:P.useCallback(()=>M(O=>O-1),[]),isFocusedToastEscapeKeyDownRef:L,isClosePausedRef:z,children:v})})};KI.displayName=wb;var YI="ToastViewport",Xj=["F8"],lw="toast.viewportPause",cw="toast.viewportResume",JI=P.forwardRef((t,e)=>{const{__scopeToast:r,hotkey:l=Xj,label:u="Notifications ({hotkey})",...m}=t,v=Tv(YI,r),b=Wj(r),a=P.useRef(null),k=P.useRef(null),M=P.useRef(null),L=P.useRef(null),z=ir(e,L,v.onViewportChange),O=l.join("+").replace(/Key/g,"").replace(/Digit/g,""),K=v.toastCount>0;P.useEffect(()=>{const Z=Y=>{l.length!==0&&l.every(ie=>Y[ie]||Y.code===ie)&&L.current?.focus()};return document.addEventListener("keydown",Z),()=>document.removeEventListener("keydown",Z)},[l]),P.useEffect(()=>{const Z=a.current,Y=L.current;if(K&&Z&&Y){const ee=()=>{if(!v.isClosePausedRef.current){const ke=new CustomEvent(lw);Y.dispatchEvent(ke),v.isClosePausedRef.current=!0}},ie=()=>{if(v.isClosePausedRef.current){const ke=new CustomEvent(cw);Y.dispatchEvent(ke),v.isClosePausedRef.current=!1}},pe=ke=>{!Z.contains(ke.relatedTarget)&&ie()},we=()=>{Z.contains(document.activeElement)||ie()};return Z.addEventListener("focusin",ee),Z.addEventListener("focusout",pe),Z.addEventListener("pointermove",ee),Z.addEventListener("pointerleave",we),window.addEventListener("blur",ee),window.addEventListener("focus",ie),()=>{Z.removeEventListener("focusin",ee),Z.removeEventListener("focusout",pe),Z.removeEventListener("pointermove",ee),Z.removeEventListener("pointerleave",we),window.removeEventListener("blur",ee),window.removeEventListener("focus",ie)}}},[K,v.isClosePausedRef]);const H=P.useCallback(({tabbingDirection:Z})=>{const ee=b().map(ie=>{const pe=ie.ref.current,we=[pe,...lO(pe)];return Z==="forwards"?we:we.reverse()});return(Z==="forwards"?ee.reverse():ee).flat()},[b]);return P.useEffect(()=>{const Z=L.current;if(Z){const Y=ee=>{const ie=ee.altKey||ee.ctrlKey||ee.metaKey;if(ee.key==="Tab"&&!ie){const we=document.activeElement,ke=ee.shiftKey;if(ee.target===Z&&ke){k.current?.focus();return}const tt=H({tabbingDirection:ke?"backwards":"forwards"}),Pe=tt.findIndex(ot=>ot===we);d1(tt.slice(Pe+1))?ee.preventDefault():ke?k.current?.focus():M.current?.focus()}};return Z.addEventListener("keydown",Y),()=>Z.removeEventListener("keydown",Y)}},[b,H]),x.jsxs(jj,{ref:a,role:"region","aria-label":u.replace("{hotkey}",O),tabIndex:-1,style:{pointerEvents:K?void 0:"none"},children:[K&&x.jsx(uw,{ref:k,onFocusFromOutsideViewport:()=>{const Z=H({tabbingDirection:"forwards"});d1(Z)}}),x.jsx(bb.Slot,{scope:r,children:x.jsx(Mn.ol,{tabIndex:-1,...m,ref:z})}),K&&x.jsx(uw,{ref:M,onFocusFromOutsideViewport:()=>{const Z=H({tabbingDirection:"backwards"});d1(Z)}})]})});JI.displayName=YI;var QI="ToastFocusProxy",uw=P.forwardRef((t,e)=>{const{__scopeToast:r,onFocusFromOutsideViewport:l,...u}=t,m=Tv(QI,r);return x.jsx(bv,{tabIndex:0,...u,ref:e,style:{position:"fixed"},onFocus:v=>{const b=v.relatedTarget;!m.viewport?.contains(b)&&l()}})});uw.displayName=QI;var Xy="Toast",Kj="toast.swipeStart",Yj="toast.swipeMove",Jj="toast.swipeCancel",Qj="toast.swipeEnd",eM=P.forwardRef((t,e)=>{const{forceMount:r,open:l,defaultOpen:u,onOpenChange:m,...v}=t,[b,a]=hh({prop:l,defaultProp:u??!0,onChange:m,caller:Xy});return x.jsx(jo,{present:r||b,children:x.jsx(nO,{open:b,...v,ref:e,onClose:()=>a(!1),onPause:Bi(t.onPause),onResume:Bi(t.onResume),onSwipeStart:Xt(t.onSwipeStart,k=>{k.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:Xt(t.onSwipeMove,k=>{const{x:M,y:L}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","move"),k.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${M}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${L}px`)}),onSwipeCancel:Xt(t.onSwipeCancel,k=>{k.currentTarget.setAttribute("data-swipe","cancel"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:Xt(t.onSwipeEnd,k=>{const{x:M,y:L}=k.detail.delta;k.currentTarget.setAttribute("data-swipe","end"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),k.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),k.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${M}px`),k.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${L}px`),a(!1)})})})});eM.displayName=Xy;var[eO,tO]=XI(Xy,{onClose(){}}),nO=P.forwardRef((t,e)=>{const{__scopeToast:r,type:l="foreground",duration:u,open:m,onClose:v,onEscapeKeyDown:b,onPause:a,onResume:k,onSwipeStart:M,onSwipeMove:L,onSwipeCancel:z,onSwipeEnd:O,...K}=t,H=Tv(Xy,r),[Z,Y]=P.useState(null),ee=ir(e,ht=>Y(ht)),ie=P.useRef(null),pe=P.useRef(null),we=u||H.duration,ke=P.useRef(0),ze=P.useRef(we),Ge=P.useRef(0),{onToastAdd:tt,onToastRemove:Pe}=H,ot=Bi(()=>{Z?.contains(document.activeElement)&&H.viewport?.focus(),v()}),ut=P.useCallback(ht=>{!ht||ht===1/0||(window.clearTimeout(Ge.current),ke.current=new Date().getTime(),Ge.current=window.setTimeout(ot,ht))},[ot]);P.useEffect(()=>{const ht=H.viewport;if(ht){const Lt=()=>{ut(ze.current),k?.()},mt=()=>{const pt=new Date().getTime()-ke.current;ze.current=ze.current-pt,window.clearTimeout(Ge.current),a?.()};return ht.addEventListener(lw,mt),ht.addEventListener(cw,Lt),()=>{ht.removeEventListener(lw,mt),ht.removeEventListener(cw,Lt)}}},[H.viewport,we,a,k,ut]),P.useEffect(()=>{m&&!H.isClosePausedRef.current&&ut(we)},[m,we,H.isClosePausedRef,ut]),P.useEffect(()=>(tt(),()=>Pe()),[tt,Pe]);const gt=P.useMemo(()=>Z?aM(Z):null,[Z]);return H.viewport?x.jsxs(x.Fragment,{children:[gt&&x.jsx(rO,{__scopeToast:r,role:"status","aria-live":l==="foreground"?"assertive":"polite",children:gt}),x.jsx(eO,{scope:r,onClose:ot,children:xh.createPortal(x.jsx(bb.ItemSlot,{scope:r,children:x.jsx(Lj,{asChild:!0,onEscapeKeyDown:Xt(b,()=>{H.isFocusedToastEscapeKeyDownRef.current||ot(),H.isFocusedToastEscapeKeyDownRef.current=!1}),children:x.jsx(Mn.li,{tabIndex:0,"data-state":m?"open":"closed","data-swipe-direction":H.swipeDirection,...K,ref:ee,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:Xt(t.onKeyDown,ht=>{ht.key==="Escape"&&(b?.(ht.nativeEvent),ht.nativeEvent.defaultPrevented||(H.isFocusedToastEscapeKeyDownRef.current=!0,ot()))}),onPointerDown:Xt(t.onPointerDown,ht=>{ht.button===0&&(ie.current={x:ht.clientX,y:ht.clientY})}),onPointerMove:Xt(t.onPointerMove,ht=>{if(!ie.current)return;const Lt=ht.clientX-ie.current.x,mt=ht.clientY-ie.current.y,pt=!!pe.current,Ae=["left","right"].includes(H.swipeDirection),xe=["left","up"].includes(H.swipeDirection)?Math.min:Math.max,We=Ae?xe(0,Lt):0,he=Ae?0:xe(0,mt),Fe=ht.pointerType==="touch"?10:2,it={x:We,y:he},vt={originalEvent:ht,delta:it};pt?(pe.current=it,ix(Yj,L,vt,{discrete:!1})):oC(it,H.swipeDirection,Fe)?(pe.current=it,ix(Kj,M,vt,{discrete:!1}),ht.target.setPointerCapture(ht.pointerId)):(Math.abs(Lt)>Fe||Math.abs(mt)>Fe)&&(ie.current=null)}),onPointerUp:Xt(t.onPointerUp,ht=>{const Lt=pe.current,mt=ht.target;if(mt.hasPointerCapture(ht.pointerId)&&mt.releasePointerCapture(ht.pointerId),pe.current=null,ie.current=null,Lt){const pt=ht.currentTarget,Ae={originalEvent:ht,delta:Lt};oC(Lt,H.swipeDirection,H.swipeThreshold)?ix(Qj,O,Ae,{discrete:!0}):ix(Jj,z,Ae,{discrete:!0}),pt.addEventListener("click",xe=>xe.preventDefault(),{once:!0})}})})})}),H.viewport)})]}):null}),rO=t=>{const{__scopeToast:e,children:r,...l}=t,u=Tv(Xy,e),[m,v]=P.useState(!1),[b,a]=P.useState(!1);return oO(()=>v(!0)),P.useEffect(()=>{const k=window.setTimeout(()=>a(!0),1e3);return()=>window.clearTimeout(k)},[]),b?null:x.jsx(Zy,{asChild:!0,children:x.jsx(bv,{...l,children:m&&x.jsxs(x.Fragment,{children:[u.label," ",r]})})})},iO="ToastTitle",tM=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t;return x.jsx(Mn.div,{...l,ref:e})});tM.displayName=iO;var sO="ToastDescription",nM=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t;return x.jsx(Mn.div,{...l,ref:e})});nM.displayName=sO;var rM="ToastAction",iM=P.forwardRef((t,e)=>{const{altText:r,...l}=t;return r.trim()?x.jsx(oM,{altText:r,asChild:!0,children:x.jsx(Tb,{...l,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${rM}\`. Expected non-empty \`string\`.`),null)});iM.displayName=rM;var sM="ToastClose",Tb=P.forwardRef((t,e)=>{const{__scopeToast:r,...l}=t,u=tO(sM,r);return x.jsx(oM,{asChild:!0,children:x.jsx(Mn.button,{type:"button",...l,ref:e,onClick:Xt(t.onClick,u.onClose)})})});Tb.displayName=sM;var oM=P.forwardRef((t,e)=>{const{__scopeToast:r,altText:l,...u}=t;return x.jsx(Mn.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":l||void 0,...u,ref:e})});function aM(t){const e=[];return Array.from(t.childNodes).forEach(l=>{if(l.nodeType===l.TEXT_NODE&&l.textContent&&e.push(l.textContent),aO(l)){const u=l.ariaHidden||l.hidden||l.style.display==="none",m=l.dataset.radixToastAnnounceExclude==="";if(!u)if(m){const v=l.dataset.radixToastAnnounceAlt;v&&e.push(v)}else e.push(...aM(l))}}),e}function ix(t,e,r,{discrete:l}){const u=r.originalEvent.currentTarget,m=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:r});e&&u.addEventListener(t,e,{once:!0}),l?vb(u,m):u.dispatchEvent(m)}var oC=(t,e,r=0)=>{const l=Math.abs(t.x),u=Math.abs(t.y),m=l>u;return e==="left"||e==="right"?m&&l>r:!m&&u>r};function oO(t=()=>{}){const e=Bi(t);Hi(()=>{let r=0,l=0;return r=window.requestAnimationFrame(()=>l=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(r),window.cancelAnimationFrame(l)}},[e])}function aO(t){return t.nodeType===t.ELEMENT_NODE}function lO(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const u=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||u?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function d1(t){const e=document.activeElement;return t.some(r=>r===e?!0:(r.focus(),document.activeElement!==e))}var cO=KI,lM=JI,cM=eM,uM=tM,dM=nM,hM=iM,fM=Tb;function pM(t){var e,r,l="";if(typeof t=="string"||typeof t=="number")l+=t;else if(typeof t=="object")if(Array.isArray(t)){var u=t.length;for(e=0;e<u;e++)t[e]&&(r=pM(t[e]))&&(l&&(l+=" "),l+=r)}else for(r in t)t[r]&&(l&&(l+=" "),l+=r);return l}function mM(){for(var t,e,r=0,l="",u=arguments.length;r<u;r++)(t=arguments[r])&&(e=pM(t))&&(l&&(l+=" "),l+=e);return l}const aC=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,lC=mM,Ky=(t,e)=>r=>{var l;if(e?.variants==null)return lC(t,r?.class,r?.className);const{variants:u,defaultVariants:m}=e,v=Object.keys(u).map(k=>{const M=r?.[k],L=m?.[k];if(M===null)return null;const z=aC(M)||aC(L);return u[k][z]}),b=r&&Object.entries(r).reduce((k,M)=>{let[L,z]=M;return z===void 0||(k[L]=z),k},{}),a=e==null||(l=e.compoundVariants)===null||l===void 0?void 0:l.reduce((k,M)=>{let{class:L,className:z,...O}=M;return Object.entries(O).every(K=>{let[H,Z]=K;return Array.isArray(Z)?Z.includes({...m,...b}[H]):{...m,...b}[H]===Z})?[...k,L,z]:k},[]);return lC(t,v,a,r?.class,r?.className)};const uO=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),gM=(...t)=>t.filter((e,r,l)=>!!e&&e.trim()!==""&&l.indexOf(e)===r).join(" ").trim();var dO={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const hO=P.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:r=2,absoluteStrokeWidth:l,className:u="",children:m,iconNode:v,...b},a)=>P.createElement("svg",{ref:a,...dO,width:e,height:e,stroke:t,strokeWidth:l?Number(r)*24/Number(e):r,className:gM("lucide",u),...b},[...v.map(([k,M])=>P.createElement(k,M)),...Array.isArray(m)?m:[m]]));const nn=(t,e)=>{const r=P.forwardRef(({className:l,...u},m)=>P.createElement(hO,{ref:m,iconNode:e,className:gM(`lucide-${uO(t)}`,l),...u}));return r.displayName=`${t}`,r};const Sv=nn("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const Sb=nn("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const cC=nn("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);const fO=nn("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const yM=nn("Bike",[["circle",{cx:"18.5",cy:"17.5",r:"3.5",key:"15x4ox"}],["circle",{cx:"5.5",cy:"17.5",r:"3.5",key:"1noe27"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["path",{d:"M12 17.5V14l-3-3 4-3 2 3h2",key:"1npguv"}]]);const oh=nn("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Rm=nn("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const Eb=nn("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const pO=nn("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const _M=nn("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const np=nn("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const Hf=nn("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const xM=nn("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const Nm=nn("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const mO=nn("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const gO=nn("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const yO=nn("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);const _O=nn("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const xO=nn("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const Cb=nn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const vO=nn("CloudUpload",[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]]);const kb=nn("Coffee",[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]]);const h1=nn("CornerUpLeft",[["polyline",{points:"9 14 4 9 9 4",key:"881910"}],["path",{d:"M20 20v-7a4 4 0 0 0-4-4H4",key:"1nkjon"}]]);const f1=nn("CornerUpRight",[["polyline",{points:"15 14 20 9 15 4",key:"1tbx3s"}],["path",{d:"M4 20v-7a4 4 0 0 1 4-4h12",key:"1lu4f8"}]]);const nl=nn("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]);const wO=nn("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);const bO=nn("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);const TO=nn("Eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const SO=nn("Facebook",[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]]);const EO=nn("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const CO=nn("Flag",[["path",{d:"M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z",key:"i9b6wo"}],["line",{x1:"4",x2:"4",y1:"22",y2:"15",key:"1cm3nv"}]]);const vM=nn("Footprints",[["path",{d:"M4 16v-2.38C4 11.5 2.97 10.5 3 8c.03-2.72 1.49-6 4.5-6C9.37 2 10 3.8 10 5.5c0 3.11-2 5.66-2 8.68V16a2 2 0 1 1-4 0Z",key:"1dudjm"}],["path",{d:"M20 20v-2.38c0-2.12 1.03-3.12 1-5.62-.03-2.72-1.49-6-4.5-6C14.63 6 14 7.8 14 9.5c0 3.11 2 5.66 2 8.68V20a2 2 0 1 0 4 0Z",key:"l2t8xc"}],["path",{d:"M16 17h4",key:"1dejxt"}],["path",{d:"M4 13h4",key:"1bwh8b"}]]);const Ab=nn("Gamepad2",[["line",{x1:"6",x2:"10",y1:"11",y2:"11",key:"1gktln"}],["line",{x1:"8",x2:"8",y1:"9",y2:"13",key:"qnk9ow"}],["line",{x1:"15",x2:"15.01",y1:"12",y2:"12",key:"krot7o"}],["line",{x1:"18",x2:"18.01",y1:"10",y2:"10",key:"1lcuu1"}],["path",{d:"M17.32 5H6.68a4 4 0 0 0-3.978 3.59c-.006.052-.01.101-.017.152C2.604 9.416 2 14.456 2 16a3 3 0 0 0 3 3c1 0 1.5-.5 2-1l1.414-1.414A2 2 0 0 1 9.828 16h4.344a2 2 0 0 1 1.414.586L17 18c.5.5 1 1 2 1a3 3 0 0 0 3-3c0-1.545-.604-6.584-.685-7.258-.007-.05-.011-.1-.017-.151A4 4 0 0 0 17.32 5z",key:"mfqc10"}]]);const kO=nn("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);const Ib=nn("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const AO=nn("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);const Ff=nn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);const Mb=nn("House",[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]]);const IO=nn("ImageOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M10.41 10.41a2 2 0 1 1-2.83-2.83",key:"1bzlo9"}],["line",{x1:"13.5",x2:"6",y1:"13.5",y2:"21",key:"1q0aeu"}],["line",{x1:"18",x2:"21",y1:"12",y2:"15",key:"5mozeu"}],["path",{d:"M3.59 3.59A1.99 1.99 0 0 0 3 5v14a2 2 0 0 0 2 2h14c.55 0 1.052-.22 1.41-.59",key:"mmje98"}],["path",{d:"M21 15V5a2 2 0 0 0-2-2H9",key:"43el77"}]]);const uC=nn("ImagePlus",[["path",{d:"M16 5h6",key:"1vod17"}],["path",{d:"M19 2v6",key:"4bpg5p"}],["path",{d:"M21 11.5V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h7.5",key:"1ue2ih"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}]]);const wM=nn("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const bM=nn("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const Fi=nn("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const Ey=nn("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const dw=nn("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const TM=nn("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const Vi=nn("MapPin",[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const SM=nn("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const MO=nn("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const zx=nn("Megaphone",[["path",{d:"m3 11 18-5v12L3 14v-3z",key:"n962bs"}],["path",{d:"M11.6 16.8a3 3 0 1 1-5.8-1.6",key:"1yl0tm"}]]);const Bx=nn("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const PO=nn("PenLine",[["path",{d:"M12 20h9",key:"t2du7b"}],["path",{d:"M16.376 3.622a1 1 0 0 1 3.002 3.002L7.368 18.635a2 2 0 0 1-.855.506l-2.872.838a.5.5 0 0 1-.62-.62l.838-2.872a2 2 0 0 1 .506-.854z",key:"1ykcvy"}]]);const p1=nn("Pen",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]]);const RO=nn("Percent",[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]]);const Ev=nn("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const _m=nn("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const dC=nn("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const NO=nn("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Cv=nn("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const DO=nn("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);const LO=nn("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const jO=nn("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const Vf=nn("Star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]);const Vc=nn("Store",[["path",{d:"m2 7 4.41-4.41A2 2 0 0 1 7.83 2h8.34a2 2 0 0 1 1.42.59L22 7",key:"ztvudi"}],["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["path",{d:"M15 22v-4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v4",key:"2ebpfo"}],["path",{d:"M2 7h20",key:"1fcdvo"}],["path",{d:"M22 7v3a2 2 0 0 1-2 2a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 16 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 12 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 8 12a2.7 2.7 0 0 1-1.59-.63.7.7 0 0 0-.82 0A2.7 2.7 0 0 1 4 12a2 2 0 0 1-2-2V7",key:"6c3vgh"}]]);const EM=nn("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);const Yy=nn("Ticket",[["path",{d:"M2 9a3 3 0 0 1 0 6v2a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-2a3 3 0 0 1 0-6V7a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2Z",key:"qn84l0"}],["path",{d:"M13 5v2",key:"dyzc3o"}],["path",{d:"M13 17v2",key:"1ont0d"}],["path",{d:"M13 11v2",key:"1wjjxi"}]]);const ah=nn("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const OO=nn("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const CM=nn("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Cy=nn("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const kM=nn("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const zO=nn("UtensilsCrossed",[["path",{d:"m16 2-2.3 2.3a3 3 0 0 0 0 4.2l1.8 1.8a3 3 0 0 0 4.2 0L22 8",key:"n7qcjb"}],["path",{d:"M15 15 3.3 3.3a4.2 4.2 0 0 0 0 6l7.3 7.3c.7.7 2 .7 2.8 0L15 15Zm0 0 7 7",key:"d0u48b"}],["path",{d:"m2.1 21.8 6.4-6.3",key:"yn04lh"}],["path",{d:"m19 5-7 7",key:"194lzd"}]]);const kv=nn("Utensils",[["path",{d:"M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2",key:"cjf0a3"}],["path",{d:"M7 2v20",key:"1473qp"}],["path",{d:"M21 15V2a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7",key:"j28e5"}]]);const ti=nn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),Pb="-",BO=t=>{const e=VO(t),{conflictingClassGroups:r,conflictingClassGroupModifiers:l}=t;return{getClassGroupId:v=>{const b=v.split(Pb);return b[0]===""&&b.length!==1&&b.shift(),AM(b,e)||FO(v)},getConflictingClassGroupIds:(v,b)=>{const a=r[v]||[];return b&&l[v]?[...a,...l[v]]:a}}},AM=(t,e)=>{if(t.length===0)return e.classGroupId;const r=t[0],l=e.nextPart.get(r),u=l?AM(t.slice(1),l):void 0;if(u)return u;if(e.validators.length===0)return;const m=t.join(Pb);return e.validators.find(({validator:v})=>v(m))?.classGroupId},hC=/^\[(.+)\]$/,FO=t=>{if(hC.test(t)){const e=hC.exec(t)[1],r=e?.substring(0,e.indexOf(":"));if(r)return"arbitrary.."+r}},VO=t=>{const{theme:e,prefix:r}=t,l={nextPart:new Map,validators:[]};return $O(Object.entries(t.classGroups),r).forEach(([m,v])=>{hw(v,l,m,e)}),l},hw=(t,e,r,l)=>{t.forEach(u=>{if(typeof u=="string"){const m=u===""?e:fC(e,u);m.classGroupId=r;return}if(typeof u=="function"){if(UO(u)){hw(u(l),e,r,l);return}e.validators.push({validator:u,classGroupId:r});return}Object.entries(u).forEach(([m,v])=>{hw(v,fC(e,m),r,l)})})},fC=(t,e)=>{let r=t;return e.split(Pb).forEach(l=>{r.nextPart.has(l)||r.nextPart.set(l,{nextPart:new Map,validators:[]}),r=r.nextPart.get(l)}),r},UO=t=>t.isThemeGetter,$O=(t,e)=>e?t.map(([r,l])=>{const u=l.map(m=>typeof m=="string"?e+m:typeof m=="object"?Object.fromEntries(Object.entries(m).map(([v,b])=>[e+v,b])):m);return[r,u]}):t,GO=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,r=new Map,l=new Map;const u=(m,v)=>{r.set(m,v),e++,e>t&&(e=0,l=r,r=new Map)};return{get(m){let v=r.get(m);if(v!==void 0)return v;if((v=l.get(m))!==void 0)return u(m,v),v},set(m,v){r.has(m)?r.set(m,v):u(m,v)}}},IM="!",HO=t=>{const{separator:e,experimentalParseClassName:r}=t,l=e.length===1,u=e[0],m=e.length,v=b=>{const a=[];let k=0,M=0,L;for(let Z=0;Z<b.length;Z++){let Y=b[Z];if(k===0){if(Y===u&&(l||b.slice(Z,Z+m)===e)){a.push(b.slice(M,Z)),M=Z+m;continue}if(Y==="/"){L=Z;continue}}Y==="["?k++:Y==="]"&&k--}const z=a.length===0?b:b.substring(M),O=z.startsWith(IM),K=O?z.substring(1):z,H=L&&L>M?L-M:void 0;return{modifiers:a,hasImportantModifier:O,baseClassName:K,maybePostfixModifierPosition:H}};return r?b=>r({className:b,parseClassName:v}):v},WO=t=>{if(t.length<=1)return t;const e=[];let r=[];return t.forEach(l=>{l[0]==="["?(e.push(...r.sort(),l),r=[]):r.push(l)}),e.push(...r.sort()),e},qO=t=>({cache:GO(t.cacheSize),parseClassName:HO(t),...BO(t)}),ZO=/\s+/,XO=(t,e)=>{const{parseClassName:r,getClassGroupId:l,getConflictingClassGroupIds:u}=e,m=[],v=t.trim().split(ZO);let b="";for(let a=v.length-1;a>=0;a-=1){const k=v[a],{modifiers:M,hasImportantModifier:L,baseClassName:z,maybePostfixModifierPosition:O}=r(k);let K=!!O,H=l(K?z.substring(0,O):z);if(!H){if(!K){b=k+(b.length>0?" "+b:b);continue}if(H=l(z),!H){b=k+(b.length>0?" "+b:b);continue}K=!1}const Z=WO(M).join(":"),Y=L?Z+IM:Z,ee=Y+H;if(m.includes(ee))continue;m.push(ee);const ie=u(H,K);for(let pe=0;pe<ie.length;++pe){const we=ie[pe];m.push(Y+we)}b=k+(b.length>0?" "+b:b)}return b};function KO(){let t=0,e,r,l="";for(;t<arguments.length;)(e=arguments[t++])&&(r=MM(e))&&(l&&(l+=" "),l+=r);return l}const MM=t=>{if(typeof t=="string")return t;let e,r="";for(let l=0;l<t.length;l++)t[l]&&(e=MM(t[l]))&&(r&&(r+=" "),r+=e);return r};function YO(t,...e){let r,l,u,m=v;function v(a){const k=e.reduce((M,L)=>L(M),t());return r=qO(k),l=r.cache.get,u=r.cache.set,m=b,b(a)}function b(a){const k=l(a);if(k)return k;const M=XO(a,r);return u(a,M),M}return function(){return m(KO.apply(null,arguments))}}const ci=t=>{const e=r=>r[t]||[];return e.isThemeGetter=!0,e},PM=/^\[(?:([a-z-]+):)?(.+)\]$/i,JO=/^\d+\/\d+$/,QO=new Set(["px","full","screen"]),ez=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,tz=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,nz=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,rz=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iz=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Vu=t=>Sm(t)||QO.has(t)||JO.test(t),qd=t=>Hm(t,"length",hz),Sm=t=>!!t&&!Number.isNaN(Number(t)),m1=t=>Hm(t,"number",Sm),Qg=t=>!!t&&Number.isInteger(Number(t)),sz=t=>t.endsWith("%")&&Sm(t.slice(0,-1)),er=t=>PM.test(t),Zd=t=>ez.test(t),oz=new Set(["length","size","percentage"]),az=t=>Hm(t,oz,RM),lz=t=>Hm(t,"position",RM),cz=new Set(["image","url"]),uz=t=>Hm(t,cz,pz),dz=t=>Hm(t,"",fz),ey=()=>!0,Hm=(t,e,r)=>{const l=PM.exec(t);return l?l[1]?typeof e=="string"?l[1]===e:e.has(l[1]):r(l[2]):!1},hz=t=>tz.test(t)&&!nz.test(t),RM=()=>!1,fz=t=>rz.test(t),pz=t=>iz.test(t),mz=()=>{const t=ci("colors"),e=ci("spacing"),r=ci("blur"),l=ci("brightness"),u=ci("borderColor"),m=ci("borderRadius"),v=ci("borderSpacing"),b=ci("borderWidth"),a=ci("contrast"),k=ci("grayscale"),M=ci("hueRotate"),L=ci("invert"),z=ci("gap"),O=ci("gradientColorStops"),K=ci("gradientColorStopPositions"),H=ci("inset"),Z=ci("margin"),Y=ci("opacity"),ee=ci("padding"),ie=ci("saturate"),pe=ci("scale"),we=ci("sepia"),ke=ci("skew"),ze=ci("space"),Ge=ci("translate"),tt=()=>["auto","contain","none"],Pe=()=>["auto","hidden","clip","visible","scroll"],ot=()=>["auto",er,e],ut=()=>[er,e],gt=()=>["",Vu,qd],ht=()=>["auto",Sm,er],Lt=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],mt=()=>["solid","dashed","dotted","double","none"],pt=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Ae=()=>["start","end","center","between","around","evenly","stretch"],xe=()=>["","0",er],We=()=>["auto","avoid","all","avoid-page","page","left","right","column"],he=()=>[Sm,er];return{cacheSize:500,separator:":",theme:{colors:[ey],spacing:[Vu,qd],blur:["none","",Zd,er],brightness:he(),borderColor:[t],borderRadius:["none","","full",Zd,er],borderSpacing:ut(),borderWidth:gt(),contrast:he(),grayscale:xe(),hueRotate:he(),invert:xe(),gap:ut(),gradientColorStops:[t],gradientColorStopPositions:[sz,qd],inset:ot(),margin:ot(),opacity:he(),padding:ut(),saturate:he(),scale:he(),sepia:xe(),skew:he(),space:ut(),translate:ut()},classGroups:{aspect:[{aspect:["auto","square","video",er]}],container:["container"],columns:[{columns:[Zd]}],"break-after":[{"break-after":We()}],"break-before":[{"break-before":We()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...Lt(),er]}],overflow:[{overflow:Pe()}],"overflow-x":[{"overflow-x":Pe()}],"overflow-y":[{"overflow-y":Pe()}],overscroll:[{overscroll:tt()}],"overscroll-x":[{"overscroll-x":tt()}],"overscroll-y":[{"overscroll-y":tt()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[H]}],"inset-x":[{"inset-x":[H]}],"inset-y":[{"inset-y":[H]}],start:[{start:[H]}],end:[{end:[H]}],top:[{top:[H]}],right:[{right:[H]}],bottom:[{bottom:[H]}],left:[{left:[H]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Qg,er]}],basis:[{basis:ot()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",er]}],grow:[{grow:xe()}],shrink:[{shrink:xe()}],order:[{order:["first","last","none",Qg,er]}],"grid-cols":[{"grid-cols":[ey]}],"col-start-end":[{col:["auto",{span:["full",Qg,er]},er]}],"col-start":[{"col-start":ht()}],"col-end":[{"col-end":ht()}],"grid-rows":[{"grid-rows":[ey]}],"row-start-end":[{row:["auto",{span:[Qg,er]},er]}],"row-start":[{"row-start":ht()}],"row-end":[{"row-end":ht()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",er]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",er]}],gap:[{gap:[z]}],"gap-x":[{"gap-x":[z]}],"gap-y":[{"gap-y":[z]}],"justify-content":[{justify:["normal",...Ae()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...Ae(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...Ae(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[ee]}],px:[{px:[ee]}],py:[{py:[ee]}],ps:[{ps:[ee]}],pe:[{pe:[ee]}],pt:[{pt:[ee]}],pr:[{pr:[ee]}],pb:[{pb:[ee]}],pl:[{pl:[ee]}],m:[{m:[Z]}],mx:[{mx:[Z]}],my:[{my:[Z]}],ms:[{ms:[Z]}],me:[{me:[Z]}],mt:[{mt:[Z]}],mr:[{mr:[Z]}],mb:[{mb:[Z]}],ml:[{ml:[Z]}],"space-x":[{"space-x":[ze]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[ze]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",er,e]}],"min-w":[{"min-w":[er,e,"min","max","fit"]}],"max-w":[{"max-w":[er,e,"none","full","min","max","fit","prose",{screen:[Zd]},Zd]}],h:[{h:[er,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[er,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[er,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[er,e,"auto","min","max","fit"]}],"font-size":[{text:["base",Zd,qd]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",m1]}],"font-family":[{font:[ey]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",er]}],"line-clamp":[{"line-clamp":["none",Sm,m1]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Vu,er]}],"list-image":[{"list-image":["none",er]}],"list-style-type":[{list:["none","disc","decimal",er]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[Y]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[Y]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...mt(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Vu,qd]}],"underline-offset":[{"underline-offset":["auto",Vu,er]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:ut()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",er]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",er]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[Y]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...Lt(),lz]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",az]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},uz]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[K]}],"gradient-via-pos":[{via:[K]}],"gradient-to-pos":[{to:[K]}],"gradient-from":[{from:[O]}],"gradient-via":[{via:[O]}],"gradient-to":[{to:[O]}],rounded:[{rounded:[m]}],"rounded-s":[{"rounded-s":[m]}],"rounded-e":[{"rounded-e":[m]}],"rounded-t":[{"rounded-t":[m]}],"rounded-r":[{"rounded-r":[m]}],"rounded-b":[{"rounded-b":[m]}],"rounded-l":[{"rounded-l":[m]}],"rounded-ss":[{"rounded-ss":[m]}],"rounded-se":[{"rounded-se":[m]}],"rounded-ee":[{"rounded-ee":[m]}],"rounded-es":[{"rounded-es":[m]}],"rounded-tl":[{"rounded-tl":[m]}],"rounded-tr":[{"rounded-tr":[m]}],"rounded-br":[{"rounded-br":[m]}],"rounded-bl":[{"rounded-bl":[m]}],"border-w":[{border:[b]}],"border-w-x":[{"border-x":[b]}],"border-w-y":[{"border-y":[b]}],"border-w-s":[{"border-s":[b]}],"border-w-e":[{"border-e":[b]}],"border-w-t":[{"border-t":[b]}],"border-w-r":[{"border-r":[b]}],"border-w-b":[{"border-b":[b]}],"border-w-l":[{"border-l":[b]}],"border-opacity":[{"border-opacity":[Y]}],"border-style":[{border:[...mt(),"hidden"]}],"divide-x":[{"divide-x":[b]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[b]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[Y]}],"divide-style":[{divide:mt()}],"border-color":[{border:[u]}],"border-color-x":[{"border-x":[u]}],"border-color-y":[{"border-y":[u]}],"border-color-s":[{"border-s":[u]}],"border-color-e":[{"border-e":[u]}],"border-color-t":[{"border-t":[u]}],"border-color-r":[{"border-r":[u]}],"border-color-b":[{"border-b":[u]}],"border-color-l":[{"border-l":[u]}],"divide-color":[{divide:[u]}],"outline-style":[{outline:["",...mt()]}],"outline-offset":[{"outline-offset":[Vu,er]}],"outline-w":[{outline:[Vu,qd]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:gt()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[Y]}],"ring-offset-w":[{"ring-offset":[Vu,qd]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",Zd,dz]}],"shadow-color":[{shadow:[ey]}],opacity:[{opacity:[Y]}],"mix-blend":[{"mix-blend":[...pt(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":pt()}],filter:[{filter:["","none"]}],blur:[{blur:[r]}],brightness:[{brightness:[l]}],contrast:[{contrast:[a]}],"drop-shadow":[{"drop-shadow":["","none",Zd,er]}],grayscale:[{grayscale:[k]}],"hue-rotate":[{"hue-rotate":[M]}],invert:[{invert:[L]}],saturate:[{saturate:[ie]}],sepia:[{sepia:[we]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[r]}],"backdrop-brightness":[{"backdrop-brightness":[l]}],"backdrop-contrast":[{"backdrop-contrast":[a]}],"backdrop-grayscale":[{"backdrop-grayscale":[k]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[M]}],"backdrop-invert":[{"backdrop-invert":[L]}],"backdrop-opacity":[{"backdrop-opacity":[Y]}],"backdrop-saturate":[{"backdrop-saturate":[ie]}],"backdrop-sepia":[{"backdrop-sepia":[we]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[v]}],"border-spacing-x":[{"border-spacing-x":[v]}],"border-spacing-y":[{"border-spacing-y":[v]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",er]}],duration:[{duration:he()}],ease:[{ease:["linear","in","out","in-out",er]}],delay:[{delay:he()}],animate:[{animate:["none","spin","ping","pulse","bounce",er]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[pe]}],"scale-x":[{"scale-x":[pe]}],"scale-y":[{"scale-y":[pe]}],rotate:[{rotate:[Qg,er]}],"translate-x":[{"translate-x":[Ge]}],"translate-y":[{"translate-y":[Ge]}],"skew-x":[{"skew-x":[ke]}],"skew-y":[{"skew-y":[ke]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",er]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",er]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":ut()}],"scroll-mx":[{"scroll-mx":ut()}],"scroll-my":[{"scroll-my":ut()}],"scroll-ms":[{"scroll-ms":ut()}],"scroll-me":[{"scroll-me":ut()}],"scroll-mt":[{"scroll-mt":ut()}],"scroll-mr":[{"scroll-mr":ut()}],"scroll-mb":[{"scroll-mb":ut()}],"scroll-ml":[{"scroll-ml":ut()}],"scroll-p":[{"scroll-p":ut()}],"scroll-px":[{"scroll-px":ut()}],"scroll-py":[{"scroll-py":ut()}],"scroll-ps":[{"scroll-ps":ut()}],"scroll-pe":[{"scroll-pe":ut()}],"scroll-pt":[{"scroll-pt":ut()}],"scroll-pr":[{"scroll-pr":ut()}],"scroll-pb":[{"scroll-pb":ut()}],"scroll-pl":[{"scroll-pl":ut()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",er]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Vu,qd,m1]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},gz=YO(mz);function ln(...t){return gz(mM(t))}const yz=cO,NM=P.forwardRef(({className:t,...e},r)=>x.jsx(lM,{ref:r,className:ln("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...e}));NM.displayName=lM.displayName;const _z=Ky("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),DM=P.forwardRef(({className:t,variant:e,...r},l)=>x.jsx(cM,{ref:l,className:ln(_z({variant:e}),t),...r}));DM.displayName=cM.displayName;const xz=P.forwardRef(({className:t,...e},r)=>x.jsx(hM,{ref:r,className:ln("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors group-[.destructive]:border-muted/40 hover:bg-secondary group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 group-[.destructive]:focus:ring-destructive disabled:pointer-events-none disabled:opacity-50",t),...e}));xz.displayName=hM.displayName;const LM=P.forwardRef(({className:t,...e},r)=>x.jsx(fM,{ref:r,className:ln("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity group-hover:opacity-100 group-[.destructive]:text-red-300 hover:text-foreground group-[.destructive]:hover:text-red-50 focus:opacity-100 focus:outline-none focus:ring-2 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...e,children:x.jsx(ti,{className:"h-4 w-4"})}));LM.displayName=fM.displayName;const jM=P.forwardRef(({className:t,...e},r)=>x.jsx(uM,{ref:r,className:ln("text-sm font-semibold",t),...e}));jM.displayName=uM.displayName;const OM=P.forwardRef(({className:t,...e},r)=>x.jsx(dM,{ref:r,className:ln("text-sm opacity-90",t),...e}));OM.displayName=dM.displayName;function vz(){const{toasts:t}=fj();return x.jsxs(yz,{children:[t.map(function({id:e,title:r,description:l,action:u,...m}){const{key:v,...b}=m;return x.jsxs(DM,{...b,children:[" ",x.jsxs("div",{className:"grid gap-1",children:[r&&x.jsx(jM,{children:r}),l&&x.jsx(OM,{children:l})]}),u,x.jsx(LM,{})]},e)}),x.jsx(NM,{})]})}var pC=["light","dark"],wz="(prefers-color-scheme: dark)",bz=P.createContext(void 0),Tz={setTheme:t=>{},themes:[]},Sz=()=>{var t;return(t=P.useContext(bz))!=null?t:Tz};P.memo(({forcedTheme:t,storageKey:e,attribute:r,enableSystem:l,enableColorScheme:u,defaultTheme:m,value:v,attrs:b,nonce:a})=>{let k=m==="system",M=r==="class"?`var d=document.documentElement,c=d.classList;${`c.remove(${b.map(K=>`'${K}'`).join(",")})`};`:`var d=document.documentElement,n='${r}',s='setAttribute';`,L=u?pC.includes(m)&&m?`if(e==='light'||e==='dark'||!e)d.style.colorScheme=e||'${m}'`:"if(e==='light'||e==='dark')d.style.colorScheme=e":"",z=(K,H=!1,Z=!0)=>{let Y=v?v[K]:K,ee=H?K+"|| ''":`'${Y}'`,ie="";return u&&Z&&!H&&pC.includes(K)&&(ie+=`d.style.colorScheme = '${K}';`),r==="class"?H||Y?ie+=`c.add(${ee})`:ie+="null":Y&&(ie+=`d[s](n,${ee})`),ie},O=t?`!function(){${M}${z(t)}}()`:l?`!function(){try{${M}var e=localStorage.getItem('${e}');if('system'===e||(!e&&${k})){var t='${wz}',m=window.matchMedia(t);if(m.media!==t||m.matches){${z("dark")}}else{${z("light")}}}else if(e){${v?`var x=${JSON.stringify(v)};`:""}${z(v?"x[e]":"e",!0)}}${k?"":"else{"+z(m,!1,!1)+"}"}${L}}catch(e){}}()`:`!function(){try{${M}var e=localStorage.getItem('${e}');if(e){${v?`var x=${JSON.stringify(v)};`:""}${z(v?"x[e]":"e",!0)}}else{${z(m,!1,!1)};}${L}}catch(t){}}();`;return P.createElement("script",{nonce:a,dangerouslySetInnerHTML:{__html:O}})});var Ez=t=>{switch(t){case"success":return Az;case"info":return Mz;case"warning":return Iz;case"error":return Pz;default:return null}},Cz=Array(12).fill(0),kz=({visible:t,className:e})=>Zt.createElement("div",{className:["sonner-loading-wrapper",e].filter(Boolean).join(" "),"data-visible":t},Zt.createElement("div",{className:"sonner-spinner"},Cz.map((r,l)=>Zt.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${l}`})))),Az=Zt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Zt.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),Iz=Zt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Zt.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),Mz=Zt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Zt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),Pz=Zt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Zt.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),Rz=Zt.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Zt.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Zt.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),Nz=()=>{let[t,e]=Zt.useState(document.hidden);return Zt.useEffect(()=>{let r=()=>{e(document.hidden)};return document.addEventListener("visibilitychange",r),()=>window.removeEventListener("visibilitychange",r)},[]),t},fw=1,Dz=class{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{let e=this.subscribers.indexOf(t);this.subscribers.splice(e,1)}),this.publish=t=>{this.subscribers.forEach(e=>e(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var e;let{message:r,...l}=t,u=typeof t?.id=="number"||((e=t.id)==null?void 0:e.length)>0?t.id:fw++,m=this.toasts.find(b=>b.id===u),v=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(u)&&this.dismissedToasts.delete(u),m?this.toasts=this.toasts.map(b=>b.id===u?(this.publish({...b,...t,id:u,title:r}),{...b,...t,id:u,dismissible:v,title:r}):b):this.addToast({title:r,...l,dismissible:v,id:u}),u},this.dismiss=t=>(this.dismissedToasts.add(t),t||this.toasts.forEach(e=>{this.subscribers.forEach(r=>r({id:e.id,dismiss:!0}))}),this.subscribers.forEach(e=>e({id:t,dismiss:!0})),t),this.message=(t,e)=>this.create({...e,message:t}),this.error=(t,e)=>this.create({...e,message:t,type:"error"}),this.success=(t,e)=>this.create({...e,type:"success",message:t}),this.info=(t,e)=>this.create({...e,type:"info",message:t}),this.warning=(t,e)=>this.create({...e,type:"warning",message:t}),this.loading=(t,e)=>this.create({...e,type:"loading",message:t}),this.promise=(t,e)=>{if(!e)return;let r;e.loading!==void 0&&(r=this.create({...e,promise:t,type:"loading",message:e.loading,description:typeof e.description!="function"?e.description:void 0}));let l=t instanceof Promise?t:t(),u=r!==void 0,m,v=l.then(async a=>{if(m=["resolve",a],Zt.isValidElement(a))u=!1,this.create({id:r,type:"default",message:a});else if(jz(a)&&!a.ok){u=!1;let k=typeof e.error=="function"?await e.error(`HTTP error! status: ${a.status}`):e.error,M=typeof e.description=="function"?await e.description(`HTTP error! status: ${a.status}`):e.description;this.create({id:r,type:"error",message:k,description:M})}else if(e.success!==void 0){u=!1;let k=typeof e.success=="function"?await e.success(a):e.success,M=typeof e.description=="function"?await e.description(a):e.description;this.create({id:r,type:"success",message:k,description:M})}}).catch(async a=>{if(m=["reject",a],e.error!==void 0){u=!1;let k=typeof e.error=="function"?await e.error(a):e.error,M=typeof e.description=="function"?await e.description(a):e.description;this.create({id:r,type:"error",message:k,description:M})}}).finally(()=>{var a;u&&(this.dismiss(r),r=void 0),(a=e.finally)==null||a.call(e)}),b=()=>new Promise((a,k)=>v.then(()=>m[0]==="reject"?k(m[1]):a(m[1])).catch(k));return typeof r!="string"&&typeof r!="number"?{unwrap:b}:Object.assign(r,{unwrap:b})},this.custom=(t,e)=>{let r=e?.id||fw++;return this.create({jsx:t(r),id:r,...e}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}},na=new Dz,Lz=(t,e)=>{let r=e?.id||fw++;return na.addToast({title:t,...e,id:r}),r},jz=t=>t&&typeof t=="object"&&"ok"in t&&typeof t.ok=="boolean"&&"status"in t&&typeof t.status=="number",Oz=Lz,zz=()=>na.toasts,Bz=()=>na.getActiveToasts(),Ht=Object.assign(Oz,{success:na.success,info:na.info,warning:na.warning,error:na.error,custom:na.custom,message:na.message,promise:na.promise,dismiss:na.dismiss,loading:na.loading},{getHistory:zz,getToasts:Bz});function Fz(t,{insertAt:e}={}){if(typeof document>"u")return;let r=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.type="text/css",e==="top"&&r.firstChild?r.insertBefore(l,r.firstChild):r.appendChild(l),l.styleSheet?l.styleSheet.cssText=t:l.appendChild(document.createTextNode(t))}Fz(`:where(html[dir="ltr"]),:where([data-sonner-toaster][dir="ltr"]){--toast-icon-margin-start: -3px;--toast-icon-margin-end: 4px;--toast-svg-margin-start: -1px;--toast-svg-margin-end: 0px;--toast-button-margin-start: auto;--toast-button-margin-end: 0;--toast-close-button-start: 0;--toast-close-button-end: unset;--toast-close-button-transform: translate(-35%, -35%)}:where(html[dir="rtl"]),:where([data-sonner-toaster][dir="rtl"]){--toast-icon-margin-start: 4px;--toast-icon-margin-end: -3px;--toast-svg-margin-start: 0px;--toast-svg-margin-end: -1px;--toast-button-margin-start: 0;--toast-button-margin-end: auto;--toast-close-button-start: unset;--toast-close-button-end: 0;--toast-close-button-transform: translate(35%, -35%)}:where([data-sonner-toaster]){position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1: hsl(0, 0%, 99%);--gray2: hsl(0, 0%, 97.3%);--gray3: hsl(0, 0%, 95.1%);--gray4: hsl(0, 0%, 93%);--gray5: hsl(0, 0%, 90.9%);--gray6: hsl(0, 0%, 88.7%);--gray7: hsl(0, 0%, 85.8%);--gray8: hsl(0, 0%, 78%);--gray9: hsl(0, 0%, 56.1%);--gray10: hsl(0, 0%, 52.3%);--gray11: hsl(0, 0%, 43.5%);--gray12: hsl(0, 0%, 9%);--border-radius: 8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:none;z-index:999999999;transition:transform .4s ease}:where([data-sonner-toaster][data-lifted="true"]){transform:translateY(-10px)}@media (hover: none) and (pointer: coarse){:where([data-sonner-toaster][data-lifted="true"]){transform:none}}:where([data-sonner-toaster][data-x-position="right"]){right:var(--offset-right)}:where([data-sonner-toaster][data-x-position="left"]){left:var(--offset-left)}:where([data-sonner-toaster][data-x-position="center"]){left:50%;transform:translate(-50%)}:where([data-sonner-toaster][data-y-position="top"]){top:var(--offset-top)}:where([data-sonner-toaster][data-y-position="bottom"]){bottom:var(--offset-bottom)}:where([data-sonner-toast]){--y: translateY(100%);--lift-amount: calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);filter:blur(0);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:none;overflow-wrap:anywhere}:where([data-sonner-toast][data-styled="true"]){padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px #0000001a;width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}:where([data-sonner-toast]:focus-visible){box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast][data-y-position="top"]){top:0;--y: translateY(-100%);--lift: 1;--lift-amount: calc(1 * var(--gap))}:where([data-sonner-toast][data-y-position="bottom"]){bottom:0;--y: translateY(100%);--lift: -1;--lift-amount: calc(var(--lift) * var(--gap))}:where([data-sonner-toast]) :where([data-description]){font-weight:400;line-height:1.4;color:inherit}:where([data-sonner-toast]) :where([data-title]){font-weight:500;line-height:1.5;color:inherit}:where([data-sonner-toast]) :where([data-icon]){display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}:where([data-sonner-toast][data-promise="true"]) :where([data-icon])>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}:where([data-sonner-toast]) :where([data-icon])>*{flex-shrink:0}:where([data-sonner-toast]) :where([data-icon]) svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}:where([data-sonner-toast]) :where([data-content]){display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;cursor:pointer;outline:none;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}:where([data-sonner-toast]) :where([data-button]):focus-visible{box-shadow:0 0 0 2px #0006}:where([data-sonner-toast]) :where([data-button]):first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}:where([data-sonner-toast]) :where([data-cancel]){color:var(--normal-text);background:rgba(0,0,0,.08)}:where([data-sonner-toast][data-theme="dark"]) :where([data-cancel]){background:rgba(255,255,255,.3)}:where([data-sonner-toast]) :where([data-close-button]){position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast] [data-close-button]{background:var(--gray1)}:where([data-sonner-toast]) :where([data-close-button]):focus-visible{box-shadow:0 4px 12px #0000001a,0 0 0 2px #0003}:where([data-sonner-toast]) :where([data-disabled="true"]){cursor:not-allowed}:where([data-sonner-toast]):hover :where([data-close-button]):hover{background:var(--gray2);border-color:var(--gray5)}:where([data-sonner-toast][data-swiping="true"]):before{content:"";position:absolute;left:-50%;right:-50%;height:100%;z-index:-1}:where([data-sonner-toast][data-y-position="top"][data-swiping="true"]):before{bottom:50%;transform:scaleY(3) translateY(50%)}:where([data-sonner-toast][data-y-position="bottom"][data-swiping="true"]):before{top:50%;transform:scaleY(3) translateY(-50%)}:where([data-sonner-toast][data-swiping="false"][data-removed="true"]):before{content:"";position:absolute;inset:0;transform:scaleY(2)}:where([data-sonner-toast]):after{content:"";position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}:where([data-sonner-toast][data-mounted="true"]){--y: translateY(0);opacity:1}:where([data-sonner-toast][data-expanded="false"][data-front="false"]){--scale: var(--toasts-before) * .05 + 1;--y: translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}:where([data-sonner-toast])>*{transition:opacity .4s}:where([data-sonner-toast][data-expanded="false"][data-front="false"][data-styled="true"])>*{opacity:0}:where([data-sonner-toast][data-visible="false"]){opacity:0;pointer-events:none}:where([data-sonner-toast][data-mounted="true"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}:where([data-sonner-toast][data-removed="true"][data-front="true"][data-swipe-out="false"]){--y: translateY(calc(var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="true"]){--y: translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}:where([data-sonner-toast][data-removed="true"][data-front="false"][data-swipe-out="false"][data-expanded="false"]){--y: translateY(40%);opacity:0;transition:transform .5s,opacity .2s}:where([data-sonner-toast][data-removed="true"][data-front="false"]):before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y, 0px)) translate(var(--swipe-amount-x, 0px));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{0%{transform:var(--y) translate(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translate(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{0%{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width: 600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-theme=light]{--normal-bg: #fff;--normal-border: var(--gray4);--normal-text: var(--gray12);--success-bg: hsl(143, 85%, 96%);--success-border: hsl(145, 92%, 91%);--success-text: hsl(140, 100%, 27%);--info-bg: hsl(208, 100%, 97%);--info-border: hsl(221, 91%, 91%);--info-text: hsl(210, 92%, 45%);--warning-bg: hsl(49, 100%, 97%);--warning-border: hsl(49, 91%, 91%);--warning-text: hsl(31, 92%, 45%);--error-bg: hsl(359, 100%, 97%);--error-border: hsl(359, 100%, 94%);--error-text: hsl(360, 100%, 45%)}[data-sonner-toaster][data-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg: #000;--normal-border: hsl(0, 0%, 20%);--normal-text: var(--gray1)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg: #fff;--normal-border: var(--gray3);--normal-text: var(--gray12)}[data-sonner-toaster][data-theme=dark]{--normal-bg: #000;--normal-bg-hover: hsl(0, 0%, 12%);--normal-border: hsl(0, 0%, 20%);--normal-border-hover: hsl(0, 0%, 25%);--normal-text: var(--gray1);--success-bg: hsl(150, 100%, 6%);--success-border: hsl(147, 100%, 12%);--success-text: hsl(150, 86%, 65%);--info-bg: hsl(215, 100%, 6%);--info-border: hsl(223, 100%, 12%);--info-text: hsl(216, 87%, 65%);--warning-bg: hsl(64, 100%, 6%);--warning-border: hsl(60, 100%, 12%);--warning-text: hsl(46, 87%, 65%);--error-bg: hsl(358, 76%, 10%);--error-border: hsl(357, 89%, 16%);--error-text: hsl(358, 100%, 81%)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success],[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info],[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning],[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error],[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size: 16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:nth-child(1){animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}to{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}to{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}to{opacity:.15}}@media (prefers-reduced-motion){[data-sonner-toast],[data-sonner-toast]>*,.sonner-loading-bar{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}
`);function sx(t){return t.label!==void 0}var Vz=3,Uz="32px",$z="16px",mC=4e3,Gz=356,Hz=14,Wz=20,qz=200;function jl(...t){return t.filter(Boolean).join(" ")}function Zz(t){let[e,r]=t.split("-"),l=[];return e&&l.push(e),r&&l.push(r),l}var Xz=t=>{var e,r,l,u,m,v,b,a,k,M,L;let{invert:z,toast:O,unstyled:K,interacting:H,setHeights:Z,visibleToasts:Y,heights:ee,index:ie,toasts:pe,expanded:we,removeToast:ke,defaultRichColors:ze,closeButton:Ge,style:tt,cancelButtonStyle:Pe,actionButtonStyle:ot,className:ut="",descriptionClassName:gt="",duration:ht,position:Lt,gap:mt,loadingIcon:pt,expandByDefault:Ae,classNames:xe,icons:We,closeButtonAriaLabel:he="Close toast",pauseWhenPageIsHidden:Fe}=t,[it,vt]=Zt.useState(null),[Wt,rn]=Zt.useState(null),[wt,Kt]=Zt.useState(!1),[Tn,fn]=Zt.useState(!1),[Cn,tn]=Zt.useState(!1),[mr,hr]=Zt.useState(!1),[_i,Xn]=Zt.useState(!1),[Er,Xs]=Zt.useState(0),[xi,Zr]=Zt.useState(0),ni=Zt.useRef(O.duration||ht||mC),rs=Zt.useRef(null),Wi=Zt.useRef(null),Ms=ie===0,_s=ie+1<=Y,Vr=O.type,is=O.dismissible!==!1,vi=O.className||"",Ps=O.descriptionClassName||"",qi=Zt.useMemo(()=>ee.findIndex(be=>be.toastId===O.id)||0,[ee,O.id]),ki=Zt.useMemo(()=>{var be;return(be=O.closeButton)!=null?be:Ge},[O.closeButton,Ge]),yo=Zt.useMemo(()=>O.duration||ht||mC,[O.duration,ht]),Ks=Zt.useRef(0),Ai=Zt.useRef(0),ss=Zt.useRef(0),ri=Zt.useRef(null),[Rs,Ys]=Lt.split("-"),_o=Zt.useMemo(()=>ee.reduce((be,Oe,Be)=>Be>=qi?be:be+Oe.height,0),[ee,qi]),Te=Nz(),ne=O.invert||z,re=Vr==="loading";Ai.current=Zt.useMemo(()=>qi*mt+_o,[qi,_o]),Zt.useEffect(()=>{ni.current=yo},[yo]),Zt.useEffect(()=>{Kt(!0)},[]),Zt.useEffect(()=>{let be=Wi.current;if(be){let Oe=be.getBoundingClientRect().height;return Zr(Oe),Z(Be=>[{toastId:O.id,height:Oe,position:O.position},...Be]),()=>Z(Be=>Be.filter(je=>je.toastId!==O.id))}},[Z,O.id]),Zt.useLayoutEffect(()=>{if(!wt)return;let be=Wi.current,Oe=be.style.height;be.style.height="auto";let Be=be.getBoundingClientRect().height;be.style.height=Oe,Zr(Be),Z(je=>je.find(Ze=>Ze.toastId===O.id)?je.map(Ze=>Ze.toastId===O.id?{...Ze,height:Be}:Ze):[{toastId:O.id,height:Be,position:O.position},...je])},[wt,O.title,O.description,Z,O.id]);let ue=Zt.useCallback(()=>{fn(!0),Xs(Ai.current),Z(be=>be.filter(Oe=>Oe.toastId!==O.id)),setTimeout(()=>{ke(O)},qz)},[O,ke,Z,Ai]);Zt.useEffect(()=>{if(O.promise&&Vr==="loading"||O.duration===1/0||O.type==="loading")return;let be;return we||H||Fe&&Te?(()=>{if(ss.current<Ks.current){let Oe=new Date().getTime()-Ks.current;ni.current=ni.current-Oe}ss.current=new Date().getTime()})():ni.current!==1/0&&(Ks.current=new Date().getTime(),be=setTimeout(()=>{var Oe;(Oe=O.onAutoClose)==null||Oe.call(O,O),ue()},ni.current)),()=>clearTimeout(be)},[we,H,O,Vr,Fe,Te,ue]),Zt.useEffect(()=>{O.delete&&ue()},[ue,O.delete]);function Se(){var be,Oe,Be;return We!=null&&We.loading?Zt.createElement("div",{className:jl(xe?.loader,(be=O?.classNames)==null?void 0:be.loader,"sonner-loader"),"data-visible":Vr==="loading"},We.loading):pt?Zt.createElement("div",{className:jl(xe?.loader,(Oe=O?.classNames)==null?void 0:Oe.loader,"sonner-loader"),"data-visible":Vr==="loading"},pt):Zt.createElement(kz,{className:jl(xe?.loader,(Be=O?.classNames)==null?void 0:Be.loader),visible:Vr==="loading"})}return Zt.createElement("li",{tabIndex:0,ref:Wi,className:jl(ut,vi,xe?.toast,(e=O?.classNames)==null?void 0:e.toast,xe?.default,xe?.[Vr],(r=O?.classNames)==null?void 0:r[Vr]),"data-sonner-toast":"","data-rich-colors":(l=O.richColors)!=null?l:ze,"data-styled":!(O.jsx||O.unstyled||K),"data-mounted":wt,"data-promise":!!O.promise,"data-swiped":_i,"data-removed":Tn,"data-visible":_s,"data-y-position":Rs,"data-x-position":Ys,"data-index":ie,"data-front":Ms,"data-swiping":Cn,"data-dismissible":is,"data-type":Vr,"data-invert":ne,"data-swipe-out":mr,"data-swipe-direction":Wt,"data-expanded":!!(we||Ae&&wt),style:{"--index":ie,"--toasts-before":ie,"--z-index":pe.length-ie,"--offset":`${Tn?Er:Ai.current}px`,"--initial-height":Ae?"auto":`${xi}px`,...tt,...O.style},onDragEnd:()=>{tn(!1),vt(null),ri.current=null},onPointerDown:be=>{re||!is||(rs.current=new Date,Xs(Ai.current),be.target.setPointerCapture(be.pointerId),be.target.tagName!=="BUTTON"&&(tn(!0),ri.current={x:be.clientX,y:be.clientY}))},onPointerUp:()=>{var be,Oe,Be,je;if(mr||!is)return;ri.current=null;let Ze=Number(((be=Wi.current)==null?void 0:be.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),St=Number(((Oe=Wi.current)==null?void 0:Oe.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),Rt=new Date().getTime()-((Be=rs.current)==null?void 0:Be.getTime()),bt=it==="x"?Ze:St,vn=Math.abs(bt)/Rt;if(Math.abs(bt)>=Wz||vn>.11){Xs(Ai.current),(je=O.onDismiss)==null||je.call(O,O),rn(it==="x"?Ze>0?"right":"left":St>0?"down":"up"),ue(),hr(!0),Xn(!1);return}tn(!1),vt(null)},onPointerMove:be=>{var Oe,Be,je,Ze;if(!ri.current||!is||((Oe=window.getSelection())==null?void 0:Oe.toString().length)>0)return;let St=be.clientY-ri.current.y,Rt=be.clientX-ri.current.x,bt=(Be=t.swipeDirections)!=null?Be:Zz(Lt);!it&&(Math.abs(Rt)>1||Math.abs(St)>1)&&vt(Math.abs(Rt)>Math.abs(St)?"x":"y");let vn={x:0,y:0};it==="y"?(bt.includes("top")||bt.includes("bottom"))&&(bt.includes("top")&&St<0||bt.includes("bottom")&&St>0)&&(vn.y=St):it==="x"&&(bt.includes("left")||bt.includes("right"))&&(bt.includes("left")&&Rt<0||bt.includes("right")&&Rt>0)&&(vn.x=Rt),(Math.abs(vn.x)>0||Math.abs(vn.y)>0)&&Xn(!0),(je=Wi.current)==null||je.style.setProperty("--swipe-amount-x",`${vn.x}px`),(Ze=Wi.current)==null||Ze.style.setProperty("--swipe-amount-y",`${vn.y}px`)}},ki&&!O.jsx?Zt.createElement("button",{"aria-label":he,"data-disabled":re,"data-close-button":!0,onClick:re||!is?()=>{}:()=>{var be;ue(),(be=O.onDismiss)==null||be.call(O,O)},className:jl(xe?.closeButton,(u=O?.classNames)==null?void 0:u.closeButton)},(m=We?.close)!=null?m:Rz):null,O.jsx||P.isValidElement(O.title)?O.jsx?O.jsx:typeof O.title=="function"?O.title():O.title:Zt.createElement(Zt.Fragment,null,Vr||O.icon||O.promise?Zt.createElement("div",{"data-icon":"",className:jl(xe?.icon,(v=O?.classNames)==null?void 0:v.icon)},O.promise||O.type==="loading"&&!O.icon?O.icon||Se():null,O.type!=="loading"?O.icon||We?.[Vr]||Ez(Vr):null):null,Zt.createElement("div",{"data-content":"",className:jl(xe?.content,(b=O?.classNames)==null?void 0:b.content)},Zt.createElement("div",{"data-title":"",className:jl(xe?.title,(a=O?.classNames)==null?void 0:a.title)},typeof O.title=="function"?O.title():O.title),O.description?Zt.createElement("div",{"data-description":"",className:jl(gt,Ps,xe?.description,(k=O?.classNames)==null?void 0:k.description)},typeof O.description=="function"?O.description():O.description):null),P.isValidElement(O.cancel)?O.cancel:O.cancel&&sx(O.cancel)?Zt.createElement("button",{"data-button":!0,"data-cancel":!0,style:O.cancelButtonStyle||Pe,onClick:be=>{var Oe,Be;sx(O.cancel)&&is&&((Be=(Oe=O.cancel).onClick)==null||Be.call(Oe,be),ue())},className:jl(xe?.cancelButton,(M=O?.classNames)==null?void 0:M.cancelButton)},O.cancel.label):null,P.isValidElement(O.action)?O.action:O.action&&sx(O.action)?Zt.createElement("button",{"data-button":!0,"data-action":!0,style:O.actionButtonStyle||ot,onClick:be=>{var Oe,Be;sx(O.action)&&((Be=(Oe=O.action).onClick)==null||Be.call(Oe,be),!be.defaultPrevented&&ue())},className:jl(xe?.actionButton,(L=O?.classNames)==null?void 0:L.actionButton)},O.action.label):null))};function gC(){if(typeof window>"u"||typeof document>"u")return"ltr";let t=document.documentElement.getAttribute("dir");return t==="auto"||!t?window.getComputedStyle(document.documentElement).direction:t}function Kz(t,e){let r={};return[t,e].forEach((l,u)=>{let m=u===1,v=m?"--mobile-offset":"--offset",b=m?$z:Uz;function a(k){["top","right","bottom","left"].forEach(M=>{r[`${v}-${M}`]=typeof k=="number"?`${k}px`:k})}typeof l=="number"||typeof l=="string"?a(l):typeof l=="object"?["top","right","bottom","left"].forEach(k=>{l[k]===void 0?r[`${v}-${k}`]=b:r[`${v}-${k}`]=typeof l[k]=="number"?`${l[k]}px`:l[k]}):a(b)}),r}var Yz=P.forwardRef(function(t,e){let{invert:r,position:l="bottom-right",hotkey:u=["altKey","KeyT"],expand:m,closeButton:v,className:b,offset:a,mobileOffset:k,theme:M="light",richColors:L,duration:z,style:O,visibleToasts:K=Vz,toastOptions:H,dir:Z=gC(),gap:Y=Hz,loadingIcon:ee,icons:ie,containerAriaLabel:pe="Notifications",pauseWhenPageIsHidden:we}=t,[ke,ze]=Zt.useState([]),Ge=Zt.useMemo(()=>Array.from(new Set([l].concat(ke.filter(Fe=>Fe.position).map(Fe=>Fe.position)))),[ke,l]),[tt,Pe]=Zt.useState([]),[ot,ut]=Zt.useState(!1),[gt,ht]=Zt.useState(!1),[Lt,mt]=Zt.useState(M!=="system"?M:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),pt=Zt.useRef(null),Ae=u.join("+").replace(/Key/g,"").replace(/Digit/g,""),xe=Zt.useRef(null),We=Zt.useRef(!1),he=Zt.useCallback(Fe=>{ze(it=>{var vt;return(vt=it.find(Wt=>Wt.id===Fe.id))!=null&&vt.delete||na.dismiss(Fe.id),it.filter(({id:Wt})=>Wt!==Fe.id)})},[]);return Zt.useEffect(()=>na.subscribe(Fe=>{if(Fe.dismiss){ze(it=>it.map(vt=>vt.id===Fe.id?{...vt,delete:!0}:vt));return}setTimeout(()=>{GI.flushSync(()=>{ze(it=>{let vt=it.findIndex(Wt=>Wt.id===Fe.id);return vt!==-1?[...it.slice(0,vt),{...it[vt],...Fe},...it.slice(vt+1)]:[Fe,...it]})})})}),[]),Zt.useEffect(()=>{if(M!=="system"){mt(M);return}if(M==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?mt("dark"):mt("light")),typeof window>"u")return;let Fe=window.matchMedia("(prefers-color-scheme: dark)");try{Fe.addEventListener("change",({matches:it})=>{mt(it?"dark":"light")})}catch{Fe.addListener(({matches:vt})=>{try{mt(vt?"dark":"light")}catch(Wt){console.error(Wt)}})}},[M]),Zt.useEffect(()=>{ke.length<=1&&ut(!1)},[ke]),Zt.useEffect(()=>{let Fe=it=>{var vt,Wt;u.every(rn=>it[rn]||it.code===rn)&&(ut(!0),(vt=pt.current)==null||vt.focus()),it.code==="Escape"&&(document.activeElement===pt.current||(Wt=pt.current)!=null&&Wt.contains(document.activeElement))&&ut(!1)};return document.addEventListener("keydown",Fe),()=>document.removeEventListener("keydown",Fe)},[u]),Zt.useEffect(()=>{if(pt.current)return()=>{xe.current&&(xe.current.focus({preventScroll:!0}),xe.current=null,We.current=!1)}},[pt.current]),Zt.createElement("section",{ref:e,"aria-label":`${pe} ${Ae}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},Ge.map((Fe,it)=>{var vt;let[Wt,rn]=Fe.split("-");return ke.length?Zt.createElement("ol",{key:Fe,dir:Z==="auto"?gC():Z,tabIndex:-1,ref:pt,className:b,"data-sonner-toaster":!0,"data-theme":Lt,"data-y-position":Wt,"data-lifted":ot&&ke.length>1&&!m,"data-x-position":rn,style:{"--front-toast-height":`${((vt=tt[0])==null?void 0:vt.height)||0}px`,"--width":`${Gz}px`,"--gap":`${Y}px`,...O,...Kz(a,k)},onBlur:wt=>{We.current&&!wt.currentTarget.contains(wt.relatedTarget)&&(We.current=!1,xe.current&&(xe.current.focus({preventScroll:!0}),xe.current=null))},onFocus:wt=>{wt.target instanceof HTMLElement&&wt.target.dataset.dismissible==="false"||We.current||(We.current=!0,xe.current=wt.relatedTarget)},onMouseEnter:()=>ut(!0),onMouseMove:()=>ut(!0),onMouseLeave:()=>{gt||ut(!1)},onDragEnd:()=>ut(!1),onPointerDown:wt=>{wt.target instanceof HTMLElement&&wt.target.dataset.dismissible==="false"||ht(!0)},onPointerUp:()=>ht(!1)},ke.filter(wt=>!wt.position&&it===0||wt.position===Fe).map((wt,Kt)=>{var Tn,fn;return Zt.createElement(Xz,{key:wt.id,icons:ie,index:Kt,toast:wt,defaultRichColors:L,duration:(Tn=H?.duration)!=null?Tn:z,className:H?.className,descriptionClassName:H?.descriptionClassName,invert:r,visibleToasts:K,closeButton:(fn=H?.closeButton)!=null?fn:v,interacting:gt,position:Fe,style:H?.style,unstyled:H?.unstyled,classNames:H?.classNames,cancelButtonStyle:H?.cancelButtonStyle,actionButtonStyle:H?.actionButtonStyle,removeToast:he,toasts:ke.filter(Cn=>Cn.position==wt.position),heights:tt.filter(Cn=>Cn.position==wt.position),setHeights:Pe,expandByDefault:m,gap:Y,loadingIcon:ee,expanded:ot,pauseWhenPageIsHidden:we,swipeDirections:t.swipeDirections})})):null}))});const Jz=({...t})=>{const{theme:e="system"}=Sz();return x.jsx(Yz,{theme:e,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...t})};var Qz=vv[" useId ".trim().toString()]||(()=>{}),eB=0;function $c(t){const[e,r]=P.useState(Qz());return Hi(()=>{r(l=>l??String(eB++))},[t]),e?`radix-${e}`:""}const tB=["top","right","bottom","left"],fh=Math.min,ba=Math.max,Fx=Math.round,ox=Math.floor,Gc=t=>({x:t,y:t}),nB={left:"right",right:"left",bottom:"top",top:"bottom"},rB={start:"end",end:"start"};function pw(t,e,r){return ba(t,fh(e,r))}function qu(t,e){return typeof t=="function"?t(e):t}function Zu(t){return t.split("-")[0]}function Wm(t){return t.split("-")[1]}function Rb(t){return t==="x"?"y":"x"}function Nb(t){return t==="y"?"height":"width"}const iB=new Set(["top","bottom"]);function Uc(t){return iB.has(Zu(t))?"y":"x"}function Db(t){return Rb(Uc(t))}function sB(t,e,r){r===void 0&&(r=!1);const l=Wm(t),u=Db(t),m=Nb(u);let v=u==="x"?l===(r?"end":"start")?"right":"left":l==="start"?"bottom":"top";return e.reference[m]>e.floating[m]&&(v=Vx(v)),[v,Vx(v)]}function oB(t){const e=Vx(t);return[mw(t),e,mw(e)]}function mw(t){return t.replace(/start|end/g,e=>rB[e])}const yC=["left","right"],_C=["right","left"],aB=["top","bottom"],lB=["bottom","top"];function cB(t,e,r){switch(t){case"top":case"bottom":return r?e?_C:yC:e?yC:_C;case"left":case"right":return e?aB:lB;default:return[]}}function uB(t,e,r,l){const u=Wm(t);let m=cB(Zu(t),r==="start",l);return u&&(m=m.map(v=>v+"-"+u),e&&(m=m.concat(m.map(mw)))),m}function Vx(t){return t.replace(/left|right|bottom|top/g,e=>nB[e])}function dB(t){return{top:0,right:0,bottom:0,left:0,...t}}function zM(t){return typeof t!="number"?dB(t):{top:t,right:t,bottom:t,left:t}}function Ux(t){const{x:e,y:r,width:l,height:u}=t;return{width:l,height:u,top:r,left:e,right:e+l,bottom:r+u,x:e,y:r}}function xC(t,e,r){let{reference:l,floating:u}=t;const m=Uc(e),v=Db(e),b=Nb(v),a=Zu(e),k=m==="y",M=l.x+l.width/2-u.width/2,L=l.y+l.height/2-u.height/2,z=l[b]/2-u[b]/2;let O;switch(a){case"top":O={x:M,y:l.y-u.height};break;case"bottom":O={x:M,y:l.y+l.height};break;case"right":O={x:l.x+l.width,y:L};break;case"left":O={x:l.x-u.width,y:L};break;default:O={x:l.x,y:l.y}}switch(Wm(e)){case"start":O[v]-=z*(r&&k?-1:1);break;case"end":O[v]+=z*(r&&k?-1:1);break}return O}const hB=async(t,e,r)=>{const{placement:l="bottom",strategy:u="absolute",middleware:m=[],platform:v}=r,b=m.filter(Boolean),a=await(v.isRTL==null?void 0:v.isRTL(e));let k=await v.getElementRects({reference:t,floating:e,strategy:u}),{x:M,y:L}=xC(k,l,a),z=l,O={},K=0;for(let H=0;H<b.length;H++){const{name:Z,fn:Y}=b[H],{x:ee,y:ie,data:pe,reset:we}=await Y({x:M,y:L,initialPlacement:l,placement:z,strategy:u,middlewareData:O,rects:k,platform:v,elements:{reference:t,floating:e}});M=ee??M,L=ie??L,O={...O,[Z]:{...O[Z],...pe}},we&&K<=50&&(K++,typeof we=="object"&&(we.placement&&(z=we.placement),we.rects&&(k=we.rects===!0?await v.getElementRects({reference:t,floating:e,strategy:u}):we.rects),{x:M,y:L}=xC(k,z,a)),H=-1)}return{x:M,y:L,placement:z,strategy:u,middlewareData:O}};async function ky(t,e){var r;e===void 0&&(e={});const{x:l,y:u,platform:m,rects:v,elements:b,strategy:a}=t,{boundary:k="clippingAncestors",rootBoundary:M="viewport",elementContext:L="floating",altBoundary:z=!1,padding:O=0}=qu(e,t),K=zM(O),Z=b[z?L==="floating"?"reference":"floating":L],Y=Ux(await m.getClippingRect({element:(r=await(m.isElement==null?void 0:m.isElement(Z)))==null||r?Z:Z.contextElement||await(m.getDocumentElement==null?void 0:m.getDocumentElement(b.floating)),boundary:k,rootBoundary:M,strategy:a})),ee=L==="floating"?{x:l,y:u,width:v.floating.width,height:v.floating.height}:v.reference,ie=await(m.getOffsetParent==null?void 0:m.getOffsetParent(b.floating)),pe=await(m.isElement==null?void 0:m.isElement(ie))?await(m.getScale==null?void 0:m.getScale(ie))||{x:1,y:1}:{x:1,y:1},we=Ux(m.convertOffsetParentRelativeRectToViewportRelativeRect?await m.convertOffsetParentRelativeRectToViewportRelativeRect({elements:b,rect:ee,offsetParent:ie,strategy:a}):ee);return{top:(Y.top-we.top+K.top)/pe.y,bottom:(we.bottom-Y.bottom+K.bottom)/pe.y,left:(Y.left-we.left+K.left)/pe.x,right:(we.right-Y.right+K.right)/pe.x}}const fB=t=>({name:"arrow",options:t,async fn(e){const{x:r,y:l,placement:u,rects:m,platform:v,elements:b,middlewareData:a}=e,{element:k,padding:M=0}=qu(t,e)||{};if(k==null)return{};const L=zM(M),z={x:r,y:l},O=Db(u),K=Nb(O),H=await v.getDimensions(k),Z=O==="y",Y=Z?"top":"left",ee=Z?"bottom":"right",ie=Z?"clientHeight":"clientWidth",pe=m.reference[K]+m.reference[O]-z[O]-m.floating[K],we=z[O]-m.reference[O],ke=await(v.getOffsetParent==null?void 0:v.getOffsetParent(k));let ze=ke?ke[ie]:0;(!ze||!await(v.isElement==null?void 0:v.isElement(ke)))&&(ze=b.floating[ie]||m.floating[K]);const Ge=pe/2-we/2,tt=ze/2-H[K]/2-1,Pe=fh(L[Y],tt),ot=fh(L[ee],tt),ut=Pe,gt=ze-H[K]-ot,ht=ze/2-H[K]/2+Ge,Lt=pw(ut,ht,gt),mt=!a.arrow&&Wm(u)!=null&&ht!==Lt&&m.reference[K]/2-(ht<ut?Pe:ot)-H[K]/2<0,pt=mt?ht<ut?ht-ut:ht-gt:0;return{[O]:z[O]+pt,data:{[O]:Lt,centerOffset:ht-Lt-pt,...mt&&{alignmentOffset:pt}},reset:mt}}}),pB=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var r,l;const{placement:u,middlewareData:m,rects:v,initialPlacement:b,platform:a,elements:k}=e,{mainAxis:M=!0,crossAxis:L=!0,fallbackPlacements:z,fallbackStrategy:O="bestFit",fallbackAxisSideDirection:K="none",flipAlignment:H=!0,...Z}=qu(t,e);if((r=m.arrow)!=null&&r.alignmentOffset)return{};const Y=Zu(u),ee=Uc(b),ie=Zu(b)===b,pe=await(a.isRTL==null?void 0:a.isRTL(k.floating)),we=z||(ie||!H?[Vx(b)]:oB(b)),ke=K!=="none";!z&&ke&&we.push(...uB(b,H,K,pe));const ze=[b,...we],Ge=await ky(e,Z),tt=[];let Pe=((l=m.flip)==null?void 0:l.overflows)||[];if(M&&tt.push(Ge[Y]),L){const ht=sB(u,v,pe);tt.push(Ge[ht[0]],Ge[ht[1]])}if(Pe=[...Pe,{placement:u,overflows:tt}],!tt.every(ht=>ht<=0)){var ot,ut;const ht=(((ot=m.flip)==null?void 0:ot.index)||0)+1,Lt=ze[ht];if(Lt&&(!(L==="alignment"?ee!==Uc(Lt):!1)||Pe.every(Ae=>Uc(Ae.placement)===ee?Ae.overflows[0]>0:!0)))return{data:{index:ht,overflows:Pe},reset:{placement:Lt}};let mt=(ut=Pe.filter(pt=>pt.overflows[0]<=0).sort((pt,Ae)=>pt.overflows[1]-Ae.overflows[1])[0])==null?void 0:ut.placement;if(!mt)switch(O){case"bestFit":{var gt;const pt=(gt=Pe.filter(Ae=>{if(ke){const xe=Uc(Ae.placement);return xe===ee||xe==="y"}return!0}).map(Ae=>[Ae.placement,Ae.overflows.filter(xe=>xe>0).reduce((xe,We)=>xe+We,0)]).sort((Ae,xe)=>Ae[1]-xe[1])[0])==null?void 0:gt[0];pt&&(mt=pt);break}case"initialPlacement":mt=b;break}if(u!==mt)return{reset:{placement:mt}}}return{}}}};function vC(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function wC(t){return tB.some(e=>t[e]>=0)}const mB=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:r}=e,{strategy:l="referenceHidden",...u}=qu(t,e);switch(l){case"referenceHidden":{const m=await ky(e,{...u,elementContext:"reference"}),v=vC(m,r.reference);return{data:{referenceHiddenOffsets:v,referenceHidden:wC(v)}}}case"escaped":{const m=await ky(e,{...u,altBoundary:!0}),v=vC(m,r.floating);return{data:{escapedOffsets:v,escaped:wC(v)}}}default:return{}}}}},BM=new Set(["left","top"]);async function gB(t,e){const{placement:r,platform:l,elements:u}=t,m=await(l.isRTL==null?void 0:l.isRTL(u.floating)),v=Zu(r),b=Wm(r),a=Uc(r)==="y",k=BM.has(v)?-1:1,M=m&&a?-1:1,L=qu(e,t);let{mainAxis:z,crossAxis:O,alignmentAxis:K}=typeof L=="number"?{mainAxis:L,crossAxis:0,alignmentAxis:null}:{mainAxis:L.mainAxis||0,crossAxis:L.crossAxis||0,alignmentAxis:L.alignmentAxis};return b&&typeof K=="number"&&(O=b==="end"?K*-1:K),a?{x:O*M,y:z*k}:{x:z*k,y:O*M}}const yB=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var r,l;const{x:u,y:m,placement:v,middlewareData:b}=e,a=await gB(e,t);return v===((r=b.offset)==null?void 0:r.placement)&&(l=b.arrow)!=null&&l.alignmentOffset?{}:{x:u+a.x,y:m+a.y,data:{...a,placement:v}}}}},_B=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:r,y:l,placement:u}=e,{mainAxis:m=!0,crossAxis:v=!1,limiter:b={fn:Z=>{let{x:Y,y:ee}=Z;return{x:Y,y:ee}}},...a}=qu(t,e),k={x:r,y:l},M=await ky(e,a),L=Uc(Zu(u)),z=Rb(L);let O=k[z],K=k[L];if(m){const Z=z==="y"?"top":"left",Y=z==="y"?"bottom":"right",ee=O+M[Z],ie=O-M[Y];O=pw(ee,O,ie)}if(v){const Z=L==="y"?"top":"left",Y=L==="y"?"bottom":"right",ee=K+M[Z],ie=K-M[Y];K=pw(ee,K,ie)}const H=b.fn({...e,[z]:O,[L]:K});return{...H,data:{x:H.x-r,y:H.y-l,enabled:{[z]:m,[L]:v}}}}}},xB=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:r,y:l,placement:u,rects:m,middlewareData:v}=e,{offset:b=0,mainAxis:a=!0,crossAxis:k=!0}=qu(t,e),M={x:r,y:l},L=Uc(u),z=Rb(L);let O=M[z],K=M[L];const H=qu(b,e),Z=typeof H=="number"?{mainAxis:H,crossAxis:0}:{mainAxis:0,crossAxis:0,...H};if(a){const ie=z==="y"?"height":"width",pe=m.reference[z]-m.floating[ie]+Z.mainAxis,we=m.reference[z]+m.reference[ie]-Z.mainAxis;O<pe?O=pe:O>we&&(O=we)}if(k){var Y,ee;const ie=z==="y"?"width":"height",pe=BM.has(Zu(u)),we=m.reference[L]-m.floating[ie]+(pe&&((Y=v.offset)==null?void 0:Y[L])||0)+(pe?0:Z.crossAxis),ke=m.reference[L]+m.reference[ie]+(pe?0:((ee=v.offset)==null?void 0:ee[L])||0)-(pe?Z.crossAxis:0);K<we?K=we:K>ke&&(K=ke)}return{[z]:O,[L]:K}}}},vB=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var r,l;const{placement:u,rects:m,platform:v,elements:b}=e,{apply:a=()=>{},...k}=qu(t,e),M=await ky(e,k),L=Zu(u),z=Wm(u),O=Uc(u)==="y",{width:K,height:H}=m.floating;let Z,Y;L==="top"||L==="bottom"?(Z=L,Y=z===(await(v.isRTL==null?void 0:v.isRTL(b.floating))?"start":"end")?"left":"right"):(Y=L,Z=z==="end"?"top":"bottom");const ee=H-M.top-M.bottom,ie=K-M.left-M.right,pe=fh(H-M[Z],ee),we=fh(K-M[Y],ie),ke=!e.middlewareData.shift;let ze=pe,Ge=we;if((r=e.middlewareData.shift)!=null&&r.enabled.x&&(Ge=ie),(l=e.middlewareData.shift)!=null&&l.enabled.y&&(ze=ee),ke&&!z){const Pe=ba(M.left,0),ot=ba(M.right,0),ut=ba(M.top,0),gt=ba(M.bottom,0);O?Ge=K-2*(Pe!==0||ot!==0?Pe+ot:ba(M.left,M.right)):ze=H-2*(ut!==0||gt!==0?ut+gt:ba(M.top,M.bottom))}await a({...e,availableWidth:Ge,availableHeight:ze});const tt=await v.getDimensions(b.floating);return K!==tt.width||H!==tt.height?{reset:{rects:!0}}:{}}}};function Av(){return typeof window<"u"}function qm(t){return FM(t)?(t.nodeName||"").toLowerCase():"#document"}function Ea(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Yc(t){var e;return(e=(FM(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function FM(t){return Av()?t instanceof Node||t instanceof Ea(t).Node:!1}function Gl(t){return Av()?t instanceof Element||t instanceof Ea(t).Element:!1}function Xc(t){return Av()?t instanceof HTMLElement||t instanceof Ea(t).HTMLElement:!1}function bC(t){return!Av()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Ea(t).ShadowRoot}const wB=new Set(["inline","contents"]);function Jy(t){const{overflow:e,overflowX:r,overflowY:l,display:u}=Hl(t);return/auto|scroll|overlay|hidden|clip/.test(e+l+r)&&!wB.has(u)}const bB=new Set(["table","td","th"]);function TB(t){return bB.has(qm(t))}const SB=[":popover-open",":modal"];function Iv(t){return SB.some(e=>{try{return t.matches(e)}catch{return!1}})}const EB=["transform","translate","scale","rotate","perspective"],CB=["transform","translate","scale","rotate","perspective","filter"],kB=["paint","layout","strict","content"];function Lb(t){const e=jb(),r=Gl(t)?Hl(t):t;return EB.some(l=>r[l]?r[l]!=="none":!1)||(r.containerType?r.containerType!=="normal":!1)||!e&&(r.backdropFilter?r.backdropFilter!=="none":!1)||!e&&(r.filter?r.filter!=="none":!1)||CB.some(l=>(r.willChange||"").includes(l))||kB.some(l=>(r.contain||"").includes(l))}function AB(t){let e=ph(t);for(;Xc(e)&&!Dm(e);){if(Lb(e))return e;if(Iv(e))return null;e=ph(e)}return null}function jb(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const IB=new Set(["html","body","#document"]);function Dm(t){return IB.has(qm(t))}function Hl(t){return Ea(t).getComputedStyle(t)}function Mv(t){return Gl(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ph(t){if(qm(t)==="html")return t;const e=t.assignedSlot||t.parentNode||bC(t)&&t.host||Yc(t);return bC(e)?e.host:e}function VM(t){const e=ph(t);return Dm(e)?t.ownerDocument?t.ownerDocument.body:t.body:Xc(e)&&Jy(e)?e:VM(e)}function Ay(t,e,r){var l;e===void 0&&(e=[]),r===void 0&&(r=!0);const u=VM(t),m=u===((l=t.ownerDocument)==null?void 0:l.body),v=Ea(u);if(m){const b=gw(v);return e.concat(v,v.visualViewport||[],Jy(u)?u:[],b&&r?Ay(b):[])}return e.concat(u,Ay(u,[],r))}function gw(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function UM(t){const e=Hl(t);let r=parseFloat(e.width)||0,l=parseFloat(e.height)||0;const u=Xc(t),m=u?t.offsetWidth:r,v=u?t.offsetHeight:l,b=Fx(r)!==m||Fx(l)!==v;return b&&(r=m,l=v),{width:r,height:l,$:b}}function Ob(t){return Gl(t)?t:t.contextElement}function Em(t){const e=Ob(t);if(!Xc(e))return Gc(1);const r=e.getBoundingClientRect(),{width:l,height:u,$:m}=UM(e);let v=(m?Fx(r.width):r.width)/l,b=(m?Fx(r.height):r.height)/u;return(!v||!Number.isFinite(v))&&(v=1),(!b||!Number.isFinite(b))&&(b=1),{x:v,y:b}}const MB=Gc(0);function $M(t){const e=Ea(t);return!jb()||!e.visualViewport?MB:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function PB(t,e,r){return e===void 0&&(e=!1),!r||e&&r!==Ea(t)?!1:e}function Wf(t,e,r,l){e===void 0&&(e=!1),r===void 0&&(r=!1);const u=t.getBoundingClientRect(),m=Ob(t);let v=Gc(1);e&&(l?Gl(l)&&(v=Em(l)):v=Em(t));const b=PB(m,r,l)?$M(m):Gc(0);let a=(u.left+b.x)/v.x,k=(u.top+b.y)/v.y,M=u.width/v.x,L=u.height/v.y;if(m){const z=Ea(m),O=l&&Gl(l)?Ea(l):l;let K=z,H=gw(K);for(;H&&l&&O!==K;){const Z=Em(H),Y=H.getBoundingClientRect(),ee=Hl(H),ie=Y.left+(H.clientLeft+parseFloat(ee.paddingLeft))*Z.x,pe=Y.top+(H.clientTop+parseFloat(ee.paddingTop))*Z.y;a*=Z.x,k*=Z.y,M*=Z.x,L*=Z.y,a+=ie,k+=pe,K=Ea(H),H=gw(K)}}return Ux({width:M,height:L,x:a,y:k})}function Pv(t,e){const r=Mv(t).scrollLeft;return e?e.left+r:Wf(Yc(t)).left+r}function GM(t,e){const r=t.getBoundingClientRect(),l=r.left+e.scrollLeft-Pv(t,r),u=r.top+e.scrollTop;return{x:l,y:u}}function RB(t){let{elements:e,rect:r,offsetParent:l,strategy:u}=t;const m=u==="fixed",v=Yc(l),b=e?Iv(e.floating):!1;if(l===v||b&&m)return r;let a={scrollLeft:0,scrollTop:0},k=Gc(1);const M=Gc(0),L=Xc(l);if((L||!L&&!m)&&((qm(l)!=="body"||Jy(v))&&(a=Mv(l)),Xc(l))){const O=Wf(l);k=Em(l),M.x=O.x+l.clientLeft,M.y=O.y+l.clientTop}const z=v&&!L&&!m?GM(v,a):Gc(0);return{width:r.width*k.x,height:r.height*k.y,x:r.x*k.x-a.scrollLeft*k.x+M.x+z.x,y:r.y*k.y-a.scrollTop*k.y+M.y+z.y}}function NB(t){return Array.from(t.getClientRects())}function DB(t){const e=Yc(t),r=Mv(t),l=t.ownerDocument.body,u=ba(e.scrollWidth,e.clientWidth,l.scrollWidth,l.clientWidth),m=ba(e.scrollHeight,e.clientHeight,l.scrollHeight,l.clientHeight);let v=-r.scrollLeft+Pv(t);const b=-r.scrollTop;return Hl(l).direction==="rtl"&&(v+=ba(e.clientWidth,l.clientWidth)-u),{width:u,height:m,x:v,y:b}}const TC=25;function LB(t,e){const r=Ea(t),l=Yc(t),u=r.visualViewport;let m=l.clientWidth,v=l.clientHeight,b=0,a=0;if(u){m=u.width,v=u.height;const M=jb();(!M||M&&e==="fixed")&&(b=u.offsetLeft,a=u.offsetTop)}const k=Pv(l);if(k<=0){const M=l.ownerDocument,L=M.body,z=getComputedStyle(L),O=M.compatMode==="CSS1Compat"&&parseFloat(z.marginLeft)+parseFloat(z.marginRight)||0,K=Math.abs(l.clientWidth-L.clientWidth-O);K<=TC&&(m-=K)}else k<=TC&&(m+=k);return{width:m,height:v,x:b,y:a}}const jB=new Set(["absolute","fixed"]);function OB(t,e){const r=Wf(t,!0,e==="fixed"),l=r.top+t.clientTop,u=r.left+t.clientLeft,m=Xc(t)?Em(t):Gc(1),v=t.clientWidth*m.x,b=t.clientHeight*m.y,a=u*m.x,k=l*m.y;return{width:v,height:b,x:a,y:k}}function SC(t,e,r){let l;if(e==="viewport")l=LB(t,r);else if(e==="document")l=DB(Yc(t));else if(Gl(e))l=OB(e,r);else{const u=$M(t);l={x:e.x-u.x,y:e.y-u.y,width:e.width,height:e.height}}return Ux(l)}function HM(t,e){const r=ph(t);return r===e||!Gl(r)||Dm(r)?!1:Hl(r).position==="fixed"||HM(r,e)}function zB(t,e){const r=e.get(t);if(r)return r;let l=Ay(t,[],!1).filter(b=>Gl(b)&&qm(b)!=="body"),u=null;const m=Hl(t).position==="fixed";let v=m?ph(t):t;for(;Gl(v)&&!Dm(v);){const b=Hl(v),a=Lb(v);!a&&b.position==="fixed"&&(u=null),(m?!a&&!u:!a&&b.position==="static"&&!!u&&jB.has(u.position)||Jy(v)&&!a&&HM(t,v))?l=l.filter(M=>M!==v):u=b,v=ph(v)}return e.set(t,l),l}function BB(t){let{element:e,boundary:r,rootBoundary:l,strategy:u}=t;const v=[...r==="clippingAncestors"?Iv(e)?[]:zB(e,this._c):[].concat(r),l],b=v[0],a=v.reduce((k,M)=>{const L=SC(e,M,u);return k.top=ba(L.top,k.top),k.right=fh(L.right,k.right),k.bottom=fh(L.bottom,k.bottom),k.left=ba(L.left,k.left),k},SC(e,b,u));return{width:a.right-a.left,height:a.bottom-a.top,x:a.left,y:a.top}}function FB(t){const{width:e,height:r}=UM(t);return{width:e,height:r}}function VB(t,e,r){const l=Xc(e),u=Yc(e),m=r==="fixed",v=Wf(t,!0,m,e);let b={scrollLeft:0,scrollTop:0};const a=Gc(0);function k(){a.x=Pv(u)}if(l||!l&&!m)if((qm(e)!=="body"||Jy(u))&&(b=Mv(e)),l){const O=Wf(e,!0,m,e);a.x=O.x+e.clientLeft,a.y=O.y+e.clientTop}else u&&k();m&&!l&&u&&k();const M=u&&!l&&!m?GM(u,b):Gc(0),L=v.left+b.scrollLeft-a.x-M.x,z=v.top+b.scrollTop-a.y-M.y;return{x:L,y:z,width:v.width,height:v.height}}function g1(t){return Hl(t).position==="static"}function EC(t,e){if(!Xc(t)||Hl(t).position==="fixed")return null;if(e)return e(t);let r=t.offsetParent;return Yc(t)===r&&(r=r.ownerDocument.body),r}function WM(t,e){const r=Ea(t);if(Iv(t))return r;if(!Xc(t)){let u=ph(t);for(;u&&!Dm(u);){if(Gl(u)&&!g1(u))return u;u=ph(u)}return r}let l=EC(t,e);for(;l&&TB(l)&&g1(l);)l=EC(l,e);return l&&Dm(l)&&g1(l)&&!Lb(l)?r:l||AB(t)||r}const UB=async function(t){const e=this.getOffsetParent||WM,r=this.getDimensions,l=await r(t.floating);return{reference:VB(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:l.width,height:l.height}}};function $B(t){return Hl(t).direction==="rtl"}const GB={convertOffsetParentRelativeRectToViewportRelativeRect:RB,getDocumentElement:Yc,getClippingRect:BB,getOffsetParent:WM,getElementRects:UB,getClientRects:NB,getDimensions:FB,getScale:Em,isElement:Gl,isRTL:$B};function qM(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function HB(t,e){let r=null,l;const u=Yc(t);function m(){var b;clearTimeout(l),(b=r)==null||b.disconnect(),r=null}function v(b,a){b===void 0&&(b=!1),a===void 0&&(a=1),m();const k=t.getBoundingClientRect(),{left:M,top:L,width:z,height:O}=k;if(b||e(),!z||!O)return;const K=ox(L),H=ox(u.clientWidth-(M+z)),Z=ox(u.clientHeight-(L+O)),Y=ox(M),ie={rootMargin:-K+"px "+-H+"px "+-Z+"px "+-Y+"px",threshold:ba(0,fh(1,a))||1};let pe=!0;function we(ke){const ze=ke[0].intersectionRatio;if(ze!==a){if(!pe)return v();ze?v(!1,ze):l=setTimeout(()=>{v(!1,1e-7)},1e3)}ze===1&&!qM(k,t.getBoundingClientRect())&&v(),pe=!1}try{r=new IntersectionObserver(we,{...ie,root:u.ownerDocument})}catch{r=new IntersectionObserver(we,ie)}r.observe(t)}return v(!0),m}function WB(t,e,r,l){l===void 0&&(l={});const{ancestorScroll:u=!0,ancestorResize:m=!0,elementResize:v=typeof ResizeObserver=="function",layoutShift:b=typeof IntersectionObserver=="function",animationFrame:a=!1}=l,k=Ob(t),M=u||m?[...k?Ay(k):[],...Ay(e)]:[];M.forEach(Y=>{u&&Y.addEventListener("scroll",r,{passive:!0}),m&&Y.addEventListener("resize",r)});const L=k&&b?HB(k,r):null;let z=-1,O=null;v&&(O=new ResizeObserver(Y=>{let[ee]=Y;ee&&ee.target===k&&O&&(O.unobserve(e),cancelAnimationFrame(z),z=requestAnimationFrame(()=>{var ie;(ie=O)==null||ie.observe(e)})),r()}),k&&!a&&O.observe(k),O.observe(e));let K,H=a?Wf(t):null;a&&Z();function Z(){const Y=Wf(t);H&&!qM(H,Y)&&r(),H=Y,K=requestAnimationFrame(Z)}return r(),()=>{var Y;M.forEach(ee=>{u&&ee.removeEventListener("scroll",r),m&&ee.removeEventListener("resize",r)}),L?.(),(Y=O)==null||Y.disconnect(),O=null,a&&cancelAnimationFrame(K)}}const qB=yB,ZB=_B,XB=pB,KB=vB,YB=mB,CC=fB,JB=xB,QB=(t,e,r)=>{const l=new Map,u={platform:GB,...r},m={...u.platform,_c:l};return hB(t,e,{...u,platform:m})};var eF=typeof document<"u",tF=function(){},Ex=eF?P.useLayoutEffect:tF;function $x(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let r,l,u;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(r=t.length,r!==e.length)return!1;for(l=r;l--!==0;)if(!$x(t[l],e[l]))return!1;return!0}if(u=Object.keys(t),r=u.length,r!==Object.keys(e).length)return!1;for(l=r;l--!==0;)if(!{}.hasOwnProperty.call(e,u[l]))return!1;for(l=r;l--!==0;){const m=u[l];if(!(m==="_owner"&&t.$$typeof)&&!$x(t[m],e[m]))return!1}return!0}return t!==t&&e!==e}function ZM(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function kC(t,e){const r=ZM(t);return Math.round(e*r)/r}function y1(t){const e=P.useRef(t);return Ex(()=>{e.current=t}),e}function nF(t){t===void 0&&(t={});const{placement:e="bottom",strategy:r="absolute",middleware:l=[],platform:u,elements:{reference:m,floating:v}={},transform:b=!0,whileElementsMounted:a,open:k}=t,[M,L]=P.useState({x:0,y:0,strategy:r,placement:e,middlewareData:{},isPositioned:!1}),[z,O]=P.useState(l);$x(z,l)||O(l);const[K,H]=P.useState(null),[Z,Y]=P.useState(null),ee=P.useCallback(Ae=>{Ae!==ke.current&&(ke.current=Ae,H(Ae))},[]),ie=P.useCallback(Ae=>{Ae!==ze.current&&(ze.current=Ae,Y(Ae))},[]),pe=m||K,we=v||Z,ke=P.useRef(null),ze=P.useRef(null),Ge=P.useRef(M),tt=a!=null,Pe=y1(a),ot=y1(u),ut=y1(k),gt=P.useCallback(()=>{if(!ke.current||!ze.current)return;const Ae={placement:e,strategy:r,middleware:z};ot.current&&(Ae.platform=ot.current),QB(ke.current,ze.current,Ae).then(xe=>{const We={...xe,isPositioned:ut.current!==!1};ht.current&&!$x(Ge.current,We)&&(Ge.current=We,xh.flushSync(()=>{L(We)}))})},[z,e,r,ot,ut]);Ex(()=>{k===!1&&Ge.current.isPositioned&&(Ge.current.isPositioned=!1,L(Ae=>({...Ae,isPositioned:!1})))},[k]);const ht=P.useRef(!1);Ex(()=>(ht.current=!0,()=>{ht.current=!1}),[]),Ex(()=>{if(pe&&(ke.current=pe),we&&(ze.current=we),pe&&we){if(Pe.current)return Pe.current(pe,we,gt);gt()}},[pe,we,gt,Pe,tt]);const Lt=P.useMemo(()=>({reference:ke,floating:ze,setReference:ee,setFloating:ie}),[ee,ie]),mt=P.useMemo(()=>({reference:pe,floating:we}),[pe,we]),pt=P.useMemo(()=>{const Ae={position:r,left:0,top:0};if(!mt.floating)return Ae;const xe=kC(mt.floating,M.x),We=kC(mt.floating,M.y);return b?{...Ae,transform:"translate("+xe+"px, "+We+"px)",...ZM(mt.floating)>=1.5&&{willChange:"transform"}}:{position:r,left:xe,top:We}},[r,b,mt.floating,M.x,M.y]);return P.useMemo(()=>({...M,update:gt,refs:Lt,elements:mt,floatingStyles:pt}),[M,gt,Lt,mt,pt])}const rF=t=>{function e(r){return{}.hasOwnProperty.call(r,"current")}return{name:"arrow",options:t,fn(r){const{element:l,padding:u}=typeof t=="function"?t(r):t;return l&&e(l)?l.current!=null?CC({element:l.current,padding:u}).fn(r):{}:l?CC({element:l,padding:u}).fn(r):{}}}},iF=(t,e)=>({...qB(t),options:[t,e]}),sF=(t,e)=>({...ZB(t),options:[t,e]}),oF=(t,e)=>({...JB(t),options:[t,e]}),aF=(t,e)=>({...XB(t),options:[t,e]}),lF=(t,e)=>({...KB(t),options:[t,e]}),cF=(t,e)=>({...YB(t),options:[t,e]}),uF=(t,e)=>({...rF(t),options:[t,e]});var dF="Arrow",XM=P.forwardRef((t,e)=>{const{children:r,width:l=10,height:u=5,...m}=t;return x.jsx(Mn.svg,{...m,ref:e,width:l,height:u,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?r:x.jsx("polygon",{points:"0,0 30,0 15,10"})})});XM.displayName=dF;var hF=XM;function KM(t){const[e,r]=P.useState(void 0);return Hi(()=>{if(t){r({width:t.offsetWidth,height:t.offsetHeight});const l=new ResizeObserver(u=>{if(!Array.isArray(u)||!u.length)return;const m=u[0];let v,b;if("borderBoxSize"in m){const a=m.borderBoxSize,k=Array.isArray(a)?a[0]:a;v=k.inlineSize,b=k.blockSize}else v=t.offsetWidth,b=t.offsetHeight;r({width:v,height:b})});return l.observe(t,{box:"border-box"}),()=>l.unobserve(t)}else r(void 0)},[t]),e}var zb="Popper",[YM,Zm]=sl(zb),[fF,JM]=YM(zb),QM=t=>{const{__scopePopper:e,children:r}=t,[l,u]=P.useState(null);return x.jsx(fF,{scope:e,anchor:l,onAnchorChange:u,children:r})};QM.displayName=zb;var eP="PopperAnchor",tP=P.forwardRef((t,e)=>{const{__scopePopper:r,virtualRef:l,...u}=t,m=JM(eP,r),v=P.useRef(null),b=ir(e,v),a=P.useRef(null);return P.useEffect(()=>{const k=a.current;a.current=l?.current||v.current,k!==a.current&&m.onAnchorChange(a.current)}),l?null:x.jsx(Mn.div,{...u,ref:b})});tP.displayName=eP;var Bb="PopperContent",[pF,mF]=YM(Bb),nP=P.forwardRef((t,e)=>{const{__scopePopper:r,side:l="bottom",sideOffset:u=0,align:m="center",alignOffset:v=0,arrowPadding:b=0,avoidCollisions:a=!0,collisionBoundary:k=[],collisionPadding:M=0,sticky:L="partial",hideWhenDetached:z=!1,updatePositionStrategy:O="optimized",onPlaced:K,...H}=t,Z=JM(Bb,r),[Y,ee]=P.useState(null),ie=ir(e,wt=>ee(wt)),[pe,we]=P.useState(null),ke=KM(pe),ze=ke?.width??0,Ge=ke?.height??0,tt=l+(m!=="center"?"-"+m:""),Pe=typeof M=="number"?M:{top:0,right:0,bottom:0,left:0,...M},ot=Array.isArray(k)?k:[k],ut=ot.length>0,gt={padding:Pe,boundary:ot.filter(yF),altBoundary:ut},{refs:ht,floatingStyles:Lt,placement:mt,isPositioned:pt,middlewareData:Ae}=nF({strategy:"fixed",placement:tt,whileElementsMounted:(...wt)=>WB(...wt,{animationFrame:O==="always"}),elements:{reference:Z.anchor},middleware:[iF({mainAxis:u+Ge,alignmentAxis:v}),a&&sF({mainAxis:!0,crossAxis:!1,limiter:L==="partial"?oF():void 0,...gt}),a&&aF({...gt}),lF({...gt,apply:({elements:wt,rects:Kt,availableWidth:Tn,availableHeight:fn})=>{const{width:Cn,height:tn}=Kt.reference,mr=wt.floating.style;mr.setProperty("--radix-popper-available-width",`${Tn}px`),mr.setProperty("--radix-popper-available-height",`${fn}px`),mr.setProperty("--radix-popper-anchor-width",`${Cn}px`),mr.setProperty("--radix-popper-anchor-height",`${tn}px`)}}),pe&&uF({element:pe,padding:b}),_F({arrowWidth:ze,arrowHeight:Ge}),z&&cF({strategy:"referenceHidden",...gt})]}),[xe,We]=sP(mt),he=Bi(K);Hi(()=>{pt&&he?.()},[pt,he]);const Fe=Ae.arrow?.x,it=Ae.arrow?.y,vt=Ae.arrow?.centerOffset!==0,[Wt,rn]=P.useState();return Hi(()=>{Y&&rn(window.getComputedStyle(Y).zIndex)},[Y]),x.jsx("div",{ref:ht.setFloating,"data-radix-popper-content-wrapper":"",style:{...Lt,transform:pt?Lt.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:Wt,"--radix-popper-transform-origin":[Ae.transformOrigin?.x,Ae.transformOrigin?.y].join(" "),...Ae.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:x.jsx(pF,{scope:r,placedSide:xe,onArrowChange:we,arrowX:Fe,arrowY:it,shouldHideArrow:vt,children:x.jsx(Mn.div,{"data-side":xe,"data-align":We,...H,ref:ie,style:{...H.style,animation:pt?void 0:"none"}})})})});nP.displayName=Bb;var rP="PopperArrow",gF={top:"bottom",right:"left",bottom:"top",left:"right"},iP=P.forwardRef(function(e,r){const{__scopePopper:l,...u}=e,m=mF(rP,l),v=gF[m.placedSide];return x.jsx("span",{ref:m.onArrowChange,style:{position:"absolute",left:m.arrowX,top:m.arrowY,[v]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[m.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[m.placedSide],visibility:m.shouldHideArrow?"hidden":void 0},children:x.jsx(hF,{...u,ref:r,style:{...u.style,display:"block"}})})});iP.displayName=rP;function yF(t){return t!==null}var _F=t=>({name:"transformOrigin",options:t,fn(e){const{placement:r,rects:l,middlewareData:u}=e,v=u.arrow?.centerOffset!==0,b=v?0:t.arrowWidth,a=v?0:t.arrowHeight,[k,M]=sP(r),L={start:"0%",center:"50%",end:"100%"}[M],z=(u.arrow?.x??0)+b/2,O=(u.arrow?.y??0)+a/2;let K="",H="";return k==="bottom"?(K=v?L:`${z}px`,H=`${-a}px`):k==="top"?(K=v?L:`${z}px`,H=`${l.floating.height+a}px`):k==="right"?(K=`${-a}px`,H=v?L:`${O}px`):k==="left"&&(K=`${l.floating.width+a}px`,H=v?L:`${O}px`),{data:{x:K,y:H}}}});function sP(t){const[e,r="center"]=t.split("-");return[e,r]}var oP=QM,Fb=tP,Vb=nP,Ub=iP,xF=Symbol("radix.slottable");function vF(t){const e=({children:r})=>x.jsx(x.Fragment,{children:r});return e.displayName=`${t}.Slottable`,e.__radixId=xF,e}var[Rv]=sl("Tooltip",[Zm]),$b=Zm(),aP="TooltipProvider",wF=700,AC="tooltip.open",[bF,lP]=Rv(aP),cP=t=>{const{__scopeTooltip:e,delayDuration:r=wF,skipDelayDuration:l=300,disableHoverableContent:u=!1,children:m}=t,v=P.useRef(!0),b=P.useRef(!1),a=P.useRef(0);return P.useEffect(()=>{const k=a.current;return()=>window.clearTimeout(k)},[]),x.jsx(bF,{scope:e,isOpenDelayedRef:v,delayDuration:r,onOpen:P.useCallback(()=>{window.clearTimeout(a.current),v.current=!1},[]),onClose:P.useCallback(()=>{window.clearTimeout(a.current),a.current=window.setTimeout(()=>v.current=!0,l)},[l]),isPointerInTransitRef:b,onPointerInTransitChange:P.useCallback(k=>{b.current=k},[]),disableHoverableContent:u,children:m})};cP.displayName=aP;var uP="Tooltip",[XJ,Nv]=Rv(uP),yw="TooltipTrigger",TF=P.forwardRef((t,e)=>{const{__scopeTooltip:r,...l}=t,u=Nv(yw,r),m=lP(yw,r),v=$b(r),b=P.useRef(null),a=ir(e,b,u.onTriggerChange),k=P.useRef(!1),M=P.useRef(!1),L=P.useCallback(()=>k.current=!1,[]);return P.useEffect(()=>()=>document.removeEventListener("pointerup",L),[L]),x.jsx(Fb,{asChild:!0,...v,children:x.jsx(Mn.button,{"aria-describedby":u.open?u.contentId:void 0,"data-state":u.stateAttribute,...l,ref:a,onPointerMove:Xt(t.onPointerMove,z=>{z.pointerType!=="touch"&&!M.current&&!m.isPointerInTransitRef.current&&(u.onTriggerEnter(),M.current=!0)}),onPointerLeave:Xt(t.onPointerLeave,()=>{u.onTriggerLeave(),M.current=!1}),onPointerDown:Xt(t.onPointerDown,()=>{u.open&&u.onClose(),k.current=!0,document.addEventListener("pointerup",L,{once:!0})}),onFocus:Xt(t.onFocus,()=>{k.current||u.onOpen()}),onBlur:Xt(t.onBlur,u.onClose),onClick:Xt(t.onClick,u.onClose)})})});TF.displayName=yw;var SF="TooltipPortal",[KJ,EF]=Rv(SF,{forceMount:void 0}),Lm="TooltipContent",dP=P.forwardRef((t,e)=>{const r=EF(Lm,t.__scopeTooltip),{forceMount:l=r.forceMount,side:u="top",...m}=t,v=Nv(Lm,t.__scopeTooltip);return x.jsx(jo,{present:l||v.open,children:v.disableHoverableContent?x.jsx(hP,{side:u,...m,ref:e}):x.jsx(CF,{side:u,...m,ref:e})})}),CF=P.forwardRef((t,e)=>{const r=Nv(Lm,t.__scopeTooltip),l=lP(Lm,t.__scopeTooltip),u=P.useRef(null),m=ir(e,u),[v,b]=P.useState(null),{trigger:a,onClose:k}=r,M=u.current,{onPointerInTransitChange:L}=l,z=P.useCallback(()=>{b(null),L(!1)},[L]),O=P.useCallback((K,H)=>{const Z=K.currentTarget,Y={x:K.clientX,y:K.clientY},ee=PF(Y,Z.getBoundingClientRect()),ie=RF(Y,ee),pe=NF(H.getBoundingClientRect()),we=LF([...ie,...pe]);b(we),L(!0)},[L]);return P.useEffect(()=>()=>z(),[z]),P.useEffect(()=>{if(a&&M){const K=Z=>O(Z,M),H=Z=>O(Z,a);return a.addEventListener("pointerleave",K),M.addEventListener("pointerleave",H),()=>{a.removeEventListener("pointerleave",K),M.removeEventListener("pointerleave",H)}}},[a,M,O,z]),P.useEffect(()=>{if(v){const K=H=>{const Z=H.target,Y={x:H.clientX,y:H.clientY},ee=a?.contains(Z)||M?.contains(Z),ie=!DF(Y,v);ee?z():ie&&(z(),k())};return document.addEventListener("pointermove",K),()=>document.removeEventListener("pointermove",K)}},[a,M,v,k,z]),x.jsx(hP,{...t,ref:m})}),[kF,AF]=Rv(uP,{isInside:!1}),IF=vF("TooltipContent"),hP=P.forwardRef((t,e)=>{const{__scopeTooltip:r,children:l,"aria-label":u,onEscapeKeyDown:m,onPointerDownOutside:v,...b}=t,a=Nv(Lm,r),k=$b(r),{onClose:M}=a;return P.useEffect(()=>(document.addEventListener(AC,M),()=>document.removeEventListener(AC,M)),[M]),P.useEffect(()=>{if(a.trigger){const L=z=>{z.target?.contains(a.trigger)&&M()};return window.addEventListener("scroll",L,{capture:!0}),()=>window.removeEventListener("scroll",L,{capture:!0})}},[a.trigger,M]),x.jsx(Gm,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:m,onPointerDownOutside:v,onFocusOutside:L=>L.preventDefault(),onDismiss:M,children:x.jsxs(Vb,{"data-state":a.stateAttribute,...k,...b,ref:e,style:{...b.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[x.jsx(IF,{children:l}),x.jsx(kF,{scope:r,isInside:!0,children:x.jsx(Hj,{id:a.contentId,role:"tooltip",children:u||l})})]})})});dP.displayName=Lm;var fP="TooltipArrow",MF=P.forwardRef((t,e)=>{const{__scopeTooltip:r,...l}=t,u=$b(r);return AF(fP,r).isInside?null:x.jsx(Ub,{...u,...l,ref:e})});MF.displayName=fP;function PF(t,e){const r=Math.abs(e.top-t.y),l=Math.abs(e.bottom-t.y),u=Math.abs(e.right-t.x),m=Math.abs(e.left-t.x);switch(Math.min(r,l,u,m)){case m:return"left";case u:return"right";case r:return"top";case l:return"bottom";default:throw new Error("unreachable")}}function RF(t,e,r=5){const l=[];switch(e){case"top":l.push({x:t.x-r,y:t.y+r},{x:t.x+r,y:t.y+r});break;case"bottom":l.push({x:t.x-r,y:t.y-r},{x:t.x+r,y:t.y-r});break;case"left":l.push({x:t.x+r,y:t.y-r},{x:t.x+r,y:t.y+r});break;case"right":l.push({x:t.x-r,y:t.y-r},{x:t.x-r,y:t.y+r});break}return l}function NF(t){const{top:e,right:r,bottom:l,left:u}=t;return[{x:u,y:e},{x:r,y:e},{x:r,y:l},{x:u,y:l}]}function DF(t,e){const{x:r,y:l}=t;let u=!1;for(let m=0,v=e.length-1;m<e.length;v=m++){const b=e[m],a=e[v],k=b.x,M=b.y,L=a.x,z=a.y;M>l!=z>l&&r<(L-k)*(l-M)/(z-M)+k&&(u=!u)}return u}function LF(t){const e=t.slice();return e.sort((r,l)=>r.x<l.x?-1:r.x>l.x?1:r.y<l.y?-1:r.y>l.y?1:0),jF(e)}function jF(t){if(t.length<=1)return t.slice();const e=[];for(let l=0;l<t.length;l++){const u=t[l];for(;e.length>=2;){const m=e[e.length-1],v=e[e.length-2];if((m.x-v.x)*(u.y-v.y)>=(m.y-v.y)*(u.x-v.x))e.pop();else break}e.push(u)}e.pop();const r=[];for(let l=t.length-1;l>=0;l--){const u=t[l];for(;r.length>=2;){const m=r[r.length-1],v=r[r.length-2];if((m.x-v.x)*(u.y-v.y)>=(m.y-v.y)*(u.x-v.x))r.pop();else break}r.push(u)}return r.pop(),e.length===1&&r.length===1&&e[0].x===r[0].x&&e[0].y===r[0].y?e:e.concat(r)}var OF=cP,pP=dP;const zF=OF,BF=P.forwardRef(({className:t,sideOffset:e=4,...r},l)=>x.jsx(pP,{ref:l,sideOffset:e,className:ln("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r}));BF.displayName=pP.displayName;var Xm=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},FF={setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t),setInterval:(t,e)=>setInterval(t,e),clearInterval:t=>clearInterval(t)},VF=class{#e=FF;#t=!1;setTimeoutProvider(t){this.#e=t}setTimeout(t,e){return this.#e.setTimeout(t,e)}clearTimeout(t){this.#e.clearTimeout(t)}setInterval(t,e){return this.#e.setInterval(t,e)}clearInterval(t){this.#e.clearInterval(t)}},Of=new VF;function UF(t){setTimeout(t,0)}var qf=typeof window>"u"||"Deno"in globalThis;function Ro(){}function $F(t,e){return typeof t=="function"?t(e):t}function _w(t){return typeof t=="number"&&t>=0&&t!==1/0}function mP(t,e){return Math.max(t+(e||0)-Date.now(),0)}function lh(t,e){return typeof t=="function"?t(e):t}function el(t,e){return typeof t=="function"?t(e):t}function IC(t,e){const{type:r="all",exact:l,fetchStatus:u,predicate:m,queryKey:v,stale:b}=t;if(v){if(l){if(e.queryHash!==Gb(v,e.options))return!1}else if(!Iy(e.queryKey,v))return!1}if(r!=="all"){const a=e.isActive();if(r==="active"&&!a||r==="inactive"&&a)return!1}return!(typeof b=="boolean"&&e.isStale()!==b||u&&u!==e.state.fetchStatus||m&&!m(e))}function MC(t,e){const{exact:r,status:l,predicate:u,mutationKey:m}=t;if(m){if(!e.options.mutationKey)return!1;if(r){if(Zf(e.options.mutationKey)!==Zf(m))return!1}else if(!Iy(e.options.mutationKey,m))return!1}return!(l&&e.state.status!==l||u&&!u(e))}function Gb(t,e){return(e?.queryKeyHashFn||Zf)(t)}function Zf(t){return JSON.stringify(t,(e,r)=>xw(r)?Object.keys(r).sort().reduce((l,u)=>(l[u]=r[u],l),{}):r)}function Iy(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?Object.keys(e).every(r=>Iy(t[r],e[r])):!1}var GF=Object.prototype.hasOwnProperty;function gP(t,e,r=0){if(t===e)return t;if(r>500)return e;const l=PC(t)&&PC(e);if(!l&&!(xw(t)&&xw(e)))return e;const m=(l?t:Object.keys(t)).length,v=l?e:Object.keys(e),b=v.length,a=l?new Array(b):{};let k=0;for(let M=0;M<b;M++){const L=l?M:v[M],z=t[L],O=e[L];if(z===O){a[L]=z,(l?M<m:GF.call(t,L))&&k++;continue}if(z===null||O===null||typeof z!="object"||typeof O!="object"){a[L]=O;continue}const K=gP(z,O,r+1);a[L]=K,K===z&&k++}return m===b&&k===m?t:a}function Gx(t,e){if(!e||Object.keys(t).length!==Object.keys(e).length)return!1;for(const r in t)if(t[r]!==e[r])return!1;return!0}function PC(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function xw(t){if(!RC(t))return!1;const e=t.constructor;if(e===void 0)return!0;const r=e.prototype;return!(!RC(r)||!r.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function RC(t){return Object.prototype.toString.call(t)==="[object Object]"}function HF(t){return new Promise(e=>{Of.setTimeout(e,t)})}function vw(t,e,r){return typeof r.structuralSharing=="function"?r.structuralSharing(t,e):r.structuralSharing!==!1?gP(t,e):e}function WF(t,e,r=0){const l=[...t,e];return r&&l.length>r?l.slice(1):l}function qF(t,e,r=0){const l=[e,...t];return r&&l.length>r?l.slice(0,-1):l}var Hb=Symbol();function yP(t,e){return!t.queryFn&&e?.initialPromise?()=>e.initialPromise:!t.queryFn||t.queryFn===Hb?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}function Wb(t,e){return typeof t=="function"?t(...e):!!t}function ZF(t,e,r){let l=!1,u;return Object.defineProperty(t,"signal",{enumerable:!0,get:()=>(u??=e(),l||(l=!0,u.aborted?r():u.addEventListener("abort",r,{once:!0})),u)}),t}var XF=class extends Xm{#e;#t;#n;constructor(){super(),this.#n=t=>{if(!qf&&window.addEventListener){const e=()=>t();return window.addEventListener("visibilitychange",e,!1),()=>{window.removeEventListener("visibilitychange",e)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(e=>{typeof e=="boolean"?this.setFocused(e):this.onFocus()})}setFocused(t){this.#e!==t&&(this.#e=t,this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(e=>{e(t)})}isFocused(){return typeof this.#e=="boolean"?this.#e:globalThis.document?.visibilityState!=="hidden"}},qb=new XF;function ww(){let t,e;const r=new Promise((u,m)=>{t=u,e=m});r.status="pending",r.catch(()=>{});function l(u){Object.assign(r,u),delete r.resolve,delete r.reject}return r.resolve=u=>{l({status:"fulfilled",value:u}),t(u)},r.reject=u=>{l({status:"rejected",reason:u}),e(u)},r}var KF=UF;function YF(){let t=[],e=0,r=b=>{b()},l=b=>{b()},u=KF;const m=b=>{e?t.push(b):u(()=>{r(b)})},v=()=>{const b=t;t=[],b.length&&u(()=>{l(()=>{b.forEach(a=>{r(a)})})})};return{batch:b=>{let a;e++;try{a=b()}finally{e--,e||v()}return a},batchCalls:b=>(...a)=>{m(()=>{b(...a)})},schedule:m,setNotifyFunction:b=>{r=b},setBatchNotifyFunction:b=>{l=b},setScheduler:b=>{u=b}}}var gs=YF(),JF=class extends Xm{#e=!0;#t;#n;constructor(){super(),this.#n=t=>{if(!qf&&window.addEventListener){const e=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",e,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",e),window.removeEventListener("offline",r)}}}}onSubscribe(){this.#t||this.setEventListener(this.#n)}onUnsubscribe(){this.hasListeners()||(this.#t?.(),this.#t=void 0)}setEventListener(t){this.#n=t,this.#t?.(),this.#t=t(this.setOnline.bind(this))}setOnline(t){this.#e!==t&&(this.#e=t,this.listeners.forEach(r=>{r(t)}))}isOnline(){return this.#e}},Hx=new JF;function QF(t){return Math.min(1e3*2**t,3e4)}function _P(t){return(t??"online")==="online"?Hx.isOnline():!0}var bw=class extends Error{constructor(t){super("CancelledError"),this.revert=t?.revert,this.silent=t?.silent}};function xP(t){let e=!1,r=0,l;const u=ww(),m=()=>u.status!=="pending",v=H=>{if(!m()){const Z=new bw(H);z(Z),t.onCancel?.(Z)}},b=()=>{e=!0},a=()=>{e=!1},k=()=>qb.isFocused()&&(t.networkMode==="always"||Hx.isOnline())&&t.canRun(),M=()=>_P(t.networkMode)&&t.canRun(),L=H=>{m()||(l?.(),u.resolve(H))},z=H=>{m()||(l?.(),u.reject(H))},O=()=>new Promise(H=>{l=Z=>{(m()||k())&&H(Z)},t.onPause?.()}).then(()=>{l=void 0,m()||t.onContinue?.()}),K=()=>{if(m())return;let H;const Z=r===0?t.initialPromise:void 0;try{H=Z??t.fn()}catch(Y){H=Promise.reject(Y)}Promise.resolve(H).then(L).catch(Y=>{if(m())return;const ee=t.retry??(qf?0:3),ie=t.retryDelay??QF,pe=typeof ie=="function"?ie(r,Y):ie,we=ee===!0||typeof ee=="number"&&r<ee||typeof ee=="function"&&ee(r,Y);if(e||!we){z(Y);return}r++,t.onFail?.(r,Y),HF(pe).then(()=>k()?void 0:O()).then(()=>{e?z(Y):K()})})};return{promise:u,status:()=>u.status,cancel:v,continue:()=>(l?.(),u),cancelRetry:b,continueRetry:a,canStart:M,start:()=>(M()?K():O().then(K),u)}}var vP=class{#e;destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),_w(this.gcTime)&&(this.#e=Of.setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(qf?1/0:300*1e3))}clearGcTimeout(){this.#e&&(Of.clearTimeout(this.#e),this.#e=void 0)}},e6=class extends vP{#e;#t;#n;#i;#r;#o;#a;constructor(t){super(),this.#a=!1,this.#o=t.defaultOptions,this.setOptions(t.options),this.observers=[],this.#i=t.client,this.#n=this.#i.getQueryCache(),this.queryKey=t.queryKey,this.queryHash=t.queryHash,this.#e=DC(this.options),this.state=t.state??this.#e,this.scheduleGc()}get meta(){return this.options.meta}get promise(){return this.#r?.promise}setOptions(t){if(this.options={...this.#o,...t},this.updateGcTime(this.options.gcTime),this.state&&this.state.data===void 0){const e=DC(this.options);e.data!==void 0&&(this.setState(NC(e.data,e.dataUpdatedAt)),this.#e=e)}}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&this.#n.remove(this)}setData(t,e){const r=vw(this.state.data,t,this.options);return this.#s({data:r,type:"success",dataUpdatedAt:e?.updatedAt,manual:e?.manual}),r}setState(t,e){this.#s({type:"setState",state:t,setStateOptions:e})}cancel(t){const e=this.#r?.promise;return this.#r?.cancel(t),e?e.then(Ro).catch(Ro):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(this.#e)}isActive(){return this.observers.some(t=>el(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Hb||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>lh(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!mP(this.state.dataUpdatedAt,t)}onFocus(){this.observers.find(e=>e.shouldFetchOnWindowFocus())?.refetch({cancelRefetch:!1}),this.#r?.continue()}onOnline(){this.observers.find(e=>e.shouldFetchOnReconnect())?.refetch({cancelRefetch:!1}),this.#r?.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(e=>e!==t),this.observers.length||(this.#r&&(this.#a?this.#r.cancel({revert:!0}):this.#r.cancelRetry()),this.scheduleGc()),this.#n.notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||this.#s({type:"invalidate"})}async fetch(t,e){if(this.state.fetchStatus!=="idle"&&this.#r?.status()!=="rejected"){if(this.state.data!==void 0&&e?.cancelRefetch)this.cancel({silent:!0});else if(this.#r)return this.#r.continueRetry(),this.#r.promise}if(t&&this.setOptions(t),!this.options.queryFn){const b=this.observers.find(a=>a.options.queryFn);b&&this.setOptions(b.options)}const r=new AbortController,l=b=>{Object.defineProperty(b,"signal",{enumerable:!0,get:()=>(this.#a=!0,r.signal)})},u=()=>{const b=yP(this.options,e),k=(()=>{const M={client:this.#i,queryKey:this.queryKey,meta:this.meta};return l(M),M})();return this.#a=!1,this.options.persister?this.options.persister(b,k,this):b(k)},v=(()=>{const b={fetchOptions:e,options:this.options,queryKey:this.queryKey,client:this.#i,state:this.state,fetchFn:u};return l(b),b})();this.options.behavior?.onFetch(v,this),this.#t=this.state,(this.state.fetchStatus==="idle"||this.state.fetchMeta!==v.fetchOptions?.meta)&&this.#s({type:"fetch",meta:v.fetchOptions?.meta}),this.#r=xP({initialPromise:e?.initialPromise,fn:v.fetchFn,onCancel:b=>{b instanceof bw&&b.revert&&this.setState({...this.#t,fetchStatus:"idle"}),r.abort()},onFail:(b,a)=>{this.#s({type:"failed",failureCount:b,error:a})},onPause:()=>{this.#s({type:"pause"})},onContinue:()=>{this.#s({type:"continue"})},retry:v.options.retry,retryDelay:v.options.retryDelay,networkMode:v.options.networkMode,canRun:()=>!0});try{const b=await this.#r.start();if(b===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(b),this.#n.config.onSuccess?.(b,this),this.#n.config.onSettled?.(b,this.state.error,this),b}catch(b){if(b instanceof bw){if(b.silent)return this.#r.promise;if(b.revert){if(this.state.data===void 0)throw b;return this.state.data}}throw this.#s({type:"error",error:b}),this.#n.config.onError?.(b,this),this.#n.config.onSettled?.(this.state.data,b,this),b}finally{this.scheduleGc()}}#s(t){const e=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...wP(r.data,this.options),fetchMeta:t.meta??null};case"success":const l={...r,...NC(t.data,t.dataUpdatedAt),dataUpdateCount:r.dataUpdateCount+1,...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return this.#t=t.manual?l:void 0,l;case"error":const u=t.error;return{...r,error:u,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:u,fetchStatus:"idle",status:"error",isInvalidated:!0};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=e(this.state),gs.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),this.#n.notify({query:this,type:"updated",action:t})})}};function wP(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:_P(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function NC(t,e){return{data:t,dataUpdatedAt:e??Date.now(),error:null,isInvalidated:!1,status:"success"}}function DC(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,r=e!==void 0,l=r?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:r?l??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:r?"success":"pending",fetchStatus:"idle"}}var t6=class extends Xm{constructor(t,e){super(),this.options=e,this.#e=t,this.#s=null,this.#a=ww(),this.bindMethods(),this.setOptions(e)}#e;#t=void 0;#n=void 0;#i=void 0;#r;#o;#a;#s;#m;#h;#f;#c;#u;#l;#p=new Set;bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(this.#t.addObserver(this),LC(this.#t,this.options)?this.#d():this.updateResult(),this.#x())}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Tw(this.#t,this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Tw(this.#t,this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,this.#v(),this.#w(),this.#t.removeObserver(this)}setOptions(t){const e=this.options,r=this.#t;if(this.options=this.#e.defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof el(this.options.enabled,this.#t)!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");this.#b(),this.#t.setOptions(this.options),e._defaulted&&!Gx(this.options,e)&&this.#e.getQueryCache().notify({type:"observerOptionsUpdated",query:this.#t,observer:this});const l=this.hasListeners();l&&jC(this.#t,r,this.options,e)&&this.#d(),this.updateResult(),l&&(this.#t!==r||el(this.options.enabled,this.#t)!==el(e.enabled,this.#t)||lh(this.options.staleTime,this.#t)!==lh(e.staleTime,this.#t))&&this.#g();const u=this.#y();l&&(this.#t!==r||el(this.options.enabled,this.#t)!==el(e.enabled,this.#t)||u!==this.#l)&&this.#_(u)}getOptimisticResult(t){const e=this.#e.getQueryCache().build(this.#e,t),r=this.createResult(e,t);return r6(this,r)&&(this.#i=r,this.#o=this.options,this.#r=this.#t.state),r}getCurrentResult(){return this.#i}trackResult(t,e){return new Proxy(t,{get:(r,l)=>(this.trackProp(l),e?.(l),l==="promise"&&(this.trackProp("data"),!this.options.experimental_prefetchInRender&&this.#a.status==="pending"&&this.#a.reject(new Error("experimental_prefetchInRender feature flag is not enabled"))),Reflect.get(r,l))})}trackProp(t){this.#p.add(t)}getCurrentQuery(){return this.#t}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const e=this.#e.defaultQueryOptions(t),r=this.#e.getQueryCache().build(this.#e,e);return r.fetch().then(()=>this.createResult(r,e))}fetch(t){return this.#d({...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),this.#i))}#d(t){this.#b();let e=this.#t.fetch(this.options,t);return t?.throwOnError||(e=e.catch(Ro)),e}#g(){this.#v();const t=lh(this.options.staleTime,this.#t);if(qf||this.#i.isStale||!_w(t))return;const r=mP(this.#i.dataUpdatedAt,t)+1;this.#c=Of.setTimeout(()=>{this.#i.isStale||this.updateResult()},r)}#y(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(this.#t):this.options.refetchInterval)??!1}#_(t){this.#w(),this.#l=t,!(qf||el(this.options.enabled,this.#t)===!1||!_w(this.#l)||this.#l===0)&&(this.#u=Of.setInterval(()=>{(this.options.refetchIntervalInBackground||qb.isFocused())&&this.#d()},this.#l))}#x(){this.#g(),this.#_(this.#y())}#v(){this.#c&&(Of.clearTimeout(this.#c),this.#c=void 0)}#w(){this.#u&&(Of.clearInterval(this.#u),this.#u=void 0)}createResult(t,e){const r=this.#t,l=this.options,u=this.#i,m=this.#r,v=this.#o,a=t!==r?t.state:this.#n,{state:k}=t;let M={...k},L=!1,z;if(e._optimisticResults){const Ge=this.hasListeners(),tt=!Ge&&LC(t,e),Pe=Ge&&jC(t,r,e,l);(tt||Pe)&&(M={...M,...wP(k.data,t.options)}),e._optimisticResults==="isRestoring"&&(M.fetchStatus="idle")}let{error:O,errorUpdatedAt:K,status:H}=M;z=M.data;let Z=!1;if(e.placeholderData!==void 0&&z===void 0&&H==="pending"){let Ge;u?.isPlaceholderData&&e.placeholderData===v?.placeholderData?(Ge=u.data,Z=!0):Ge=typeof e.placeholderData=="function"?e.placeholderData(this.#f?.state.data,this.#f):e.placeholderData,Ge!==void 0&&(H="success",z=vw(u?.data,Ge,e),L=!0)}if(e.select&&z!==void 0&&!Z)if(u&&z===m?.data&&e.select===this.#m)z=this.#h;else try{this.#m=e.select,z=e.select(z),z=vw(u?.data,z,e),this.#h=z,this.#s=null}catch(Ge){this.#s=Ge}this.#s&&(O=this.#s,z=this.#h,K=Date.now(),H="error");const Y=M.fetchStatus==="fetching",ee=H==="pending",ie=H==="error",pe=ee&&Y,we=z!==void 0,ze={status:H,fetchStatus:M.fetchStatus,isPending:ee,isSuccess:H==="success",isError:ie,isInitialLoading:pe,isLoading:pe,data:z,dataUpdatedAt:M.dataUpdatedAt,error:O,errorUpdatedAt:K,failureCount:M.fetchFailureCount,failureReason:M.fetchFailureReason,errorUpdateCount:M.errorUpdateCount,isFetched:M.dataUpdateCount>0||M.errorUpdateCount>0,isFetchedAfterMount:M.dataUpdateCount>a.dataUpdateCount||M.errorUpdateCount>a.errorUpdateCount,isFetching:Y,isRefetching:Y&&!ee,isLoadingError:ie&&!we,isPaused:M.fetchStatus==="paused",isPlaceholderData:L,isRefetchError:ie&&we,isStale:Zb(t,e),refetch:this.refetch,promise:this.#a,isEnabled:el(e.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const Ge=ze.data!==void 0,tt=ze.status==="error"&&!Ge,Pe=gt=>{tt?gt.reject(ze.error):Ge&&gt.resolve(ze.data)},ot=()=>{const gt=this.#a=ze.promise=ww();Pe(gt)},ut=this.#a;switch(ut.status){case"pending":t.queryHash===r.queryHash&&Pe(ut);break;case"fulfilled":(tt||ze.data!==ut.value)&&ot();break;case"rejected":(!tt||ze.error!==ut.reason)&&ot();break}}return ze}updateResult(){const t=this.#i,e=this.createResult(this.#t,this.options);if(this.#r=this.#t.state,this.#o=this.options,this.#r.data!==void 0&&(this.#f=this.#t),Gx(e,t))return;this.#i=e;const r=()=>{if(!t)return!0;const{notifyOnChangeProps:l}=this.options,u=typeof l=="function"?l():l;if(u==="all"||!u&&!this.#p.size)return!0;const m=new Set(u??this.#p);return this.options.throwOnError&&m.add("error"),Object.keys(this.#i).some(v=>{const b=v;return this.#i[b]!==t[b]&&m.has(b)})};this.#T({listeners:r()})}#b(){const t=this.#e.getQueryCache().build(this.#e,this.options);if(t===this.#t)return;const e=this.#t;this.#t=t,this.#n=t.state,this.hasListeners()&&(e?.removeObserver(this),t.addObserver(this))}onQueryUpdate(){this.updateResult(),this.hasListeners()&&this.#x()}#T(t){gs.batch(()=>{t.listeners&&this.listeners.forEach(e=>{e(this.#i)}),this.#e.getQueryCache().notify({query:this.#t,type:"observerResultsUpdated"})})}};function n6(t,e){return el(e.enabled,t)!==!1&&t.state.data===void 0&&!(t.state.status==="error"&&e.retryOnMount===!1)}function LC(t,e){return n6(t,e)||t.state.data!==void 0&&Tw(t,e,e.refetchOnMount)}function Tw(t,e,r){if(el(e.enabled,t)!==!1&&lh(e.staleTime,t)!=="static"){const l=typeof r=="function"?r(t):r;return l==="always"||l!==!1&&Zb(t,e)}return!1}function jC(t,e,r,l){return(t!==e||el(l.enabled,t)===!1)&&(!r.suspense||t.state.status!=="error")&&Zb(t,r)}function Zb(t,e){return el(e.enabled,t)!==!1&&t.isStaleByTime(lh(e.staleTime,t))}function r6(t,e){return!Gx(t.getCurrentResult(),e)}function OC(t){return{onFetch:(e,r)=>{const l=e.options,u=e.fetchOptions?.meta?.fetchMore?.direction,m=e.state.data?.pages||[],v=e.state.data?.pageParams||[];let b={pages:[],pageParams:[]},a=0;const k=async()=>{let M=!1;const L=K=>{ZF(K,()=>e.signal,()=>M=!0)},z=yP(e.options,e.fetchOptions),O=async(K,H,Z)=>{if(M)return Promise.reject();if(H==null&&K.pages.length)return Promise.resolve(K);const ee=(()=>{const ke={client:e.client,queryKey:e.queryKey,pageParam:H,direction:Z?"backward":"forward",meta:e.options.meta};return L(ke),ke})(),ie=await z(ee),{maxPages:pe}=e.options,we=Z?qF:WF;return{pages:we(K.pages,ie,pe),pageParams:we(K.pageParams,H,pe)}};if(u&&m.length){const K=u==="backward",H=K?i6:zC,Z={pages:m,pageParams:v},Y=H(l,Z);b=await O(Z,Y,K)}else{const K=t??m.length;do{const H=a===0?v[0]??l.initialPageParam:zC(l,b);if(a>0&&H==null)break;b=await O(b,H),a++}while(a<K)}return b};e.options.persister?e.fetchFn=()=>e.options.persister?.(k,{client:e.client,queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=k}}}function zC(t,{pages:e,pageParams:r}){const l=e.length-1;return e.length>0?t.getNextPageParam(e[l],e,r[l],r):void 0}function i6(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}var s6=class extends vP{#e;#t;#n;#i;constructor(t){super(),this.#e=t.client,this.mutationId=t.mutationId,this.#n=t.mutationCache,this.#t=[],this.state=t.state||bP(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){this.#t.includes(t)||(this.#t.push(t),this.clearGcTimeout(),this.#n.notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){this.#t=this.#t.filter(e=>e!==t),this.scheduleGc(),this.#n.notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){this.#t.length||(this.state.status==="pending"?this.scheduleGc():this.#n.remove(this))}continue(){return this.#i?.continue()??this.execute(this.state.variables)}async execute(t){const e=()=>{this.#r({type:"continue"})},r={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};this.#i=xP({fn:()=>this.options.mutationFn?this.options.mutationFn(t,r):Promise.reject(new Error("No mutationFn found")),onFail:(m,v)=>{this.#r({type:"failed",failureCount:m,error:v})},onPause:()=>{this.#r({type:"pause"})},onContinue:e,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>this.#n.canRun(this)});const l=this.state.status==="pending",u=!this.#i.canStart();try{if(l)e();else{this.#r({type:"pending",variables:t,isPaused:u}),this.#n.config.onMutate&&await this.#n.config.onMutate(t,this,r);const v=await this.options.onMutate?.(t,r);v!==this.state.context&&this.#r({type:"pending",context:v,variables:t,isPaused:u})}const m=await this.#i.start();return await this.#n.config.onSuccess?.(m,t,this.state.context,this,r),await this.options.onSuccess?.(m,t,this.state.context,r),await this.#n.config.onSettled?.(m,null,this.state.variables,this.state.context,this,r),await this.options.onSettled?.(m,null,t,this.state.context,r),this.#r({type:"success",data:m}),m}catch(m){try{await this.#n.config.onError?.(m,t,this.state.context,this,r)}catch(v){Promise.reject(v)}try{await this.options.onError?.(m,t,this.state.context,r)}catch(v){Promise.reject(v)}try{await this.#n.config.onSettled?.(void 0,m,this.state.variables,this.state.context,this,r)}catch(v){Promise.reject(v)}try{await this.options.onSettled?.(void 0,m,t,this.state.context,r)}catch(v){Promise.reject(v)}throw this.#r({type:"error",error:m}),m}finally{this.#n.runNext(this)}}#r(t){const e=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=e(this.state),gs.batch(()=>{this.#t.forEach(r=>{r.onMutationUpdate(t)}),this.#n.notify({mutation:this,type:"updated",action:t})})}};function bP(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var o6=class extends Xm{constructor(t={}){super(),this.config=t,this.#e=new Set,this.#t=new Map,this.#n=0}#e;#t;#n;build(t,e,r){const l=new s6({client:t,mutationCache:this,mutationId:++this.#n,options:t.defaultMutationOptions(e),state:r});return this.add(l),l}add(t){this.#e.add(t);const e=ax(t);if(typeof e=="string"){const r=this.#t.get(e);r?r.push(t):this.#t.set(e,[t])}this.notify({type:"added",mutation:t})}remove(t){if(this.#e.delete(t)){const e=ax(t);if(typeof e=="string"){const r=this.#t.get(e);if(r)if(r.length>1){const l=r.indexOf(t);l!==-1&&r.splice(l,1)}else r[0]===t&&this.#t.delete(e)}}this.notify({type:"removed",mutation:t})}canRun(t){const e=ax(t);if(typeof e=="string"){const l=this.#t.get(e)?.find(u=>u.state.status==="pending");return!l||l===t}else return!0}runNext(t){const e=ax(t);return typeof e=="string"?this.#t.get(e)?.find(l=>l!==t&&l.state.isPaused)?.continue()??Promise.resolve():Promise.resolve()}clear(){gs.batch(()=>{this.#e.forEach(t=>{this.notify({type:"removed",mutation:t})}),this.#e.clear(),this.#t.clear()})}getAll(){return Array.from(this.#e)}find(t){const e={exact:!0,...t};return this.getAll().find(r=>MC(e,r))}findAll(t={}){return this.getAll().filter(e=>MC(t,e))}notify(t){gs.batch(()=>{this.listeners.forEach(e=>{e(t)})})}resumePausedMutations(){const t=this.getAll().filter(e=>e.state.isPaused);return gs.batch(()=>Promise.all(t.map(e=>e.continue().catch(Ro))))}};function ax(t){return t.options.scope?.id}var a6=class extends Xm{#e;#t=void 0;#n;#i;constructor(e,r){super(),this.#e=e,this.setOptions(r),this.bindMethods(),this.#r()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(e){const r=this.options;this.options=this.#e.defaultMutationOptions(e),Gx(this.options,r)||this.#e.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.#n,observer:this}),r?.mutationKey&&this.options.mutationKey&&Zf(r.mutationKey)!==Zf(this.options.mutationKey)?this.reset():this.#n?.state.status==="pending"&&this.#n.setOptions(this.options)}onUnsubscribe(){this.hasListeners()||this.#n?.removeObserver(this)}onMutationUpdate(e){this.#r(),this.#o(e)}getCurrentResult(){return this.#t}reset(){this.#n?.removeObserver(this),this.#n=void 0,this.#r(),this.#o()}mutate(e,r){return this.#i=r,this.#n?.removeObserver(this),this.#n=this.#e.getMutationCache().build(this.#e,this.options),this.#n.addObserver(this),this.#n.execute(e)}#r(){const e=this.#n?.state??bP();this.#t={...e,isPending:e.status==="pending",isSuccess:e.status==="success",isError:e.status==="error",isIdle:e.status==="idle",mutate:this.mutate,reset:this.reset}}#o(e){gs.batch(()=>{if(this.#i&&this.hasListeners()){const r=this.#t.variables,l=this.#t.context,u={client:this.#e,meta:this.options.meta,mutationKey:this.options.mutationKey};if(e?.type==="success"){try{this.#i.onSuccess?.(e.data,r,l,u)}catch(m){Promise.reject(m)}try{this.#i.onSettled?.(e.data,null,r,l,u)}catch(m){Promise.reject(m)}}else if(e?.type==="error"){try{this.#i.onError?.(e.error,r,l,u)}catch(m){Promise.reject(m)}try{this.#i.onSettled?.(void 0,e.error,r,l,u)}catch(m){Promise.reject(m)}}}this.listeners.forEach(r=>{r(this.#t)})})}},l6=class extends Xm{constructor(t={}){super(),this.config=t,this.#e=new Map}#e;build(t,e,r){const l=e.queryKey,u=e.queryHash??Gb(l,e);let m=this.get(u);return m||(m=new e6({client:t,queryKey:l,queryHash:u,options:t.defaultQueryOptions(e),state:r,defaultOptions:t.getQueryDefaults(l)}),this.add(m)),m}add(t){this.#e.has(t.queryHash)||(this.#e.set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const e=this.#e.get(t.queryHash);e&&(t.destroy(),e===t&&this.#e.delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){gs.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return this.#e.get(t)}getAll(){return[...this.#e.values()]}find(t){const e={exact:!0,...t};return this.getAll().find(r=>IC(e,r))}findAll(t={}){const e=this.getAll();return Object.keys(t).length>0?e.filter(r=>IC(t,r)):e}notify(t){gs.batch(()=>{this.listeners.forEach(e=>{e(t)})})}onFocus(){gs.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){gs.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},c6=class{#e;#t;#n;#i;#r;#o;#a;#s;constructor(t={}){this.#e=t.queryCache||new l6,this.#t=t.mutationCache||new o6,this.#n=t.defaultOptions||{},this.#i=new Map,this.#r=new Map,this.#o=0}mount(){this.#o++,this.#o===1&&(this.#a=qb.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onFocus())}),this.#s=Hx.subscribe(async t=>{t&&(await this.resumePausedMutations(),this.#e.onOnline())}))}unmount(){this.#o--,this.#o===0&&(this.#a?.(),this.#a=void 0,this.#s?.(),this.#s=void 0)}isFetching(t){return this.#e.findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return this.#t.findAll({...t,status:"pending"}).length}getQueryData(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state.data}ensureQueryData(t){const e=this.defaultQueryOptions(t),r=this.#e.build(this,e),l=r.state.data;return l===void 0?this.fetchQuery(t):(t.revalidateIfStale&&r.isStaleByTime(lh(e.staleTime,r))&&this.prefetchQuery(e),Promise.resolve(l))}getQueriesData(t){return this.#e.findAll(t).map(({queryKey:e,state:r})=>{const l=r.data;return[e,l]})}setQueryData(t,e,r){const l=this.defaultQueryOptions({queryKey:t}),m=this.#e.get(l.queryHash)?.state.data,v=$F(e,m);if(v!==void 0)return this.#e.build(this,l).setData(v,{...r,manual:!0})}setQueriesData(t,e,r){return gs.batch(()=>this.#e.findAll(t).map(({queryKey:l})=>[l,this.setQueryData(l,e,r)]))}getQueryState(t){const e=this.defaultQueryOptions({queryKey:t});return this.#e.get(e.queryHash)?.state}removeQueries(t){const e=this.#e;gs.batch(()=>{e.findAll(t).forEach(r=>{e.remove(r)})})}resetQueries(t,e){const r=this.#e;return gs.batch(()=>(r.findAll(t).forEach(l=>{l.reset()}),this.refetchQueries({type:"active",...t},e)))}cancelQueries(t,e={}){const r={revert:!0,...e},l=gs.batch(()=>this.#e.findAll(t).map(u=>u.cancel(r)));return Promise.all(l).then(Ro).catch(Ro)}invalidateQueries(t,e={}){return gs.batch(()=>(this.#e.findAll(t).forEach(r=>{r.invalidate()}),t?.refetchType==="none"?Promise.resolve():this.refetchQueries({...t,type:t?.refetchType??t?.type??"active"},e)))}refetchQueries(t,e={}){const r={...e,cancelRefetch:e.cancelRefetch??!0},l=gs.batch(()=>this.#e.findAll(t).filter(u=>!u.isDisabled()&&!u.isStatic()).map(u=>{let m=u.fetch(void 0,r);return r.throwOnError||(m=m.catch(Ro)),u.state.fetchStatus==="paused"?Promise.resolve():m}));return Promise.all(l).then(Ro)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const r=this.#e.build(this,e);return r.isStaleByTime(lh(e.staleTime,r))?r.fetch(e):Promise.resolve(r.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Ro).catch(Ro)}fetchInfiniteQuery(t){return t.behavior=OC(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Ro).catch(Ro)}ensureInfiniteQueryData(t){return t.behavior=OC(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return Hx.isOnline()?this.#t.resumePausedMutations():Promise.resolve()}getQueryCache(){return this.#e}getMutationCache(){return this.#t}getDefaultOptions(){return this.#n}setDefaultOptions(t){this.#n=t}setQueryDefaults(t,e){this.#i.set(Zf(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...this.#i.values()],r={};return e.forEach(l=>{Iy(t,l.queryKey)&&Object.assign(r,l.defaultOptions)}),r}setMutationDefaults(t,e){this.#r.set(Zf(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...this.#r.values()],r={};return e.forEach(l=>{Iy(t,l.mutationKey)&&Object.assign(r,l.defaultOptions)}),r}defaultQueryOptions(t){if(t._defaulted)return t;const e={...this.#n.queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=Gb(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.queryFn===Hb&&(e.enabled=!1),e}defaultMutationOptions(t){return t?._defaulted?t:{...this.#n.mutations,...t?.mutationKey&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){this.#e.clear(),this.#t.clear()}},TP=P.createContext(void 0),Dv=t=>{const e=P.useContext(TP);if(!e)throw new Error("No QueryClient set, use QueryClientProvider to set one");return e},u6=({client:t,children:e})=>(P.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),x.jsx(TP.Provider,{value:t,children:e})),SP=P.createContext(!1),d6=()=>P.useContext(SP);SP.Provider;function h6(){let t=!1;return{clearReset:()=>{t=!1},reset:()=>{t=!0},isReset:()=>t}}var f6=P.createContext(h6()),p6=()=>P.useContext(f6),m6=(t,e,r)=>{const l=r?.state.error&&typeof t.throwOnError=="function"?Wb(t.throwOnError,[r.state.error,r]):t.throwOnError;(t.suspense||t.experimental_prefetchInRender||l)&&(e.isReset()||(t.retryOnMount=!1))},g6=t=>{P.useEffect(()=>{t.clearReset()},[t])},y6=({result:t,errorResetBoundary:e,throwOnError:r,query:l,suspense:u})=>t.isError&&!e.isReset()&&!t.isFetching&&l&&(u&&t.data===void 0||Wb(r,[t.error,l])),_6=t=>{if(t.suspense){const r=u=>u==="static"?u:Math.max(u??1e3,1e3),l=t.staleTime;t.staleTime=typeof l=="function"?(...u)=>r(l(...u)):r(l),typeof t.gcTime=="number"&&(t.gcTime=Math.max(t.gcTime,1e3))}},x6=(t,e)=>t.isLoading&&t.isFetching&&!e,v6=(t,e)=>t?.suspense&&e.isPending,BC=(t,e,r)=>e.fetchOptimistic(t).catch(()=>{r.clearReset()});function w6(t,e,r){const l=d6(),u=p6(),m=Dv(),v=m.defaultQueryOptions(t);m.getDefaultOptions().queries?._experimental_beforeQuery?.(v);const b=m.getQueryCache().get(v.queryHash);v._optimisticResults=l?"isRestoring":"optimistic",_6(v),m6(v,u,b),g6(u);const a=!m.getQueryCache().get(v.queryHash),[k]=P.useState(()=>new e(m,v)),M=k.getOptimisticResult(v),L=!l&&t.subscribed!==!1;if(P.useSyncExternalStore(P.useCallback(z=>{const O=L?k.subscribe(gs.batchCalls(z)):Ro;return k.updateResult(),O},[k,L]),()=>k.getCurrentResult(),()=>k.getCurrentResult()),P.useEffect(()=>{k.setOptions(v)},[v,k]),v6(v,M))throw BC(v,k,u);if(y6({result:M,errorResetBoundary:u,throwOnError:v.throwOnError,query:b,suspense:v.suspense}))throw M.error;return m.getDefaultOptions().queries?._experimental_afterQuery?.(v,M),v.experimental_prefetchInRender&&!qf&&x6(M,l)&&(a?BC(v,k,u):b?.promise)?.catch(Ro).finally(()=>{k.updateResult()}),v.notifyOnChangeProps?M:k.trackResult(M)}function Xb(t,e){return w6(t,t6)}function Bl(t,e){const r=Dv(),[l]=P.useState(()=>new a6(r,t));P.useEffect(()=>{l.setOptions(t)},[l,t]);const u=P.useSyncExternalStore(P.useCallback(v=>l.subscribe(gs.batchCalls(v)),[l]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),m=P.useCallback((v,b)=>{l.mutate(v,b).catch(Ro)},[l]);if(u.error&&Wb(l.options.throwOnError,[u.error]))throw u.error;return{...u,mutate:m,mutateAsync:u.mutate}}function My(){return My=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},My.apply(this,arguments)}var rh;(function(t){t.Pop="POP",t.Push="PUSH",t.Replace="REPLACE"})(rh||(rh={}));const FC="popstate";function b6(t){t===void 0&&(t={});function e(l,u){let{pathname:m,search:v,hash:b}=l.location;return Sw("",{pathname:m,search:v,hash:b},u.state&&u.state.usr||null,u.state&&u.state.key||"default")}function r(l,u){return typeof u=="string"?u:EP(u)}return S6(e,r,null,t)}function ys(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Kb(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function T6(){return Math.random().toString(36).substr(2,8)}function VC(t,e){return{usr:t.state,key:t.key,idx:e}}function Sw(t,e,r,l){return r===void 0&&(r=null),My({pathname:typeof t=="string"?t:t.pathname,search:"",hash:""},typeof e=="string"?Km(e):e,{state:r,key:e&&e.key||l||T6()})}function EP(t){let{pathname:e="/",search:r="",hash:l=""}=t;return r&&r!=="?"&&(e+=r.charAt(0)==="?"?r:"?"+r),l&&l!=="#"&&(e+=l.charAt(0)==="#"?l:"#"+l),e}function Km(t){let e={};if(t){let r=t.indexOf("#");r>=0&&(e.hash=t.substr(r),t=t.substr(0,r));let l=t.indexOf("?");l>=0&&(e.search=t.substr(l),t=t.substr(0,l)),t&&(e.pathname=t)}return e}function S6(t,e,r,l){l===void 0&&(l={});let{window:u=document.defaultView,v5Compat:m=!1}=l,v=u.history,b=rh.Pop,a=null,k=M();k==null&&(k=0,v.replaceState(My({},v.state,{idx:k}),""));function M(){return(v.state||{idx:null}).idx}function L(){b=rh.Pop;let Z=M(),Y=Z==null?null:Z-k;k=Z,a&&a({action:b,location:H.location,delta:Y})}function z(Z,Y){b=rh.Push;let ee=Sw(H.location,Z,Y);k=M()+1;let ie=VC(ee,k),pe=H.createHref(ee);try{v.pushState(ie,"",pe)}catch(we){if(we instanceof DOMException&&we.name==="DataCloneError")throw we;u.location.assign(pe)}m&&a&&a({action:b,location:H.location,delta:1})}function O(Z,Y){b=rh.Replace;let ee=Sw(H.location,Z,Y);k=M();let ie=VC(ee,k),pe=H.createHref(ee);v.replaceState(ie,"",pe),m&&a&&a({action:b,location:H.location,delta:0})}function K(Z){let Y=u.location.origin!=="null"?u.location.origin:u.location.href,ee=typeof Z=="string"?Z:EP(Z);return ee=ee.replace(/ $/,"%20"),ys(Y,"No window.location.(origin|href) available to create URL for href: "+ee),new URL(ee,Y)}let H={get action(){return b},get location(){return t(u,v)},listen(Z){if(a)throw new Error("A history only accepts one active listener");return u.addEventListener(FC,L),a=Z,()=>{u.removeEventListener(FC,L),a=null}},createHref(Z){return e(u,Z)},createURL:K,encodeLocation(Z){let Y=K(Z);return{pathname:Y.pathname,search:Y.search,hash:Y.hash}},push:z,replace:O,go(Z){return v.go(Z)}};return H}var UC;(function(t){t.data="data",t.deferred="deferred",t.redirect="redirect",t.error="error"})(UC||(UC={}));function E6(t,e,r){return r===void 0&&(r="/"),C6(t,e,r)}function C6(t,e,r,l){let u=typeof e=="string"?Km(e):e,m=AP(u.pathname||"/",r);if(m==null)return null;let v=CP(t);k6(v);let b=null;for(let a=0;b==null&&a<v.length;++a){let k=B6(m);b=j6(v[a],k)}return b}function CP(t,e,r,l){e===void 0&&(e=[]),r===void 0&&(r=[]),l===void 0&&(l="");let u=(m,v,b)=>{let a={relativePath:b===void 0?m.path||"":b,caseSensitive:m.caseSensitive===!0,childrenIndex:v,route:m};a.relativePath.startsWith("/")&&(ys(a.relativePath.startsWith(l),'Absolute route path "'+a.relativePath+'" nested under path '+('"'+l+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),a.relativePath=a.relativePath.slice(l.length));let k=Uf([l,a.relativePath]),M=r.concat(a);m.children&&m.children.length>0&&(ys(m.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+k+'".')),CP(m.children,e,M,k)),!(m.path==null&&!m.index)&&e.push({path:k,score:D6(k,m.index),routesMeta:M})};return t.forEach((m,v)=>{var b;if(m.path===""||!((b=m.path)!=null&&b.includes("?")))u(m,v);else for(let a of kP(m.path))u(m,v,a)}),e}function kP(t){let e=t.split("/");if(e.length===0)return[];let[r,...l]=e,u=r.endsWith("?"),m=r.replace(/\?$/,"");if(l.length===0)return u?[m,""]:[m];let v=kP(l.join("/")),b=[];return b.push(...v.map(a=>a===""?m:[m,a].join("/"))),u&&b.push(...v),b.map(a=>t.startsWith("/")&&a===""?"/":a)}function k6(t){t.sort((e,r)=>e.score!==r.score?r.score-e.score:L6(e.routesMeta.map(l=>l.childrenIndex),r.routesMeta.map(l=>l.childrenIndex)))}const A6=/^:[\w-]+$/,I6=3,M6=2,P6=1,R6=10,N6=-2,$C=t=>t==="*";function D6(t,e){let r=t.split("/"),l=r.length;return r.some($C)&&(l+=N6),e&&(l+=M6),r.filter(u=>!$C(u)).reduce((u,m)=>u+(A6.test(m)?I6:m===""?P6:R6),l)}function L6(t,e){return t.length===e.length&&t.slice(0,-1).every((l,u)=>l===e[u])?t[t.length-1]-e[e.length-1]:0}function j6(t,e,r){let{routesMeta:l}=t,u={},m="/",v=[];for(let b=0;b<l.length;++b){let a=l[b],k=b===l.length-1,M=m==="/"?e:e.slice(m.length)||"/",L=O6({path:a.relativePath,caseSensitive:a.caseSensitive,end:k},M),z=a.route;if(!L)return null;Object.assign(u,L.params),v.push({params:u,pathname:Uf([m,L.pathname]),pathnameBase:W6(Uf([m,L.pathnameBase])),route:z}),L.pathnameBase!=="/"&&(m=Uf([m,L.pathnameBase]))}return v}function O6(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[r,l]=z6(t.path,t.caseSensitive,t.end),u=e.match(r);if(!u)return null;let m=u[0],v=m.replace(/(.)\/+$/,"$1"),b=u.slice(1);return{params:l.reduce((k,M,L)=>{let{paramName:z,isOptional:O}=M;if(z==="*"){let H=b[L]||"";v=m.slice(0,m.length-H.length).replace(/(.)\/+$/,"$1")}const K=b[L];return O&&!K?k[z]=void 0:k[z]=(K||"").replace(/%2F/g,"/"),k},{}),pathname:m,pathnameBase:v,pattern:t}}function z6(t,e,r){e===void 0&&(e=!1),r===void 0&&(r=!0),Kb(t==="*"||!t.endsWith("*")||t.endsWith("/*"),'Route path "'+t+'" will be treated as if it were '+('"'+t.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+t.replace(/\*$/,"/*")+'".'));let l=[],u="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(v,b,a)=>(l.push({paramName:b,isOptional:a!=null}),a?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(l.push({paramName:"*"}),u+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):r?u+="\\/*$":t!==""&&t!=="/"&&(u+="(?:(?=\\/|$))"),[new RegExp(u,e?void 0:"i"),l]}function B6(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Kb(!1,'The URL path "'+t+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),t}}function AP(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let r=e.endsWith("/")?e.length-1:e.length,l=t.charAt(r);return l&&l!=="/"?null:t.slice(r)||"/"}const F6=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,V6=t=>F6.test(t);function U6(t,e){e===void 0&&(e="/");let{pathname:r,search:l="",hash:u=""}=typeof t=="string"?Km(t):t,m;if(r)if(V6(r))m=r;else{if(r.includes("//")){let v=r;r=r.replace(/\/\/+/g,"/"),Kb(!1,"Pathnames cannot have embedded double slashes - normalizing "+(v+" -> "+r))}r.startsWith("/")?m=GC(r.substring(1),"/"):m=GC(r,e)}else m=e;return{pathname:m,search:q6(l),hash:Z6(u)}}function GC(t,e){let r=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(u=>{u===".."?r.length>1&&r.pop():u!=="."&&r.push(u)}),r.length>1?r.join("/"):"/"}function _1(t,e,r,l){return"Cannot include a '"+t+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(l)+"].  Please separate it out to the ")+("`to."+r+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function $6(t){return t.filter((e,r)=>r===0||e.route.path&&e.route.path.length>0)}function G6(t,e){let r=$6(t);return e?r.map((l,u)=>u===r.length-1?l.pathname:l.pathnameBase):r.map(l=>l.pathnameBase)}function H6(t,e,r,l){l===void 0&&(l=!1);let u;typeof t=="string"?u=Km(t):(u=My({},t),ys(!u.pathname||!u.pathname.includes("?"),_1("?","pathname","search",u)),ys(!u.pathname||!u.pathname.includes("#"),_1("#","pathname","hash",u)),ys(!u.search||!u.search.includes("#"),_1("#","search","hash",u)));let m=t===""||u.pathname==="",v=m?"/":u.pathname,b;if(v==null)b=r;else{let L=e.length-1;if(!l&&v.startsWith("..")){let z=v.split("/");for(;z[0]==="..";)z.shift(),L-=1;u.pathname=z.join("/")}b=L>=0?e[L]:"/"}let a=U6(u,b),k=v&&v!=="/"&&v.endsWith("/"),M=(m||v===".")&&r.endsWith("/");return!a.pathname.endsWith("/")&&(k||M)&&(a.pathname+="/"),a}const Uf=t=>t.join("/").replace(/\/\/+/g,"/"),W6=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),q6=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,Z6=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function X6(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}const IP=["post","put","patch","delete"];new Set(IP);const K6=["get",...IP];new Set(K6);function Py(){return Py=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var r=arguments[e];for(var l in r)Object.prototype.hasOwnProperty.call(r,l)&&(t[l]=r[l])}return t},Py.apply(this,arguments)}const Yb=P.createContext(null),Y6=P.createContext(null),Lv=P.createContext(null),jv=P.createContext(null),rp=P.createContext({outlet:null,matches:[],isDataRoute:!1}),MP=P.createContext(null);function Ov(){return P.useContext(jv)!=null}function zv(){return Ov()||ys(!1),P.useContext(jv).location}function PP(t){P.useContext(Lv).static||P.useLayoutEffect(t)}function ip(){let{isDataRoute:t}=P.useContext(rp);return t?dV():J6()}function J6(){Ov()||ys(!1);let t=P.useContext(Yb),{basename:e,future:r,navigator:l}=P.useContext(Lv),{matches:u}=P.useContext(rp),{pathname:m}=zv(),v=JSON.stringify(G6(u,r.v7_relativeSplatPath)),b=P.useRef(!1);return PP(()=>{b.current=!0}),P.useCallback(function(k,M){if(M===void 0&&(M={}),!b.current)return;if(typeof k=="number"){l.go(k);return}let L=H6(k,JSON.parse(v),m,M.relative==="path");t==null&&e!=="/"&&(L.pathname=L.pathname==="/"?e:Uf([e,L.pathname])),(M.replace?l.replace:l.push)(L,M.state,M)},[e,l,v,m,t])}function Q6(){let{matches:t}=P.useContext(rp),e=t[t.length-1];return e?e.params:{}}function eV(t,e){return tV(t,e)}function tV(t,e,r,l){Ov()||ys(!1);let{navigator:u}=P.useContext(Lv),{matches:m}=P.useContext(rp),v=m[m.length-1],b=v?v.params:{};v&&v.pathname;let a=v?v.pathnameBase:"/";v&&v.route;let k=zv(),M;if(e){var L;let Z=typeof e=="string"?Km(e):e;a==="/"||(L=Z.pathname)!=null&&L.startsWith(a)||ys(!1),M=Z}else M=k;let z=M.pathname||"/",O=z;if(a!=="/"){let Z=a.replace(/^\//,"").split("/");O="/"+z.replace(/^\//,"").split("/").slice(Z.length).join("/")}let K=E6(t,{pathname:O}),H=oV(K&&K.map(Z=>Object.assign({},Z,{params:Object.assign({},b,Z.params),pathname:Uf([a,u.encodeLocation?u.encodeLocation(Z.pathname).pathname:Z.pathname]),pathnameBase:Z.pathnameBase==="/"?a:Uf([a,u.encodeLocation?u.encodeLocation(Z.pathnameBase).pathname:Z.pathnameBase])})),m,r,l);return e&&H?P.createElement(jv.Provider,{value:{location:Py({pathname:"/",search:"",hash:"",state:null,key:"default"},M),navigationType:rh.Pop}},H):H}function nV(){let t=uV(),e=X6(t)?t.status+" "+t.statusText:t instanceof Error?t.message:JSON.stringify(t),r=t instanceof Error?t.stack:null,u={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return P.createElement(P.Fragment,null,P.createElement("h2",null,"Unexpected Application Error!"),P.createElement("h3",{style:{fontStyle:"italic"}},e),r?P.createElement("pre",{style:u},r):null,null)}const rV=P.createElement(nV,null);class iV extends P.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,r){return r.location!==e.location||r.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:r.error,location:r.location,revalidation:e.revalidation||r.revalidation}}componentDidCatch(e,r){console.error("React Router caught the following error during render",e,r)}render(){return this.state.error!==void 0?P.createElement(rp.Provider,{value:this.props.routeContext},P.createElement(MP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function sV(t){let{routeContext:e,match:r,children:l}=t,u=P.useContext(Yb);return u&&u.static&&u.staticContext&&(r.route.errorElement||r.route.ErrorBoundary)&&(u.staticContext._deepestRenderedBoundaryId=r.route.id),P.createElement(rp.Provider,{value:e},l)}function oV(t,e,r,l){var u;if(e===void 0&&(e=[]),r===void 0&&(r=null),l===void 0&&(l=null),t==null){var m;if(!r)return null;if(r.errors)t=r.matches;else if((m=l)!=null&&m.v7_partialHydration&&e.length===0&&!r.initialized&&r.matches.length>0)t=r.matches;else return null}let v=t,b=(u=r)==null?void 0:u.errors;if(b!=null){let M=v.findIndex(L=>L.route.id&&b?.[L.route.id]!==void 0);M>=0||ys(!1),v=v.slice(0,Math.min(v.length,M+1))}let a=!1,k=-1;if(r&&l&&l.v7_partialHydration)for(let M=0;M<v.length;M++){let L=v[M];if((L.route.HydrateFallback||L.route.hydrateFallbackElement)&&(k=M),L.route.id){let{loaderData:z,errors:O}=r,K=L.route.loader&&z[L.route.id]===void 0&&(!O||O[L.route.id]===void 0);if(L.route.lazy||K){a=!0,k>=0?v=v.slice(0,k+1):v=[v[0]];break}}}return v.reduceRight((M,L,z)=>{let O,K=!1,H=null,Z=null;r&&(O=b&&L.route.id?b[L.route.id]:void 0,H=L.route.errorElement||rV,a&&(k<0&&z===0?(hV("route-fallback"),K=!0,Z=null):k===z&&(K=!0,Z=L.route.hydrateFallbackElement||null)));let Y=e.concat(v.slice(0,z+1)),ee=()=>{let ie;return O?ie=H:K?ie=Z:L.route.Component?ie=P.createElement(L.route.Component,null):L.route.element?ie=L.route.element:ie=M,P.createElement(sV,{match:L,routeContext:{outlet:M,matches:Y,isDataRoute:r!=null},children:ie})};return r&&(L.route.ErrorBoundary||L.route.errorElement||z===0)?P.createElement(iV,{location:r.location,revalidation:r.revalidation,component:H,error:O,children:ee(),routeContext:{outlet:null,matches:Y,isDataRoute:!0}}):ee()},null)}var RP=(function(t){return t.UseBlocker="useBlocker",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t})(RP||{}),NP=(function(t){return t.UseBlocker="useBlocker",t.UseLoaderData="useLoaderData",t.UseActionData="useActionData",t.UseRouteError="useRouteError",t.UseNavigation="useNavigation",t.UseRouteLoaderData="useRouteLoaderData",t.UseMatches="useMatches",t.UseRevalidator="useRevalidator",t.UseNavigateStable="useNavigate",t.UseRouteId="useRouteId",t})(NP||{});function aV(t){let e=P.useContext(Yb);return e||ys(!1),e}function lV(t){let e=P.useContext(Y6);return e||ys(!1),e}function cV(t){let e=P.useContext(rp);return e||ys(!1),e}function DP(t){let e=cV(),r=e.matches[e.matches.length-1];return r.route.id||ys(!1),r.route.id}function uV(){var t;let e=P.useContext(MP),r=lV(),l=DP();return e!==void 0?e:(t=r.errors)==null?void 0:t[l]}function dV(){let{router:t}=aV(RP.UseNavigateStable),e=DP(NP.UseNavigateStable),r=P.useRef(!1);return PP(()=>{r.current=!0}),P.useCallback(function(u,m){m===void 0&&(m={}),r.current&&(typeof u=="number"?t.navigate(u):t.navigate(u,Py({fromRouteId:e},m)))},[t,e])}const HC={};function hV(t,e,r){HC[t]||(HC[t]=!0)}function fV(t,e){t?.v7_startTransition,t?.v7_relativeSplatPath}function Df(t){ys(!1)}function pV(t){let{basename:e="/",children:r=null,location:l,navigationType:u=rh.Pop,navigator:m,static:v=!1,future:b}=t;Ov()&&ys(!1);let a=e.replace(/^\/*/,"/"),k=P.useMemo(()=>({basename:a,navigator:m,static:v,future:Py({v7_relativeSplatPath:!1},b)}),[a,b,m,v]);typeof l=="string"&&(l=Km(l));let{pathname:M="/",search:L="",hash:z="",state:O=null,key:K="default"}=l,H=P.useMemo(()=>{let Z=AP(M,a);return Z==null?null:{location:{pathname:Z,search:L,hash:z,state:O,key:K},navigationType:u}},[a,M,L,z,O,K,u]);return H==null?null:P.createElement(Lv.Provider,{value:k},P.createElement(jv.Provider,{children:r,value:H}))}function mV(t){let{children:e,location:r}=t;return eV(Ew(e),r)}new Promise(()=>{});function Ew(t,e){e===void 0&&(e=[]);let r=[];return P.Children.forEach(t,(l,u)=>{if(!P.isValidElement(l))return;let m=[...e,u];if(l.type===P.Fragment){r.push.apply(r,Ew(l.props.children,m));return}l.type!==Df&&ys(!1),!l.props.index||!l.props.children||ys(!1);let v={id:l.props.id||m.join("-"),caseSensitive:l.props.caseSensitive,element:l.props.element,Component:l.props.Component,index:l.props.index,path:l.props.path,loader:l.props.loader,action:l.props.action,errorElement:l.props.errorElement,ErrorBoundary:l.props.ErrorBoundary,hasErrorBoundary:l.props.ErrorBoundary!=null||l.props.errorElement!=null,shouldRevalidate:l.props.shouldRevalidate,handle:l.props.handle,lazy:l.props.lazy};l.props.children&&(v.children=Ew(l.props.children,m)),r.push(v)}),r}const gV="6";try{window.__reactRouterVersion=gV}catch{}const yV="startTransition",WC=vv[yV];function _V(t){let{basename:e,children:r,future:l,window:u}=t,m=P.useRef();m.current==null&&(m.current=b6({window:u,v5Compat:!0}));let v=m.current,[b,a]=P.useState({action:v.action,location:v.location}),{v7_startTransition:k}=l||{},M=P.useCallback(L=>{k&&WC?WC(()=>a(L)):a(L)},[a,k]);return P.useLayoutEffect(()=>v.listen(M),[v,M]),P.useEffect(()=>fV(l),[l]),P.createElement(pV,{basename:e,children:r,location:b.location,navigationType:b.action,navigator:v,future:l})}var qC;(function(t){t.UseScrollRestoration="useScrollRestoration",t.UseSubmit="useSubmit",t.UseSubmitFetcher="useSubmitFetcher",t.UseFetcher="useFetcher",t.useViewTransitionState="useViewTransitionState"})(qC||(qC={}));var ZC;(function(t){t.UseFetcher="useFetcher",t.UseFetchers="useFetchers",t.UseScrollRestoration="useScrollRestoration"})(ZC||(ZC={}));const XC={vi:{appName:"UniPocket",appTagline:"Campus & Lifestyle Map",searchPlaceholder:"Tm phng ban, ta nh, hoc qun ngon...",categoryBuilding:"Ta nh",categoryFood:"n ung",categoryHousing:"Nh tr",categoryJob:"Vic lm",reviews:"nh gi",departments:"Phng ban",floor:"Tng",room:"Phng",roomShort:"P.",seeMore:"Xem thm",directions:"Ch ng",sponsored:"c ti tr",viewNow:"Xem ngay",reviewCount:"{count} nh gi",navigatingTo:"ang ch ng n",calculatingRoute:"ang tnh ton tuyn ng...",hideInstructions:"n hng dn",viewSteps:"Xem {count} bc hng dn",continueStright:"Tip tc i thng",youAreHere:" Bn ang  y",next:"Tip theo:",continue:"Tip tc",accuracy:" chnh xc",remaining:"Cn",multiStopRoute:"L trnh nhiu im",stops:"im dng",addStop:"Thm im dng",selectPointOnMap:"Chn im trn bn ...",total:"Tng cng",startMultiStop:"i nhiu im",walking:"i b",cycling:"Xe my",driving:" t",shortest:"Ngn nht",fastest:"Nhanh nht",minutes:"pht",hours:"gi",meters:"m",kilometers:"km",turnLeft:"R tri",turnRight:"R phi",turnSlightLeft:"R nh sang tri",turnSlightRight:"R nh sang phi",turnSharpLeft:"R gp sang tri",turnSharpRight:"R gp sang phi",continueOn:"Tip tc i",arrive:"n ni",arriveDestination:"Bn  n im ch",depart:"Bt u",straight:"i thng",uturn:"Quay u",roundabout:"i vng xuyn",merge:"Nhp ln",fork:"R ng ba",endOfRoad:"Cui ng",newName:"Tip tc theo",onThe:" pha",left:"tri",right:"phi",locationError:"Khng th ly v tr ca bn. Vui lng cho php truy cp v tr.",browserNoLocation:"Trnh duyt khng h tr nh v",offRouteWarning:"Bn  i lch tuyn ng. ang tnh ton li...",tokenNotConfigured:"Mapbox Token cha c cu hnh",mapboxTokenRequired:"Cn Mapbox Token  xem bn ",mapboxTokenInstructions:"Dn Access Token ca bn (public token)  chy demo ngay.",tokenPlaceholder:"pk.eyJ1Ijoi...",saveTokenAndLoad:"Lu token & ti bn ",tokenSavedInBrowser:"Token s c lu trong trnh duyt (localStorage).",tokenEmptyError:"Vui lng dn Mapbox Access Token",tokenTooShortError:"Token c v cha ng (qu ngn)",language:"Ngn ng",vietnamese:"Ting Vit",english:"English",voucherDiscount20Student:"Gim 20% cho sinh vin",voucherBuy2Get1:"Mua 2 tng 1",voucherDiscount500kFirstMonth:"Gim 500k thng u",voucherFreeDrink:"Tng nc ung",voucherBogo:"Mua 1 tng 1 (T2-T4)",lectureHall:"Ging ng",dormitory:"K tc x",student:"Sinh vin",parking:"Nh xe",gate:"Cng",entrance:"Li vo",security:"Bo v",safetyGuard:"An ninh",sports:"Th thao",health:"Sc khe",medical:"Y t",administration:"Hnh chnh",innovation:"i mi",startup:"Khi nghip",bank:"Ngn hng",atm:"ATM",lake:"H",relaxation:"Th gin",landscape:"Cnh quan",sportsField:"Sn bng",carParking:" xe  t",checkin:"Check-in",lecture_hall:"Ging ng",office:"Vn phng",cafe:"Caf",entertainment:"Vui chi",food:"Qun n",building:"Ta nh",job:"Vic lm",housing:"Nh tr",coffee:"C ph",studySpace:"Khng gian hc tp",wifi:"Wifi",pastry:"Bnh ngt",group:"Nhm",milkTea:"Tr sa",cheap:"Gi r",nearSchool:"Gn trng",aesthetic:"Sng o",safe:"An ninh",partTime:"Part-time",sales:"Bn hng",evening:"Ti",selectCategory:"Chn danh mc",category:"Danh mc",save:"Lu thng tin",cancel:"Hy",premium:"VIP"},en:{lecture_hall:"Lecture Hall",checkin:"Check-in",office:"Office",cafe:"Cafe",entertainment:"Entertainment",food:"Food",building:"Building",job:"Job",appName:"UniPocket",appTagline:"Campus & Lifestyle Map",searchPlaceholder:"Search departments, buildings, or restaurants...",categoryBuilding:"Buildings",categoryFood:"Food & Drink",categoryHousing:"Housing",categoryJob:"Jobs",category:"Category",reviews:"Reviews",departments:"Departments",floor:"Floor",room:"Room",roomShort:"R.",seeMore:"See more",directions:"Directions",sponsored:"Sponsored",viewNow:"View now",reviewCount:"{count} reviews",navigatingTo:"Navigating to",calculatingRoute:"Calculating route...",hideInstructions:"Hide instructions",viewSteps:"View {count} steps",continueStright:"Continue straight",youAreHere:" You are here",next:"Next:",continue:"Continue",accuracy:"Accuracy",remaining:"Remaining",multiStopRoute:"Multi-stop Route",stops:"stops",addStop:"Add stop",selectPointOnMap:"Select point on map...",total:"Total",startMultiStop:"Multi-stop",walking:"Walk",cycling:"Bike",driving:"Drive",shortest:"Shortest",fastest:"Fastest",minutes:"min",hours:"hr",meters:"m",kilometers:"km",turnLeft:"Turn left",turnRight:"Turn right",turnSlightLeft:"Turn slight left",turnSlightRight:"Turn slight right",turnSharpLeft:"Turn sharp left",turnSharpRight:"Turn sharp right",continueOn:"Continue on",arrive:"Arrive",arriveDestination:"You have arrived at your destination",depart:"Depart",straight:"Go straight",uturn:"Make a U-turn",roundabout:"Enter roundabout",merge:"Merge",fork:"Take fork",endOfRoad:"End of road",newName:"Continue onto",onThe:"on the",left:"left",right:"right",locationError:"Unable to get your location. Please allow location access.",browserNoLocation:"Browser does not support geolocation",offRouteWarning:"You are off route. Recalculating...",tokenNotConfigured:"Mapbox Token not configured",mapboxTokenRequired:"Mapbox Token required to view the map",mapboxTokenInstructions:"Paste your Access Token (public token) to run the demo.",tokenPlaceholder:"pk.eyJ1Ijoi...",saveTokenAndLoad:"Save token & load map",tokenSavedInBrowser:"Token will be saved in browser (localStorage).",tokenEmptyError:"Please paste your Mapbox Access Token",tokenTooShortError:"Token seems invalid (too short)",language:"Language",vietnamese:"Ting Vit",english:"English",voucherDiscount20Student:"20% off for students",voucherBuy2Get1:"Buy 2 get 1 free",voucherDiscount500kFirstMonth:"500k off first month",voucherFreeDrink:"Free drink included",voucherBogo:"Buy 1 get 1 free (Mon-Wed)",lectureHall:"Lecture Hall",dormitory:"Dormitory",student:"Student",parking:"Parking",gate:"Gate",entrance:"Entrance",security:"Security",safetyGuard:"Safety Guard",sports:"Sports",health:"Health",medical:"Medical",administration:"Administration",innovation:"Innovation",startup:"Startup",bank:"Bank",atm:"ATM",lake:"Lake",relaxation:"Relaxation",landscape:"Landscape",sportsField:"Sports Field",carParking:"Car Parking",coffee:"Coffee",studySpace:"Study Space",wifi:"WiFi",pastry:"Pastry",group:"Group",milkTea:"Milk Tea",cheap:"Budget-friendly",nearSchool:"Near Campus",aesthetic:"Aesthetic",housing:"Housing",safe:"Safe",partTime:"Part-time",sales:"Sales",evening:"Evening"}},LP=P.createContext(void 0),KC="unipocket-language",xV=({children:t})=>{const[e,r]=P.useState(()=>{if(typeof window<"u"){const m=localStorage.getItem(KC);if(m==="vi"||m==="en")return m}return"vi"}),l=P.useCallback(m=>{r(m),localStorage.setItem(KC,m)},[]),u=P.useCallback((m,v)=>{let b=XC[e][m]||XC.vi[m]||m;return v&&Object.entries(v).forEach(([a,k])=>{b=b.replace(`{${a}}`,String(k))}),b},[e]);return x.jsx(LP.Provider,{value:{language:e,setLanguage:l,t:u},children:t})},ra=()=>{const t=P.useContext(LP);if(t===void 0)throw new Error("useLanguage must be used within a LanguageProvider");return t},vV=()=>{};var YC={};const jP=function(t){const e=[];let r=0;for(let l=0;l<t.length;l++){let u=t.charCodeAt(l);u<128?e[r++]=u:u<2048?(e[r++]=u>>6|192,e[r++]=u&63|128):(u&64512)===55296&&l+1<t.length&&(t.charCodeAt(l+1)&64512)===56320?(u=65536+((u&1023)<<10)+(t.charCodeAt(++l)&1023),e[r++]=u>>18|240,e[r++]=u>>12&63|128,e[r++]=u>>6&63|128,e[r++]=u&63|128):(e[r++]=u>>12|224,e[r++]=u>>6&63|128,e[r++]=u&63|128)}return e},wV=function(t){const e=[];let r=0,l=0;for(;r<t.length;){const u=t[r++];if(u<128)e[l++]=String.fromCharCode(u);else if(u>191&&u<224){const m=t[r++];e[l++]=String.fromCharCode((u&31)<<6|m&63)}else if(u>239&&u<365){const m=t[r++],v=t[r++],b=t[r++],a=((u&7)<<18|(m&63)<<12|(v&63)<<6|b&63)-65536;e[l++]=String.fromCharCode(55296+(a>>10)),e[l++]=String.fromCharCode(56320+(a&1023))}else{const m=t[r++],v=t[r++];e[l++]=String.fromCharCode((u&15)<<12|(m&63)<<6|v&63)}}return e.join("")},OP={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const r=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,l=[];for(let u=0;u<t.length;u+=3){const m=t[u],v=u+1<t.length,b=v?t[u+1]:0,a=u+2<t.length,k=a?t[u+2]:0,M=m>>2,L=(m&3)<<4|b>>4;let z=(b&15)<<2|k>>6,O=k&63;a||(O=64,v||(z=64)),l.push(r[M],r[L],r[z],r[O])}return l.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(jP(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):wV(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const r=e?this.charToByteMapWebSafe_:this.charToByteMap_,l=[];for(let u=0;u<t.length;){const m=r[t.charAt(u++)],b=u<t.length?r[t.charAt(u)]:0;++u;const k=u<t.length?r[t.charAt(u)]:64;++u;const L=u<t.length?r[t.charAt(u)]:64;if(++u,m==null||b==null||k==null||L==null)throw new bV;const z=m<<2|b>>4;if(l.push(z),k!==64){const O=b<<4&240|k>>2;if(l.push(O),L!==64){const K=k<<6&192|L;l.push(K)}}}return l},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class bV extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const TV=function(t){const e=jP(t);return OP.encodeByteArray(e,!0)},zP=function(t){return TV(t).replace(/\./g,"")},BP=function(t){try{return OP.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};function SV(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}const EV=()=>SV().__FIREBASE_DEFAULTS__,CV=()=>{if(typeof process>"u"||typeof YC>"u")return;const t=YC.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},kV=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&BP(t[1]);return e&&JSON.parse(e)},Jb=()=>{try{return vV()||EV()||CV()||kV()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},AV=t=>Jb()?.emulatorHosts?.[t],FP=()=>Jb()?.config,VP=t=>Jb()?.[`_${t}`];class IV{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,r)=>{this.resolve=e,this.reject=r})}wrapCallback(e){return(r,l)=>{r?this.reject(r):this.resolve(l),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(r):e(r,l))}}}function Bv(t){try{return(t.startsWith("http://")||t.startsWith("https://")?new URL(t).hostname:t).endsWith(".cloudworkstations.dev")}catch{return!1}}async function MV(t){return(await fetch(t,{credentials:"include"})).ok}const gy={};function PV(){const t={prod:[],emulator:[]};for(const e of Object.keys(gy))gy[e]?t.emulator.push(e):t.prod.push(e);return t}function RV(t){let e=document.getElementById(t),r=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),r=!0),{created:r,element:e}}let JC=!1;function NV(t,e){if(typeof window>"u"||typeof document>"u"||!Bv(window.location.host)||gy[t]===e||gy[t]||JC)return;gy[t]=e;function r(z){return`__firebase__banner__${z}`}const l="__firebase__banner",m=PV().prod.length>0;function v(){const z=document.getElementById(l);z&&z.remove()}function b(z){z.style.display="flex",z.style.background="#7faaf0",z.style.position="fixed",z.style.bottom="5px",z.style.left="5px",z.style.padding=".5em",z.style.borderRadius="5px",z.style.alignItems="center"}function a(z,O){z.setAttribute("width","24"),z.setAttribute("id",O),z.setAttribute("height","24"),z.setAttribute("viewBox","0 0 24 24"),z.setAttribute("fill","none"),z.style.marginLeft="-6px"}function k(){const z=document.createElement("span");return z.style.cursor="pointer",z.style.marginLeft="16px",z.style.fontSize="24px",z.innerHTML=" &times;",z.onclick=()=>{JC=!0,v()},z}function M(z,O){z.setAttribute("id",O),z.innerText="Learn more",z.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",z.setAttribute("target","__blank"),z.style.paddingLeft="5px",z.style.textDecoration="underline"}function L(){const z=RV(l),O=r("text"),K=document.getElementById(O)||document.createElement("span"),H=r("learnmore"),Z=document.getElementById(H)||document.createElement("a"),Y=r("preprendIcon"),ee=document.getElementById(Y)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(z.created){const ie=z.element;b(ie),M(Z,H);const pe=k();a(ee,Y),ie.append(ee,K,Z,pe),document.body.appendChild(ie)}m?(K.innerText="Preview backend disconnected.",ee.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(ee.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,K.innerText="Preview backend running in this workspace."),K.setAttribute("id",O)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",L):L()}function Lo(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function DV(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Lo())}function LV(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function jV(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function OV(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function zV(){const t=Lo();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function BV(){try{return typeof indexedDB=="object"}catch{return!1}}function FV(){return new Promise((t,e)=>{try{let r=!0;const l="validate-browser-context-for-indexeddb-analytics-module",u=self.indexedDB.open(l);u.onsuccess=()=>{u.result.close(),r||self.indexedDB.deleteDatabase(l),t(!0)},u.onupgradeneeded=()=>{r=!1},u.onerror=()=>{e(u.error?.message||"")}}catch(r){e(r)}})}const VV="FirebaseError";class vh extends Error{constructor(e,r,l){super(r),this.code=e,this.customData=l,this.name=VV,Object.setPrototypeOf(this,vh.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,Qy.prototype.create)}}class Qy{constructor(e,r,l){this.service=e,this.serviceName=r,this.errors=l}create(e,...r){const l=r[0]||{},u=`${this.service}/${e}`,m=this.errors[e],v=m?UV(m,l):"Error",b=`${this.serviceName}: ${v} (${u}).`;return new vh(u,b,l)}}function UV(t,e){return t.replace($V,(r,l)=>{const u=e[l];return u!=null?String(u):`<${l}?>`})}const $V=/\{\$([^}]+)}/g;function GV(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function jm(t,e){if(t===e)return!0;const r=Object.keys(t),l=Object.keys(e);for(const u of r){if(!l.includes(u))return!1;const m=t[u],v=e[u];if(QC(m)&&QC(v)){if(!jm(m,v))return!1}else if(m!==v)return!1}for(const u of l)if(!r.includes(u))return!1;return!0}function QC(t){return t!==null&&typeof t=="object"}function e_(t){const e=[];for(const[r,l]of Object.entries(t))Array.isArray(l)?l.forEach(u=>{e.push(encodeURIComponent(r)+"="+encodeURIComponent(u))}):e.push(encodeURIComponent(r)+"="+encodeURIComponent(l));return e.length?"&"+e.join("&"):""}function ry(t){const e={};return t.replace(/^\?/,"").split("&").forEach(l=>{if(l){const[u,m]=l.split("=");e[decodeURIComponent(u)]=decodeURIComponent(m)}}),e}function iy(t){const e=t.indexOf("?");if(!e)return"";const r=t.indexOf("#",e);return t.substring(e,r>0?r:void 0)}function HV(t,e){const r=new WV(t,e);return r.subscribe.bind(r)}class WV{constructor(e,r){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=r,this.task.then(()=>{e(this)}).catch(l=>{this.error(l)})}next(e){this.forEachObserver(r=>{r.next(e)})}error(e){this.forEachObserver(r=>{r.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,r,l){let u;if(e===void 0&&r===void 0&&l===void 0)throw new Error("Missing Observer.");qV(e,["next","error","complete"])?u=e:u={next:e,error:r,complete:l},u.next===void 0&&(u.next=x1),u.error===void 0&&(u.error=x1),u.complete===void 0&&(u.complete=x1);const m=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?u.error(this.finalError):u.complete()}catch{}}),this.observers.push(u),m}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let r=0;r<this.observers.length;r++)this.sendOne(r,e)}sendOne(e,r){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{r(this.observers[e])}catch(l){typeof console<"u"&&console.error&&console.error(l)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function qV(t,e){if(typeof t!="object"||t===null)return!1;for(const r of e)if(r in t&&typeof t[r]=="function")return!0;return!1}function x1(){}function td(t){return t&&t._delegate?t._delegate:t}class Om{constructor(e,r,l){this.name=e,this.instanceFactory=r,this.type=l,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Lf="[DEFAULT]";class ZV{constructor(e,r){this.name=e,this.container=r,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const r=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(r)){const l=new IV;if(this.instancesDeferred.set(r,l),this.isInitialized(r)||this.shouldAutoInitialize())try{const u=this.getOrInitializeService({instanceIdentifier:r});u&&l.resolve(u)}catch{}}return this.instancesDeferred.get(r).promise}getImmediate(e){const r=this.normalizeInstanceIdentifier(e?.identifier),l=e?.optional??!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(u){if(l)return null;throw u}else{if(l)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(KV(e))try{this.getOrInitializeService({instanceIdentifier:Lf})}catch{}for(const[r,l]of this.instancesDeferred.entries()){const u=this.normalizeInstanceIdentifier(r);try{const m=this.getOrInitializeService({instanceIdentifier:u});l.resolve(m)}catch{}}}}clearInstance(e=Lf){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(r=>"INTERNAL"in r).map(r=>r.INTERNAL.delete()),...e.filter(r=>"_delete"in r).map(r=>r._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Lf){return this.instances.has(e)}getOptions(e=Lf){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:r={}}=e,l=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(l))throw Error(`${this.name}(${l}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const u=this.getOrInitializeService({instanceIdentifier:l,options:r});for(const[m,v]of this.instancesDeferred.entries()){const b=this.normalizeInstanceIdentifier(m);l===b&&v.resolve(u)}return u}onInit(e,r){const l=this.normalizeInstanceIdentifier(r),u=this.onInitCallbacks.get(l)??new Set;u.add(e),this.onInitCallbacks.set(l,u);const m=this.instances.get(l);return m&&e(m,l),()=>{u.delete(e)}}invokeOnInitCallbacks(e,r){const l=this.onInitCallbacks.get(r);if(l)for(const u of l)try{u(e,r)}catch{}}getOrInitializeService({instanceIdentifier:e,options:r={}}){let l=this.instances.get(e);if(!l&&this.component&&(l=this.component.instanceFactory(this.container,{instanceIdentifier:XV(e),options:r}),this.instances.set(e,l),this.instancesOptions.set(e,r),this.invokeOnInitCallbacks(l,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,l)}catch{}return l||null}normalizeInstanceIdentifier(e=Lf){return this.component?this.component.multipleInstances?e:Lf:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function XV(t){return t===Lf?void 0:t}function KV(t){return t.instantiationMode==="EAGER"}class YV{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const r=this.getProvider(e.name);if(r.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);r.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const r=new ZV(e,this);return this.providers.set(e,r),r}getProviders(){return Array.from(this.providers.values())}}var qr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(qr||(qr={}));const JV={debug:qr.DEBUG,verbose:qr.VERBOSE,info:qr.INFO,warn:qr.WARN,error:qr.ERROR,silent:qr.SILENT},QV=qr.INFO,e8={[qr.DEBUG]:"log",[qr.VERBOSE]:"log",[qr.INFO]:"info",[qr.WARN]:"warn",[qr.ERROR]:"error"},t8=(t,e,...r)=>{if(e<t.logLevel)return;const l=new Date().toISOString(),u=e8[e];if(u)console[u](`[${l}]  ${t.name}:`,...r);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class UP{constructor(e){this.name=e,this._logLevel=QV,this._logHandler=t8,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in qr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?JV[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,qr.DEBUG,...e),this._logHandler(this,qr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,qr.VERBOSE,...e),this._logHandler(this,qr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,qr.INFO,...e),this._logHandler(this,qr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,qr.WARN,...e),this._logHandler(this,qr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,qr.ERROR,...e),this._logHandler(this,qr.ERROR,...e)}}const n8=(t,e)=>e.some(r=>t instanceof r);let ek,tk;function r8(){return ek||(ek=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function i8(){return tk||(tk=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const $P=new WeakMap,Cw=new WeakMap,GP=new WeakMap,v1=new WeakMap,Qb=new WeakMap;function s8(t){const e=new Promise((r,l)=>{const u=()=>{t.removeEventListener("success",m),t.removeEventListener("error",v)},m=()=>{r(ch(t.result)),u()},v=()=>{l(t.error),u()};t.addEventListener("success",m),t.addEventListener("error",v)});return e.then(r=>{r instanceof IDBCursor&&$P.set(r,t)}).catch(()=>{}),Qb.set(e,t),e}function o8(t){if(Cw.has(t))return;const e=new Promise((r,l)=>{const u=()=>{t.removeEventListener("complete",m),t.removeEventListener("error",v),t.removeEventListener("abort",v)},m=()=>{r(),u()},v=()=>{l(t.error||new DOMException("AbortError","AbortError")),u()};t.addEventListener("complete",m),t.addEventListener("error",v),t.addEventListener("abort",v)});Cw.set(t,e)}let kw={get(t,e,r){if(t instanceof IDBTransaction){if(e==="done")return Cw.get(t);if(e==="objectStoreNames")return t.objectStoreNames||GP.get(t);if(e==="store")return r.objectStoreNames[1]?void 0:r.objectStore(r.objectStoreNames[0])}return ch(t[e])},set(t,e,r){return t[e]=r,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function a8(t){kw=t(kw)}function l8(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...r){const l=t.call(w1(this),e,...r);return GP.set(l,e.sort?e.sort():[e]),ch(l)}:i8().includes(t)?function(...e){return t.apply(w1(this),e),ch($P.get(this))}:function(...e){return ch(t.apply(w1(this),e))}}function c8(t){return typeof t=="function"?l8(t):(t instanceof IDBTransaction&&o8(t),n8(t,r8())?new Proxy(t,kw):t)}function ch(t){if(t instanceof IDBRequest)return s8(t);if(v1.has(t))return v1.get(t);const e=c8(t);return e!==t&&(v1.set(t,e),Qb.set(e,t)),e}const w1=t=>Qb.get(t);function u8(t,e,{blocked:r,upgrade:l,blocking:u,terminated:m}={}){const v=indexedDB.open(t,e),b=ch(v);return l&&v.addEventListener("upgradeneeded",a=>{l(ch(v.result),a.oldVersion,a.newVersion,ch(v.transaction),a)}),r&&v.addEventListener("blocked",a=>r(a.oldVersion,a.newVersion,a)),b.then(a=>{m&&a.addEventListener("close",()=>m()),u&&a.addEventListener("versionchange",k=>u(k.oldVersion,k.newVersion,k))}).catch(()=>{}),b}const d8=["get","getKey","getAll","getAllKeys","count"],h8=["put","add","delete","clear"],b1=new Map;function nk(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(b1.get(e))return b1.get(e);const r=e.replace(/FromIndex$/,""),l=e!==r,u=h8.includes(r);if(!(r in(l?IDBIndex:IDBObjectStore).prototype)||!(u||d8.includes(r)))return;const m=async function(v,...b){const a=this.transaction(v,u?"readwrite":"readonly");let k=a.store;return l&&(k=k.index(b.shift())),(await Promise.all([k[r](...b),u&&a.done]))[0]};return b1.set(e,m),m}a8(t=>({...t,get:(e,r,l)=>nk(e,r)||t.get(e,r,l),has:(e,r)=>!!nk(e,r)||t.has(e,r)}));class f8{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(r=>{if(p8(r)){const l=r.getImmediate();return`${l.library}/${l.version}`}else return null}).filter(r=>r).join(" ")}}function p8(t){return t.getComponent()?.type==="VERSION"}const Aw="@firebase/app",rk="0.14.7";const Xu=new UP("@firebase/app"),m8="@firebase/app-compat",g8="@firebase/analytics-compat",y8="@firebase/analytics",_8="@firebase/app-check-compat",x8="@firebase/app-check",v8="@firebase/auth",w8="@firebase/auth-compat",b8="@firebase/database",T8="@firebase/data-connect",S8="@firebase/database-compat",E8="@firebase/functions",C8="@firebase/functions-compat",k8="@firebase/installations",A8="@firebase/installations-compat",I8="@firebase/messaging",M8="@firebase/messaging-compat",P8="@firebase/performance",R8="@firebase/performance-compat",N8="@firebase/remote-config",D8="@firebase/remote-config-compat",L8="@firebase/storage",j8="@firebase/storage-compat",O8="@firebase/firestore",z8="@firebase/ai",B8="@firebase/firestore-compat",F8="firebase",V8="12.8.0";const Iw="[DEFAULT]",U8={[Aw]:"fire-core",[m8]:"fire-core-compat",[y8]:"fire-analytics",[g8]:"fire-analytics-compat",[x8]:"fire-app-check",[_8]:"fire-app-check-compat",[v8]:"fire-auth",[w8]:"fire-auth-compat",[b8]:"fire-rtdb",[T8]:"fire-data-connect",[S8]:"fire-rtdb-compat",[E8]:"fire-fn",[C8]:"fire-fn-compat",[k8]:"fire-iid",[A8]:"fire-iid-compat",[I8]:"fire-fcm",[M8]:"fire-fcm-compat",[P8]:"fire-perf",[R8]:"fire-perf-compat",[N8]:"fire-rc",[D8]:"fire-rc-compat",[L8]:"fire-gcs",[j8]:"fire-gcs-compat",[O8]:"fire-fst",[B8]:"fire-fst-compat",[z8]:"fire-vertex","fire-js":"fire-js",[F8]:"fire-js-all"};const Wx=new Map,$8=new Map,Mw=new Map;function ik(t,e){try{t.container.addComponent(e)}catch(r){Xu.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,r)}}function Ry(t){const e=t.name;if(Mw.has(e))return Xu.debug(`There were multiple attempts to register component ${e}.`),!1;Mw.set(e,t);for(const r of Wx.values())ik(r,t);for(const r of $8.values())ik(r,t);return!0}function HP(t,e){const r=t.container.getProvider("heartbeat").getImmediate({optional:!0});return r&&r.triggerHeartbeat(),t.container.getProvider(e)}function Ul(t){return t==null?!1:t.settings!==void 0}const G8={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},uh=new Qy("app","Firebase",G8);class H8{constructor(e,r,l){this._isDeleted=!1,this._options={...e},this._config={...r},this._name=r.name,this._automaticDataCollectionEnabled=r.automaticDataCollectionEnabled,this._container=l,this.container.addComponent(new Om("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw uh.create("app-deleted",{appName:this._name})}}const t_=V8;function WP(t,e={}){let r=t;typeof e!="object"&&(e={name:e});const l={name:Iw,automaticDataCollectionEnabled:!0,...e},u=l.name;if(typeof u!="string"||!u)throw uh.create("bad-app-name",{appName:String(u)});if(r||(r=FP()),!r)throw uh.create("no-options");const m=Wx.get(u);if(m){if(jm(r,m.options)&&jm(l,m.config))return m;throw uh.create("duplicate-app",{appName:u})}const v=new YV(u);for(const a of Mw.values())v.addComponent(a);const b=new H8(r,l,v);return Wx.set(u,b),b}function W8(t=Iw){const e=Wx.get(t);if(!e&&t===Iw&&FP())return WP();if(!e)throw uh.create("no-app",{appName:t});return e}function Cm(t,e,r){let l=U8[t]??t;r&&(l+=`-${r}`);const u=l.match(/\s|\//),m=e.match(/\s|\//);if(u||m){const v=[`Unable to register library "${l}" with version "${e}":`];u&&v.push(`library name "${l}" contains illegal characters (whitespace or "/")`),u&&m&&v.push("and"),m&&v.push(`version name "${e}" contains illegal characters (whitespace or "/")`),Xu.warn(v.join(" "));return}Ry(new Om(`${l}-version`,()=>({library:l,version:e}),"VERSION"))}const q8="firebase-heartbeat-database",Z8=1,Ny="firebase-heartbeat-store";let T1=null;function qP(){return T1||(T1=u8(q8,Z8,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(Ny)}catch(r){console.warn(r)}}}}).catch(t=>{throw uh.create("idb-open",{originalErrorMessage:t.message})})),T1}async function X8(t){try{const r=(await qP()).transaction(Ny),l=await r.objectStore(Ny).get(ZP(t));return await r.done,l}catch(e){if(e instanceof vh)Xu.warn(e.message);else{const r=uh.create("idb-get",{originalErrorMessage:e?.message});Xu.warn(r.message)}}}async function sk(t,e){try{const l=(await qP()).transaction(Ny,"readwrite");await l.objectStore(Ny).put(e,ZP(t)),await l.done}catch(r){if(r instanceof vh)Xu.warn(r.message);else{const l=uh.create("idb-set",{originalErrorMessage:r?.message});Xu.warn(l.message)}}}function ZP(t){return`${t.name}!${t.options.appId}`}const K8=1024,Y8=30;class J8{constructor(e){this.container=e,this._heartbeatsCache=null;const r=this.container.getProvider("app").getImmediate();this._storage=new eU(r),this._heartbeatsCachePromise=this._storage.read().then(l=>(this._heartbeatsCache=l,l))}async triggerHeartbeat(){try{const r=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),l=ok();if(this._heartbeatsCache?.heartbeats==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null)||this._heartbeatsCache.lastSentHeartbeatDate===l||this._heartbeatsCache.heartbeats.some(u=>u.date===l))return;if(this._heartbeatsCache.heartbeats.push({date:l,agent:r}),this._heartbeatsCache.heartbeats.length>Y8){const u=tU(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(u,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){Xu.warn(e)}}async getHeartbeatsHeader(){try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,this._heartbeatsCache?.heartbeats==null||this._heartbeatsCache.heartbeats.length===0)return"";const e=ok(),{heartbeatsToSend:r,unsentEntries:l}=Q8(this._heartbeatsCache.heartbeats),u=zP(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=e,l.length>0?(this._heartbeatsCache.heartbeats=l,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),u}catch(e){return Xu.warn(e),""}}}function ok(){return new Date().toISOString().substring(0,10)}function Q8(t,e=K8){const r=[];let l=t.slice();for(const u of t){const m=r.find(v=>v.agent===u.agent);if(m){if(m.dates.push(u.date),ak(r)>e){m.dates.pop();break}}else if(r.push({agent:u.agent,dates:[u.date]}),ak(r)>e){r.pop();break}l=l.slice(1)}return{heartbeatsToSend:r,unsentEntries:l}}class eU{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return BV()?FV().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const r=await X8(this.app);return r?.heartbeats?r:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return sk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){if(await this._canUseIndexedDBPromise){const l=await this.read();return sk(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??l.lastSentHeartbeatDate,heartbeats:[...l.heartbeats,...e.heartbeats]})}else return}}function ak(t){return zP(JSON.stringify({version:2,heartbeats:t})).length}function tU(t){if(t.length===0)return-1;let e=0,r=t[0].date;for(let l=1;l<t.length;l++)t[l].date<r&&(r=t[l].date,e=l);return e}function nU(t){Ry(new Om("platform-logger",e=>new f8(e),"PRIVATE")),Ry(new Om("heartbeat",e=>new J8(e),"PRIVATE")),Cm(Aw,rk,t),Cm(Aw,rk,"esm2020"),Cm("fire-js","")}nU("");function XP(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const rU=XP,KP=new Qy("auth","Firebase",XP());const qx=new UP("@firebase/auth");function iU(t,...e){qx.logLevel<=qr.WARN&&qx.warn(`Auth (${t_}): ${t}`,...e)}function Cx(t,...e){qx.logLevel<=qr.ERROR&&qx.error(`Auth (${t_}): ${t}`,...e)}function Wl(t,...e){throw eT(t,...e)}function Hc(t,...e){return eT(t,...e)}function YP(t,e,r){const l={...rU(),[e]:r};return new Qy("auth","Firebase",l).create(e,{appName:t.name})}function Hu(t){return YP(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function eT(t,...e){if(typeof t!="string"){const r=e[0],l=[...e.slice(1)];return l[0]&&(l[0].appName=t.name),t._errorFactory.create(r,...l)}return KP.create(t,...e)}function Un(t,e,...r){if(!t)throw eT(e,...r)}function $u(t){const e="INTERNAL ASSERTION FAILED: "+t;throw Cx(e),new Error(e)}function Ku(t,e){t||$u(e)}function Pw(){return typeof self<"u"&&self.location?.href||""}function sU(){return lk()==="http:"||lk()==="https:"}function lk(){return typeof self<"u"&&self.location?.protocol||null}function oU(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(sU()||jV()||"connection"in navigator)?navigator.onLine:!0}function aU(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}class n_{constructor(e,r){this.shortDelay=e,this.longDelay=r,Ku(r>e,"Short delay should be less than long delay!"),this.isMobile=DV()||OV()}get(){return oU()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}function tT(t,e){Ku(t.emulator,"Emulator should always be set here");const{url:r}=t.emulator;return e?`${r}${e.startsWith("/")?e.slice(1):e}`:r}class JP{static initialize(e,r,l){this.fetchImpl=e,r&&(this.headersImpl=r),l&&(this.responseImpl=l)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;$u("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;$u("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;$u("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const lU={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};const cU=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],uU=new n_(3e4,6e4);function wh(t,e){return t.tenantId&&!e.tenantId?{...e,tenantId:t.tenantId}:e}async function bh(t,e,r,l,u={}){return QP(t,u,async()=>{let m={},v={};l&&(e==="GET"?v=l:m={body:JSON.stringify(l)});const b=e_({key:t.config.apiKey,...v}).slice(1),a=await t._getAdditionalHeaders();a["Content-Type"]="application/json",t.languageCode&&(a["X-Firebase-Locale"]=t.languageCode);const k={method:e,headers:a,...m};return LV()||(k.referrerPolicy="no-referrer"),t.emulatorConfig&&Bv(t.emulatorConfig.host)&&(k.credentials="include"),JP.fetch()(await eR(t,t.config.apiHost,r,b),k)})}async function QP(t,e,r){t._canInitEmulator=!1;const l={...lU,...e};try{const u=new hU(t),m=await Promise.race([r(),u.promise]);u.clearNetworkTimeout();const v=await m.json();if("needConfirmation"in v)throw lx(t,"account-exists-with-different-credential",v);if(m.ok&&!("errorMessage"in v))return v;{const b=m.ok?v.errorMessage:v.error.message,[a,k]=b.split(" : ");if(a==="FEDERATED_USER_ID_ALREADY_LINKED")throw lx(t,"credential-already-in-use",v);if(a==="EMAIL_EXISTS")throw lx(t,"email-already-in-use",v);if(a==="USER_DISABLED")throw lx(t,"user-disabled",v);const M=l[a]||a.toLowerCase().replace(/[_\s]+/g,"-");if(k)throw YP(t,M,k);Wl(t,M)}}catch(u){if(u instanceof vh)throw u;Wl(t,"network-request-failed",{message:String(u)})}}async function r_(t,e,r,l,u={}){const m=await bh(t,e,r,l,u);return"mfaPendingCredential"in m&&Wl(t,"multi-factor-auth-required",{_serverResponse:m}),m}async function eR(t,e,r,l){const u=`${e}${r}?${l}`,m=t,v=m.config.emulator?tT(t.config,u):`${t.config.apiScheme}://${u}`;return cU.includes(r)&&(await m._persistenceManagerAvailable,m._getPersistenceType()==="COOKIE")?m._getPersistence()._getFinalTarget(v).toString():v}function dU(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class hU{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((r,l)=>{this.timer=setTimeout(()=>l(Hc(this.auth,"network-request-failed")),uU.get())})}}function lx(t,e,r){const l={appName:t.name};r.email&&(l.email=r.email),r.phoneNumber&&(l.phoneNumber=r.phoneNumber);const u=Hc(t,e,l);return u.customData._tokenResponse=r,u}function ck(t){return t!==void 0&&t.enterprise!==void 0}class fU{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const r of this.recaptchaEnforcementState)if(r.provider&&r.provider===e)return dU(r.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function pU(t,e){return bh(t,"GET","/v2/recaptchaConfig",wh(t,e))}async function mU(t,e){return bh(t,"POST","/v1/accounts:delete",e)}async function Zx(t,e){return bh(t,"POST","/v1/accounts:lookup",e)}function yy(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function gU(t,e=!1){const r=td(t),l=await r.getIdToken(e),u=nT(l);Un(u&&u.exp&&u.auth_time&&u.iat,r.auth,"internal-error");const m=typeof u.firebase=="object"?u.firebase:void 0,v=m?.sign_in_provider;return{claims:u,token:l,authTime:yy(S1(u.auth_time)),issuedAtTime:yy(S1(u.iat)),expirationTime:yy(S1(u.exp)),signInProvider:v||null,signInSecondFactor:m?.sign_in_second_factor||null}}function S1(t){return Number(t)*1e3}function nT(t){const[e,r,l]=t.split(".");if(e===void 0||r===void 0||l===void 0)return Cx("JWT malformed, contained fewer than 3 sections"),null;try{const u=BP(r);return u?JSON.parse(u):(Cx("Failed to decode base64 JWT payload"),null)}catch(u){return Cx("Caught error parsing JWT payload as JSON",u?.toString()),null}}function uk(t){const e=nT(t);return Un(e,"internal-error"),Un(typeof e.exp<"u","internal-error"),Un(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}async function Dy(t,e,r=!1){if(r)return e;try{return await e}catch(l){throw l instanceof vh&&yU(l)&&t.auth.currentUser===t&&await t.auth.signOut(),l}}function yU({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}class _U{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const l=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,l)}}schedule(e=!1){if(!this.isRunning)return;const r=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},r)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){e?.code==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}class Rw{constructor(e,r){this.createdAt=e,this.lastLoginAt=r,this._initializeTime()}_initializeTime(){this.lastSignInTime=yy(this.lastLoginAt),this.creationTime=yy(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function Xx(t){const e=t.auth,r=await t.getIdToken(),l=await Dy(t,Zx(e,{idToken:r}));Un(l?.users.length,e,"internal-error");const u=l.users[0];t._notifyReloadListener(u);const m=u.providerUserInfo?.length?tR(u.providerUserInfo):[],v=vU(t.providerData,m),b=t.isAnonymous,a=!(t.email&&u.passwordHash)&&!v?.length,k=b?a:!1,M={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:v,metadata:new Rw(u.createdAt,u.lastLoginAt),isAnonymous:k};Object.assign(t,M)}async function xU(t){const e=td(t);await Xx(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function vU(t,e){return[...t.filter(l=>!e.some(u=>u.providerId===l.providerId)),...e]}function tR(t){return t.map(({providerId:e,...r})=>({providerId:e,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}))}async function wU(t,e){const r=await QP(t,{},async()=>{const l=e_({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:u,apiKey:m}=t.config,v=await eR(t,u,"/v1/token",`key=${m}`),b=await t._getAdditionalHeaders();b["Content-Type"]="application/x-www-form-urlencoded";const a={method:"POST",headers:b,body:l};return t.emulatorConfig&&Bv(t.emulatorConfig.host)&&(a.credentials="include"),JP.fetch()(v,a)});return{accessToken:r.access_token,expiresIn:r.expires_in,refreshToken:r.refresh_token}}async function bU(t,e){return bh(t,"POST","/v2/accounts:revokeToken",wh(t,e))}class km{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Un(e.idToken,"internal-error"),Un(typeof e.idToken<"u","internal-error"),Un(typeof e.refreshToken<"u","internal-error");const r="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):uk(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,r)}updateFromIdToken(e){Un(e.length!==0,"internal-error");const r=uk(e);this.updateTokensAndExpiration(e,null,r)}async getToken(e,r=!1){return!r&&this.accessToken&&!this.isExpired?this.accessToken:(Un(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,r){const{accessToken:l,refreshToken:u,expiresIn:m}=await wU(e,r);this.updateTokensAndExpiration(l,u,Number(m))}updateTokensAndExpiration(e,r,l){this.refreshToken=r||null,this.accessToken=e||null,this.expirationTime=Date.now()+l*1e3}static fromJSON(e,r){const{refreshToken:l,accessToken:u,expirationTime:m}=r,v=new km;return l&&(Un(typeof l=="string","internal-error",{appName:e}),v.refreshToken=l),u&&(Un(typeof u=="string","internal-error",{appName:e}),v.accessToken=u),m&&(Un(typeof m=="number","internal-error",{appName:e}),v.expirationTime=m),v}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new km,this.toJSON())}_performRefresh(){return $u("not implemented")}}function Xd(t,e){Un(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class $l{constructor({uid:e,auth:r,stsTokenManager:l,...u}){this.providerId="firebase",this.proactiveRefresh=new _U(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=r,this.stsTokenManager=l,this.accessToken=l.accessToken,this.displayName=u.displayName||null,this.email=u.email||null,this.emailVerified=u.emailVerified||!1,this.phoneNumber=u.phoneNumber||null,this.photoURL=u.photoURL||null,this.isAnonymous=u.isAnonymous||!1,this.tenantId=u.tenantId||null,this.providerData=u.providerData?[...u.providerData]:[],this.metadata=new Rw(u.createdAt||void 0,u.lastLoginAt||void 0)}async getIdToken(e){const r=await Dy(this,this.stsTokenManager.getToken(this.auth,e));return Un(r,this.auth,"internal-error"),this.accessToken!==r&&(this.accessToken=r,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),r}getIdTokenResult(e){return gU(this,e)}reload(){return xU(this)}_assign(e){this!==e&&(Un(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(r=>({...r})),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const r=new $l({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return r.metadata._copy(this.metadata),r}_onReload(e){Un(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,r=!1){let l=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),l=!0),r&&await Xx(this),await this.auth._persistUserIfCurrent(this),l&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Ul(this.auth.app))return Promise.reject(Hu(this.auth));const e=await this.getIdToken();return await Dy(this,mU(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>({...e})),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,r){const l=r.displayName??void 0,u=r.email??void 0,m=r.phoneNumber??void 0,v=r.photoURL??void 0,b=r.tenantId??void 0,a=r._redirectEventId??void 0,k=r.createdAt??void 0,M=r.lastLoginAt??void 0,{uid:L,emailVerified:z,isAnonymous:O,providerData:K,stsTokenManager:H}=r;Un(L&&H,e,"internal-error");const Z=km.fromJSON(this.name,H);Un(typeof L=="string",e,"internal-error"),Xd(l,e.name),Xd(u,e.name),Un(typeof z=="boolean",e,"internal-error"),Un(typeof O=="boolean",e,"internal-error"),Xd(m,e.name),Xd(v,e.name),Xd(b,e.name),Xd(a,e.name),Xd(k,e.name),Xd(M,e.name);const Y=new $l({uid:L,auth:e,email:u,emailVerified:z,displayName:l,isAnonymous:O,photoURL:v,phoneNumber:m,tenantId:b,stsTokenManager:Z,createdAt:k,lastLoginAt:M});return K&&Array.isArray(K)&&(Y.providerData=K.map(ee=>({...ee}))),a&&(Y._redirectEventId=a),Y}static async _fromIdTokenResponse(e,r,l=!1){const u=new km;u.updateFromServerResponse(r);const m=new $l({uid:r.localId,auth:e,stsTokenManager:u,isAnonymous:l});return await Xx(m),m}static async _fromGetAccountInfoResponse(e,r,l){const u=r.users[0];Un(u.localId!==void 0,"internal-error");const m=u.providerUserInfo!==void 0?tR(u.providerUserInfo):[],v=!(u.email&&u.passwordHash)&&!m?.length,b=new km;b.updateFromIdToken(l);const a=new $l({uid:u.localId,auth:e,stsTokenManager:b,isAnonymous:v}),k={uid:u.localId,displayName:u.displayName||null,photoURL:u.photoUrl||null,email:u.email||null,emailVerified:u.emailVerified||!1,phoneNumber:u.phoneNumber||null,tenantId:u.tenantId||null,providerData:m,metadata:new Rw(u.createdAt,u.lastLoginAt),isAnonymous:!(u.email&&u.passwordHash)&&!m?.length};return Object.assign(a,k),a}}const dk=new Map;function Gu(t){Ku(t instanceof Function,"Expected a class definition");let e=dk.get(t);return e?(Ku(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,dk.set(t,e),e)}class nR{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,r){this.storage[e]=r}async _get(e){const r=this.storage[e];return r===void 0?null:r}async _remove(e){delete this.storage[e]}_addListener(e,r){}_removeListener(e,r){}}nR.type="NONE";const hk=nR;function kx(t,e,r){return`firebase:${t}:${e}:${r}`}class Am{constructor(e,r,l){this.persistence=e,this.auth=r,this.userKey=l;const{config:u,name:m}=this.auth;this.fullUserKey=kx(this.userKey,u.apiKey,m),this.fullPersistenceKey=kx("persistence",u.apiKey,m),this.boundEventHandler=r._onStorageEvent.bind(r),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const r=await Zx(this.auth,{idToken:e}).catch(()=>{});return r?$l._fromGetAccountInfoResponse(this.auth,r,e):null}return $l._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const r=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,r)return this.setCurrentUser(r)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,r,l="authUser"){if(!r.length)return new Am(Gu(hk),e,l);const u=(await Promise.all(r.map(async k=>{if(await k._isAvailable())return k}))).filter(k=>k);let m=u[0]||Gu(hk);const v=kx(l,e.config.apiKey,e.name);let b=null;for(const k of r)try{const M=await k._get(v);if(M){let L;if(typeof M=="string"){const z=await Zx(e,{idToken:M}).catch(()=>{});if(!z)break;L=await $l._fromGetAccountInfoResponse(e,z,M)}else L=$l._fromJSON(e,M);k!==m&&(b=L),m=k;break}}catch{}const a=u.filter(k=>k._shouldAllowMigration);return!m._shouldAllowMigration||!a.length?new Am(m,e,l):(m=a[0],b&&await m._set(v,b.toJSON()),await Promise.all(r.map(async k=>{if(k!==m)try{await k._remove(v)}catch{}})),new Am(m,e,l))}}function fk(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(oR(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(rR(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(lR(e))return"Blackberry";if(cR(e))return"Webos";if(iR(e))return"Safari";if((e.includes("chrome/")||sR(e))&&!e.includes("edge/"))return"Chrome";if(aR(e))return"Android";{const r=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,l=t.match(r);if(l?.length===2)return l[1]}return"Other"}function rR(t=Lo()){return/firefox\//i.test(t)}function iR(t=Lo()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function sR(t=Lo()){return/crios\//i.test(t)}function oR(t=Lo()){return/iemobile/i.test(t)}function aR(t=Lo()){return/android/i.test(t)}function lR(t=Lo()){return/blackberry/i.test(t)}function cR(t=Lo()){return/webos/i.test(t)}function rT(t=Lo()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function TU(t=Lo()){return rT(t)&&!!window.navigator?.standalone}function SU(){return zV()&&document.documentMode===10}function uR(t=Lo()){return rT(t)||aR(t)||cR(t)||lR(t)||/windows phone/i.test(t)||oR(t)}function dR(t,e=[]){let r;switch(t){case"Browser":r=fk(Lo());break;case"Worker":r=`${fk(Lo())}-${t}`;break;default:r=t}const l=e.length?e.join(","):"FirebaseCore-web";return`${r}/JsCore/${t_}/${l}`}class EU{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,r){const l=m=>new Promise((v,b)=>{try{const a=e(m);v(a)}catch(a){b(a)}});l.onAbort=r,this.queue.push(l);const u=this.queue.length-1;return()=>{this.queue[u]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const r=[];try{for(const l of this.queue)await l(e),l.onAbort&&r.push(l.onAbort)}catch(l){r.reverse();for(const u of r)try{u()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:l?.message})}}}async function CU(t,e={}){return bh(t,"GET","/v2/passwordPolicy",wh(t,e))}const kU=6;class AU{constructor(e){const r=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=r.minPasswordLength??kU,r.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=r.maxPasswordLength),r.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=r.containsLowercaseCharacter),r.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=r.containsUppercaseCharacter),r.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=r.containsNumericCharacter),r.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=r.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const r={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,r),this.validatePasswordCharacterOptions(e,r),r.isValid&&(r.isValid=r.meetsMinPasswordLength??!0),r.isValid&&(r.isValid=r.meetsMaxPasswordLength??!0),r.isValid&&(r.isValid=r.containsLowercaseLetter??!0),r.isValid&&(r.isValid=r.containsUppercaseLetter??!0),r.isValid&&(r.isValid=r.containsNumericCharacter??!0),r.isValid&&(r.isValid=r.containsNonAlphanumericCharacter??!0),r}validatePasswordLengthOptions(e,r){const l=this.customStrengthOptions.minPasswordLength,u=this.customStrengthOptions.maxPasswordLength;l&&(r.meetsMinPasswordLength=e.length>=l),u&&(r.meetsMaxPasswordLength=e.length<=u)}validatePasswordCharacterOptions(e,r){this.updatePasswordCharacterOptionsStatuses(r,!1,!1,!1,!1);let l;for(let u=0;u<e.length;u++)l=e.charAt(u),this.updatePasswordCharacterOptionsStatuses(r,l>="a"&&l<="z",l>="A"&&l<="Z",l>="0"&&l<="9",this.allowedNonAlphanumericCharacters.includes(l))}updatePasswordCharacterOptionsStatuses(e,r,l,u,m){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=r)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=l)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=u)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=m))}}class IU{constructor(e,r,l,u){this.app=e,this.heartbeatServiceProvider=r,this.appCheckServiceProvider=l,this.config=u,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new pk(this),this.idTokenSubscription=new pk(this),this.beforeStateQueue=new EU(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=KP,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=u.sdkClientVersion,this._persistenceManagerAvailable=new Promise(m=>this._resolvePersistenceManagerAvailable=m)}_initializeWithPersistence(e,r){return r&&(this._popupRedirectResolver=Gu(r)),this._initializationPromise=this.queue(async()=>{if(!this._deleted&&(this.persistenceManager=await Am.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(r),this.lastNotifiedUid=this.currentUser?.uid||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const r=await Zx(this,{idToken:e}),l=await $l._fromGetAccountInfoResponse(this,r,e);await this.directlySetCurrentUser(l)}catch(r){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",r),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if(Ul(this.app)){const m=this.app.settings.authIdToken;return m?new Promise(v=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(m).then(v,v))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let l=r,u=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const m=this.redirectUser?._redirectEventId,v=l?._redirectEventId,b=await this.tryRedirectSignIn(e);(!m||m===v)&&b?.user&&(l=b.user,u=!0)}if(!l)return this.directlySetCurrentUser(null);if(!l._redirectEventId){if(u)try{await this.beforeStateQueue.runMiddleware(l)}catch(m){l=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(m))}return l?this.reloadAndSetCurrentUserOrClear(l):this.directlySetCurrentUser(null)}return Un(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===l._redirectEventId?this.directlySetCurrentUser(l):this.reloadAndSetCurrentUserOrClear(l)}async tryRedirectSignIn(e){let r=null;try{r=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return r}async reloadAndSetCurrentUserOrClear(e){try{await Xx(e)}catch(r){if(r?.code!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=aU()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Ul(this.app))return Promise.reject(Hu(this));const r=e?td(e):null;return r&&Un(r.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(r&&r._clone(this))}async _updateCurrentUser(e,r=!1){if(!this._deleted)return e&&Un(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),r||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Ul(this.app)?Promise.reject(Hu(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Ul(this.app)?Promise.reject(Hu(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(Gu(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const r=this._getPasswordPolicyInternal();return r.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):r.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await CU(this),r=new AU(e);this.tenantId===null?this._projectPasswordPolicy=r:this._tenantPasswordPolicies[this.tenantId]=r}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new Qy("auth","Firebase",e())}onAuthStateChanged(e,r,l){return this.registerStateListener(this.authStateSubscription,e,r,l)}beforeAuthStateChanged(e,r){return this.beforeStateQueue.pushCallback(e,r)}onIdTokenChanged(e,r,l){return this.registerStateListener(this.idTokenSubscription,e,r,l)}authStateReady(){return new Promise((e,r)=>{if(this.currentUser)e();else{const l=this.onAuthStateChanged(()=>{l(),e()},r)}})}async revokeAccessToken(e){if(this.currentUser){const r=await this.currentUser.getIdToken(),l={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:r};this.tenantId!=null&&(l.tenantId=this.tenantId),await bU(this,l)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,r){const l=await this.getOrInitRedirectPersistenceManager(r);return e===null?l.removeCurrentUser():l.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const r=e&&Gu(e)||this._popupRedirectResolver;Un(r,this,"argument-error"),this.redirectPersistenceManager=await Am.create(this,[Gu(r._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue(async()=>{}),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,r,l,u){if(this._deleted)return()=>{};const m=typeof r=="function"?r:r.next.bind(r);let v=!1;const b=this._isInitialized?Promise.resolve():this._initializationPromise;if(Un(b,this,"internal-error"),b.then(()=>{v||m(this.currentUser)}),typeof r=="function"){const a=e.addObserver(r,l,u);return()=>{v=!0,a()}}else{const a=e.addObserver(r);return()=>{v=!0,a()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Un(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=dR(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const r=await this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader();r&&(e["X-Firebase-Client"]=r);const l=await this._getAppCheckToken();return l&&(e["X-Firebase-AppCheck"]=l),e}async _getAppCheckToken(){if(Ul(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken();return e?.error&&iU(`Error while retrieving App Check token: ${e.error}`),e?.token}}function sp(t){return td(t)}class pk{constructor(e){this.auth=e,this.observer=null,this.addObserver=HV(r=>this.observer=r)}get next(){return Un(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Fv={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function MU(t){Fv=t}function hR(t){return Fv.loadJS(t)}function PU(){return Fv.recaptchaEnterpriseScript}function RU(){return Fv.gapiScript}function NU(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class DU{constructor(){this.enterprise=new LU}ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}class LU{ready(e){e()}execute(e,r){return Promise.resolve("token")}render(e,r){return""}}const jU="recaptcha-enterprise",fR="NO_RECAPTCHA";class OU{constructor(e){this.type=jU,this.auth=sp(e)}async verify(e="verify",r=!1){async function l(m){if(!r){if(m.tenantId==null&&m._agentRecaptchaConfig!=null)return m._agentRecaptchaConfig.siteKey;if(m.tenantId!=null&&m._tenantRecaptchaConfigs[m.tenantId]!==void 0)return m._tenantRecaptchaConfigs[m.tenantId].siteKey}return new Promise(async(v,b)=>{pU(m,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(a=>{if(a.recaptchaKey===void 0)b(new Error("recaptcha Enterprise site key undefined"));else{const k=new fU(a);return m.tenantId==null?m._agentRecaptchaConfig=k:m._tenantRecaptchaConfigs[m.tenantId]=k,v(k.siteKey)}}).catch(a=>{b(a)})})}function u(m,v,b){const a=window.grecaptcha;ck(a)?a.enterprise.ready(()=>{a.enterprise.execute(m,{action:e}).then(k=>{v(k)}).catch(()=>{v(fR)})}):b(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new DU().execute("siteKey",{action:"verify"}):new Promise((m,v)=>{l(this.auth).then(b=>{if(!r&&ck(window.grecaptcha))u(b,m,v);else{if(typeof window>"u"){v(new Error("RecaptchaVerifier is only supported in browser"));return}let a=PU();a.length!==0&&(a+=b),hR(a).then(()=>{u(b,m,v)}).catch(k=>{v(k)})}}).catch(b=>{v(b)})})}}async function mk(t,e,r,l=!1,u=!1){const m=new OU(t);let v;if(u)v=fR;else try{v=await m.verify(r)}catch{v=await m.verify(r,!0)}const b={...e};if(r==="mfaSmsEnrollment"||r==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in b){const a=b.phoneEnrollmentInfo.phoneNumber,k=b.phoneEnrollmentInfo.recaptchaToken;Object.assign(b,{phoneEnrollmentInfo:{phoneNumber:a,recaptchaToken:k,captchaResponse:v,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in b){const a=b.phoneSignInInfo.recaptchaToken;Object.assign(b,{phoneSignInInfo:{recaptchaToken:a,captchaResponse:v,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return b}return l?Object.assign(b,{captchaResp:v}):Object.assign(b,{captchaResponse:v}),Object.assign(b,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(b,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),b}async function Nw(t,e,r,l,u){if(t._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const m=await mk(t,e,r,r==="getOobCode");return l(t,m)}else return l(t,e).catch(async m=>{if(m.code==="auth/missing-recaptcha-token"){console.log(`${r} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const v=await mk(t,e,r,r==="getOobCode");return l(t,v)}else return Promise.reject(m)})}function zU(t,e){const r=HP(t,"auth");if(r.isInitialized()){const u=r.getImmediate(),m=r.getOptions();if(jm(m,e??{}))return u;Wl(u,"already-initialized")}return r.initialize({options:e})}function BU(t,e){const r=e?.persistence||[],l=(Array.isArray(r)?r:[r]).map(Gu);e?.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(l,e?.popupRedirectResolver)}function FU(t,e,r){const l=sp(t);Un(/^https?:\/\//.test(e),l,"invalid-emulator-scheme");const u=!1,m=pR(e),{host:v,port:b}=VU(e),a=b===null?"":`:${b}`,k={url:`${m}//${v}${a}/`},M=Object.freeze({host:v,port:b,protocol:m.replace(":",""),options:Object.freeze({disableWarnings:u})});if(!l._canInitEmulator){Un(l.config.emulator&&l.emulatorConfig,l,"emulator-config-failed"),Un(jm(k,l.config.emulator)&&jm(M,l.emulatorConfig),l,"emulator-config-failed");return}l.config.emulator=k,l.emulatorConfig=M,l.settings.appVerificationDisabledForTesting=!0,Bv(v)?(MV(`${m}//${v}${a}`),NV("Auth",!0)):UU()}function pR(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function VU(t){const e=pR(t),r=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!r)return{host:"",port:null};const l=r[2].split("@").pop()||"",u=/^(\[[^\]]+\])(:|$)/.exec(l);if(u){const m=u[1];return{host:m,port:gk(l.substr(m.length+1))}}else{const[m,v]=l.split(":");return{host:m,port:gk(v)}}}function gk(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function UU(){function t(){const e=document.createElement("p"),r=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",r.position="fixed",r.width="100%",r.backgroundColor="#ffffff",r.border=".1em solid #000000",r.color="#b50000",r.bottom="0px",r.left="0px",r.margin="0px",r.zIndex="10000",r.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}class iT{constructor(e,r){this.providerId=e,this.signInMethod=r}toJSON(){return $u("not implemented")}_getIdTokenResponse(e){return $u("not implemented")}_linkToIdToken(e,r){return $u("not implemented")}_getReauthenticationResolver(e){return $u("not implemented")}}async function $U(t,e){return bh(t,"POST","/v1/accounts:signUp",e)}async function GU(t,e){return r_(t,"POST","/v1/accounts:signInWithPassword",wh(t,e))}async function HU(t,e){return r_(t,"POST","/v1/accounts:signInWithEmailLink",wh(t,e))}async function WU(t,e){return r_(t,"POST","/v1/accounts:signInWithEmailLink",wh(t,e))}class Ly extends iT{constructor(e,r,l,u=null){super("password",l),this._email=e,this._password=r,this._tenantId=u}static _fromEmailAndPassword(e,r){return new Ly(e,r,"password")}static _fromEmailAndCode(e,r,l=null){return new Ly(e,r,"emailLink",l)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e;if(r?.email&&r?.password){if(r.signInMethod==="password")return this._fromEmailAndPassword(r.email,r.password);if(r.signInMethod==="emailLink")return this._fromEmailAndCode(r.email,r.password,r.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const r={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nw(e,r,"signInWithPassword",GU);case"emailLink":return HU(e,{email:this._email,oobCode:this._password});default:Wl(e,"internal-error")}}async _linkToIdToken(e,r){switch(this.signInMethod){case"password":const l={idToken:r,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Nw(e,l,"signUpPassword",$U);case"emailLink":return WU(e,{idToken:r,email:this._email,oobCode:this._password});default:Wl(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Im(t,e){return r_(t,"POST","/v1/accounts:signInWithIdp",wh(t,e))}const qU="http://localhost";class Xf extends iT{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const r=new Xf(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(r.idToken=e.idToken),e.accessToken&&(r.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(r.nonce=e.nonce),e.pendingToken&&(r.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(r.accessToken=e.oauthToken,r.secret=e.oauthTokenSecret):Wl("argument-error"),r}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const r=typeof e=="string"?JSON.parse(e):e,{providerId:l,signInMethod:u,...m}=r;if(!l||!u)return null;const v=new Xf(l,u);return v.idToken=m.idToken||void 0,v.accessToken=m.accessToken||void 0,v.secret=m.secret,v.nonce=m.nonce,v.pendingToken=m.pendingToken||null,v}_getIdTokenResponse(e){const r=this.buildRequest();return Im(e,r)}_linkToIdToken(e,r){const l=this.buildRequest();return l.idToken=r,Im(e,l)}_getReauthenticationResolver(e){const r=this.buildRequest();return r.autoCreate=!1,Im(e,r)}buildRequest(){const e={requestUri:qU,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const r={};this.idToken&&(r.id_token=this.idToken),this.accessToken&&(r.access_token=this.accessToken),this.secret&&(r.oauth_token_secret=this.secret),r.providerId=this.providerId,this.nonce&&!this.pendingToken&&(r.nonce=this.nonce),e.postBody=e_(r)}return e}}function ZU(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function XU(t){const e=ry(iy(t)).link,r=e?ry(iy(e)).deep_link_id:null,l=ry(iy(t)).deep_link_id;return(l?ry(iy(l)).link:null)||l||r||e||t}class sT{constructor(e){const r=ry(iy(e)),l=r.apiKey??null,u=r.oobCode??null,m=ZU(r.mode??null);Un(l&&u&&m,"argument-error"),this.apiKey=l,this.operation=m,this.code=u,this.continueUrl=r.continueUrl??null,this.languageCode=r.lang??null,this.tenantId=r.tenantId??null}static parseLink(e){const r=XU(e);try{return new sT(r)}catch{return null}}}class Ym{constructor(){this.providerId=Ym.PROVIDER_ID}static credential(e,r){return Ly._fromEmailAndPassword(e,r)}static credentialWithLink(e,r){const l=sT.parseLink(r);return Un(l,"argument-error"),Ly._fromEmailAndCode(e,l.code,l.tenantId)}}Ym.PROVIDER_ID="password";Ym.EMAIL_PASSWORD_SIGN_IN_METHOD="password";Ym.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class mR{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class i_ extends mR{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Qd extends i_{constructor(){super("facebook.com")}static credential(e){return Xf._fromParams({providerId:Qd.PROVIDER_ID,signInMethod:Qd.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qd.credentialFromTaggedObject(e)}static credentialFromError(e){return Qd.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Qd.credential(e.oauthAccessToken)}catch{return null}}}Qd.FACEBOOK_SIGN_IN_METHOD="facebook.com";Qd.PROVIDER_ID="facebook.com";class eh extends i_{constructor(){super("google.com"),this.addScope("profile")}static credential(e,r){return Xf._fromParams({providerId:eh.PROVIDER_ID,signInMethod:eh.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:r})}static credentialFromResult(e){return eh.credentialFromTaggedObject(e)}static credentialFromError(e){return eh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:r,oauthAccessToken:l}=e;if(!r&&!l)return null;try{return eh.credential(r,l)}catch{return null}}}eh.GOOGLE_SIGN_IN_METHOD="google.com";eh.PROVIDER_ID="google.com";class th extends i_{constructor(){super("github.com")}static credential(e){return Xf._fromParams({providerId:th.PROVIDER_ID,signInMethod:th.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return th.credentialFromTaggedObject(e)}static credentialFromError(e){return th.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return th.credential(e.oauthAccessToken)}catch{return null}}}th.GITHUB_SIGN_IN_METHOD="github.com";th.PROVIDER_ID="github.com";class nh extends i_{constructor(){super("twitter.com")}static credential(e,r){return Xf._fromParams({providerId:nh.PROVIDER_ID,signInMethod:nh.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:r})}static credentialFromResult(e){return nh.credentialFromTaggedObject(e)}static credentialFromError(e){return nh.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:r,oauthTokenSecret:l}=e;if(!r||!l)return null;try{return nh.credential(r,l)}catch{return null}}}nh.TWITTER_SIGN_IN_METHOD="twitter.com";nh.PROVIDER_ID="twitter.com";async function KU(t,e){return r_(t,"POST","/v1/accounts:signUp",wh(t,e))}class Kf{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,r,l,u=!1){const m=await $l._fromIdTokenResponse(e,l,u),v=yk(l);return new Kf({user:m,providerId:v,_tokenResponse:l,operationType:r})}static async _forOperation(e,r,l){await e._updateTokensIfNecessary(l,!0);const u=yk(l);return new Kf({user:e,providerId:u,_tokenResponse:l,operationType:r})}}function yk(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}class Kx extends vh{constructor(e,r,l,u){super(r.code,r.message),this.operationType=l,this.user=u,Object.setPrototypeOf(this,Kx.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:r.customData._serverResponse,operationType:l}}static _fromErrorAndOperation(e,r,l,u){return new Kx(e,r,l,u)}}function gR(t,e,r,l){return(e==="reauthenticate"?r._getReauthenticationResolver(t):r._getIdTokenResponse(t)).catch(m=>{throw m.code==="auth/multi-factor-auth-required"?Kx._fromErrorAndOperation(t,m,e,l):m})}async function YU(t,e,r=!1){const l=await Dy(t,e._linkToIdToken(t.auth,await t.getIdToken()),r);return Kf._forOperation(t,"link",l)}async function JU(t,e,r=!1){const{auth:l}=t;if(Ul(l.app))return Promise.reject(Hu(l));const u="reauthenticate";try{const m=await Dy(t,gR(l,u,e,t),r);Un(m.idToken,l,"internal-error");const v=nT(m.idToken);Un(v,l,"internal-error");const{sub:b}=v;return Un(t.uid===b,l,"user-mismatch"),Kf._forOperation(t,u,m)}catch(m){throw m?.code==="auth/user-not-found"&&Wl(l,"user-mismatch"),m}}async function yR(t,e,r=!1){if(Ul(t.app))return Promise.reject(Hu(t));const l="signIn",u=await gR(t,l,e),m=await Kf._fromIdTokenResponse(t,l,u);return r||await t._updateCurrentUser(m.user),m}async function QU(t,e){return yR(sp(t),e)}async function _R(t){const e=sp(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function e$(t,e,r){if(Ul(t.app))return Promise.reject(Hu(t));const l=sp(t),v=await Nw(l,{returnSecureToken:!0,email:e,password:r,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",KU).catch(a=>{throw a.code==="auth/password-does-not-meet-requirements"&&_R(t),a}),b=await Kf._fromIdTokenResponse(l,"signIn",v);return await l._updateCurrentUser(b.user),b}function t$(t,e,r){return Ul(t.app)?Promise.reject(Hu(t)):QU(td(t),Ym.credential(e,r)).catch(async l=>{throw l.code==="auth/password-does-not-meet-requirements"&&_R(t),l})}function n$(t,e,r,l){return td(t).onIdTokenChanged(e,r,l)}function r$(t,e,r){return td(t).beforeAuthStateChanged(e,r)}function i$(t,e,r,l){return td(t).onAuthStateChanged(e,r,l)}function s$(t){return td(t).signOut()}const Yx="__sak";class xR{constructor(e,r){this.storageRetriever=e,this.type=r}_isAvailable(){try{return this.storage?(this.storage.setItem(Yx,"1"),this.storage.removeItem(Yx),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,r){return this.storage.setItem(e,JSON.stringify(r)),Promise.resolve()}_get(e){const r=this.storage.getItem(e);return Promise.resolve(r?JSON.parse(r):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}const o$=1e3,a$=10;class vR extends xR{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,r)=>this.onStorageEvent(e,r),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=uR(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const r of Object.keys(this.listeners)){const l=this.storage.getItem(r),u=this.localCache[r];l!==u&&e(r,u,l)}}onStorageEvent(e,r=!1){if(!e.key){this.forAllChangedKeys((v,b,a)=>{this.notifyListeners(v,a)});return}const l=e.key;r?this.detachListener():this.stopPolling();const u=()=>{const v=this.storage.getItem(l);!r&&this.localCache[l]===v||this.notifyListeners(l,v)},m=this.storage.getItem(l);SU()&&m!==e.newValue&&e.newValue!==e.oldValue?setTimeout(u,a$):u()}notifyListeners(e,r){this.localCache[e]=r;const l=this.listeners[e];if(l)for(const u of Array.from(l))u(r&&JSON.parse(r))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,r,l)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:r,newValue:l}),!0)})},o$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,r){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,r){await super._set(e,r),this.localCache[e]=JSON.stringify(r)}async _get(e){const r=await super._get(e);return this.localCache[e]=JSON.stringify(r),r}async _remove(e){await super._remove(e),delete this.localCache[e]}}vR.type="LOCAL";const l$=vR;class wR extends xR{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,r){}_removeListener(e,r){}}wR.type="SESSION";const bR=wR;function c$(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(r){return{fulfilled:!1,reason:r}}}))}class Vv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const r=this.receivers.find(u=>u.isListeningto(e));if(r)return r;const l=new Vv(e);return this.receivers.push(l),l}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const r=e,{eventId:l,eventType:u,data:m}=r.data,v=this.handlersMap[u];if(!v?.size)return;r.ports[0].postMessage({status:"ack",eventId:l,eventType:u});const b=Array.from(v).map(async k=>k(r.origin,m)),a=await c$(b);r.ports[0].postMessage({status:"done",eventId:l,eventType:u,response:a})}_subscribe(e,r){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(r)}_unsubscribe(e,r){this.handlersMap[e]&&r&&this.handlersMap[e].delete(r),(!r||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}Vv.receivers=[];function oT(t="",e=10){let r="";for(let l=0;l<e;l++)r+=Math.floor(Math.random()*10);return t+r}class u${constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,r,l=50){const u=typeof MessageChannel<"u"?new MessageChannel:null;if(!u)throw new Error("connection_unavailable");let m,v;return new Promise((b,a)=>{const k=oT("",20);u.port1.start();const M=setTimeout(()=>{a(new Error("unsupported_event"))},l);v={messageChannel:u,onMessage(L){const z=L;if(z.data.eventId===k)switch(z.data.status){case"ack":clearTimeout(M),m=setTimeout(()=>{a(new Error("timeout"))},3e3);break;case"done":clearTimeout(m),b(z.data.response);break;default:clearTimeout(M),clearTimeout(m),a(new Error("invalid_response"));break}}},this.handlers.add(v),u.port1.addEventListener("message",v.onMessage),this.target.postMessage({eventType:e,eventId:k,data:r},[u.port2])}).finally(()=>{v&&this.removeMessageHandler(v)})}}function Wc(){return window}function d$(t){Wc().location.href=t}function TR(){return typeof Wc().WorkerGlobalScope<"u"&&typeof Wc().importScripts=="function"}async function h$(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function f$(){return navigator?.serviceWorker?.controller||null}function p$(){return TR()?self:null}const SR="firebaseLocalStorageDb",m$=1,Jx="firebaseLocalStorage",ER="fbase_key";class s_{constructor(e){this.request=e}toPromise(){return new Promise((e,r)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{r(this.request.error)})})}}function Uv(t,e){return t.transaction([Jx],e?"readwrite":"readonly").objectStore(Jx)}function g$(){const t=indexedDB.deleteDatabase(SR);return new s_(t).toPromise()}function Dw(){const t=indexedDB.open(SR,m$);return new Promise((e,r)=>{t.addEventListener("error",()=>{r(t.error)}),t.addEventListener("upgradeneeded",()=>{const l=t.result;try{l.createObjectStore(Jx,{keyPath:ER})}catch(u){r(u)}}),t.addEventListener("success",async()=>{const l=t.result;l.objectStoreNames.contains(Jx)?e(l):(l.close(),await g$(),e(await Dw()))})})}async function _k(t,e,r){const l=Uv(t,!0).put({[ER]:e,value:r});return new s_(l).toPromise()}async function y$(t,e){const r=Uv(t,!1).get(e),l=await new s_(r).toPromise();return l===void 0?null:l.value}function xk(t,e){const r=Uv(t,!0).delete(e);return new s_(r).toPromise()}const _$=800,x$=3;class CR{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Dw(),this.db)}async _withRetries(e){let r=0;for(;;)try{const l=await this._openDb();return await e(l)}catch(l){if(r++>x$)throw l;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return TR()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Vv._getInstance(p$()),this.receiver._subscribe("keyChanged",async(e,r)=>({keyProcessed:(await this._poll()).includes(r.key)})),this.receiver._subscribe("ping",async(e,r)=>["keyChanged"])}async initializeSender(){if(this.activeServiceWorker=await h$(),!this.activeServiceWorker)return;this.sender=new u$(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||f$()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Dw();return await _k(e,Yx,"1"),await xk(e,Yx),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,r){return this._withPendingWrite(async()=>(await this._withRetries(l=>_k(l,e,r)),this.localCache[e]=r,this.notifyServiceWorker(e)))}async _get(e){const r=await this._withRetries(l=>y$(l,e));return this.localCache[e]=r,r}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(r=>xk(r,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(u=>{const m=Uv(u,!1).getAll();return new s_(m).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const r=[],l=new Set;if(e.length!==0)for(const{fbase_key:u,value:m}of e)l.add(u),JSON.stringify(this.localCache[u])!==JSON.stringify(m)&&(this.notifyListeners(u,m),r.push(u));for(const u of Object.keys(this.localCache))this.localCache[u]&&!l.has(u)&&(this.notifyListeners(u,null),r.push(u));return r}notifyListeners(e,r){this.localCache[e]=r;const l=this.listeners[e];if(l)for(const u of Array.from(l))u(r)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),_$)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,r){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(r)}_removeListener(e,r){this.listeners[e]&&(this.listeners[e].delete(r),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}CR.type="LOCAL";const v$=CR;new n_(3e4,6e4);function w$(t,e){return e?Gu(e):(Un(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}class aT extends iT{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Im(e,this._buildIdpRequest())}_linkToIdToken(e,r){return Im(e,this._buildIdpRequest(r))}_getReauthenticationResolver(e){return Im(e,this._buildIdpRequest())}_buildIdpRequest(e){const r={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(r.idToken=e),r}}function b$(t){return yR(t.auth,new aT(t),t.bypassAuthState)}function T$(t){const{auth:e,user:r}=t;return Un(r,e,"internal-error"),JU(r,new aT(t),t.bypassAuthState)}async function S$(t){const{auth:e,user:r}=t;return Un(r,e,"internal-error"),YU(r,new aT(t),t.bypassAuthState)}class kR{constructor(e,r,l,u,m=!1){this.auth=e,this.resolver=l,this.user=u,this.bypassAuthState=m,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(r)?r:[r]}execute(){return new Promise(async(e,r)=>{this.pendingPromise={resolve:e,reject:r};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(l){this.reject(l)}})}async onAuthEvent(e){const{urlResponse:r,sessionId:l,postBody:u,tenantId:m,error:v,type:b}=e;if(v){this.reject(v);return}const a={auth:this.auth,requestUri:r,sessionId:l,tenantId:m||void 0,postBody:u||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(b)(a))}catch(k){this.reject(k)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return b$;case"linkViaPopup":case"linkViaRedirect":return S$;case"reauthViaPopup":case"reauthViaRedirect":return T$;default:Wl(this.auth,"internal-error")}}resolve(e){Ku(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){Ku(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const E$=new n_(2e3,1e4);class xm extends kR{constructor(e,r,l,u,m){super(e,r,u,m),this.provider=l,this.authWindow=null,this.pollId=null,xm.currentPopupAction&&xm.currentPopupAction.cancel(),xm.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Un(e,this.auth,"internal-error"),e}async onExecution(){Ku(this.filter.length===1,"Popup operations only handle one event");const e=oT();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(r=>{this.reject(r)}),this.resolver._isIframeWebStorageSupported(this.auth,r=>{r||this.reject(Hc(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(Hc(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,xm.currentPopupAction=null}pollUserCancellation(){const e=()=>{if(this.authWindow?.window?.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Hc(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,E$.get())};e()}}xm.currentPopupAction=null;const C$="pendingRedirect",Ax=new Map;class k$ extends kR{constructor(e,r,l=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],r,void 0,l),this.eventId=null}async execute(){let e=Ax.get(this.auth._key());if(!e){try{const l=await A$(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(l)}catch(r){e=()=>Promise.reject(r)}Ax.set(this.auth._key(),e)}return this.bypassAuthState||Ax.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const r=await this.auth._redirectUserForId(e.eventId);if(r)return this.user=r,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function A$(t,e){const r=P$(e),l=M$(t);if(!await l._isAvailable())return!1;const u=await l._get(r)==="true";return await l._remove(r),u}function I$(t,e){Ax.set(t._key(),e)}function M$(t){return Gu(t._redirectPersistence)}function P$(t){return kx(C$,t.config.apiKey,t.name)}async function R$(t,e,r=!1){if(Ul(t.app))return Promise.reject(Hu(t));const l=sp(t),u=w$(l,e),v=await new k$(l,u,r).execute();return v&&!r&&(delete v.user._redirectEventId,await l._persistUserIfCurrent(v.user),await l._setRedirectUser(null,e)),v}const N$=600*1e3;class D${constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let r=!1;return this.consumers.forEach(l=>{this.isEventForConsumer(e,l)&&(r=!0,this.sendToConsumer(e,l),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!L$(e)||(this.hasHandledPotentialRedirect=!0,r||(this.queuedRedirectEvent=e,r=!0)),r}sendToConsumer(e,r){if(e.error&&!AR(e)){const l=e.error.code?.split("auth/")[1]||"internal-error";r.onError(Hc(this.auth,l))}else r.onAuthEvent(e)}isEventForConsumer(e,r){const l=r.eventId===null||!!e.eventId&&e.eventId===r.eventId;return r.filter.includes(e.type)&&l}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=N$&&this.cachedEventUids.clear(),this.cachedEventUids.has(vk(e))}saveEventToCache(e){this.cachedEventUids.add(vk(e)),this.lastProcessedEventTime=Date.now()}}function vk(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function AR({type:t,error:e}){return t==="unknown"&&e?.code==="auth/no-auth-event"}function L$(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return AR(t);default:return!1}}async function j$(t,e={}){return bh(t,"GET","/v1/projects",e)}const O$=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,z$=/^https?/;async function B$(t){if(t.config.emulator)return;const{authorizedDomains:e}=await j$(t);for(const r of e)try{if(F$(r))return}catch{}Wl(t,"unauthorized-domain")}function F$(t){const e=Pw(),{protocol:r,hostname:l}=new URL(e);if(t.startsWith("chrome-extension://")){const v=new URL(t);return v.hostname===""&&l===""?r==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):r==="chrome-extension:"&&v.hostname===l}if(!z$.test(r))return!1;if(O$.test(t))return l===t;const u=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+u+"|"+u+")$","i").test(l)}const V$=new n_(3e4,6e4);function wk(){const t=Wc().___jsl;if(t?.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let r=0;r<t.CP.length;r++)t.CP[r]=null}}function U$(t){return new Promise((e,r)=>{function l(){wk(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{wk(),r(Hc(t,"network-request-failed"))},timeout:V$.get()})}if(Wc().gapi?.iframes?.Iframe)e(gapi.iframes.getContext());else if(Wc().gapi?.load)l();else{const u=NU("iframefcb");return Wc()[u]=()=>{gapi.load?l():r(Hc(t,"network-request-failed"))},hR(`${RU()}?onload=${u}`).catch(m=>r(m))}}).catch(e=>{throw Ix=null,e})}let Ix=null;function $$(t){return Ix=Ix||U$(t),Ix}const G$=new n_(5e3,15e3),H$="__/auth/iframe",W$="emulator/auth/iframe",q$={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},Z$=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function X$(t){const e=t.config;Un(e.authDomain,t,"auth-domain-config-required");const r=e.emulator?tT(e,W$):`https://${t.config.authDomain}/${H$}`,l={apiKey:e.apiKey,appName:t.name,v:t_},u=Z$.get(t.config.apiHost);u&&(l.eid=u);const m=t._getFrameworks();return m.length&&(l.fw=m.join(",")),`${r}?${e_(l).slice(1)}`}async function K$(t){const e=await $$(t),r=Wc().gapi;return Un(r,t,"internal-error"),e.open({where:document.body,url:X$(t),messageHandlersFilter:r.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:q$,dontclear:!0},l=>new Promise(async(u,m)=>{await l.restyle({setHideOnLeave:!1});const v=Hc(t,"network-request-failed"),b=Wc().setTimeout(()=>{m(v)},G$.get());function a(){Wc().clearTimeout(b),u(l)}l.ping(a).then(a,()=>{m(v)})}))}const Y$={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},J$=500,Q$=600,e2="_blank",t2="http://localhost";class bk{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function n2(t,e,r,l=J$,u=Q$){const m=Math.max((window.screen.availHeight-u)/2,0).toString(),v=Math.max((window.screen.availWidth-l)/2,0).toString();let b="";const a={...Y$,width:l.toString(),height:u.toString(),top:m,left:v},k=Lo().toLowerCase();r&&(b=sR(k)?e2:r),rR(k)&&(e=e||t2,a.scrollbars="yes");const M=Object.entries(a).reduce((z,[O,K])=>`${z}${O}=${K},`,"");if(TU(k)&&b!=="_self")return r2(e||"",b),new bk(null);const L=window.open(e||"",b,M);Un(L,t,"popup-blocked");try{L.focus()}catch{}return new bk(L)}function r2(t,e){const r=document.createElement("a");r.href=t,r.target=e;const l=document.createEvent("MouseEvent");l.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),r.dispatchEvent(l)}const i2="__/auth/handler",s2="emulator/auth/handler",o2=encodeURIComponent("fac");async function Tk(t,e,r,l,u,m){Un(t.config.authDomain,t,"auth-domain-config-required"),Un(t.config.apiKey,t,"invalid-api-key");const v={apiKey:t.config.apiKey,appName:t.name,authType:r,redirectUrl:l,v:t_,eventId:u};if(e instanceof mR){e.setDefaultLanguage(t.languageCode),v.providerId=e.providerId||"",GV(e.getCustomParameters())||(v.customParameters=JSON.stringify(e.getCustomParameters()));for(const[M,L]of Object.entries({}))v[M]=L}if(e instanceof i_){const M=e.getScopes().filter(L=>L!=="");M.length>0&&(v.scopes=M.join(","))}t.tenantId&&(v.tid=t.tenantId);const b=v;for(const M of Object.keys(b))b[M]===void 0&&delete b[M];const a=await t._getAppCheckToken(),k=a?`#${o2}=${encodeURIComponent(a)}`:"";return`${a2(t)}?${e_(b).slice(1)}${k}`}function a2({config:t}){return t.emulator?tT(t,s2):`https://${t.authDomain}/${i2}`}const E1="webStorageSupport";class l2{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=bR,this._completeRedirectFn=R$,this._overrideRedirectResult=I$}async _openPopup(e,r,l,u){Ku(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");const m=await Tk(e,r,l,Pw(),u);return n2(e,m,oT())}async _openRedirect(e,r,l,u){await this._originValidation(e);const m=await Tk(e,r,l,Pw(),u);return d$(m),new Promise(()=>{})}_initialize(e){const r=e._key();if(this.eventManagers[r]){const{manager:u,promise:m}=this.eventManagers[r];return u?Promise.resolve(u):(Ku(m,"If manager is not set, promise should be"),m)}const l=this.initAndGetManager(e);return this.eventManagers[r]={promise:l},l.catch(()=>{delete this.eventManagers[r]}),l}async initAndGetManager(e){const r=await K$(e),l=new D$(e);return r.register("authEvent",u=>(Un(u?.authEvent,e,"invalid-auth-event"),{status:l.onEvent(u.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:l},this.iframes[e._key()]=r,l}_isIframeWebStorageSupported(e,r){this.iframes[e._key()].send(E1,{type:E1},u=>{const m=u?.[0]?.[E1];m!==void 0&&r(!!m),Wl(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const r=e._key();return this.originValidationPromises[r]||(this.originValidationPromises[r]=B$(e)),this.originValidationPromises[r]}get _shouldInitProactively(){return uR()||iR()||rT()}}const c2=l2;var Sk="@firebase/auth",Ek="1.12.0";class u2{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const r=this.auth.onIdTokenChanged(l=>{e(l?.stsTokenManager.accessToken||null)});this.internalListeners.set(e,r),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const r=this.internalListeners.get(e);r&&(this.internalListeners.delete(e),r(),this.updateProactiveRefresh())}assertAuthConfigured(){Un(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}function d2(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function h2(t){Ry(new Om("auth",(e,{options:r})=>{const l=e.getProvider("app").getImmediate(),u=e.getProvider("heartbeat"),m=e.getProvider("app-check-internal"),{apiKey:v,authDomain:b}=l.options;Un(v&&!v.includes(":"),"invalid-api-key",{appName:l.name});const a={apiKey:v,authDomain:b,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:dR(t)},k=new IU(l,u,m,a);return BU(k,r),k},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,r,l)=>{e.getProvider("auth-internal").initialize()})),Ry(new Om("auth-internal",e=>{const r=sp(e.getProvider("auth").getImmediate());return(l=>new u2(l))(r)},"PRIVATE").setInstantiationMode("EXPLICIT")),Cm(Sk,Ek,d2(t)),Cm(Sk,Ek,"esm2020")}const f2=300,p2=VP("authIdTokenMaxAge")||f2;let Ck=null;const m2=t=>async e=>{const r=e&&await e.getIdTokenResult(),l=r&&(new Date().getTime()-Date.parse(r.issuedAtTime))/1e3;if(l&&l>p2)return;const u=r?.token;Ck!==u&&(Ck=u,await fetch(t,{method:u?"POST":"DELETE",headers:u?{Authorization:`Bearer ${u}`}:{}}))};function g2(t=W8()){const e=HP(t,"auth");if(e.isInitialized())return e.getImmediate();const r=zU(t,{popupRedirectResolver:c2,persistence:[v$,l$,bR]}),l=VP("authTokenSyncURL");if(l&&typeof isSecureContext=="boolean"&&isSecureContext){const m=new URL(l,location.origin);if(location.origin===m.origin){const v=m2(m.toString());r$(r,v,()=>v(r.currentUser)),n$(r,b=>v(b))}}const u=AV("auth");return u&&FU(r,`http://${u}`),r}function y2(){return document.getElementsByTagName("head")?.[0]??document}MU({loadJS(t){return new Promise((e,r)=>{const l=document.createElement("script");l.setAttribute("src",t),l.onload=e,l.onerror=u=>{const m=Hc("internal-error");m.customData=u,r(m)},l.type="text/javascript",l.charset="UTF-8",y2().appendChild(l)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});h2("Browser");var _2="firebase",x2="12.8.0";Cm(_2,x2,"app");const v2={apiKey:"AIzaSyAJHXB1tqt3VtZZ1qrEQR0NpPDBEjId9tk",authDomain:"winged-ray-485505-m3.firebaseapp.com",projectId:"winged-ray-485505-m3",storageBucket:"winged-ray-485505-m3.firebasestorage.app",messagingSenderId:"1067502227654",appId:"1:1067502227654:web:c784f33fc7d56a56f207c7"},w2=WP(v2),cx=g2(w2),IR=P.createContext(void 0),b2=({children:t})=>{const[e,r]=P.useState(null),[l,u]=P.useState(!0);P.useEffect(()=>{const a=i$(cx,k=>{r(k),u(!1)});return()=>a()},[]);const m=async(a,k)=>{try{return await t$(cx,a,k),Ht.success("ng nhp thnh cng"),{error:null}}catch(M){return console.error(M),Ht.error("ng nhp tht bi: "+M.message),{error:M}}},v=async(a,k)=>{try{return await e$(cx,a,k),Ht.success("ng k thnh cng! Hy ng nhp ngay."),{error:null}}catch(M){return console.error(M),Ht.error("ng k tht bi: "+M.message),{error:M}}},b=async()=>{try{await s$(cx),Ht.success(" ng xut")}catch(a){Ht.error(a.message)}};return x.jsx(IR.Provider,{value:{user:e,isLoading:l,signIn:m,signUp:v,signOut:b},children:t})},Oo=()=>{const t=P.useContext(IR);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},lT=P.createContext({});function op(t){const e=P.useRef(null);return e.current===null&&(e.current=t()),e.current}const MR=typeof window<"u",cT=MR?P.useLayoutEffect:P.useEffect,$v=P.createContext(null);function uT(t,e){t.indexOf(e)===-1&&t.push(e)}function dT(t,e){const r=t.indexOf(e);r>-1&&t.splice(r,1)}function T2([...t],e,r){const l=e<0?t.length+e:e;if(l>=0&&l<t.length){const u=r<0?t.length+r:r,[m]=t.splice(e,1);t.splice(u,0,m)}return t}const Kc=(t,e,r)=>r>e?e:r<t?t:r;let hT=()=>{};const Yu={},PR=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function RR(t){return typeof t=="object"&&t!==null}const NR=t=>/^0[^.\s]+$/u.test(t);function fT(t){let e;return()=>(e===void 0&&(e=t()),e)}const rl=t=>t,S2=(t,e)=>r=>e(t(r)),o_=(...t)=>t.reduce(S2),jy=(t,e,r)=>{const l=e-t;return l===0?1:(r-t)/l};class pT{constructor(){this.subscriptions=[]}add(e){return uT(this.subscriptions,e),()=>dT(this.subscriptions,e)}notify(e,r,l){const u=this.subscriptions.length;if(u)if(u===1)this.subscriptions[0](e,r,l);else for(let m=0;m<u;m++){const v=this.subscriptions[m];v&&v(e,r,l)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Wu=t=>t*1e3,tl=t=>t/1e3;function DR(t,e){return e?t*(1e3/e):0}const LR=(t,e,r)=>(((1-3*r+3*e)*t+(3*r-6*e))*t+3*e)*t,E2=1e-7,C2=12;function k2(t,e,r,l,u){let m,v,b=0;do v=e+(r-e)/2,m=LR(v,l,u)-t,m>0?r=v:e=v;while(Math.abs(m)>E2&&++b<C2);return v}function a_(t,e,r,l){if(t===e&&r===l)return rl;const u=m=>k2(m,0,1,t,r);return m=>m===0||m===1?m:LR(u(m),e,l)}const jR=t=>e=>e<=.5?t(2*e)/2:(2-t(2*(1-e)))/2,OR=t=>e=>1-t(1-e),zR=a_(.33,1.53,.69,.99),mT=OR(zR),BR=jR(mT),FR=t=>(t*=2)<1?.5*mT(t):.5*(2-Math.pow(2,-10*(t-1))),gT=t=>1-Math.sin(Math.acos(t)),VR=OR(gT),UR=jR(gT),A2=a_(.42,0,1,1),I2=a_(0,0,.58,1),$R=a_(.42,0,.58,1),M2=t=>Array.isArray(t)&&typeof t[0]!="number",GR=t=>Array.isArray(t)&&typeof t[0]=="number",P2={linear:rl,easeIn:A2,easeInOut:$R,easeOut:I2,circIn:gT,circInOut:UR,circOut:VR,backIn:mT,backInOut:BR,backOut:zR,anticipate:FR},R2=t=>typeof t=="string",kk=t=>{if(GR(t)){hT(t.length===4);const[e,r,l,u]=t;return a_(e,r,l,u)}else if(R2(t))return P2[t];return t},ux=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function N2(t,e){let r=new Set,l=new Set,u=!1,m=!1;const v=new WeakSet;let b={delta:0,timestamp:0,isProcessing:!1};function a(M){v.has(M)&&(k.schedule(M),t()),M(b)}const k={schedule:(M,L=!1,z=!1)=>{const K=z&&u?r:l;return L&&v.add(M),K.has(M)||K.add(M),M},cancel:M=>{l.delete(M),v.delete(M)},process:M=>{if(b=M,u){m=!0;return}u=!0,[r,l]=[l,r],r.forEach(a),r.clear(),u=!1,m&&(m=!1,k.process(M))}};return k}const D2=40;function HR(t,e){let r=!1,l=!0;const u={delta:0,timestamp:0,isProcessing:!1},m=()=>r=!0,v=ux.reduce((ie,pe)=>(ie[pe]=N2(m),ie),{}),{setup:b,read:a,resolveKeyframes:k,preUpdate:M,update:L,preRender:z,render:O,postRender:K}=v,H=()=>{const ie=Yu.useManualTiming?u.timestamp:performance.now();r=!1,Yu.useManualTiming||(u.delta=l?1e3/60:Math.max(Math.min(ie-u.timestamp,D2),1)),u.timestamp=ie,u.isProcessing=!0,b.process(u),a.process(u),k.process(u),M.process(u),L.process(u),z.process(u),O.process(u),K.process(u),u.isProcessing=!1,r&&e&&(l=!1,t(H))},Z=()=>{r=!0,l=!0,u.isProcessing||t(H)};return{schedule:ux.reduce((ie,pe)=>{const we=v[pe];return ie[pe]=(ke,ze=!1,Ge=!1)=>(r||Z(),we.schedule(ke,ze,Ge)),ie},{}),cancel:ie=>{for(let pe=0;pe<ux.length;pe++)v[ux[pe]].cancel(ie)},state:u,steps:v}}const{schedule:ei,cancel:Ju,state:Ws,steps:C1}=HR(typeof requestAnimationFrame<"u"?requestAnimationFrame:rl,!0);let Mx;function L2(){Mx=void 0}const No={now:()=>(Mx===void 0&&No.set(Ws.isProcessing||Yu.useManualTiming?Ws.timestamp:performance.now()),Mx),set:t=>{Mx=t,queueMicrotask(L2)}},WR=t=>e=>typeof e=="string"&&e.startsWith(t),qR=WR("--"),j2=WR("var(--"),yT=t=>j2(t)?O2.test(t.split("/*")[0].trim()):!1,O2=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu;function Ak(t){return typeof t!="string"?!1:t.split("/*")[0].includes("var(--")}const Jm={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},Oy={...Jm,transform:t=>Kc(0,1,t)},dx={...Jm,default:1},_y=t=>Math.round(t*1e5)/1e5,_T=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function z2(t){return t==null}const B2=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,xT=(t,e)=>r=>!!(typeof r=="string"&&B2.test(r)&&r.startsWith(t)||e&&!z2(r)&&Object.prototype.hasOwnProperty.call(r,e)),ZR=(t,e,r)=>l=>{if(typeof l!="string")return l;const[u,m,v,b]=l.match(_T);return{[t]:parseFloat(u),[e]:parseFloat(m),[r]:parseFloat(v),alpha:b!==void 0?parseFloat(b):1}},F2=t=>Kc(0,255,t),k1={...Jm,transform:t=>Math.round(F2(t))},zf={test:xT("rgb","red"),parse:ZR("red","green","blue"),transform:({red:t,green:e,blue:r,alpha:l=1})=>"rgba("+k1.transform(t)+", "+k1.transform(e)+", "+k1.transform(r)+", "+_y(Oy.transform(l))+")"};function V2(t){let e="",r="",l="",u="";return t.length>5?(e=t.substring(1,3),r=t.substring(3,5),l=t.substring(5,7),u=t.substring(7,9)):(e=t.substring(1,2),r=t.substring(2,3),l=t.substring(3,4),u=t.substring(4,5),e+=e,r+=r,l+=l,u+=u),{red:parseInt(e,16),green:parseInt(r,16),blue:parseInt(l,16),alpha:u?parseInt(u,16)/255:1}}const Lw={test:xT("#"),parse:V2,transform:zf.transform},l_=t=>({test:e=>typeof e=="string"&&e.endsWith(t)&&e.split(" ").length===1,parse:parseFloat,transform:e=>`${e}${t}`}),Kd=l_("deg"),qc=l_("%"),gn=l_("px"),U2=l_("vh"),$2=l_("vw"),Ik={...qc,parse:t=>qc.parse(t)/100,transform:t=>qc.transform(t*100)},vm={test:xT("hsl","hue"),parse:ZR("hue","saturation","lightness"),transform:({hue:t,saturation:e,lightness:r,alpha:l=1})=>"hsla("+Math.round(t)+", "+qc.transform(_y(e))+", "+qc.transform(_y(r))+", "+_y(Oy.transform(l))+")"},ns={test:t=>zf.test(t)||Lw.test(t)||vm.test(t),parse:t=>zf.test(t)?zf.parse(t):vm.test(t)?vm.parse(t):Lw.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?zf.transform(t):vm.transform(t),getAnimatableNone:t=>{const e=ns.parse(t);return e.alpha=0,ns.transform(e)}},G2=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function H2(t){return isNaN(t)&&typeof t=="string"&&(t.match(_T)?.length||0)+(t.match(G2)?.length||0)>0}const XR="number",KR="color",W2="var",q2="var(",Mk="${}",Z2=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function zy(t){const e=t.toString(),r=[],l={color:[],number:[],var:[]},u=[];let m=0;const b=e.replace(Z2,a=>(ns.test(a)?(l.color.push(m),u.push(KR),r.push(ns.parse(a))):a.startsWith(q2)?(l.var.push(m),u.push(W2),r.push(a)):(l.number.push(m),u.push(XR),r.push(parseFloat(a))),++m,Mk)).split(Mk);return{values:r,split:b,indexes:l,types:u}}function YR(t){return zy(t).values}function JR(t){const{split:e,types:r}=zy(t),l=e.length;return u=>{let m="";for(let v=0;v<l;v++)if(m+=e[v],u[v]!==void 0){const b=r[v];b===XR?m+=_y(u[v]):b===KR?m+=ns.transform(u[v]):m+=u[v]}return m}}const X2=t=>typeof t=="number"?0:ns.test(t)?ns.getAnimatableNone(t):t;function K2(t){const e=YR(t);return JR(t)(e.map(X2))}const mh={test:H2,parse:YR,createTransformer:JR,getAnimatableNone:K2};function A1(t,e,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?t+(e-t)*6*r:r<1/2?e:r<2/3?t+(e-t)*(2/3-r)*6:t}function Y2({hue:t,saturation:e,lightness:r,alpha:l}){t/=360,e/=100,r/=100;let u=0,m=0,v=0;if(!e)u=m=v=r;else{const b=r<.5?r*(1+e):r+e-r*e,a=2*r-b;u=A1(a,b,t+1/3),m=A1(a,b,t),v=A1(a,b,t-1/3)}return{red:Math.round(u*255),green:Math.round(m*255),blue:Math.round(v*255),alpha:l}}function Qx(t,e){return r=>r>0?e:t}const yi=(t,e,r)=>t+(e-t)*r,I1=(t,e,r)=>{const l=t*t,u=r*(e*e-l)+l;return u<0?0:Math.sqrt(u)},J2=[Lw,zf,vm],Q2=t=>J2.find(e=>e.test(t));function Pk(t){const e=Q2(t);if(!e)return!1;let r=e.parse(t);return e===vm&&(r=Y2(r)),r}const Rk=(t,e)=>{const r=Pk(t),l=Pk(e);if(!r||!l)return Qx(t,e);const u={...r};return m=>(u.red=I1(r.red,l.red,m),u.green=I1(r.green,l.green,m),u.blue=I1(r.blue,l.blue,m),u.alpha=yi(r.alpha,l.alpha,m),zf.transform(u))},jw=new Set(["none","hidden"]);function e7(t,e){return jw.has(t)?r=>r<=0?t:e:r=>r>=1?e:t}function t7(t,e){return r=>yi(t,e,r)}function vT(t){return typeof t=="number"?t7:typeof t=="string"?yT(t)?Qx:ns.test(t)?Rk:i7:Array.isArray(t)?QR:typeof t=="object"?ns.test(t)?Rk:n7:Qx}function QR(t,e){const r=[...t],l=r.length,u=t.map((m,v)=>vT(m)(m,e[v]));return m=>{for(let v=0;v<l;v++)r[v]=u[v](m);return r}}function n7(t,e){const r={...t,...e},l={};for(const u in r)t[u]!==void 0&&e[u]!==void 0&&(l[u]=vT(t[u])(t[u],e[u]));return u=>{for(const m in l)r[m]=l[m](u);return r}}function r7(t,e){const r=[],l={color:0,var:0,number:0};for(let u=0;u<e.values.length;u++){const m=e.types[u],v=t.indexes[m][l[m]],b=t.values[v]??0;r[u]=b,l[m]++}return r}const i7=(t,e)=>{const r=mh.createTransformer(e),l=zy(t),u=zy(e);return l.indexes.var.length===u.indexes.var.length&&l.indexes.color.length===u.indexes.color.length&&l.indexes.number.length>=u.indexes.number.length?jw.has(t)&&!u.values.length||jw.has(e)&&!l.values.length?e7(t,e):o_(QR(r7(l,u),u.values),r):Qx(t,e)};function eN(t,e,r){return typeof t=="number"&&typeof e=="number"&&typeof r=="number"?yi(t,e,r):vT(t)(t,e)}const s7=t=>{const e=({timestamp:r})=>t(r);return{start:(r=!0)=>ei.update(e,r),stop:()=>Ju(e),now:()=>Ws.isProcessing?Ws.timestamp:No.now()}},tN=(t,e,r=10)=>{let l="";const u=Math.max(Math.round(e/r),2);for(let m=0;m<u;m++)l+=Math.round(t(m/(u-1))*1e4)/1e4+", ";return`linear(${l.substring(0,l.length-2)})`},ev=2e4;function wT(t){let e=0;const r=50;let l=t.next(e);for(;!l.done&&e<ev;)e+=r,l=t.next(e);return e>=ev?1/0:e}function o7(t,e=100,r){const l=r({...t,keyframes:[0,e]}),u=Math.min(wT(l),ev);return{type:"keyframes",ease:m=>l.next(u*m).value/e,duration:tl(u)}}const a7=5;function nN(t,e,r){const l=Math.max(e-a7,0);return DR(r-t(l),e-l)}const zi={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},M1=.001;function l7({duration:t=zi.duration,bounce:e=zi.bounce,velocity:r=zi.velocity,mass:l=zi.mass}){let u,m,v=1-e;v=Kc(zi.minDamping,zi.maxDamping,v),t=Kc(zi.minDuration,zi.maxDuration,tl(t)),v<1?(u=k=>{const M=k*v,L=M*t,z=M-r,O=Ow(k,v),K=Math.exp(-L);return M1-z/O*K},m=k=>{const L=k*v*t,z=L*r+r,O=Math.pow(v,2)*Math.pow(k,2)*t,K=Math.exp(-L),H=Ow(Math.pow(k,2),v);return(-u(k)+M1>0?-1:1)*((z-O)*K)/H}):(u=k=>{const M=Math.exp(-k*t),L=(k-r)*t+1;return-M1+M*L},m=k=>{const M=Math.exp(-k*t),L=(r-k)*(t*t);return M*L});const b=5/t,a=u7(u,m,b);if(t=Wu(t),isNaN(a))return{stiffness:zi.stiffness,damping:zi.damping,duration:t};{const k=Math.pow(a,2)*l;return{stiffness:k,damping:v*2*Math.sqrt(l*k),duration:t}}}const c7=12;function u7(t,e,r){let l=r;for(let u=1;u<c7;u++)l=l-t(l)/e(l);return l}function Ow(t,e){return t*Math.sqrt(1-e*e)}const d7=["duration","bounce"],h7=["stiffness","damping","mass"];function Nk(t,e){return e.some(r=>t[r]!==void 0)}function f7(t){let e={velocity:zi.velocity,stiffness:zi.stiffness,damping:zi.damping,mass:zi.mass,isResolvedFromDuration:!1,...t};if(!Nk(t,h7)&&Nk(t,d7))if(t.visualDuration){const r=t.visualDuration,l=2*Math.PI/(r*1.2),u=l*l,m=2*Kc(.05,1,1-(t.bounce||0))*Math.sqrt(u);e={...e,mass:zi.mass,stiffness:u,damping:m}}else{const r=l7(t);e={...e,...r,mass:zi.mass},e.isResolvedFromDuration=!0}return e}function tv(t=zi.visualDuration,e=zi.bounce){const r=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:e}:t;let{restSpeed:l,restDelta:u}=r;const m=r.keyframes[0],v=r.keyframes[r.keyframes.length-1],b={done:!1,value:m},{stiffness:a,damping:k,mass:M,duration:L,velocity:z,isResolvedFromDuration:O}=f7({...r,velocity:-tl(r.velocity||0)}),K=z||0,H=k/(2*Math.sqrt(a*M)),Z=v-m,Y=tl(Math.sqrt(a/M)),ee=Math.abs(Z)<5;l||(l=ee?zi.restSpeed.granular:zi.restSpeed.default),u||(u=ee?zi.restDelta.granular:zi.restDelta.default);let ie;if(H<1){const we=Ow(Y,H);ie=ke=>{const ze=Math.exp(-H*Y*ke);return v-ze*((K+H*Y*Z)/we*Math.sin(we*ke)+Z*Math.cos(we*ke))}}else if(H===1)ie=we=>v-Math.exp(-Y*we)*(Z+(K+Y*Z)*we);else{const we=Y*Math.sqrt(H*H-1);ie=ke=>{const ze=Math.exp(-H*Y*ke),Ge=Math.min(we*ke,300);return v-ze*((K+H*Y*Z)*Math.sinh(Ge)+we*Z*Math.cosh(Ge))/we}}const pe={calculatedDuration:O&&L||null,next:we=>{const ke=ie(we);if(O)b.done=we>=L;else{let ze=we===0?K:0;H<1&&(ze=we===0?Wu(K):nN(ie,we,ke));const Ge=Math.abs(ze)<=l,tt=Math.abs(v-ke)<=u;b.done=Ge&&tt}return b.value=b.done?v:ke,b},toString:()=>{const we=Math.min(wT(pe),ev),ke=tN(ze=>pe.next(we*ze).value,we,30);return we+"ms "+ke},toTransition:()=>{}};return pe}tv.applyToOptions=t=>{const e=o7(t,100,tv);return t.ease=e.ease,t.duration=Wu(e.duration),t.type="keyframes",t};function zw({keyframes:t,velocity:e=0,power:r=.8,timeConstant:l=325,bounceDamping:u=10,bounceStiffness:m=500,modifyTarget:v,min:b,max:a,restDelta:k=.5,restSpeed:M}){const L=t[0],z={done:!1,value:L},O=Ge=>b!==void 0&&Ge<b||a!==void 0&&Ge>a,K=Ge=>b===void 0?a:a===void 0||Math.abs(b-Ge)<Math.abs(a-Ge)?b:a;let H=r*e;const Z=L+H,Y=v===void 0?Z:v(Z);Y!==Z&&(H=Y-L);const ee=Ge=>-H*Math.exp(-Ge/l),ie=Ge=>Y+ee(Ge),pe=Ge=>{const tt=ee(Ge),Pe=ie(Ge);z.done=Math.abs(tt)<=k,z.value=z.done?Y:Pe};let we,ke;const ze=Ge=>{O(z.value)&&(we=Ge,ke=tv({keyframes:[z.value,K(z.value)],velocity:nN(ie,Ge,z.value),damping:u,stiffness:m,restDelta:k,restSpeed:M}))};return ze(0),{calculatedDuration:null,next:Ge=>{let tt=!1;return!ke&&we===void 0&&(tt=!0,pe(Ge),ze(Ge)),we!==void 0&&Ge>=we?ke.next(Ge-we):(!tt&&pe(Ge),z)}}}function p7(t,e,r){const l=[],u=r||Yu.mix||eN,m=t.length-1;for(let v=0;v<m;v++){let b=u(t[v],t[v+1]);if(e){const a=Array.isArray(e)?e[v]||rl:e;b=o_(a,b)}l.push(b)}return l}function rN(t,e,{clamp:r=!0,ease:l,mixer:u}={}){const m=t.length;if(hT(m===e.length),m===1)return()=>e[0];if(m===2&&e[0]===e[1])return()=>e[1];const v=t[0]===t[1];t[0]>t[m-1]&&(t=[...t].reverse(),e=[...e].reverse());const b=p7(e,l,u),a=b.length,k=M=>{if(v&&M<t[0])return e[0];let L=0;if(a>1)for(;L<t.length-2&&!(M<t[L+1]);L++);const z=jy(t[L],t[L+1],M);return b[L](z)};return r?M=>k(Kc(t[0],t[m-1],M)):k}function m7(t,e){const r=t[t.length-1];for(let l=1;l<=e;l++){const u=jy(0,e,l);t.push(yi(r,1,u))}}function g7(t){const e=[0];return m7(e,t.length-1),e}function y7(t,e){return t.map(r=>r*e)}function _7(t,e){return t.map(()=>e||$R).splice(0,t.length-1)}function xy({duration:t=300,keyframes:e,times:r,ease:l="easeInOut"}){const u=M2(l)?l.map(kk):kk(l),m={done:!1,value:e[0]},v=y7(r&&r.length===e.length?r:g7(e),t),b=rN(v,e,{ease:Array.isArray(u)?u:_7(e,u)});return{calculatedDuration:t,next:a=>(m.value=b(a),m.done=a>=t,m)}}const x7=t=>t!==null;function bT(t,{repeat:e,repeatType:r="loop"},l,u=1){const m=t.filter(x7),b=u<0||e&&r!=="loop"&&e%2===1?0:m.length-1;return!b||l===void 0?m[b]:l}const v7={decay:zw,inertia:zw,tween:xy,keyframes:xy,spring:tv};function iN(t){typeof t.type=="string"&&(t.type=v7[t.type])}class TT{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(e=>{this.resolve=e})}notifyFinished(){this.resolve()}then(e,r){return this.finished.then(e,r)}}const w7=t=>t/100;class ST extends TT{constructor(e){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:r}=this.options;r&&r.updatedAt!==No.now()&&this.tick(No.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),this.options.onStop?.())},this.options=e,this.initAnimation(),this.play(),e.autoplay===!1&&this.pause()}initAnimation(){const{options:e}=this;iN(e);const{type:r=xy,repeat:l=0,repeatDelay:u=0,repeatType:m,velocity:v=0}=e;let{keyframes:b}=e;const a=r||xy;a!==xy&&typeof b[0]!="number"&&(this.mixKeyframes=o_(w7,eN(b[0],b[1])),b=[0,100]);const k=a({...e,keyframes:b});m==="mirror"&&(this.mirroredGenerator=a({...e,keyframes:[...b].reverse(),velocity:-v})),k.calculatedDuration===null&&(k.calculatedDuration=wT(k));const{calculatedDuration:M}=k;this.calculatedDuration=M,this.resolvedDuration=M+u,this.totalDuration=this.resolvedDuration*(l+1)-u,this.generator=k}updateTime(e){const r=Math.round(e-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=r}tick(e,r=!1){const{generator:l,totalDuration:u,mixKeyframes:m,mirroredGenerator:v,resolvedDuration:b,calculatedDuration:a}=this;if(this.startTime===null)return l.next(0);const{delay:k=0,keyframes:M,repeat:L,repeatType:z,repeatDelay:O,type:K,onUpdate:H,finalKeyframe:Z}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,e):this.speed<0&&(this.startTime=Math.min(e-u/this.speed,this.startTime)),r?this.currentTime=e:this.updateTime(e);const Y=this.currentTime-k*(this.playbackSpeed>=0?1:-1),ee=this.playbackSpeed>=0?Y<0:Y>u;this.currentTime=Math.max(Y,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=u);let ie=this.currentTime,pe=l;if(L){const Ge=Math.min(this.currentTime,u)/b;let tt=Math.floor(Ge),Pe=Ge%1;!Pe&&Ge>=1&&(Pe=1),Pe===1&&tt--,tt=Math.min(tt,L+1),tt%2&&(z==="reverse"?(Pe=1-Pe,O&&(Pe-=O/b)):z==="mirror"&&(pe=v)),ie=Kc(0,1,Pe)*b}const we=ee?{done:!1,value:M[0]}:pe.next(ie);m&&(we.value=m(we.value));let{done:ke}=we;!ee&&a!==null&&(ke=this.playbackSpeed>=0?this.currentTime>=u:this.currentTime<=0);const ze=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&ke);return ze&&K!==zw&&(we.value=bT(M,this.options,Z,this.speed)),H&&H(we.value),ze&&this.finish(),we}then(e,r){return this.finished.then(e,r)}get duration(){return tl(this.calculatedDuration)}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+tl(e)}get time(){return tl(this.currentTime)}set time(e){e=Wu(e),this.currentTime=e,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=e:this.driver&&(this.startTime=this.driver.now()-e/this.playbackSpeed),this.driver?.start(!1)}get speed(){return this.playbackSpeed}set speed(e){this.updateTime(No.now());const r=this.playbackSpeed!==e;this.playbackSpeed=e,r&&(this.time=tl(this.currentTime))}play(){if(this.isStopped)return;const{driver:e=s7,startTime:r}=this.options;this.driver||(this.driver=e(u=>this.tick(u))),this.options.onPlay?.();const l=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=l):this.holdTime!==null?this.startTime=l-this.holdTime:this.startTime||(this.startTime=r??l),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(No.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.notifyFinished(),this.teardown(),this.state="finished",this.options.onComplete?.()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),this.options.onCancel?.()}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(e){return this.startTime=0,this.tick(e,!0)}attachTimeline(e){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),this.driver?.stop(),e.observe(this)}}function b7(t){for(let e=1;e<t.length;e++)t[e]??(t[e]=t[e-1])}const Bf=t=>t*180/Math.PI,Bw=t=>{const e=Bf(Math.atan2(t[1],t[0]));return Fw(e)},T7={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Bw,rotateZ:Bw,skewX:t=>Bf(Math.atan(t[1])),skewY:t=>Bf(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Fw=t=>(t=t%360,t<0&&(t+=360),t),Dk=Bw,Lk=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),jk=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),S7={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:Lk,scaleY:jk,scale:t=>(Lk(t)+jk(t))/2,rotateX:t=>Fw(Bf(Math.atan2(t[6],t[5]))),rotateY:t=>Fw(Bf(Math.atan2(-t[2],t[0]))),rotateZ:Dk,rotate:Dk,skewX:t=>Bf(Math.atan(t[4])),skewY:t=>Bf(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Vw(t){return t.includes("scale")?1:0}function Uw(t,e){if(!t||t==="none")return Vw(e);const r=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let l,u;if(r)l=S7,u=r;else{const b=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);l=T7,u=b}if(!u)return Vw(e);const m=l[e],v=u[1].split(",").map(C7);return typeof m=="function"?m(v):v[m]}const E7=(t,e)=>{const{transform:r="none"}=getComputedStyle(t);return Uw(r,e)};function C7(t){return parseFloat(t.trim())}const Qm=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],eg=new Set(Qm),Ok=t=>t===Jm||t===gn,k7=new Set(["x","y","z"]),A7=Qm.filter(t=>!k7.has(t));function I7(t){const e=[];return A7.forEach(r=>{const l=t.getValue(r);l!==void 0&&(e.push([r,l.get()]),l.set(r.startsWith("scale")?1:0))}),e}const ih={width:({x:t},{paddingLeft:e="0",paddingRight:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),height:({y:t},{paddingTop:e="0",paddingBottom:r="0"})=>t.max-t.min-parseFloat(e)-parseFloat(r),top:(t,{top:e})=>parseFloat(e),left:(t,{left:e})=>parseFloat(e),bottom:({y:t},{top:e})=>parseFloat(e)+(t.max-t.min),right:({x:t},{left:e})=>parseFloat(e)+(t.max-t.min),x:(t,{transform:e})=>Uw(e,"x"),y:(t,{transform:e})=>Uw(e,"y")};ih.translateX=ih.x;ih.translateY=ih.y;const $f=new Set;let $w=!1,Gw=!1,Hw=!1;function sN(){if(Gw){const t=Array.from($f).filter(l=>l.needsMeasurement),e=new Set(t.map(l=>l.element)),r=new Map;e.forEach(l=>{const u=I7(l);u.length&&(r.set(l,u),l.render())}),t.forEach(l=>l.measureInitialState()),e.forEach(l=>{l.render();const u=r.get(l);u&&u.forEach(([m,v])=>{l.getValue(m)?.set(v)})}),t.forEach(l=>l.measureEndState()),t.forEach(l=>{l.suspendedScrollY!==void 0&&window.scrollTo(0,l.suspendedScrollY)})}Gw=!1,$w=!1,$f.forEach(t=>t.complete(Hw)),$f.clear()}function oN(){$f.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(Gw=!0)})}function M7(){Hw=!0,oN(),sN(),Hw=!1}class ET{constructor(e,r,l,u,m,v=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...e],this.onComplete=r,this.name=l,this.motionValue=u,this.element=m,this.isAsync=v}scheduleResolve(){this.state="scheduled",this.isAsync?($f.add(this),$w||($w=!0,ei.read(oN),ei.resolveKeyframes(sN))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:e,name:r,element:l,motionValue:u}=this;if(e[0]===null){const m=u?.get(),v=e[e.length-1];if(m!==void 0)e[0]=m;else if(l&&r){const b=l.readValue(r,v);b!=null&&(e[0]=b)}e[0]===void 0&&(e[0]=v),u&&m===void 0&&u.set(e[0])}b7(e)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(e=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,e),$f.delete(this)}cancel(){this.state==="scheduled"&&($f.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const P7=t=>t.startsWith("--");function R7(t,e,r){P7(e)?t.style.setProperty(e,r):t.style[e]=r}const N7=fT(()=>window.ScrollTimeline!==void 0),D7={};function L7(t,e){const r=fT(t);return()=>D7[e]??r()}const aN=L7(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),sy=([t,e,r,l])=>`cubic-bezier(${t}, ${e}, ${r}, ${l})`,zk={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:sy([0,.65,.55,1]),circOut:sy([.55,0,1,.45]),backIn:sy([.31,.01,.66,-.59]),backOut:sy([.33,1.53,.69,.99])};function lN(t,e){if(t)return typeof t=="function"?aN()?tN(t,e):"ease-out":GR(t)?sy(t):Array.isArray(t)?t.map(r=>lN(r,e)||zk.easeOut):zk[t]}function j7(t,e,r,{delay:l=0,duration:u=300,repeat:m=0,repeatType:v="loop",ease:b="easeOut",times:a}={},k=void 0){const M={[e]:r};a&&(M.offset=a);const L=lN(b,u);Array.isArray(L)&&(M.easing=L);const z={delay:l,duration:u,easing:Array.isArray(L)?"linear":L,fill:"both",iterations:m+1,direction:v==="reverse"?"alternate":"normal"};return k&&(z.pseudoElement=k),t.animate(M,z)}function cN(t){return typeof t=="function"&&"applyToOptions"in t}function O7({type:t,...e}){return cN(t)&&aN()?t.applyToOptions(e):(e.duration??(e.duration=300),e.ease??(e.ease="easeOut"),e)}class z7 extends TT{constructor(e){if(super(),this.finishedTime=null,this.isStopped=!1,this.manualStartTime=null,!e)return;const{element:r,name:l,keyframes:u,pseudoElement:m,allowFlatten:v=!1,finalKeyframe:b,onComplete:a}=e;this.isPseudoElement=!!m,this.allowFlatten=v,this.options=e,hT(typeof e.type!="string");const k=O7(e);this.animation=j7(r,l,u,k,m),k.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!m){const M=bT(u,this.options,b,this.speed);this.updateMotionValue?this.updateMotionValue(M):R7(r,l,M),this.animation.cancel()}a?.(),this.notifyFinished()}}play(){this.isStopped||(this.manualStartTime=null,this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){this.animation.finish?.()}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:e}=this;e==="idle"||e==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){this.isPseudoElement||this.animation.commitStyles?.()}get duration(){const e=this.animation.effect?.getComputedTiming?.().duration||0;return tl(Number(e))}get iterationDuration(){const{delay:e=0}=this.options||{};return this.duration+tl(e)}get time(){return tl(Number(this.animation.currentTime)||0)}set time(e){this.manualStartTime=null,this.finishedTime=null,this.animation.currentTime=Wu(e)}get speed(){return this.animation.playbackRate}set speed(e){e<0&&(this.finishedTime=null),this.animation.playbackRate=e}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return this.manualStartTime??Number(this.animation.startTime)}set startTime(e){this.manualStartTime=this.animation.startTime=e}attachTimeline({timeline:e,observe:r}){return this.allowFlatten&&this.animation.effect?.updateTiming({easing:"linear"}),this.animation.onfinish=null,e&&N7()?(this.animation.timeline=e,rl):r(this)}}const uN={anticipate:FR,backInOut:BR,circInOut:UR};function B7(t){return t in uN}function F7(t){typeof t.ease=="string"&&B7(t.ease)&&(t.ease=uN[t.ease])}const P1=10;class V7 extends z7{constructor(e){F7(e),iN(e),super(e),e.startTime!==void 0&&(this.startTime=e.startTime),this.options=e}updateMotionValue(e){const{motionValue:r,onUpdate:l,onComplete:u,element:m,...v}=this.options;if(!r)return;if(e!==void 0){r.set(e);return}const b=new ST({...v,autoplay:!1}),a=Math.max(P1,No.now()-this.startTime),k=Kc(0,P1,a-P1);r.setWithVelocity(b.sample(Math.max(0,a-k)).value,b.sample(a).value,k),b.stop()}}const Bk=(t,e)=>e==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(mh.test(t)||t==="0")&&!t.startsWith("url("));function U7(t){const e=t[0];if(t.length===1)return!0;for(let r=0;r<t.length;r++)if(t[r]!==e)return!0}function $7(t,e,r,l){const u=t[0];if(u===null)return!1;if(e==="display"||e==="visibility")return!0;const m=t[t.length-1],v=Bk(u,e),b=Bk(m,e);return!v||!b?!1:U7(t)||(r==="spring"||cN(r))&&l}function Ww(t){t.duration=0,t.type="keyframes"}const G7=new Set(["opacity","clipPath","filter","transform"]),H7=fT(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function W7(t){const{motionValue:e,name:r,repeatDelay:l,repeatType:u,damping:m,type:v}=t;if(!(e?.owner?.current instanceof HTMLElement))return!1;const{onUpdate:a,transformTemplate:k}=e.owner.getProps();return H7()&&r&&G7.has(r)&&(r!=="transform"||!k)&&!a&&!l&&u!=="mirror"&&m!==0&&v!=="inertia"}const q7=40;class Z7 extends TT{constructor({autoplay:e=!0,delay:r=0,type:l="keyframes",repeat:u=0,repeatDelay:m=0,repeatType:v="loop",keyframes:b,name:a,motionValue:k,element:M,...L}){super(),this.stop=()=>{this._animation&&(this._animation.stop(),this.stopTimeline?.()),this.keyframeResolver?.cancel()},this.createdAt=No.now();const z={autoplay:e,delay:r,type:l,repeat:u,repeatDelay:m,repeatType:v,name:a,motionValue:k,element:M,...L},O=M?.KeyframeResolver||ET;this.keyframeResolver=new O(b,(K,H,Z)=>this.onKeyframesResolved(K,H,z,!Z),a,k,M),this.keyframeResolver?.scheduleResolve()}onKeyframesResolved(e,r,l,u){this.keyframeResolver=void 0;const{name:m,type:v,velocity:b,delay:a,isHandoff:k,onUpdate:M}=l;this.resolvedAt=No.now(),$7(e,m,v,b)||((Yu.instantAnimations||!a)&&M?.(bT(e,l,r)),e[0]=e[e.length-1],Ww(l),l.repeat=0);const z={startTime:u?this.resolvedAt?this.resolvedAt-this.createdAt>q7?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:r,...l,keyframes:e},O=!k&&W7(z),K=z.motionValue?.owner?.current,H=O?new V7({...z,element:K}):new ST(z);H.finished.then(()=>{this.notifyFinished()}).catch(rl),this.pendingTimeline&&(this.stopTimeline=H.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=H}get finished(){return this._animation?this.animation.finished:this._finished}then(e,r){return this.finished.finally(e).then(()=>{})}get animation(){return this._animation||(this.keyframeResolver?.resume(),M7()),this._animation}get duration(){return this.animation.duration}get iterationDuration(){return this.animation.iterationDuration}get time(){return this.animation.time}set time(e){this.animation.time=e}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(e){this.animation.speed=e}get startTime(){return this.animation.startTime}attachTimeline(e){return this._animation?this.stopTimeline=this.animation.attachTimeline(e):this.pendingTimeline=e,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this._animation&&this.animation.cancel(),this.keyframeResolver?.cancel()}}function dN(t,e,r,l=0,u=1){const m=Array.from(t).sort((k,M)=>k.sortNodePosition(M)).indexOf(e),v=t.size,b=(v-1)*l;return typeof r=="function"?r(m,v):u===1?m*l:b-m*l}const X7=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function K7(t){const e=X7.exec(t);if(!e)return[,];const[,r,l,u]=e;return[`--${r??l}`,u]}function hN(t,e,r=1){const[l,u]=K7(t);if(!l)return;const m=window.getComputedStyle(e).getPropertyValue(l);if(m){const v=m.trim();return PR(v)?parseFloat(v):v}return yT(u)?hN(u,e,r+1):u}const Y7={type:"spring",stiffness:500,damping:25,restSpeed:10},J7=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),Q7={type:"keyframes",duration:.8},e9={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},t9=(t,{keyframes:e})=>e.length>2?Q7:eg.has(t)?t.startsWith("scale")?J7(e[1]):Y7:e9,n9=t=>t!==null;function r9(t,{repeat:e,repeatType:r="loop"},l){const u=t.filter(n9),m=e&&r!=="loop"&&e%2===1?0:u.length-1;return u[m]}function CT(t,e){return t?.[e]??t?.default??t}function i9({when:t,delay:e,delayChildren:r,staggerChildren:l,staggerDirection:u,repeat:m,repeatType:v,repeatDelay:b,from:a,elapsed:k,...M}){return!!Object.keys(M).length}const kT=(t,e,r,l={},u,m)=>v=>{const b=CT(l,t)||{},a=b.delay||l.delay||0;let{elapsed:k=0}=l;k=k-Wu(a);const M={keyframes:Array.isArray(r)?r:[null,r],ease:"easeOut",velocity:e.getVelocity(),...b,delay:-k,onUpdate:z=>{e.set(z),b.onUpdate&&b.onUpdate(z)},onComplete:()=>{v(),b.onComplete&&b.onComplete()},name:t,motionValue:e,element:m?void 0:u};i9(b)||Object.assign(M,t9(t,M)),M.duration&&(M.duration=Wu(M.duration)),M.repeatDelay&&(M.repeatDelay=Wu(M.repeatDelay)),M.from!==void 0&&(M.keyframes[0]=M.from);let L=!1;if((M.type===!1||M.duration===0&&!M.repeatDelay)&&(Ww(M),M.delay===0&&(L=!0)),(Yu.instantAnimations||Yu.skipAnimations)&&(L=!0,Ww(M),M.delay=0),M.allowFlatten=!b.type&&!b.ease,L&&!m&&e.get()!==void 0){const z=r9(M.keyframes,b);if(z!==void 0){ei.update(()=>{M.onUpdate(z),M.onComplete()});return}}return b.isSync?new ST(M):new Z7(M)};function Fk(t){const e=[{},{}];return t?.values.forEach((r,l)=>{e[0][l]=r.get(),e[1][l]=r.getVelocity()}),e}function AT(t,e,r,l){if(typeof e=="function"){const[u,m]=Fk(l);e=e(r!==void 0?r:t.custom,u,m)}if(typeof e=="string"&&(e=t.variants&&t.variants[e]),typeof e=="function"){const[u,m]=Fk(l);e=e(r!==void 0?r:t.custom,u,m)}return e}function Mm(t,e,r){const l=t.getProps();return AT(l,e,r!==void 0?r:l.custom,t)}const fN=new Set(["width","height","top","left","right","bottom",...Qm]),Vk=30,s9=t=>!isNaN(parseFloat(t)),vy={current:void 0};class o9{constructor(e,r={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=l=>{const u=No.now();if(this.updatedAt!==u&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(l),this.current!==this.prev&&(this.events.change?.notify(this.current),this.dependents))for(const m of this.dependents)m.dirty()},this.hasAnimated=!1,this.setCurrent(e),this.owner=r.owner}setCurrent(e){this.current=e,this.updatedAt=No.now(),this.canTrackVelocity===null&&e!==void 0&&(this.canTrackVelocity=s9(this.current))}setPrevFrameValue(e=this.current){this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt}onChange(e){return this.on("change",e)}on(e,r){this.events[e]||(this.events[e]=new pT);const l=this.events[e].add(r);return e==="change"?()=>{l(),ei.read(()=>{this.events.change.getSize()||this.stop()})}:l}clearListeners(){for(const e in this.events)this.events[e].clear()}attach(e,r){this.passiveEffect=e,this.stopPassiveEffect=r}set(e){this.passiveEffect?this.passiveEffect(e,this.updateAndNotify):this.updateAndNotify(e)}setWithVelocity(e,r,l){this.set(r),this.prev=void 0,this.prevFrameValue=e,this.prevUpdatedAt=this.updatedAt-l}jump(e,r=!0){this.updateAndNotify(e),this.prev=e,this.prevUpdatedAt=this.prevFrameValue=void 0,r&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){this.events.change?.notify(this.current)}addDependent(e){this.dependents||(this.dependents=new Set),this.dependents.add(e)}removeDependent(e){this.dependents&&this.dependents.delete(e)}get(){return vy.current&&vy.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const e=No.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||e-this.updatedAt>Vk)return 0;const r=Math.min(this.updatedAt-this.prevUpdatedAt,Vk);return DR(parseFloat(this.current)-parseFloat(this.prevFrameValue),r)}start(e){return this.stop(),new Promise(r=>{this.hasAnimated=!0,this.animation=e(r),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.dependents?.clear(),this.events.destroy?.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Yf(t,e){return new o9(t,e)}const qw=t=>Array.isArray(t);function a9(t,e,r){t.hasValue(e)?t.getValue(e).set(r):t.addValue(e,Yf(r))}function l9(t){return qw(t)?t[t.length-1]||0:t}function c9(t,e){const r=Mm(t,e);let{transitionEnd:l={},transition:u={},...m}=r||{};m={...m,...l};for(const v in m){const b=l9(m[v]);a9(t,v,b)}}const Zs=t=>!!(t&&t.getVelocity);function u9(t){return!!(Zs(t)&&t.add)}function Zw(t,e){const r=t.getValue("willChange");if(u9(r))return r.add(e);if(!r&&Yu.WillChange){const l=new Yu.WillChange("auto");t.addValue("willChange",l),l.add(e)}}function IT(t){return t.replace(/([A-Z])/g,e=>`-${e.toLowerCase()}`)}const d9="framerAppearId",pN="data-"+IT(d9);function mN(t){return t.props[pN]}function h9({protectedKeys:t,needsAnimating:e},r){const l=t.hasOwnProperty(r)&&e[r]!==!0;return e[r]=!1,l}function gN(t,e,{delay:r=0,transitionOverride:l,type:u}={}){let{transition:m=t.getDefaultTransition(),transitionEnd:v,...b}=e;const a=m?.reduceMotion;l&&(m=l);const k=[],M=u&&t.animationState&&t.animationState.getState()[u];for(const L in b){const z=t.getValue(L,t.latestValues[L]??null),O=b[L];if(O===void 0||M&&h9(M,L))continue;const K={delay:r,...CT(m||{},L)},H=z.get();if(H!==void 0&&!z.isAnimating&&!Array.isArray(O)&&O===H&&!K.velocity)continue;let Z=!1;if(window.MotionHandoffAnimation){const ie=mN(t);if(ie){const pe=window.MotionHandoffAnimation(ie,L,ei);pe!==null&&(K.startTime=pe,Z=!0)}}Zw(t,L);const Y=a??t.shouldReduceMotion;z.start(kT(L,z,O,Y&&fN.has(L)?{type:!1}:K,t,Z));const ee=z.animation;ee&&k.push(ee)}return v&&Promise.all(k).then(()=>{ei.update(()=>{v&&c9(t,v)})}),k}function Xw(t,e,r={}){const l=Mm(t,e,r.type==="exit"?t.presenceContext?.custom:void 0);let{transition:u=t.getDefaultTransition()||{}}=l||{};r.transitionOverride&&(u=r.transitionOverride);const m=l?()=>Promise.all(gN(t,l,r)):()=>Promise.resolve(),v=t.variantChildren&&t.variantChildren.size?(a=0)=>{const{delayChildren:k=0,staggerChildren:M,staggerDirection:L}=u;return f9(t,e,a,k,M,L,r)}:()=>Promise.resolve(),{when:b}=u;if(b){const[a,k]=b==="beforeChildren"?[m,v]:[v,m];return a().then(()=>k())}else return Promise.all([m(),v(r.delay)])}function f9(t,e,r=0,l=0,u=0,m=1,v){const b=[];for(const a of t.variantChildren)a.notify("AnimationStart",e),b.push(Xw(a,e,{...v,delay:r+(typeof l=="function"?0:l)+dN(t.variantChildren,a,l,u,m)}).then(()=>a.notify("AnimationComplete",e)));return Promise.all(b)}function p9(t,e,r={}){t.notify("AnimationStart",e);let l;if(Array.isArray(e)){const u=e.map(m=>Xw(t,m,r));l=Promise.all(u)}else if(typeof e=="string")l=Xw(t,e,r);else{const u=typeof e=="function"?Mm(t,e,r.custom):e;l=Promise.all(gN(t,u,r))}return l.then(()=>{t.notify("AnimationComplete",e)})}const m9={test:t=>t==="auto",parse:t=>t},yN=t=>e=>e.test(t),_N=[Jm,gn,qc,Kd,$2,U2,m9],Uk=t=>_N.find(yN(t));function g9(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||NR(t):!0}const y9=new Set(["brightness","contrast","saturate","opacity"]);function _9(t){const[e,r]=t.slice(0,-1).split("(");if(e==="drop-shadow")return t;const[l]=r.match(_T)||[];if(!l)return t;const u=r.replace(l,"");let m=y9.has(e)?1:0;return l!==r&&(m*=100),e+"("+m+u+")"}const x9=/\b([a-z-]*)\(.*?\)/gu,Kw={...mh,getAnimatableNone:t=>{const e=t.match(x9);return e?e.map(_9).join(" "):t}},$k={...Jm,transform:Math.round},v9={rotate:Kd,rotateX:Kd,rotateY:Kd,rotateZ:Kd,scale:dx,scaleX:dx,scaleY:dx,scaleZ:dx,skew:Kd,skewX:Kd,skewY:Kd,distance:gn,translateX:gn,translateY:gn,translateZ:gn,x:gn,y:gn,z:gn,perspective:gn,transformPerspective:gn,opacity:Oy,originX:Ik,originY:Ik,originZ:gn},MT={borderWidth:gn,borderTopWidth:gn,borderRightWidth:gn,borderBottomWidth:gn,borderLeftWidth:gn,borderRadius:gn,borderTopLeftRadius:gn,borderTopRightRadius:gn,borderBottomRightRadius:gn,borderBottomLeftRadius:gn,width:gn,maxWidth:gn,height:gn,maxHeight:gn,top:gn,right:gn,bottom:gn,left:gn,inset:gn,insetBlock:gn,insetBlockStart:gn,insetBlockEnd:gn,insetInline:gn,insetInlineStart:gn,insetInlineEnd:gn,padding:gn,paddingTop:gn,paddingRight:gn,paddingBottom:gn,paddingLeft:gn,paddingBlock:gn,paddingBlockStart:gn,paddingBlockEnd:gn,paddingInline:gn,paddingInlineStart:gn,paddingInlineEnd:gn,margin:gn,marginTop:gn,marginRight:gn,marginBottom:gn,marginLeft:gn,marginBlock:gn,marginBlockStart:gn,marginBlockEnd:gn,marginInline:gn,marginInlineStart:gn,marginInlineEnd:gn,fontSize:gn,backgroundPositionX:gn,backgroundPositionY:gn,...v9,zIndex:$k,fillOpacity:Oy,strokeOpacity:Oy,numOctaves:$k},w9={...MT,color:ns,backgroundColor:ns,outlineColor:ns,fill:ns,stroke:ns,borderColor:ns,borderTopColor:ns,borderRightColor:ns,borderBottomColor:ns,borderLeftColor:ns,filter:Kw,WebkitFilter:Kw},xN=t=>w9[t];function vN(t,e){let r=xN(t);return r!==Kw&&(r=mh),r.getAnimatableNone?r.getAnimatableNone(e):void 0}const b9=new Set(["auto","none","0"]);function T9(t,e,r){let l=0,u;for(;l<t.length&&!u;){const m=t[l];typeof m=="string"&&!b9.has(m)&&zy(m).values.length&&(u=t[l]),l++}if(u&&r)for(const m of e)t[m]=vN(r,u)}class S9 extends ET{constructor(e,r,l,u,m){super(e,r,l,u,m,!0)}readKeyframes(){const{unresolvedKeyframes:e,element:r,name:l}=this;if(!r||!r.current)return;super.readKeyframes();for(let M=0;M<e.length;M++){let L=e[M];if(typeof L=="string"&&(L=L.trim(),yT(L))){const z=hN(L,r.current);z!==void 0&&(e[M]=z),M===e.length-1&&(this.finalKeyframe=L)}}if(this.resolveNoneKeyframes(),!fN.has(l)||e.length!==2)return;const[u,m]=e,v=Uk(u),b=Uk(m),a=Ak(u),k=Ak(m);if(a!==k&&ih[l]){this.needsMeasurement=!0;return}if(v!==b)if(Ok(v)&&Ok(b))for(let M=0;M<e.length;M++){const L=e[M];typeof L=="string"&&(e[M]=parseFloat(L))}else ih[l]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:e,name:r}=this,l=[];for(let u=0;u<e.length;u++)(e[u]===null||g9(e[u]))&&l.push(u);l.length&&T9(e,l,r)}measureInitialState(){const{element:e,unresolvedKeyframes:r,name:l}=this;if(!e||!e.current)return;l==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=ih[l](e.measureViewportBox(),window.getComputedStyle(e.current)),r[0]=this.measuredOrigin;const u=r[r.length-1];u!==void 0&&e.getValue(l,u).jump(u,!1)}measureEndState(){const{element:e,name:r,unresolvedKeyframes:l}=this;if(!e||!e.current)return;const u=e.getValue(r);u&&u.jump(this.measuredOrigin,!1);const m=l.length-1,v=l[m];l[m]=ih[r](e.measureViewportBox(),window.getComputedStyle(e.current)),v!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=v),this.removedTransforms?.length&&this.removedTransforms.forEach(([b,a])=>{e.getValue(b).set(a)}),this.resolveNoneKeyframes()}}function E9(t,e,r){if(t==null)return[];if(t instanceof EventTarget)return[t];if(typeof t=="string"){let l=document;const u=r?.[t]??l.querySelectorAll(t);return u?Array.from(u):[]}return Array.from(t).filter(l=>l!=null)}const wN=(t,e)=>e&&typeof t=="number"?e.transform(t):t;function Yw(t){return RR(t)&&"offsetHeight"in t}const{schedule:PT}=HR(queueMicrotask,!1),Fl={x:!1,y:!1};function bN(){return Fl.x||Fl.y}function C9(t){return t==="x"||t==="y"?Fl[t]?null:(Fl[t]=!0,()=>{Fl[t]=!1}):Fl.x||Fl.y?null:(Fl.x=Fl.y=!0,()=>{Fl.x=Fl.y=!1})}function TN(t,e){const r=E9(t),l=new AbortController,u={passive:!0,...e,signal:l.signal};return[r,u,()=>l.abort()]}function Gk(t){return!(t.pointerType==="touch"||bN())}function k9(t,e,r={}){const[l,u,m]=TN(t,r),v=b=>{if(!Gk(b))return;const{target:a}=b,k=e(a,b);if(typeof k!="function"||!a)return;const M=L=>{Gk(L)&&(k(L),a.removeEventListener("pointerleave",M))};a.addEventListener("pointerleave",M,u)};return l.forEach(b=>{b.addEventListener("pointerenter",v,u)}),m}const SN=(t,e)=>e?t===e?!0:SN(t,e.parentElement):!1,RT=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,A9=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function EN(t){return A9.has(t.tagName)||t.isContentEditable===!0}const Px=new WeakSet;function Hk(t){return e=>{e.key==="Enter"&&t(e)}}function R1(t,e){t.dispatchEvent(new PointerEvent("pointer"+e,{isPrimary:!0,bubbles:!0}))}const I9=(t,e)=>{const r=t.currentTarget;if(!r)return;const l=Hk(()=>{if(Px.has(r))return;R1(r,"down");const u=Hk(()=>{R1(r,"up")}),m=()=>R1(r,"cancel");r.addEventListener("keyup",u,e),r.addEventListener("blur",m,e)});r.addEventListener("keydown",l,e),r.addEventListener("blur",()=>r.removeEventListener("keydown",l),e)};function Wk(t){return RT(t)&&!bN()}function M9(t,e,r={}){const[l,u,m]=TN(t,r),v=b=>{const a=b.currentTarget;if(!Wk(b))return;Px.add(a);const k=e(a,b),M=(O,K)=>{window.removeEventListener("pointerup",L),window.removeEventListener("pointercancel",z),Px.has(a)&&Px.delete(a),Wk(O)&&typeof k=="function"&&k(O,{success:K})},L=O=>{M(O,a===window||a===document||r.useGlobalTarget||SN(a,O.target))},z=O=>{M(O,!1)};window.addEventListener("pointerup",L,u),window.addEventListener("pointercancel",z,u)};return l.forEach(b=>{(r.useGlobalTarget?window:b).addEventListener("pointerdown",v,u),Yw(b)&&(b.addEventListener("focus",k=>I9(k,u)),!EN(b)&&!b.hasAttribute("tabindex")&&(b.tabIndex=0))}),m}function CN(t){return RR(t)&&"ownerSVGElement"in t}function P9(t){return CN(t)&&t.tagName==="svg"}function R9(...t){const e=!Array.isArray(t[0]),r=e?0:-1,l=t[0+r],u=t[1+r],m=t[2+r],v=t[3+r],b=rN(u,m,v);return e?b(l):b}const N9=[..._N,ns,mh],D9=t=>N9.find(yN(t)),qk=()=>({translate:0,scale:1,origin:0,originPoint:0}),wm=()=>({x:qk(),y:qk()}),Zk=()=>({min:0,max:0}),ps=()=>({x:Zk(),y:Zk()}),Jw={current:null},kN={current:!1},L9=typeof window<"u";function j9(){if(kN.current=!0,!!L9)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),e=()=>Jw.current=t.matches;t.addEventListener("change",e),e()}else Jw.current=!1}const O9=new WeakMap;function Gv(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function By(t){return typeof t=="string"||Array.isArray(t)}const NT=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],DT=["initial",...NT];function Hv(t){return Gv(t.animate)||DT.some(e=>By(t[e]))}function AN(t){return!!(Hv(t)||t.variants)}function z9(t,e,r){for(const l in e){const u=e[l],m=r[l];if(Zs(u))t.addValue(l,u);else if(Zs(m))t.addValue(l,Yf(u,{owner:t}));else if(m!==u)if(t.hasValue(l)){const v=t.getValue(l);v.liveStyle===!0?v.jump(u):v.hasAnimated||v.set(u)}else{const v=t.getStaticValue(l);t.addValue(l,Yf(v!==void 0?v:u,{owner:t}))}}for(const l in r)e[l]===void 0&&t.removeValue(l);return e}const Xk=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];let nv={};function IN(t){nv=t}function B9(){return nv}class F9{scrapeMotionValuesFromProps(e,r,l){return{}}constructor({parent:e,props:r,presenceContext:l,reducedMotionConfig:u,blockInitialAnimation:m,visualState:v},b={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ET,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const z=No.now();this.renderScheduledAt<z&&(this.renderScheduledAt=z,ei.render(this.render,!1,!0))};const{latestValues:a,renderState:k}=v;this.latestValues=a,this.baseTarget={...a},this.initialValues=r.initial?{...a}:{},this.renderState=k,this.parent=e,this.props=r,this.presenceContext=l,this.depth=e?e.depth+1:0,this.reducedMotionConfig=u,this.options=b,this.blockInitialAnimation=!!m,this.isControllingVariants=Hv(r),this.isVariantNode=AN(r),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(e&&e.current);const{willChange:M,...L}=this.scrapeMotionValuesFromProps(r,{},this);for(const z in L){const O=L[z];a[z]!==void 0&&Zs(O)&&O.set(a[z])}}mount(e){this.current=e,O9.set(e,this),this.projection&&!this.projection.instance&&this.projection.mount(e),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,l)=>this.bindToMotionValue(l,r)),this.reducedMotionConfig==="never"?this.shouldReduceMotion=!1:this.reducedMotionConfig==="always"?this.shouldReduceMotion=!0:(kN.current||j9(),this.shouldReduceMotion=Jw.current),this.parent?.addChild(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),Ju(this.notifyUpdate),Ju(this.render),this.valueSubscriptions.forEach(e=>e()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent?.removeChild(this);for(const e in this.events)this.events[e].clear();for(const e in this.features){const r=this.features[e];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(e){this.children.add(e),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(e)}removeChild(e){this.children.delete(e),this.enteringChildren&&this.enteringChildren.delete(e)}bindToMotionValue(e,r){this.valueSubscriptions.has(e)&&this.valueSubscriptions.get(e)();const l=eg.has(e);l&&this.onBindTransform&&this.onBindTransform();const u=r.on("change",v=>{this.latestValues[e]=v,this.props.onUpdate&&ei.preRender(this.notifyUpdate),l&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let m;typeof window<"u"&&window.MotionCheckAppearSync&&(m=window.MotionCheckAppearSync(this,e,r)),this.valueSubscriptions.set(e,()=>{u(),m&&m(),r.owner&&r.stop()})}sortNodePosition(e){return!this.current||!this.sortInstanceNodePosition||this.type!==e.type?0:this.sortInstanceNodePosition(this.current,e.current)}updateFeatures(){let e="animation";for(e in nv){const r=nv[e];if(!r)continue;const{isEnabled:l,Feature:u}=r;if(!this.features[e]&&u&&l(this.props)&&(this.features[e]=new u(this)),this.features[e]){const m=this.features[e];m.isMounted?m.update():(m.mount(),m.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):ps()}getStaticValue(e){return this.latestValues[e]}setStaticValue(e,r){this.latestValues[e]=r}update(e,r){(e.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=e,this.prevPresenceContext=this.presenceContext,this.presenceContext=r;for(let l=0;l<Xk.length;l++){const u=Xk[l];this.propEventSubscriptions[u]&&(this.propEventSubscriptions[u](),delete this.propEventSubscriptions[u]);const m="on"+u,v=e[m];v&&(this.propEventSubscriptions[u]=this.on(u,v))}this.prevMotionValues=z9(this,this.scrapeMotionValuesFromProps(e,this.prevProps||{},this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(e){return this.props.variants?this.props.variants[e]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(e){const r=this.getClosestVariantNode();if(r)return r.variantChildren&&r.variantChildren.add(e),()=>r.variantChildren.delete(e)}addValue(e,r){const l=this.values.get(e);r!==l&&(l&&this.removeValue(e),this.bindToMotionValue(e,r),this.values.set(e,r),this.latestValues[e]=r.get())}removeValue(e){this.values.delete(e);const r=this.valueSubscriptions.get(e);r&&(r(),this.valueSubscriptions.delete(e)),delete this.latestValues[e],this.removeValueFromRenderState(e,this.renderState)}hasValue(e){return this.values.has(e)}getValue(e,r){if(this.props.values&&this.props.values[e])return this.props.values[e];let l=this.values.get(e);return l===void 0&&r!==void 0&&(l=Yf(r===null?void 0:r,{owner:this}),this.addValue(e,l)),l}readValue(e,r){let l=this.latestValues[e]!==void 0||!this.current?this.latestValues[e]:this.getBaseTargetFromProps(this.props,e)??this.readValueFromInstance(this.current,e,this.options);return l!=null&&(typeof l=="string"&&(PR(l)||NR(l))?l=parseFloat(l):!D9(l)&&mh.test(r)&&(l=vN(e,r)),this.setBaseTarget(e,Zs(l)?l.get():l)),Zs(l)?l.get():l}setBaseTarget(e,r){this.baseTarget[e]=r}getBaseTarget(e){const{initial:r}=this.props;let l;if(typeof r=="string"||typeof r=="object"){const m=AT(this.props,r,this.presenceContext?.custom);m&&(l=m[e])}if(r&&l!==void 0)return l;const u=this.getBaseTargetFromProps(this.props,e);return u!==void 0&&!Zs(u)?u:this.initialValues[e]!==void 0&&l===void 0?void 0:this.baseTarget[e]}on(e,r){return this.events[e]||(this.events[e]=new pT),this.events[e].add(r)}notify(e,...r){this.events[e]&&this.events[e].notify(...r)}scheduleRenderMicrotask(){PT.render(this.render)}}class MN extends F9{constructor(){super(...arguments),this.KeyframeResolver=S9}sortInstanceNodePosition(e,r){return e.compareDocumentPosition(r)&2?1:-1}getBaseTargetFromProps(e,r){const l=e.style;return l?l[r]:void 0}removeValueFromRenderState(e,{vars:r,style:l}){delete r[e],delete l[e]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:e}=this.props;Zs(e)&&(this.childSubscription=e.on("change",r=>{this.current&&(this.current.textContent=`${r}`)}))}}class Th{constructor(e){this.isMounted=!1,this.node=e}update(){}}function PN({top:t,left:e,right:r,bottom:l}){return{x:{min:e,max:r},y:{min:t,max:l}}}function V9({x:t,y:e}){return{top:e.min,right:t.max,bottom:e.max,left:t.min}}function U9(t,e){if(!e)return t;const r=e({x:t.left,y:t.top}),l=e({x:t.right,y:t.bottom});return{top:r.y,left:r.x,bottom:l.y,right:l.x}}function N1(t){return t===void 0||t===1}function Qw({scale:t,scaleX:e,scaleY:r}){return!N1(t)||!N1(e)||!N1(r)}function jf(t){return Qw(t)||RN(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function RN(t){return Kk(t.x)||Kk(t.y)}function Kk(t){return t&&t!=="0%"}function rv(t,e,r){const l=t-r,u=e*l;return r+u}function Yk(t,e,r,l,u){return u!==void 0&&(t=rv(t,u,l)),rv(t,r,l)+e}function eb(t,e=0,r=1,l,u){t.min=Yk(t.min,e,r,l,u),t.max=Yk(t.max,e,r,l,u)}function NN(t,{x:e,y:r}){eb(t.x,e.translate,e.scale,e.originPoint),eb(t.y,r.translate,r.scale,r.originPoint)}const Jk=.999999999999,Qk=1.0000000000001;function $9(t,e,r,l=!1){const u=r.length;if(!u)return;e.x=e.y=1;let m,v;for(let b=0;b<u;b++){m=r[b],v=m.projectionDelta;const{visualElement:a}=m.options;a&&a.props.style&&a.props.style.display==="contents"||(l&&m.options.layoutScroll&&m.scroll&&m!==m.root&&Tm(t,{x:-m.scroll.offset.x,y:-m.scroll.offset.y}),v&&(e.x*=v.x.scale,e.y*=v.y.scale,NN(t,v)),l&&jf(m.latestValues)&&Tm(t,m.latestValues))}e.x<Qk&&e.x>Jk&&(e.x=1),e.y<Qk&&e.y>Jk&&(e.y=1)}function bm(t,e){t.min=t.min+e,t.max=t.max+e}function eA(t,e,r,l,u=.5){const m=yi(t.min,t.max,u);eb(t,e,r,m,l)}function Tm(t,e){eA(t.x,e.x,e.scaleX,e.scale,e.originX),eA(t.y,e.y,e.scaleY,e.scale,e.originY)}function DN(t,e){return PN(U9(t.getBoundingClientRect(),e))}function G9(t,e,r){const l=DN(t,r),{scroll:u}=e;return u&&(bm(l.x,u.offset.x),bm(l.y,u.offset.y)),l}const H9={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},W9=Qm.length;function q9(t,e,r){let l="",u=!0;for(let m=0;m<W9;m++){const v=Qm[m],b=t[v];if(b===void 0)continue;let a=!0;if(typeof b=="number")a=b===(v.startsWith("scale")?1:0);else{const k=parseFloat(b);a=v.startsWith("scale")?k===1:k===0}if(!a||r){const k=wN(b,MT[v]);if(!a){u=!1;const M=H9[v]||v;l+=`${M}(${k}) `}r&&(e[v]=k)}}return l=l.trim(),r?l=r(e,u?"":l):u&&(l="none"),l}function LT(t,e,r){const{style:l,vars:u,transformOrigin:m}=t;let v=!1,b=!1;for(const a in e){const k=e[a];if(eg.has(a)){v=!0;continue}else if(qR(a)){u[a]=k;continue}else{const M=wN(k,MT[a]);a.startsWith("origin")?(b=!0,m[a]=M):l[a]=M}}if(e.transform||(v||r?l.transform=q9(e,t.transform,r):l.transform&&(l.transform="none")),b){const{originX:a="50%",originY:k="50%",originZ:M=0}=m;l.transformOrigin=`${a} ${k} ${M}`}}function LN(t,{style:e,vars:r},l,u){const m=t.style;let v;for(v in e)m[v]=e[v];u?.applyProjectionStyles(m,l);for(v in r)m.setProperty(v,r[v])}function tA(t,e){return e.max===e.min?0:t/(e.max-e.min)*100}const ty={correct:(t,e)=>{if(!e.target)return t;if(typeof t=="string")if(gn.test(t))t=parseFloat(t);else return t;const r=tA(t,e.target.x),l=tA(t,e.target.y);return`${r}% ${l}%`}},Z9={correct:(t,{treeScale:e,projectionDelta:r})=>{const l=t,u=mh.parse(t);if(u.length>5)return l;const m=mh.createTransformer(t),v=typeof u[0]!="number"?1:0,b=r.x.scale*e.x,a=r.y.scale*e.y;u[0+v]/=b,u[1+v]/=a;const k=yi(b,a,.5);return typeof u[2+v]=="number"&&(u[2+v]/=k),typeof u[3+v]=="number"&&(u[3+v]/=k),m(u)}},tb={borderRadius:{...ty,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ty,borderTopRightRadius:ty,borderBottomLeftRadius:ty,borderBottomRightRadius:ty,boxShadow:Z9};function jN(t,{layout:e,layoutId:r}){return eg.has(t)||t.startsWith("origin")||(e||r!==void 0)&&(!!tb[t]||t==="opacity")}function jT(t,e,r){const l=t.style,u=e?.style,m={};if(!l)return m;for(const v in l)(Zs(l[v])||u&&Zs(u[v])||jN(v,t)||r?.getValue(v)?.liveStyle!==void 0)&&(m[v]=l[v]);return m}function X9(t){return window.getComputedStyle(t)}class K9 extends MN{constructor(){super(...arguments),this.type="html",this.renderInstance=LN}readValueFromInstance(e,r){if(eg.has(r))return this.projection?.isProjecting?Vw(r):E7(e,r);{const l=X9(e),u=(qR(r)?l.getPropertyValue(r):l[r])||0;return typeof u=="string"?u.trim():u}}measureInstanceViewportBox(e,{transformPagePoint:r}){return DN(e,r)}build(e,r,l){LT(e,r,l.transformTemplate)}scrapeMotionValuesFromProps(e,r,l){return jT(e,r,l)}}const Y9={offset:"stroke-dashoffset",array:"stroke-dasharray"},J9={offset:"strokeDashoffset",array:"strokeDasharray"};function Q9(t,e,r=1,l=0,u=!0){t.pathLength=1;const m=u?Y9:J9;t[m.offset]=`${-l}`,t[m.array]=`${e} ${r}`}const eG=["offsetDistance","offsetPath","offsetRotate","offsetAnchor"];function ON(t,{attrX:e,attrY:r,attrScale:l,pathLength:u,pathSpacing:m=1,pathOffset:v=0,...b},a,k,M){if(LT(t,b,k),a){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:L,style:z}=t;L.transform&&(z.transform=L.transform,delete L.transform),(z.transform||L.transformOrigin)&&(z.transformOrigin=L.transformOrigin??"50% 50%",delete L.transformOrigin),z.transform&&(z.transformBox=M?.transformBox??"fill-box",delete L.transformBox);for(const O of eG)L[O]!==void 0&&(z[O]=L[O],delete L[O]);e!==void 0&&(L.x=e),r!==void 0&&(L.y=r),l!==void 0&&(L.scale=l),u!==void 0&&Q9(L,u,m,v,!1)}const zN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]),BN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function tG(t,e,r,l){LN(t,e,void 0,l);for(const u in e.attrs)t.setAttribute(zN.has(u)?u:IT(u),e.attrs[u])}function FN(t,e,r){const l=jT(t,e,r);for(const u in t)if(Zs(t[u])||Zs(e[u])){const m=Qm.indexOf(u)!==-1?"attr"+u.charAt(0).toUpperCase()+u.substring(1):u;l[m]=t[u]}return l}class nG extends MN{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=ps}getBaseTargetFromProps(e,r){return e[r]}readValueFromInstance(e,r){if(eg.has(r)){const l=xN(r);return l&&l.default||0}return r=zN.has(r)?r:IT(r),e.getAttribute(r)}scrapeMotionValuesFromProps(e,r,l){return FN(e,r,l)}build(e,r,l){ON(e,r,this.isSVGTag,l.transformTemplate,l.style)}renderInstance(e,r,l,u){tG(e,r,l,u)}mount(e){this.isSVGTag=BN(e.tagName),super.mount(e)}}const rG=DT.length;function VN(t){if(!t)return;if(!t.isControllingVariants){const r=t.parent?VN(t.parent)||{}:{};return t.props.initial!==void 0&&(r.initial=t.props.initial),r}const e={};for(let r=0;r<rG;r++){const l=DT[r],u=t.props[l];(By(u)||u===!1)&&(e[l]=u)}return e}function UN(t,e){if(!Array.isArray(e))return!1;const r=e.length;if(r!==t.length)return!1;for(let l=0;l<r;l++)if(e[l]!==t[l])return!1;return!0}const iG=[...NT].reverse(),sG=NT.length;function oG(t){return e=>Promise.all(e.map(({animation:r,options:l})=>p9(t,r,l)))}function aG(t){let e=oG(t),r=nA(),l=!0;const u=a=>(k,M)=>{const L=Mm(t,M,a==="exit"?t.presenceContext?.custom:void 0);if(L){const{transition:z,transitionEnd:O,...K}=L;k={...k,...K,...O}}return k};function m(a){e=a(t)}function v(a){const{props:k}=t,M=VN(t.parent)||{},L=[],z=new Set;let O={},K=1/0;for(let Z=0;Z<sG;Z++){const Y=iG[Z],ee=r[Y],ie=k[Y]!==void 0?k[Y]:M[Y],pe=By(ie),we=Y===a?ee.isActive:null;we===!1&&(K=Z);let ke=ie===M[Y]&&ie!==k[Y]&&pe;if(ke&&l&&t.manuallyAnimateOnMount&&(ke=!1),ee.protectedKeys={...O},!ee.isActive&&we===null||!ie&&!ee.prevProp||Gv(ie)||typeof ie=="boolean")continue;const ze=lG(ee.prevProp,ie);let Ge=ze||Y===a&&ee.isActive&&!ke&&pe||Z>K&&pe,tt=!1;const Pe=Array.isArray(ie)?ie:[ie];let ot=Pe.reduce(u(Y),{});we===!1&&(ot={});const{prevResolvedValues:ut={}}=ee,gt={...ut,...ot},ht=pt=>{Ge=!0,z.has(pt)&&(tt=!0,z.delete(pt)),ee.needsAnimating[pt]=!0;const Ae=t.getValue(pt);Ae&&(Ae.liveStyle=!1)};for(const pt in gt){const Ae=ot[pt],xe=ut[pt];if(O.hasOwnProperty(pt))continue;let We=!1;qw(Ae)&&qw(xe)?We=!UN(Ae,xe):We=Ae!==xe,We?Ae!=null?ht(pt):z.add(pt):Ae!==void 0&&z.has(pt)?ht(pt):ee.protectedKeys[pt]=!0}ee.prevProp=ie,ee.prevResolvedValues=ot,ee.isActive&&(O={...O,...ot}),l&&t.blockInitialAnimation&&(Ge=!1);const Lt=ke&&ze;Ge&&(!Lt||tt)&&L.push(...Pe.map(pt=>{const Ae={type:Y};if(typeof pt=="string"&&l&&!Lt&&t.manuallyAnimateOnMount&&t.parent){const{parent:xe}=t,We=Mm(xe,pt);if(xe.enteringChildren&&We){const{delayChildren:he}=We.transition||{};Ae.delay=dN(xe.enteringChildren,t,he)}}return{animation:pt,options:Ae}}))}if(z.size){const Z={};if(typeof k.initial!="boolean"){const Y=Mm(t,Array.isArray(k.initial)?k.initial[0]:k.initial);Y&&Y.transition&&(Z.transition=Y.transition)}z.forEach(Y=>{const ee=t.getBaseTarget(Y),ie=t.getValue(Y);ie&&(ie.liveStyle=!0),Z[Y]=ee??null}),L.push({animation:Z})}let H=!!L.length;return l&&(k.initial===!1||k.initial===k.animate)&&!t.manuallyAnimateOnMount&&(H=!1),l=!1,H?e(L):Promise.resolve()}function b(a,k){if(r[a].isActive===k)return Promise.resolve();t.variantChildren?.forEach(L=>L.animationState?.setActive(a,k)),r[a].isActive=k;const M=v(a);for(const L in r)r[L].protectedKeys={};return M}return{animateChanges:v,setActive:b,setAnimateFunction:m,getState:()=>r,reset:()=>{r=nA()}}}function lG(t,e){return typeof e=="string"?e!==t:Array.isArray(e)?!UN(e,t):!1}function Rf(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function nA(){return{animate:Rf(!0),whileInView:Rf(),whileHover:Rf(),whileTap:Rf(),whileDrag:Rf(),whileFocus:Rf(),exit:Rf()}}function rA(t,e){t.min=e.min,t.max=e.max}function Ol(t,e){rA(t.x,e.x),rA(t.y,e.y)}function iA(t,e){t.translate=e.translate,t.scale=e.scale,t.originPoint=e.originPoint,t.origin=e.origin}const $N=1e-4,cG=1-$N,uG=1+$N,GN=.01,dG=0-GN,hG=0+GN;function Do(t){return t.max-t.min}function fG(t,e,r){return Math.abs(t-e)<=r}function sA(t,e,r,l=.5){t.origin=l,t.originPoint=yi(e.min,e.max,t.origin),t.scale=Do(r)/Do(e),t.translate=yi(r.min,r.max,t.origin)-t.originPoint,(t.scale>=cG&&t.scale<=uG||isNaN(t.scale))&&(t.scale=1),(t.translate>=dG&&t.translate<=hG||isNaN(t.translate))&&(t.translate=0)}function wy(t,e,r,l){sA(t.x,e.x,r.x,l?l.originX:void 0),sA(t.y,e.y,r.y,l?l.originY:void 0)}function oA(t,e,r){t.min=r.min+e.min,t.max=t.min+Do(e)}function pG(t,e,r){oA(t.x,e.x,r.x),oA(t.y,e.y,r.y)}function aA(t,e,r){t.min=e.min-r.min,t.max=t.min+Do(e)}function iv(t,e,r){aA(t.x,e.x,r.x),aA(t.y,e.y,r.y)}function lA(t,e,r,l,u){return t-=e,t=rv(t,1/r,l),u!==void 0&&(t=rv(t,1/u,l)),t}function mG(t,e=0,r=1,l=.5,u,m=t,v=t){if(qc.test(e)&&(e=parseFloat(e),e=yi(v.min,v.max,e/100)-v.min),typeof e!="number")return;let b=yi(m.min,m.max,l);t===m&&(b-=e),t.min=lA(t.min,e,r,b,u),t.max=lA(t.max,e,r,b,u)}function cA(t,e,[r,l,u],m,v){mG(t,e[r],e[l],e[u],e.scale,m,v)}const gG=["x","scaleX","originX"],yG=["y","scaleY","originY"];function uA(t,e,r,l){cA(t.x,e,gG,r?r.x:void 0,l?l.x:void 0),cA(t.y,e,yG,r?r.y:void 0,l?l.y:void 0)}function dA(t){return t.translate===0&&t.scale===1}function HN(t){return dA(t.x)&&dA(t.y)}function hA(t,e){return t.min===e.min&&t.max===e.max}function _G(t,e){return hA(t.x,e.x)&&hA(t.y,e.y)}function fA(t,e){return Math.round(t.min)===Math.round(e.min)&&Math.round(t.max)===Math.round(e.max)}function WN(t,e){return fA(t.x,e.x)&&fA(t.y,e.y)}function pA(t){return Do(t.x)/Do(t.y)}function mA(t,e){return t.translate===e.translate&&t.scale===e.scale&&t.originPoint===e.originPoint}function Ja(t){return[t("x"),t("y")]}function xG(t,e,r){let l="";const u=t.x.translate/e.x,m=t.y.translate/e.y,v=r?.z||0;if((u||m||v)&&(l=`translate3d(${u}px, ${m}px, ${v}px) `),(e.x!==1||e.y!==1)&&(l+=`scale(${1/e.x}, ${1/e.y}) `),r){const{transformPerspective:k,rotate:M,rotateX:L,rotateY:z,skewX:O,skewY:K}=r;k&&(l=`perspective(${k}px) ${l}`),M&&(l+=`rotate(${M}deg) `),L&&(l+=`rotateX(${L}deg) `),z&&(l+=`rotateY(${z}deg) `),O&&(l+=`skewX(${O}deg) `),K&&(l+=`skewY(${K}deg) `)}const b=t.x.scale*e.x,a=t.y.scale*e.y;return(b!==1||a!==1)&&(l+=`scale(${b}, ${a})`),l||"none"}const qN=["TopLeft","TopRight","BottomLeft","BottomRight"],vG=qN.length,gA=t=>typeof t=="string"?parseFloat(t):t,yA=t=>typeof t=="number"||gn.test(t);function wG(t,e,r,l,u,m){u?(t.opacity=yi(0,r.opacity??1,bG(l)),t.opacityExit=yi(e.opacity??1,0,TG(l))):m&&(t.opacity=yi(e.opacity??1,r.opacity??1,l));for(let v=0;v<vG;v++){const b=`border${qN[v]}Radius`;let a=_A(e,b),k=_A(r,b);if(a===void 0&&k===void 0)continue;a||(a=0),k||(k=0),a===0||k===0||yA(a)===yA(k)?(t[b]=Math.max(yi(gA(a),gA(k),l),0),(qc.test(k)||qc.test(a))&&(t[b]+="%")):t[b]=k}(e.rotate||r.rotate)&&(t.rotate=yi(e.rotate||0,r.rotate||0,l))}function _A(t,e){return t[e]!==void 0?t[e]:t.borderRadius}const bG=ZN(0,.5,VR),TG=ZN(.5,.95,rl);function ZN(t,e,r){return l=>l<t?0:l>e?1:r(jy(t,e,l))}function SG(t,e,r){const l=Zs(t)?t:Yf(t);return l.start(kT("",l,e,r)),l.animation}function Fy(t,e,r,l={passive:!0}){return t.addEventListener(e,r,l),()=>t.removeEventListener(e,r)}const EG=(t,e)=>t.depth-e.depth;class CG{constructor(){this.children=[],this.isDirty=!1}add(e){uT(this.children,e),this.isDirty=!0}remove(e){dT(this.children,e),this.isDirty=!0}forEach(e){this.isDirty&&this.children.sort(EG),this.isDirty=!1,this.children.forEach(e)}}function kG(t,e){const r=No.now(),l=({timestamp:u})=>{const m=u-r;m>=e&&(Ju(l),t(m-e))};return ei.setup(l,!0),()=>Ju(l)}function Rx(t){return Zs(t)?t.get():t}class AG{constructor(){this.members=[]}add(e){uT(this.members,e),e.scheduleRender()}remove(e){if(dT(this.members,e),e===this.prevLead&&(this.prevLead=void 0),e===this.lead){const r=this.members[this.members.length-1];r&&this.promote(r)}}relegate(e){const r=this.members.findIndex(u=>e===u);if(r===0)return!1;let l;for(let u=r;u>=0;u--){const m=this.members[u];if(m.isPresent!==!1){l=m;break}}return l?(this.promote(l),!0):!1}promote(e,r){const l=this.lead;if(e!==l&&(this.prevLead=l,this.lead=e,e.show(),l)){l.instance&&l.scheduleRender(),e.scheduleRender();const u=l.options.layoutDependency,m=e.options.layoutDependency;u!==void 0&&m!==void 0&&u===m||(e.resumeFrom=l,r&&(e.resumeFrom.preserveOpacity=!0),l.snapshot&&(e.snapshot=l.snapshot,e.snapshot.latestValues=l.animationValues||l.latestValues),e.root&&e.root.isUpdating&&(e.isLayoutDirty=!0));const{crossfade:b}=e.options;b===!1&&l.hide()}}exitAnimationComplete(){this.members.forEach(e=>{const{options:r,resumingFrom:l}=e;r.onExitComplete&&r.onExitComplete(),l&&l.options.onExitComplete&&l.options.onExitComplete()})}scheduleRender(){this.members.forEach(e=>{e.instance&&e.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}const Nx={hasAnimatedSinceResize:!0,hasEverUpdated:!1},D1=["","X","Y","Z"],IG=1e3;let MG=0;function L1(t,e,r,l){const{latestValues:u}=e;u[t]&&(r[t]=u[t],e.setStaticValue(t,0),l&&(l[t]=0))}function XN(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:e}=t.options;if(!e)return;const r=mN(e);if(window.MotionHasOptimisedAnimation(r,"transform")){const{layout:u,layoutId:m}=t.options;window.MotionCancelOptimisedAnimation(r,"transform",ei,!(u||m))}const{parent:l}=t;l&&!l.hasCheckedOptimisedAppear&&XN(l)}function KN({attachResizeListener:t,defaultParent:e,measureScroll:r,checkIsScrollRoot:l,resetTransform:u}){return class{constructor(v={},b=e?.()){this.id=MG++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.layoutVersion=0,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(NG),this.nodes.forEach(OG),this.nodes.forEach(zG),this.nodes.forEach(DG)},this.resolvedRelativeTargetAt=0,this.linkedParentVersion=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=v,this.root=b?b.root||b:this,this.path=b?[...b.path,b]:[],this.parent=b,this.depth=b?b.depth+1:0;for(let a=0;a<this.path.length;a++)this.path[a].shouldResetTransform=!0;this.root===this&&(this.nodes=new CG)}addEventListener(v,b){return this.eventHandlers.has(v)||this.eventHandlers.set(v,new pT),this.eventHandlers.get(v).add(b)}notifyListeners(v,...b){const a=this.eventHandlers.get(v);a&&a.notify(...b)}hasListeners(v){return this.eventHandlers.has(v)}mount(v){if(this.instance)return;this.isSVG=CN(v)&&!P9(v),this.instance=v;const{layoutId:b,layout:a,visualElement:k}=this.options;if(k&&!k.current&&k.mount(v),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(a||b)&&(this.isLayoutDirty=!0),t){let M,L=0;const z=()=>this.root.updateBlockedByResize=!1;ei.read(()=>{L=window.innerWidth}),t(v,()=>{const O=window.innerWidth;O!==L&&(L=O,this.root.updateBlockedByResize=!0,M&&M(),M=kG(z,250),Nx.hasAnimatedSinceResize&&(Nx.hasAnimatedSinceResize=!1,this.nodes.forEach(wA)))})}b&&this.root.registerSharedNode(b,this),this.options.animate!==!1&&k&&(b||a)&&this.addEventListener("didUpdate",({delta:M,hasLayoutChanged:L,hasRelativeLayoutChanged:z,layout:O})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const K=this.options.transition||k.getDefaultTransition()||$G,{onLayoutAnimationStart:H,onLayoutAnimationComplete:Z}=k.getProps(),Y=!this.targetLayout||!WN(this.targetLayout,O),ee=!L&&z;if(this.options.layoutRoot||this.resumeFrom||ee||L&&(Y||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const ie={...CT(K,"layout"),onPlay:H,onComplete:Z};(k.shouldReduceMotion||this.options.layoutRoot)&&(ie.delay=0,ie.type=!1),this.startAnimation(ie),this.setAnimationOrigin(M,ee)}else L||wA(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=O})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const v=this.getStack();v&&v.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),Ju(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(BG),this.animationId++)}getTransformTemplate(){const{visualElement:v}=this.options;return v&&v.getProps().transformTemplate}willUpdate(v=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&XN(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let M=0;M<this.path.length;M++){const L=this.path[M];L.shouldResetTransform=!0,L.updateScroll("snapshot"),L.options.layoutRoot&&L.willUpdate(!1)}const{layoutId:b,layout:a}=this.options;if(b===void 0&&!a)return;const k=this.getTransformTemplate();this.prevTransformTemplateValue=k?k(this.latestValues,""):void 0,this.updateSnapshot(),v&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(xA);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(vA);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(jG),this.nodes.forEach(PG),this.nodes.forEach(RG)):this.nodes.forEach(vA),this.clearAllSnapshots();const b=No.now();Ws.delta=Kc(0,1e3/60,b-Ws.timestamp),Ws.timestamp=b,Ws.isProcessing=!0,C1.update.process(Ws),C1.preRender.process(Ws),C1.render.process(Ws),Ws.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,PT.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(LG),this.sharedNodes.forEach(FG)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ei.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ei.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Do(this.snapshot.measuredBox.x)&&!Do(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let a=0;a<this.path.length;a++)this.path[a].updateScroll();const v=this.layout;this.layout=this.measure(!1),this.layoutVersion++,this.layoutCorrected=ps(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:b}=this.options;b&&b.notify("LayoutMeasure",this.layout.layoutBox,v?v.layoutBox:void 0)}updateScroll(v="measure"){let b=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===v&&(b=!1),b&&this.instance){const a=l(this.instance);this.scroll={animationId:this.root.animationId,phase:v,isRoot:a,offset:r(this.instance),wasRoot:this.scroll?this.scroll.isRoot:a}}}resetTransform(){if(!u)return;const v=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,b=this.projectionDelta&&!HN(this.projectionDelta),a=this.getTransformTemplate(),k=a?a(this.latestValues,""):void 0,M=k!==this.prevTransformTemplateValue;v&&this.instance&&(b||jf(this.latestValues)||M)&&(u(this.instance,k),this.shouldResetTransform=!1,this.scheduleRender())}measure(v=!0){const b=this.measurePageBox();let a=this.removeElementScroll(b);return v&&(a=this.removeTransform(a)),GG(a),{animationId:this.root.animationId,measuredBox:b,layoutBox:a,latestValues:{},source:this.id}}measurePageBox(){const{visualElement:v}=this.options;if(!v)return ps();const b=v.measureViewportBox();if(!(this.scroll?.wasRoot||this.path.some(HG))){const{scroll:k}=this.root;k&&(bm(b.x,k.offset.x),bm(b.y,k.offset.y))}return b}removeElementScroll(v){const b=ps();if(Ol(b,v),this.scroll?.wasRoot)return b;for(let a=0;a<this.path.length;a++){const k=this.path[a],{scroll:M,options:L}=k;k!==this.root&&M&&L.layoutScroll&&(M.wasRoot&&Ol(b,v),bm(b.x,M.offset.x),bm(b.y,M.offset.y))}return b}applyTransform(v,b=!1){const a=ps();Ol(a,v);for(let k=0;k<this.path.length;k++){const M=this.path[k];!b&&M.options.layoutScroll&&M.scroll&&M!==M.root&&Tm(a,{x:-M.scroll.offset.x,y:-M.scroll.offset.y}),jf(M.latestValues)&&Tm(a,M.latestValues)}return jf(this.latestValues)&&Tm(a,this.latestValues),a}removeTransform(v){const b=ps();Ol(b,v);for(let a=0;a<this.path.length;a++){const k=this.path[a];if(!k.instance||!jf(k.latestValues))continue;Qw(k.latestValues)&&k.updateSnapshot();const M=ps(),L=k.measurePageBox();Ol(M,L),uA(b,k.latestValues,k.snapshot?k.snapshot.layoutBox:void 0,M)}return jf(this.latestValues)&&uA(b,this.latestValues),b}setTargetDelta(v){this.targetDelta=v,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(v){this.options={...this.options,...v,crossfade:v.crossfade!==void 0?v.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Ws.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(v=!1){const b=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=b.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=b.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=b.isSharedProjectionDirty);const a=!!this.resumingFrom||this!==b;if(!(v||a&&this.isSharedProjectionDirty||this.isProjectionDirty||this.parent?.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:M,layoutId:L}=this.options;if(!this.layout||!(M||L))return;this.resolvedRelativeTargetAt=Ws.timestamp;const z=this.getClosestProjectingParent();z&&this.linkedParentVersion!==z.layoutVersion&&!z.options.layoutRoot&&this.removeRelativeTarget(),!this.targetDelta&&!this.relativeTarget&&(z&&z.layout?this.createRelativeTarget(z,this.layout.layoutBox,z.layout.layoutBox):this.removeRelativeTarget()),!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=ps(),this.targetWithTransforms=ps()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),pG(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Ol(this.target,this.layout.layoutBox),NN(this.target,this.targetDelta)):Ol(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget&&(this.attemptToResolveRelativeTarget=!1,z&&!!z.resumingFrom==!!this.resumingFrom&&!z.options.layoutScroll&&z.target&&this.animationProgress!==1?this.createRelativeTarget(z,this.target,z.target):this.relativeParent=this.relativeTarget=void 0))}getClosestProjectingParent(){if(!(!this.parent||Qw(this.parent.latestValues)||RN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}createRelativeTarget(v,b,a){this.relativeParent=v,this.linkedParentVersion=v.layoutVersion,this.forceRelativeParentToResolveTarget(),this.relativeTarget=ps(),this.relativeTargetOrigin=ps(),iv(this.relativeTargetOrigin,b,a),Ol(this.relativeTarget,this.relativeTargetOrigin)}removeRelativeTarget(){this.relativeParent=this.relativeTarget=void 0}calcProjection(){const v=this.getLead(),b=!!this.resumingFrom||this!==v;let a=!0;if((this.isProjectionDirty||this.parent?.isProjectionDirty)&&(a=!1),b&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(a=!1),this.resolvedRelativeTargetAt===Ws.timestamp&&(a=!1),a)return;const{layout:k,layoutId:M}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(k||M))return;Ol(this.layoutCorrected,this.layout.layoutBox);const L=this.treeScale.x,z=this.treeScale.y;$9(this.layoutCorrected,this.treeScale,this.path,b),v.layout&&!v.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(v.target=v.layout.layoutBox,v.targetWithTransforms=ps());const{target:O}=v;if(!O){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(iA(this.prevProjectionDelta.x,this.projectionDelta.x),iA(this.prevProjectionDelta.y,this.projectionDelta.y)),wy(this.projectionDelta,this.layoutCorrected,O,this.latestValues),(this.treeScale.x!==L||this.treeScale.y!==z||!mA(this.projectionDelta.x,this.prevProjectionDelta.x)||!mA(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",O))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(v=!0){if(this.options.visualElement?.scheduleRender(),v){const b=this.getStack();b&&b.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=wm(),this.projectionDelta=wm(),this.projectionDeltaWithTransform=wm()}setAnimationOrigin(v,b=!1){const a=this.snapshot,k=a?a.latestValues:{},M={...this.latestValues},L=wm();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!b;const z=ps(),O=a?a.source:void 0,K=this.layout?this.layout.source:void 0,H=O!==K,Z=this.getStack(),Y=!Z||Z.members.length<=1,ee=!!(H&&!Y&&this.options.crossfade===!0&&!this.path.some(UG));this.animationProgress=0;let ie;this.mixTargetDelta=pe=>{const we=pe/1e3;bA(L.x,v.x,we),bA(L.y,v.y,we),this.setTargetDelta(L),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(iv(z,this.layout.layoutBox,this.relativeParent.layout.layoutBox),VG(this.relativeTarget,this.relativeTargetOrigin,z,we),ie&&_G(this.relativeTarget,ie)&&(this.isProjectionDirty=!1),ie||(ie=ps()),Ol(ie,this.relativeTarget)),H&&(this.animationValues=M,wG(M,k,this.latestValues,we,ee,Y)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=we},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(v){this.notifyListeners("animationStart"),this.currentAnimation?.stop(),this.resumingFrom?.currentAnimation?.stop(),this.pendingAnimation&&(Ju(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ei.update(()=>{Nx.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Yf(0)),this.currentAnimation=SG(this.motionValue,[0,1e3],{...v,velocity:0,isSync:!0,onUpdate:b=>{this.mixTargetDelta(b),v.onUpdate&&v.onUpdate(b)},onStop:()=>{},onComplete:()=>{v.onComplete&&v.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const v=this.getStack();v&&v.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(IG),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const v=this.getLead();let{targetWithTransforms:b,target:a,layout:k,latestValues:M}=v;if(!(!b||!a||!k)){if(this!==v&&this.layout&&k&&YN(this.options.animationType,this.layout.layoutBox,k.layoutBox)){a=this.target||ps();const L=Do(this.layout.layoutBox.x);a.x.min=v.target.x.min,a.x.max=a.x.min+L;const z=Do(this.layout.layoutBox.y);a.y.min=v.target.y.min,a.y.max=a.y.min+z}Ol(b,a),Tm(b,M),wy(this.projectionDeltaWithTransform,this.layoutCorrected,b,M)}}registerSharedNode(v,b){this.sharedNodes.has(v)||this.sharedNodes.set(v,new AG),this.sharedNodes.get(v).add(b);const k=b.options.initialPromotionConfig;b.promote({transition:k?k.transition:void 0,preserveFollowOpacity:k&&k.shouldPreserveFollowOpacity?k.shouldPreserveFollowOpacity(b):void 0})}isLead(){const v=this.getStack();return v?v.lead===this:!0}getLead(){const{layoutId:v}=this.options;return v?this.getStack()?.lead||this:this}getPrevLead(){const{layoutId:v}=this.options;return v?this.getStack()?.prevLead:void 0}getStack(){const{layoutId:v}=this.options;if(v)return this.root.sharedNodes.get(v)}promote({needsReset:v,transition:b,preserveFollowOpacity:a}={}){const k=this.getStack();k&&k.promote(this,a),v&&(this.projectionDelta=void 0,this.needsReset=!0),b&&this.setOptions({transition:b})}relegate(){const v=this.getStack();return v?v.relegate(this):!1}resetSkewAndRotation(){const{visualElement:v}=this.options;if(!v)return;let b=!1;const{latestValues:a}=v;if((a.z||a.rotate||a.rotateX||a.rotateY||a.rotateZ||a.skewX||a.skewY)&&(b=!0),!b)return;const k={};a.z&&L1("z",v,k,this.animationValues);for(let M=0;M<D1.length;M++)L1(`rotate${D1[M]}`,v,k,this.animationValues),L1(`skew${D1[M]}`,v,k,this.animationValues);v.render();for(const M in k)v.setStaticValue(M,k[M]),this.animationValues&&(this.animationValues[M]=k[M]);v.scheduleRender()}applyProjectionStyles(v,b){if(!this.instance||this.isSVG)return;if(!this.isVisible){v.visibility="hidden";return}const a=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,v.visibility="",v.opacity="",v.pointerEvents=Rx(b?.pointerEvents)||"",v.transform=a?a(this.latestValues,""):"none";return}const k=this.getLead();if(!this.projectionDelta||!this.layout||!k.target){this.options.layoutId&&(v.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,v.pointerEvents=Rx(b?.pointerEvents)||""),this.hasProjected&&!jf(this.latestValues)&&(v.transform=a?a({},""):"none",this.hasProjected=!1);return}v.visibility="";const M=k.animationValues||k.latestValues;this.applyTransformsToTarget();let L=xG(this.projectionDeltaWithTransform,this.treeScale,M);a&&(L=a(M,L)),v.transform=L;const{x:z,y:O}=this.projectionDelta;v.transformOrigin=`${z.origin*100}% ${O.origin*100}% 0`,k.animationValues?v.opacity=k===this?M.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:M.opacityExit:v.opacity=k===this?M.opacity!==void 0?M.opacity:"":M.opacityExit!==void 0?M.opacityExit:0;for(const K in tb){if(M[K]===void 0)continue;const{correct:H,applyTo:Z,isCSSVariable:Y}=tb[K],ee=L==="none"?M[K]:H(M[K],k);if(Z){const ie=Z.length;for(let pe=0;pe<ie;pe++)v[Z[pe]]=ee}else Y?this.options.visualElement.renderState.vars[K]=ee:v[K]=ee}this.options.layoutId&&(v.pointerEvents=k===this?Rx(b?.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(v=>v.currentAnimation?.stop()),this.root.nodes.forEach(xA),this.root.sharedNodes.clear()}}}function PG(t){t.updateLayout()}function RG(t){const e=t.resumeFrom?.snapshot||t.snapshot;if(t.isLead()&&t.layout&&e&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:l}=t.layout,{animationType:u}=t.options,m=e.source!==t.layout.source;u==="size"?Ja(M=>{const L=m?e.measuredBox[M]:e.layoutBox[M],z=Do(L);L.min=r[M].min,L.max=L.min+z}):YN(u,e.layoutBox,r)&&Ja(M=>{const L=m?e.measuredBox[M]:e.layoutBox[M],z=Do(r[M]);L.max=L.min+z,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[M].max=t.relativeTarget[M].min+z)});const v=wm();wy(v,r,e.layoutBox);const b=wm();m?wy(b,t.applyTransform(l,!0),e.measuredBox):wy(b,r,e.layoutBox);const a=!HN(v);let k=!1;if(!t.resumeFrom){const M=t.getClosestProjectingParent();if(M&&!M.resumeFrom){const{snapshot:L,layout:z}=M;if(L&&z){const O=ps();iv(O,e.layoutBox,L.layoutBox);const K=ps();iv(K,r,z.layoutBox),WN(O,K)||(k=!0),M.options.layoutRoot&&(t.relativeTarget=K,t.relativeTargetOrigin=O,t.relativeParent=M)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:e,delta:b,layoutDelta:v,hasLayoutChanged:a,hasRelativeLayoutChanged:k})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function NG(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function DG(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function LG(t){t.clearSnapshot()}function xA(t){t.clearMeasurements()}function vA(t){t.isLayoutDirty=!1}function jG(t){const{visualElement:e}=t.options;e&&e.getProps().onBeforeLayoutMeasure&&e.notify("BeforeLayoutMeasure"),t.resetTransform()}function wA(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function OG(t){t.resolveTargetDelta()}function zG(t){t.calcProjection()}function BG(t){t.resetSkewAndRotation()}function FG(t){t.removeLeadSnapshot()}function bA(t,e,r){t.translate=yi(e.translate,0,r),t.scale=yi(e.scale,1,r),t.origin=e.origin,t.originPoint=e.originPoint}function TA(t,e,r,l){t.min=yi(e.min,r.min,l),t.max=yi(e.max,r.max,l)}function VG(t,e,r,l){TA(t.x,e.x,r.x,l),TA(t.y,e.y,r.y,l)}function UG(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const $G={duration:.45,ease:[.4,0,.1,1]},SA=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),EA=SA("applewebkit/")&&!SA("chrome/")?Math.round:rl;function CA(t){t.min=EA(t.min),t.max=EA(t.max)}function GG(t){CA(t.x),CA(t.y)}function YN(t,e,r){return t==="position"||t==="preserve-aspect"&&!fG(pA(e),pA(r),.2)}function HG(t){return t!==t.root&&t.scroll?.wasRoot}const WG=KN({attachResizeListener:(t,e)=>Fy(t,"resize",e),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body?.scrollLeft||0,y:document.documentElement.scrollTop||document.body?.scrollTop||0}),checkIsScrollRoot:()=>!0}),j1={current:void 0},JN=KN({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!j1.current){const t=new WG({});t.mount(window),t.setOptions({layoutScroll:!0}),j1.current=t}return j1.current},resetTransform:(t,e)=>{t.style.transform=e!==void 0?e:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),Wv=P.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});function kA(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function qG(...t){return e=>{let r=!1;const l=t.map(u=>{const m=kA(u,e);return!r&&typeof m=="function"&&(r=!0),m});if(r)return()=>{for(let u=0;u<l.length;u++){const m=l[u];typeof m=="function"?m():kA(t[u],null)}}}}function ZG(...t){return P.useCallback(qG(...t),t)}class XG extends P.Component{getSnapshotBeforeUpdate(e){const r=this.props.childRef.current;if(r&&e.isPresent&&!this.props.isPresent){const l=r.offsetParent,u=Yw(l)&&l.offsetWidth||0,m=Yw(l)&&l.offsetHeight||0,v=this.props.sizeRef.current;v.height=r.offsetHeight||0,v.width=r.offsetWidth||0,v.top=r.offsetTop,v.left=r.offsetLeft,v.right=u-v.width-v.left,v.bottom=m-v.height-v.top}return null}componentDidUpdate(){}render(){return this.props.children}}function KG({children:t,isPresent:e,anchorX:r,anchorY:l,root:u}){const m=P.useId(),v=P.useRef(null),b=P.useRef({width:0,height:0,top:0,left:0,right:0,bottom:0}),{nonce:a}=P.useContext(Wv),k=t.props?.ref??t?.ref,M=ZG(v,k);return P.useInsertionEffect(()=>{const{width:L,height:z,top:O,left:K,right:H,bottom:Z}=b.current;if(e||!v.current||!L||!z)return;const Y=r==="left"?`left: ${K}`:`right: ${H}`,ee=l==="bottom"?`bottom: ${Z}`:`top: ${O}`;v.current.dataset.motionPopId=m;const ie=document.createElement("style");a&&(ie.nonce=a);const pe=u??document.head;return pe.appendChild(ie),ie.sheet&&ie.sheet.insertRule(`
          [data-motion-pop-id="${m}"] {
            position: absolute !important;
            width: ${L}px !important;
            height: ${z}px !important;
            ${Y}px !important;
            ${ee}px !important;
          }
        `),()=>{pe.contains(ie)&&pe.removeChild(ie)}},[e]),x.jsx(XG,{isPresent:e,childRef:v,sizeRef:b,children:P.cloneElement(t,{ref:M})})}const YG=({children:t,initial:e,isPresent:r,onExitComplete:l,custom:u,presenceAffectsLayout:m,mode:v,anchorX:b,anchorY:a,root:k})=>{const M=op(JG),L=P.useId();let z=!0,O=P.useMemo(()=>(z=!1,{id:L,initial:e,isPresent:r,custom:u,onExitComplete:K=>{M.set(K,!0);for(const H of M.values())if(!H)return;l&&l()},register:K=>(M.set(K,!1),()=>M.delete(K))}),[r,M,l]);return m&&z&&(O={...O}),P.useMemo(()=>{M.forEach((K,H)=>M.set(H,!1))},[r]),P.useEffect(()=>{!r&&!M.size&&l&&l()},[r]),v==="popLayout"&&(t=x.jsx(KG,{isPresent:r,anchorX:b,anchorY:a,root:k,children:t})),x.jsx($v.Provider,{value:O,children:t})};function JG(){return new Map}function QN(t=!0){const e=P.useContext($v);if(e===null)return[!0,null];const{isPresent:r,onExitComplete:l,register:u}=e,m=P.useId();P.useEffect(()=>{if(t)return u(m)},[t]);const v=P.useCallback(()=>t&&l&&l(m),[m,l,t]);return!r&&l?[!1,v]:[!0]}const hx=t=>t.key||"";function AA(t){const e=[];return P.Children.forEach(t,r=>{P.isValidElement(r)&&e.push(r)}),e}const Ta=({children:t,custom:e,initial:r=!0,onExitComplete:l,presenceAffectsLayout:u=!0,mode:m="sync",propagate:v=!1,anchorX:b="left",anchorY:a="top",root:k})=>{const[M,L]=QN(v),z=P.useMemo(()=>AA(t),[t]),O=v&&!M?[]:z.map(hx),K=P.useRef(!0),H=P.useRef(z),Z=op(()=>new Map),Y=P.useRef(new Set),[ee,ie]=P.useState(z),[pe,we]=P.useState(z);cT(()=>{K.current=!1,H.current=z;for(let Ge=0;Ge<pe.length;Ge++){const tt=hx(pe[Ge]);O.includes(tt)?(Z.delete(tt),Y.current.delete(tt)):Z.get(tt)!==!0&&Z.set(tt,!1)}},[pe,O.length,O.join("-")]);const ke=[];if(z!==ee){let Ge=[...z];for(let tt=0;tt<pe.length;tt++){const Pe=pe[tt],ot=hx(Pe);O.includes(ot)||(Ge.splice(tt,0,Pe),ke.push(Pe))}return m==="wait"&&ke.length&&(Ge=ke),we(AA(Ge)),ie(z),null}const{forceRender:ze}=P.useContext(lT);return x.jsx(x.Fragment,{children:pe.map(Ge=>{const tt=hx(Ge),Pe=v&&!M?!1:z===pe||O.includes(tt),ot=()=>{if(Y.current.has(tt))return;if(Y.current.add(tt),Z.has(tt))Z.set(tt,!0);else return;let ut=!0;Z.forEach(gt=>{gt||(ut=!1)}),ut&&(ze?.(),we(H.current),v&&L?.(),l&&l())};return x.jsx(YG,{isPresent:Pe,initial:!K.current||r?void 0:!1,custom:e,presenceAffectsLayout:u,mode:m,root:k,onExitComplete:Pe?void 0:ot,anchorX:b,anchorY:a,children:Ge},tt)})})},e3=P.createContext({strict:!1}),IA={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]};let MA=!1;function QG(){if(MA)return;const t={};for(const e in IA)t[e]={isEnabled:r=>IA[e].some(l=>!!r[l])};IN(t),MA=!0}function t3(){return QG(),B9()}function eH(t){const e=t3();for(const r in t)e[r]={...e[r],...t[r]};IN(e)}const tH=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function sv(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||tH.has(t)}let n3=t=>!sv(t);function nH(t){typeof t=="function"&&(n3=e=>e.startsWith("on")?!sv(e):t(e))}try{nH(require("@emotion/is-prop-valid").default)}catch{}function rH(t,e,r){const l={};for(const u in t)u==="values"&&typeof t.values=="object"||(n3(u)||r===!0&&sv(u)||!e&&!sv(u)||t.draggable&&u.startsWith("onDrag"))&&(l[u]=t[u]);return l}const qv=P.createContext({});function iH(t,e){if(Hv(t)){const{initial:r,animate:l}=t;return{initial:r===!1||By(r)?r:void 0,animate:By(l)?l:void 0}}return t.inherit!==!1?e:{}}function sH(t){const{initial:e,animate:r}=iH(t,P.useContext(qv));return P.useMemo(()=>({initial:e,animate:r}),[PA(e),PA(r)])}function PA(t){return Array.isArray(t)?t.join(" "):t}const OT=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function r3(t,e,r){for(const l in e)!Zs(e[l])&&!jN(l,r)&&(t[l]=e[l])}function oH({transformTemplate:t},e){return P.useMemo(()=>{const r=OT();return LT(r,e,t),Object.assign({},r.vars,r.style)},[e])}function aH(t,e){const r=t.style||{},l={};return r3(l,r,t),Object.assign(l,oH(t,e)),l}function lH(t,e){const r={},l=aH(t,e);return t.drag&&t.dragListener!==!1&&(r.draggable=!1,l.userSelect=l.WebkitUserSelect=l.WebkitTouchCallout="none",l.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(r.tabIndex=0),r.style=l,r}const i3=()=>({...OT(),attrs:{}});function cH(t,e,r,l){const u=P.useMemo(()=>{const m=i3();return ON(m,e,BN(l),t.transformTemplate,t.style),{...m.attrs,style:{...m.style}}},[e]);if(t.style){const m={};r3(m,t.style,t),u.style={...m,...u.style}}return u}const uH=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function zT(t){return typeof t!="string"||t.includes("-")?!1:!!(uH.indexOf(t)>-1||/[A-Z]/u.test(t))}function dH(t,e,r,{latestValues:l},u,m=!1,v){const a=(v??zT(t)?cH:lH)(e,l,u,t),k=rH(e,typeof t=="string",m),M=t!==P.Fragment?{...k,...a,ref:r}:{},{children:L}=e,z=P.useMemo(()=>Zs(L)?L.get():L,[L]);return P.createElement(t,{...M,children:z})}function hH({scrapeMotionValuesFromProps:t,createRenderState:e},r,l,u){return{latestValues:fH(r,l,u,t),renderState:e()}}function fH(t,e,r,l){const u={},m=l(t,{});for(const z in m)u[z]=Rx(m[z]);let{initial:v,animate:b}=t;const a=Hv(t),k=AN(t);e&&k&&!a&&t.inherit!==!1&&(v===void 0&&(v=e.initial),b===void 0&&(b=e.animate));let M=r?r.initial===!1:!1;M=M||v===!1;const L=M?b:v;if(L&&typeof L!="boolean"&&!Gv(L)){const z=Array.isArray(L)?L:[L];for(let O=0;O<z.length;O++){const K=AT(t,z[O]);if(K){const{transitionEnd:H,transition:Z,...Y}=K;for(const ee in Y){let ie=Y[ee];if(Array.isArray(ie)){const pe=M?ie.length-1:0;ie=ie[pe]}ie!==null&&(u[ee]=ie)}for(const ee in H)u[ee]=H[ee]}}}return u}const s3=t=>(e,r)=>{const l=P.useContext(qv),u=P.useContext($v),m=()=>hH(t,e,l,u);return r?m():op(m)},pH=s3({scrapeMotionValuesFromProps:jT,createRenderState:OT}),mH=s3({scrapeMotionValuesFromProps:FN,createRenderState:i3}),gH=Symbol.for("motionComponentSymbol");function yH(t,e,r){const l=P.useRef(r);P.useInsertionEffect(()=>{l.current=r});const u=P.useRef(null);return P.useCallback(m=>{m&&t.onMount?.(m),e&&(m?e.mount(m):e.unmount());const v=l.current;if(typeof v=="function")if(m){const b=v(m);typeof b=="function"&&(u.current=b)}else u.current?(u.current(),u.current=null):v(m);else v&&(v.current=m)},[e])}const o3=P.createContext({});function oy(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function _H(t,e,r,l,u,m){const{visualElement:v}=P.useContext(qv),b=P.useContext(e3),a=P.useContext($v),k=P.useContext(Wv).reducedMotion,M=P.useRef(null),L=P.useRef(!1);l=l||b.renderer,!M.current&&l&&(M.current=l(t,{visualState:e,parent:v,props:r,presenceContext:a,blockInitialAnimation:a?a.initial===!1:!1,reducedMotionConfig:k,isSVG:m}),L.current&&M.current&&(M.current.manuallyAnimateOnMount=!0));const z=M.current,O=P.useContext(o3);z&&!z.projection&&u&&(z.type==="html"||z.type==="svg")&&xH(M.current,r,u,O);const K=P.useRef(!1);P.useInsertionEffect(()=>{z&&K.current&&z.update(r,a)});const H=r[pN],Z=P.useRef(!!H&&!window.MotionHandoffIsComplete?.(H)&&window.MotionHasOptimisedAnimation?.(H));return cT(()=>{L.current=!0,z&&(K.current=!0,window.MotionIsMounted=!0,z.updateFeatures(),z.scheduleRenderMicrotask(),Z.current&&z.animationState&&z.animationState.animateChanges())}),P.useEffect(()=>{z&&(!Z.current&&z.animationState&&z.animationState.animateChanges(),Z.current&&(queueMicrotask(()=>{window.MotionHandoffMarkAsComplete?.(H)}),Z.current=!1),z.enteringChildren=void 0)}),z}function xH(t,e,r,l){const{layoutId:u,layout:m,drag:v,dragConstraints:b,layoutScroll:a,layoutRoot:k,layoutCrossfade:M}=e;t.projection=new r(t.latestValues,e["data-framer-portal-id"]?void 0:a3(t.parent)),t.projection.setOptions({layoutId:u,layout:m,alwaysMeasureLayout:!!v||b&&oy(b),visualElement:t,animationType:typeof m=="string"?m:"both",initialPromotionConfig:l,crossfade:M,layoutScroll:a,layoutRoot:k})}function a3(t){if(t)return t.options.allowProjection!==!1?t.projection:a3(t.parent)}function O1(t,{forwardMotionProps:e=!1,type:r}={},l,u){l&&eH(l);const m=r?r==="svg":zT(t),v=m?mH:pH;function b(k,M){let L;const z={...P.useContext(Wv),...k,layoutId:vH(k)},{isStatic:O}=z,K=sH(k),H=v(k,O);if(!O&&MR){wH();const Z=bH(z);L=Z.MeasureLayout,K.visualElement=_H(t,H,z,u,Z.ProjectionNode,m)}return x.jsxs(qv.Provider,{value:K,children:[L&&K.visualElement?x.jsx(L,{visualElement:K.visualElement,...z}):null,dH(t,k,yH(H,K.visualElement,M),H,O,e,m)]})}b.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const a=P.forwardRef(b);return a[gH]=t,a}function vH({layoutId:t}){const e=P.useContext(lT).id;return e&&t!==void 0?e+"-"+t:t}function wH(t,e){P.useContext(e3).strict}function bH(t){const e=t3(),{drag:r,layout:l}=e;if(!r&&!l)return{};const u={...r,...l};return{MeasureLayout:r?.isEnabled(t)||l?.isEnabled(t)?u.MeasureLayout:void 0,ProjectionNode:u.ProjectionNode}}function TH(t,e){if(typeof Proxy>"u")return O1;const r=new Map,l=(m,v)=>O1(m,v,t,e),u=(m,v)=>l(m,v);return new Proxy(u,{get:(m,v)=>v==="create"?l:(r.has(v)||r.set(v,O1(v,void 0,t,e)),r.get(v))})}const SH=(t,e)=>e.isSVG??zT(t)?new nG(e):new K9(e,{allowProjection:t!==P.Fragment});class EH extends Th{constructor(e){super(e),e.animationState||(e.animationState=aG(e))}updateAnimationControlsSubscription(){const{animate:e}=this.node.getProps();Gv(e)&&(this.unmountControls=e.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:e}=this.node.getProps(),{animate:r}=this.node.prevProps||{};e!==r&&this.updateAnimationControlsSubscription()}unmount(){this.node.animationState.reset(),this.unmountControls?.()}}let CH=0;class kH extends Th{constructor(){super(...arguments),this.id=CH++}update(){if(!this.node.presenceContext)return;const{isPresent:e,onExitComplete:r}=this.node.presenceContext,{isPresent:l}=this.node.prevPresenceContext||{};if(!this.node.animationState||e===l)return;const u=this.node.animationState.setActive("exit",!e);r&&!e&&u.then(()=>{r(this.id)})}mount(){const{register:e,onExitComplete:r}=this.node.presenceContext||{};r&&r(this.id),e&&(this.unmount=e(this.id))}unmount(){}}const AH={animation:{Feature:EH},exit:{Feature:kH}};function c_(t){return{point:{x:t.pageX,y:t.pageY}}}const IH=t=>e=>RT(e)&&t(e,c_(e));function by(t,e,r,l){return Fy(t,e,IH(r),l)}const l3=({current:t})=>t?t.ownerDocument.defaultView:null,RA=(t,e)=>Math.abs(t-e);function MH(t,e){const r=RA(t.x,e.x),l=RA(t.y,e.y);return Math.sqrt(r**2+l**2)}const NA=new Set(["auto","scroll"]);class c3{constructor(e,r,{transformPagePoint:l,contextWindow:u=window,dragSnapToOrigin:m=!1,distanceThreshold:v=3,element:b}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.scrollPositions=new Map,this.removeScrollListeners=null,this.onElementScroll=O=>{this.handleScroll(O.target)},this.onWindowScroll=()=>{this.handleScroll(window)},this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const O=B1(this.lastMoveEventInfo,this.history),K=this.startEvent!==null,H=MH(O.offset,{x:0,y:0})>=this.distanceThreshold;if(!K&&!H)return;const{point:Z}=O,{timestamp:Y}=Ws;this.history.push({...Z,timestamp:Y});const{onStart:ee,onMove:ie}=this.handlers;K||(ee&&ee(this.lastMoveEvent,O),this.startEvent=this.lastMoveEvent),ie&&ie(this.lastMoveEvent,O)},this.handlePointerMove=(O,K)=>{this.lastMoveEvent=O,this.lastMoveEventInfo=z1(K,this.transformPagePoint),ei.update(this.updatePoint,!0)},this.handlePointerUp=(O,K)=>{this.end();const{onEnd:H,onSessionEnd:Z,resumeAnimation:Y}=this.handlers;if((this.dragSnapToOrigin||!this.startEvent)&&Y&&Y(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const ee=B1(O.type==="pointercancel"?this.lastMoveEventInfo:z1(K,this.transformPagePoint),this.history);this.startEvent&&H&&H(O,ee),Z&&Z(O,ee)},!RT(e))return;this.dragSnapToOrigin=m,this.handlers=r,this.transformPagePoint=l,this.distanceThreshold=v,this.contextWindow=u||window;const a=c_(e),k=z1(a,this.transformPagePoint),{point:M}=k,{timestamp:L}=Ws;this.history=[{...M,timestamp:L}];const{onSessionStart:z}=r;z&&z(e,B1(k,this.history)),this.removeListeners=o_(by(this.contextWindow,"pointermove",this.handlePointerMove),by(this.contextWindow,"pointerup",this.handlePointerUp),by(this.contextWindow,"pointercancel",this.handlePointerUp)),b&&this.startScrollTracking(b)}startScrollTracking(e){let r=e.parentElement;for(;r;){const l=getComputedStyle(r);(NA.has(l.overflowX)||NA.has(l.overflowY))&&this.scrollPositions.set(r,{x:r.scrollLeft,y:r.scrollTop}),r=r.parentElement}this.scrollPositions.set(window,{x:window.scrollX,y:window.scrollY}),window.addEventListener("scroll",this.onElementScroll,{capture:!0,passive:!0}),window.addEventListener("scroll",this.onWindowScroll,{passive:!0}),this.removeScrollListeners=()=>{window.removeEventListener("scroll",this.onElementScroll,{capture:!0}),window.removeEventListener("scroll",this.onWindowScroll)}}handleScroll(e){const r=this.scrollPositions.get(e);if(!r)return;const l=e===window,u=l?{x:window.scrollX,y:window.scrollY}:{x:e.scrollLeft,y:e.scrollTop},m={x:u.x-r.x,y:u.y-r.y};m.x===0&&m.y===0||(l?this.lastMoveEventInfo&&(this.lastMoveEventInfo.point.x+=m.x,this.lastMoveEventInfo.point.y+=m.y):this.history.length>0&&(this.history[0].x-=m.x,this.history[0].y-=m.y),this.scrollPositions.set(e,u),ei.update(this.updatePoint,!0))}updateHandlers(e){this.handlers=e}end(){this.removeListeners&&this.removeListeners(),this.removeScrollListeners&&this.removeScrollListeners(),this.scrollPositions.clear(),Ju(this.updatePoint)}}function z1(t,e){return e?{point:e(t.point)}:t}function DA(t,e){return{x:t.x-e.x,y:t.y-e.y}}function B1({point:t},e){return{point:t,delta:DA(t,u3(e)),offset:DA(t,PH(e)),velocity:RH(e,.1)}}function PH(t){return t[0]}function u3(t){return t[t.length-1]}function RH(t,e){if(t.length<2)return{x:0,y:0};let r=t.length-1,l=null;const u=u3(t);for(;r>=0&&(l=t[r],!(u.timestamp-l.timestamp>Wu(e)));)r--;if(!l)return{x:0,y:0};const m=tl(u.timestamp-l.timestamp);if(m===0)return{x:0,y:0};const v={x:(u.x-l.x)/m,y:(u.y-l.y)/m};return v.x===1/0&&(v.x=0),v.y===1/0&&(v.y=0),v}function NH(t,{min:e,max:r},l){return e!==void 0&&t<e?t=l?yi(e,t,l.min):Math.max(t,e):r!==void 0&&t>r&&(t=l?yi(r,t,l.max):Math.min(t,r)),t}function LA(t,e,r){return{min:e!==void 0?t.min+e:void 0,max:r!==void 0?t.max+r-(t.max-t.min):void 0}}function DH(t,{top:e,left:r,bottom:l,right:u}){return{x:LA(t.x,r,u),y:LA(t.y,e,l)}}function jA(t,e){let r=e.min-t.min,l=e.max-t.max;return e.max-e.min<t.max-t.min&&([r,l]=[l,r]),{min:r,max:l}}function LH(t,e){return{x:jA(t.x,e.x),y:jA(t.y,e.y)}}function jH(t,e){let r=.5;const l=Do(t),u=Do(e);return u>l?r=jy(e.min,e.max-l,t.min):l>u&&(r=jy(t.min,t.max-u,e.min)),Kc(0,1,r)}function OH(t,e){const r={};return e.min!==void 0&&(r.min=e.min-t.min),e.max!==void 0&&(r.max=e.max-t.min),r}const nb=.35;function zH(t=nb){return t===!1?t=0:t===!0&&(t=nb),{x:OA(t,"left","right"),y:OA(t,"top","bottom")}}function OA(t,e,r){return{min:zA(t,e),max:zA(t,r)}}function zA(t,e){return typeof t=="number"?t:t[e]||0}const BH=new WeakMap;class FH{constructor(e){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=ps(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=e}start(e,{snapToCursor:r=!1,distanceThreshold:l}={}){const{presenceContext:u}=this.visualElement;if(u&&u.isPresent===!1)return;const m=L=>{r?(this.stopAnimation(),this.snapToCursor(c_(L).point)):this.pauseAnimation()},v=(L,z)=>{this.stopAnimation();const{drag:O,dragPropagation:K,onDragStart:H}=this.getProps();if(O&&!K&&(this.openDragLock&&this.openDragLock(),this.openDragLock=C9(O),!this.openDragLock))return;this.latestPointerEvent=L,this.latestPanInfo=z,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ja(Y=>{let ee=this.getAxisMotionValue(Y).get()||0;if(qc.test(ee)){const{projection:ie}=this.visualElement;if(ie&&ie.layout){const pe=ie.layout.layoutBox[Y];pe&&(ee=Do(pe)*(parseFloat(ee)/100))}}this.originPoint[Y]=ee}),H&&ei.postRender(()=>H(L,z)),Zw(this.visualElement,"transform");const{animationState:Z}=this.visualElement;Z&&Z.setActive("whileDrag",!0)},b=(L,z)=>{this.latestPointerEvent=L,this.latestPanInfo=z;const{dragPropagation:O,dragDirectionLock:K,onDirectionLock:H,onDrag:Z}=this.getProps();if(!O&&!this.openDragLock)return;const{offset:Y}=z;if(K&&this.currentDirection===null){this.currentDirection=VH(Y),this.currentDirection!==null&&H&&H(this.currentDirection);return}this.updateAxis("x",z.point,Y),this.updateAxis("y",z.point,Y),this.visualElement.render(),Z&&Z(L,z)},a=(L,z)=>{this.latestPointerEvent=L,this.latestPanInfo=z,this.stop(L,z),this.latestPointerEvent=null,this.latestPanInfo=null},k=()=>Ja(L=>this.getAnimationState(L)==="paused"&&this.getAxisMotionValue(L).animation?.play()),{dragSnapToOrigin:M}=this.getProps();this.panSession=new c3(e,{onSessionStart:m,onStart:v,onMove:b,onSessionEnd:a,resumeAnimation:k},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:M,distanceThreshold:l,contextWindow:l3(this.visualElement),element:this.visualElement.current})}stop(e,r){const l=e||this.latestPointerEvent,u=r||this.latestPanInfo,m=this.isDragging;if(this.cancel(),!m||!u||!l)return;const{velocity:v}=u;this.startAnimation(v);const{onDragEnd:b}=this.getProps();b&&ei.postRender(()=>b(l,u))}cancel(){this.isDragging=!1;const{projection:e,animationState:r}=this.visualElement;e&&(e.isAnimationBlocked=!1),this.endPanSession();const{dragPropagation:l}=this.getProps();!l&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),r&&r.setActive("whileDrag",!1)}endPanSession(){this.panSession&&this.panSession.end(),this.panSession=void 0}updateAxis(e,r,l){const{drag:u}=this.getProps();if(!l||!fx(e,u,this.currentDirection))return;const m=this.getAxisMotionValue(e);let v=this.originPoint[e]+l[e];this.constraints&&this.constraints[e]&&(v=NH(v,this.constraints[e],this.elastic[e])),m.set(v)}resolveConstraints(){const{dragConstraints:e,dragElastic:r}=this.getProps(),l=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):this.visualElement.projection?.layout,u=this.constraints;e&&oy(e)?this.constraints||(this.constraints=this.resolveRefConstraints()):e&&l?this.constraints=DH(l.layoutBox,e):this.constraints=!1,this.elastic=zH(r),u!==this.constraints&&l&&this.constraints&&!this.hasMutatedConstraints&&Ja(m=>{this.constraints!==!1&&this.getAxisMotionValue(m)&&(this.constraints[m]=OH(l.layoutBox[m],this.constraints[m]))})}resolveRefConstraints(){const{dragConstraints:e,onMeasureDragConstraints:r}=this.getProps();if(!e||!oy(e))return!1;const l=e.current,{projection:u}=this.visualElement;if(!u||!u.layout)return!1;const m=G9(l,u.root,this.visualElement.getTransformPagePoint());let v=LH(u.layout.layoutBox,m);if(r){const b=r(V9(v));this.hasMutatedConstraints=!!b,b&&(v=PN(b))}return v}startAnimation(e){const{drag:r,dragMomentum:l,dragElastic:u,dragTransition:m,dragSnapToOrigin:v,onDragTransitionEnd:b}=this.getProps(),a=this.constraints||{},k=Ja(M=>{if(!fx(M,r,this.currentDirection))return;let L=a&&a[M]||{};v&&(L={min:0,max:0});const z=u?200:1e6,O=u?40:1e7,K={type:"inertia",velocity:l?e[M]:0,bounceStiffness:z,bounceDamping:O,timeConstant:750,restDelta:1,restSpeed:10,...m,...L};return this.startAxisValueAnimation(M,K)});return Promise.all(k).then(b)}startAxisValueAnimation(e,r){const l=this.getAxisMotionValue(e);return Zw(this.visualElement,e),l.start(kT(e,l,0,r,this.visualElement,!1))}stopAnimation(){Ja(e=>this.getAxisMotionValue(e).stop())}pauseAnimation(){Ja(e=>this.getAxisMotionValue(e).animation?.pause())}getAnimationState(e){return this.getAxisMotionValue(e).animation?.state}getAxisMotionValue(e){const r=`_drag${e.toUpperCase()}`,l=this.visualElement.getProps(),u=l[r];return u||this.visualElement.getValue(e,(l.initial?l.initial[e]:void 0)||0)}snapToCursor(e){Ja(r=>{const{drag:l}=this.getProps();if(!fx(r,l,this.currentDirection))return;const{projection:u}=this.visualElement,m=this.getAxisMotionValue(r);if(u&&u.layout){const{min:v,max:b}=u.layout.layoutBox[r],a=m.get()||0;m.set(e[r]-yi(v,b,.5)+a)}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:e,dragConstraints:r}=this.getProps(),{projection:l}=this.visualElement;if(!oy(r)||!l||!this.constraints)return;this.stopAnimation();const u={x:0,y:0};Ja(v=>{const b=this.getAxisMotionValue(v);if(b&&this.constraints!==!1){const a=b.get();u[v]=jH({min:a,max:a},this.constraints[v])}});const{transformTemplate:m}=this.visualElement.getProps();this.visualElement.current.style.transform=m?m({},""):"none",l.root&&l.root.updateScroll(),l.updateLayout(),this.resolveConstraints(),Ja(v=>{if(!fx(v,e,null))return;const b=this.getAxisMotionValue(v),{min:a,max:k}=this.constraints[v];b.set(yi(a,k,u[v]))})}addListeners(){if(!this.visualElement.current)return;BH.set(this.visualElement,this);const e=this.visualElement.current,r=by(e,"pointerdown",a=>{const{drag:k,dragListener:M=!0}=this.getProps(),L=a.target,z=L!==e&&EN(L);k&&M&&!z&&this.start(a)}),l=()=>{const{dragConstraints:a}=this.getProps();oy(a)&&a.current&&(this.constraints=this.resolveRefConstraints())},{projection:u}=this.visualElement,m=u.addEventListener("measure",l);u&&!u.layout&&(u.root&&u.root.updateScroll(),u.updateLayout()),ei.read(l);const v=Fy(window,"resize",()=>this.scalePositionWithinConstraints()),b=u.addEventListener("didUpdate",(({delta:a,hasLayoutChanged:k})=>{this.isDragging&&k&&(Ja(M=>{const L=this.getAxisMotionValue(M);L&&(this.originPoint[M]+=a[M].translate,L.set(L.get()+a[M].translate))}),this.visualElement.render())}));return()=>{v(),r(),m(),b&&b()}}getProps(){const e=this.visualElement.getProps(),{drag:r=!1,dragDirectionLock:l=!1,dragPropagation:u=!1,dragConstraints:m=!1,dragElastic:v=nb,dragMomentum:b=!0}=e;return{...e,drag:r,dragDirectionLock:l,dragPropagation:u,dragConstraints:m,dragElastic:v,dragMomentum:b}}}function fx(t,e,r){return(e===!0||e===t)&&(r===null||r===t)}function VH(t,e=10){let r=null;return Math.abs(t.y)>e?r="y":Math.abs(t.x)>e&&(r="x"),r}class UH extends Th{constructor(e){super(e),this.removeGroupControls=rl,this.removeListeners=rl,this.controls=new FH(e)}mount(){const{dragControls:e}=this.node.getProps();e&&(this.removeGroupControls=e.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||rl}update(){const{dragControls:e}=this.node.getProps(),{dragControls:r}=this.node.prevProps||{};e!==r&&(this.removeGroupControls(),e&&(this.removeGroupControls=e.subscribe(this.controls)))}unmount(){this.removeGroupControls(),this.removeListeners(),this.controls.isDragging||this.controls.endPanSession()}}const BA=t=>(e,r)=>{t&&ei.postRender(()=>t(e,r))};class $H extends Th{constructor(){super(...arguments),this.removePointerDownListener=rl}onPointerDown(e){this.session=new c3(e,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:l3(this.node)})}createPanHandlers(){const{onPanSessionStart:e,onPanStart:r,onPan:l,onPanEnd:u}=this.node.getProps();return{onSessionStart:BA(e),onStart:BA(r),onMove:l,onEnd:(m,v)=>{delete this.session,u&&ei.postRender(()=>u(m,v))}}}mount(){this.removePointerDownListener=by(this.node.current,"pointerdown",e=>this.onPointerDown(e))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}let F1=!1;class GH extends P.Component{componentDidMount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:l,layoutId:u}=this.props,{projection:m}=e;m&&(r.group&&r.group.add(m),l&&l.register&&u&&l.register(m),F1&&m.root.didUpdate(),m.addEventListener("animationComplete",()=>{this.safeToRemove()}),m.setOptions({...m.options,layoutDependency:this.props.layoutDependency,onExitComplete:()=>this.safeToRemove()})),Nx.hasEverUpdated=!0}getSnapshotBeforeUpdate(e){const{layoutDependency:r,visualElement:l,drag:u,isPresent:m}=this.props,{projection:v}=l;return v&&(v.isPresent=m,e.layoutDependency!==r&&v.setOptions({...v.options,layoutDependency:r}),F1=!0,u||e.layoutDependency!==r||r===void 0||e.isPresent!==m?v.willUpdate():this.safeToRemove(),e.isPresent!==m&&(m?v.promote():v.relegate()||ei.postRender(()=>{const b=v.getStack();(!b||!b.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:e}=this.props.visualElement;e&&(e.root.didUpdate(),PT.postRender(()=>{!e.currentAnimation&&e.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:e,layoutGroup:r,switchLayoutGroup:l}=this.props,{projection:u}=e;F1=!0,u&&(u.scheduleCheckAfterUnmount(),r&&r.group&&r.group.remove(u),l&&l.deregister&&l.deregister(u))}safeToRemove(){const{safeToRemove:e}=this.props;e&&e()}render(){return null}}function d3(t){const[e,r]=QN(),l=P.useContext(lT);return x.jsx(GH,{...t,layoutGroup:l,switchLayoutGroup:P.useContext(o3),isPresent:e,safeToRemove:r})}const HH={pan:{Feature:$H},drag:{Feature:UH,ProjectionNode:JN,MeasureLayout:d3}};function FA(t,e,r){const{props:l}=t;t.animationState&&l.whileHover&&t.animationState.setActive("whileHover",r==="Start");const u="onHover"+r,m=l[u];m&&ei.postRender(()=>m(e,c_(e)))}class WH extends Th{mount(){const{current:e}=this.node;e&&(this.unmount=k9(e,(r,l)=>(FA(this.node,l,"Start"),u=>FA(this.node,u,"End"))))}unmount(){}}class qH extends Th{constructor(){super(...arguments),this.isActive=!1}onFocus(){let e=!1;try{e=this.node.current.matches(":focus-visible")}catch{e=!0}!e||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=o_(Fy(this.node.current,"focus",()=>this.onFocus()),Fy(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function VA(t,e,r){const{props:l}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&l.whileTap&&t.animationState.setActive("whileTap",r==="Start");const u="onTap"+(r==="End"?"":r),m=l[u];m&&ei.postRender(()=>m(e,c_(e)))}class ZH extends Th{mount(){const{current:e}=this.node;e&&(this.unmount=M9(e,(r,l)=>(VA(this.node,l,"Start"),(u,{success:m})=>VA(this.node,u,m?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const rb=new WeakMap,V1=new WeakMap,XH=t=>{const e=rb.get(t.target);e&&e(t)},KH=t=>{t.forEach(XH)};function YH({root:t,...e}){const r=t||document;V1.has(r)||V1.set(r,{});const l=V1.get(r),u=JSON.stringify(e);return l[u]||(l[u]=new IntersectionObserver(KH,{root:t,...e})),l[u]}function JH(t,e,r){const l=YH(e);return rb.set(t,r),l.observe(t),()=>{rb.delete(t),l.unobserve(t)}}const QH={some:0,all:1};class eW extends Th{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:e={}}=this.node.getProps(),{root:r,margin:l,amount:u="some",once:m}=e,v={root:r?r.current:void 0,rootMargin:l,threshold:typeof u=="number"?u:QH[u]},b=a=>{const{isIntersecting:k}=a;if(this.isInView===k||(this.isInView=k,m&&!k&&this.hasEnteredView))return;k&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",k);const{onViewportEnter:M,onViewportLeave:L}=this.node.getProps(),z=k?M:L;z&&z(a)};return JH(this.node.current,v,b)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:e,prevProps:r}=this.node;["amount","margin","root"].some(tW(e,r))&&this.startObserver()}unmount(){}}function tW({viewport:t={}},{viewport:e={}}={}){return r=>t[r]!==e[r]}const nW={inView:{Feature:eW},tap:{Feature:ZH},focus:{Feature:qH},hover:{Feature:WH}},rW={layout:{ProjectionNode:JN,MeasureLayout:d3}},iW={...AH,...nW,...HH,...rW},yr=TH(iW,SH);function h3(t){const e=op(()=>Yf(t)),{isStatic:r}=P.useContext(Wv);if(r){const[,l]=P.useState(t);P.useEffect(()=>e.on("change",l),[])}return e}function f3(t,e){const r=h3(e()),l=()=>r.set(e());return l(),cT(()=>{const u=()=>ei.preRender(l,!1,!0),m=t.map(v=>v.on("change",u));return()=>{m.forEach(v=>v()),Ju(l)}}),r}function sW(t){vy.current=[],t();const e=f3(vy.current,t);return vy.current=void 0,e}function oW(t,e,r,l){if(typeof t=="function")return sW(t);const m=typeof e=="function"?e:R9(e,r,l);return Array.isArray(t)?UA(t,m):UA([t],([v])=>m(v))}function UA(t,e){const r=op(()=>[]);return f3(t,()=>{r.length=0;const l=t.length;for(let u=0;u<l;u++)r[u]=t[u].get();return e(r)})}const p3=P.createContext(null);function aW(t,e,r,l){if(!l)return t;const u=t.findIndex(M=>M.value===e);if(u===-1)return t;const m=l>0?1:-1,v=t[u+m];if(!v)return t;const b=t[u],a=v.layout,k=yi(a.min,a.max,.5);return m===1&&b.layout.max+r>k||m===-1&&b.layout.min+r<k?T2(t,u,u+m):t}function lW({children:t,as:e="ul",axis:r="y",onReorder:l,values:u,...m},v){const b=op(()=>yr[e]),a=[],k=P.useRef(!1),M=P.useRef(null),L={axis:r,groupRef:M,registerItem:(K,H)=>{const Z=a.findIndex(Y=>K===Y.value);Z!==-1?a[Z].layout=H[r]:a.push({value:K,layout:H[r]}),a.sort(dW)},updateOrder:(K,H,Z)=>{if(k.current)return;const Y=aW(a,K,H,Z);a!==Y&&(k.current=!0,l(Y.map(uW).filter(ee=>u.indexOf(ee)!==-1)))}};P.useEffect(()=>{k.current=!1});const z=K=>{M.current=K,typeof v=="function"?v(K):v&&(v.current=K)},O={overflowAnchor:"none",...m.style};return x.jsx(b,{...m,style:O,ref:z,ignoreStrict:!0,children:x.jsx(p3.Provider,{value:L,children:t})})}const cW=P.forwardRef(lW);function uW(t){return t.value}function dW(t,e){return t.layout.min-e.layout.min}const px=50,$A=25,hW=new Set(["auto","scroll"]),Ty=new WeakMap,Sy=new WeakMap;let ay=null;function fW(){if(ay){const t=ib(ay,"y");t&&(Sy.delete(t),Ty.delete(t));const e=ib(ay,"x");e&&e!==t&&(Sy.delete(e),Ty.delete(e)),ay=null}}function pW(t,e){const r=getComputedStyle(t),l=e==="x"?r.overflowX:r.overflowY;return hW.has(l)}function ib(t,e){let r=t?.parentElement;for(;r;){if(pW(r,e))return r;r=r.parentElement}return null}function mW(t,e,r){const l=e.getBoundingClientRect(),u=r==="x"?l.left:l.top,m=r==="x"?l.right:l.bottom,v=t-u,b=m-t;if(v<px){const a=1-v/px;return{amount:-$A*a*a,edge:"start"}}else if(b<px){const a=1-b/px;return{amount:$A*a*a,edge:"end"}}return{amount:0,edge:null}}function gW(t,e,r,l){if(!t)return;ay=t;const u=ib(t,r);if(!u)return;const m=e-(r==="x"?window.scrollX:window.scrollY),{amount:v,edge:b}=mW(m,u,r);if(b===null){Sy.delete(u),Ty.delete(u);return}if(Sy.get(u)!==b){if(!(b==="start"&&l<0||b==="end"&&l>0))return;Sy.set(u,b);const M=r==="x"?u.scrollWidth-u.clientWidth:u.scrollHeight-u.clientHeight;Ty.set(u,M)}if(v>0){const k=Ty.get(u);if((r==="x"?u.scrollLeft:u.scrollTop)>=k)return}r==="x"?u.scrollLeft+=v:u.scrollTop+=v}function GA(t,e=0){return Zs(t)?t:h3(e)}function yW({children:t,style:e={},value:r,as:l="li",onDrag:u,onDragEnd:m,layout:v=!0,...b},a){const k=op(()=>yr[l]),M=P.useContext(p3),L={x:GA(e.x),y:GA(e.y)},z=oW([L.x,L.y],([Y,ee])=>Y||ee?1:"unset"),{axis:O,registerItem:K,updateOrder:H,groupRef:Z}=M;return x.jsx(k,{drag:O,...b,dragSnapToOrigin:!0,style:{...e,x:L.x,y:L.y,zIndex:z},layout:v,onDrag:(Y,ee)=>{const{velocity:ie,point:pe}=ee,we=L[O].get();H(r,we,ie[O]),gW(Z.current,pe[O],O,ie[O]),u&&u(Y,ee)},onDragEnd:(Y,ee)=>{fW(),m&&m(Y,ee)},onLayoutMeasure:Y=>{K(r,Y)},ref:a,ignoreStrict:!0,children:t})}const _W=P.forwardRef(yW);var xW=Symbol.for("react.lazy"),ov=vv[" use ".trim().toString()];function vW(t){return typeof t=="object"&&t!==null&&"then"in t}function m3(t){return t!=null&&typeof t=="object"&&"$$typeof"in t&&t.$$typeof===xW&&"_payload"in t&&vW(t._payload)}function BT(t){const e=bW(t),r=P.forwardRef((l,u)=>{let{children:m,...v}=l;m3(m)&&typeof ov=="function"&&(m=ov(m._payload));const b=P.Children.toArray(m),a=b.find(SW);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}var wW=BT("Slot");function bW(t){const e=P.forwardRef((r,l)=>{let{children:u,...m}=r;if(m3(u)&&typeof ov=="function"&&(u=ov(u._payload)),P.isValidElement(u)){const v=CW(u),b=EW(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var TW=Symbol("radix.slottable");function SW(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===TW}function EW(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function CW(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}const kW=Ky("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),_n=P.forwardRef(({className:t,variant:e,size:r,asChild:l=!1,...u},m)=>{const v=l?wW:"button";return x.jsx(v,{className:ln(kW({variant:e,size:r,className:t})),ref:m,...u})});_n.displayName="Button";const AW=({size:t=20,className:e=""})=>x.jsx("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:e,children:x.jsx("path",{d:"M9 12a4 4 0 1 0 4 4V4a5 5 0 0 0 5 5"})}),IW=()=>{const t=ip(),e=()=>{const l=document.getElementById("features-section");l&&l.scrollIntoView({behavior:"smooth"})},r=[{icon:x.jsx(Cv,{className:"w-8 h-8 text-blue-500"}),title:"Tm g cng c",desc:"Hiu  nh ca bn: G 'i', 'kht', 'ht tin'... h thng s t ng gi  qun n, cafe, ATM ph hp."},{icon:x.jsx(SM,{className:"w-8 h-8 text-green-500"}),title:"Bn  sinh vin",desc:"D liu c ti u ring cho sinh vin: V tr ging ng, th vin, nh tr, v cc im check-in hot nht."},{icon:x.jsx(Yy,{className:"w-8 h-8 text-orange-500"}),title:"Sn Voucher",desc:"Lin kt vi cc ca hng quanh trng  tung ra cc m gim gi c quyn ch dnh cho sinh vin."},{icon:x.jsx(Vf,{className:"w-8 h-8 text-yellow-500"}),title:"Review C Tm",desc:"Xem nh gi thc t t cng ng sinh vin trc khi quyt nh 'xung tin' i n hay i chi."}];return x.jsxs("div",{className:"min-h-screen bg-white text-gray-800 font-sans selection:bg-green-100",children:[x.jsx("nav",{className:"fixed top-0 left-0 right-0 bg-white/80 backdrop-blur-md z-50 border-b border-gray-100",children:x.jsxs("div",{className:"max-w-6xl mx-auto px-4 h-16 flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-2 cursor-pointer",onClick:()=>t("/"),children:[x.jsx("img",{src:"/logo.png",alt:"ThodiaUni",className:"w-8 h-8 object-contain rounded"}),x.jsx("span",{className:"font-bold text-xl tracking-tight text-green-700",children:"ThodiaUni"})]}),x.jsxs(_n,{variant:"ghost",onClick:()=>t("/"),className:"gap-2 hover:bg-green-50 text-green-700",children:[x.jsx(Sv,{size:18}),"Quay li Bn "]})]})}),x.jsxs("section",{className:"pt-32 pb-20 px-4 text-center relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 w-[800px] h-[400px] bg-green-200/30 rounded-full blur-3xl -z-10"}),x.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"max-w-3xl mx-auto",children:[x.jsx("span",{className:"px-3 py-1 rounded-full bg-green-100 text-green-700 text-sm font-bold mb-4 inline-block",children:"Dnh ring cho Sinh Vin"}),x.jsxs("h1",{className:"text-5xl md:text-6xl font-black text-gray-900 mb-6 leading-tight",children:["Th a Ca ",x.jsx("span",{className:"text-green-600",children:"Sinh Vin"})]}),x.jsx("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:'Bn l tn sinh vin cn b ng? Hay "cu" sinh vin nhng tra no cng hi "Hm nay n g?". ThodiaUni chnh l ngi bn ng hnh gip bn lm ch khu vc quanh trng.'}),x.jsxs("div",{className:"flex justify-center gap-4",children:[x.jsx(_n,{size:"lg",className:"bg-green-600 hover:bg-green-700 text-white h-12 px-8 rounded-full text-lg shadow-lg shadow-green-600/20",onClick:()=>t("/"),children:"Khm ph ngay"}),x.jsx(_n,{variant:"outline",size:"lg",className:"h-12 px-8 rounded-full text-lg border-2 hover:bg-gray-50",onClick:e,children:"Tm hiu thm"})]})]})]}),x.jsx("section",{id:"features-section",className:"py-20 bg-gray-50",children:x.jsxs("div",{className:"max-w-6xl mx-auto px-4",children:[x.jsxs("div",{className:"text-center mb-16",children:[x.jsx("h2",{className:"text-3xl font-bold mb-4",children:"Ti sao chn ThodiaUni?"}),x.jsx("p",{className:"text-gray-500",children:"Tt c nhng g bn cn  sng st qua 4 nm i hc."})]}),x.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-4 gap-8",children:r.map((l,u)=>x.jsxs(yr.div,{initial:{opacity:0,y:20},whileInView:{opacity:1,y:0},transition:{delay:u*.1},viewport:{once:!0},className:"bg-white p-6 rounded-2xl shadow-sm border border-gray-100 hover:shadow-md transition-shadow",children:[x.jsx("div",{className:"mb-4 bg-gray-50 w-14 h-14 rounded-xl flex items-center justify-center",children:l.icon}),x.jsx("h3",{className:"text-xl font-bold mb-2 text-gray-800",children:l.title}),x.jsx("p",{className:"text-gray-600 text-sm leading-relaxed",children:l.desc})]},u))})]})}),x.jsx("section",{className:"py-20 px-4",children:x.jsxs("div",{className:"max-w-4xl mx-auto bg-green-600 rounded-3xl p-8 md:p-12 text-center text-white relative overflow-hidden",children:[x.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white/10 rounded-full -translate-y-1/2 translate-x-1/2"}),x.jsx("div",{className:"absolute bottom-0 left-0 w-48 h-48 bg-white/10 rounded-full translate-y-1/2 -translate-x-1/2"}),x.jsx(Ff,{className:"w-12 h-12 mx-auto mb-6 text-green-200 animate-pulse"}),x.jsx("h2",{className:"text-3xl font-bold mb-4",children:"S Mnh Ca Chng Ti"}),x.jsx("p",{className:"text-lg text-green-100 mb-8 leading-relaxed",children:'"Chng ti tin rng i sinh vin l khong thi gian p nht. ThodiaUni c to ra  gip bn bt lo lng v chuyn n , i li,  dnh trn tm tr cho vic hc tp v tri nghim tui tr."'}),x.jsxs("div",{className:"flex flex-wrap justify-center gap-6 text-sm font-medium text-green-200",children:[x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(Vi,{size:16})," Lng i Hc"]}),x.jsxs("span",{className:"flex items-center gap-2",children:[x.jsx(kO,{size:16})," Kt ni cng ng"]})]})]})}),x.jsxs("footer",{className:"bg-gray-900 text-gray-400 py-12 px-4",children:[x.jsxs("div",{className:"max-w-6xl mx-auto flex flex-col md:flex-row justify-between items-center gap-6",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx("img",{src:"/logo.png",alt:"ThodiaUni",className:"w-8 h-8 object-contain rounded"}),x.jsx("span",{className:"text-white font-bold text-xl",children:"ThodiaUni"})]}),x.jsxs("div",{className:"text-sm flex flex-col md:flex-row gap-4 md:gap-8 items-center font-medium",children:[x.jsxs("div",{className:"flex items-center gap-2 hover:text-white transition-colors cursor-default",children:[x.jsx(TM,{size:16,className:"text-gray-500"}),x.jsx("span",{children:"contact@thodiauni.com"})]}),x.jsxs("div",{className:"flex items-center gap-2 hover:text-white transition-colors cursor-default",children:[x.jsx(Ev,{size:16,className:"text-gray-500"}),x.jsx("span",{children:"086 299 3382"})]})]}),x.jsxs("div",{className:"flex gap-6 items-center",children:[x.jsx("a",{href:"https://facebook.com/thodiauni",target:"_blank",rel:"noopener noreferrer",className:"hover:text-blue-500 transition-colors flex items-center gap-1 group",title:"Facebook",children:x.jsx(SO,{size:24,className:"group-hover:scale-110 transition-transform"})}),x.jsx("a",{href:"https://tiktok.com/@thodiauni",target:"_blank",rel:"noopener noreferrer",className:"hover:text-pink-500 transition-colors flex items-center gap-1 group",title:"TikTok",children:x.jsx(AW,{size:22,className:"group-hover:scale-110 transition-transform"})})]})]}),x.jsx("div",{className:"max-w-6xl mx-auto mt-8 pt-8 border-t border-gray-800 text-center text-xs text-gray-600",children:" 2026 ThodiaUni Project. Built with passion."})]})]})};function U1({className:t,...e}){return x.jsx("div",{className:ln("animate-pulse rounded-md bg-muted",t),...e})}var MW=P.createContext(void 0);function u_(t){const e=P.useContext(MW);return t||e||"ltr"}function sb(t,[e,r]){return Math.min(r,Math.max(e,t))}function PW(t,e){return P.useReducer((r,l)=>e[r][l]??r,t)}var FT="ScrollArea",[g3]=sl(FT),[RW,ol]=g3(FT),y3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,type:l="hover",dir:u,scrollHideDelay:m=600,...v}=t,[b,a]=P.useState(null),[k,M]=P.useState(null),[L,z]=P.useState(null),[O,K]=P.useState(null),[H,Z]=P.useState(null),[Y,ee]=P.useState(0),[ie,pe]=P.useState(0),[we,ke]=P.useState(!1),[ze,Ge]=P.useState(!1),tt=ir(e,ot=>a(ot)),Pe=u_(u);return x.jsx(RW,{scope:r,type:l,dir:Pe,scrollHideDelay:m,scrollArea:b,viewport:k,onViewportChange:M,content:L,onContentChange:z,scrollbarX:O,onScrollbarXChange:K,scrollbarXEnabled:we,onScrollbarXEnabledChange:ke,scrollbarY:H,onScrollbarYChange:Z,scrollbarYEnabled:ze,onScrollbarYEnabledChange:Ge,onCornerWidthChange:ee,onCornerHeightChange:pe,children:x.jsx(Mn.div,{dir:Pe,...v,ref:tt,style:{position:"relative","--radix-scroll-area-corner-width":Y+"px","--radix-scroll-area-corner-height":ie+"px",...t.style}})})});y3.displayName=FT;var _3="ScrollAreaViewport",x3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,children:l,nonce:u,...m}=t,v=ol(_3,r),b=P.useRef(null),a=ir(e,b,v.onViewportChange);return x.jsxs(x.Fragment,{children:[x.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:u}),x.jsx(Mn.div,{"data-radix-scroll-area-viewport":"",...m,ref:a,style:{overflowX:v.scrollbarXEnabled?"scroll":"hidden",overflowY:v.scrollbarYEnabled?"scroll":"hidden",...t.style},children:x.jsx("div",{ref:v.onContentChange,style:{minWidth:"100%",display:"table"},children:l})})]})});x3.displayName=_3;var Jc="ScrollAreaScrollbar",VT=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),{onScrollbarXEnabledChange:m,onScrollbarYEnabledChange:v}=u,b=t.orientation==="horizontal";return P.useEffect(()=>(b?m(!0):v(!0),()=>{b?m(!1):v(!1)}),[b,m,v]),u.type==="hover"?x.jsx(NW,{...l,ref:e,forceMount:r}):u.type==="scroll"?x.jsx(DW,{...l,ref:e,forceMount:r}):u.type==="auto"?x.jsx(v3,{...l,ref:e,forceMount:r}):u.type==="always"?x.jsx(UT,{...l,ref:e}):null});VT.displayName=Jc;var NW=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),[m,v]=P.useState(!1);return P.useEffect(()=>{const b=u.scrollArea;let a=0;if(b){const k=()=>{window.clearTimeout(a),v(!0)},M=()=>{a=window.setTimeout(()=>v(!1),u.scrollHideDelay)};return b.addEventListener("pointerenter",k),b.addEventListener("pointerleave",M),()=>{window.clearTimeout(a),b.removeEventListener("pointerenter",k),b.removeEventListener("pointerleave",M)}}},[u.scrollArea,u.scrollHideDelay]),x.jsx(jo,{present:r||m,children:x.jsx(v3,{"data-state":m?"visible":"hidden",...l,ref:e})})}),DW=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=ol(Jc,t.__scopeScrollArea),m=t.orientation==="horizontal",v=Xv(()=>a("SCROLL_END"),100),[b,a]=PW("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return P.useEffect(()=>{if(b==="idle"){const k=window.setTimeout(()=>a("HIDE"),u.scrollHideDelay);return()=>window.clearTimeout(k)}},[b,u.scrollHideDelay,a]),P.useEffect(()=>{const k=u.viewport,M=m?"scrollLeft":"scrollTop";if(k){let L=k[M];const z=()=>{const O=k[M];L!==O&&(a("SCROLL"),v()),L=O};return k.addEventListener("scroll",z),()=>k.removeEventListener("scroll",z)}},[u.viewport,m,a,v]),x.jsx(jo,{present:r||b!=="hidden",children:x.jsx(UT,{"data-state":b==="hidden"?"hidden":"visible",...l,ref:e,onPointerEnter:Xt(t.onPointerEnter,()=>a("POINTER_ENTER")),onPointerLeave:Xt(t.onPointerLeave,()=>a("POINTER_LEAVE"))})})}),v3=P.forwardRef((t,e)=>{const r=ol(Jc,t.__scopeScrollArea),{forceMount:l,...u}=t,[m,v]=P.useState(!1),b=t.orientation==="horizontal",a=Xv(()=>{if(r.viewport){const k=r.viewport.offsetWidth<r.viewport.scrollWidth,M=r.viewport.offsetHeight<r.viewport.scrollHeight;v(b?k:M)}},10);return zm(r.viewport,a),zm(r.content,a),x.jsx(jo,{present:l||m,children:x.jsx(UT,{"data-state":m?"visible":"hidden",...u,ref:e})})}),UT=P.forwardRef((t,e)=>{const{orientation:r="vertical",...l}=t,u=ol(Jc,t.__scopeScrollArea),m=P.useRef(null),v=P.useRef(0),[b,a]=P.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),k=E3(b.viewport,b.content),M={...l,sizes:b,onSizesChange:a,hasThumb:k>0&&k<1,onThumbChange:z=>m.current=z,onThumbPointerUp:()=>v.current=0,onThumbPointerDown:z=>v.current=z};function L(z,O){return FW(z,v.current,b,O)}return r==="horizontal"?x.jsx(LW,{...M,ref:e,onThumbPositionChange:()=>{if(u.viewport&&m.current){const z=u.viewport.scrollLeft,O=HA(z,b,u.dir);m.current.style.transform=`translate3d(${O}px, 0, 0)`}},onWheelScroll:z=>{u.viewport&&(u.viewport.scrollLeft=z)},onDragScroll:z=>{u.viewport&&(u.viewport.scrollLeft=L(z,u.dir))}}):r==="vertical"?x.jsx(jW,{...M,ref:e,onThumbPositionChange:()=>{if(u.viewport&&m.current){const z=u.viewport.scrollTop,O=HA(z,b);m.current.style.transform=`translate3d(0, ${O}px, 0)`}},onWheelScroll:z=>{u.viewport&&(u.viewport.scrollTop=z)},onDragScroll:z=>{u.viewport&&(u.viewport.scrollTop=L(z))}}):null}),LW=P.forwardRef((t,e)=>{const{sizes:r,onSizesChange:l,...u}=t,m=ol(Jc,t.__scopeScrollArea),[v,b]=P.useState(),a=P.useRef(null),k=ir(e,a,m.onScrollbarXChange);return P.useEffect(()=>{a.current&&b(getComputedStyle(a.current))},[a]),x.jsx(b3,{"data-orientation":"horizontal",...u,ref:k,sizes:r,style:{bottom:0,left:m.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:m.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":Zv(r)+"px",...t.style},onThumbPointerDown:M=>t.onThumbPointerDown(M.x),onDragScroll:M=>t.onDragScroll(M.x),onWheelScroll:(M,L)=>{if(m.viewport){const z=m.viewport.scrollLeft+M.deltaX;t.onWheelScroll(z),k3(z,L)&&M.preventDefault()}},onResize:()=>{a.current&&m.viewport&&v&&l({content:m.viewport.scrollWidth,viewport:m.viewport.offsetWidth,scrollbar:{size:a.current.clientWidth,paddingStart:lv(v.paddingLeft),paddingEnd:lv(v.paddingRight)}})}})}),jW=P.forwardRef((t,e)=>{const{sizes:r,onSizesChange:l,...u}=t,m=ol(Jc,t.__scopeScrollArea),[v,b]=P.useState(),a=P.useRef(null),k=ir(e,a,m.onScrollbarYChange);return P.useEffect(()=>{a.current&&b(getComputedStyle(a.current))},[a]),x.jsx(b3,{"data-orientation":"vertical",...u,ref:k,sizes:r,style:{top:0,right:m.dir==="ltr"?0:void 0,left:m.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":Zv(r)+"px",...t.style},onThumbPointerDown:M=>t.onThumbPointerDown(M.y),onDragScroll:M=>t.onDragScroll(M.y),onWheelScroll:(M,L)=>{if(m.viewport){const z=m.viewport.scrollTop+M.deltaY;t.onWheelScroll(z),k3(z,L)&&M.preventDefault()}},onResize:()=>{a.current&&m.viewport&&v&&l({content:m.viewport.scrollHeight,viewport:m.viewport.offsetHeight,scrollbar:{size:a.current.clientHeight,paddingStart:lv(v.paddingTop),paddingEnd:lv(v.paddingBottom)}})}})}),[OW,w3]=g3(Jc),b3=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,sizes:l,hasThumb:u,onThumbChange:m,onThumbPointerUp:v,onThumbPointerDown:b,onThumbPositionChange:a,onDragScroll:k,onWheelScroll:M,onResize:L,...z}=t,O=ol(Jc,r),[K,H]=P.useState(null),Z=ir(e,tt=>H(tt)),Y=P.useRef(null),ee=P.useRef(""),ie=O.viewport,pe=l.content-l.viewport,we=Bi(M),ke=Bi(a),ze=Xv(L,10);function Ge(tt){if(Y.current){const Pe=tt.clientX-Y.current.left,ot=tt.clientY-Y.current.top;k({x:Pe,y:ot})}}return P.useEffect(()=>{const tt=Pe=>{const ot=Pe.target;K?.contains(ot)&&we(Pe,pe)};return document.addEventListener("wheel",tt,{passive:!1}),()=>document.removeEventListener("wheel",tt,{passive:!1})},[ie,K,pe,we]),P.useEffect(ke,[l,ke]),zm(K,ze),zm(O.content,ze),x.jsx(OW,{scope:r,scrollbar:K,hasThumb:u,onThumbChange:Bi(m),onThumbPointerUp:Bi(v),onThumbPositionChange:ke,onThumbPointerDown:Bi(b),children:x.jsx(Mn.div,{...z,ref:Z,style:{position:"absolute",...z.style},onPointerDown:Xt(t.onPointerDown,tt=>{tt.button===0&&(tt.target.setPointerCapture(tt.pointerId),Y.current=K.getBoundingClientRect(),ee.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",O.viewport&&(O.viewport.style.scrollBehavior="auto"),Ge(tt))}),onPointerMove:Xt(t.onPointerMove,Ge),onPointerUp:Xt(t.onPointerUp,tt=>{const Pe=tt.target;Pe.hasPointerCapture(tt.pointerId)&&Pe.releasePointerCapture(tt.pointerId),document.body.style.webkitUserSelect=ee.current,O.viewport&&(O.viewport.style.scrollBehavior=""),Y.current=null})})})}),av="ScrollAreaThumb",T3=P.forwardRef((t,e)=>{const{forceMount:r,...l}=t,u=w3(av,t.__scopeScrollArea);return x.jsx(jo,{present:r||u.hasThumb,children:x.jsx(zW,{ref:e,...l})})}),zW=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,style:l,...u}=t,m=ol(av,r),v=w3(av,r),{onThumbPositionChange:b}=v,a=ir(e,L=>v.onThumbChange(L)),k=P.useRef(void 0),M=Xv(()=>{k.current&&(k.current(),k.current=void 0)},100);return P.useEffect(()=>{const L=m.viewport;if(L){const z=()=>{if(M(),!k.current){const O=VW(L,b);k.current=O,b()}};return b(),L.addEventListener("scroll",z),()=>L.removeEventListener("scroll",z)}},[m.viewport,M,b]),x.jsx(Mn.div,{"data-state":v.hasThumb?"visible":"hidden",...u,ref:a,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...l},onPointerDownCapture:Xt(t.onPointerDownCapture,L=>{const O=L.target.getBoundingClientRect(),K=L.clientX-O.left,H=L.clientY-O.top;v.onThumbPointerDown({x:K,y:H})}),onPointerUp:Xt(t.onPointerUp,v.onThumbPointerUp)})});T3.displayName=av;var $T="ScrollAreaCorner",S3=P.forwardRef((t,e)=>{const r=ol($T,t.__scopeScrollArea),l=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&l?x.jsx(BW,{...t,ref:e}):null});S3.displayName=$T;var BW=P.forwardRef((t,e)=>{const{__scopeScrollArea:r,...l}=t,u=ol($T,r),[m,v]=P.useState(0),[b,a]=P.useState(0),k=!!(m&&b);return zm(u.scrollbarX,()=>{const M=u.scrollbarX?.offsetHeight||0;u.onCornerHeightChange(M),a(M)}),zm(u.scrollbarY,()=>{const M=u.scrollbarY?.offsetWidth||0;u.onCornerWidthChange(M),v(M)}),k?x.jsx(Mn.div,{...l,ref:e,style:{width:m,height:b,position:"absolute",right:u.dir==="ltr"?0:void 0,left:u.dir==="rtl"?0:void 0,bottom:0,...t.style}}):null});function lv(t){return t?parseInt(t,10):0}function E3(t,e){const r=t/e;return isNaN(r)?0:r}function Zv(t){const e=E3(t.viewport,t.content),r=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=(t.scrollbar.size-r)*e;return Math.max(l,18)}function FW(t,e,r,l="ltr"){const u=Zv(r),m=u/2,v=e||m,b=u-v,a=r.scrollbar.paddingStart+v,k=r.scrollbar.size-r.scrollbar.paddingEnd-b,M=r.content-r.viewport,L=l==="ltr"?[0,M]:[M*-1,0];return C3([a,k],L)(t)}function HA(t,e,r="ltr"){const l=Zv(e),u=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,m=e.scrollbar.size-u,v=e.content-e.viewport,b=m-l,a=r==="ltr"?[0,v]:[v*-1,0],k=sb(t,a);return C3([0,v],[0,b])(k)}function C3(t,e){return r=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const l=(e[1]-e[0])/(t[1]-t[0]);return e[0]+l*(r-t[0])}}function k3(t,e){return t>0&&t<e}var VW=(t,e=()=>{})=>{let r={left:t.scrollLeft,top:t.scrollTop},l=0;return(function u(){const m={left:t.scrollLeft,top:t.scrollTop},v=r.left!==m.left,b=r.top!==m.top;(v||b)&&e(),r=m,l=window.requestAnimationFrame(u)})(),()=>window.cancelAnimationFrame(l)};function Xv(t,e){const r=Bi(t),l=P.useRef(0);return P.useEffect(()=>()=>window.clearTimeout(l.current),[]),P.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(r,e)},[r,e])}function zm(t,e){const r=Bi(e);Hi(()=>{let l=0;if(t){const u=new ResizeObserver(()=>{cancelAnimationFrame(l),l=window.requestAnimationFrame(r)});return u.observe(t),()=>{window.cancelAnimationFrame(l),u.unobserve(t)}}},[t,r])}var A3=y3,UW=x3,$W=S3;const Kv=P.forwardRef(({className:t,children:e,...r},l)=>x.jsxs(A3,{ref:l,className:ln("relative overflow-hidden",t),...r,children:[x.jsx(UW,{className:"h-full w-full rounded-[inherit]",children:e}),x.jsx(I3,{}),x.jsx($W,{})]}));Kv.displayName=A3.displayName;const I3=P.forwardRef(({className:t,orientation:e="vertical",...r},l)=>x.jsx(VT,{ref:l,orientation:e,className:ln("flex touch-none select-none transition-colors",e==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",e==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:x.jsx(T3,{className:"relative flex-1 rounded-full bg-border"})}));I3.displayName=VT.displayName;const GW="https://thodia-backend-1067502227654.asia-southeast1.run.app",HW=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},WW=`
  @keyframes scroll-left {
    0% { transform: translateX(0); }
    100% { transform: translateX(-50%); }
  }
  .animate-scroll {
    display: flex;
    white-space: nowrap;
    animation: scroll-left 10s linear infinite;
  }
  .group:hover .animate-scroll {
    animation-play-state: paused;
  }
  .mask-gradient {
    mask-image: linear-gradient(to right, transparent, black 10%, black 90%, transparent);
    -webkit-mask-image: linear-gradient(to right, transparent, black 5%, black 95%, transparent);
  }
`,qW=({text:t,className:e})=>t.length>28?x.jsx("div",{className:"overflow-hidden w-full mask-gradient",children:x.jsxs("div",{className:`animate-scroll w-fit ${e}`,children:[x.jsx("span",{className:"mr-8",children:t}),x.jsx("span",{className:"mr-8",children:t})]})}):x.jsx("h4",{className:`truncate ${e}`,children:t}),WA=[{id:"food",icon:x.jsx(kv,{className:"w-3.5 h-3.5"}),label:"n ung"},{id:"cafe",icon:x.jsx(kb,{className:"w-3.5 h-3.5"}),label:"Caf"},{id:"entertainment",icon:x.jsx(Ab,{className:"w-3.5 h-3.5"}),label:"Vui chi"},{id:"lecture_hall",icon:x.jsx(Ib,{className:"w-3.5 h-3.5"}),label:"Ging ng"},{id:"office",icon:x.jsx(Eb,{className:"w-3.5 h-3.5"}),label:"Vn phng"},{id:"housing",icon:x.jsx(Mb,{className:"w-3.5 h-3.5"}),label:"Nh tr"},{id:"job",icon:x.jsx(oh,{className:"w-3.5 h-3.5"}),label:"Vic lm"},{id:"building",icon:x.jsx(Rm,{className:"w-3.5 h-3.5"}),label:"Ta nh"},{id:"checkin",icon:x.jsx(CM,{className:"w-3.5 h-3.5"}),label:"Check-in"}],ZW=({onSelectLocation:t,userLocation:e})=>{const{language:r}=ra(),[l,u]=P.useState(!1),[m,v]=P.useState("food"),[b,a]=P.useState({}),[k,M]=P.useState(!0);P.useEffect(()=>{(async()=>{M(!0);try{const H=await(await fetch(`${GW}/api/stores/approved`)).json();if(!Array.isArray(H)){console.error("D liu tr v khng phi mng:",H),M(!1);return}let Z=H.map(ee=>{let ie=0;return e&&(ie=HW(e.lat,e.lng,ee.lat,ee.lng)),{...ee,distance:ie}});Z.sort((ee,ie)=>ee.is_premium&&!ie.is_premium?-1:!ee.is_premium&&ie.is_premium?1:(ee.distance||0)-(ie.distance||0));const Y={};WA.forEach(ee=>Y[ee.id]=[]),Z.forEach(ee=>{Y[ee.category]&&Y[ee.category].length<10&&Y[ee.category].push(ee)}),a(Y)}catch(K){console.error("Li ti danh sch ca hng:",K)}finally{M(!1)}})()},[e]);const L=O=>{const K={...O,id:O.id,name:r==="en"&&O.name_en?O.name_en:O.name_vi,nameVi:O.name_vi,address:r==="en"&&O.address_en?O.address_en:O.address_vi,category:O.category,lat:O.lat,lng:O.lng,image:O.image_url,isUserStore:!0};t(K)},z=b[m]||[];return x.jsxs("div",{className:"absolute top-[112px] left-3 z-[30] flex flex-col items-start gap-2",children:[x.jsx("style",{children:WW}),x.jsxs("button",{onClick:()=>u(!l),className:"bg-white/95 backdrop-blur-md shadow-lg border rounded-full px-3 py-2 text-xs font-bold flex items-center gap-2 hover:bg-white transition-all text-primary group active:scale-95",children:[x.jsx("div",{className:"bg-primary/10 p-1 rounded-full group-hover:bg-primary/20 transition-colors",children:x.jsx(Vc,{className:"w-3.5 h-3.5 text-primary"})}),r==="vi"?"Gi  gn y":"Nearby Suggestions",l?x.jsx(Nm,{className:"w-3 h-3 text-gray-400"}):x.jsx(Hf,{className:"w-3 h-3 text-gray-400"})]}),x.jsx(Ta,{children:l&&x.jsxs(yr.div,{initial:{opacity:0,scale:.95,y:-10,height:0},animate:{opacity:1,scale:1,y:0,height:"auto"},exit:{opacity:0,scale:.95,y:-10,height:0},className:"w-[300px] md:w-[320px] max-h-[60vh] bg-white/95 backdrop-blur-md rounded-xl shadow-2xl border border-white/20 overflow-hidden flex flex-col origin-top-left",children:[x.jsx("div",{className:"border-b bg-gray-50/80",children:x.jsxs("div",{className:"flex overflow-x-auto p-2 gap-1.5",style:{scrollbarWidth:"none",msOverflowStyle:"none"},children:[x.jsx("style",{children:".flex::-webkit-scrollbar { display: none; }"}),WA.map(O=>{const K=m===O.id;return x.jsxs("button",{onClick:()=>v(O.id),className:ln("flex-none flex items-center justify-center gap-1.5 px-3 py-1.5 rounded-full text-[11px] font-bold transition-all whitespace-nowrap",K?"bg-white text-primary shadow-sm border ring-1 ring-gray-100":"text-gray-500 hover:bg-gray-200/50 hover:text-gray-700 bg-transparent"),children:[O.icon,O.label]},O.id)})]})}),x.jsx(Kv,{className:"flex-1 w-full bg-white/50",children:x.jsxs("div",{className:"p-2 space-y-2",children:[k?[1,2,3].map(O=>x.jsxs("div",{className:"flex gap-3 items-center p-2",children:[x.jsx(U1,{className:"w-12 h-12 rounded-lg flex-shrink-0"}),x.jsxs("div",{className:"space-y-2 flex-1",children:[x.jsx(U1,{className:"h-3 w-3/4"}),x.jsx(U1,{className:"h-2 w-1/2"})]})]},O)):z.length===0?x.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-gray-400 gap-2",children:[x.jsx(Vc,{className:"w-10 h-10 opacity-20"}),x.jsx("span",{className:"text-xs",children:"Khng tm thy a im no"})]}):z.map(O=>{const K=r==="en"&&O.name_en?O.name_en:O.name_vi,H=r==="en"&&O.address_en?O.address_en:O.address_vi,Z=O.is_premium,Y=O.distance?O.distance<1?`${(O.distance*1e3).toFixed(0)}m`:`${O.distance.toFixed(1)}km`:"";return x.jsxs(yr.div,{layout:!0,initial:{opacity:0,y:10},animate:{opacity:1,y:0},onClick:()=>L(O),className:ln("flex gap-3 p-2 rounded-lg transition-all cursor-pointer border group relative overflow-hidden",Z?"bg-gradient-to-r from-yellow-50 to-white border-yellow-200/60 hover:border-yellow-300":"bg-white/60 border-transparent hover:bg-white hover:shadow-sm hover:border-gray-100"),children:[x.jsxs("div",{className:"w-14 h-14 flex-shrink-0 relative",children:[x.jsx("img",{src:O.image_url||"https://placehold.co/100x100?text=Store",className:"w-full h-full object-cover rounded-md bg-gray-100 border border-gray-100",loading:"lazy",onError:ee=>ee.currentTarget.src="https://placehold.co/100x100?text=Store"}),Z&&x.jsx("div",{className:"absolute -top-1.5 -left-1.5 z-10",children:x.jsxs("span",{className:"relative flex h-3 w-3",children:[x.jsx("span",{className:"animate-ping absolute inline-flex h-full w-full rounded-full bg-yellow-400 opacity-75"}),x.jsx("span",{className:"relative inline-flex rounded-full h-3 w-3 bg-yellow-500 border border-white"})]})})]}),x.jsxs("div",{className:"flex-1 min-w-0 flex flex-col justify-center gap-0.5",children:[x.jsxs("div",{className:"flex justify-between items-start gap-1",children:[x.jsx("div",{className:"flex-1 min-w-0",children:x.jsx(qW,{text:K,className:ln("text-xs font-bold transition-colors",Z?"text-yellow-800":"text-gray-800 group-hover:text-primary")})}),Y&&x.jsx("span",{className:"text-[9px] font-bold text-blue-600 bg-blue-50 px-1.5 py-0.5 rounded-full whitespace-nowrap border border-blue-100",children:Y})]}),x.jsxs("div",{className:"flex items-center gap-1 text-gray-500",children:[x.jsx(Vi,{className:"w-2.5 h-2.5 flex-shrink-0 text-gray-400"}),x.jsx("p",{className:"text-[10px] truncate w-full",children:H})]}),Z&&x.jsx("div",{className:"flex gap-1 mt-1",children:x.jsxs("span",{className:"text-[8px] text-yellow-700 font-bold bg-gradient-to-r from-yellow-100 to-transparent pl-1 pr-2 rounded-sm flex items-center gap-1",children:[x.jsx(nl,{className:"w-2 h-2 fill-yellow-700"}),"VIP Partner"]})})]})]},O.id)}),x.jsx("div",{className:"h-2"})]})})]})})]})};var Dx={exports:{}},XW=Dx.exports,qA;function KW(){return qA||(qA=1,(function(t,e){var r={};(function(l,u){t.exports=u()})(XW,(function(){var l,u,m;function v(a,k){if(!l)l=k;else if(!u)u=k;else{var M="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+l+")(sharedChunk); ("+u+")(sharedChunk); self.onerror = null;",L={};l(L),m=k(L),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(m.workerUrl=window.URL.createObjectURL(new Blob([M],{type:"text/javascript"})))}}v(["exports"],(function(a){var k=typeof self<"u"?self:{},M="2.15.0";let L;const z={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){if(L==null){const i=/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i;try{L=r.API_URL_REGEX!=null?new RegExp(r.API_URL_REGEX):i}catch{L=i}}return L},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!z.API_URL)return null;try{const i=new URL(z.API_URL);return i.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":i.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,MAX_PARALLEL_IMAGE_REQUESTS:16},O={supported:!1,testSupport:function(i){!Z&&H&&(Y?ee(i):K=i)}};let K,H,Z=!1,Y=!1;function ee(i){const n=i.createTexture();i.bindTexture(i.TEXTURE_2D,n);try{if(i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,H),i.isContextLost())return;O.supported=!0}catch{}i.deleteTexture(n),Z=!0}k.document&&(H=k.document.createElement("img"),H.onload=function(){K&&ee(K),K=null,Y=!0},H.onerror=function(){Z=!0,K=null},H.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const ie="01";function pe(i){return i&&i.__esModule&&Object.prototype.hasOwnProperty.call(i,"default")?i.default:i}var we=ke;function ke(i,n,s,c){this.cx=3*i,this.bx=3*(s-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*n,this.by=3*(c-n)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=n,this.p2x=s,this.p2y=c}ke.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,n){if(n===void 0&&(n=1e-6),i<0)return 0;if(i>1)return 1;for(var s=i,c=0;c<8;c++){var f=this.sampleCurveX(s)-i;if(Math.abs(f)<n)return s;var y=this.sampleCurveDerivativeX(s);if(Math.abs(y)<1e-6)break;s-=f/y}var w=0,E=1;for(s=i,c=0;c<20&&(f=this.sampleCurveX(s),!(Math.abs(f-i)<n));c++)i>f?w=s:E=s,s=.5*(E-w)+w;return s},solve:function(i,n){return this.sampleCurveY(this.solveCurveX(i,n))}};var ze=pe(we),Ge=tt;function tt(i,n){this.x=i,this.y=n}tt.prototype={clone:function(){return new tt(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,n){return this.clone()._rotateAround(i,n)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var n=i.x-this.x,s=i.y-this.y;return n*n+s*s},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,n){return Math.atan2(this.x*n-this.y*i,this.x*i+this.y*n)},_matMult:function(i){var n=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=n,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var n=Math.cos(i),s=Math.sin(i),c=s*this.x+n*this.y;return this.x=n*this.x-s*this.y,this.y=c,this},_rotateAround:function(i,n){var s=Math.cos(i),c=Math.sin(i),f=n.y+c*(this.x-n.x)+s*(this.y-n.y);return this.x=n.x+s*(this.x-n.x)-c*(this.y-n.y),this.y=f,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},tt.convert=function(i){return i instanceof tt?i:Array.isArray(i)?new tt(i[0],i[1]):i};var Pe=pe(Ge);const ot=Math.PI/180,ut=180/Math.PI;function gt(i){return i*ot}function ht(i){return i*ut}const Lt=[[0,0],[1,0],[1,1],[0,1]];function mt(i){if(i<=0)return 0;if(i>=1)return 1;const n=i*i,s=n*i;return 4*(i<.5?s:3*(i-n)+s-.75)}function pt(i,n,s,c){const f=new ze(i,n,s,c);return function(y){return f.solve(y)}}const Ae=pt(.25,.1,.25,1);function xe(i,n,s){return Math.min(s,Math.max(n,i))}function We(i,n,s){return(s=xe((s-i)/(n-i),0,1))*s*(3-2*s)}function he(i,n,s){const c=s-n,f=((i-n)%c+c)%c+n;return f===n?s:f}function Fe(i,n,s){if(!i.length)return s(null,[]);let c=i.length;const f=new Array(i.length);let y=null;i.forEach(((w,E)=>{n(w,((A,I)=>{A&&(y=A),f[E]=I,--c==0&&s(y,f)}))}))}function it(i){const n=[];for(const s in i)n.push(i[s]);return n}function vt(i,...n){for(const s of n)for(const c in s)i[c]=s[c];return i}let Wt=1;function rn(){return Wt++}function wt(){return(function i(n){return n?(n^Math.random()*(16>>n/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,i)})()}function Kt(i){return i<=1?1:Math.pow(2,Math.ceil(Math.log(i)/Math.LN2))}function Tn(i){return!!i&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(i)}function fn(i,n){i.forEach((s=>{n[s]&&(n[s]=n[s].bind(n))}))}function Cn(i,n){return i.indexOf(n,i.length-n.length)!==-1}function tn(i,n,s){const c={};for(const f in i)c[f]=n.call(this,i[f],f,i);return c}function mr(i,n,s){const c={};for(const f in i)n.call(s||this,i[f],f,i)&&(c[f]=i[f]);return c}function hr(i){return Array.isArray(i)?i.map(hr):typeof i=="object"&&i?tn(i,hr):i}const _i={};function Xn(i){_i[i]||(typeof console<"u"&&console.warn(i),_i[i]=!0)}function Er(i,n,s){return(s.y-i.y)*(n.x-i.x)>(n.y-i.y)*(s.x-i.x)}function Xs(i){let n=0;for(let s,c,f=0,y=i.length,w=y-1;f<y;w=f++)s=i[f],c=i[w],n+=(c.x-s.x)*(s.y+c.y);return n}function xi(){return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope}function Zr(i){const n={};if(i.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,((s,c,f,y)=>{const w=f||y;return n[c]=!w||w.toLowerCase(),""})),n["max-age"]){const s=parseInt(n["max-age"],10);isNaN(s)?delete n["max-age"]:n["max-age"]=s}return n}let ni=null;function rs(i){if(ni==null){const n=i.navigator?i.navigator.userAgent:null;ni=!!i.safari||!(!n||!(/\b(iPad|iPhone|iPod)\b/.test(n)||n.match("Safari")&&!n.match("Chrome")))}return ni}function Wi(i){try{const n=k[i];return n.setItem("_mapbox_test_",1),n.removeItem("_mapbox_test_"),!0}catch{return!1}}function Ms(i,n){return[i[4*n],i[4*n+1],i[4*n+2],i[4*n+3]]}const _s="mapbox-tiles";let Vr=500,is=50,vi,Ps;function qi(){try{return k.caches}catch{}}function ki(){qi()&&!vi&&(vi=k.caches.open(_s))}function yo(i){const n=i.indexOf("?");if(n<0)return i;const s=(function(f){const y=f.indexOf("?");return y>0?f.slice(y+1).split("&"):[]})(i),c=s.filter((f=>{const y=f.split("=");return y[0]==="language"||y[0]==="worldview"}));return c.length?`${i.slice(0,n)}?${c.join("&")}`:i.slice(0,n)}let Ks=1/0;const Ai={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Image:"Image"};typeof Object.freeze=="function"&&Object.freeze(Ai);class ss extends Error{constructor(n,s,c){s===401&&Oe(c)&&(n+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(n),this.status=s,this.url=c}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const ri=xi()?()=>self.worker&&self.worker.referrer:()=>(k.location.protocol==="blob:"?k.parent:k).location.href,Rs=function(i,n){if(!(/^file:/.test(s=i.url)||/^file:/.test(ri())&&!/^\w+:/.test(s))){if(k.fetch&&k.Request&&k.AbortController&&k.Request.prototype.hasOwnProperty("signal"))return(function(c,f){const y=new k.AbortController,w=new k.Request(c.url,{method:c.method||"GET",body:c.body,credentials:c.credentials,headers:c.headers,referrer:ri(),referrerPolicy:c.referrerPolicy,signal:y.signal});let E=!1,A=!1;const I=(j=w.url).indexOf("sku=")>0&&Oe(j);var j;c.type==="json"&&w.headers.set("Accept","application/json");const V=(q,X,te)=>{if(A)return;if(q&&q.message!=="SecurityError"&&Xn(q.toString()),X&&te)return U(X);const ae=Date.now();k.fetch(w).then((ge=>{if(ge.ok){const Ce=I?ge.clone():null;return U(ge,Ce,ae)}return f(new ss(ge.statusText,ge.status,c.url))})).catch((ge=>{ge.name!=="AbortError"&&f(new Error(`${ge.message} ${c.url}`))}))},U=(q,X,te)=>{(c.type==="arrayBuffer"?q.arrayBuffer():c.type==="json"?q.json():q.text()).then((ae=>{A||(X&&te&&(function(ge,Ce,ye){if(ki(),!vi)return;const Ee={status:Ce.status,statusText:Ce.statusText,headers:new k.Headers};Ce.headers.forEach(((Qe,Xe)=>Ee.headers.set(Xe,Qe)));const Re=Zr(Ce.headers.get("Cache-Control")||"");if(Re["no-store"])return;Re["max-age"]&&Ee.headers.set("Expires",new Date(ye+1e3*Re["max-age"]).toUTCString());const Me=Ee.headers.get("Expires");Me&&(new Date(Me).getTime()-ye<42e4||(function(Qe,Xe){if(Ps===void 0)try{new Response(new ReadableStream),Ps=!0}catch{Ps=!1}Ps?Xe(Qe.body):Qe.blob().then(Xe)})(Ce,(Qe=>{const Xe=new k.Response(Qe,Ee);ki(),vi&&vi.then((ft=>ft.put(yo(ge.url),Xe))).catch((ft=>Xn(ft.message)))})))})(w,X,te),E=!0,f(null,ae,q.headers.get("Cache-Control"),q.headers.get("Expires")))})).catch((ae=>{A||f(new Error(ae.message))}))};return I?(function(q,X){if(ki(),!vi)return X(null);const te=yo(q.url);vi.then((ae=>{ae.match(te).then((ge=>{const Ce=(function(ye){if(!ye)return!1;const Ee=new Date(ye.headers.get("Expires")||0),Re=Zr(ye.headers.get("Cache-Control")||"");return Ee>Date.now()&&!Re["no-cache"]})(ge);ae.delete(te),Ce&&ae.put(te,ge.clone()),X(null,ge,Ce)})).catch(X)})).catch(X)})(w,V):V(null,null),{cancel:()=>{A=!0,E||y.abort()}}})(i,n);if(xi()&&self.worker&&self.worker.actor)return self.worker.actor.send("getResource",i,n,void 0,!0)}var s;return(function(c,f){const y=new k.XMLHttpRequest;y.open(c.method||"GET",c.url,!0),c.type==="arrayBuffer"&&(y.responseType="arraybuffer");for(const w in c.headers)y.setRequestHeader(w,c.headers[w]);return c.type==="json"&&(y.responseType="text",y.setRequestHeader("Accept","application/json")),y.withCredentials=c.credentials==="include",y.onerror=()=>{f(new Error(y.statusText))},y.onload=()=>{if((y.status>=200&&y.status<300||y.status===0)&&y.response!==null){let w=y.response;if(c.type==="json")try{w=JSON.parse(y.response)}catch(E){return f(E)}f(null,w,y.getResponseHeader("Cache-Control"),y.getResponseHeader("Expires"))}else f(new ss(y.statusText,y.status,c.url))},y.send(c.body),{cancel:()=>y.abort()}})(i,n)},Ys=function(i,n){return Rs(vt(i,{type:"arrayBuffer"}),n)};function _o(i){const n=k.document.createElement("a");return n.href=i,n.protocol===k.document.location.protocol&&n.host===k.document.location.host}const Te="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let ne,re;ne=[],re=0;const ue=function(i,n){if(O.supported&&(i.headers||(i.headers={}),i.headers.accept="image/webp,*/*"),re>=z.MAX_PARALLEL_IMAGE_REQUESTS){const y={requestParameters:i,callback:n,cancelled:!1,cancel(){this.cancelled=!0}};return ne.push(y),y}re++;let s=!1;const c=()=>{if(!s)for(s=!0,re--;ne.length&&re<z.MAX_PARALLEL_IMAGE_REQUESTS;){const y=ne.shift(),{requestParameters:w,callback:E,cancelled:A}=y;A||(y.cancel=ue(w,E).cancel)}},f=Ys(i,((y,w,E,A)=>{c(),y?n(y):w&&(k.createImageBitmap?(function(I,j){const V=new k.Blob([new Uint8Array(I)],{type:"image/png"});k.createImageBitmap(V).then((U=>{j(null,U)})).catch((U=>{j(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))}))})(w,((I,j)=>n(I,j,E,A))):(function(I,j){const V=new k.Image,U=k.URL;V.onload=()=>{j(null,V),U.revokeObjectURL(V.src),V.onload=null,k.requestAnimationFrame((()=>{V.src=Te}))},V.onerror=()=>j(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const q=new k.Blob([new Uint8Array(I)],{type:"image/png"});V.src=I.byteLength?U.createObjectURL(q):Te})(w,((I,j)=>n(I,j,E,A))))}));return{cancel:()=>{f.cancel(),c()}}},Se="NO_ACCESS_TOKEN";function be(i){return i.indexOf("mapbox:")===0}function Oe(i){return z.API_URL_REGEX.test(i)}function Be(i){return z.API_CDN_URL_REGEX.test(i)}function je(i){return z.API_STYLE_REGEX.test(i)&&!Ze(i)}function Ze(i){return z.API_SPRITE_REGEX.test(i)}const St=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function Rt(i){const n=i.match(St);if(!n)throw new Error("Unable to parse URL object");return{protocol:n[1],authority:n[2],path:n[3]||"/",params:n[4]?n[4].split("&"):[]}}function bt(i){const n=i.params.length?`?${i.params.join("&")}`:"";return`${i.protocol}://${i.authority}${i.path}${n}`}const vn="mapbox.eventData";function An(i){if(!i)return null;const n=i.split(".");if(!n||n.length!==3)return null;try{return JSON.parse(decodeURIComponent(k.atob(n[1]).split("").map((s=>"%"+("00"+s.charCodeAt(0).toString(16)).slice(-2))).join("")))}catch{return null}}class kn{constructor(n){this.type=n,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(n){const s=An(z.ACCESS_TOKEN);let c="";return c=s&&s.u?k.btoa(encodeURIComponent(s.u).replace(/%([0-9A-F]{2})/g,((f,y)=>String.fromCharCode(+("0x"+y))))):z.ACCESS_TOKEN||"",n?`${vn}.${n}:${c}`:`${vn}:${c}`}fetchEventData(){const n=Wi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{const f=k.localStorage.getItem(s);f&&(this.eventData=JSON.parse(f));const y=k.localStorage.getItem(c);y&&(this.anonId=y)}catch{Xn("Unable to read from LocalStorage")}}saveEventData(){const n=Wi("localStorage"),s=this.getStorageKey(),c=this.getStorageKey("uuid");if(n)try{k.localStorage.setItem(c,this.anonId),Object.keys(this.eventData).length>=1&&k.localStorage.setItem(s,JSON.stringify(this.eventData))}catch{Xn("Unable to write to LocalStorage")}}processRequests(n){}postEvent(n,s,c,f){if(!z.EVENTS_URL)return;const y=Rt(z.EVENTS_URL);y.params.push(`access_token=${f||z.ACCESS_TOKEN||""}`);const w={event:this.type,created:new Date(n).toISOString()},E=s?vt(w,s):w,A={url:bt(y),headers:{"Content-Type":"text/plain"},body:JSON.stringify([E])};this.pendingRequest=(function(I,j){return Rs(vt(I,{method:"POST"}),j)})(A,(I=>{this.pendingRequest=null,c(I),this.saveEventData(),this.processRequests(f)}))}queueRequest(n,s){this.queue.push(n),this.processRequests(s)}}const Pn=new class extends kn{constructor(i){super("appUserTurnstile"),this._customAccessToken=i}postTurnstileEvent(i,n){z.EVENTS_URL&&z.ACCESS_TOKEN&&Array.isArray(i)&&i.some((s=>be(s)||Oe(s)))&&this.queueRequest(Date.now(),n)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const n=An(z.ACCESS_TOKEN),s=n?n.u:z.ACCESS_TOKEN;let c=s!==this.eventData.tokenU;Tn(this.anonId)||(this.anonId=wt(),c=!0);const f=this.queue.shift();if(this.eventData.lastSuccess){const y=new Date(this.eventData.lastSuccess),w=new Date(f),E=(f-this.eventData.lastSuccess)/864e5;c=c||E>=1||E<-1||y.getDate()!==w.getDate()}else c=!0;c?this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ie,"enabled.telemetry":!1,userId:this.anonId},(y=>{y||(this.eventData.lastSuccess=f,this.eventData.tokenU=s)}),i):this.processRequests()}},$n=Pn.postTurnstileEvent.bind(Pn),jr=new class extends kn{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(i,n,s,c){this.skuToken=n,this.errorCb=c,z.EVENTS_URL&&(s||z.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(Se)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||(this.anonId||this.fetchEventData(),Tn(this.anonId)||(this.anonId=wt()),this.postEvent(s,{sdkIdentifier:"mapbox-gl-js",sdkVersion:M,skuId:ie,skuToken:this.skuToken,userId:this.anonId},(c=>{c?this.errorCb(c):n&&(this.success[n]=!0)}),i))}},ii=jr.postMapLoadEvent.bind(jr),Zi=new class extends kn{constructor(){super("gljs.performance")}postPerformanceEvent(i,n){z.EVENTS_URL&&(i||z.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:n},i)}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:n,performanceData:s}=this.queue.shift(),c=(function(f){const y=k.performance.getEntriesByType("resource"),w=k.performance.getEntriesByType("mark"),E=(function(U){const q={};if(U){for(const X in U)if(X!=="other")for(const te of U[X]){const ae=`${X}ResolveRangeMin`,ge=`${X}ResolveRangeMax`,Ce=`${X}RequestCount`,ye=`${X}RequestCachedCount`;q[ae]=Math.min(q[ae]||1/0,te.startTime),q[ge]=Math.max(q[ge]||-1/0,te.responseEnd);const Ee=Re=>{q[Re]===void 0&&(q[Re]=0),++q[Re]};te.transferSize!==void 0&&te.transferSize===0&&Ee(ye),Ee(Ce)}}return q})((function(U,q){const X={};if(U)for(const te of U){const ae=q(te);X[ae]===void 0&&(X[ae]=[]),X[ae].push(te)}return X})(y,Ch)),A=k.devicePixelRatio,I=k.navigator.connection||k.navigator.mozConnection||k.navigator.webkitConnection,j={counters:[],metadata:[],attributes:[]},V=(U,q,X)=>{X!=null&&U.push({name:q,value:X.toString()})};for(const U in E)V(j.counters,U,E[U]);if(f.interactionRange[0]!==1/0&&f.interactionRange[1]!==-1/0&&(V(j.counters,"interactionRangeMin",f.interactionRange[0]),V(j.counters,"interactionRangeMax",f.interactionRange[1])),w)for(const U of Object.keys(ll)){const q=ll[U],X=w.find((te=>te.name===q));X&&V(j.counters,q,X.startTime)}return V(j.counters,"visibilityHidden",f.visibilityHidden),V(j.attributes,"style",(function(U){if(U)for(const q of U){const X=q.name.split("?")[0];if(je(X)){const te=X.split("/").slice(-2);if(te.length===2)return`mapbox://styles/${te[0]}/${te[1]}`}}})(y)),V(j.attributes,"terrainEnabled",f.terrainEnabled?"true":"false"),V(j.attributes,"fogEnabled",f.fogEnabled?"true":"false"),V(j.attributes,"projection",f.projection),V(j.attributes,"zoom",f.zoom),V(j.metadata,"devicePixelRatio",A),V(j.metadata,"connectionEffectiveType",I?I.effectiveType:void 0),V(j.metadata,"navigatorUserAgent",k.navigator.userAgent),V(j.metadata,"screenWidth",k.screen.width),V(j.metadata,"screenHeight",k.screen.height),V(j.metadata,"windowWidth",k.innerWidth),V(j.metadata,"windowHeight",k.innerHeight),V(j.metadata,"mapWidth",f.width/A),V(j.metadata,"mapHeight",f.height/A),V(j.metadata,"webglRenderer",f.renderer),V(j.metadata,"webglVendor",f.vendor),V(j.metadata,"sdkVersion",M),V(j.metadata,"sdkIdentifier","mapbox-gl-js"),j})(s);for(const f of c.metadata);for(const f of c.counters);for(const f of c.attributes);this.postEvent(n,c,(()=>{}),i)}},Rr=Zi.postPerformanceEvent.bind(Zi),xo=new class extends kn{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(i,n,s,c){if(!z.API_URL||!z.SESSION_PATH)return;const f=Rt(z.API_URL+z.SESSION_PATH);f.params.push(`sku=${n||""}`),f.params.push(`access_token=${c||z.ACCESS_TOKEN||""}`);const y={url:bt(f),headers:{"Content-Type":"text/plain"}};this.pendingRequest=(function(w,E){return Rs(vt(w,{method:"GET"}),E)})(y,(w=>{this.pendingRequest=null,s(w),this.saveEventData(),this.processRequests(c)}))}getSessionAPI(i,n,s,c){this.skuToken=n,this.errorCb=c,z.SESSION_PATH&&z.API_URL&&(s||z.ACCESS_TOKEN?this.queueRequest({id:i,timestamp:Date.now()},s):this.errorCb(new Error(Se)))}processRequests(i){if(this.pendingRequest||this.queue.length===0)return;const{id:n,timestamp:s}=this.queue.shift();n&&this.success[n]||this.getSession(s,this.skuToken,(c=>{c?this.errorCb(c):n&&(this.success[n]=!0)}),i)}},wi=xo.getSessionAPI.bind(xo),os=new Set,ll={create:"create",load:"load",fullLoad:"fullLoad"},up={mark(i){k.performance.mark(i)},measure(i,n,s){k.performance.measure(i,n,s)}};function Ch(i){const n=i.name.split("?")[0];return Be(n)&&n.includes("mapbox-gl.js")?"javascript":Be(n)&&n.includes("mapbox-gl.css")?"css":(function(s){return z.API_FONTS_REGEX.test(s)})(n)?"fontRange":Ze(n)?"sprite":je(n)?"style":(function(s){return z.API_TILEJSON_REGEX.test(s)})(n)?"tilejson":"other"}const nr=k.performance;function kh(i){const n=i?i.url.toString():void 0;return nr.getEntriesByName(n)}let Qc,Ur,nd,Js;const Bo={now:()=>nd!==void 0?nd:k.performance.now(),setNow(i){nd=i},restoreNow(){nd=void 0},frame(i){const n=k.requestAnimationFrame(i);return{cancel:()=>k.cancelAnimationFrame(n)}},getImageData(i,n=0){const{width:s,height:c}=i;Js||(Js=k.document.createElement("canvas"));const f=Js.getContext("2d",{willReadFrequently:!0});if(!f)throw new Error("failed to create canvas 2d context");return(s>Js.width||c>Js.height)&&(Js.width=s,Js.height=c),f.clearRect(-n,-n,s+2*n,c+2*n),f.drawImage(i,0,0,s,c),f.getImageData(-n,-n,s+2*n,c+2*n)},resolveURL:i=>(Qc||(Qc=k.document.createElement("a")),Qc.href=i,Qc.href),get devicePixelRatio(){return k.devicePixelRatio},get prefersReducedMotion(){return!!k.matchMedia&&(Ur==null&&(Ur=k.matchMedia("(prefers-reduced-motion: reduce)")),Ur.matches)}};function Zl(i,n,s){s[i]&&s[i].indexOf(n)!==-1||(s[i]=s[i]||[],s[i].push(n))}function Ah(i,n,s){if(s&&s[i]){const c=s[i].indexOf(n);c!==-1&&s[i].splice(c,1)}}class ka{constructor(n,s={}){vt(this,s),this.type=n}}class Qs extends ka{constructor(n,s={}){super("error",vt({error:n},s))}}class xs{on(n,s){return this._listeners=this._listeners||{},Zl(n,s,this._listeners),this}off(n,s){return Ah(n,s,this._listeners),Ah(n,s,this._oneTimeListeners),this}once(n,s){return s?(this._oneTimeListeners=this._oneTimeListeners||{},Zl(n,s,this._oneTimeListeners),this):new Promise((c=>this.once(n,c)))}fire(n,s){typeof n=="string"&&(n=new ka(n,s||{}));const c=n.type;if(this.listens(c)){n.target=this;const f=this._listeners&&this._listeners[c]?this._listeners[c].slice():[];for(const E of f)E.call(this,n);const y=this._oneTimeListeners&&this._oneTimeListeners[c]?this._oneTimeListeners[c].slice():[];for(const E of y)Ah(c,E,this._oneTimeListeners),E.call(this,n);const w=this._eventedParent;w&&(vt(n,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),w.fire(n))}else n instanceof Qs&&console.error(n.error);return this}listens(n){return!!(this._listeners&&this._listeners[n]&&this._listeners[n].length>0||this._oneTimeListeners&&this._oneTimeListeners[n]&&this._oneTimeListeners[n].length>0||this._eventedParent&&this._eventedParent.listens(n))}setEventedParent(n,s){return this._eventedParent=n,this._eventedParentData=s,this}}var dt=JSON.parse('{"$version":8,"$root":{"version":{"required":true,"type":"enum","values":[8]},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360,"units":"degrees"},"pitch":{"type":"number","default":0,"units":"degrees"},"light":{"type":"light"},"terrain":{"type":"terrain"},"fog":{"type":"fog"},"sources":{"required":true,"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"required":true,"type":"array","value":"layer"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_geojson","source_video","source_image"],"source_vector":{"type":{"required":true,"type":"enum","values":{"vector":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"required":true,"type":"enum","values":{"raster":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"scheme":{"type":"enum","values":{"xyz":{},"tms":{}},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"required":true,"type":"enum","values":{"raster-dem":{}}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512,"units":"pixels"},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":{},"mapbox":{}},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"required":true,"type":"enum","values":{"geojson":{}}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"}},"source_video":{"type":{"required":true,"type":"enum","values":{"video":{}}},"urls":{"required":true,"type":"array","value":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"required":true,"type":"enum","values":{"image":{}}},"url":{"required":true,"type":"string"},"coordinates":{"required":true,"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"layer":{"id":{"type":"string","required":true},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"raster":{},"hillshade":{},"background":{},"sky":{}},"required":true},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_symbol","layout_raster","layout_hillshade","layout_background","layout_sky"],"layout_background":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"},"fill-extrusion-edge-radius":{"type":"number","private":true,"default":0,"minimum":0,"maximum":1,"property-type":"constant"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":{},"round":{},"square":{}},"default":"butt","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":{},"round":{},"miter":{}},"default":"miter","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"requires":[{"line-join":"miter"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-round-limit":{"type":"number","default":1.05,"requires":[{"line-join":"round"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":{},"line":{},"line-center":{}},"default":"point","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-spacing":{"type":"number","default":250,"minimum":1,"units":"pixels","requires":[{"symbol-placement":"line"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"symbol-sort-key":{"type":"number","expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":{},"viewport-y":{},"source":{}},"default":"auto","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-allow-overlap":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-ignore-placement":{"type":"boolean","default":false,"requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-optional":{"type":"boolean","default":false,"requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-size":{"type":"number","default":1,"minimum":0,"units":"factor of the original icon size","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit":{"type":"enum","values":{"none":{},"width":{},"height":{},"both":{}},"default":"none","requires":["icon-image","text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"units":"pixels","requires":["icon-image","text-field",{"icon-text-fit":["both","width","height"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-keep-upright":{"type":"boolean","default":false,"requires":["icon-image",{"icon-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotation-alignment":{"type":"enum","values":{"map":{},"viewport":{},"auto":{}},"default":"auto","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-width":{"type":"number","default":10,"minimum":0,"units":"ems","requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"units":"ems","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":{},"left":{},"center":{},"right":{}},"default":"center","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","units":"ems","default":0,"requires":["text-field"],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"requires":["text-field",{"symbol-placement":["point"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-anchor":{"type":"enum","values":{"center":{},"left":{},"right":{},"top":{},"bottom":{},"top-left":{},"top-right":{},"bottom-left":{},"bottom-right":{}},"default":"center","requires":["text-field",{"!":"text-variable-anchor"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"units":"degrees","requires":["text-field",{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":{},"vertical":{}},"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-rotate":{"type":"number","default":0,"period":360,"units":"degrees","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-keep-upright":{"type":"boolean","default":true,"requires":["text-field",{"text-rotation-alignment":"map"},{"symbol-placement":["line","line-center"]}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-transform":{"type":"enum","values":{"none":{},"uppercase":{},"lowercase":{}},"default":"none","requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","units":"ems","length":2,"default":[0,0],"requires":["text-field",{"!":"text-radial-offset"}],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-ignore-placement":{"type":"boolean","default":false,"requires":["text-field"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-optional":{"type":"boolean","default":false,"requires":["text-field","icon-image"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":{},"none":{}},"default":"visible","property-type":"constant"}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"transition":false,"property-type":"data-driven","expression":{"interpolated":false,"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":{},"!=":{},">":{},">=":{},"<":{},"<=":{},"in":{},"!in":{},"all":{},"any":{},"none":{},"has":{},"!has":{},"within":{}}},"geometry_type":{"type":"enum","values":{"Point":{},"LineString":{},"Polygon":{}}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":{},"exponential":{},"interval":{},"categorical":{}},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":{},"lab":{},"hcl":{}},"default":"rgb"},"default":{"type":"*","required":false}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"high-color":{"type":"color","property-type":"data-constant","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"space-color":{"type":"color","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"horizon-blend":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"star-intensity":{"type":"number","property-type":"data-constant","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":{},"viewport":{}},"property-type":"data-constant","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","property-type":"data-constant","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","property-type":"data-constant","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"intensity":{"type":"number","property-type":"data-constant","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":{},"equalEarth":{},"equirectangular":{},"lambertConformalConic":{},"mercator":{},"naturalEarth":{},"winkelTripel":{},"globe":{}},"default":"mercator","required":true},"center":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-180,-90],"maximum":[180,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]},"parallels":{"type":"array","length":2,"value":"number","property-type":"data-constant","minimum":[-90,-90],"maximum":[90,90],"transition":false,"requires":[{"name":["albers","lambertConformalConic"]}]}},"terrain":{"source":{"type":"string","required":true},"exaggeration":{"type":"number","property-type":"data-constant","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["source"]}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_symbol","paint_raster","paint_hillshade","paint_background","paint_sky"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","transition":true,"requires":[{"!":"fill-pattern"},{"fill-antialias":true}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"fill-extrusion-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["fill-extrusion-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"units":"meters","transition":true,"requires":["fill-extrusion-height"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"fill-extrusion-ambient-occlusion-intensity":{"property-type":"data-constant","type":"number","private":true,"default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"property-type":"data-constant","type":"number","private":true,"default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true,"requires":["fill-extrusion-edge-radius"]},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"requires":["fill-extrusion-edge-radius"],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"line-pattern"}],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"line-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["line-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"transition":false,"units":"line widths","requires":[{"!":"line-pattern"}],"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-gradient":{"type":"color","transition":false,"requires":[{"!":"line-pattern"},{"source":"geojson","has":{"lineMetrics":true}}],"expression":{"interpolated":true,"parameters":["line-progress"]},"property-type":"color-ramp"},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"transition":false,"requires":[{"source":"geojson","has":{"lineMetrics":true}}],"property-type":"constant"}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"circle-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["circle-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-scale":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-pitch-alignment":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"units":"pixels","expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"transition":false,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"transition":false,"expression":{"interpolated":true,"parameters":["heatmap-density"]},"property-type":"color-ramp"},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["icon-image"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"icon-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["icon-image","icon-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","transition":true,"overridable":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","transition":true,"requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"units":"pixels","requires":["text-field"],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"text-translate-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"map","requires":["text-field","text-translate"],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"units":"degrees","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"raster-resampling":{"type":"enum","values":{"linear":{},"nearest":{}},"default":"linear","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"transition":false,"units":"milliseconds","expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"transition":false,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-illumination-anchor":{"type":"enum","values":{"map":{},"viewport":{}},"default":"viewport","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-shadow-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"hillshade-accent-color":{"type":"color","default":"#000000","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_background":{"background-color":{"type":"color","default":"#000000","transition":true,"requires":[{"!":"background-pattern"}],"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"},"background-pattern":{"type":"resolvedImage","transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":{},"atmosphere":{}},"default":"atmosphere","expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"requires":[{"sky-type":"atmosphere"}],"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-atmosphere-sun-intensity":{"type":"number","requires":[{"sky-type":"atmosphere"}],"default":10,"minimum":0,"maximum":100,"transition":false,"property-type":"data-constant"},"sky-gradient-center":{"type":"array","requires":[{"sky-type":"gradient"}],"value":"number","default":[0,0],"length":2,"units":"degrees","minimum":[0,0],"maximum":[360,180],"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient-radius":{"type":"number","requires":[{"sky-type":"gradient"}],"default":90,"minimum":0,"maximum":180,"transition":false,"expression":{"interpolated":false,"parameters":["zoom"]},"property-type":"data-constant"},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"transition":false,"requires":[{"sky-type":"gradient"}],"expression":{"interpolated":true,"parameters":["sky-radial-progress"]},"property-type":"color-ramp"},"sky-atmosphere-halo-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-atmosphere-color":{"type":"color","default":"white","transition":false,"requires":[{"sky-type":"atmosphere"}],"property-type":"data-constant"},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"property-type":"data-constant"}},"transition":{"duration":{"type":"number","default":300,"minimum":0,"units":"milliseconds"},"delay":{"type":"number","default":0,"minimum":0,"units":"milliseconds"}},"property-type":{"data-driven":{"type":"property-type"},"color-ramp":{"type":"property-type"},"data-constant":{"type":"property-type"},"constant":{"type":"property-type"}},"promoteId":{"*":{"type":"string"}}}');function bi(i,...n){for(const s of n)for(const c in s)i[c]=s[c];return i}function si(i){return i instanceof Number||i instanceof String||i instanceof Boolean?i.valueOf():i}function Ii(i){if(Array.isArray(i))return i.map(Ii);if(i instanceof Object&&!(i instanceof Number||i instanceof String||i instanceof Boolean)){const n={};for(const s in i)n[s]=Ii(i[s]);return n}return si(i)}class dp extends Error{constructor(n,s){super(s),this.message=s,this.key=n}}var Ns=dp;class Xl{constructor(n,s=[]){this.parent=n,this.bindings={};for(const[c,f]of s)this.bindings[c]=f}concat(n){return new Xl(this,n)}get(n){if(this.bindings[n])return this.bindings[n];if(this.parent)return this.parent.get(n);throw new Error(`${n} not found in scope.`)}has(n){return!!this.bindings[n]||!!this.parent&&this.parent.has(n)}}var Kl=Xl;const ia={kind:"null"},Ut={kind:"number"},Hn={kind:"string"},Bn={kind:"boolean"},vs={kind:"color"},Ds={kind:"object"},Rn={kind:"value"},Ls={kind:"collator"},cl={kind:"formatted"},rr={kind:"resolvedImage"};function js(i,n){return{kind:"array",itemType:i,N:n}}function Cr(i){if(i.kind==="array"){const n=Cr(i.itemType);return typeof i.N=="number"?`array<${n}, ${i.N}>`:i.itemType.kind==="value"?"array":`array<${n}>`}return i.kind}const rd=[ia,Ut,Hn,Bn,vs,cl,Ds,js(Rn),rr];function Fo(i,n){if(n.kind==="error")return null;if(i.kind==="array"){if(n.kind==="array"&&(n.N===0&&n.itemType.kind==="value"||!Fo(i.itemType,n.itemType))&&(typeof i.N!="number"||i.N===n.N))return null}else{if(i.kind===n.kind)return null;if(i.kind==="value"){for(const s of rd)if(!Fo(s,n))return null}}return`Expected ${Cr(i)} but found ${Cr(n)} instead.`}function Yl(i,n){return n.some((s=>s.kind===i.kind))}function Jl(i,n){return n.some((s=>s==="null"?i===null:s==="array"?Array.isArray(i):s==="object"?i&&!Array.isArray(i)&&typeof i=="object":s===typeof i))}var eu,tu={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function eo(i){return(i=Math.round(i))<0?0:i>255?255:i}function to(i){return eo(i[i.length-1]==="%"?parseFloat(i)/100*255:parseInt(i))}function vo(i){return(n=i[i.length-1]==="%"?parseFloat(i)/100:parseFloat(i))<0?0:n>1?1:n;var n}function Vo(i,n,s){return s<0?s+=1:s>1&&(s-=1),6*s<1?i+(n-i)*s*6:2*s<1?n:3*s<2?i+(n-i)*(2/3-s)*6:i}try{eu={}.parseCSSColor=function(i){var n,s=i.replace(/ /g,"").toLowerCase();if(s in tu)return tu[s].slice();if(s[0]==="#")return s.length===4?(n=parseInt(s.substr(1),16))>=0&&n<=4095?[(3840&n)>>4|(3840&n)>>8,240&n|(240&n)>>4,15&n|(15&n)<<4,1]:null:s.length===7&&(n=parseInt(s.substr(1),16))>=0&&n<=16777215?[(16711680&n)>>16,(65280&n)>>8,255&n,1]:null;var c=s.indexOf("("),f=s.indexOf(")");if(c!==-1&&f+1===s.length){var y=s.substr(0,c),w=s.substr(c+1,f-(c+1)).split(","),E=1;switch(y){case"rgba":if(w.length!==4)return null;E=vo(w.pop());case"rgb":return w.length!==3?null:[to(w[0]),to(w[1]),to(w[2]),E];case"hsla":if(w.length!==4)return null;E=vo(w.pop());case"hsl":if(w.length!==3)return null;var A=(parseFloat(w[0])%360+360)%360/360,I=vo(w[1]),j=vo(w[2]),V=j<=.5?j*(I+1):j+I-j*I,U=2*j-V;return[eo(255*Vo(U,V,A+1/3)),eo(255*Vo(U,V,A)),eo(255*Vo(U,V,A-1/3)),E];default:return null}}return null}}catch{}class Mi{constructor(n,s,c,f=1){this.r=n,this.g=s,this.b=c,this.a=f}static parse(n){if(!n)return;if(n instanceof Mi)return n;if(typeof n!="string")return;const s=eu(n);return s?new Mi(s[0]/255*s[3],s[1]/255*s[3],s[2]/255*s[3],s[3]):void 0}toString(){const[n,s,c,f]=this.toArray();return`rgba(${Math.round(n)},${Math.round(s)},${Math.round(c)},${f})`}toArray(){const{r:n,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[255*n/f,255*s/f,255*c/f,f]}toArray01(){const{r:n,g:s,b:c,a:f}=this;return f===0?[0,0,0,0]:[n/f,s/f,c/f,f]}toArray01PremultipliedAlpha(){const{r:n,g:s,b:c,a:f}=this;return[n,s,c,f]}}Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0),Mi.red=new Mi(1,0,0,1),Mi.blue=new Mi(0,0,1,1);var _r=Mi;class Ih{constructor(n,s,c){this.sensitivity=n?s?"variant":"case":s?"accent":"base",this.locale=c,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(n,s){return this.collator.compare(n,s)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class id{constructor(n,s,c,f,y){this.text=n.normalize?n.normalize():n,this.image=s,this.scale=c,this.fontStack=f,this.textColor=y}}class Pi{constructor(n){this.sections=n}static fromString(n){return new Pi([new id(n,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some((n=>n.text.length!==0||n.image&&n.image.name.length!==0))}static factory(n){return n instanceof Pi?n:Pi.fromString(n)}toString(){return this.sections.length===0?"":this.sections.map((n=>n.text)).join("")}serialize(){const n=["format"];for(const s of this.sections){if(s.image){n.push(["image",s.image.name]);continue}n.push(s.text);const c={};s.fontStack&&(c["text-font"]=["literal",s.fontStack.split(",")]),s.scale&&(c["font-scale"]=s.scale),s.textColor&&(c["text-color"]=["rgba"].concat(s.textColor.toArray())),n.push(c)}return n}}class no{constructor(n){this.name=n.name,this.available=n.available}toString(){return this.name}static fromString(n){return n?new no({name:n,available:!1}):null}serialize(){return["image",this.name]}}function Mh(i,n,s,c){return typeof i=="number"&&i>=0&&i<=255&&typeof n=="number"&&n>=0&&n<=255&&typeof s=="number"&&s>=0&&s<=255?c===void 0||typeof c=="number"&&c>=0&&c<=1?null:`Invalid rgba value [${[i,n,s,c].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof c=="number"?[i,n,s,c]:[i,n,s]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function Aa(i){if(i===null||typeof i=="string"||typeof i=="boolean"||typeof i=="number"||i instanceof _r||i instanceof Ih||i instanceof Pi||i instanceof no)return!0;if(Array.isArray(i)){for(const n of i)if(!Aa(n))return!1;return!0}if(typeof i=="object"){for(const n in i)if(!Aa(i[n]))return!1;return!0}return!1}function Br(i){if(i===null)return ia;if(typeof i=="string")return Hn;if(typeof i=="boolean")return Bn;if(typeof i=="number")return Ut;if(i instanceof _r)return vs;if(i instanceof Ih)return Ls;if(i instanceof Pi)return cl;if(i instanceof no)return rr;if(Array.isArray(i)){const n=i.length;let s;for(const c of i){const f=Br(c);if(s){if(s===f)continue;s=Rn;break}s=f}return js(s||Rn,n)}return Ds}function nu(i){const n=typeof i;return i===null?"":n==="string"||n==="number"||n==="boolean"?String(i):i instanceof _r||i instanceof Pi||i instanceof no?i.toString():JSON.stringify(i)}class ul{constructor(n,s){this.type=n,this.value=s}static parse(n,s){if(n.length!==2)return s.error(`'literal' expression requires exactly one argument, but found ${n.length-1} instead.`);if(!Aa(n[1]))return s.error("invalid value");const c=n[1];let f=Br(c);const y=s.expectedType;return f.kind!=="array"||f.N!==0||!y||y.kind!=="array"||typeof y.N=="number"&&y.N!==0||(f=y),new ul(f,c)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof _r?["rgba"].concat(this.value.toArray()):this.value instanceof Pi?this.value.serialize():this.value}}var wo=ul,Xr=class{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}};const Ql={string:Hn,number:Ut,boolean:Bn,object:Ds};class Ph{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");let c,f=1;const y=n[0];if(y==="array"){let E,A;if(n.length>2){const I=n[1];if(typeof I!="string"||!(I in Ql)||I==="object")return s.error('The item type argument of "array" must be one of string, number, boolean',1);E=Ql[I],f++}else E=Rn;if(n.length>3){if(n[2]!==null&&(typeof n[2]!="number"||n[2]<0||n[2]!==Math.floor(n[2])))return s.error('The length argument to "array" must be a positive integer literal',2);A=n[2],f++}c=js(E,A)}else c=Ql[y];const w=[];for(;f<n.length;f++){const E=s.parse(n[f],f,Rn);if(!E)return null;w.push(E)}return new Ph(c,w)}evaluate(n){for(let s=0;s<this.args.length;s++){const c=this.args[s].evaluate(n);if(!Fo(this.type,Br(c)))return c;if(s===this.args.length-1)throw new Xr(`Expected value to be of type ${Cr(this.type)}, but found ${Cr(Br(c))} instead.`)}return null}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){const n=this.type,s=[n.kind];if(n.kind==="array"){const c=n.itemType;if(c.kind==="string"||c.kind==="number"||c.kind==="boolean"){s.push(c.kind);const f=n.N;(typeof f=="number"||this.args.length>1)&&s.push(f)}}return s.concat(this.args.map((c=>c.serialize())))}}var sa=Ph;class Uo{constructor(n){this.type=cl,this.sections=n}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[1];if(!Array.isArray(c)&&typeof c=="object")return s.error("First argument must be an image or text section.");const f=[];let y=!1;for(let w=1;w<=n.length-1;++w){const E=n[w];if(y&&typeof E=="object"&&!Array.isArray(E)){y=!1;let A=null;if(E["font-scale"]&&(A=s.parse(E["font-scale"],1,Ut),!A))return null;let I=null;if(E["text-font"]&&(I=s.parse(E["text-font"],1,js(Hn)),!I))return null;let j=null;if(E["text-color"]&&(j=s.parse(E["text-color"],1,vs),!j))return null;const V=f[f.length-1];V.scale=A,V.font=I,V.textColor=j}else{const A=s.parse(n[w],1,Rn);if(!A)return null;const I=A.type.kind;if(I!=="string"&&I!=="value"&&I!=="null"&&I!=="resolvedImage")return s.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");y=!0,f.push({content:A,scale:null,font:null,textColor:null})}}return new Uo(f)}evaluate(n){return new Pi(this.sections.map((s=>{const c=s.content.evaluate(n);return Br(c)===rr?new id("",c,null,null,null):new id(nu(c),null,s.scale?s.scale.evaluate(n):null,s.font?s.font.evaluate(n).join(","):null,s.textColor?s.textColor.evaluate(n):null)})))}eachChild(n){for(const s of this.sections)n(s.content),s.scale&&n(s.scale),s.font&&n(s.font),s.textColor&&n(s.textColor)}outputDefined(){return!1}serialize(){const n=["format"];for(const s of this.sections){n.push(s.content.serialize());const c={};s.scale&&(c["font-scale"]=s.scale.serialize()),s.font&&(c["text-font"]=s.font.serialize()),s.textColor&&(c["text-color"]=s.textColor.serialize()),n.push(c)}return n}}class dl{constructor(n){this.type=rr,this.input=n}static parse(n,s){if(n.length!==2)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Hn);return c?new dl(c):s.error("No image name provided.")}evaluate(n){const s=this.input.evaluate(n),c=no.fromString(s);return c&&n.availableImages&&(c.available=n.availableImages.indexOf(s)>-1),c}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){return["image",this.input.serialize()]}}const Rh={"to-boolean":Bn,"to-color":vs,"to-number":Ut,"to-string":Hn};class sd{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expected at least one argument.");const c=n[0];if((c==="to-boolean"||c==="to-string")&&n.length!==2)return s.error("Expected one argument.");const f=Rh[c],y=[];for(let w=1;w<n.length;w++){const E=s.parse(n[w],w,Rn);if(!E)return null;y.push(E)}return new sd(f,y)}evaluate(n){if(this.type.kind==="boolean")return!!this.args[0].evaluate(n);if(this.type.kind==="color"){let s,c;for(const f of this.args){if(s=f.evaluate(n),c=null,s instanceof _r)return s;if(typeof s=="string"){const y=n.parseColor(s);if(y)return y}else if(Array.isArray(s)&&(c=s.length<3||s.length>4?`Invalid rbga value ${JSON.stringify(s)}: expected an array containing either three or four numeric values.`:Mh(s[0],s[1],s[2],s[3]),!c))return new _r(s[0]/255,s[1]/255,s[2]/255,s[3])}throw new Xr(c||`Could not parse color from value '${typeof s=="string"?s:String(JSON.stringify(s))}'`)}if(this.type.kind==="number"){let s=null;for(const c of this.args){if(s=c.evaluate(n),s===null)return 0;const f=Number(s);if(!isNaN(f))return f}throw new Xr(`Could not convert ${JSON.stringify(s)} to number.`)}return this.type.kind==="formatted"?Pi.fromString(nu(this.args[0].evaluate(n))):this.type.kind==="resolvedImage"?no.fromString(nu(this.args[0].evaluate(n))):nu(this.args[0].evaluate(n))}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){if(this.type.kind==="formatted")return new Uo([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new dl(this.args[0]).serialize();const n=[`to-${this.type.kind}`];return this.eachChild((s=>{n.push(s.serialize())})),n}}var Os=sd;const ro=["Unknown","Point","LineString","Polygon"];var ec=class{constructor(){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?ro[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,n=this.featureDistanceData.scale,{x:s,y:c}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(s*n-i[0])+this.featureDistanceData.bearing[1]*(c*n-i[1])}return 0}parseColor(i){let n=this._parseColorCache[i];return n||(n=this._parseColorCache[i]=_r.parse(i)),n}};class Ia{constructor(n,s,c,f){this.name=n,this.type=s,this._evaluate=c,this.args=f}evaluate(n){return this._evaluate(n,this.args)}eachChild(n){this.args.forEach(n)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map((n=>n.serialize())))}static parse(n,s){const c=n[0],f=Ia.definitions[c];if(!f)return s.error(`Unknown expression "${c}". If you wanted a literal array, use ["literal", [...]].`,0);const y=Array.isArray(f)?f[0]:f.type,w=Array.isArray(f)?[[f[1],f[2]]]:f.overloads,E=w.filter((([I])=>!Array.isArray(I)||I.length===n.length-1));let A=null;for(const[I,j]of E){A=new jh(s.registry,s.path,null,s.scope);const V=[];let U=!1;for(let q=1;q<n.length;q++){const X=n[q],te=Array.isArray(I)?I[q-1]:I.type,ae=A.parse(X,1+V.length,te);if(!ae){U=!0;break}V.push(ae)}if(!U)if(Array.isArray(I)&&I.length!==V.length)A.error(`Expected ${I.length} arguments, but found ${V.length} instead.`);else{for(let q=0;q<V.length;q++){const X=Array.isArray(I)?I[q]:I.type,te=V[q];A.concat(q+1).checkSubtype(X,te.type)}if(A.errors.length===0)return new Ia(c,y,j,V)}}if(E.length===1)s.errors.push(...A.errors);else{const I=(E.length?E:w).map((([V])=>{return U=V,Array.isArray(U)?`(${U.map(Cr).join(", ")})`:`(${Cr(U.type)}...)`;var U})).join(" | "),j=[];for(let V=1;V<n.length;V++){const U=s.parse(n[V],1+j.length);if(!U)return null;j.push(Cr(U.type))}s.error(`Expected arguments of type ${I}, but found (${j.join(", ")}) instead.`)}return null}static register(n,s){Ia.definitions=s;for(const c in s)n[c]=Ia}}var io=Ia;class Ma{constructor(n,s,c){this.type=Ls,this.locale=c,this.caseSensitive=n,this.diacriticSensitive=s}static parse(n,s){if(n.length!==2)return s.error("Expected one argument.");const c=n[1];if(typeof c!="object"||Array.isArray(c))return s.error("Collator options argument must be an object.");const f=s.parse(c["case-sensitive"]!==void 0&&c["case-sensitive"],1,Bn);if(!f)return null;const y=s.parse(c["diacritic-sensitive"]!==void 0&&c["diacritic-sensitive"],1,Bn);if(!y)return null;let w=null;return c.locale&&(w=s.parse(c.locale,1,Hn),!w)?null:new Ma(f,y,w)}evaluate(n){return new Ih(this.caseSensitive.evaluate(n),this.diacriticSensitive.evaluate(n),this.locale?this.locale.evaluate(n):null)}eachChild(n){n(this.caseSensitive),n(this.diacriticSensitive),this.locale&&n(this.locale)}outputDefined(){return!1}serialize(){const n={};return n["case-sensitive"]=this.caseSensitive.serialize(),n["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(n.locale=this.locale.serialize()),["collator",n]}}const $o=8192;function Xi(i,n){i[0]=Math.min(i[0],n[0]),i[1]=Math.min(i[1],n[1]),i[2]=Math.max(i[2],n[0]),i[3]=Math.max(i[3],n[1])}function bo(i,n){return!(i[0]<=n[0]||i[2]>=n[2]||i[1]<=n[1]||i[3]>=n[3])}function hl(i,n){const s=(180+i[0])/360,c=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i[1]*Math.PI/360)))/360,f=Math.pow(2,n.z);return[Math.round(s*f*$o),Math.round(c*f*$o)]}function tc(i,n,s){const c=i[0]-n[0],f=i[1]-n[1],y=i[0]-s[0],w=i[1]-s[1];return c*w-y*f==0&&c*y<=0&&f*w<=0}function od(i,n){let s=!1;for(let w=0,E=n.length;w<E;w++){const A=n[w];for(let I=0,j=A.length;I<j-1;I++){if(tc(i,A[I],A[I+1]))return!1;(f=A[I])[1]>(c=i)[1]!=(y=A[I+1])[1]>c[1]&&c[0]<(y[0]-f[0])*(c[1]-f[1])/(y[1]-f[1])+f[0]&&(s=!s)}}var c,f,y;return s}function ru(i,n){for(let s=0;s<n.length;s++)if(od(i,n[s]))return!0;return!1}function iu(i,n,s,c){const f=c[0]-s[0],y=c[1]-s[1],w=(i[0]-s[0])*y-f*(i[1]-s[1]),E=(n[0]-s[0])*y-f*(n[1]-s[1]);return w>0&&E<0||w<0&&E>0}function Go(i,n,s){for(const I of s)for(let j=0;j<I.length-1;++j)if((E=[(w=I[j+1])[0]-(y=I[j])[0],w[1]-y[1]])[0]*(A=[(f=n)[0]-(c=i)[0],f[1]-c[1]])[1]-E[1]*A[0]!=0&&iu(c,f,y,w)&&iu(y,w,c,f))return!0;var c,f,y,w,E,A;return!1}function Yn(i,n){for(let s=0;s<i.length;++s)if(!od(i[s],n))return!1;for(let s=0;s<i.length-1;++s)if(Go(i[s],i[s+1],n))return!1;return!0}function hp(i,n){for(let s=0;s<n.length;s++)if(Yn(i,n[s]))return!0;return!1}function Nh(i,n,s){const c=[];for(let f=0;f<i.length;f++){const y=[];for(let w=0;w<i[f].length;w++){const E=hl(i[f][w],s);Xi(n,E),y.push(E)}c.push(y)}return c}function fp(i,n,s){const c=[];for(let f=0;f<i.length;f++){const y=Nh(i[f],n,s);c.push(y)}return c}function Dh(i,n,s,c){if(i[0]<s[0]||i[0]>s[2]){const f=.5*c;let y=i[0]-s[0]>f?-c:s[0]-i[0]>f?c:0;y===0&&(y=i[0]-s[2]>f?-c:s[2]-i[0]>f?c:0),i[0]+=y}Xi(n,i)}function ad(i,n,s,c){const f=Math.pow(2,c.z)*$o,y=[c.x*$o,c.y*$o],w=[];if(!i)return w;for(const E of i)for(const A of E){const I=[A.x+y[0],A.y+y[1]];Dh(I,n,s,f),w.push(I)}return w}function Lh(i,n,s,c){const f=Math.pow(2,c.z)*$o,y=[c.x*$o,c.y*$o],w=[];if(!i)return w;for(const A of i){const I=[];for(const j of A){const V=[j.x+y[0],j.y+y[1]];Xi(n,V),I.push(V)}w.push(I)}if(n[2]-n[0]<=f/2){(E=n)[0]=E[1]=1/0,E[2]=E[3]=-1/0;for(const A of w)for(const I of A)Dh(I,n,s,f)}var E;return w}class nc{constructor(n,s){this.type=Bn,this.geojson=n,this.geometries=s}static parse(n,s){if(n.length!==2)return s.error(`'within' expression requires exactly one argument, but found ${n.length-1} instead.`);if(Aa(n[1])){const c=n[1];if(c.type==="FeatureCollection")for(let f=0;f<c.features.length;++f){const y=c.features[f].geometry.type;if(y==="Polygon"||y==="MultiPolygon")return new nc(c,c.features[f].geometry)}else if(c.type==="Feature"){const f=c.geometry.type;if(f==="Polygon"||f==="MultiPolygon")return new nc(c,c.geometry)}else if(c.type==="Polygon"||c.type==="MultiPolygon")return new nc(c,c)}return s.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(n){if(n.geometry()!=null&&n.canonicalID()!=null){if(n.geometryType()==="Point")return(function(s,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(!w)return!1;if(c.type==="Polygon"){const E=Nh(c.coordinates,y,w),A=ad(s.geometry(),f,y,w);if(!bo(f,y))return!1;for(const I of A)if(!od(I,E))return!1}if(c.type==="MultiPolygon"){const E=fp(c.coordinates,y,w),A=ad(s.geometry(),f,y,w);if(!bo(f,y))return!1;for(const I of A)if(!ru(I,E))return!1}return!0})(n,this.geometries);if(n.geometryType()==="LineString")return(function(s,c){const f=[1/0,1/0,-1/0,-1/0],y=[1/0,1/0,-1/0,-1/0],w=s.canonicalID();if(!w)return!1;if(c.type==="Polygon"){const E=Nh(c.coordinates,y,w),A=Lh(s.geometry(),f,y,w);if(!bo(f,y))return!1;for(const I of A)if(!Yn(I,E))return!1}if(c.type==="MultiPolygon"){const E=fp(c.coordinates,y,w),A=Lh(s.geometry(),f,y,w);if(!bo(f,y))return!1;for(const I of A)if(!hp(I,E))return!1}return!0})(n,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}var ld=nc;function rc(i){if(i instanceof io&&(i.name==="get"&&i.args.length===1||i.name==="feature-state"||i.name==="has"&&i.args.length===1||i.name==="properties"||i.name==="geometry-type"||i.name==="id"||/^filter-/.test(i.name))||i instanceof ld)return!1;let n=!0;return i.eachChild((s=>{n&&!rc(s)&&(n=!1)})),n}function oa(i){if(i instanceof io&&i.name==="feature-state")return!1;let n=!0;return i.eachChild((s=>{n&&!oa(s)&&(n=!1)})),n}function Pa(i,n){if(i instanceof io&&n.indexOf(i.name)>=0)return!1;let s=!0;return i.eachChild((c=>{s&&!Pa(c,n)&&(s=!1)})),s}class cd{constructor(n,s){this.type=s.type,this.name=n,this.boundExpression=s}static parse(n,s){if(n.length!==2||typeof n[1]!="string")return s.error("'var' expression requires exactly one string literal argument.");const c=n[1];return s.scope.has(c)?new cd(c,s.scope.get(c)):s.error(`Unknown variable "${c}". Make sure "${c}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(n){return this.boundExpression.evaluate(n)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}var pp=cd;class su{constructor(n,s=[],c,f=new Kl,y=[]){this.registry=n,this.path=s,this.key=s.map((w=>`[${w}]`)).join(""),this.scope=f,this.errors=y,this.expectedType=c}parse(n,s,c,f,y={}){return s?this.concat(s,c,f)._parse(n,y):this._parse(n,y)}_parse(n,s){function c(f,y,w){return w==="assert"?new sa(y,[f]):w==="coerce"?new Os(y,[f]):f}if(n!==null&&typeof n!="string"&&typeof n!="boolean"&&typeof n!="number"||(n=["literal",n]),Array.isArray(n)){if(n.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const f=n[0];if(typeof f!="string")return this.error(`Expression name must be a string, but found ${typeof f} instead. If you wanted a literal array, use ["literal", [...]].`,0),null;const y=this.registry[f];if(y){let w=y.parse(n,this);if(!w)return null;if(this.expectedType){const E=this.expectedType,A=w.type;if(E.kind!=="string"&&E.kind!=="number"&&E.kind!=="boolean"&&E.kind!=="object"&&E.kind!=="array"||A.kind!=="value")if(E.kind!=="color"&&E.kind!=="formatted"&&E.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(E,A))return null}else w=c(w,E,s.typeAnnotation||"coerce");else w=c(w,E,s.typeAnnotation||"assert")}if(!(w instanceof wo)&&w.type.kind!=="resolvedImage"&&ou(w)){const E=new ec;try{w=new wo(w.type,w.evaluate(E))}catch(A){return this.error(A.message),null}}return w}return this.error(`Unknown expression "${f}". If you wanted a literal array, use ["literal", [...]].`,0)}return this.error(n===void 0?"'undefined' value invalid. Use null instead.":typeof n=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof n} instead.`)}concat(n,s,c){const f=typeof n=="number"?this.path.concat(n):this.path,y=c?this.scope.concat(c):this.scope;return new su(this.registry,f,s||null,y,this.errors)}error(n,...s){const c=`${this.key}${s.map((f=>`[${f}]`)).join("")}`;this.errors.push(new Ns(c,n))}checkSubtype(n,s){const c=Fo(n,s);return c&&this.error(c),c}}var jh=su;function ou(i){if(i instanceof pp)return ou(i.boundExpression);if(i instanceof io&&i.name==="error"||i instanceof Ma||i instanceof ld)return!1;const n=i instanceof Os||i instanceof sa;let s=!0;return i.eachChild((c=>{s=n?s&&ou(c):s&&c instanceof wo})),!!s&&rc(i)&&Pa(i,["zoom","heatmap-density","line-progress","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center"])}function ud(i,n){const s=i.length-1;let c,f,y=0,w=s,E=0;for(;y<=w;)if(E=Math.floor((y+w)/2),c=i[E],f=i[E+1],c<=n){if(E===s||n<f)return E;y=E+1}else{if(!(c>n))throw new Xr("Input is not a number.");w=E-1}return 0}class dd{constructor(n,s,c){this.type=n,this.input=s,this.labels=[],this.outputs=[];for(const[f,y]of c)this.labels.push(f),this.outputs.push(y)}static parse(n,s){if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");const c=s.parse(n[1],1,Ut);if(!c)return null;const f=[];let y=null;s.expectedType&&s.expectedType.kind!=="value"&&(y=s.expectedType);for(let w=1;w<n.length;w+=2){const E=w===1?-1/0:n[w],A=n[w+1],I=w,j=w+1;if(typeof E!="number")return s.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',I);if(f.length&&f[f.length-1][0]>=E)return s.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',I);const V=s.parse(A,j,y);if(!V)return null;y=y||V.type,f.push([E,V])}return new dd(y,c,f)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=s[0])return c[0].evaluate(n);const y=s.length;return f>=s[y-1]?c[y-1].evaluate(n):c[ud(s,f)].evaluate(n)}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}serialize(){const n=["step",this.input.serialize()];for(let s=0;s<this.labels.length;s++)s>0&&n.push(this.labels[s]),n.push(this.outputs[s].serialize());return n}}var Oh=dd;function Kn(i,n,s){return i*(1-s)+n*s}var au=Object.freeze({__proto__:null,array:function(i,n,s){return i.map(((c,f)=>Kn(c,n[f],s)))},color:function(i,n,s){return new _r(Kn(i.r,n.r,s),Kn(i.g,n.g,s),Kn(i.b,n.b,s),Kn(i.a,n.a,s))},number:Kn});const mp=.95047,zh=1.08883,gp=4/29,fl=6/29,Bh=3*fl*fl,ng=fl*fl*fl,Fh=Math.PI/180,lu=180/Math.PI;function Vh(i){return i>ng?Math.pow(i,1/3):i/Bh+gp}function hd(i){return i>fl?i*i*i:Bh*(i-gp)}function fd(i){return 255*(i<=.0031308?12.92*i:1.055*Math.pow(i,1/2.4)-.055)}function cu(i){return(i/=255)<=.04045?i/12.92:Math.pow((i+.055)/1.055,2.4)}function Uh(i){const n=cu(i.r),s=cu(i.g),c=cu(i.b),f=Vh((.4124564*n+.3575761*s+.1804375*c)/mp),y=Vh((.2126729*n+.7151522*s+.072175*c)/1);return{l:116*y-16,a:500*(f-y),b:200*(y-Vh((.0193339*n+.119192*s+.9503041*c)/zh)),alpha:i.a}}function $h(i){let n=(i.l+16)/116,s=isNaN(i.a)?n:n+i.a/500,c=isNaN(i.b)?n:n-i.b/200;return n=1*hd(n),s=mp*hd(s),c=zh*hd(c),new _r(fd(3.2404542*s-1.5371385*n-.4985314*c),fd(-.969266*s+1.8760108*n+.041556*c),fd(.0556434*s-.2040259*n+1.0572252*c),i.alpha)}function ic(i,n,s){const c=n-i;return i+s*(c>180||c<-180?c-360*Math.round(c/360):c)}const uu={forward:Uh,reverse:$h,interpolate:function(i,n,s){return{l:Kn(i.l,n.l,s),a:Kn(i.a,n.a,s),b:Kn(i.b,n.b,s),alpha:Kn(i.alpha,n.alpha,s)}}},sc={forward:function(i){const{l:n,a:s,b:c}=Uh(i),f=Math.atan2(c,s)*lu;return{h:f<0?f+360:f,c:Math.sqrt(s*s+c*c),l:n,alpha:i.a}},reverse:function(i){const n=i.h*Fh,s=i.c;return $h({l:i.l,a:Math.cos(n)*s,b:Math.sin(n)*s,alpha:i.alpha})},interpolate:function(i,n,s){return{h:ic(i.h,n.h,s),c:Kn(i.c,n.c,s),l:Kn(i.l,n.l,s),alpha:Kn(i.alpha,n.alpha,s)}}};var Gh=Object.freeze({__proto__:null,hcl:sc,lab:uu});class oc{constructor(n,s,c,f,y){this.type=n,this.operator=s,this.interpolation=c,this.input=f,this.labels=[],this.outputs=[];for(const[w,E]of y)this.labels.push(w),this.outputs.push(E)}static interpolationFactor(n,s,c,f){let y=0;if(n.name==="exponential")y=pd(s,n.base,c,f);else if(n.name==="linear")y=pd(s,1,c,f);else if(n.name==="cubic-bezier"){const w=n.controlPoints;y=new ze(w[0],w[1],w[2],w[3]).solve(pd(s,1,c,f))}return y}static parse(n,s){let[c,f,y,...w]=n;if(!Array.isArray(f)||f.length===0)return s.error("Expected an interpolation type expression.",1);if(f[0]==="linear")f={name:"linear"};else if(f[0]==="exponential"){const I=f[1];if(typeof I!="number")return s.error("Exponential interpolation requires a numeric base.",1,1);f={name:"exponential",base:I}}else{if(f[0]!=="cubic-bezier")return s.error(`Unknown interpolation type ${String(f[0])}`,1,0);{const I=f.slice(1);if(I.length!==4||I.some((j=>typeof j!="number"||j<0||j>1)))return s.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);f={name:"cubic-bezier",controlPoints:I}}}if(n.length-1<4)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if((n.length-1)%2!=0)return s.error("Expected an even number of arguments.");if(y=s.parse(y,2,Ut),!y)return null;const E=[];let A=null;c==="interpolate-hcl"||c==="interpolate-lab"?A=vs:s.expectedType&&s.expectedType.kind!=="value"&&(A=s.expectedType);for(let I=0;I<w.length;I+=2){const j=w[I],V=w[I+1],U=I+3,q=I+4;if(typeof j!="number")return s.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(E.length&&E[E.length-1][0]>=j)return s.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const X=s.parse(V,q,A);if(!X)return null;A=A||X.type,E.push([j,X])}return A.kind==="number"||A.kind==="color"||A.kind==="array"&&A.itemType.kind==="number"&&typeof A.N=="number"?new oc(A,c,f,y,E):s.error(`Type ${Cr(A)} is not interpolatable.`)}evaluate(n){const s=this.labels,c=this.outputs;if(s.length===1)return c[0].evaluate(n);const f=this.input.evaluate(n);if(f<=s[0])return c[0].evaluate(n);const y=s.length;if(f>=s[y-1])return c[y-1].evaluate(n);const w=ud(s,f),E=oc.interpolationFactor(this.interpolation,f,s[w],s[w+1]),A=c[w].evaluate(n),I=c[w+1].evaluate(n);return this.operator==="interpolate"?au[this.type.kind.toLowerCase()](A,I,E):this.operator==="interpolate-hcl"?sc.reverse(sc.interpolate(sc.forward(A),sc.forward(I),E)):uu.reverse(uu.interpolate(uu.forward(A),uu.forward(I),E))}eachChild(n){n(this.input);for(const s of this.outputs)n(s)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))}serialize(){let n;n=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier"].concat(this.interpolation.controlPoints);const s=[this.operator,n,this.input.serialize()];for(let c=0;c<this.labels.length;c++)s.push(this.labels[c],this.outputs[c].serialize());return s}}function pd(i,n,s,c){const f=c-s,y=i-s;return f===0?0:n===1?y/f:(Math.pow(n,y)-1)/(Math.pow(n,f)-1)}var ws=oc;class Ra{constructor(n,s){this.type=n,this.args=s}static parse(n,s){if(n.length<2)return s.error("Expectected at least one argument.");let c=null;const f=s.expectedType;f&&f.kind!=="value"&&(c=f);const y=[];for(const E of n.slice(1)){const A=s.parse(E,1+y.length,c,void 0,{typeAnnotation:"omit"});if(!A)return null;c=c||A.type,y.push(A)}const w=f&&y.some((E=>Fo(f,E.type)));return new Ra(w?Rn:c,y)}evaluate(n){let s,c=null,f=0;for(const y of this.args){if(f++,c=y.evaluate(n),c&&c instanceof no&&!c.available&&(s||(s=c),c=null,f===this.args.length))return s;if(c!==null)break}return c}eachChild(n){this.args.forEach(n)}outputDefined(){return this.args.every((n=>n.outputDefined()))}serialize(){const n=["coalesce"];return this.eachChild((s=>{n.push(s.serialize())})),n}}var Hh=Ra;class pl{constructor(n,s){this.type=s.type,this.bindings=[].concat(n),this.result=s}evaluate(n){return this.result.evaluate(n)}eachChild(n){for(const s of this.bindings)n(s[1]);n(this.result)}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found ${n.length-1} instead.`);const c=[];for(let y=1;y<n.length-1;y+=2){const w=n[y];if(typeof w!="string")return s.error(`Expected string, but found ${typeof w} instead.`,y);if(/[^a-zA-Z0-9_]/.test(w))return s.error("Variable names must contain only alphanumeric characters or '_'.",y);const E=s.parse(n[y+1],y+1);if(!E)return null;c.push([w,E])}const f=s.parse(n[n.length-1],n.length-1,s.expectedType,c);return f?new pl(c,f):null}outputDefined(){return this.result.outputDefined()}serialize(){const n=["let"];for(const[s,c]of this.bindings)n.push(s,c.serialize());return n.push(this.result.serialize()),n}}var yp=pl;class md{constructor(n,s,c){this.type=n,this.index=s,this.input=c}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Ut),f=s.parse(n[2],2,js(s.expectedType||Rn));return c&&f?new md(f.type.itemType,c,f):null}evaluate(n){const s=this.index.evaluate(n),c=this.input.evaluate(n);if(s<0)throw new Xr(`Array index out of bounds: ${s} < 0.`);if(s>=c.length)throw new Xr(`Array index out of bounds: ${s} > ${c.length-1}.`);if(s!==Math.floor(s))throw new Xr(`Array index must be an integer, but found ${s} instead.`);return c[s]}eachChild(n){n(this.index),n(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}var Wh=md;class du{constructor(n,s){this.type=Bn,this.needle=n,this.haystack=s}static parse(n,s){if(n.length!==3)return s.error(`Expected 2 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Rn),f=s.parse(n[2],2,Rn);return c&&f?Yl(c.type,[Bn,Hn,Ut,ia,Rn])?new du(c,f):s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(c.type)} instead`):null}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(c==null)return!1;if(!Jl(s,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(Br(s))} instead.`);if(!Jl(c,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${Cr(Br(c))} instead.`);return c.indexOf(s)>=0}eachChild(n){n(this.needle),n(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}var hu=du;class ac{constructor(n,s,c){this.type=Ut,this.needle=n,this.haystack=s,this.fromIndex=c}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Rn),f=s.parse(n[2],2,Rn);if(!c||!f)return null;if(!Yl(c.type,[Bn,Hn,Ut,ia,Rn]))return s.error(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(c.type)} instead`);if(n.length===4){const y=s.parse(n[3],3,Ut);return y?new ac(c,f,y):null}return new ac(c,f)}evaluate(n){const s=this.needle.evaluate(n),c=this.haystack.evaluate(n);if(!Jl(s,["boolean","string","number","null"]))throw new Xr(`Expected first argument to be of type boolean, string, number or null, but found ${Cr(Br(s))} instead.`);if(!Jl(c,["string","array"]))throw new Xr(`Expected second argument to be of type array or string, but found ${Cr(Br(c))} instead.`);if(this.fromIndex){const f=this.fromIndex.evaluate(n);return c.indexOf(s,f)}return c.indexOf(s)}eachChild(n){n(this.needle),n(this.haystack),this.fromIndex&&n(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const n=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),n]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}var qh=ac;class Zh{constructor(n,s,c,f,y,w){this.inputType=n,this.type=s,this.input=c,this.cases=f,this.outputs=y,this.otherwise=w}static parse(n,s){if(n.length<5)return s.error(`Expected at least 4 arguments, but found only ${n.length-1}.`);if(n.length%2!=1)return s.error("Expected an even number of arguments.");let c,f;s.expectedType&&s.expectedType.kind!=="value"&&(f=s.expectedType);const y={},w=[];for(let I=2;I<n.length-1;I+=2){let j=n[I];const V=n[I+1];Array.isArray(j)||(j=[j]);const U=s.concat(I);if(j.length===0)return U.error("Expected at least one branch label.");for(const X of j){if(typeof X!="number"&&typeof X!="string")return U.error("Branch labels must be numbers or strings.");if(typeof X=="number"&&Math.abs(X)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof X=="number"&&Math.floor(X)!==X)return U.error("Numeric branch labels must be integer values.");if(c){if(U.checkSubtype(c,Br(X)))return null}else c=Br(X);if(y[String(X)]!==void 0)return U.error("Branch labels must be unique.");y[String(X)]=w.length}const q=s.parse(V,I,f);if(!q)return null;f=f||q.type,w.push(q)}const E=s.parse(n[1],1,Rn);if(!E)return null;const A=s.parse(n[n.length-1],n.length-1,f);return A?E.type.kind!=="value"&&s.concat(1).checkSubtype(c,E.type)?null:new Zh(c,f,E,y,w,A):null}evaluate(n){const s=this.input.evaluate(n);return(Br(s)===this.inputType&&this.outputs[this.cases[s]]||this.otherwise).evaluate(n)}eachChild(n){n(this.input),this.outputs.forEach(n),n(this.otherwise)}outputDefined(){return this.outputs.every((n=>n.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const n=["match",this.input.serialize()],s=Object.keys(this.cases).sort(),c=[],f={};for(const w of s){const E=f[this.cases[w]];E===void 0?(f[this.cases[w]]=c.length,c.push([this.cases[w],[w]])):c[E][1].push(w)}const y=w=>this.inputType.kind==="number"?Number(w):w;for(const[w,E]of c)n.push(E.length===1?y(E[0]):E.map(y)),n.push(this.outputs[w].serialize());return n.push(this.otherwise.serialize()),n}}var rg=Zh;class Xh{constructor(n,s,c){this.type=n,this.branches=s,this.otherwise=c}static parse(n,s){if(n.length<4)return s.error(`Expected at least 3 arguments, but found only ${n.length-1}.`);if(n.length%2!=0)return s.error("Expected an odd number of arguments.");let c;s.expectedType&&s.expectedType.kind!=="value"&&(c=s.expectedType);const f=[];for(let w=1;w<n.length-1;w+=2){const E=s.parse(n[w],w,Bn);if(!E)return null;const A=s.parse(n[w+1],w+1,c);if(!A)return null;f.push([E,A]),c=c||A.type}const y=s.parse(n[n.length-1],n.length-1,c);return y?new Xh(c,f,y):null}evaluate(n){for(const[s,c]of this.branches)if(s.evaluate(n))return c.evaluate(n);return this.otherwise.evaluate(n)}eachChild(n){for(const[s,c]of this.branches)n(s),n(c);n(this.otherwise)}outputDefined(){return this.branches.every((([n,s])=>s.outputDefined()))&&this.otherwise.outputDefined()}serialize(){const n=["case"];return this.eachChild((s=>{n.push(s.serialize())})),n}}var _p=Xh;class fu{constructor(n,s,c,f){this.type=n,this.input=s,this.beginIndex=c,this.endIndex=f}static parse(n,s){if(n.length<=2||n.length>=5)return s.error(`Expected 3 or 4 arguments, but found ${n.length-1} instead.`);const c=s.parse(n[1],1,Rn),f=s.parse(n[2],2,Ut);if(!c||!f)return null;if(!Yl(c.type,[js(Rn),Hn,Rn]))return s.error(`Expected first argument to be of type array or string, but found ${Cr(c.type)} instead`);if(n.length===4){const y=s.parse(n[3],3,Ut);return y?new fu(c.type,c,f,y):null}return new fu(c.type,c,f)}evaluate(n){const s=this.input.evaluate(n),c=this.beginIndex.evaluate(n);if(!Jl(s,["string","array"]))throw new Xr(`Expected first argument to be of type array or string, but found ${Cr(Br(s))} instead.`);if(this.endIndex){const f=this.endIndex.evaluate(n);return s.slice(c,f)}return s.slice(c)}eachChild(n){n(this.input),n(this.beginIndex),this.endIndex&&n(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const n=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),n]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}var so=fu;function Na(i,n){return i==="=="||i==="!="?n.kind==="boolean"||n.kind==="string"||n.kind==="number"||n.kind==="null"||n.kind==="value":n.kind==="string"||n.kind==="number"||n.kind==="value"}function Kh(i,n,s,c){return c.compare(n,s)===0}function ml(i,n,s){const c=i!=="=="&&i!=="!=";return class M3{constructor(y,w,E){this.type=Bn,this.lhs=y,this.rhs=w,this.collator=E,this.hasUntypedArgument=y.type.kind==="value"||w.type.kind==="value"}static parse(y,w){if(y.length!==3&&y.length!==4)return w.error("Expected two or three arguments.");const E=y[0];let A=w.parse(y[1],1,Rn);if(!A)return null;if(!Na(E,A.type))return w.concat(1).error(`"${E}" comparisons are not supported for type '${Cr(A.type)}'.`);let I=w.parse(y[2],2,Rn);if(!I)return null;if(!Na(E,I.type))return w.concat(2).error(`"${E}" comparisons are not supported for type '${Cr(I.type)}'.`);if(A.type.kind!==I.type.kind&&A.type.kind!=="value"&&I.type.kind!=="value")return w.error(`Cannot compare types '${Cr(A.type)}' and '${Cr(I.type)}'.`);c&&(A.type.kind==="value"&&I.type.kind!=="value"?A=new sa(I.type,[A]):A.type.kind!=="value"&&I.type.kind==="value"&&(I=new sa(A.type,[I])));let j=null;if(y.length===4){if(A.type.kind!=="string"&&I.type.kind!=="string"&&A.type.kind!=="value"&&I.type.kind!=="value")return w.error("Cannot use collator to compare non-string types.");if(j=w.parse(y[3],3,Ls),!j)return null}return new M3(A,I,j)}evaluate(y){const w=this.lhs.evaluate(y),E=this.rhs.evaluate(y);if(c&&this.hasUntypedArgument){const A=Br(w),I=Br(E);if(A.kind!==I.kind||A.kind!=="string"&&A.kind!=="number")throw new Xr(`Expected arguments for "${i}" to be (string, string) or (number, number), but found (${A.kind}, ${I.kind}) instead.`)}if(this.collator&&!c&&this.hasUntypedArgument){const A=Br(w),I=Br(E);if(A.kind!=="string"||I.kind!=="string")return n(y,w,E)}return this.collator?s(y,w,E,this.collator.evaluate(y)):n(y,w,E)}eachChild(y){y(this.lhs),y(this.rhs),this.collator&&y(this.collator)}outputDefined(){return!0}serialize(){const y=[i];return this.eachChild((w=>{y.push(w.serialize())})),y}}}const xp=ml("==",(function(i,n,s){return n===s}),Kh),vp=ml("!=",(function(i,n,s){return n!==s}),(function(i,n,s,c){return!Kh(0,n,s,c)})),Yh=ml("<",(function(i,n,s){return n<s}),(function(i,n,s,c){return c.compare(n,s)<0})),ig=ml(">",(function(i,n,s){return n>s}),(function(i,n,s,c){return c.compare(n,s)>0})),sg=ml("<=",(function(i,n,s){return n<=s}),(function(i,n,s,c){return c.compare(n,s)<=0})),gl=ml(">=",(function(i,n,s){return n>=s}),(function(i,n,s,c){return c.compare(n,s)>=0}));class lc{constructor(n,s,c,f,y,w){this.type=Hn,this.number=n,this.locale=s,this.currency=c,this.unit=f,this.minFractionDigits=y,this.maxFractionDigits=w}static parse(n,s){if(n.length!==3)return s.error("Expected two arguments.");const c=s.parse(n[1],1,Ut);if(!c)return null;const f=n[2];if(typeof f!="object"||Array.isArray(f))return s.error("NumberFormat options argument must be an object.");let y=null;if(f.locale&&(y=s.parse(f.locale,1,Hn),!y))return null;let w=null;if(f.currency&&(w=s.parse(f.currency,1,Hn),!w))return null;let E=null;if(f.unit&&(E=s.parse(f.unit,1,Hn),!E))return null;let A=null;if(f["min-fraction-digits"]&&(A=s.parse(f["min-fraction-digits"],1,Ut),!A))return null;let I=null;return f["max-fraction-digits"]&&(I=s.parse(f["max-fraction-digits"],1,Ut),!I)?null:new lc(c,y,w,E,A,I)}evaluate(n){return new Intl.NumberFormat(this.locale?this.locale.evaluate(n):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(n):void 0,unit:this.unit?this.unit.evaluate(n):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(n):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(n):void 0}).format(this.number.evaluate(n))}eachChild(n){n(this.number),this.locale&&n(this.locale),this.currency&&n(this.currency),this.unit&&n(this.unit),this.minFractionDigits&&n(this.minFractionDigits),this.maxFractionDigits&&n(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const n={};return this.locale&&(n.locale=this.locale.serialize()),this.currency&&(n.currency=this.currency.serialize()),this.unit&&(n.unit=this.unit.serialize()),this.minFractionDigits&&(n["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(n["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),n]}}class Ho{constructor(n){this.type=Ut,this.input=n}static parse(n,s){if(n.length!==2)return s.error(`Expected 1 argument, but found ${n.length-1} instead.`);const c=s.parse(n[1],1);return c?c.type.kind!=="array"&&c.type.kind!=="string"&&c.type.kind!=="value"?s.error(`Expected argument of type string or array, but found ${Cr(c.type)} instead.`):new Ho(c):null}evaluate(n){const s=this.input.evaluate(n);if(typeof s=="string"||Array.isArray(s))return s.length;throw new Xr(`Expected value to be of type string or array, but found ${Cr(Br(s))} instead.`)}eachChild(n){n(this.input)}outputDefined(){return!1}serialize(){const n=["length"];return this.eachChild((s=>{n.push(s.serialize())})),n}}const gd={"==":xp,"!=":vp,">":ig,"<":Yh,">=":gl,"<=":sg,array:sa,at:Wh,boolean:sa,case:_p,coalesce:Hh,collator:Ma,format:Uo,image:dl,in:hu,"index-of":qh,interpolate:ws,"interpolate-hcl":ws,"interpolate-lab":ws,length:Ho,let:yp,literal:wo,match:rg,number:sa,"number-format":lc,object:sa,slice:so,step:Oh,string:sa,"to-boolean":Os,"to-color":Os,"to-number":Os,"to-string":Os,var:pp,within:ld};function Jh(i,[n,s,c,f]){n=n.evaluate(i),s=s.evaluate(i),c=c.evaluate(i);const y=f?f.evaluate(i):1,w=Mh(n,s,c,y);if(w)throw new Xr(w);return new _r(n/255*y,s/255*y,c/255*y,y)}function oo(i,n){return i in n}function aa(i,n){const s=n[i];return s===void 0?null:s}function bs(i){return{type:i}}io.register(gd,{error:[{kind:"error"},[Hn],(i,[n])=>{throw new Xr(n.evaluate(i))}],typeof:[Hn,[Rn],(i,[n])=>Cr(Br(n.evaluate(i)))],"to-rgba":[js(Ut,4),[vs],(i,[n])=>n.evaluate(i).toArray()],rgb:[vs,[Ut,Ut,Ut],Jh],rgba:[vs,[Ut,Ut,Ut,Ut],Jh],has:{type:Bn,overloads:[[[Hn],(i,[n])=>oo(n.evaluate(i),i.properties())],[[Hn,Ds],(i,[n,s])=>oo(n.evaluate(i),s.evaluate(i))]]},get:{type:Rn,overloads:[[[Hn],(i,[n])=>aa(n.evaluate(i),i.properties())],[[Hn,Ds],(i,[n,s])=>aa(n.evaluate(i),s.evaluate(i))]]},"feature-state":[Rn,[Hn],(i,[n])=>aa(n.evaluate(i),i.featureState||{})],properties:[Ds,[],i=>i.properties()],"geometry-type":[Hn,[],i=>i.geometryType()],id:[Rn,[],i=>i.id()],zoom:[Ut,[],i=>i.globals.zoom],pitch:[Ut,[],i=>i.globals.pitch||0],"distance-from-center":[Ut,[],i=>i.distanceFromCenter()],"heatmap-density":[Ut,[],i=>i.globals.heatmapDensity||0],"line-progress":[Ut,[],i=>i.globals.lineProgress||0],"sky-radial-progress":[Ut,[],i=>i.globals.skyRadialProgress||0],accumulated:[Rn,[],i=>i.globals.accumulated===void 0?null:i.globals.accumulated],"+":[Ut,bs(Ut),(i,n)=>{let s=0;for(const c of n)s+=c.evaluate(i);return s}],"*":[Ut,bs(Ut),(i,n)=>{let s=1;for(const c of n)s*=c.evaluate(i);return s}],"-":{type:Ut,overloads:[[[Ut,Ut],(i,[n,s])=>n.evaluate(i)-s.evaluate(i)],[[Ut],(i,[n])=>-n.evaluate(i)]]},"/":[Ut,[Ut,Ut],(i,[n,s])=>n.evaluate(i)/s.evaluate(i)],"%":[Ut,[Ut,Ut],(i,[n,s])=>n.evaluate(i)%s.evaluate(i)],ln2:[Ut,[],()=>Math.LN2],pi:[Ut,[],()=>Math.PI],e:[Ut,[],()=>Math.E],"^":[Ut,[Ut,Ut],(i,[n,s])=>Math.pow(n.evaluate(i),s.evaluate(i))],sqrt:[Ut,[Ut],(i,[n])=>Math.sqrt(n.evaluate(i))],log10:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))/Math.LN10],ln:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))],log2:[Ut,[Ut],(i,[n])=>Math.log(n.evaluate(i))/Math.LN2],sin:[Ut,[Ut],(i,[n])=>Math.sin(n.evaluate(i))],cos:[Ut,[Ut],(i,[n])=>Math.cos(n.evaluate(i))],tan:[Ut,[Ut],(i,[n])=>Math.tan(n.evaluate(i))],asin:[Ut,[Ut],(i,[n])=>Math.asin(n.evaluate(i))],acos:[Ut,[Ut],(i,[n])=>Math.acos(n.evaluate(i))],atan:[Ut,[Ut],(i,[n])=>Math.atan(n.evaluate(i))],min:[Ut,bs(Ut),(i,n)=>Math.min(...n.map((s=>s.evaluate(i))))],max:[Ut,bs(Ut),(i,n)=>Math.max(...n.map((s=>s.evaluate(i))))],abs:[Ut,[Ut],(i,[n])=>Math.abs(n.evaluate(i))],round:[Ut,[Ut],(i,[n])=>{const s=n.evaluate(i);return s<0?-Math.round(-s):Math.round(s)}],floor:[Ut,[Ut],(i,[n])=>Math.floor(n.evaluate(i))],ceil:[Ut,[Ut],(i,[n])=>Math.ceil(n.evaluate(i))],"filter-==":[Bn,[Hn,Rn],(i,[n,s])=>i.properties()[n.value]===s.value],"filter-id-==":[Bn,[Rn],(i,[n])=>i.id()===n.value],"filter-type-==":[Bn,[Hn],(i,[n])=>i.geometryType()===n.value],"filter-<":[Bn,[Hn,Rn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c<f}],"filter-id-<":[Bn,[Rn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s<c}],"filter->":[Bn,[Hn,Rn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c>f}],"filter-id->":[Bn,[Rn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s>c}],"filter-<=":[Bn,[Hn,Rn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c<=f}],"filter-id-<=":[Bn,[Rn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s<=c}],"filter->=":[Bn,[Hn,Rn],(i,[n,s])=>{const c=i.properties()[n.value],f=s.value;return typeof c==typeof f&&c>=f}],"filter-id->=":[Bn,[Rn],(i,[n])=>{const s=i.id(),c=n.value;return typeof s==typeof c&&s>=c}],"filter-has":[Bn,[Rn],(i,[n])=>n.value in i.properties()],"filter-has-id":[Bn,[],i=>i.id()!==null&&i.id()!==void 0],"filter-type-in":[Bn,[js(Hn)],(i,[n])=>n.value.indexOf(i.geometryType())>=0],"filter-id-in":[Bn,[js(Rn)],(i,[n])=>n.value.indexOf(i.id())>=0],"filter-in-small":[Bn,[Hn,js(Rn)],(i,[n,s])=>s.value.indexOf(i.properties()[n.value])>=0],"filter-in-large":[Bn,[Hn,js(Rn)],(i,[n,s])=>(function(c,f,y,w){for(;y<=w;){const E=y+w>>1;if(f[E]===c)return!0;f[E]>c?w=E-1:y=E+1}return!1})(i.properties()[n.value],s.value,0,s.value.length-1)],all:{type:Bn,overloads:[[[Bn,Bn],(i,[n,s])=>n.evaluate(i)&&s.evaluate(i)],[bs(Bn),(i,n)=>{for(const s of n)if(!s.evaluate(i))return!1;return!0}]]},any:{type:Bn,overloads:[[[Bn,Bn],(i,[n,s])=>n.evaluate(i)||s.evaluate(i)],[bs(Bn),(i,n)=>{for(const s of n)if(s.evaluate(i))return!0;return!1}]]},"!":[Bn,[Bn],(i,[n])=>!n.evaluate(i)],"is-supported-script":[Bn,[Hn],(i,[n])=>{const s=i.globals&&i.globals.isSupportedScript;return!s||s(n.evaluate(i))}],upcase:[Hn,[Hn],(i,[n])=>n.evaluate(i).toUpperCase()],downcase:[Hn,[Hn],(i,[n])=>n.evaluate(i).toLowerCase()],concat:[Hn,bs(Rn),(i,n)=>n.map((s=>nu(s.evaluate(i)))).join("")],"resolved-locale":[Hn,[Ls],(i,[n])=>n.evaluate(i).resolvedLocale()]});var cc=gd;function pu(i){return{result:"success",value:i}}function Da(i){return{result:"error",value:i}}function yl(i){return i["property-type"]==="data-driven"}function mu(i){return!!i.expression&&i.expression.parameters.indexOf("zoom")>-1}function gu(i){return!!i.expression&&i.expression.interpolated}function Jn(i){return i instanceof Number?"number":i instanceof String?"string":i instanceof Boolean?"boolean":Array.isArray(i)?"array":i===null?"null":typeof i}function uc(i){return typeof i=="object"&&i!==null&&!Array.isArray(i)}function la(i){return i}function dc(i,n){const s=n.type==="color",c=i.stops&&typeof i.stops[0][0]=="object",f=c||!(c||i.property!==void 0),y=i.type||(gu(n)?"exponential":"interval");if(s&&((i=bi({},i)).stops&&(i.stops=i.stops.map((I=>[I[0],_r.parse(I[1])]))),i.default=_r.parse(i.default?i.default:n.default)),i.colorSpace&&i.colorSpace!=="rgb"&&!Gh[i.colorSpace])throw new Error(`Unknown color space: ${i.colorSpace}`);let w,E,A;if(y==="exponential")w=zs;else if(y==="interval")w=yd;else if(y==="categorical"){w=wp,E=Object.create(null);for(const I of i.stops)E[I[0]]=I[1];A=typeof i.stops[0][0]}else{if(y!=="identity")throw new Error(`Unknown function type "${y}"`);w=bp}if(c){const I={},j=[];for(let q=0;q<i.stops.length;q++){const X=i.stops[q],te=X[0].zoom;I[te]===void 0&&(I[te]={zoom:te,type:i.type,property:i.property,default:i.default,stops:[]},j.push(te)),I[te].stops.push([X[0].value,X[1]])}const V=[];for(const q of j)V.push([I[q].zoom,dc(I[q],n)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:ws.interpolationFactor.bind(void 0,U),zoomStops:V.map((q=>q[0])),evaluate:({zoom:q},X)=>zs({stops:V,base:i.base},n,q).evaluate(q,X)}}if(f){const I=y==="exponential"?{name:"exponential",base:i.base!==void 0?i.base:1}:null;return{kind:"camera",interpolationType:I,interpolationFactor:ws.interpolationFactor.bind(void 0,I),zoomStops:i.stops.map((j=>j[0])),evaluate:({zoom:j})=>w(i,n,j,E,A)}}return{kind:"source",evaluate(I,j){const V=j&&j.properties?j.properties[i.property]:void 0;return V===void 0?La(i.default,n.default):w(i,n,V,E,A)}}}function La(i,n,s){return i!==void 0?i:n!==void 0?n:s!==void 0?s:void 0}function wp(i,n,s,c,f){return La(typeof s===f?c[s]:void 0,i.default,n.default)}function yd(i,n,s){if(Jn(s)!=="number")return La(i.default,n.default);const c=i.stops.length;if(c===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[c-1][0])return i.stops[c-1][1];const f=ud(i.stops.map((y=>y[0])),s);return i.stops[f][1]}function zs(i,n,s){const c=i.base!==void 0?i.base:1;if(Jn(s)!=="number")return La(i.default,n.default);const f=i.stops.length;if(f===1||s<=i.stops[0][0])return i.stops[0][1];if(s>=i.stops[f-1][0])return i.stops[f-1][1];const y=ud(i.stops.map((j=>j[0])),s),w=(function(j,V,U,q){const X=q-U,te=j-U;return X===0?0:V===1?te/X:(Math.pow(V,te)-1)/(Math.pow(V,X)-1)})(s,c,i.stops[y][0],i.stops[y+1][0]),E=i.stops[y][1],A=i.stops[y+1][1];let I=au[n.type]||la;if(i.colorSpace&&i.colorSpace!=="rgb"){const j=Gh[i.colorSpace];I=(V,U)=>j.reverse(j.interpolate(j.forward(V),j.forward(U),w))}return typeof E.evaluate=="function"?{evaluate(...j){const V=E.evaluate.apply(void 0,j),U=A.evaluate.apply(void 0,j);if(V!==void 0&&U!==void 0)return I(V,U,w)}}:I(E,A,w)}function bp(i,n,s){return n.type==="color"?s=_r.parse(s):n.type==="formatted"?s=Pi.fromString(s.toString()):n.type==="resolvedImage"?s=no.fromString(s.toString()):Jn(s)===n.type||n.type==="enum"&&n.values[s]||(s=void 0),La(s,i.default,n.default)}class yu{constructor(n,s){this.expression=n,this._warningHistory={},this._evaluator=new ec,this._defaultValue=s?(function(c){return c.type==="color"&&(uc(c.default)||Array.isArray(c.default))?new _r(0,0,0,0):c.type==="color"?_r.parse(c.default)||null:c.default===void 0?null:c.default})(s):null,this._enumValues=s&&s.type==="enum"?s.values:null}evaluateWithoutErrorHandling(n,s,c,f,y,w,E,A){return this._evaluator.globals=n,this._evaluator.feature=s,this._evaluator.featureState=c,this._evaluator.canonical=f||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=w,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=A||null,this.expression.evaluate(this._evaluator)}evaluate(n,s,c,f,y,w,E,A){this._evaluator.globals=n,this._evaluator.feature=s||null,this._evaluator.featureState=c||null,this._evaluator.canonical=f||null,this._evaluator.availableImages=y||null,this._evaluator.formattedSection=w||null,this._evaluator.featureTileCoord=E||null,this._evaluator.featureDistanceData=A||null;try{const I=this.expression.evaluate(this._evaluator);if(I==null||typeof I=="number"&&I!=I)return this._defaultValue;if(this._enumValues&&!(I in this._enumValues))throw new Xr(`Expected value to be one of ${Object.keys(this._enumValues).map((j=>JSON.stringify(j))).join(", ")}, but found ${JSON.stringify(I)} instead.`);return I}catch(I){return this._warningHistory[I.message]||(this._warningHistory[I.message]=!0,typeof console<"u"&&console.warn(I.message)),this._defaultValue}}}function _l(i){return Array.isArray(i)&&i.length>0&&typeof i[0]=="string"&&i[0]in cc}function gr(i,n){const s=new jh(cc,[],n?(function(f){const y={color:vs,string:Hn,number:Ut,enum:Hn,boolean:Bn,formatted:cl,resolvedImage:rr};return f.type==="array"?js(y[f.value]||Rn,f.length):y[f.type]})(n):void 0),c=s.parse(i,void 0,void 0,void 0,n&&n.type==="string"?{typeAnnotation:"coerce"}:void 0);return c?pu(new yu(c,n)):Da(s.errors)}class _u{constructor(n,s){this.kind=n,this._styleExpression=s,this.isStateDependent=n!=="constant"&&!oa(s.expression)}evaluateWithoutErrorHandling(n,s,c,f,y,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,f,y,w)}evaluate(n,s,c,f,y,w){return this._styleExpression.evaluate(n,s,c,f,y,w)}}class ja{constructor(n,s,c,f){this.kind=n,this.zoomStops=c,this._styleExpression=s,this.isStateDependent=n!=="camera"&&!oa(s.expression),this.interpolationType=f}evaluateWithoutErrorHandling(n,s,c,f,y,w){return this._styleExpression.evaluateWithoutErrorHandling(n,s,c,f,y,w)}evaluate(n,s,c,f,y,w){return this._styleExpression.evaluate(n,s,c,f,y,w)}interpolationFactor(n,s,c){return this.interpolationType?ws.interpolationFactor(this.interpolationType,n,s,c):0}}function ca(i,n){if((i=gr(i,n)).result==="error")return i;const s=i.value.expression,c=rc(s);if(!c&&!yl(n))return Da([new Ns("","data expressions not supported")]);const f=Pa(s,["zoom","pitch","distance-from-center"]);if(!f&&!mu(n))return Da([new Ns("","zoom expressions not supported")]);const y=hc(s);return y||f?y instanceof Ns?Da([y]):y instanceof ws&&!gu(n)?Da([new Ns("",'"interpolate" expressions cannot be used with this property')]):pu(y?new ja(c?"camera":"composite",i.value,y.labels,y instanceof ws?y.interpolation:void 0):new _u(c?"constant":"source",i.value)):Da([new Ns("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.')])}class xu{constructor(n,s){this._parameters=n,this._specification=s,bi(this,dc(this._parameters,this._specification))}static deserialize(n){return new xu(n._parameters,n._specification)}static serialize(n){return{_parameters:n._parameters,_specification:n._specification}}}function hc(i){let n=null;if(i instanceof yp)n=hc(i.result);else if(i instanceof Hh){for(const s of i.args)if(n=hc(s),n)break}else(i instanceof Oh||i instanceof ws)&&i.input instanceof io&&i.input.name==="zoom"&&(n=i);return n instanceof Ns||i.eachChild((s=>{const c=hc(s);c instanceof Ns?n=c:!n&&c?n=new Ns("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression.'):n&&c&&n!==c&&(n=new Ns("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))})),n}class zt{constructor(n,s,c,f){this.message=(n?`${n}: `:"")+c,f&&(this.identifier=f),s!=null&&s.__line__&&(this.line=s.__line__)}}function Ts(i){const n=i.key,s=i.value,c=i.valueSpec||{},f=i.objectElementValidators||{},y=i.style,w=i.styleSpec;let E=[];const A=Jn(s);if(A!=="object")return[new zt(n,s,`object expected, ${A} found`)];for(const I in s){const j=I.split(".")[0];let V;f[j]?V=f[j]:c[j]?V=Wn:f["*"]?V=f["*"]:c["*"]&&(V=Wn),V?E=E.concat(V({key:(n&&`${n}.`)+I,value:s[I],valueSpec:c[j]||c["*"],style:y,styleSpec:w,object:s,objectKey:I},s)):E.push(new zt(n,s[I],`unknown property "${I}"`))}for(const I in c)f[I]||c[I].required&&c[I].default===void 0&&s[I]===void 0&&E.push(new zt(n,s,`missing required property "${I}"`));return E}function xl(i){const n=i.value,s=i.valueSpec,c=i.style,f=i.styleSpec,y=i.key,w=i.arrayElementValidator||Wn;if(Jn(n)!=="array")return[new zt(y,n,`array expected, ${Jn(n)} found`)];if(s.length&&n.length!==s.length)return[new zt(y,n,`array length ${s.length} expected, length ${n.length} found`)];if(s["min-length"]&&n.length<s["min-length"])return[new zt(y,n,`array length at least ${s["min-length"]} expected, length ${n.length} found`)];let E={type:s.value,values:s.values,minimum:s.minimum,maximum:s.maximum,function:void 0};f.$version<7&&(E.function=s.function),Jn(s.value)==="object"&&(E=s.value);let A=[];for(let I=0;I<n.length;I++)A=A.concat(w({array:n,arrayIndex:I,value:n[I],valueSpec:E,style:c,styleSpec:f,key:`${y}[${I}]`}));return A}function fc(i){const n=i.key,s=i.value,c=i.valueSpec;let f=Jn(s);if(f==="number"&&s!=s&&(f="NaN"),f!=="number")return[new zt(n,s,`number expected, ${f} found`)];if("minimum"in c){let y=c.minimum;if(Jn(c.minimum)==="array"&&(y=c.minimum[i.arrayIndex]),s<y)return[new zt(n,s,`${s} is less than the minimum value ${y}`)]}if("maximum"in c){let y=c.maximum;if(Jn(c.maximum)==="array"&&(y=c.maximum[i.arrayIndex]),s>y)return[new zt(n,s,`${s} is greater than the maximum value ${y}`)]}return[]}function vu(i){const n=i.valueSpec,s=si(i.value.type);let c,f,y,w={};const E=s!=="categorical"&&i.value.property===void 0,A=!E,I=Jn(i.value.stops)==="array"&&Jn(i.value.stops[0])==="array"&&Jn(i.value.stops[0][0])==="object",j=Ts({key:i.key,value:i.value,valueSpec:i.styleSpec.function,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{stops:function(q){if(s==="identity")return[new zt(q.key,q.value,'identity function may not have a "stops" property')];let X=[];const te=q.value;return X=X.concat(xl({key:q.key,value:te,valueSpec:q.valueSpec,style:q.style,styleSpec:q.styleSpec,arrayElementValidator:V})),Jn(te)==="array"&&te.length===0&&X.push(new zt(q.key,te,"array must have at least one stop")),X},default:function(q){return Wn({key:q.key,value:q.value,valueSpec:n,style:q.style,styleSpec:q.styleSpec})}}});return s==="identity"&&E&&j.push(new zt(i.key,i.value,'missing required property "property"')),s==="identity"||i.value.stops||j.push(new zt(i.key,i.value,'missing required property "stops"')),s==="exponential"&&i.valueSpec.expression&&!gu(i.valueSpec)&&j.push(new zt(i.key,i.value,"exponential functions not supported")),i.styleSpec.$version>=8&&(A&&!yl(i.valueSpec)?j.push(new zt(i.key,i.value,"property functions not supported")):E&&!mu(i.valueSpec)&&j.push(new zt(i.key,i.value,"zoom functions not supported"))),s!=="categorical"&&!I||i.value.property!==void 0||j.push(new zt(i.key,i.value,'"property" property is required')),j;function V(q){let X=[];const te=q.value,ae=q.key;if(Jn(te)!=="array")return[new zt(ae,te,`array expected, ${Jn(te)} found`)];if(te.length!==2)return[new zt(ae,te,`array length 2 expected, length ${te.length} found`)];if(I){if(Jn(te[0])!=="object")return[new zt(ae,te,`object expected, ${Jn(te[0])} found`)];if(te[0].zoom===void 0)return[new zt(ae,te,"object stop key must have zoom")];if(te[0].value===void 0)return[new zt(ae,te,"object stop key must have value")];const ge=si(te[0].zoom);if(typeof ge!="number")return[new zt(ae,te[0].zoom,"stop zoom values must be numbers")];if(y&&y>ge)return[new zt(ae,te[0].zoom,"stop zoom values must appear in ascending order")];ge!==y&&(y=ge,f=void 0,w={}),X=X.concat(Ts({key:`${ae}[0]`,value:te[0],valueSpec:{zoom:{}},style:q.style,styleSpec:q.styleSpec,objectElementValidators:{zoom:fc,value:U}}))}else X=X.concat(U({key:`${ae}[0]`,value:te[0],style:q.style,styleSpec:q.styleSpec},te));return _l(Ii(te[1]))?X.concat([new zt(`${ae}[1]`,te[1],"expressions are not allowed in function stops.")]):X.concat(Wn({key:`${ae}[1]`,value:te[1],valueSpec:n,style:q.style,styleSpec:q.styleSpec}))}function U(q,X){const te=Jn(q.value),ae=si(q.value),ge=q.value!==null?q.value:X;if(c){if(te!==c)return[new zt(q.key,ge,`${te} stop domain type must match previous stop domain type ${c}`)]}else c=te;if(te!=="number"&&te!=="string"&&te!=="boolean"&&typeof ae!="number"&&typeof ae!="string"&&typeof ae!="boolean")return[new zt(q.key,ge,"stop domain value must be a number, string, or boolean")];if(te!=="number"&&s!=="categorical"){let Ce=`number expected, ${te} found`;return yl(n)&&s===void 0&&(Ce+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new zt(q.key,ge,Ce)]}return s!=="categorical"||te!=="number"||typeof ae=="number"&&isFinite(ae)&&Math.floor(ae)===ae?s!=="categorical"&&te==="number"&&typeof ae=="number"&&typeof f=="number"&&f!==void 0&&ae<f?[new zt(q.key,ge,"stop domain values must appear in ascending order")]:(f=ae,s==="categorical"&&ae in w?[new zt(q.key,ge,"stop domain values must be unique")]:(w[ae]=!0,[])):[new zt(q.key,ge,`integer expected, found ${String(ae)}`)]}}function Ri(i){const n=(i.expressionContext==="property"?ca:gr)(Ii(i.value),i.valueSpec);if(n.result==="error")return n.value.map((c=>new zt(`${i.key}${c.key}`,i.value,c.message)));const s=n.value.expression||n.value._styleExpression.expression;if(i.expressionContext==="property"&&i.propertyKey==="text-font"&&!s.outputDefined())return[new zt(i.key,i.value,`Invalid data expression for "${i.propertyKey}". Output values must be contained as literals within the expression.`)];if(i.expressionContext==="property"&&i.propertyType==="layout"&&!oa(s))return[new zt(i.key,i.value,'"feature-state" data expressions are not supported with layout properties.')];if(i.expressionContext==="filter")return pc(s,i);if(i.expressionContext&&i.expressionContext.indexOf("cluster")===0){if(!Pa(s,["zoom","feature-state"]))return[new zt(i.key,i.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(i.expressionContext==="cluster-initial"&&!rc(s))return[new zt(i.key,i.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function pc(i,n){const s=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(n.valueSpec&&n.valueSpec.expression)for(const f of n.valueSpec.expression.parameters)s.delete(f);if(s.size===0)return[];const c=[];return i instanceof io&&s.has(i.name)?[new zt(n.key,n.value,`["${i.name}"] expression is not supported in a filter for a ${n.object.type} layer with id: ${n.object.id}`)]:(i.eachChild((f=>{c.push(...pc(f,n))})),c)}function vl(i){const n=i.key,s=i.value,c=i.valueSpec,f=[];return Array.isArray(c.values)?c.values.indexOf(si(s))===-1&&f.push(new zt(n,s,`expected one of [${c.values.join(", ")}], ${JSON.stringify(s)} found`)):Object.keys(c.values).indexOf(si(s))===-1&&f.push(new zt(n,s,`expected one of [${Object.keys(c.values).join(", ")}], ${JSON.stringify(s)} found`)),f}function mc(i){if(i===!0||i===!1)return!0;if(!Array.isArray(i)||i.length===0)return!1;switch(i[0]){case"has":return i.length>=2&&i[1]!=="$id"&&i[1]!=="$type";case"in":return i.length>=3&&(typeof i[1]!="string"||Array.isArray(i[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return i.length!==3||Array.isArray(i[1])||Array.isArray(i[2]);case"any":case"all":for(const n of i.slice(1))if(!mc(n)&&typeof n!="boolean")return!1;return!0;default:return!0}}function gc(i,n="fill"){if(i==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};mc(i)||(i=_c(i));const s=i;let c=!0;try{c=(function(I){if(!Oa(I))return I;let j=Ii(I);return yc(j),j=_d(j),j})(s)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(s,null,2)}
        `)}const f=dt[`filter_${n}`],y=gr(c,f);let w=null;if(y.result==="error")throw new Error(y.value.map((I=>`${I.key}: ${I.message}`)).join(", "));w=(I,j,V)=>y.value.evaluate(I,j,{},V);let E=null,A=null;if(c!==s){const I=gr(s,f);if(I.result==="error")throw new Error(I.value.map((j=>`${j.key}: ${j.message}`)).join(", "));E=(j,V,U,q,X)=>I.value.evaluate(j,V,{},U,void 0,void 0,q,X),A=!rc(I.value.expression)}return{filter:w,dynamicFilter:E||void 0,needGeometry:Sp(c),needFeature:!!A}}function _d(i){if(!Array.isArray(i))return i;const n=(function(s){if(Qh.has(s[0])){for(let c=1;c<s.length;c++)if(Oa(s[c]))return!0}return s})(i);return n===!0?n:n.map((s=>_d(s)))}function yc(i){let n=!1;const s=[];if(i[0]==="case"){for(let c=1;c<i.length-1;c+=2)n=n||Oa(i[c]),s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="match"){n=n||Oa(i[1]);for(let c=2;c<i.length-1;c+=2)s.push(i[c+1]);s.push(i[i.length-1])}else if(i[0]==="step"){n=n||Oa(i[1]);for(let c=1;c<i.length-1;c+=2)s.push(i[c+1])}n&&(i.length=0,i.push("any",...s));for(let c=1;c<i.length;c++)yc(i[c])}function Oa(i){if(!Array.isArray(i))return!1;if((n=i[0])==="pitch"||n==="distance-from-center")return!0;var n;for(let s=1;s<i.length;s++)if(Oa(i[s]))return!0;return!1}const Qh=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Tp(i,n){return i<n?-1:i>n?1:0}function Sp(i){if(!Array.isArray(i))return!1;if(i[0]==="within")return!0;for(let n=1;n<i.length;n++)if(Sp(i[n]))return!0;return!1}function _c(i){if(!i)return!0;const n=i[0];return i.length<=1?n!=="any":n==="=="?wu(i[1],i[2],"=="):n==="!="?ua(wu(i[1],i[2],"==")):n==="<"||n===">"||n==="<="||n===">="?wu(i[1],i[2],n):n==="any"?(s=i.slice(1),["any"].concat(s.map(_c))):n==="all"?["all"].concat(i.slice(1).map(_c)):n==="none"?["all"].concat(i.slice(1).map(_c).map(ua)):n==="in"?Wo(i[1],i.slice(2)):n==="!in"?ua(Wo(i[1],i.slice(2))):n==="has"?xd(i[1]):n==="!has"?ua(xd(i[1])):n!=="within"||i;var s}function wu(i,n,s){switch(i){case"$type":return[`filter-type-${s}`,n];case"$id":return[`filter-id-${s}`,n];default:return[`filter-${s}`,i,n]}}function Wo(i,n){if(n.length===0)return!1;switch(i){case"$type":return["filter-type-in",["literal",n]];case"$id":return["filter-id-in",["literal",n]];default:return n.length>200&&!n.some((s=>typeof s!=typeof n[0]))?["filter-in-large",i,["literal",n.sort(Tp)]]:["filter-in-small",i,["literal",n]]}}function xd(i){switch(i){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",i]}}function ua(i){return["!",i]}function Ss(i){return mc(Ii(i.value))?Ri(bi({},i,{expressionContext:"filter",valueSpec:i.styleSpec[`filter_${i.layerType||"fill"}`]})):da(i)}function da(i){const n=i.value,s=i.key;if(Jn(n)!=="array")return[new zt(s,n,`array expected, ${Jn(n)} found`)];const c=i.styleSpec;let f,y=[];if(n.length<1)return[new zt(s,n,"filter array must have at least 1 element")];switch(y=y.concat(vl({key:`${s}[0]`,value:n[0],valueSpec:c.filter_operator,style:i.style,styleSpec:i.styleSpec})),si(n[0])){case"<":case"<=":case">":case">=":n.length>=2&&si(n[1])==="$type"&&y.push(new zt(s,n,`"$type" cannot be use with operator "${n[0]}"`));case"==":case"!=":n.length!==3&&y.push(new zt(s,n,`filter array for operator "${n[0]}" must have 3 elements`));case"in":case"!in":n.length>=2&&(f=Jn(n[1]),f!=="string"&&y.push(new zt(`${s}[1]`,n[1],`string expected, ${f} found`)));for(let w=2;w<n.length;w++)f=Jn(n[w]),si(n[1])==="$type"?y=y.concat(vl({key:`${s}[${w}]`,value:n[w],valueSpec:c.geometry_type,style:i.style,styleSpec:i.styleSpec})):f!=="string"&&f!=="number"&&f!=="boolean"&&y.push(new zt(`${s}[${w}]`,n[w],`string, number, or boolean expected, ${f} found`));break;case"any":case"all":case"none":for(let w=1;w<n.length;w++)y=y.concat(da({key:`${s}[${w}]`,value:n[w],style:i.style,styleSpec:i.styleSpec}));break;case"has":case"!has":f=Jn(n[1]),n.length!==2?y.push(new zt(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="string"&&y.push(new zt(`${s}[1]`,n[1],`string expected, ${f} found`));break;case"within":f=Jn(n[1]),n.length!==2?y.push(new zt(s,n,`filter array for "${n[0]}" operator must have 2 elements`)):f!=="object"&&y.push(new zt(`${s}[1]`,n[1],`object expected, ${f} found`))}return y}function To(i,n){const s=i.key,c=i.style,f=i.styleSpec,y=i.value,w=i.objectKey,E=f[`${n}_${i.layerType}`];if(!E)return[];const A=w.match(/^(.*)-transition$/);if(n==="paint"&&A&&E[A[1]]&&E[A[1]].transition)return Wn({key:s,value:y,valueSpec:f.transition,style:c,styleSpec:f});const I=i.valueSpec||E[w];if(!I)return[new zt(s,y,`unknown property "${w}"`)];let j;if(Jn(y)==="string"&&yl(I)&&!I.tokens&&(j=/^{([^}]+)}$/.exec(y))){const U=`\`{ "type": "identity", "property": ${j?JSON.stringify(j[1]):'"_"'} }\``;return[new zt(s,y,`"${w}" does not support interpolation syntax
Use an identity property function instead: ${U}.`)]}const V=[];return i.layerType==="symbol"&&(w==="text-field"&&c&&!c.glyphs&&V.push(new zt(s,y,'use of "text-field" requires a style "glyphs" property')),w==="text-font"&&uc(Ii(y))&&si(y.type)==="identity"&&V.push(new zt(s,y,'"text-font" does not support identity functions'))),V.concat(Wn({key:i.key,value:y,valueSpec:I,style:c,styleSpec:f,expressionContext:"property",propertyType:n,propertyKey:w}))}function vd(i){return To(i,"paint")}function ef(i){return To(i,"layout")}function Ep(i){let n=[];const s=i.value,c=i.key,f=i.style,y=i.styleSpec;s.type||s.ref||n.push(new zt(c,s,'either "type" or "ref" is required'));let w=si(s.type);const E=si(s.ref);if(s.id){const A=si(s.id);for(let I=0;I<i.arrayIndex;I++){const j=f.layers[I];si(j.id)===A&&n.push(new zt(c,s.id,`duplicate layer id "${s.id}", previously used at line ${j.id.__line__}`))}}if("ref"in s){let A;["type","source","source-layer","filter","layout"].forEach((I=>{I in s&&n.push(new zt(c,s[I],`"${I}" is prohibited for ref layers`))})),f.layers.forEach((I=>{si(I.id)===E&&(A=I)})),A?A.ref?n.push(new zt(c,s.ref,"ref cannot reference another ref layer")):w=si(A.type):typeof E=="string"&&n.push(new zt(c,s.ref,`ref layer "${E}" not found`))}else if(w!=="background"&&w!=="sky")if(s.source){const A=f.sources&&f.sources[s.source],I=A&&si(A.type);A?I==="vector"&&w==="raster"?n.push(new zt(c,s.source,`layer "${s.id}" requires a raster source`)):I==="raster"&&w!=="raster"?n.push(new zt(c,s.source,`layer "${s.id}" requires a vector source`)):I!=="vector"||s["source-layer"]?I==="raster-dem"&&w!=="hillshade"?n.push(new zt(c,s.source,"raster-dem source can only be used with layer type 'hillshade'.")):w!=="line"||!s.paint||!s.paint["line-gradient"]&&!s.paint["line-trim-offset"]||I==="geojson"&&A.lineMetrics||n.push(new zt(c,s,`layer "${s.id}" specifies a line-gradient, which requires a GeoJSON source with \`lineMetrics\` enabled.`)):n.push(new zt(c,s,`layer "${s.id}" must specify a "source-layer"`)):n.push(new zt(c,s.source,`source "${s.source}" not found`))}else n.push(new zt(c,s,'missing required property "source"'));return n=n.concat(Ts({key:c,value:s,valueSpec:y.layer,style:i.style,styleSpec:i.styleSpec,objectElementValidators:{"*":()=>[],type:()=>Wn({key:`${c}.type`,value:s.type,valueSpec:y.layer.type,style:i.style,styleSpec:i.styleSpec,object:s,objectKey:"type"}),filter:A=>Ss(bi({layerType:w},A)),layout:A=>Ts({layer:s,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":I=>ef(bi({layerType:w},I))}}),paint:A=>Ts({layer:s,key:A.key,value:A.value,valueSpec:{},style:A.style,styleSpec:A.styleSpec,objectElementValidators:{"*":I=>vd(bi({layerType:w},I))}})}})),n}function Es(i){const n=i.value,s=i.key,c=Jn(n);return c!=="string"?[new zt(s,n,`string expected, ${c} found`)]:[]}const xc={promoteId:function({key:i,value:n}){if(Jn(n)==="string")return Es({key:i,value:n});{const s=[];for(const c in n)s.push(...Es({key:`${i}.${c}`,value:n[c]}));return s}}};function wl(i){const n=i.value,s=i.key,c=i.styleSpec,f=i.style;if(!n.type)return[new zt(s,n,'"type" is required')];const y=si(n.type);let w;switch(y){case"vector":case"raster":case"raster-dem":return w=Ts({key:s,value:n,valueSpec:c[`source_${y.replace("-","_")}`],style:i.style,styleSpec:c,objectElementValidators:xc}),w;case"geojson":if(w=Ts({key:s,value:n,valueSpec:c.source_geojson,style:f,styleSpec:c,objectElementValidators:xc}),n.cluster)for(const E in n.clusterProperties){const[A,I]=n.clusterProperties[E],j=typeof A=="string"?[A,["accumulated"],["get",E]]:A;w.push(...Ri({key:`${s}.${E}.map`,value:I,expressionContext:"cluster-map"})),w.push(...Ri({key:`${s}.${E}.reduce`,value:j,expressionContext:"cluster-reduce"}))}return w;case"video":return Ts({key:s,value:n,valueSpec:c.source_video,style:f,styleSpec:c});case"image":return Ts({key:s,value:n,valueSpec:c.source_image,style:f,styleSpec:c});case"canvas":return[new zt(s,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return vl({key:`${s}.type`,value:n.type,valueSpec:{values:wd(c)}})}}function wd(i){return i.source.reduce(((n,s)=>{const c=i[s];return c.type.type==="enum"&&(n=n.concat(Object.keys(c.type.values))),n}),[])}function bd(i){const n=i.value,s=i.styleSpec,c=s.light,f=i.style;let y=[];const w=Jn(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new zt("light",n,`object expected, ${w} found`)]),y;for(const E in n){const A=E.match(/^(.*)-transition$/);y=y.concat(A&&c[A[1]]&&c[A[1]].transition?Wn({key:E,value:n[E],valueSpec:s.transition,style:f,styleSpec:s}):c[E]?Wn({key:E,value:n[E],valueSpec:c[E],style:f,styleSpec:s}):[new zt(E,n[E],`unknown property "${E}"`)])}return y}function za(i){const n=i.value,s=i.key,c=i.style,f=i.styleSpec,y=f.terrain;let w=[];const E=Jn(n);if(n===void 0)return w;if(E!=="object")return w=w.concat([new zt("terrain",n,`object expected, ${E} found`)]),w;for(const A in n){const I=A.match(/^(.*)-transition$/);w=w.concat(I&&y[I[1]]&&y[I[1]].transition?Wn({key:A,value:n[A],valueSpec:f.transition,style:c,styleSpec:f}):y[A]?Wn({key:A,value:n[A],valueSpec:y[A],style:c,styleSpec:f}):[new zt(A,n[A],`unknown property "${A}"`)])}if(n.source){const A=c.sources&&c.sources[n.source],I=A&&si(A.type);A?I!=="raster-dem"&&w.push(new zt(s,n.source,`terrain cannot be used with a source of type ${String(I)}, it only be used with a "raster-dem" source type`)):w.push(new zt(s,n.source,`source "${n.source}" not found`))}else w.push(new zt(s,n,'terrain is missing required property "source"'));return w}function ha(i){const n=i.value,s=i.style,c=i.styleSpec,f=c.fog;let y=[];const w=Jn(n);if(n===void 0)return y;if(w!=="object")return y=y.concat([new zt("fog",n,`object expected, ${w} found`)]),y;for(const E in n){const A=E.match(/^(.*)-transition$/);y=y.concat(A&&f[A[1]]&&f[A[1]].transition?Wn({key:E,value:n[E],valueSpec:c.transition,style:s,styleSpec:c}):f[E]?Wn({key:E,value:n[E],valueSpec:f[E],style:s,styleSpec:c}):[new zt(E,n[E],`unknown property "${E}"`)])}return y}const Nr={"*":()=>[],array:xl,boolean:function(i){const n=i.value,s=i.key,c=Jn(n);return c!=="boolean"?[new zt(s,n,`boolean expected, ${c} found`)]:[]},number:fc,color:function(i){const n=i.key,s=i.value,c=Jn(s);return c!=="string"?[new zt(n,s,`color expected, ${c} found`)]:eu(s)===null?[new zt(n,s,`color expected, "${s}" found`)]:[]},enum:vl,filter:Ss,function:vu,layer:Ep,object:Ts,source:wl,light:bd,terrain:za,fog:ha,string:Es,formatted:function(i){return Es(i).length===0?[]:Ri(i)},resolvedImage:function(i){return Es(i).length===0?[]:Ri(i)},projection:function(i){const n=i.value,s=i.styleSpec,c=s.projection,f=i.style;let y=[];const w=Jn(n);if(w==="object")for(const E in n)y=y.concat(Wn({key:E,value:n[E],valueSpec:c[E],style:f,styleSpec:s}));else w!=="string"&&(y=y.concat([new zt("projection",n,`object or string expected, ${w} found`)]));return y}};function Wn(i){const n=i.value,s=i.valueSpec,c=i.styleSpec;return s.expression&&uc(si(n))?vu(i):s.expression&&_l(Ii(n))?Ri(i):s.type&&Nr[s.type]?Nr[s.type](i):Ts(bi({},i,{valueSpec:s.type?c[s.type]:s}))}function Ba(i){const n=i.value,s=i.key,c=Es(i);return c.length||(n.indexOf("{fontstack}")===-1&&c.push(new zt(s,n,'"glyphs" url must include a "{fontstack}" token')),n.indexOf("{range}")===-1&&c.push(new zt(s,n,'"glyphs" url must include a "{range}" token'))),c}function Ui(i,n=dt){return $i(Wn({key:"",value:i,valueSpec:n.$root,styleSpec:n,style:i,objectElementValidators:{glyphs:Ba,"*":()=>[]}}))}const Cs=i=>$i(vd(i)),bl=i=>$i(ef(i));function $i(i){return i.slice().sort(((n,s)=>n.line&&s.line?n.line-s.line:0))}function as(i,n){let s=!1;if(n&&n.length)for(const c of n)i.fire(new Qs(new Error(c.message))),s=!0;return s}var Td=So,ao=3;function So(i,n,s){var c=this.cells=[];if(i instanceof ArrayBuffer){this.arrayBuffer=i;var f=new Int32Array(this.arrayBuffer);i=f[0],this.d=(n=f[1])+2*(s=f[2]);for(var y=0;y<this.d*this.d;y++){var w=f[ao+y],E=f[ao+y+1];c.push(w===E?null:f.subarray(w,E))}var A=f[ao+c.length+1];this.keys=f.subarray(f[ao+c.length],A),this.bboxes=f.subarray(A),this.insert=this._insertReadonly}else{this.d=n+2*s;for(var I=0;I<this.d*this.d;I++)c.push([]);this.keys=[],this.bboxes=[]}this.n=n,this.extent=i,this.padding=s,this.scale=n/i,this.uid=0;var j=s/n*i;this.min=-j,this.max=i+j}So.prototype.insert=function(i,n,s,c,f){this._forEachCell(n,s,c,f,this._insertCell,this.uid++),this.keys.push(i),this.bboxes.push(n),this.bboxes.push(s),this.bboxes.push(c),this.bboxes.push(f)},So.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},So.prototype._insertCell=function(i,n,s,c,f,y){this.cells[f].push(y)},So.prototype.query=function(i,n,s,c,f){var y=this.min,w=this.max;if(i<=y&&n<=y&&w<=s&&w<=c&&!f)return Array.prototype.slice.call(this.keys);var E=[];return this._forEachCell(i,n,s,c,this._queryCell,E,{},f),E},So.prototype._queryCell=function(i,n,s,c,f,y,w,E){var A=this.cells[f];if(A!==null)for(var I=this.keys,j=this.bboxes,V=0;V<A.length;V++){var U=A[V];if(w[U]===void 0){var q=4*U;(E?E(j[q+0],j[q+1],j[q+2],j[q+3]):i<=j[q+2]&&n<=j[q+3]&&s>=j[q+0]&&c>=j[q+1])?(w[U]=!0,y.push(I[U])):w[U]=!1}}},So.prototype._forEachCell=function(i,n,s,c,f,y,w,E){for(var A=this._convertToCellCoord(i),I=this._convertToCellCoord(n),j=this._convertToCellCoord(s),V=this._convertToCellCoord(c),U=A;U<=j;U++)for(var q=I;q<=V;q++){var X=this.d*q+U;if((!E||E(this._convertFromCellCoord(U),this._convertFromCellCoord(q),this._convertFromCellCoord(U+1),this._convertFromCellCoord(q+1)))&&f.call(this,i,n,s,c,X,y,w,E))return}},So.prototype._convertFromCellCoord=function(i){return(i-this.padding)/this.scale},So.prototype._convertToCellCoord=function(i){return Math.max(0,Math.min(this.d-1,Math.floor(i*this.scale)+this.padding))},So.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var i=this.cells,n=ao+this.cells.length+1+1,s=0,c=0;c<this.cells.length;c++)s+=this.cells[c].length;var f=new Int32Array(n+s+this.keys.length+this.bboxes.length);f[0]=this.extent,f[1]=this.n,f[2]=this.padding;for(var y=n,w=0;w<i.length;w++){var E=i[w];f[ao+w]=y,f.set(E,y),y+=E.length}return f[ao+i.length]=y,f.set(this.keys,y),f[ao+i.length+1]=y+=this.keys.length,f.set(this.bboxes,y),y+=this.bboxes.length,f.buffer};var qo=pe(Td);const bu={};function Ft(i,n,s={}){Object.defineProperty(i,"_classRegistryKey",{value:n,writeable:!1}),bu[n]={klass:i,omit:s.omit||[]}}Ft(Object,"Object"),qo.serialize=function(i,n){const s=i.toArrayBuffer();return n&&n.push(s),{buffer:s}},qo.deserialize=function(i){return new qo(i.buffer)},Object.defineProperty(qo,"name",{value:"Grid"}),Ft(qo,"Grid"),Ft(_r,"Color"),Ft(Error,"Error"),Ft(ss,"AJAXError"),Ft(no,"ResolvedImage"),Ft(xu,"StylePropertyFunction"),Ft(yu,"StyleExpression",{omit:["_evaluator"]}),Ft(ja,"ZoomDependentExpression"),Ft(_u,"ZoomConstantExpression"),Ft(io,"CompoundExpression",{omit:["_evaluate"]});for(const i in cc)bu[cc[i]._classRegistryKey]||Ft(cc[i],`Expression${i}`);function vc(i){return i&&typeof ArrayBuffer<"u"&&(i instanceof ArrayBuffer||i.constructor&&i.constructor.name==="ArrayBuffer")}function Tu(i){return k.ImageBitmap&&i instanceof k.ImageBitmap}function Tl(i,n){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp)return i;if(vc(i)||Tu(i))return n&&n.push(i),i;if(ArrayBuffer.isView(i)){const s=i;return n&&n.push(s.buffer),s}if(i instanceof k.ImageData)return n&&n.push(i.data.buffer),i;if(Array.isArray(i)){const s=[];for(const c of i)s.push(Tl(c,n));return s}if(typeof i=="object"){const s=i.constructor,c=s._classRegistryKey;if(!c)throw new Error(`can't serialize object of unregistered class ${c}`);const f=s.serialize?s.serialize(i,n):{};if(!s.serialize){for(const y in i)i.hasOwnProperty(y)&&(bu[c].omit.indexOf(y)>=0||(f[y]=Tl(i[y],n)));i instanceof Error&&(f.message=i.message)}if(f.$name)throw new Error("$name property is reserved for worker serialization logic.");return c!=="Object"&&(f.$name=c),f}throw new Error("can't serialize object of type "+typeof i)}function Sl(i){if(i==null||typeof i=="boolean"||typeof i=="number"||typeof i=="string"||i instanceof Boolean||i instanceof Number||i instanceof String||i instanceof Date||i instanceof RegExp||vc(i)||Tu(i)||ArrayBuffer.isView(i)||i instanceof k.ImageData)return i;if(Array.isArray(i))return i.map(Sl);if(typeof i=="object"){const n=i.$name||"Object",{klass:s}=bu[n];if(!s)throw new Error(`can't deserialize unregistered class ${n}`);if(s.deserialize)return s.deserialize(i);const c=Object.create(s.prototype);for(const f of Object.keys(i))f!=="$name"&&(c[f]=Sl(i[f]));return c}throw new Error("can't deserialize object of type "+typeof i)}const Ot={"Latin-1 Supplement":i=>i>=128&&i<=255,Arabic:i=>i>=1536&&i<=1791,"Arabic Supplement":i=>i>=1872&&i<=1919,"Arabic Extended-A":i=>i>=2208&&i<=2303,"Hangul Jamo":i=>i>=4352&&i<=4607,"Unified Canadian Aboriginal Syllabics":i=>i>=5120&&i<=5759,Khmer:i=>i>=6016&&i<=6143,"Unified Canadian Aboriginal Syllabics Extended":i=>i>=6320&&i<=6399,"General Punctuation":i=>i>=8192&&i<=8303,"Letterlike Symbols":i=>i>=8448&&i<=8527,"Number Forms":i=>i>=8528&&i<=8591,"Miscellaneous Technical":i=>i>=8960&&i<=9215,"Control Pictures":i=>i>=9216&&i<=9279,"Optical Character Recognition":i=>i>=9280&&i<=9311,"Enclosed Alphanumerics":i=>i>=9312&&i<=9471,"Geometric Shapes":i=>i>=9632&&i<=9727,"Miscellaneous Symbols":i=>i>=9728&&i<=9983,"Miscellaneous Symbols and Arrows":i=>i>=11008&&i<=11263,"CJK Radicals Supplement":i=>i>=11904&&i<=12031,"Kangxi Radicals":i=>i>=12032&&i<=12255,"Ideographic Description Characters":i=>i>=12272&&i<=12287,"CJK Symbols and Punctuation":i=>i>=12288&&i<=12351,Hiragana:i=>i>=12352&&i<=12447,Katakana:i=>i>=12448&&i<=12543,Bopomofo:i=>i>=12544&&i<=12591,"Hangul Compatibility Jamo":i=>i>=12592&&i<=12687,Kanbun:i=>i>=12688&&i<=12703,"Bopomofo Extended":i=>i>=12704&&i<=12735,"CJK Strokes":i=>i>=12736&&i<=12783,"Katakana Phonetic Extensions":i=>i>=12784&&i<=12799,"Enclosed CJK Letters and Months":i=>i>=12800&&i<=13055,"CJK Compatibility":i=>i>=13056&&i<=13311,"CJK Unified Ideographs Extension A":i=>i>=13312&&i<=19903,"Yijing Hexagram Symbols":i=>i>=19904&&i<=19967,"CJK Unified Ideographs":i=>i>=19968&&i<=40959,"Yi Syllables":i=>i>=40960&&i<=42127,"Yi Radicals":i=>i>=42128&&i<=42191,"Hangul Jamo Extended-A":i=>i>=43360&&i<=43391,"Hangul Syllables":i=>i>=44032&&i<=55215,"Hangul Jamo Extended-B":i=>i>=55216&&i<=55295,"Private Use Area":i=>i>=57344&&i<=63743,"CJK Compatibility Ideographs":i=>i>=63744&&i<=64255,"Arabic Presentation Forms-A":i=>i>=64336&&i<=65023,"Vertical Forms":i=>i>=65040&&i<=65055,"CJK Compatibility Forms":i=>i>=65072&&i<=65103,"Small Form Variants":i=>i>=65104&&i<=65135,"Arabic Presentation Forms-B":i=>i>=65136&&i<=65279,"Halfwidth and Fullwidth Forms":i=>i>=65280&&i<=65519};function Fa(i){for(const n of i)if(bc(n.charCodeAt(0)))return!0;return!1}function wc(i){for(const n of i)if(!Su(n.charCodeAt(0)))return!1;return!0}function Su(i){return!(Ot.Arabic(i)||Ot["Arabic Supplement"](i)||Ot["Arabic Extended-A"](i)||Ot["Arabic Presentation Forms-A"](i)||Ot["Arabic Presentation Forms-B"](i))}function bc(i){return!(i!==746&&i!==747&&(i<4352||!(Ot["Bopomofo Extended"](i)||Ot.Bopomofo(i)||Ot["CJK Compatibility Forms"](i)&&!(i>=65097&&i<=65103)||Ot["CJK Compatibility Ideographs"](i)||Ot["CJK Compatibility"](i)||Ot["CJK Radicals Supplement"](i)||Ot["CJK Strokes"](i)||!(!Ot["CJK Symbols and Punctuation"](i)||i>=12296&&i<=12305||i>=12308&&i<=12319||i===12336)||Ot["CJK Unified Ideographs Extension A"](i)||Ot["CJK Unified Ideographs"](i)||Ot["Enclosed CJK Letters and Months"](i)||Ot["Hangul Compatibility Jamo"](i)||Ot["Hangul Jamo Extended-A"](i)||Ot["Hangul Jamo Extended-B"](i)||Ot["Hangul Jamo"](i)||Ot["Hangul Syllables"](i)||Ot.Hiragana(i)||Ot["Ideographic Description Characters"](i)||Ot.Kanbun(i)||Ot["Kangxi Radicals"](i)||Ot["Katakana Phonetic Extensions"](i)||Ot.Katakana(i)&&i!==12540||!(!Ot["Halfwidth and Fullwidth Forms"](i)||i===65288||i===65289||i===65293||i>=65306&&i<=65310||i===65339||i===65341||i===65343||i>=65371&&i<=65503||i===65507||i>=65512&&i<=65519)||!(!Ot["Small Form Variants"](i)||i>=65112&&i<=65118||i>=65123&&i<=65126)||Ot["Unified Canadian Aboriginal Syllabics"](i)||Ot["Unified Canadian Aboriginal Syllabics Extended"](i)||Ot["Vertical Forms"](i)||Ot["Yijing Hexagram Symbols"](i)||Ot["Yi Syllables"](i)||Ot["Yi Radicals"](i))))}function Bs(i){return!(bc(i)||(function(n){return!!(Ot["Latin-1 Supplement"](n)&&(n===167||n===169||n===174||n===177||n===188||n===189||n===190||n===215||n===247)||Ot["General Punctuation"](n)&&(n===8214||n===8224||n===8225||n===8240||n===8241||n===8251||n===8252||n===8258||n===8263||n===8264||n===8265||n===8273)||Ot["Letterlike Symbols"](n)||Ot["Number Forms"](n)||Ot["Miscellaneous Technical"](n)&&(n>=8960&&n<=8967||n>=8972&&n<=8991||n>=8996&&n<=9e3||n===9003||n>=9085&&n<=9114||n>=9150&&n<=9165||n===9167||n>=9169&&n<=9179||n>=9186&&n<=9215)||Ot["Control Pictures"](n)&&n!==9251||Ot["Optical Character Recognition"](n)||Ot["Enclosed Alphanumerics"](n)||Ot["Geometric Shapes"](n)||Ot["Miscellaneous Symbols"](n)&&!(n>=9754&&n<=9759)||Ot["Miscellaneous Symbols and Arrows"](n)&&(n>=11026&&n<=11055||n>=11088&&n<=11097||n>=11192&&n<=11243)||Ot["CJK Symbols and Punctuation"](n)||Ot.Katakana(n)||Ot["Private Use Area"](n)||Ot["CJK Compatibility Forms"](n)||Ot["Small Form Variants"](n)||Ot["Halfwidth and Fullwidth Forms"](n)||n===8734||n===8756||n===8757||n>=9984&&n<=10087||n>=10102&&n<=10131||n===65532||n===65533)})(i))}function Fs(i){return i>=1424&&i<=2303||Ot["Arabic Presentation Forms-A"](i)||Ot["Arabic Presentation Forms-B"](i)}function El(i,n){return!(!n&&Fs(i)||i>=2304&&i<=3583||i>=3840&&i<=4255||Ot.Khmer(i))}function fa(i){for(const n of i)if(Fs(n.charCodeAt(0)))return!0;return!1}const Eo="deferred",pa="loading",Sd="loaded";let Va=null,g="unavailable",o=null;const h=function(i){i&&typeof i=="string"&&i.indexOf("NetworkError")>-1&&(g="error"),Va&&Va(i)};function _(){T.fire(new ka("pluginStateChange",{pluginStatus:g,pluginURL:o}))}const T=new xs,C=function(){return g},N=function(){if(g!==Eo||!o)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");g=pa,_(),o&&Ys({url:o},(i=>{i?h(i):(g=Sd,_())}))},D={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>g===Sd||D.applyArabicShaping!=null,isLoading:()=>g===pa,setState(i){g=i.pluginStatus,o=i.pluginURL},isParsed:()=>D.applyArabicShaping!=null&&D.processBidirectionalText!=null&&D.processStyledBidirectionalText!=null,getPluginURL:()=>o};class B{constructor(n,s){this.zoom=n,s?(this.now=s.now,this.fadeDuration=s.fadeDuration,this.transition=s.transition,this.pitch=s.pitch):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0)}isSupportedScript(n){return(function(s,c){for(const f of s)if(!El(f.charCodeAt(0),c))return!1;return!0})(n,D.isLoaded())}}class G{constructor(n,s){this.property=n,this.value=s,this.expression=(function(c,f){if(uc(c))return new xu(c,f);if(_l(c)){const y=ca(c,f);if(y.result==="error")throw new Error(y.value.map((w=>`${w.key}: ${w.message}`)).join(", "));return y.value}{let y=c;return typeof c=="string"&&f.type==="color"&&(y=_r.parse(c)),{kind:"constant",evaluate:()=>y}}})(s===void 0?n.specification.default:s,n.specification)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(n,s,c){return this.property.possiblyEvaluate(this,n,s,c)}}class ${constructor(n){this.property=n,this.value=new G(n,void 0)}transitioned(n,s){return new oe(this.property,this.value,s,vt({},n.transition,this.transition),n.now)}untransitioned(){return new oe(this.property,this.value,null,{},0)}}class J{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitionablePropertyValues)}getValue(n){return hr(this._values[n].value.value)}setValue(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new $(this._values[n].property)),this._values[n].value=new G(this._values[n].property,s===null?void 0:hr(s))}getTransition(n){return hr(this._values[n].transition)}setTransition(n,s){this._values.hasOwnProperty(n)||(this._values[n]=new $(this._values[n].property)),this._values[n].transition=hr(s)||void 0}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c);const f=this.getTransition(s);f!==void 0&&(n[`${s}-transition`]=f)}return n}transitioned(n,s){const c=new ce(this._properties);for(const f of Object.keys(this._values))c._values[f]=this._values[f].transitioned(n,s._values[f]);return c}untransitioned(){const n=new ce(this._properties);for(const s of Object.keys(this._values))n._values[s]=this._values[s].untransitioned();return n}}class oe{constructor(n,s,c,f,y){const w=f.delay||0,E=f.duration||0;y=y||0,this.property=n,this.value=s,this.begin=y+w,this.end=this.begin+E,n.specification.transition&&(f.delay||f.duration)&&(this.prior=c)}possiblyEvaluate(n,s,c){const f=n.now||0,y=this.value.possiblyEvaluate(n,s,c),w=this.prior;if(w){if(f>this.end)return this.prior=null,y;if(this.value.isDataDriven())return this.prior=null,y;if(f<this.begin)return w.possiblyEvaluate(n,s,c);{const E=(f-this.begin)/(this.end-this.begin);return this.property.interpolate(w.possiblyEvaluate(n,s,c),y,mt(E))}}return y}}class ce{constructor(n){this._properties=n,this._values=Object.create(n.defaultTransitioningPropertyValues)}possiblyEvaluate(n,s,c){const f=new me(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(n,s,c);return f}hasTransition(){for(const n of Object.keys(this._values))if(this._values[n].prior)return!0;return!1}}class fe{constructor(n){this._properties=n,this._values=Object.create(n.defaultPropertyValues)}getValue(n){return hr(this._values[n].value)}setValue(n,s){this._values[n]=new G(this._values[n].property,s===null?void 0:hr(s))}serialize(){const n={};for(const s of Object.keys(this._values)){const c=this.getValue(s);c!==void 0&&(n[s]=c)}return n}possiblyEvaluate(n,s,c){const f=new me(this._properties);for(const y of Object.keys(this._values))f._values[y]=this._values[y].possiblyEvaluate(n,s,c);return f}}class de{constructor(n,s,c){this.property=n,this.value=s,this.parameters=c}isConstant(){return this.value.kind==="constant"}constantOr(n){return this.value.kind==="constant"?this.value.value:n}evaluate(n,s,c,f){return this.property.evaluate(this.value,this.parameters,n,s,c,f)}}class me{constructor(n){this._properties=n,this._values=Object.create(n.defaultPossiblyEvaluatedValues)}get(n){return this._values[n]}}class Q{constructor(n){this.specification=n}possiblyEvaluate(n,s){return n.expression.evaluate(s)}interpolate(n,s,c){const f=au[this.specification.type];return f?f(n,s,c):n}}class le{constructor(n,s){this.specification=n,this.overrides=s}possiblyEvaluate(n,s,c,f){return new de(this,n.expression.kind==="constant"||n.expression.kind==="camera"?{kind:"constant",value:n.expression.evaluate(s,null,{},c,f)}:n.expression,s)}interpolate(n,s,c){if(n.value.kind!=="constant"||s.value.kind!=="constant")return n;if(n.value.value===void 0||s.value.value===void 0)return new de(this,{kind:"constant",value:void 0},n.parameters);const f=au[this.specification.type];return f?new de(this,{kind:"constant",value:f(n.value.value,s.value.value,c)},n.parameters):n}evaluate(n,s,c,f,y,w){return n.kind==="constant"?n.value:n.evaluate(s,c,f,y,w)}}class _e{constructor(n){this.specification=n}possiblyEvaluate(n,s,c,f){return!!n.expression.evaluate(s,null,{},c,f)}interpolate(){return!1}}class ve{constructor(n){this.properties=n,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const s=new B(0,{});for(const c in n){const f=n[c];f.specification.overridable&&this.overridableProperties.push(c);const y=this.defaultPropertyValues[c]=new G(f,void 0),w=this.defaultTransitionablePropertyValues[c]=new $(f);this.defaultTransitioningPropertyValues[c]=w.untransitioned(),this.defaultPossiblyEvaluatedValues[c]=y.possiblyEvaluate(s)}}}function Ne(i,n){return 256*(i=xe(Math.floor(i),0,255))+xe(Math.floor(n),0,255)}Ft(le,"DataDrivenProperty"),Ft(Q,"DataConstantProperty"),Ft(_e,"ColorRampProperty");const Le={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class De{constructor(n,s){this._structArray=n,this._pos1=s*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class $e{constructor(){this.isTransferred=!1,this.capacity=-1,this.resize(0)}static serialize(n,s){return n._trim(),s&&(n.isTransferred=!0,s.push(n.arrayBuffer)),{length:n.length,arrayBuffer:n.arrayBuffer}}static deserialize(n){const s=Object.create(this.prototype);return s.arrayBuffer=n.arrayBuffer,s.length=n.length,s.capacity=n.arrayBuffer.byteLength/s.bytesPerElement,s._refreshViews(),s}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(n){this.reserve(n),this.length=n}reserve(n){if(n>this.capacity){this.capacity=Math.max(n,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const s=this.uint8;this._refreshViews(),s&&this.uint8.set(s)}}_refreshViews(){throw new Error("_refreshViews() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Ue(i,n=1){let s=0,c=0;return{members:i.map((f=>{const y=Le[f.type].BYTES_PER_ELEMENT,w=s=Ye(s,Math.max(n,y)),E=f.components||1;return c=Math.max(c,y),s+=y*E,{name:f.name,type:f.type,components:E,offset:w}})),size:Ye(s,Math.max(c,n)),alignment:n}}function Ye(i,n){return Math.ceil(i/n)*n}class kt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.int16[f+0]=s,this.int16[f+1]=c,n}}kt.prototype.bytesPerElement=4,Ft(kt,"StructArrayLayout2i4");class qe extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.int16[y+0]=s,this.int16[y+1]=c,this.int16[y+2]=f,n}}qe.prototype.bytesPerElement=6,Ft(qe,"StructArrayLayout3i6");class at extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.int16[w+0]=s,this.int16[w+1]=c,this.int16[w+2]=f,this.int16[w+3]=y,n}}at.prototype.bytesPerElement=8,Ft(at,"StructArrayLayout4i8");class Je extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,f,y,w,E)}emplace(n,s,c,f,y,w,E,A){const I=6*n,j=12*n,V=3*n;return this.int16[I+0]=s,this.int16[I+1]=c,this.uint8[j+4]=f,this.uint8[j+5]=y,this.uint8[j+6]=w,this.uint8[j+7]=E,this.float32[V+2]=A,n}}Je.prototype.bytesPerElement=12,Ft(Je,"StructArrayLayout2i4ub1f12");class Et extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.float32[w+0]=s,this.float32[w+1]=c,this.float32[w+2]=f,this.float32[w+3]=y,n}}Et.prototype.bytesPerElement=16,Ft(Et,"StructArrayLayout4f16");class Ke extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=6*n,A=3*n;return this.uint16[E+0]=s,this.uint16[E+1]=c,this.uint16[E+2]=f,this.uint16[E+3]=y,this.float32[A+2]=w,n}}Ke.prototype.bytesPerElement=12,Ft(Ke,"StructArrayLayout4ui1f12");class lt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=4*n;return this.uint16[w+0]=s,this.uint16[w+1]=c,this.uint16[w+2]=f,this.uint16[w+3]=y,n}}lt.prototype.bytesPerElement=8,Ft(lt,"StructArrayLayout4ui8");class Tt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,f,y,w)}emplace(n,s,c,f,y,w,E){const A=6*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=f,this.int16[A+3]=y,this.int16[A+4]=w,this.int16[A+5]=E,n}}Tt.prototype.bytesPerElement=12,Ft(Tt,"StructArrayLayout6i12");class xt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U){const q=this.length;return this.resize(q+1),this.emplace(q,n,s,c,f,y,w,E,A,I,j,V,U)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q){const X=12*n;return this.int16[X+0]=s,this.int16[X+1]=c,this.int16[X+2]=f,this.int16[X+3]=y,this.uint16[X+4]=w,this.uint16[X+5]=E,this.uint16[X+6]=A,this.uint16[X+7]=I,this.int16[X+8]=j,this.int16[X+9]=V,this.int16[X+10]=U,this.int16[X+11]=q,n}}xt.prototype.bytesPerElement=24,Ft(xt,"StructArrayLayout4i4ui4i24");class At extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w){const E=this.length;return this.resize(E+1),this.emplace(E,n,s,c,f,y,w)}emplace(n,s,c,f,y,w,E){const A=10*n,I=5*n;return this.int16[A+0]=s,this.int16[A+1]=c,this.int16[A+2]=f,this.float32[I+2]=y,this.float32[I+3]=w,this.float32[I+4]=E,n}}At.prototype.bytesPerElement=20,Ft(At,"StructArrayLayout3i3f20");class Qt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint32[1*n+0]=s,n}}Qt.prototype.bytesPerElement=4,Ft(Qt,"StructArrayLayout1ul4");class yn extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q){const X=this.length;return this.resize(X+1),this.emplace(X,n,s,c,f,y,w,E,A,I,j,V,U,q)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=20*n,ae=10*n;return this.int16[te+0]=s,this.int16[te+1]=c,this.int16[te+2]=f,this.int16[te+3]=y,this.int16[te+4]=w,this.float32[ae+3]=E,this.float32[ae+4]=A,this.float32[ae+5]=I,this.float32[ae+6]=j,this.int16[te+14]=V,this.uint32[ae+8]=U,this.uint16[te+18]=q,this.uint16[te+19]=X,n}}yn.prototype.bytesPerElement=40,Ft(yn,"StructArrayLayout5i4f1i1ul2ui40");class qt extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E){const A=this.length;return this.resize(A+1),this.emplace(A,n,s,c,f,y,w,E)}emplace(n,s,c,f,y,w,E,A){const I=8*n;return this.int16[I+0]=s,this.int16[I+1]=c,this.int16[I+2]=f,this.int16[I+4]=y,this.int16[I+5]=w,this.int16[I+6]=E,this.int16[I+7]=A,n}}qt.prototype.bytesPerElement=16,Ft(qt,"StructArrayLayout3i2i2i16");class un extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=4*n,A=8*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=f,this.int16[A+6]=y,this.int16[A+7]=w,n}}un.prototype.bytesPerElement=16,Ft(un,"StructArrayLayout2f1f2i16");class jn extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=12*n,E=3*n;return this.uint8[w+0]=s,this.uint8[w+1]=c,this.float32[E+1]=f,this.float32[E+2]=y,n}}jn.prototype.bytesPerElement=12,Ft(jn,"StructArrayLayout2ub2f12");class Fn extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.float32[y+0]=s,this.float32[y+1]=c,this.float32[y+2]=f,n}}Fn.prototype.bytesPerElement=12,Ft(Fn,"StructArrayLayout3f12");class en extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c){const f=this.length;return this.resize(f+1),this.emplace(f,n,s,c)}emplace(n,s,c,f){const y=3*n;return this.uint16[y+0]=s,this.uint16[y+1]=c,this.uint16[y+2]=f,n}}en.prototype.bytesPerElement=6,Ft(en,"StructArrayLayout3ui6");class Gn extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re){const Me=this.length;return this.resize(Me+1),this.emplace(Me,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re,Me){const Qe=30*n,Xe=15*n,ft=60*n;return this.int16[Qe+0]=s,this.int16[Qe+1]=c,this.int16[Qe+2]=f,this.float32[Xe+2]=y,this.float32[Xe+3]=w,this.uint16[Qe+8]=E,this.uint16[Qe+9]=A,this.uint32[Xe+5]=I,this.uint32[Xe+6]=j,this.uint32[Xe+7]=V,this.uint16[Qe+16]=U,this.uint16[Qe+17]=q,this.uint16[Qe+18]=X,this.float32[Xe+10]=te,this.float32[Xe+11]=ae,this.uint8[ft+48]=ge,this.uint8[ft+49]=Ce,this.uint8[ft+50]=ye,this.uint32[Xe+13]=Ee,this.int16[Qe+28]=Re,this.uint8[ft+58]=Me,n}}Gn.prototype.bytesPerElement=60,Ft(Gn,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class sr extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re,Me,Qe,Xe,ft,It,nt,yt,_t,Ct){const Pt=this.length;return this.resize(Pt+1),this.emplace(Pt,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re,Me,Qe,Xe,ft,It,nt,yt,_t,Ct)}emplace(n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae,ge,Ce,ye,Ee,Re,Me,Qe,Xe,ft,It,nt,yt,_t,Ct,Pt){const ct=38*n,Bt=19*n;return this.int16[ct+0]=s,this.int16[ct+1]=c,this.int16[ct+2]=f,this.float32[Bt+2]=y,this.float32[Bt+3]=w,this.int16[ct+8]=E,this.int16[ct+9]=A,this.int16[ct+10]=I,this.int16[ct+11]=j,this.int16[ct+12]=V,this.int16[ct+13]=U,this.uint16[ct+14]=q,this.uint16[ct+15]=X,this.uint16[ct+16]=te,this.uint16[ct+17]=ae,this.uint16[ct+18]=ge,this.uint16[ct+19]=Ce,this.uint16[ct+20]=ye,this.uint16[ct+21]=Ee,this.uint16[ct+22]=Re,this.uint16[ct+23]=Me,this.uint16[ct+24]=Qe,this.uint16[ct+25]=Xe,this.uint16[ct+26]=ft,this.uint16[ct+27]=It,this.uint16[ct+28]=nt,this.uint32[Bt+15]=yt,this.float32[Bt+16]=_t,this.float32[Bt+17]=Ct,this.float32[Bt+18]=Pt,n}}sr.prototype.bytesPerElement=76,Ft(sr,"StructArrayLayout3i2f6i15ui1ul3f76");class or extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.float32[1*n+0]=s,n}}or.prototype.bytesPerElement=4,Ft(or,"StructArrayLayout1f4");class tr extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s,c,f,y){const w=this.length;return this.resize(w+1),this.emplace(w,n,s,c,f,y)}emplace(n,s,c,f,y,w){const E=5*n;return this.float32[E+0]=s,this.float32[E+1]=c,this.float32[E+2]=f,this.float32[E+3]=y,this.float32[E+4]=w,n}}tr.prototype.bytesPerElement=20,Ft(tr,"StructArrayLayout5f20");class Ni extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s,c,f){const y=this.length;return this.resize(y+1),this.emplace(y,n,s,c,f)}emplace(n,s,c,f,y){const w=6*n;return this.uint32[3*n+0]=s,this.uint16[w+2]=c,this.uint16[w+3]=f,this.uint16[w+4]=y,n}}Ni.prototype.bytesPerElement=12,Ft(Ni,"StructArrayLayout1ul3ui12");class $r extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.uint16[f+0]=s,this.uint16[f+1]=c,n}}$r.prototype.bytesPerElement=4,Ft($r,"StructArrayLayout2ui4");class Vs extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(n){const s=this.length;return this.resize(s+1),this.emplace(s,n)}emplace(n,s){return this.uint16[1*n+0]=s,n}}Vs.prototype.bytesPerElement=2,Ft(Vs,"StructArrayLayout1ui2");class lo extends $e{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(n,s){const c=this.length;return this.resize(c+1),this.emplace(c,n,s)}emplace(n,s,c){const f=2*n;return this.float32[f+0]=s,this.float32[f+1]=c,n}}lo.prototype.bytesPerElement=8,Ft(lo,"StructArrayLayout2f8");class In extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}In.prototype.size=40;class fr extends yn{get(n){return new In(this,n)}}Ft(fr,"CollisionBoxArray");class Qn extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(n){this._structArray.uint8[this._pos1+49]=n}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(n){this._structArray.uint8[this._pos1+50]=n}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(n){this._structArray.uint32[this._pos4+13]=n}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(n){this._structArray.uint8[this._pos1+58]=n}}Qn.prototype.size=60;class Gr extends Gn{get(n){return new Qn(this,n)}}Ft(Gr,"PlacedSymbolArray");class Di extends De{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+11]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+13]}get key(){return this._structArray.uint16[this._pos2+14]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+15]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+17]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+19]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+21]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+22]}get featureIndex(){return this._structArray.uint16[this._pos2+23]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+25]}get numIconVertices(){return this._structArray.uint16[this._pos2+26]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+27]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+28]}get crossTileID(){return this._structArray.uint32[this._pos4+15]}set crossTileID(n){this._structArray.uint32[this._pos4+15]=n}get textOffset0(){return this._structArray.float32[this._pos4+16]}get textOffset1(){return this._structArray.float32[this._pos4+17]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+18]}}Di.prototype.size=76;class xr extends sr{get(n){return new Di(this,n)}}Ft(xr,"SymbolInstanceArray");class hi extends or{getoffsetX(n){return this.float32[1*n+0]}}Ft(hi,"GlyphOffsetArray");class Dr extends kt{getx(n){return this.int16[2*n+0]}gety(n){return this.int16[2*n+1]}}Ft(Dr,"SymbolLineVertexArray");class Or extends De{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}Or.prototype.size=12;class Kr extends Ni{get(n){return new Or(this,n)}}Ft(Kr,"FeatureIndexArray");class co extends $r{geta_centroid_pos0(n){return this.uint16[2*n+0]}geta_centroid_pos1(n){return this.uint16[2*n+1]}}Ft(co,"FillExtrusionCentroidArray");const uo=Ue([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Co=Ue([{name:"a_dash",components:4,type:"Uint16"}]);var Ed={exports:{}},fi={exports:{}};fi.exports=function(i,n){var s,c,f,y,w,E,A,I;for(c=i.length-(s=3&i.length),f=n,w=3432918353,E=461845907,I=0;I<c;)A=255&i.charCodeAt(I)|(255&i.charCodeAt(++I))<<8|(255&i.charCodeAt(++I))<<16|(255&i.charCodeAt(++I))<<24,++I,f=27492+(65535&(y=5*(65535&(f=(f^=A=(65535&(A=(A=(65535&A)*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295)<<13|f>>>19))+((5*(f>>>16)&65535)<<16)&4294967295))+((58964+(y>>>16)&65535)<<16);switch(A=0,s){case 3:A^=(255&i.charCodeAt(I+2))<<16;case 2:A^=(255&i.charCodeAt(I+1))<<8;case 1:f^=A=(65535&(A=(A=(65535&(A^=255&i.charCodeAt(I)))*w+(((A>>>16)*w&65535)<<16)&4294967295)<<15|A>>>17))*E+(((A>>>16)*E&65535)<<16)&4294967295}return f^=i.length,f=2246822507*(65535&(f^=f>>>16))+((2246822507*(f>>>16)&65535)<<16)&4294967295,f=3266489909*(65535&(f^=f>>>13))+((3266489909*(f>>>16)&65535)<<16)&4294967295,(f^=f>>>16)>>>0};var Eu=fi.exports,Cp={exports:{}};Cp.exports=function(i,n){for(var s,c=i.length,f=n^c,y=0;c>=4;)s=1540483477*(65535&(s=255&i.charCodeAt(y)|(255&i.charCodeAt(++y))<<8|(255&i.charCodeAt(++y))<<16|(255&i.charCodeAt(++y))<<24))+((1540483477*(s>>>16)&65535)<<16),f=1540483477*(65535&f)+((1540483477*(f>>>16)&65535)<<16)^(s=1540483477*(65535&(s^=s>>>24))+((1540483477*(s>>>16)&65535)<<16)),c-=4,++y;switch(c){case 3:f^=(255&i.charCodeAt(y+2))<<16;case 2:f^=(255&i.charCodeAt(y+1))<<8;case 1:f=1540483477*(65535&(f^=255&i.charCodeAt(y)))+((1540483477*(f>>>16)&65535)<<16)}return f=1540483477*(65535&(f^=f>>>13))+((1540483477*(f>>>16)&65535)<<16),(f^=f>>>15)>>>0};var kp=Eu,Ua=Cp.exports;Ed.exports=kp,Ed.exports.murmur3=kp,Ed.exports.murmur2=Ua;var ho=pe(Ed.exports);class Tc{constructor(){this.ids=[],this.positions=[],this.indexed=!1}add(n,s,c,f){this.ids.push(Ap(n)),this.positions.push(s,c,f)}getPositions(n){const s=Ap(n);let c=0,f=this.ids.length-1;for(;c<f;){const w=c+f>>1;this.ids[w]>=s?f=w:c=w+1}const y=[];for(;this.ids[c]===s;)y.push({index:this.positions[3*c],start:this.positions[3*c+1],end:this.positions[3*c+2]}),c++;return y}static serialize(n,s){const c=new Float64Array(n.ids),f=new Uint32Array(n.positions);return tf(c,f,0,c.length-1),s&&s.push(c.buffer,f.buffer),{ids:c,positions:f}}static deserialize(n){const s=new Tc;return s.ids=n.ids,s.positions=n.positions,s.indexed=!0,s}}function Ap(i){const n=+i;return!isNaN(n)&&Number.MIN_SAFE_INTEGER<=n&&n<=Number.MAX_SAFE_INTEGER?n:ho(String(i))}function tf(i,n,s,c){for(;s<c;){const f=i[s+c>>1];let y=s-1,w=c+1;for(;;){do y++;while(i[y]<f);do w--;while(i[w]>f);if(y>=w)break;nf(i,y,w),nf(n,3*y,3*w),nf(n,3*y+1,3*w+1),nf(n,3*y+2,3*w+2)}w-s<c-w?(tf(i,n,s,w),s=w+1):(tf(i,n,w+1,c),c=w)}}function nf(i,n,s){const c=i[n];i[n]=i[s],i[s]=c}Ft(Tc,"FeaturePositionMap");class $a{constructor(n){this.gl=n.gl,this.initialized=!1}fetchUniformLocation(n,s){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(n,s),this.initialized=!0),!!this.location}}class rf extends $a{constructor(n){super(n),this.current=0}set(n,s,c){this.fetchUniformLocation(n,s)&&this.current!==c&&(this.current=c,this.gl.uniform1f(this.location,c))}}class og extends $a{constructor(n){super(n),this.current=[0,0,0,0]}set(n,s,c){this.fetchUniformLocation(n,s)&&(c[0]===this.current[0]&&c[1]===this.current[1]&&c[2]===this.current[2]&&c[3]===this.current[3]||(this.current=c,this.gl.uniform4f(this.location,c[0],c[1],c[2],c[3])))}}class ag extends $a{constructor(n){super(n),this.current=_r.transparent}set(n,s,c){this.fetchUniformLocation(n,s)&&(c.r===this.current.r&&c.g===this.current.g&&c.b===this.current.b&&c.a===this.current.a||(this.current=c,this.gl.uniform4f(this.location,c.r,c.g,c.b,c.a)))}}const m_=new Float32Array(16),g_=new Float32Array(9),y_=new Float32Array(4);function Cu(i){return[Ne(255*i.r,255*i.g),Ne(255*i.b,255*i.a)]}class Cd{constructor(n,s,c){this.value=n,this.uniformNames=s.map((f=>`u_${f}`)),this.type=c}setUniform(n,s,c,f,y){s.set(n,y,f.constantOr(this.value))}getBinding(n,s){return this.type==="color"?new ag(n):new rf(n)}}class Cl{constructor(n,s){this.uniformNames=s.map((c=>`u_${c}`)),this.pattern=null,this.pixelRatio=1}setConstantPatternPositions(n){this.pixelRatio=n.pixelRatio||1,this.pattern=n.tl.concat(n.br)}setUniform(n,s,c,f,y){const w=y==="u_pattern"||y==="u_dash"?this.pattern:y==="u_pixel_ratio"?this.pixelRatio:null;w&&s.set(n,y,w)}getBinding(n,s){return s==="u_pattern"||s==="u_dash"?new og(n):new rf(n)}}class Zo{constructor(n,s,c,f){this.expression=n,this.type=c,this.maxValue=0,this.paintVertexAttributes=s.map((y=>({name:`a_${y}`,type:"Float32",components:c==="color"?2:1,offset:0}))),this.paintVertexArray=new f}populatePaintArray(n,s,c,f,y,w){const E=this.paintVertexArray.length,A=this.expression.evaluate(new B(0),s,{},y,f,w);this.paintVertexArray.resize(n),this._setPaintValue(E,n,A)}updatePaintArray(n,s,c,f,y){const w=this.expression.evaluate({zoom:0},c,f,void 0,y);this._setPaintValue(n,s,w)}_setPaintValue(n,s,c){if(this.type==="color"){const f=Cu(c);for(let y=n;y<s;y++)this.paintVertexArray.emplace(y,f[0],f[1])}else{for(let f=n;f<s;f++)this.paintVertexArray.emplace(f,c);this.maxValue=Math.max(this.maxValue,Math.abs(c))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class Xo{constructor(n,s,c,f,y,w){this.expression=n,this.uniformNames=s.map((E=>`u_${E}_t`)),this.type=c,this.useIntegerZoom=f,this.zoom=y,this.maxValue=0,this.paintVertexAttributes=s.map((E=>({name:`a_${E}`,type:"Float32",components:c==="color"?4:2,offset:0}))),this.paintVertexArray=new w}populatePaintArray(n,s,c,f,y,w){const E=this.expression.evaluate(new B(this.zoom),s,{},y,f,w),A=this.expression.evaluate(new B(this.zoom+1),s,{},y,f,w),I=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValue(I,n,E,A)}updatePaintArray(n,s,c,f,y){const w=this.expression.evaluate({zoom:this.zoom},c,f,void 0,y),E=this.expression.evaluate({zoom:this.zoom+1},c,f,void 0,y);this._setPaintValue(n,s,w,E)}_setPaintValue(n,s,c,f){if(this.type==="color"){const y=Cu(c),w=Cu(f);for(let E=n;E<s;E++)this.paintVertexArray.emplace(E,y[0],y[1],w[0],w[1])}else{for(let y=n;y<s;y++)this.paintVertexArray.emplace(y,c,f);this.maxValue=Math.max(this.maxValue,Math.abs(c),Math.abs(f))}}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(n,s,c,f,y){const w=this.useIntegerZoom?Math.floor(c.zoom):c.zoom,E=xe(this.expression.interpolationFactor(w,this.zoom,this.zoom+1),0,1);s.set(n,y,E)}getBinding(n,s){return new rf(n)}}class Ga{constructor(n,s,c,f,y){this.expression=n,this.layerId=y,this.paintVertexAttributes=(c==="array"?Co:uo).members;for(let w=0;w<s.length;++w);this.paintVertexArray=new f}populatePaintArray(n,s,c){const f=this.paintVertexArray.length;this.paintVertexArray.resize(n),this._setPaintValues(f,n,s.patterns&&s.patterns[this.layerId],c)}updatePaintArray(n,s,c,f,y,w){this._setPaintValues(n,s,c.patterns&&c.patterns[this.layerId],w)}_setPaintValues(n,s,c,f){if(!f||!c)return;const y=f[c];if(!y)return;const{tl:w,br:E,pixelRatio:A}=y;for(let I=n;I<s;I++)this.paintVertexArray.emplace(I,w[0],w[1],E[0],E[1],A)}upload(n){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=n.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class kl{constructor(n,s,c=(()=>!0)){this.binders={},this._buffers=[];const f=[];for(const y in n.paint._values){if(!c(y))continue;const w=n.paint.get(y);if(!(w instanceof de&&yl(w.property.specification)))continue;const E=x_(y,n.type),A=w.value,I=w.property.specification.type,j=!!w.property.useIntegerZoom,V=y==="line-dasharray"||y.endsWith("pattern"),U=y==="line-dasharray"&&n.layout.get("line-cap").value.kind!=="constant";if(A.kind!=="constant"||U)if(A.kind==="source"||U||V){const q=cg(y,I,"source");this.binders[y]=V?new Ga(A,E,I,q,n.id):new Zo(A,E,I,q),f.push(`/a_${y}`)}else{const q=cg(y,I,"composite");this.binders[y]=new Xo(A,E,I,j,s,q),f.push(`/z_${y}`)}else this.binders[y]=V?new Cl(A.value,E):new Cd(A.value,E,I),f.push(`/u_${y}`)}this.cacheKey=f.sort().join("")}getMaxValue(n){const s=this.binders[n];return s instanceof Zo||s instanceof Xo?s.maxValue:0}populatePaintArrays(n,s,c,f,y,w){for(const E in this.binders){const A=this.binders[E];(A instanceof Zo||A instanceof Xo||A instanceof Ga)&&A.populatePaintArray(n,s,c,f,y,w)}}setConstantPatternPositions(n){for(const s in this.binders){const c=this.binders[s];c instanceof Cl&&c.setConstantPatternPositions(n)}}updatePaintArrays(n,s,c,f,y,w){let E=!1;for(const A in n){const I=s.getPositions(A);for(const j of I){const V=c.feature(j.index);for(const U in this.binders){const q=this.binders[U];if((q instanceof Zo||q instanceof Xo||q instanceof Ga)&&q.expression.isStateDependent===!0){const X=f.paint.get(U);q.expression=X.value,q.updatePaintArray(j.start,j.end,V,n[A],y,w),E=!0}}}}return E}defines(){const n=[];for(const s in this.binders){const c=this.binders[s];(c instanceof Cd||c instanceof Cl)&&n.push(...c.uniformNames.map((f=>`#define HAS_UNIFORM_${f}`)))}return n}getBinderAttributes(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Zo||c instanceof Xo||c instanceof Ga)for(let f=0;f<c.paintVertexAttributes.length;f++)n.push(c.paintVertexAttributes[f].name)}return n}getBinderUniforms(){const n=[];for(const s in this.binders){const c=this.binders[s];if(c instanceof Cd||c instanceof Cl||c instanceof Xo)for(const f of c.uniformNames)n.push(f)}return n}getPaintVertexBuffers(){return this._buffers}getUniforms(n){const s=[];for(const c in this.binders){const f=this.binders[c];if(f instanceof Cd||f instanceof Cl||f instanceof Xo)for(const y of f.uniformNames)s.push({name:y,property:c,binding:f.getBinding(n,y)})}return s}setUniforms(n,s,c,f,y){for(const{name:w,property:E,binding:A}of c)this.binders[E].setUniform(n,A,y,f.get(E),w)}updatePaintBuffers(){this._buffers=[];for(const n in this.binders){const s=this.binders[n];(s instanceof Zo||s instanceof Xo||s instanceof Ga)&&s.paintVertexBuffer&&this._buffers.push(s.paintVertexBuffer)}}upload(n){for(const s in this.binders){const c=this.binders[s];(c instanceof Zo||c instanceof Xo||c instanceof Ga)&&c.upload(n)}this.updatePaintBuffers()}destroy(){for(const n in this.binders){const s=this.binders[n];(s instanceof Zo||s instanceof Xo||s instanceof Ga)&&s.destroy()}}}class Sc{constructor(n,s,c=(()=>!0)){this.programConfigurations={};for(const f of n)this.programConfigurations[f.id]=new kl(f,s,c);this.needsUpload=!1,this._featureMap=new Tc,this._bufferOffset=0}populatePaintArrays(n,s,c,f,y,w,E){for(const A in this.programConfigurations)this.programConfigurations[A].populatePaintArrays(n,s,f,y,w,E);s.id!==void 0&&this._featureMap.add(s.id,c,this._bufferOffset,n),this._bufferOffset=n,this.needsUpload=!0}updatePaintArrays(n,s,c,f,y){for(const w of c)this.needsUpload=this.programConfigurations[w.id].updatePaintArrays(n,this._featureMap,s,w,f,y)||this.needsUpload}get(n){return this.programConfigurations[n]}upload(n){if(this.needsUpload){for(const s in this.programConfigurations)this.programConfigurations[s].upload(n);this.needsUpload=!1}}destroy(){for(const n in this.programConfigurations)this.programConfigurations[n].destroy()}}const __={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio"],"fill-pattern":["pattern","pixel_ratio"],"fill-extrusion-pattern":["pattern","pixel_ratio"],"line-dasharray":["dash"]};function x_(i,n){return __[i]||[i.replace(`${n}-`,"").replace(/-/g,"_")]}const lg={"line-pattern":{source:Ke,composite:Ke},"fill-pattern":{source:Ke,composite:Ke},"fill-extrusion-pattern":{source:Ke,composite:Ke},"line-dasharray":{source:lt,composite:lt}},v_={color:{source:lo,composite:Et},number:{source:or,composite:lo}};function cg(i,n,s){const c=lg[i];return c&&c[s]||v_[n][s]}Ft(Cd,"ConstantBinder"),Ft(Cl,"PatternConstantBinder"),Ft(Zo,"SourceExpressionBinder"),Ft(Ga,"PatternCompositeBinder"),Ft(Xo,"CompositeExpressionBinder"),Ft(kl,"ProgramConfiguration",{omit:["_buffers"]}),Ft(Sc,"ProgramConfigurationSet");const ug="-transition";class ma extends xs{constructor(n,s){if(super(),this.id=n.id,this.type=n.type,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,n.type!=="custom"&&(this.metadata=n.metadata,this.minzoom=n.minzoom,this.maxzoom=n.maxzoom,n.type!=="background"&&n.type!=="sky"&&(this.source=n.source,this.sourceLayer=n["source-layer"],this.filter=n.filter),s.layout&&(this._unevaluatedLayout=new fe(s.layout)),s.paint)){this._transitionablePaint=new J(s.paint);for(const c in n.paint)this.setPaintProperty(c,n.paint[c],{validate:!1});for(const c in n.layout)this.setLayoutProperty(c,n.layout[c],{validate:!1});this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new me(s.paint)}}getLayoutProperty(n){return n==="visibility"?this.visibility:this._unevaluatedLayout.getValue(n)}setLayoutProperty(n,s,c={}){s!=null&&this._validate(bl,`layers.${this.id}.layout.${n}`,n,s,c)||(n!=="visibility"?this._unevaluatedLayout.setValue(n,s):this.visibility=s)}getPaintProperty(n){return Cn(n,ug)?this._transitionablePaint.getTransition(n.slice(0,-11)):this._transitionablePaint.getValue(n)}setPaintProperty(n,s,c={}){if(s!=null&&this._validate(Cs,`layers.${this.id}.paint.${n}`,n,s,c))return!1;if(Cn(n,ug))return this._transitionablePaint.setTransition(n.slice(0,-11),s||void 0),!1;{const f=this._transitionablePaint._values[n],y=f.value.isDataDriven(),w=f.value;this._transitionablePaint.setValue(n,s),this._handleSpecialPaintPropertyUpdate(n);const E=this._transitionablePaint._values[n].value,A=E.isDataDriven(),I=Cn(n,"pattern")||n==="line-dasharray";return A||y||I||this._handleOverridablePaintPropertyUpdate(n,w,E)}}_handleSpecialPaintPropertyUpdate(n){}getProgramIds(){return null}getProgramConfiguration(n){return null}_handleOverridablePaintPropertyUpdate(n,s,c){return!1}isHidden(n){return!!(this.minzoom&&n<this.minzoom)||!!(this.maxzoom&&n>=this.maxzoom)||this.visibility==="none"}updateTransitions(n){this._transitioningPaint=this._transitionablePaint.transitioned(n,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(n,s){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(n,void 0,s)),this.paint=this._transitioningPaint.possiblyEvaluate(n,void 0,s)}serialize(){const n={id:this.id,type:this.type,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()};return this.visibility&&(n.layout=n.layout||{},n.layout.visibility=this.visibility),mr(n,((s,c)=>!(s===void 0||c==="layout"&&!Object.keys(s).length||c==="paint"&&!Object.keys(s).length)))}_validate(n,s,c,f,y={}){return(!y||y.validate!==!1)&&as(this,n.call(Ui,{key:s,layerType:this.type,objectKey:c,value:f,styleSpec:dt,style:{glyphs:!0,sprite:!0}}))}is3D(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}resize(){}isStateDependent(){for(const n in this.paint._values){const s=this.paint.get(n);if(s instanceof de&&yl(s.property.specification)&&(s.value.kind==="source"||s.value.kind==="composite")&&s.value.isStateDependent)return!0}return!1}compileFilter(){this._filterCompiled||(this._featureFilter=gc(this.filter),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}}const w_=Ue([{name:"a_pos",components:2,type:"Int16"}],4),_0=Ue([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class oi{constructor(n=[]){this.segments=n}prepareSegment(n,s,c,f){let y=this.segments[this.segments.length-1];return n>oi.MAX_VERTEX_ARRAY_LENGTH&&Xn(`Max vertices per segment is ${oi.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${n}`),(!y||y.vertexLength+n>oi.MAX_VERTEX_ARRAY_LENGTH||y.sortKey!==f)&&(y={vertexOffset:s.length,primitiveOffset:c.length,vertexLength:0,primitiveLength:0},f!==void 0&&(y.sortKey=f),this.segments.push(y)),y}get(){return this.segments}destroy(){for(const n of this.segments)for(const s in n.vaos)n.vaos[s].destroy()}static simpleSegment(n,s,c,f){return new oi([{vertexOffset:n,primitiveOffset:s,vertexLength:c,primitiveLength:f,vaos:{},sortKey:0}])}}oi.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,Ft(oi,"SegmentVector");var an=8192;class Al{constructor(n,s){n&&(s?this.setSouthWest(n).setNorthEast(s):n.length===4?this.setSouthWest([n[0],n[1]]).setNorthEast([n[2],n[3]]):this.setSouthWest(n[0]).setNorthEast(n[1]))}setNorthEast(n){return this._ne=n instanceof dn?new dn(n.lng,n.lat):dn.convert(n),this}setSouthWest(n){return this._sw=n instanceof dn?new dn(n.lng,n.lat):dn.convert(n),this}extend(n){const s=this._sw,c=this._ne;let f,y;if(n instanceof dn)f=n,y=n;else{if(!(n instanceof Al))return Array.isArray(n)?n.length===4||n.every(Array.isArray)?this.extend(Al.convert(n)):this.extend(dn.convert(n)):typeof n=="object"&&n!==null&&n.hasOwnProperty("lat")&&(n.hasOwnProperty("lon")||n.hasOwnProperty("lng"))?this.extend(dn.convert(n)):this;if(f=n._sw,y=n._ne,!f||!y)return this}return s||c?(s.lng=Math.min(f.lng,s.lng),s.lat=Math.min(f.lat,s.lat),c.lng=Math.max(y.lng,c.lng),c.lat=Math.max(y.lat,c.lat)):(this._sw=new dn(f.lng,f.lat),this._ne=new dn(y.lng,y.lat)),this}getCenter(){return new dn((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new dn(this.getWest(),this.getNorth())}getSouthEast(){return new dn(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(n){const{lng:s,lat:c}=dn.convert(n);let f=this._sw.lng<=s&&s<=this._ne.lng;return this._sw.lng>this._ne.lng&&(f=this._sw.lng>=s&&s>=this._ne.lng),this._sw.lat<=c&&c<=this._ne.lat&&f}static convert(n){return!n||n instanceof Al?n:new Al(n)}}var sf=1e-6,ls=typeof Float32Array<"u"?Float32Array:Array;function b_(){var i=new ls(9);return ls!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[5]=0,i[6]=0,i[7]=0),i[0]=1,i[4]=1,i[8]=1,i}function T_(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=s[0],q=s[1],X=s[2],te=s[3],ae=s[4],ge=s[5],Ce=s[6],ye=s[7],Ee=s[8];return i[0]=U*c+q*w+X*I,i[1]=U*f+q*E+X*j,i[2]=U*y+q*A+X*V,i[3]=te*c+ae*w+ge*I,i[4]=te*f+ae*E+ge*j,i[5]=te*y+ae*A+ge*V,i[6]=Ce*c+ye*w+Ee*I,i[7]=Ce*f+ye*E+Ee*j,i[8]=Ce*y+ye*A+Ee*V,i}function ga(i){return i[0]=1,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=1,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=1,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ko(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=n[4],E=n[5],A=n[6],I=n[7],j=n[8],V=n[9],U=n[10],q=n[11],X=n[12],te=n[13],ae=n[14],ge=n[15],Ce=s*E-c*w,ye=s*A-f*w,Ee=s*I-y*w,Re=c*A-f*E,Me=c*I-y*E,Qe=f*I-y*A,Xe=j*te-V*X,ft=j*ae-U*X,It=j*ge-q*X,nt=V*ae-U*te,yt=V*ge-q*te,_t=U*ge-q*ae,Ct=Ce*_t-ye*yt+Ee*nt+Re*It-Me*ft+Qe*Xe;return Ct?(i[0]=(E*_t-A*yt+I*nt)*(Ct=1/Ct),i[1]=(f*yt-c*_t-y*nt)*Ct,i[2]=(te*Qe-ae*Me+ge*Re)*Ct,i[3]=(U*Me-V*Qe-q*Re)*Ct,i[4]=(A*It-w*_t-I*ft)*Ct,i[5]=(s*_t-f*It+y*ft)*Ct,i[6]=(ae*Ee-X*Qe-ge*ye)*Ct,i[7]=(j*Qe-U*Ee+q*ye)*Ct,i[8]=(w*yt-E*It+I*Xe)*Ct,i[9]=(c*It-s*yt-y*Xe)*Ct,i[10]=(X*Me-te*Ee+ge*Ce)*Ct,i[11]=(V*Ee-j*Me-q*Ce)*Ct,i[12]=(E*ft-w*nt-A*Xe)*Ct,i[13]=(s*nt-c*ft+f*Xe)*Ct,i[14]=(te*ye-X*Re-ae*Ce)*Ct,i[15]=(j*Re-V*ye+U*Ce)*Ct,i):null}function Il(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=n[9],q=n[10],X=n[11],te=n[12],ae=n[13],ge=n[14],Ce=n[15],ye=s[0],Ee=s[1],Re=s[2],Me=s[3];return i[0]=ye*c+Ee*E+Re*V+Me*te,i[1]=ye*f+Ee*A+Re*U+Me*ae,i[2]=ye*y+Ee*I+Re*q+Me*ge,i[3]=ye*w+Ee*j+Re*X+Me*Ce,i[4]=(ye=s[4])*c+(Ee=s[5])*E+(Re=s[6])*V+(Me=s[7])*te,i[5]=ye*f+Ee*A+Re*U+Me*ae,i[6]=ye*y+Ee*I+Re*q+Me*ge,i[7]=ye*w+Ee*j+Re*X+Me*Ce,i[8]=(ye=s[8])*c+(Ee=s[9])*E+(Re=s[10])*V+(Me=s[11])*te,i[9]=ye*f+Ee*A+Re*U+Me*ae,i[10]=ye*y+Ee*I+Re*q+Me*ge,i[11]=ye*w+Ee*j+Re*X+Me*Ce,i[12]=(ye=s[12])*c+(Ee=s[13])*E+(Re=s[14])*V+(Me=s[15])*te,i[13]=ye*f+Ee*A+Re*U+Me*ae,i[14]=ye*y+Ee*I+Re*q+Me*ge,i[15]=ye*w+Ee*j+Re*X+Me*Ce,i}function Ec(i,n,s){var c,f,y,w,E,A,I,j,V,U,q,X,te=s[0],ae=s[1],ge=s[2];return n===i?(i[12]=n[0]*te+n[4]*ae+n[8]*ge+n[12],i[13]=n[1]*te+n[5]*ae+n[9]*ge+n[13],i[14]=n[2]*te+n[6]*ae+n[10]*ge+n[14],i[15]=n[3]*te+n[7]*ae+n[11]*ge+n[15]):(f=n[1],y=n[2],w=n[3],E=n[4],A=n[5],I=n[6],j=n[7],V=n[8],U=n[9],q=n[10],X=n[11],i[0]=c=n[0],i[1]=f,i[2]=y,i[3]=w,i[4]=E,i[5]=A,i[6]=I,i[7]=j,i[8]=V,i[9]=U,i[10]=q,i[11]=X,i[12]=c*te+E*ae+V*ge+n[12],i[13]=f*te+A*ae+U*ge+n[13],i[14]=y*te+I*ae+q*ge+n[14],i[15]=w*te+j*ae+X*ge+n[15]),i}function Cc(i,n,s){var c=s[0],f=s[1],y=s[2];return i[0]=n[0]*c,i[1]=n[1]*c,i[2]=n[2]*c,i[3]=n[3]*c,i[4]=n[4]*f,i[5]=n[5]*f,i[6]=n[6]*f,i[7]=n[7]*f,i[8]=n[8]*y,i[9]=n[9]*y,i[10]=n[10]*y,i[11]=n[11]*y,i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15],i}function Ip(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[4],w=n[5],E=n[6],A=n[7],I=n[8],j=n[9],V=n[10],U=n[11];return n!==i&&(i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[3],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[4]=y*f+I*c,i[5]=w*f+j*c,i[6]=E*f+V*c,i[7]=A*f+U*c,i[8]=I*f-y*c,i[9]=j*f-w*c,i[10]=V*f-E*c,i[11]=U*f-A*c,i}function of(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[0],w=n[1],E=n[2],A=n[3],I=n[8],j=n[9],V=n[10],U=n[11];return n!==i&&(i[4]=n[4],i[5]=n[5],i[6]=n[6],i[7]=n[7],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*f-I*c,i[1]=w*f-j*c,i[2]=E*f-V*c,i[3]=A*f-U*c,i[8]=y*c+I*f,i[9]=w*c+j*f,i[10]=E*c+V*f,i[11]=A*c+U*f,i}function Mp(i,n){return i[0]=n[0],i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=n[1],i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=n[2],i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i}function ku(i,n,s){var c,f,y,w=s[0],E=s[1],A=s[2],I=Math.hypot(w,E,A);return I<sf?null:(w*=I=1/I,E*=I,A*=I,c=Math.sin(n),f=Math.cos(n),i[0]=w*w*(y=1-f)+f,i[1]=E*w*y+A*c,i[2]=A*w*y-E*c,i[3]=0,i[4]=w*E*y-A*c,i[5]=E*E*y+f,i[6]=A*E*y+w*c,i[7]=0,i[8]=w*A*y+E*c,i[9]=E*A*y-w*c,i[10]=A*A*y+f,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i)}Math.hypot||(Math.hypot=function(){for(var i=0,n=arguments.length;n--;)i+=arguments[n]*arguments[n];return Math.sqrt(i)});var dg=Il;function af(){var i=new ls(3);return ls!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i}function S_(i){var n=new ls(3);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n}function kd(i){return Math.hypot(i[0],i[1],i[2])}function Au(i,n,s){var c=new ls(3);return c[0]=i,c[1]=n,c[2]=s,c}function Ha(i,n,s){return i[0]=n[0]+s[0],i[1]=n[1]+s[1],i[2]=n[2]+s[2],i}function Pp(i,n,s){return i[0]=n[0]-s[0],i[1]=n[1]-s[1],i[2]=n[2]-s[2],i}function hg(i,n,s){return i[0]=n[0]*s[0],i[1]=n[1]*s[1],i[2]=n[2]*s[2],i}function lf(i,n,s){return i[0]=Math.min(n[0],s[0]),i[1]=Math.min(n[1],s[1]),i[2]=Math.min(n[2],s[2]),i}function Ki(i,n,s){return i[0]=Math.max(n[0],s[0]),i[1]=Math.max(n[1],s[1]),i[2]=Math.max(n[2],s[2]),i}function zr(i,n,s){return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i}function Ad(i,n,s,c){return i[0]=n[0]+s[0]*c,i[1]=n[1]+s[1]*c,i[2]=n[2]+s[2]*c,i}function cs(i,n){var s=n[0],c=n[1],f=n[2],y=s*s+c*c+f*f;return y>0&&(y=1/Math.sqrt(y)),i[0]=n[0]*y,i[1]=n[1]*y,i[2]=n[2]*y,i}function Ao(i,n){return i[0]*n[0]+i[1]*n[1]+i[2]*n[2]}function Rp(i,n,s){var c=n[0],f=n[1],y=n[2],w=s[0],E=s[1],A=s[2];return i[0]=f*A-y*E,i[1]=y*w-c*A,i[2]=c*E-f*w,i}function Hr(i,n,s){var c=n[0],f=n[1],y=n[2],w=s[3]*c+s[7]*f+s[11]*y+s[15];return i[0]=(s[0]*c+s[4]*f+s[8]*y+s[12])/(w=w||1),i[1]=(s[1]*c+s[5]*f+s[9]*y+s[13])/w,i[2]=(s[2]*c+s[6]*f+s[10]*y+s[14])/w,i}function Np(i,n,s){var c=s[0],f=s[1],y=s[2],w=n[0],E=n[1],A=n[2],I=f*A-y*E,j=y*w-c*A,V=c*E-f*w,U=f*V-y*j,q=y*I-c*V,X=c*j-f*I,te=2*s[3];return j*=te,V*=te,q*=2,X*=2,i[0]=w+(I*=te)+(U*=2),i[1]=E+j+q,i[2]=A+V+X,i}var Id,Io=Pp,E_=hg,C_=kd;function Dp(i,n,s){return i[0]=n[0]*s,i[1]=n[1]*s,i[2]=n[2]*s,i[3]=n[3]*s,i}function Lp(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=s*s+c*c+f*f+y*y;return w>0&&(w=1/Math.sqrt(w)),i[0]=s*w,i[1]=c*w,i[2]=f*w,i[3]=y*w,i}function kc(i,n,s){var c=n[0],f=n[1],y=n[2],w=n[3];return i[0]=s[0]*c+s[4]*f+s[8]*y+s[12]*w,i[1]=s[1]*c+s[5]*f+s[9]*y+s[13]*w,i[2]=s[2]*c+s[6]*f+s[10]*y+s[14]*w,i[3]=s[3]*c+s[7]*f+s[11]*y+s[15]*w,i}function jp(){var i=new ls(4);return ls!=Float32Array&&(i[0]=0,i[1]=0,i[2]=0),i[3]=1,i}function cf(i){return i[0]=0,i[1]=0,i[2]=0,i[3]=1,i}function k_(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A+w*E,i[1]=f*A+y*E,i[2]=y*A-f*E,i[3]=w*A-c*E,i}function fg(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A-y*E,i[1]=f*A+w*E,i[2]=y*A+c*E,i[3]=w*A-f*E,i}af(),Id=new ls(4),ls!=Float32Array&&(Id[0]=0,Id[1]=0,Id[2]=0,Id[3]=0);var pg=Lp;af(),Au(1,0,0),Au(0,1,0),jp(),jp(),b_();const A_=Ue([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:uf}=A_,Wa=Ue([{name:"a_pos_3",components:3,type:"Int16"}]);var df=Ue([{name:"a_pos",type:"Int16",components:2}]);class Op{constructor(n,s){this.pos=n,this.dir=s}intersectsPlane(n,s,c){const f=Ao(s,this.dir);if(Math.abs(f)<1e-6)return!1;const y=((n[0]-this.pos[0])*s[0]+(n[1]-this.pos[1])*s[1]+(n[2]-this.pos[2])*s[2])/f;return c[0]=this.pos[0]+this.dir[0]*y,c[1]=this.pos[1]+this.dir[1]*y,c[2]=this.pos[2]+this.dir[2]*y,!0}closestPointOnSphere(n,s,c){if((function(q,X){var te=q[0],ae=q[1],ge=q[2],Ce=X[0],ye=X[1],Ee=X[2];return Math.abs(te-Ce)<=sf*Math.max(1,Math.abs(te),Math.abs(Ce))&&Math.abs(ae-ye)<=sf*Math.max(1,Math.abs(ae),Math.abs(ye))&&Math.abs(ge-Ee)<=sf*Math.max(1,Math.abs(ge),Math.abs(Ee))})(this.pos,n)||s===0)return c[0]=c[1]=c[2]=0,!1;const[f,y,w]=this.dir,E=this.pos[0]-n[0],A=this.pos[1]-n[1],I=this.pos[2]-n[2],j=f*f+y*y+w*w,V=2*(E*f+A*y+I*w),U=V*V-4*j*(E*E+A*A+I*I-s*s);if(U<0){const q=Math.max(-V/2,0),X=E+f*q,te=A+y*q,ae=I+w*q,ge=Math.hypot(X,te,ae);return c[0]=X*s/ge,c[1]=te*s/ge,c[2]=ae*s/ge,!1}{const q=(-V-Math.sqrt(U))/(2*j);if(q<0){const X=Math.hypot(E,A,I);return c[0]=E*s/X,c[1]=A*s/X,c[2]=I*s/X,!1}return c[0]=E+f*q,c[1]=A+y*q,c[2]=I+w*q,!0}}}class hf{constructor(n,s,c,f,y){this.TL=n,this.TR=s,this.BR=c,this.BL=f,this.horizon=y}static fromInvProjectionMatrix(n,s,c){const f=[-1,1,1],y=[1,1,1],w=[1,-1,1],E=[-1,-1,1],A=Hr(f,f,n),I=Hr(y,y,n),j=Hr(w,w,n),V=Hr(E,E,n);return new hf(A,I,j,V,s/c)}}class zp{constructor(n,s){this.points=n,this.planes=s}static fromInvProjectionMatrix(n,s,c,f){const y=Math.pow(2,c),w=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map((A=>{const I=kc([],A,n),j=1/I[3]/s*y;return(function(V,U,q){return V[0]=U[0]*q[0],V[1]=U[1]*q[1],V[2]=U[2]*q[2],V[3]=U[3]*q[3],V})(I,I,[j,j,f?1/I[3]:j,j])})),E=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map((A=>{const I=cs([],Rp([],Io([],w[A[0]],w[A[1]]),Io([],w[A[2]],w[A[1]]))),j=-Ao(I,w[A[1]]);return I.concat(j)}));return new zp(w,E)}}class us{static fromPoints(n){const s=[1/0,1/0,1/0],c=[-1/0,-1/0,-1/0];for(const f of n)lf(s,s,f),Ki(c,c,f);return new us(s,c)}static applyTransform(n,s){const c=n.getCorners();for(let f=0;f<c.length;++f)Hr(c[f],c[f],s);return us.fromPoints(c)}constructor(n,s){this.min=n,this.max=s,this.center=zr([],Ha([],this.min,this.max),.5)}quadrant(n){const s=[n%2==0,n<2],c=S_(this.min),f=S_(this.max);for(let y=0;y<s.length;y++)c[y]=s[y]?this.min[y]:this.center[y],f[y]=s[y]?this.center[y]:this.max[y];return f[2]=this.max[2],new us(c,f)}distanceX(n){return Math.max(Math.min(this.max[0],n[0]),this.min[0])-n[0]}distanceY(n){return Math.max(Math.min(this.max[1],n[1]),this.min[1])-n[1]}distanceZ(n){return Math.max(Math.min(this.max[2],n[2]),this.min[2])-n[2]}getCorners(){const n=this.min,s=this.max;return[[n[0],n[1],n[2]],[s[0],n[1],n[2]],[s[0],s[1],n[2]],[n[0],s[1],n[2]],[n[0],n[1],s[2]],[s[0],n[1],s[2]],[s[0],s[1],s[2]],[n[0],s[1],s[2]]]}intersects(n){const s=this.getCorners();let c=!0;for(let f=0;f<n.planes.length;f++){const y=n.planes[f];let w=0;for(let E=0;E<s.length;E++)w+=Ao(y,s[E])+y[3]>=0;if(w===0)return 0;w!==s.length&&(c=!1)}if(c)return 2;for(let f=0;f<3;f++){let y=Number.MAX_VALUE,w=-Number.MAX_VALUE;for(let E=0;E<n.points.length;E++){const A=n.points[E][f]-this.min[f];y=Math.min(y,A),w=Math.max(w,A)}if(w<0||y>this.max[f]-this.min[f])return 0}return 1}}const Iu=5,ds=6,qa=an/Math.PI/2,x0=16383,Za=64,Li=[Za,32,16],Ko=-qa,Yt=qa,Md=[new us([Ko,Ko,Ko],[Yt,Yt,Yt]),new us([Ko,Ko,Ko],[0,0,Yt]),new us([0,Ko,Ko],[Yt,0,Yt]),new us([Ko,0,Ko],[0,Yt,Yt]),new us([0,0,Ko],[Yt,Yt,Yt])];function Pd(i){return i*qa/Ac}function mg(i,n,s,c=!0){const f=zr([],i._camera.position,i.worldSize),y=[n,s,1,1];kc(y,y,i.pixelMatrixInverse),Dp(y,y,1/y[3]);const w=cs([],Io([],y,f)),E=i.globeMatrix,A=[E[12],E[13],E[14]],I=Io([],A,f),j=kd(I),V=cs([],I),U=i.worldSize/(2*Math.PI),q=Ao(V,w),X=Math.asin(U/j);if(X<Math.acos(q)){if(!c)return null;const It=[],nt=[];zr(It,w,j/q),cs(nt,Io(nt,It,I)),cs(w,Ha(w,I,zr(w,nt,Math.tan(X)*j)))}const te=[];new Op(f,w).closestPointOnSphere(A,U,te);const ae=cs([],Ms(E,0)),ge=cs([],Ms(E,1)),Ce=cs([],Ms(E,2)),ye=Ao(ae,te),Ee=Ao(ge,te),Re=Ao(Ce,te),Me=ht(Math.asin(-Ee/U));let Qe=ht(Math.atan2(ye,Re));Qe=i.center.lng+(function(It,nt){const yt=(nt-It+180)%360-180;return yt<-180?yt+360:yt})(i.center.lng,Qe);const Xe=kr(Qe),ft=xe(Fr(Me),0,1);return new Ic(Xe,ft)}class v0{constructor(n,s,c){this.a=Io([],n,c),this.b=Io([],s,c),this.center=c;const f=cs([],this.a),y=cs([],this.b);this.angle=Math.acos(Ao(f,y))}}function Mu(i,n){if(i.angle===0)return null;let s;return s=i.a[n]===0?1/i.angle*.5*Math.PI:1/i.angle*Math.atan(i.b[n]/i.a[n]/Math.sin(i.angle)-1/Math.tan(i.angle)),s<0||s>1?null:(function(c,f,y,w){const E=Math.sin(y);return c*(Math.sin((1-w)*y)/E)+f*(Math.sin(w*y)/E)})(i.a[n],i.b[n],i.angle,xe(s,0,1))+i.center[n]}function Mo(i){if(i.z<=1)return Md[i.z+2*i.y+i.x];const n=ff(Rd(i));return us.fromPoints(n)}function Ml(i,n,s){return zr(i,i,1-s),Ad(i,i,n,s)}function gg(i,n){const s=Nd(n.zoom);if(s===0)return Mo(i);const c=Rd(i),f=ff(c),y=kr(c.getWest())*n.worldSize,w=kr(c.getEast())*n.worldSize,E=Fr(c.getNorth())*n.worldSize,A=Fr(c.getSouth())*n.worldSize,I=[y,E,0],j=[w,E,0],V=[y,A,0],U=[w,A,0],q=ko([],n.globeMatrix);return Hr(I,I,q),Hr(j,j,q),Hr(V,V,q),Hr(U,U,q),f[0]=Ml(f[0],V,s),f[1]=Ml(f[1],U,s),f[2]=Ml(f[2],j,s),f[3]=Ml(f[3],I,s),us.fromPoints(f)}function yg(i,n,s){for(const c of i)Hr(c,c,n),zr(c,c,s)}function I_(i,n,s){const c=n/i.worldSize,f=i.globeMatrix;if(s.z<=1){const Xe=Mo(s).getCorners();return yg(Xe,f,c),us.fromPoints(Xe)}const y=Rd(s),w=ff(y);yg(w,f,c);const E=Number.MAX_VALUE,A=[-E,-E,-E],I=[E,E,E];if(y.contains(i.center)){for(const It of w)lf(I,I,It),Ki(A,A,It);A[2]=0;const Xe=i.point,ft=[Xe.x*c,Xe.y*c,0];return lf(I,I,ft),Ki(A,A,ft),new us(I,A)}const j=[f[12]*c,f[13]*c,f[14]*c],V=y.getCenter(),U=xe(i.center.lat,-Yr,Yr),q=xe(V.lat,-Yr,Yr),X=kr(i.center.lng),te=Fr(U);let ae=X-kr(V.lng);const ge=te-Fr(q);ae>.5?ae-=1:ae<-.5&&(ae+=1);let Ce=0;Math.abs(ae)>Math.abs(ge)?Ce=ae>=0?1:3:(Ce=ge>=0?0:2,Ad(j,j,[f[4]*c,f[5]*c,f[6]*c],-Math.sin(gt(ge>=0?y.getSouth():y.getNorth()))*qa));const ye=w[Ce],Ee=w[(Ce+1)%4],Re=new v0(ye,Ee,j),Me=[Mu(Re,0)||ye[0],Mu(Re,1)||ye[1],Mu(Re,2)||ye[2]],Qe=Nd(i.zoom);if(Qe>0){const Xe=(function({x:It,y:nt,z:yt},_t,Ct,Pt,ct){const Bt=1/(1<<yt);let Jt=It*Bt,$t=Jt+Bt,Nn=nt*Bt,Nt=Nn+Bt,cn=0;const Dn=(Jt+$t)/2-Pt;return Dn>.5?cn=-1:Dn<-.5&&(cn=1),Jt=((Jt+cn)*_t-(Pt*=_t))*Ct+Pt,$t=(($t+cn)*_t-Pt)*Ct+Pt,Nn=(Nn*_t-(ct*=_t))*Ct+ct,Nt=(Nt*_t-ct)*Ct+ct,[[Jt,Nt,0],[$t,Nt,0],[$t,Nn,0],[Jt,Nn,0]]})(s,n,i._pixelsPerMercatorPixel,X,te);for(let It=0;It<w.length;It++)Ml(w[It],Xe[It],Qe);const ft=Ha([],Xe[Ce],Xe[(Ce+1)%4]);zr(ft,ft,.5),Ml(Me,ft,Qe)}for(const Xe of w)lf(I,I,Xe),Ki(A,A,Xe);return I[2]=Math.min(ye[2],Ee[2]),lf(I,I,Me),Ki(A,A,Me),new us(I,A)}function Rd({x:i,y:n,z:s}){const c=1/(1<<s),f=new dn(Yi(i*c),ar((n+1)*c)),y=new dn(Yi((i+1)*c),ar(n*c));return new Al(f,y)}function ff(i){const n=gt(i.getNorth()),s=gt(i.getSouth()),c=Math.cos(n),f=Math.cos(s),y=Math.sin(n),w=Math.sin(s),E=i.getWest(),A=i.getEast();return[pi(f,w,E),pi(f,w,A),pi(c,y,A),pi(c,y,E)]}function pi(i,n,s,c=qa){return s=gt(s),[i*Math.sin(s)*c,-n*c,i*Math.cos(s)*c]}function ks(i,n,s){return pi(Math.cos(gt(i)),Math.sin(gt(i)),n,s)}function Yo(i,n,s,c){const f=1<<s.z,y=(i/an+s.x)/f;return ks(ar((n/an+s.y)/f),Yi(y),c)}function pf({min:i,max:n}){return x0/Math.max(n[0]-i[0],n[1]-i[1],n[2]-i[2])}const _g=new Float64Array(16);function Us(i){const n=pf(i),s=Mp(_g,[n,n,n]);return Ec(s,s,((c=[])[0]=-(f=i.min)[0],c[1]=-f[1],c[2]=-f[2],c));var c,f}function Bp(i){const n=(c=i.min,(s=_g)[0]=1,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=1,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=1,s[11]=0,s[12]=c[0],s[13]=c[1],s[14]=c[2],s[15]=1,s);var s,c;const f=1/pf(i);return Cc(n,n,[f,f,f])}function ya(i,n,s,c,f){const y=(function(A){const I=an/(2*Math.PI);return A/(2*Math.PI)/I})(s),w=[i,n,-s/(2*Math.PI)],E=ga(new Float64Array(16));return Ec(E,E,w),Cc(E,E,[y,y,y]),Ip(E,E,gt(-f)),of(E,E,gt(-c)),E}function Nd(i){return We(Iu,ds,i)}function xg(i,n){const s=ks(n.lat,n.lng),c=(function(X){const te=ks(X._center.lat,X._center.lng);let ae=Rp([],Au(0,1,0),te);const ge=ku([],-X.angle,te);ae=Hr(ae,ae,ge),ku(ge,-X._pitch,ae);const Ce=cs([],te);return zr(Ce,Ce,Pd(X.cameraToCenterDistance/X.pixelsPerMeter)),Hr(Ce,Ce,ge),Ha([],te,Ce)})(i);return w=(f=Pp([],c,s))[0],E=f[1],A=f[2],I=(y=s)[0],j=y[1],V=y[2],q=(U=Math.sqrt(w*w+E*E+A*A)*Math.sqrt(I*I+j*j+V*V))&&Ao(f,y)/U,Math.acos(Math.min(Math.max(q,-1),1));var f,y,w,E,A,I,j,V,U,q}function Fp(i,n){return xg(i,n)>Math.PI/2*1.01}const vg=gt(85),M_=Math.cos(vg),w0=Math.sin(vg),Ac=63710088e-1,Vp=2*Math.PI*Ac;class Gi{constructor(n,s){if(isNaN(n)||isNaN(s))throw new Error(`Invalid LngLat object: (${n}, ${s})`);if(this.lng=+n,this.lat=+s,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new Gi(he(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(n){const s=Math.PI/180,c=this.lat*s,f=n.lat*s,y=Math.sin(c)*Math.sin(f)+Math.cos(c)*Math.cos(f)*Math.cos((n.lng-this.lng)*s);return Ac*Math.acos(Math.min(y,1))}toBounds(n=0){const s=360*n/40075017,c=s/Math.cos(Math.PI/180*this.lat);return new Al(new Gi(this.lng-c,this.lat-s),new Gi(this.lng+c,this.lat+s))}toEcef(n){const s=Pd(n);return ks(this.lat,this.lng,qa+s)}static convert(n){if(n instanceof Gi)return n;if(Array.isArray(n)&&(n.length===2||n.length===3))return new Gi(Number(n[0]),Number(n[1]));if(!Array.isArray(n)&&typeof n=="object"&&n!==null)return new Gi(Number("lng"in n?n.lng:n.lon),Number(n.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}var dn=Gi;function ji(i){return Vp*Math.cos(i*Math.PI/180)}function kr(i){return(180+i)/360}function Fr(i){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+i*Math.PI/360)))/360}function ai(i,n){return i/ji(n)}function Yi(i){return 360*i-180}function ar(i){return 360/Math.PI*Math.atan(Math.exp((180-360*i)*Math.PI/180))-90}function Dd(i,n){return i*ji(ar(n))}const Yr=85.051129;function mf(i){return 1/Math.cos(i*Math.PI/180)}class Ic{constructor(n,s,c=0){this.x=+n,this.y=+s,this.z=+c}static fromLngLat(n,s=0){const c=dn.convert(n);return new Ic(kr(c.lng),Fr(c.lat),ai(s,c.lat))}toLngLat(){return new dn(Yi(this.x),ar(this.y))}toAltitude(){return Dd(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/Vp*mf(ar(this.y))}}function Pu(i,n,s,c,f,y,w,E,A){const I=(n+c)/2,j=(s+f)/2,V=new Pe(I,j);E(V),(function(U,q,X,te,ae,ge){const Ce=X-ae,ye=te-ge;return Math.abs((te-q)*Ce-(X-U)*ye)/Math.hypot(Ce,ye)})(V.x,V.y,y.x,y.y,w.x,w.y)>=A?(Pu(i,n,s,I,j,y,V,E,A),Pu(i,I,j,c,f,V,w,E,A)):i.push(w)}function $s(i,n,s){let c=i[0],f=c.x,y=c.y;n(c);const w=[c];for(let E=1;E<i.length;E++){const A=i[E],{x:I,y:j}=A;n(A),Pu(w,f,y,I,j,c,A,n,s),f=I,y=j,c=A}return w}function gf(i,n,s,c){if(c(n,s)){const f=n.add(s)._mult(.5);gf(i,n,f,c),gf(i,f,s,c)}else i.push(s)}function Ld(i,n){let s=i[0];const c=[s];for(let f=1;f<i.length;f++){const y=i[f];gf(c,s,y,n),s=y}return c}const _a=Math.pow(2,14)-1,yf=-_a-1;function wg(i,n){const s=Math.round(i.x*n),c=Math.round(i.y*n);return i.x=xe(s,yf,_a),i.y=xe(c,yf,_a),(s<i.x||s>i.x+1||c<i.y||c>i.y+1)&&Xn("Geometry exceeds allowed extent, reduce your vector tile buffer size"),i}function As(i,n,s){const c=i.loadGeometry(),f=i.extent,y=an/f;if(n&&s&&s.projection.isReprojectedInTileSpace){const w=1<<n.z,{scale:E,x:A,y:I,projection:j}=s,V=U=>{const q=Yi((n.x+U.x/f)/w),X=ar((n.y+U.y/f)/w),te=j.project(q,X);U.x=(te.x*E-A)*f,U.y=(te.y*E-I)*f};for(let U=0;U<c.length;U++)if(i.type!==1)c[U]=$s(c[U],V,1);else{const q=[];for(const X of c[U])X.x<0||X.x>=f||X.y<0||X.y>=f||(V(X),q.push(X));c[U]=q}}for(const w of c)for(const E of w)wg(E,y);return c}function Xa(i,n){return{type:i.type,id:i.id,properties:i.properties,geometry:n?As(i):[]}}function xa(i,n,s,c,f){i.emplaceBack(2*n+(c+1)/2,2*s+(f+1)/2)}function Ru(i,n,s){i.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class Nu{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.projection=n.projection,this.layoutVertexArray=new kt,this.indexArray=new en,this.segments=new oi,this.programConfigurations=new Sc(n.layers,n.zoom),this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(n,s,c,f){const y=this.layers[0],w=[];let E=null;y.type==="circle"&&(E=y.layout.get("circle-sort-key"));for(const{feature:I,id:j,index:V,sourceLayerIndex:U}of n){const q=this.layers[0]._featureFilter.needGeometry,X=Xa(I,q);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),X,c))continue;const te=E?E.evaluate(X,{},c):void 0,ae={id:j,properties:I.properties,type:I.type,sourceLayerIndex:U,index:V,geometry:q?X.geometry:As(I,c,f),patterns:{},sortKey:te};w.push(ae)}E&&w.sort(((I,j)=>I.sortKey-j.sortKey));let A=null;f.projection.name==="globe"&&(this.globeExtVertexArray=new Tt,A=f.projection);for(const I of w){const{geometry:j,index:V,sourceLayerIndex:U}=I,q=n[V].feature;this.addFeature(I,j,V,s.availableImages,c,A),s.featureIndex.insert(q,j,V,U,this.index)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,w_.members),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,_0.members))),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}addFeature(n,s,c,f,y,w){for(const E of s)for(const A of E){const I=A.x,j=A.y;if(I<0||I>=an||j<0||j>=an)continue;if(w){const q=w.projectTilePoint(I,j,y),X=w.upVector(y,I,j),te=this.globeExtVertexArray;Ru(te,q,X),Ru(te,q,X),Ru(te,q,X),Ru(te,q,X)}const V=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,n.sortKey),U=V.vertexLength;xa(this.layoutVertexArray,I,j,-1,-1),xa(this.layoutVertexArray,I,j,1,-1),xa(this.layoutVertexArray,I,j,1,1),xa(this.layoutVertexArray,I,j,-1,1),this.indexArray.emplaceBack(U,U+1,U+2),this.indexArray.emplaceBack(U,U+2,U+3),V.vertexLength+=4,V.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,{},f,y)}}function Up(i,n){for(let s=0;s<i.length;s++)if(Pl(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(Pl(i,n[s]))return!0;return!!Ka(i,n)}function $p(i,n,s){return!!Pl(i,n)||!!Is(n,i,s)}function _f(i,n){if(i.length===1)return Gp(n,i[0]);for(let s=0;s<n.length;s++){const c=n[s];for(let f=0;f<c.length;f++)if(Pl(i,c[f]))return!0}for(let s=0;s<i.length;s++)if(Gp(n,i[s]))return!0;for(let s=0;s<n.length;s++)if(Ka(i,n[s]))return!0;return!1}function Gs(i,n,s){if(i.length>1){if(Ka(i,n))return!0;for(let c=0;c<n.length;c++)if(Is(n[c],i,s))return!0}for(let c=0;c<i.length;c++)if(Is(i[c],n,s))return!0;return!1}function Ka(i,n){if(i.length===0||n.length===0)return!1;for(let s=0;s<i.length-1;s++){const c=i[s],f=i[s+1];for(let y=0;y<n.length-1;y++)if(va(c,f,n[y],n[y+1]))return!0}return!1}function va(i,n,s,c){return Er(i,s,c)!==Er(n,s,c)&&Er(i,n,s)!==Er(i,n,c)}function Is(i,n,s){const c=s*s;if(n.length===1)return i.distSqr(n[0])<c;for(let f=1;f<n.length;f++)if(bg(i,n[f-1],n[f])<c)return!0;return!1}function bg(i,n,s){const c=n.distSqr(s);if(c===0)return i.distSqr(n);const f=((i.x-n.x)*(s.x-n.x)+(i.y-n.y)*(s.y-n.y))/c;return i.distSqr(f<0?n:f>1?s:s.sub(n)._mult(f)._add(n))}function Gp(i,n){let s,c,f,y=!1;for(let w=0;w<i.length;w++){s=i[w];for(let E=0,A=s.length-1;E<s.length;A=E++)c=s[E],f=s[A],c.y>n.y!=f.y>n.y&&n.x<(f.x-c.x)*(n.y-c.y)/(f.y-c.y)+c.x&&(y=!y)}return y}function Pl(i,n){let s=!1;for(let c=0,f=i.length-1;c<i.length;f=c++){const y=i[c],w=i[f];y.y>n.y!=w.y>n.y&&n.x<(w.x-y.x)*(n.y-y.y)/(w.y-y.y)+y.x&&(s=!s)}return s}function P_(i,n,s,c,f){for(const w of i)if(n<=w.x&&s<=w.y&&c>=w.x&&f>=w.y)return!0;const y=[new Pe(n,s),new Pe(n,f),new Pe(c,f),new Pe(c,s)];if(i.length>2){for(const w of y)if(Pl(i,w))return!0}for(let w=0;w<i.length-1;w++)if(Mc(i[w],i[w+1],y))return!0;return!1}function Mc(i,n,s){const c=s[0],f=s[2];if(i.x<c.x&&n.x<c.x||i.x>f.x&&n.x>f.x||i.y<c.y&&n.y<c.y||i.y>f.y&&n.y>f.y)return!1;const y=Er(i,n,s[0]);return y!==Er(i,n,s[1])||y!==Er(i,n,s[2])||y!==Er(i,n,s[3])}function Du(i,n,s){const c=n.paint.get(i).value;return c.kind==="constant"?c.value:s.programConfigurations.get(n.id).getMaxValue(i)}function jd(i){return Math.sqrt(i[0]*i[0]+i[1]*i[1])}function Pc(i,n,s,c,f){if(!n[0]&&!n[1])return i;const y=Pe.convert(n)._mult(f);s==="viewport"&&y._rotate(-c);const w=[];for(let E=0;E<i.length;E++)w.push(i[E].sub(y));return w}function Hp(i,n,s,c){const f=Pe.convert(i)._mult(c);return n==="viewport"&&f._rotate(-s),f}Ft(Nu,"CircleBucket",{omit:["layers"]});const Lu=new ve({"circle-sort-key":new le(dt.layout_circle["circle-sort-key"])});var R_={paint:new ve({"circle-radius":new le(dt.paint_circle["circle-radius"]),"circle-color":new le(dt.paint_circle["circle-color"]),"circle-blur":new le(dt.paint_circle["circle-blur"]),"circle-opacity":new le(dt.paint_circle["circle-opacity"]),"circle-translate":new Q(dt.paint_circle["circle-translate"]),"circle-translate-anchor":new Q(dt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Q(dt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Q(dt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new le(dt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new le(dt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new le(dt.paint_circle["circle-stroke-opacity"])}),layout:Lu};function Tg(i,n,s,c,f,y,w,E,A){if(y&&i.queryGeometry.isAboveHorizon)return!1;y&&(A*=i.pixelToTileUnitsFactor);const I=i.tileID.canonical,j=s.projection.upVectorScale(I,s.center.lat,s.worldSize).metersToTile;for(const V of n)for(const U of V){const q=U.add(E),X=f&&s.elevation?s.elevation.exaggeration()*f.getElevationAt(q.x,q.y,!0):0,te=s.projection.projectTilePoint(q.x,q.y,I);if(X>0){const ye=s.projection.upVector(I,q.x,q.y);te.x+=ye[0]*j*X,te.y+=ye[1]*j*X,te.z+=ye[2]*j*X}const ae=y?q:Sg(te.x,te.y,te.z,c),ge=y?i.tilespaceRays.map((ye=>T0(ye,X))):i.queryGeometry.screenGeometry,Ce=kc([],[te.x,te.y,te.z,1],c);if(!w&&y?A*=Ce[3]/s.cameraToCenterDistance:w&&!y&&(A*=s.cameraToCenterDistance/Ce[3]),y){const ye=ar((U.y/an+I.y)/(1<<I.z));A/=s.projection.pixelsPerMeter(ye,1)/ai(1,ye)}if($p(ge,ae,A))return!0}return!1}function Sg(i,n,s,c){const f=kc([],[i,n,s,1],c);return new Pe(f[0]/f[3],f[1]/f[3])}const xf=Au(0,0,0),b0=Au(0,0,1);function T0(i,n){const s=af();return xf[2]=n,i.intersectsPlane(xf,b0,s),new Pe(s[0],s[1])}class Eg extends Nu{}function Cg(i,{width:n,height:s},c,f){if(f){if(f instanceof Uint8ClampedArray)f=new Uint8Array(f.buffer);else if(f.length!==n*s*c)throw new RangeError("mismatched image size")}else f=new Uint8Array(n*s*c);return i.width=n,i.height=s,i.data=f,i}function Rc(i,n,s){const{width:c,height:f}=n;c===i.width&&f===i.height||(kg(i,n,{x:0,y:0},{x:0,y:0},{width:Math.min(i.width,c),height:Math.min(i.height,f)},s),i.width=c,i.height=f,i.data=n.data)}function kg(i,n,s,c,f,y){if(f.width===0||f.height===0)return n;if(f.width>i.width||f.height>i.height||s.x>i.width-f.width||s.y>i.height-f.height)throw new RangeError("out of range source coordinates for image copy");if(f.width>n.width||f.height>n.height||c.x>n.width-f.width||c.y>n.height-f.height)throw new RangeError("out of range destination coordinates for image copy");const w=i.data,E=n.data;for(let A=0;A<f.height;A++){const I=((s.y+A)*i.width+s.x)*y,j=((c.y+A)*n.width+c.x)*y;for(let V=0;V<f.width*y;V++)E[j+V]=w[I+V]}return n}Ft(Eg,"HeatmapBucket",{omit:["layers"]});class fo{constructor(n,s){Cg(this,n,1,s)}resize(n){Rc(this,new fo(n),1)}clone(){return new fo({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,f,y){kg(n,s,c,f,y,1)}}class Hs{constructor(n,s){Cg(this,n,4,s)}resize(n){Rc(this,new Hs(n),4)}replace(n,s){s?this.data.set(n):this.data=n instanceof Uint8ClampedArray?new Uint8Array(n.buffer):n}clone(){return new Hs({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(n,s,c,f,y){kg(n,s,c,f,y,4)}}Ft(fo,"AlphaImage"),Ft(Hs,"RGBAImage");var mi={paint:new ve({"heatmap-radius":new le(dt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new le(dt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Q(dt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new _e(dt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Q(dt.paint_heatmap["heatmap-opacity"])})};function Ag(i){const n={},s=i.resolution||256,c=i.clips?i.clips.length:1,f=i.image||new Hs({width:s,height:c}),y=(w,E,A)=>{n[i.evaluationKey]=A;const I=i.expression.evaluate(n);f.data[w+E+0]=Math.floor(255*I.r/I.a),f.data[w+E+1]=Math.floor(255*I.g/I.a),f.data[w+E+2]=Math.floor(255*I.b/I.a),f.data[w+E+3]=Math.floor(255*I.a)};if(i.clips)for(let w=0,E=0;w<c;++w,E+=4*s)for(let A=0,I=0;A<s;A++,I+=4){const j=A/(s-1),{start:V,end:U}=i.clips[w];y(E,I,V*(1-j)+U*j)}else for(let w=0,E=0;w<s;w++,E+=4)y(0,E,w/(s-1));return f}var N_={paint:new ve({"hillshade-illumination-direction":new Q(dt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Q(dt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Q(dt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Q(dt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Q(dt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Q(dt.paint_hillshade["hillshade-accent-color"])})};const S0=Ue([{name:"a_pos",components:2,type:"Int16"}],4),{members:E0}=S0;var Wp={exports:{}};function vf(i,n,s){s=s||2;var c,f,y,w,E,A,I,j=n&&n.length,V=j?n[0]*s:i.length,U=D_(i,0,V,s,!0),q=[];if(!U||U.next===U.prev)return q;if(j&&(U=(function(te,ae,ge,Ce){var ye,Ee,Re,Me=[];for(ye=0,Ee=ae.length;ye<Ee;ye++)(Re=D_(te,ae[ye]*Ce,ye<Ee-1?ae[ye+1]*Ce:te.length,Ce,!1))===Re.next&&(Re.steiner=!0),Me.push(Rg(Re));for(Me.sort(Zp),ye=0;ye<Me.length;ye++)ge=Ig(Me[ye],ge);return ge})(i,n,U,s)),i.length>80*s){c=y=i[0],f=w=i[1];for(var X=s;X<V;X+=s)(E=i[X])<c&&(c=E),(A=i[X+1])<f&&(f=A),E>y&&(y=E),A>w&&(w=A);I=(I=Math.max(y-c,w-f))!==0?32767/I:0}return ju(U,q,s,c,f,I,0),q}function D_(i,n,s,c,f){var y,w;if(f===Bd(i,n,s,c)>0)for(y=n;y<s;y+=c)w=Xp(y,i[y],i[y+1],w);else for(y=s-c;y>=n;y-=c)w=Xp(y,i[y],i[y+1],w);return w&&zu(w,w.next)&&(Dc(w),w=w.next),w}function Ji(i,n){if(!i)return i;n||(n=i);var s,c=i;do if(s=!1,c.steiner||!zu(c,c.next)&&Jr(c.prev,c,c.next)!==0)c=c.next;else{if(Dc(c),(c=n=c.prev)===c.next)break;s=!0}while(s||c!==n);return n}function ju(i,n,s,c,f,y,w){if(i){!w&&y&&(function(j,V,U,q){var X=j;do X.z===0&&(X.z=Pg(X.x,X.y,V,U,q)),X.prevZ=X.prev,X.nextZ=X.next,X=X.next;while(X!==j);X.prevZ.nextZ=null,X.prevZ=null,(function(te){var ae,ge,Ce,ye,Ee,Re,Me,Qe,Xe=1;do{for(ge=te,te=null,Ee=null,Re=0;ge;){for(Re++,Ce=ge,Me=0,ae=0;ae<Xe&&(Me++,Ce=Ce.nextZ);ae++);for(Qe=Xe;Me>0||Qe>0&&Ce;)Me!==0&&(Qe===0||!Ce||ge.z<=Ce.z)?(ye=ge,ge=ge.nextZ,Me--):(ye=Ce,Ce=Ce.nextZ,Qe--),Ee?Ee.nextZ=ye:te=ye,ye.prevZ=Ee,Ee=ye;ge=Ce}Ee.nextZ=null,Xe*=2}while(Re>1)})(X)})(i,c,f,y);for(var E,A,I=i;i.prev!==i.next;)if(E=i.prev,A=i.next,y?Nc(i,c,f,y):C0(i))n.push(E.i/s|0),n.push(i.i/s|0),n.push(A.i/s|0),Dc(i),i=A.next,I=A.next;else if((i=A)===I){w?w===1?ju(i=qp(Ji(i),n,s),n,s,c,f,y,2):w===2&&Ou(i,n,s,c,f,y):ju(Ji(i),n,s,c,f,y,1);break}}}function C0(i){var n=i.prev,s=i,c=i.next;if(Jr(n,s,c)>=0)return!1;for(var f=n.x,y=s.x,w=c.x,E=n.y,A=s.y,I=c.y,j=f<y?f<w?f:w:y<w?y:w,V=E<A?E<I?E:I:A<I?A:I,U=f>y?f>w?f:w:y>w?y:w,q=E>A?E>I?E:I:A>I?A:I,X=c.next;X!==n;){if(X.x>=j&&X.x<=U&&X.y>=V&&X.y<=q&&Od(f,E,y,A,w,I,X.x,X.y)&&Jr(X.prev,X,X.next)>=0)return!1;X=X.next}return!0}function Nc(i,n,s,c){var f=i.prev,y=i,w=i.next;if(Jr(f,y,w)>=0)return!1;for(var E=f.x,A=y.x,I=w.x,j=f.y,V=y.y,U=w.y,q=E<A?E<I?E:I:A<I?A:I,X=j<V?j<U?j:U:V<U?V:U,te=E>A?E>I?E:I:A>I?A:I,ae=j>V?j>U?j:U:V>U?V:U,ge=Pg(q,X,n,s,c),Ce=Pg(te,ae,n,s,c),ye=i.prevZ,Ee=i.nextZ;ye&&ye.z>=ge&&Ee&&Ee.z<=Ce;){if(ye.x>=q&&ye.x<=te&&ye.y>=X&&ye.y<=ae&&ye!==f&&ye!==w&&Od(E,j,A,V,I,U,ye.x,ye.y)&&Jr(ye.prev,ye,ye.next)>=0||(ye=ye.prevZ,Ee.x>=q&&Ee.x<=te&&Ee.y>=X&&Ee.y<=ae&&Ee!==f&&Ee!==w&&Od(E,j,A,V,I,U,Ee.x,Ee.y)&&Jr(Ee.prev,Ee,Ee.next)>=0))return!1;Ee=Ee.nextZ}for(;ye&&ye.z>=ge;){if(ye.x>=q&&ye.x<=te&&ye.y>=X&&ye.y<=ae&&ye!==f&&ye!==w&&Od(E,j,A,V,I,U,ye.x,ye.y)&&Jr(ye.prev,ye,ye.next)>=0)return!1;ye=ye.prevZ}for(;Ee&&Ee.z<=Ce;){if(Ee.x>=q&&Ee.x<=te&&Ee.y>=X&&Ee.y<=ae&&Ee!==f&&Ee!==w&&Od(E,j,A,V,I,U,Ee.x,Ee.y)&&Jr(Ee.prev,Ee,Ee.next)>=0)return!1;Ee=Ee.nextZ}return!0}function qp(i,n,s){var c=i;do{var f=c.prev,y=c.next.next;!zu(f,y)&&wf(f,c,c.next,y)&&Tf(f,y)&&Tf(y,f)&&(n.push(f.i/s|0),n.push(c.i/s|0),n.push(y.i/s|0),Dc(c),Dc(c.next),c=i=y),c=c.next}while(c!==i);return Ji(c)}function Ou(i,n,s,c,f,y){var w=i;do{for(var E=w.next.next;E!==w.prev;){if(w.i!==E.i&&L_(w,E)){var A=Ng(w,E);return w=Ji(w,w.next),A=Ji(A,A.next),ju(w,n,s,c,f,y,0),void ju(A,n,s,c,f,y,0)}E=E.next}w=w.next}while(w!==i)}function Zp(i,n){return i.x-n.x}function Ig(i,n){var s=(function(f,y){var w,E=y,A=f.x,I=f.y,j=-1/0;do{if(I<=E.y&&I>=E.next.y&&E.next.y!==E.y){var V=E.x+(I-E.y)*(E.next.x-E.x)/(E.next.y-E.y);if(V<=A&&V>j&&(j=V,w=E.x<E.next.x?E:E.next,V===A))return w}E=E.next}while(E!==y);if(!w)return null;var U,q=w,X=w.x,te=w.y,ae=1/0;E=w;do A>=E.x&&E.x>=X&&A!==E.x&&Od(I<te?A:j,I,X,te,I<te?j:A,I,E.x,E.y)&&(U=Math.abs(I-E.y)/(A-E.x),Tf(E,f)&&(U<ae||U===ae&&(E.x>w.x||E.x===w.x&&Mg(w,E)))&&(w=E,ae=U)),E=E.next;while(E!==q);return w})(i,n);if(!s)return n;var c=Ng(s,i);return Ji(c,c.next),Ji(s,s.next)}function Mg(i,n){return Jr(i.prev,i,n.prev)<0&&Jr(n.next,i,i.next)<0}function Pg(i,n,s,c,f){return(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-s)*f|0)|i<<8))|i<<4))|i<<2))|i<<1))|(n=1431655765&((n=858993459&((n=252645135&((n=16711935&((n=(n-c)*f|0)|n<<8))|n<<4))|n<<2))|n<<1))<<1}function Rg(i){var n=i,s=i;do(n.x<s.x||n.x===s.x&&n.y<s.y)&&(s=n),n=n.next;while(n!==i);return s}function Od(i,n,s,c,f,y,w,E){return(f-w)*(n-E)>=(i-w)*(y-E)&&(i-w)*(c-E)>=(s-w)*(n-E)&&(s-w)*(y-E)>=(f-w)*(c-E)}function L_(i,n){return i.next.i!==n.i&&i.prev.i!==n.i&&!(function(s,c){var f=s;do{if(f.i!==s.i&&f.next.i!==s.i&&f.i!==c.i&&f.next.i!==c.i&&wf(f,f.next,s,c))return!0;f=f.next}while(f!==s);return!1})(i,n)&&(Tf(i,n)&&Tf(n,i)&&(function(s,c){var f=s,y=!1,w=(s.x+c.x)/2,E=(s.y+c.y)/2;do f.y>E!=f.next.y>E&&f.next.y!==f.y&&w<(f.next.x-f.x)*(E-f.y)/(f.next.y-f.y)+f.x&&(y=!y),f=f.next;while(f!==s);return y})(i,n)&&(Jr(i.prev,i,n.prev)||Jr(i,n.prev,n))||zu(i,n)&&Jr(i.prev,i,i.next)>0&&Jr(n.prev,n,n.next)>0)}function Jr(i,n,s){return(n.y-i.y)*(s.x-n.x)-(n.x-i.x)*(s.y-n.y)}function zu(i,n){return i.x===n.x&&i.y===n.y}function wf(i,n,s,c){var f=zd(Jr(i,n,s)),y=zd(Jr(i,n,c)),w=zd(Jr(s,c,i)),E=zd(Jr(s,c,n));return f!==y&&w!==E||!(f!==0||!bf(i,s,n))||!(y!==0||!bf(i,c,n))||!(w!==0||!bf(s,i,c))||!(E!==0||!bf(s,n,c))}function bf(i,n,s){return n.x<=Math.max(i.x,s.x)&&n.x>=Math.min(i.x,s.x)&&n.y<=Math.max(i.y,s.y)&&n.y>=Math.min(i.y,s.y)}function zd(i){return i>0?1:i<0?-1:0}function Tf(i,n){return Jr(i.prev,i,i.next)<0?Jr(i,n,i.next)>=0&&Jr(i,i.prev,n)>=0:Jr(i,n,i.prev)<0||Jr(i,i.next,n)<0}function Ng(i,n){var s=new Sf(i.i,i.x,i.y),c=new Sf(n.i,n.x,n.y),f=i.next,y=n.prev;return i.next=n,n.prev=i,s.next=f,f.prev=s,c.next=s,s.prev=c,y.next=c,c.prev=y,c}function Xp(i,n,s,c){var f=new Sf(i,n,s);return c?(f.next=c.next,f.prev=c,c.next.prev=f,c.next=f):(f.prev=f,f.next=f),f}function Dc(i){i.next.prev=i.prev,i.prev.next=i.next,i.prevZ&&(i.prevZ.nextZ=i.nextZ),i.nextZ&&(i.nextZ.prevZ=i.prevZ)}function Sf(i,n,s){this.i=i,this.x=n,this.y=s,this.prev=null,this.next=null,this.z=0,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Bd(i,n,s,c){for(var f=0,y=n,w=s-c;y<s;y+=c)f+=(i[w]-i[y])*(i[y+1]+i[w+1]),w=y;return f}Wp.exports=vf,Wp.exports.default=vf,vf.deviation=function(i,n,s,c){var f=n&&n.length,y=Math.abs(Bd(i,0,f?n[0]*s:i.length,s));if(f)for(var w=0,E=n.length;w<E;w++)y-=Math.abs(Bd(i,n[w]*s,w<E-1?n[w+1]*s:i.length,s));var A=0;for(w=0;w<c.length;w+=3){var I=c[w]*s,j=c[w+1]*s,V=c[w+2]*s;A+=Math.abs((i[I]-i[V])*(i[j+1]-i[I+1])-(i[I]-i[j])*(i[V+1]-i[I+1]))}return y===0&&A===0?0:Math.abs((A-y)/y)},vf.flatten=function(i){for(var n=i[0][0].length,s={vertices:[],holes:[],dimensions:n},c=0,f=0;f<i.length;f++){for(var y=0;y<i[f].length;y++)for(var w=0;w<n;w++)s.vertices.push(i[f][y][w]);f>0&&s.holes.push(c+=i[f-1].length)}return s};var Kp=pe(Wp.exports);function k0(i,n,s,c,f){Ef(i,n,s,c||i.length-1,f||kf)}function Ef(i,n,s,c,f){for(;c>s;){if(c-s>600){var y=c-s+1,w=n-s+1,E=Math.log(y),A=.5*Math.exp(2*E/3),I=.5*Math.sqrt(E*A*(y-A)/y)*(w-y/2<0?-1:1);Ef(i,n,Math.max(s,Math.floor(n-w*A/y+I)),Math.min(c,Math.floor(n+(y-w)*A/y+I)),f)}var j=i[n],V=s,U=c;for(Cf(i,s,n),f(i[c],j)>0&&Cf(i,s,c);V<U;){for(Cf(i,V,U),V++,U--;f(i[V],j)<0;)V++;for(;f(i[U],j)>0;)U--}f(i[s],j)===0?Cf(i,s,U):Cf(i,++U,c),U<=n&&(s=U+1),n<=U&&(c=U-1)}}function Cf(i,n,s){var c=i[n];i[n]=i[s],i[s]=c}function kf(i,n){return i<n?-1:i>n?1:0}function Dg(i,n){const s=i.length;if(s<=1)return[i];const c=[];let f,y;for(let w=0;w<s;w++){const E=Xs(i[w]);E!==0&&(i[w].area=Math.abs(E),y===void 0&&(y=E<0),y===E<0?(f&&c.push(f),f=[i[w]]):f.push(i[w]))}if(f&&c.push(f),n>1)for(let w=0;w<c.length;w++)c[w].length<=n||(k0(c[w],n,1,c[w].length-1,Yp),c[w]=c[w].slice(0,n));return c}function Yp(i,n){return n.area-i.area}function d(i,n,s){const c=s.patternDependencies;let f=!1;for(const y of n){const w=y.paint.get(`${i}-pattern`);w.isConstant()||(f=!0);const E=w.constantOr(null);E&&(f=!0,c[E]=!0)}return f}function p(i,n,s,c,f){const y=f.patternDependencies;for(const w of n){const E=w.paint.get(`${i}-pattern`).value;if(E.kind!=="constant"){let A=E.evaluate({zoom:c},s,{},f.availableImages);A=A&&A.name?A.name:A,y[A]=!0,s.patterns[w.id]=A}}return s}class S{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.patternFeatures=[],this.layoutVertexArray=new kt,this.indexArray=new en,this.indexArray2=new $r,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new oi,this.segments2=new oi,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.projection=n.projection}populate(n,s,c,f){this.hasPattern=d("fill",this.layers,s);const y=this.layers[0].layout.get("fill-sort-key"),w=[];for(const{feature:E,id:A,index:I,sourceLayerIndex:j}of n){const V=this.layers[0]._featureFilter.needGeometry,U=Xa(E,V);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),U,c))continue;const q=y?y.evaluate(U,{},c,s.availableImages):void 0,X={id:A,properties:E.properties,type:E.type,sourceLayerIndex:j,index:I,geometry:V?U.geometry:As(E,c,f),patterns:{},sortKey:q};w.push(X)}y&&w.sort(((E,A)=>E.sortKey-A.sortKey));for(const E of w){const{geometry:A,index:I,sourceLayerIndex:j}=E;if(this.hasPattern){const V=p("fill",this.layers,E,this.zoom,s);this.patternFeatures.push(V)}else this.addFeature(E,A,I,c,{},s.availableImages);s.featureIndex.insert(n[I].feature,A,I,j,this.index)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}addFeatures(n,s,c,f,y){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,E0),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.indexBuffer2=n.createIndexBuffer(this.indexArray2)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.indexBuffer2.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.segments2.destroy())}addFeature(n,s,c,f,y,w=[]){for(const E of Dg(s,500)){let A=0;for(const X of E)A+=X.length;const I=this.segments.prepareSegment(A,this.layoutVertexArray,this.indexArray),j=I.vertexLength,V=[],U=[];for(const X of E){if(X.length===0)continue;X!==E[0]&&U.push(V.length/2);const te=this.segments2.prepareSegment(X.length,this.layoutVertexArray,this.indexArray2),ae=te.vertexLength;this.layoutVertexArray.emplaceBack(X[0].x,X[0].y),this.indexArray2.emplaceBack(ae+X.length-1,ae),V.push(X[0].x),V.push(X[0].y);for(let ge=1;ge<X.length;ge++)this.layoutVertexArray.emplaceBack(X[ge].x,X[ge].y),this.indexArray2.emplaceBack(ae+ge-1,ae+ge),V.push(X[ge].x),V.push(X[ge].y);te.vertexLength+=X.length,te.primitiveLength+=X.length}const q=Kp(V,U);for(let X=0;X<q.length;X+=3)this.indexArray.emplaceBack(j+q[X],j+q[X+1],j+q[X+2]);I.vertexLength+=A,I.primitiveLength+=q.length/3}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}}Ft(S,"FillBucket",{omit:["layers","patternFeatures"]});const R=new ve({"fill-sort-key":new le(dt.layout_fill["fill-sort-key"])});var F={paint:new ve({"fill-antialias":new Q(dt.paint_fill["fill-antialias"]),"fill-opacity":new le(dt.paint_fill["fill-opacity"]),"fill-color":new le(dt.paint_fill["fill-color"]),"fill-outline-color":new le(dt.paint_fill["fill-outline-color"]),"fill-translate":new Q(dt.paint_fill["fill-translate"]),"fill-translate-anchor":new Q(dt.paint_fill["fill-translate-anchor"]),"fill-pattern":new le(dt.paint_fill["fill-pattern"])}),layout:R};const W=Ue([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),se=Ue([{name:"a_centroid_pos",components:2,type:"Uint16"}]),Ie=Ue([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:Ve}=W;var st={},Dt=Ge,jt=Mt;function Mt(i,n,s,c,f){this.properties={},this.extent=s,this.type=0,this._pbf=i,this._geometry=-1,this._keys=c,this._values=f,i.readFields(sn,this,n)}function sn(i,n,s){i==1?n.id=s.readVarint():i==2?(function(c,f){for(var y=c.readVarint()+c.pos;c.pos<y;){var w=f._keys[c.readVarint()],E=f._values[c.readVarint()];f.properties[w]=E}})(s,n):i==3?n.type=s.readVarint():i==4&&(n._geometry=s.pos)}function hn(i){for(var n,s,c=0,f=0,y=i.length,w=y-1;f<y;w=f++)c+=((s=i[w]).x-(n=i[f]).x)*(n.y+s.y);return c}Mt.types=["Unknown","Point","LineString","Polygon"],Mt.prototype.loadGeometry=function(){var i=this._pbf;i.pos=this._geometry;for(var n,s=i.readVarint()+i.pos,c=1,f=0,y=0,w=0,E=[];i.pos<s;){if(f<=0){var A=i.readVarint();c=7&A,f=A>>3}if(f--,c===1||c===2)y+=i.readSVarint(),w+=i.readSVarint(),c===1&&(n&&E.push(n),n=[]),n.push(new Dt(y,w));else{if(c!==7)throw new Error("unknown command "+c);n&&n.push(n[0].clone())}}return n&&E.push(n),E},Mt.prototype.bbox=function(){var i=this._pbf;i.pos=this._geometry;for(var n=i.readVarint()+i.pos,s=1,c=0,f=0,y=0,w=1/0,E=-1/0,A=1/0,I=-1/0;i.pos<n;){if(c<=0){var j=i.readVarint();s=7&j,c=j>>3}if(c--,s===1||s===2)(f+=i.readSVarint())<w&&(w=f),f>E&&(E=f),(y+=i.readSVarint())<A&&(A=y),y>I&&(I=y);else if(s!==7)throw new Error("unknown command "+s)}return[w,A,E,I]},Mt.prototype.toGeoJSON=function(i,n,s){var c,f,y=this.extent*Math.pow(2,s),w=this.extent*i,E=this.extent*n,A=this.loadGeometry(),I=Mt.types[this.type];function j(q){for(var X=0;X<q.length;X++){var te=q[X];q[X]=[360*(te.x+w)/y-180,360/Math.PI*Math.atan(Math.exp((180-360*(te.y+E)/y)*Math.PI/180))-90]}}switch(this.type){case 1:var V=[];for(c=0;c<A.length;c++)V[c]=A[c][0];j(A=V);break;case 2:for(c=0;c<A.length;c++)j(A[c]);break;case 3:for(A=(function(q){var X=q.length;if(X<=1)return[q];for(var te,ae,ge=[],Ce=0;Ce<X;Ce++){var ye=hn(q[Ce]);ye!==0&&(ae===void 0&&(ae=ye<0),ae===ye<0?(te&&ge.push(te),te=[q[Ce]]):te.push(q[Ce]))}return te&&ge.push(te),ge})(A),c=0;c<A.length;c++)for(f=0;f<A[c].length;f++)j(A[c][f])}A.length===1?A=A[0]:I="Multi"+I;var U={type:"Feature",geometry:{type:I,coordinates:A},properties:this.properties};return"id"in this&&(U.id=this.id),U};var pn=jt,gi=et;function et(i,n){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=i,this._keys=[],this._values=[],this._features=[],i.readFields(He,this,n),this.length=this._features.length}function He(i,n,s){i===15?n.version=s.readVarint():i===1?n.name=s.readString():i===5?n.extent=s.readVarint():i===2?n._features.push(s.pos):i===3?n._keys.push(s.readString()):i===4&&n._values.push((function(c){for(var f=null,y=c.readVarint()+c.pos;c.pos<y;){var w=c.readVarint()>>3;f=w===1?c.readString():w===2?c.readFloat():w===3?c.readDouble():w===4?c.readVarint64():w===5?c.readVarint():w===6?c.readSVarint():w===7?c.readBoolean():null}return f})(s))}et.prototype.feature=function(i){if(i<0||i>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[i];var n=this._pbf.readVarint()+this._pbf.pos;return new pn(this._pbf,n,this.extent,this._keys,this._values)};var rt=gi;function Vt(i,n,s){if(i===3){var c=new rt(s,s.readVarint()+s.pos);c.length&&(n[c.name]=c)}}var mn=st.VectorTile=function(i,n){this.layers=i.readFields(Vt,{},n)},Sn=st.VectorTileFeature=jt;function En(i,n,s,c){const f=[],y=c===0?(w,E,A,I,j,V)=>{w.push(new Pe(V,A+(V-E)/(I-E)*(j-A)))}:(w,E,A,I,j,V)=>{w.push(new Pe(E+(V-A)/(j-A)*(I-E),V))};for(const w of i){const E=[];for(const A of w){if(A.length<=2)continue;const I=[];for(let U=0;U<A.length-1;U++){const q=A[U].x,X=A[U].y,te=A[U+1].x,ae=A[U+1].y,ge=c===0?q:X,Ce=c===0?te:ae;ge<n?Ce>n&&y(I,q,X,te,ae,n):ge>s?Ce<s&&y(I,q,X,te,ae,s):I.push(A[U]),Ce<n&&ge>=n&&y(I,q,X,te,ae,n),Ce>s&&ge<=s&&y(I,q,X,te,ae,s)}let j=A[A.length-1];const V=c===0?j.x:j.y;V>=n&&V<=s&&I.push(j),I.length&&(j=I[I.length-1],I[0].x===j.x&&I[0].y===j.y||I.push(I[0]),E.push(I))}E.length&&f.push(E)}return f}st.VectorTileLayer=gi;const Vn=Sn.types,Qi=Math.pow(2,13);function lr(i,n,s,c,f,y,w,E){i.emplaceBack((n<<1)+w,(s<<1)+y,(Math.floor(c*Qi)<<1)+f,Math.round(E))}function Jo(i,n,s){i.emplaceBack(n.x,n.y,n.z,s[0]*16384,s[1]*16384,s[2]*16384)}class j_{constructor(){this.acc=new Pe(0,0),this.polyCount=[]}startRing(n){this.currentPolyCount={edges:0,top:0},this.polyCount.push(this.currentPolyCount),this.min||(this.min=new Pe(n.x,n.y),this.max=new Pe(n.x,n.y))}append(n,s){this.currentPolyCount.edges++,this.acc._add(n);const c=this.min,f=this.max;n.x<c.x?c.x=n.x:n.x>f.x&&(f.x=n.x),n.y<c.y?c.y=n.y:n.y>f.y&&(f.y=n.y),((n.x===0||n.x===an)&&n.x===s.x)!=((n.y===0||n.y===an)&&n.y===s.y)&&this.processBorderOverlap(n,s),s.x<0!=n.x<0&&this.addBorderIntersection(0,Kn(s.y,n.y,(0-s.x)/(n.x-s.x))),s.x>an!=n.x>an&&this.addBorderIntersection(1,Kn(s.y,n.y,(an-s.x)/(n.x-s.x))),s.y<0!=n.y<0&&this.addBorderIntersection(2,Kn(s.x,n.x,(0-s.y)/(n.y-s.y))),s.y>an!=n.y>an&&this.addBorderIntersection(3,Kn(s.x,n.x,(an-s.y)/(n.y-s.y)))}addBorderIntersection(n,s){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const c=this.borders[n];s<c[0]&&(c[0]=s),s>c[1]&&(c[1]=s)}processBorderOverlap(n,s){if(n.x===s.x){if(n.y===s.y)return;const c=n.x===0?0:1;this.addBorderIntersection(c,s.y),this.addBorderIntersection(c,n.y)}else{const c=n.y===0?2:3;this.addBorderIntersection(c,s.x),this.addBorderIntersection(c,n.x)}}centroid(){const n=this.polyCount.reduce(((s,c)=>s+c.edges),0);return n!==0?this.acc.div(n)._round():new Pe(0,0)}span(){return new Pe(this.max.x-this.min.x,this.max.y-this.min.y)}intersectsCount(){return this.borders.reduce(((n,s)=>n+ +(s[0]!==Number.MAX_VALUE)),0)}}class Lg{constructor(n){this.zoom=n.zoom,this.canonical=n.canonical,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=n.projection,this.layoutVertexArray=new at,this.centroidVertexArray=new co,this.indexArray=new en,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new oi,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id)),this.enableTerrain=n.enableTerrain}populate(n,s,c,f){this.features=[],this.hasPattern=d("fill-extrusion",this.layers,s),this.featuresOnBorder=[],this.borders=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.tileToMeter=(function(y){const w=Math.exp(Math.PI*(1-y.y/(1<<y.z)*2));return 80150034*w/(w*w+1)/an/(1<<y.z)})(c),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter;for(const{feature:y,id:w,index:E,sourceLayerIndex:A}of n){const I=this.layers[0]._featureFilter.needGeometry,j=Xa(y,I);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),j,c))continue;const V={id:w,sourceLayerIndex:A,index:E,geometry:I?j.geometry:As(y,c,f),properties:y.properties,type:y.type,patterns:{}},U=this.layoutVertexArray.length;this.hasPattern?this.features.push(p("fill-extrusion",this.layers,V,this.zoom,s)):this.addFeature(V,V.geometry,E,c,{},s.availableImages,f),s.featureIndex.insert(y,V.geometry,E,A,this.index,U)}this.sortBorders()}addFeatures(n,s,c,f,y){for(const w of this.features){const{geometry:E}=w;this.addFeature(w,E,w.index,s,c,f,y)}this.sortBorders()}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,Ve),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=n.createVertexBuffer(this.layoutVertexExtArray,Ie.members,!0))),this.programConfigurations.upload(n),this.uploaded=!0}uploadCentroid(n){this.centroidVertexArray.length!==0&&(this.centroidVertexBuffer?this.needsCentroidUpdate&&this.centroidVertexBuffer.updateData(this.centroidVertexArray):this.centroidVertexBuffer=n.createVertexBuffer(this.centroidVertexArray,se.members,!0),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(n,s,c,f,y,w,E){const A=[new Pe(0,0),new Pe(an,an)],I=E.projection,j=I.name==="globe",V=this.enableTerrain&&!j?new j_:null,U=Vn[n.type]==="Polygon";j&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Tt);const q=Dg(s,500);for(let ge=q.length-1;ge>=0;ge--){const Ce=q[ge];(Ce.length===0||(X=Ce[0]).every((ye=>ye.x<=0))||X.every((ye=>ye.x>=an))||X.every((ye=>ye.y<=0))||X.every((ye=>ye.y>=an)))&&q.splice(ge,1)}var X;let te;if(j)te=SS(q,A,f);else{te=[];for(const ge of q)te.push({polygon:ge,bounds:A})}const ae=U?this.edgeRadius:0;for(const{polygon:ge,bounds:Ce}of te){let ye=0,Ee=0;for(const Me of ge)U&&!Me[0].equals(Me[Me.length-1])&&Me.push(Me[0]),Ee+=U?Me.length-1:Me.length;const Re=this.segments.prepareSegment((U?5:4)*Ee,this.layoutVertexArray,this.indexArray);if(U){const Me=[],Qe=[];ye=Re.vertexLength;for(const ft of ge){let It,nt;ft.length&&ft!==ge[0]&&Qe.push(Me.length/2),It=ft[1].sub(ft[0])._perp()._unit();for(let yt=1;yt<ft.length;yt++){const _t=ft[yt],Ct=ft[yt===ft.length-1?1:yt+1];let{x:Pt,y:ct}=_t;if(ae){nt=Ct.sub(_t)._perp()._unit();const Bt=It.add(nt)._unit(),Jt=ae*Math.min(4,1/(It.x*Bt.x+It.y*Bt.y));Pt+=Jt*Bt.x,ct+=Jt*Bt.y,It=nt}lr(this.layoutVertexArray,Pt,ct,0,0,1,1,0),Re.vertexLength++,Me.push(_t.x,_t.y),j&&Jo(this.layoutVertexExtArray,I.projectTilePoint(Pt,ct,f),I.upVector(f,Pt,ct))}}const Xe=Kp(Me,Qe);for(let ft=0;ft<Xe.length;ft+=3)this.indexArray.emplaceBack(ye+Xe[ft],ye+Xe[ft+2],ye+Xe[ft+1]),Re.primitiveLength++}for(const Me of ge){V&&Me.length&&V.startRing(Me[0]);let Qe,Xe,ft,It=Me.length>4&&wS(Me[Me.length-2],Me[0],Me[1]),nt=ae?jL(Me[Me.length-2],Me[0],Me[1],ae):0;Xe=Me[1].sub(Me[0])._perp()._unit();let yt=!0;for(let _t=1,Ct=0;_t<Me.length;_t++){let Pt=Me[_t-1],ct=Me[_t];const Bt=Me[_t===Me.length-1?1:_t+1];if(V&&U&&V.currentPolyCount.top++,vS(ct,Pt,Ce)){ae&&(Xe=Bt.sub(ct)._perp()._unit(),yt=!yt);continue}V&&V.append(ct,Pt);const Jt=ct.sub(Pt)._perp(),$t=Jt.x/(Math.abs(Jt.x)+Math.abs(Jt.y)),Nn=Jt.y>0?1:0,Nt=Pt.dist(ct);if(Ct+Nt>32768&&(Ct=0),ae){ft=Bt.sub(ct)._perp()._unit();let Ln=xS(Pt,ct,Bt,_S(Xe,ft),ae);isNaN(Ln)&&(Ln=0);const wn=ct.sub(Pt)._unit();Pt=Pt.add(wn.mult(nt))._round(),ct=ct.add(wn.mult(-Ln))._round(),nt=Ln,Xe=ft}const cn=Re.vertexLength,Dn=Me.length>4&&wS(Pt,ct,Bt);let cr=bS(Ct,It,yt);if(lr(this.layoutVertexArray,Pt.x,Pt.y,$t,Nn,0,0,cr),lr(this.layoutVertexArray,Pt.x,Pt.y,$t,Nn,0,1,cr),Ct+=Nt,cr=bS(Ct,Dn,!yt),It=Dn,lr(this.layoutVertexArray,ct.x,ct.y,$t,Nn,0,0,cr),lr(this.layoutVertexArray,ct.x,ct.y,$t,Nn,0,1,cr),Re.vertexLength+=4,this.indexArray.emplaceBack(cn+0,cn+1,cn+2),this.indexArray.emplaceBack(cn+1,cn+3,cn+2),Re.primitiveLength+=2,ae){const Ln=ye+(_t===1?Me.length-2:_t-2),wn=_t===1?ye:Ln+1;if(this.indexArray.emplaceBack(cn+1,Ln,cn+3),this.indexArray.emplaceBack(Ln,wn,cn+3),Re.primitiveLength+=2,Qe===void 0&&(Qe=cn),!vS(Bt,Me[_t],Ce)){const Lr=_t===Me.length-1?Qe:Re.vertexLength;this.indexArray.emplaceBack(cn+2,cn+3,Lr),this.indexArray.emplaceBack(cn+3,Lr+1,Lr),this.indexArray.emplaceBack(cn+3,wn,Lr+1),Re.primitiveLength+=3}yt=!yt}if(j){const Ln=this.layoutVertexExtArray,wn=I.projectTilePoint(Pt.x,Pt.y,f),Lr=I.projectTilePoint(ct.x,ct.y,f),On=I.upVector(f,Pt.x,Pt.y),zn=I.upVector(f,ct.x,ct.y);Jo(Ln,wn,On),Jo(Ln,wn,On),Jo(Ln,Lr,zn),Jo(Ln,Lr,zn)}}U&&(ye+=Me.length-1)}}if(V&&V.polyCount.length>0){if(V.borders){V.vertexArrayOffset=this.centroidVertexArray.length;const ge=V.borders,Ce=this.featuresOnBorder.push(V)-1;for(let ye=0;ye<4;ye++)ge[ye][0]!==Number.MAX_VALUE&&this.borders[ye].push(Ce)}this.encodeCentroid(V.borders?void 0:V.centroid(),V)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}sortBorders(){for(let n=0;n<4;n++)this.borders[n].sort(((s,c)=>this.featuresOnBorder[s].borders[n][0]-this.featuresOnBorder[c].borders[n][0]))}encodeCentroid(n,s,c=!0){let f,y;if(n)if(n.y!==0){const E=s.span()._mult(this.tileToMeter);f=(Math.max(n.x,1)<<3)+Math.min(7,Math.round(E.x/10)),y=(Math.max(n.y,1)<<3)+Math.min(7,Math.round(E.y/10))}else f=Math.ceil(7*(n.x+450)),y=0;else f=0,y=+c;let w=c?this.centroidVertexArray.length:s.vertexArrayOffset;for(const E of s.polyCount){c&&this.centroidVertexArray.resize(this.centroidVertexArray.length+4*E.edges+E.top);for(let A=0;A<E.top;A++)this.centroidVertexArray.emplace(w++,f,y);for(let A=0;A<2*E.edges;A++)this.centroidVertexArray.emplace(w++,0,y),this.centroidVertexArray.emplace(w++,f,y)}}}function _S(i,n){const s=i.add(n)._unit();return i.x*s.x+i.y*s.y}function jL(i,n,s,c){const f=n.sub(i)._perp()._unit(),y=s.sub(n)._perp()._unit();return xS(i,n,s,_S(f,y),c)}function xS(i,n,s,c,f){const y=Math.sqrt(1-c*c);return Math.min(i.dist(n)/3,n.dist(s)/3,f*y/c)}function vS(i,n,s){return i.x<s[0].x&&n.x<s[0].x||i.x>s[1].x&&n.x>s[1].x||i.y<s[0].y&&n.y<s[0].y||i.y>s[1].y&&n.y>s[1].y}function wS(i,n,s){if(i.x<0||i.x>=an||n.x<0||n.x>=an||s.x<0||s.x>=an)return!1;const c=s.sub(n),f=c.perp(),y=i.sub(n);return(c.x*y.x+c.y*y.y)/Math.sqrt((c.x*c.x+c.y*c.y)*(y.x*y.x+y.y*y.y))>-.866&&f.x*y.x+f.y*y.y<0}function bS(i,n,s){const c=n?2|i:-3&i;return s?1|c:-2&c}function TS(){const i=Math.PI/32,n=Math.tan(i),s=Ac;return s*Math.sqrt(1+2*n*n)-s}function SS(i,n,s){const c=1<<s.z,f=Yi(s.x/c),y=Yi((s.x+1)/c),w=ar(s.y/c),E=ar((s.y+1)/c);return(function(A,I,j,V,U=0,q){const X=[];if(!A.length||!j||!V)return X;const te=(Me,Qe)=>{for(const Xe of Me)X.push({polygon:Xe,bounds:Qe})},ae=Math.ceil(Math.log2(j)),ge=Math.ceil(Math.log2(V)),Ce=ae-ge,ye=[];for(let Me=0;Me<Math.abs(Ce);Me++)ye.push(Ce>0?0:1);for(let Me=0;Me<Math.min(ae,ge);Me++)ye.push(0),ye.push(1);let Ee=A;if(Ee=En(Ee,I[0].y-U,I[1].y+U,1),Ee=En(Ee,I[0].x-U,I[1].x+U,0),!Ee.length)return X;const Re=[];for(ye.length?Re.push({polygons:Ee,bounds:I,depth:0}):te(Ee,I);Re.length;){const Me=Re.pop(),Qe=Me.depth,Xe=ye[Qe],ft=Me.bounds[0],It=Me.bounds[1],nt=Xe===0?ft.x:ft.y,yt=Xe===0?It.x:It.y,_t=q?q(Xe,nt,yt):.5*(nt+yt),Ct=En(Me.polygons,nt-U,_t+U,Xe),Pt=En(Me.polygons,_t-U,yt+U,Xe);if(Ct.length){const ct=[ft,new Pe(Xe===0?_t:It.x,Xe===1?_t:It.y)];ye.length>Qe+1?Re.push({polygons:Ct,bounds:ct,depth:Qe+1}):te(Ct,ct)}if(Pt.length){const ct=[new Pe(Xe===0?_t:ft.x,Xe===1?_t:ft.y),It];ye.length>Qe+1?Re.push({polygons:Pt,bounds:ct,depth:Qe+1}):te(Pt,ct)}}return X})(i,n,Math.ceil((y-f)/11.25),Math.ceil((w-E)/11.25),1,((A,I,j)=>{if(A===0)return .5*(I+j);{const V=ar((s.y+I/an)/c);return(Fr(.5*(ar((s.y+j/an)/c)+V))*c-s.y)*an}}))}Ft(Lg,"FillExtrusionBucket",{omit:["layers","features"]}),Ft(j_,"PartMetadata");const OL=new ve({"fill-extrusion-edge-radius":new Q(dt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])});var zL={paint:new ve({"fill-extrusion-opacity":new Q(dt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new le(dt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Q(dt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Q(dt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new le(dt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-height":new le(dt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new le(dt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-vertical-gradient":new Q(dt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Q(dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Q(dt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-rounded-roof":new Q(dt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"])}),layout:OL};function ES(i,n,s){var c=2*Math.PI*6378137/256/Math.pow(2,s);return[i*c-2*Math.PI*6378137/2,n*c-2*Math.PI*6378137/2]}class O_{constructor(n,s,c){this.z=n,this.x=s,this.y=c,this.key=jg(0,n,n,s,c)}equals(n){return this.z===n.z&&this.x===n.x&&this.y===n.y}url(n,s){const c=(function(y,w,E){var A=ES(256*y,256*(w=Math.pow(2,E)-w-1),E),I=ES(256*(y+1),256*(w+1),E);return A[0]+","+A[1]+","+I[0]+","+I[1]})(this.x,this.y,this.z),f=(function(y,w,E){let A,I="";for(let j=y;j>0;j--)A=1<<j-1,I+=(w&A?1:0)+(E&A?2:0);return I})(this.z,this.x,this.y);return n[(this.x+this.y)%n.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(s==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",f).replace("{bbox-epsg-3857}",c)}toString(){return`${this.z}/${this.x}/${this.y}`}}class CS{constructor(n,s){this.wrap=n,this.canonical=s,this.key=jg(n,s.z,s.z,s.x,s.y)}}class po{constructor(n,s,c,f,y){this.overscaledZ=n,this.wrap=s,this.canonical=new O_(c,+f,+y),this.key=s===0&&n===c?this.canonical.key:jg(s,n,c,f,y)}equals(n){return this.overscaledZ===n.overscaledZ&&this.wrap===n.wrap&&this.canonical.equals(n.canonical)}scaledTo(n){const s=this.canonical.z-n;return n>this.canonical.z?new po(n,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new po(n,this.wrap,n,this.canonical.x>>s,this.canonical.y>>s)}calculateScaledKey(n,s=!0){if(this.overscaledZ===n&&s)return this.key;if(n>this.canonical.z)return jg(this.wrap*+s,n,this.canonical.z,this.canonical.x,this.canonical.y);{const c=this.canonical.z-n;return jg(this.wrap*+s,n,n,this.canonical.x>>c,this.canonical.y>>c)}}isChildOf(n){if(n.wrap!==this.wrap)return!1;const s=this.canonical.z-n.canonical.z;return n.overscaledZ===0||n.overscaledZ<this.overscaledZ&&n.canonical.x===this.canonical.x>>s&&n.canonical.y===this.canonical.y>>s}children(n){if(this.overscaledZ>=n)return[new po(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const s=this.canonical.z+1,c=2*this.canonical.x,f=2*this.canonical.y;return[new po(s,this.wrap,s,c,f),new po(s,this.wrap,s,c+1,f),new po(s,this.wrap,s,c,f+1),new po(s,this.wrap,s,c+1,f+1)]}isLessThan(n){return this.wrap<n.wrap||!(this.wrap>n.wrap)&&(this.overscaledZ<n.overscaledZ||!(this.overscaledZ>n.overscaledZ)&&(this.canonical.x<n.canonical.x||!(this.canonical.x>n.canonical.x)&&this.canonical.y<n.canonical.y))}wrapped(){return new po(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(n){return new po(this.overscaledZ,n,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new CS(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function jg(i,n,s,c,f){const y=1<<Math.min(s,22);let w=y*(f%y)+c%y;return i&&s<22&&(w+=y*y*((i<0?-2*i-1:2*i)%(1<<2*(22-s)))),16*(32*w+s)+(n-s)}Ft(O_,"CanonicalTileID"),Ft(po,"OverscaledTileID",{omit:["projMatrix"]});class Jp extends Pe{constructor(n,s,c){super(n,s),this.z=c}}function Og(i,n){return i.x*n.x+i.y*n.y}function kS(i,n){if(i.length===1){let s=0;const c=n[s++];let f;for(;!f||c.equals(f);)if(f=n[s++],!f)return 1/0;for(;s<n.length;s++){const y=n[s],w=i[0],E=f.sub(c),A=y.sub(c),I=w.sub(c),j=Og(E,E),V=Og(E,A),U=Og(A,A),q=Og(I,E),X=Og(I,A),te=j*U-V*V,ae=(U*q-V*X)/te,ge=(j*X-V*q)/te,Ce=c.z*(1-ae-ge)+f.z*ae+y.z*ge;if(isFinite(Ce))return Ce}return 1/0}{let s=1/0;for(const c of n)s=Math.min(s,c.z);return s}}function AS(i,n,s,c,f,y,w,E){const A=w*f.getElevationAt(i,n,!0,!0),I=y[0]!==0,j=I?y[1]===0?w*(y[0]/7-450):w*(function(V,U,q){const X=Math.floor(U[0]/8),te=Math.floor(U[1]/8),ae=10*(U[0]-8*X),ge=10*(U[1]-8*te),Ce=V.getElevationAt(X,te,!0,!0),ye=V.getMeterToDEM(q),Ee=Math.floor(.5*(ae*ye-1)),Re=Math.floor(.5*(ge*ye-1)),Me=V.tileCoordToPixel(X,te),Qe=2*Ee+1,Xe=2*Re+1,ft=(function(Pt,ct,Bt,Jt,$t){return[Pt.getElevationAtPixel(ct,Bt,!0),Pt.getElevationAtPixel(ct+$t,Bt,!0),Pt.getElevationAtPixel(ct,Bt+$t,!0),Pt.getElevationAtPixel(ct+Jt,Bt+$t,!0)]})(V,Me.x-Ee,Me.y-Re,Qe,Xe),It=Math.abs(ft[0]-ft[1]),nt=Math.abs(ft[2]-ft[3]),yt=Math.abs(ft[0]-ft[2])+Math.abs(ft[1]-ft[3]),_t=Math.min(.25,.5*ye*(It+nt)/Qe),Ct=Math.min(.25,.5*ye*yt/Xe);return Ce+Math.max(_t*ae,Ct*ge)})(f,y,E):A;return{base:A+(s===0)?-1:s,top:I?Math.max(j+c,A+s+2):A+c}}const BL=Ue([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),{members:FL}=BL,VL=Ue([{name:"a_packed",components:4,type:"Float32"}]),{members:UL}=VL,$L=Sn.types,GL=Math.cos(Math.PI/180*37.5);class z_{constructor(n){this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((s=>s.id)),this.index=n.index,this.projection=n.projection,this.hasPattern=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach((s=>{this.gradients[s.id]={}})),this.layoutVertexArray=new Je,this.layoutVertexArray2=new Et,this.indexArray=new en,this.programConfigurations=new Sc(n.layers,n.zoom),this.segments=new oi,this.maxLineLength=0,this.stateDependentLayerIds=this.layers.filter((s=>s.isStateDependent())).map((s=>s.id))}populate(n,s,c,f){this.hasPattern=d("line",this.layers,s);const y=this.layers[0].layout.get("line-sort-key"),w=[];for(const{feature:j,id:V,index:U,sourceLayerIndex:q}of n){const X=this.layers[0]._featureFilter.needGeometry,te=Xa(j,X);if(!this.layers[0]._featureFilter.filter(new B(this.zoom),te,c))continue;const ae=y?y.evaluate(te,{},c):void 0,ge={id:V,properties:j.properties,type:j.type,sourceLayerIndex:q,index:U,geometry:X?te.geometry:As(j,c,f),patterns:{},sortKey:ae};w.push(ge)}y&&w.sort(((j,V)=>j.sortKey-V.sortKey));const{lineAtlas:E,featureIndex:A}=s,I=this.addConstantDashes(E);for(const j of w){const{geometry:V,index:U,sourceLayerIndex:q}=j;if(I&&this.addFeatureDashes(j,E),this.hasPattern){const X=p("line",this.layers,j,this.zoom,s);this.patternFeatures.push(X)}else this.addFeature(j,V,U,c,E.positions,s.availableImages);A.insert(n[U].feature,V,U,q,this.index)}}addConstantDashes(n){let s=!1;for(const c of this.layers){const f=c.paint.get("line-dasharray").value,y=c.layout.get("line-cap").value;if(f.kind!=="constant"||y.kind!=="constant")s=!0;else{const w=y.value,E=f.value;if(!E)continue;n.addDash(E,w)}}return s}addFeatureDashes(n,s){const c=this.zoom;for(const f of this.layers){const y=f.paint.get("line-dasharray").value,w=f.layout.get("line-cap").value;if(y.kind==="constant"&&w.kind==="constant")continue;let E,A;if(y.kind==="constant"){if(E=y.value,!E)continue}else E=y.evaluate({zoom:c},n);A=w.kind==="constant"?w.value:w.evaluate({zoom:c},n),s.addDash(E,A),n.patterns[f.id]=s.getKey(E,A)}}update(n,s,c,f){this.stateDependentLayers.length&&this.programConfigurations.updatePaintArrays(n,s,this.stateDependentLayers,c,f)}addFeatures(n,s,c,f,y){for(const w of this.patternFeatures)this.addFeature(w,w.geometry,w.index,s,c,f)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(n){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=n.createVertexBuffer(this.layoutVertexArray2,UL)),this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,FL),this.indexBuffer=n.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(n),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(n){if(n.properties&&n.properties.hasOwnProperty("mapbox_clip_start")&&n.properties.hasOwnProperty("mapbox_clip_end"))return{start:+n.properties.mapbox_clip_start,end:+n.properties.mapbox_clip_end}}addFeature(n,s,c,f,y,w){const E=this.layers[0].layout,A=E.get("line-join").evaluate(n,{}),I=E.get("line-cap").evaluate(n,{}),j=E.get("line-miter-limit"),V=E.get("line-round-limit");this.lineClips=this.lineFeatureClips(n);for(const U of s)this.addLine(U,n,A,I,j,V);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,n,c,y,w,f)}addLine(n,s,c,f,y,w){if(this.distance=0,this.scaledDistance=0,this.totalDistance=0,this.lineSoFar=0,this.lineClips){this.lineClipsArray.push(this.lineClips);for(let ge=0;ge<n.length-1;ge++)this.totalDistance+=n[ge].dist(n[ge+1]);this.updateScaledDistance(),this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}const E=$L[s.type]==="Polygon";let A=n.length;for(;A>=2&&n[A-1].equals(n[A-2]);)A--;let I=0;for(;I<A-1&&n[I].equals(n[I+1]);)I++;if(A<(E?3:2))return;c==="bevel"&&(y=1.05);const j=this.overscaling<=16?15*an/(512*this.overscaling):0,V=this.segments.prepareSegment(10*A,this.layoutVertexArray,this.indexArray);let U,q,X,te,ae;this.e1=this.e2=-1,E&&(U=n[A-2],ae=n[I].sub(U)._unit()._perp());for(let ge=I;ge<A;ge++){if(X=ge===A-1?E?n[I+1]:void 0:n[ge+1],X&&n[ge].equals(X))continue;ae&&(te=ae),U&&(q=U),U=n[ge],ae=X?X.sub(U)._unit()._perp():te,te=te||ae;let Ce=te.add(ae);Ce.x===0&&Ce.y===0||Ce._unit();const ye=te.x*ae.x+te.y*ae.y,Ee=Ce.x*ae.x+Ce.y*ae.y,Re=Ee!==0?1/Ee:1/0,Me=2*Math.sqrt(2-2*Ee),Qe=Ee<GL&&q&&X,Xe=te.x*ae.y-te.y*ae.x>0;if(Qe&&ge>I){const nt=U.dist(q);if(nt>2*j){const yt=U.sub(U.sub(q)._mult(j/nt)._round());this.updateDistance(q,yt),this.addCurrentVertex(yt,te,0,0,V),q=yt}}const ft=q&&X;let It=ft?c:E?"butt":f;if(ft&&It==="round"&&(Re<w?It="miter":Re<=2&&(It="fakeround")),It==="miter"&&Re>y&&(It="bevel"),It==="bevel"&&(Re>2&&(It="flipbevel"),Re<y&&(It="miter")),q&&this.updateDistance(q,U),It==="miter")Ce._mult(Re),this.addCurrentVertex(U,Ce,0,0,V);else if(It==="flipbevel"){if(Re>100)Ce=ae.mult(-1);else{const nt=Re*te.add(ae).mag()/te.sub(ae).mag();Ce._perp()._mult(nt*(Xe?-1:1))}this.addCurrentVertex(U,Ce,0,0,V),this.addCurrentVertex(U,Ce.mult(-1),0,0,V)}else if(It==="bevel"||It==="fakeround"){const nt=-Math.sqrt(Re*Re-1),yt=Xe?nt:0,_t=Xe?0:nt;if(q&&this.addCurrentVertex(U,te,yt,_t,V),It==="fakeround"){const Ct=Math.round(180*Me/Math.PI/20);for(let Pt=1;Pt<Ct;Pt++){let ct=Pt/Ct;if(ct!==.5){const Jt=ct-.5;ct+=ct*Jt*(ct-1)*((1.0904+ye*(ye*(3.55645-1.43519*ye)-3.2452))*Jt*Jt+(.848013+ye*(.215638*ye-1.06021)))}const Bt=ae.sub(te)._mult(ct)._add(te)._unit()._mult(Xe?-1:1);this.addHalfVertex(U,Bt.x,Bt.y,!1,Xe,0,V)}}X&&this.addCurrentVertex(U,ae,-yt,-_t,V)}else if(It==="butt")this.addCurrentVertex(U,Ce,0,0,V);else if(It==="square"){const nt=q?1:-1;q||this.addCurrentVertex(U,Ce,nt,nt,V),this.addCurrentVertex(U,Ce,0,0,V),q&&this.addCurrentVertex(U,Ce,nt,nt,V)}else It==="round"&&(q&&(this.addCurrentVertex(U,te,0,0,V),this.addCurrentVertex(U,te,1,1,V,!0)),X&&(this.addCurrentVertex(U,ae,-1,-1,V,!0),this.addCurrentVertex(U,ae,0,0,V)));if(Qe&&ge<A-1){const nt=U.dist(X);if(nt>2*j){const yt=U.add(X.sub(U)._mult(j/nt)._round());this.updateDistance(U,yt),this.addCurrentVertex(yt,ae,0,0,V),U=yt}}}}addCurrentVertex(n,s,c,f,y,w=!1){const E=s.y*f-s.x,A=-s.y-s.x*f;this.addHalfVertex(n,s.x+s.y*c,s.y-s.x*c,w,!1,c,y),this.addHalfVertex(n,E,A,w,!0,-f,y)}addHalfVertex({x:n,y:s},c,f,y,w,E,A){this.layoutVertexArray.emplaceBack((n<<1)+(y?1:0),(s<<1)+(w?1:0),Math.round(63*c)+128,Math.round(63*f)+128,1+(E===0?0:E<0?-1:1),0,this.lineSoFar),this.lineClips&&this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,this.lineClips.start,this.lineClips.end);const I=A.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,I),A.primitiveLength++),w?this.e2=I:this.e1=I}updateScaledDistance(){if(this.lineClips){const n=this.totalDistance/(this.lineClips.end-this.lineClips.start);this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=n*this.lineClips.start+this.distance}else this.lineSoFar=this.distance}updateDistance(n,s){this.distance+=n.dist(s),this.updateScaledDistance()}}Ft(z_,"LineBucket",{omit:["layers","patternFeatures"]});const HL=new ve({"line-cap":new le(dt.layout_line["line-cap"]),"line-join":new le(dt.layout_line["line-join"]),"line-miter-limit":new Q(dt.layout_line["line-miter-limit"]),"line-round-limit":new Q(dt.layout_line["line-round-limit"]),"line-sort-key":new le(dt.layout_line["line-sort-key"])});var IS={paint:new ve({"line-opacity":new le(dt.paint_line["line-opacity"]),"line-color":new le(dt.paint_line["line-color"]),"line-translate":new Q(dt.paint_line["line-translate"]),"line-translate-anchor":new Q(dt.paint_line["line-translate-anchor"]),"line-width":new le(dt.paint_line["line-width"]),"line-gap-width":new le(dt.paint_line["line-gap-width"]),"line-offset":new le(dt.paint_line["line-offset"]),"line-blur":new le(dt.paint_line["line-blur"]),"line-dasharray":new le(dt.paint_line["line-dasharray"]),"line-pattern":new le(dt.paint_line["line-pattern"]),"line-gradient":new _e(dt.paint_line["line-gradient"]),"line-trim-offset":new Q(dt.paint_line["line-trim-offset"])}),layout:HL};const MS=new class extends le{possiblyEvaluate(i,n){return n=new B(Math.floor(n.zoom),{now:n.now,fadeDuration:n.fadeDuration,transition:n.transition}),super.possiblyEvaluate(i,n)}evaluate(i,n,s,c){return n=vt({},n,{zoom:Math.floor(n.zoom)}),super.evaluate(i,n,s,c)}}(IS.paint.properties["line-width"].specification);function PS(i,n){return n>0?n+2*i:i}MS.useIntegerZoom=!0;const WL=Ue([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),qL=Ue([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),ZL=Ue([{name:"a_projected_pos",components:4,type:"Float32"}],4);Ue([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const XL=Ue([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"}]),KL=Ue([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"}]);Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const RS=Ue([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),YL=Ue([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Ue([{name:"triangle",components:3,type:"Uint16"}]),Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Ue([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"}]),Ue([{type:"Float32",name:"offsetX"}]),Ue([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var hs=24;const Rl=128;function A0(i,n){const{expression:s}=n;if(s.kind==="constant")return{kind:"constant",layoutSize:s.evaluate(new B(i+1))};if(s.kind==="source")return{kind:"source"};{const{zoomStops:c,interpolationType:f}=s;let y=0;for(;y<c.length&&c[y]<=i;)y++;y=Math.max(0,y-1);let w=y;for(;w<c.length&&c[w]<i+1;)w++;w=Math.min(c.length-1,w);const E=c[y],A=c[w];return s.kind==="composite"?{kind:"composite",minZoom:E,maxZoom:A,interpolationType:f}:{kind:"camera",minZoom:E,maxZoom:A,minSize:s.evaluate(new B(E)),maxSize:s.evaluate(new B(A)),interpolationType:f}}}function B_(i,{uSize:n,uSizeT:s},{lowerSize:c,upperSize:f}){return i.kind==="source"?c/Rl:i.kind==="composite"?Kn(c/Rl,f/Rl,s):n}function Qp(i,n){let s=0,c=0;if(i.kind==="constant")c=i.layoutSize;else if(i.kind!=="source"){const{interpolationType:f,minZoom:y,maxZoom:w}=i,E=f?xe(ws.interpolationFactor(f,n,y,w),0,1):0;i.kind==="camera"?c=Kn(i.minSize,i.maxSize,E):s=E}return{uSizeT:s,uSize:c}}var JL=Object.freeze({__proto__:null,SIZE_PACK_FACTOR:Rl,evaluateSizeForFeature:B_,evaluateSizeForZoom:Qp,getSizeData:A0});function QL(i,n,s){return i.sections.forEach((c=>{c.text=(function(f,y,w){const E=y.layout.get("text-transform").evaluate(w,{});return E==="uppercase"?f=f.toLocaleUpperCase():E==="lowercase"&&(f=f.toLocaleLowerCase()),D.applyArabicShaping&&(f=D.applyArabicShaping(f)),f})(c.text,n,s)})),i}const zg={"!":"","#":"",$:"","%":"","&":"","(":"",")":"","*":"","+":"",",":"","-":"",".":"","/":"",":":"",";":"","<":"","=":"",">":"","?":"","@":"","[":"","\\":"","]":"","^":"",_:"","`":"","{":"","|":"","}":"","~":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":"","":""};function e5(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}function t5(i){return i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""||i===""}var NS=Ar,DS=function(i,n,s,c,f){var y,w,E=8*f-c-1,A=(1<<E)-1,I=A>>1,j=-7,V=f-1,U=-1,q=i[n+V];for(V+=U,y=q&(1<<-j)-1,q>>=-j,j+=E;j>0;y=256*y+i[n+V],V+=U,j-=8);for(w=y&(1<<-j)-1,y>>=-j,j+=c;j>0;w=256*w+i[n+V],V+=U,j-=8);if(y===0)y=1-I;else{if(y===A)return w?NaN:1/0*(q?-1:1);w+=Math.pow(2,c),y-=I}return(q?-1:1)*w*Math.pow(2,y-c)},LS=function(i,n,s,c,f,y){var w,E,A,I=8*y-f-1,j=(1<<I)-1,V=j>>1,U=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=0,X=1,te=n<0||n===0&&1/n<0?1:0;for(n=Math.abs(n),isNaN(n)||n===1/0?(E=isNaN(n)?1:0,w=j):(w=Math.floor(Math.log(n)/Math.LN2),n*(A=Math.pow(2,-w))<1&&(w--,A*=2),(n+=w+V>=1?U/A:U*Math.pow(2,1-V))*A>=2&&(w++,A/=2),w+V>=j?(E=0,w=j):w+V>=1?(E=(n*A-1)*Math.pow(2,f),w+=V):(E=n*Math.pow(2,V-1)*Math.pow(2,f),w=0));f>=8;i[s+q]=255&E,q+=X,E/=256,f-=8);for(w=w<<f|E,I+=f;I>0;i[s+q]=255&w,q+=X,w/=256,I-=8);i[s+q-X]|=128*te};function Ar(i){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(i)?i:new Uint8Array(i||0),this.pos=0,this.type=0,this.length=this.buf.length}Ar.Varint=0,Ar.Fixed64=1,Ar.Bytes=2,Ar.Fixed32=5;var I0=4294967296,jS=1/I0,OS=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function Bu(i){return i.type===Ar.Bytes?i.readVarint()+i.pos:i.pos+1}function em(i,n,s){return s?4294967296*n+(i>>>0):4294967296*(n>>>0)+(i>>>0)}function zS(i,n,s){var c=n<=16383?1:n<=2097151?2:n<=268435455?3:Math.floor(Math.log(n)/(7*Math.LN2));s.realloc(c);for(var f=s.pos-1;f>=i;f--)s.buf[f+c]=s.buf[f]}function n5(i,n){for(var s=0;s<i.length;s++)n.writeVarint(i[s])}function r5(i,n){for(var s=0;s<i.length;s++)n.writeSVarint(i[s])}function i5(i,n){for(var s=0;s<i.length;s++)n.writeFloat(i[s])}function s5(i,n){for(var s=0;s<i.length;s++)n.writeDouble(i[s])}function o5(i,n){for(var s=0;s<i.length;s++)n.writeBoolean(i[s])}function a5(i,n){for(var s=0;s<i.length;s++)n.writeFixed32(i[s])}function l5(i,n){for(var s=0;s<i.length;s++)n.writeSFixed32(i[s])}function c5(i,n){for(var s=0;s<i.length;s++)n.writeFixed64(i[s])}function u5(i,n){for(var s=0;s<i.length;s++)n.writeSFixed64(i[s])}function F_(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+16777216*i[n+3]}function tm(i,n,s){i[s]=n,i[s+1]=n>>>8,i[s+2]=n>>>16,i[s+3]=n>>>24}function BS(i,n){return(i[n]|i[n+1]<<8|i[n+2]<<16)+(i[n+3]<<24)}Ar.prototype={destroy:function(){this.buf=null},readFields:function(i,n,s){for(s=s||this.length;this.pos<s;){var c=this.readVarint(),f=c>>3,y=this.pos;this.type=7&c,i(f,n,this),this.pos===y&&this.skip(c)}return n},readMessage:function(i,n){return this.readFields(i,n,this.readVarint()+this.pos)},readFixed32:function(){var i=F_(this.buf,this.pos);return this.pos+=4,i},readSFixed32:function(){var i=BS(this.buf,this.pos);return this.pos+=4,i},readFixed64:function(){var i=F_(this.buf,this.pos)+F_(this.buf,this.pos+4)*I0;return this.pos+=8,i},readSFixed64:function(){var i=F_(this.buf,this.pos)+BS(this.buf,this.pos+4)*I0;return this.pos+=8,i},readFloat:function(){var i=DS(this.buf,this.pos,!0,23,4);return this.pos+=4,i},readDouble:function(){var i=DS(this.buf,this.pos,!0,52,8);return this.pos+=8,i},readVarint:function(i){var n,s,c=this.buf;return n=127&(s=c[this.pos++]),s<128?n:(n|=(127&(s=c[this.pos++]))<<7,s<128?n:(n|=(127&(s=c[this.pos++]))<<14,s<128?n:(n|=(127&(s=c[this.pos++]))<<21,s<128?n:(function(f,y,w){var E,A,I=w.buf;if(E=(112&(A=I[w.pos++]))>>4,A<128||(E|=(127&(A=I[w.pos++]))<<3,A<128)||(E|=(127&(A=I[w.pos++]))<<10,A<128)||(E|=(127&(A=I[w.pos++]))<<17,A<128)||(E|=(127&(A=I[w.pos++]))<<24,A<128)||(E|=(1&(A=I[w.pos++]))<<31,A<128))return em(f,E,y);throw new Error("Expected varint not more than 10 bytes")})(n|=(15&(s=c[this.pos]))<<28,i,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var i=this.readVarint();return i%2==1?(i+1)/-2:i/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var i=this.readVarint()+this.pos,n=this.pos;return this.pos=i,i-n>=12&&OS?(function(s,c,f){return OS.decode(s.subarray(c,f))})(this.buf,n,i):(function(s,c,f){for(var y="",w=c;w<f;){var E,A,I,j=s[w],V=null,U=j>239?4:j>223?3:j>191?2:1;if(w+U>f)break;U===1?j<128&&(V=j):U===2?(192&(E=s[w+1]))==128&&(V=(31&j)<<6|63&E)<=127&&(V=null):U===3?(A=s[w+2],(192&(E=s[w+1]))==128&&(192&A)==128&&((V=(15&j)<<12|(63&E)<<6|63&A)<=2047||V>=55296&&V<=57343)&&(V=null)):U===4&&(A=s[w+2],I=s[w+3],(192&(E=s[w+1]))==128&&(192&A)==128&&(192&I)==128&&((V=(15&j)<<18|(63&E)<<12|(63&A)<<6|63&I)<=65535||V>=1114112)&&(V=null)),V===null?(V=65533,U=1):V>65535&&(V-=65536,y+=String.fromCharCode(V>>>10&1023|55296),V=56320|1023&V),y+=String.fromCharCode(V),w+=U}return y})(this.buf,n,i)},readBytes:function(){var i=this.readVarint()+this.pos,n=this.buf.subarray(this.pos,i);return this.pos=i,n},readPackedVarint:function(i,n){if(this.type!==Ar.Bytes)return i.push(this.readVarint(n));var s=Bu(this);for(i=i||[];this.pos<s;)i.push(this.readVarint(n));return i},readPackedSVarint:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSVarint());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSVarint());return i},readPackedBoolean:function(i){if(this.type!==Ar.Bytes)return i.push(this.readBoolean());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readBoolean());return i},readPackedFloat:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFloat());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFloat());return i},readPackedDouble:function(i){if(this.type!==Ar.Bytes)return i.push(this.readDouble());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readDouble());return i},readPackedFixed32:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFixed32());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFixed32());return i},readPackedSFixed32:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSFixed32());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed32());return i},readPackedFixed64:function(i){if(this.type!==Ar.Bytes)return i.push(this.readFixed64());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readFixed64());return i},readPackedSFixed64:function(i){if(this.type!==Ar.Bytes)return i.push(this.readSFixed64());var n=Bu(this);for(i=i||[];this.pos<n;)i.push(this.readSFixed64());return i},skip:function(i){var n=7&i;if(n===Ar.Varint)for(;this.buf[this.pos++]>127;);else if(n===Ar.Bytes)this.pos=this.readVarint()+this.pos;else if(n===Ar.Fixed32)this.pos+=4;else{if(n!==Ar.Fixed64)throw new Error("Unimplemented type: "+n);this.pos+=8}},writeTag:function(i,n){this.writeVarint(i<<3|n)},realloc:function(i){for(var n=this.length||16;n<this.pos+i;)n*=2;if(n!==this.length){var s=new Uint8Array(n);s.set(this.buf),this.buf=s,this.length=n}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(i){this.realloc(4),tm(this.buf,i,this.pos),this.pos+=4},writeSFixed32:function(i){this.realloc(4),tm(this.buf,i,this.pos),this.pos+=4},writeFixed64:function(i){this.realloc(8),tm(this.buf,-1&i,this.pos),tm(this.buf,Math.floor(i*jS),this.pos+4),this.pos+=8},writeSFixed64:function(i){this.realloc(8),tm(this.buf,-1&i,this.pos),tm(this.buf,Math.floor(i*jS),this.pos+4),this.pos+=8},writeVarint:function(i){(i=+i||0)>268435455||i<0?(function(n,s){var c,f;if(n>=0?(c=n%4294967296|0,f=n/4294967296|0):(f=~(-n/4294967296),4294967295^(c=~(-n%4294967296))?c=c+1|0:(c=0,f=f+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),(function(y,w,E){E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,y>>>=7,E.buf[E.pos++]=127&y|128,E.buf[E.pos]=127&(y>>>=7)})(c,0,s),(function(y,w){var E=(7&y)<<4;w.buf[w.pos++]|=E|((y>>>=3)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y|((y>>>=7)?128:0),y&&(w.buf[w.pos++]=127&y)))))})(f,s)})(i,this):(this.realloc(4),this.buf[this.pos++]=127&i|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=127&(i>>>=7)|(i>127?128:0),i<=127||(this.buf[this.pos++]=i>>>7&127))))},writeSVarint:function(i){this.writeVarint(i<0?2*-i-1:2*i)},writeBoolean:function(i){this.writeVarint(!!i)},writeString:function(i){i=String(i),this.realloc(4*i.length),this.pos++;var n=this.pos;this.pos=(function(c,f,y){for(var w,E,A=0;A<f.length;A++){if((w=f.charCodeAt(A))>55295&&w<57344){if(!E){w>56319||A+1===f.length?(c[y++]=239,c[y++]=191,c[y++]=189):E=w;continue}if(w<56320){c[y++]=239,c[y++]=191,c[y++]=189,E=w;continue}w=E-55296<<10|w-56320|65536,E=null}else E&&(c[y++]=239,c[y++]=191,c[y++]=189,E=null);w<128?c[y++]=w:(w<2048?c[y++]=w>>6|192:(w<65536?c[y++]=w>>12|224:(c[y++]=w>>18|240,c[y++]=w>>12&63|128),c[y++]=w>>6&63|128),c[y++]=63&w|128)}return y})(this.buf,i,this.pos);var s=this.pos-n;s>=128&&zS(n,s,this),this.pos=n-1,this.writeVarint(s),this.pos+=s},writeFloat:function(i){this.realloc(4),LS(this.buf,i,this.pos,!0,23,4),this.pos+=4},writeDouble:function(i){this.realloc(8),LS(this.buf,i,this.pos,!0,52,8),this.pos+=8},writeBytes:function(i){var n=i.length;this.writeVarint(n),this.realloc(n);for(var s=0;s<n;s++)this.buf[this.pos++]=i[s]},writeRawMessage:function(i,n){this.pos++;var s=this.pos;i(n,this);var c=this.pos-s;c>=128&&zS(s,c,this),this.pos=s-1,this.writeVarint(c),this.pos+=c},writeMessage:function(i,n,s){this.writeTag(i,Ar.Bytes),this.writeRawMessage(n,s)},writePackedVarint:function(i,n){n.length&&this.writeMessage(i,n5,n)},writePackedSVarint:function(i,n){n.length&&this.writeMessage(i,r5,n)},writePackedBoolean:function(i,n){n.length&&this.writeMessage(i,o5,n)},writePackedFloat:function(i,n){n.length&&this.writeMessage(i,i5,n)},writePackedDouble:function(i,n){n.length&&this.writeMessage(i,s5,n)},writePackedFixed32:function(i,n){n.length&&this.writeMessage(i,a5,n)},writePackedSFixed32:function(i,n){n.length&&this.writeMessage(i,l5,n)},writePackedFixed64:function(i,n){n.length&&this.writeMessage(i,c5,n)},writePackedSFixed64:function(i,n){n.length&&this.writeMessage(i,u5,n)},writeBytesField:function(i,n){this.writeTag(i,Ar.Bytes),this.writeBytes(n)},writeFixed32Field:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeFixed32(n)},writeSFixed32Field:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeSFixed32(n)},writeFixed64Field:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeFixed64(n)},writeSFixed64Field:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeSFixed64(n)},writeVarintField:function(i,n){this.writeTag(i,Ar.Varint),this.writeVarint(n)},writeSVarintField:function(i,n){this.writeTag(i,Ar.Varint),this.writeSVarint(n)},writeStringField:function(i,n){this.writeTag(i,Ar.Bytes),this.writeString(n)},writeFloatField:function(i,n){this.writeTag(i,Ar.Fixed32),this.writeFloat(n)},writeDoubleField:function(i,n){this.writeTag(i,Ar.Fixed64),this.writeDouble(n)},writeBooleanField:function(i,n){this.writeVarintField(i,!!n)}};var V_=pe(NS);const M0=3;function d5(i,n,s){n.glyphs=[],i===1&&s.readMessage(h5,n)}function h5(i,n,s){if(i===3){const{id:c,bitmap:f,width:y,height:w,left:E,top:A,advance:I}=s.readMessage(f5,{});n.glyphs.push({id:c,bitmap:new fo({width:y+2*M0,height:w+2*M0},f),metrics:{width:y,height:w,left:E,top:A,advance:I}})}else i===4?n.ascender=s.readSVarint():i===5&&(n.descender=s.readSVarint())}function f5(i,n,s){i===1?n.id=s.readVarint():i===2?n.bitmap=s.readBytes():i===3?n.width=s.readVarint():i===4?n.height=s.readVarint():i===5?n.left=s.readSVarint():i===6?n.top=s.readSVarint():i===7&&(n.advance=s.readVarint())}const FS=M0;function P0(i){let n=0,s=0;for(const w of i)n+=w.w*w.h,s=Math.max(s,w.w);i.sort(((w,E)=>E.h-w.h));const c=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(n/.95)),s),h:1/0}];let f=0,y=0;for(const w of i)for(let E=c.length-1;E>=0;E--){const A=c[E];if(!(w.w>A.w||w.h>A.h)){if(w.x=A.x,w.y=A.y,y=Math.max(y,w.y+w.h),f=Math.max(f,w.x+w.w),w.w===A.w&&w.h===A.h){const I=c.pop();E<c.length&&(c[E]=I)}else w.h===A.h?(A.x+=w.w,A.w-=w.w):w.w===A.w?(A.y+=w.h,A.h-=w.h):(c.push({x:A.x+w.w,y:A.y,w:A.w-w.w,h:w.h}),A.y+=w.h,A.h-=w.h);break}}return{w:f,h:y,fill:n/(f*y)||0}}const Po=1;class R0{constructor(n,{pixelRatio:s,version:c,stretchX:f,stretchY:y,content:w}){this.paddedRect=n,this.pixelRatio=s,this.stretchX=f,this.stretchY=y,this.content=w,this.version=c}get tl(){return[this.paddedRect.x+Po,this.paddedRect.y+Po]}get br(){return[this.paddedRect.x+this.paddedRect.w-Po,this.paddedRect.y+this.paddedRect.h-Po]}get displaySize(){return[(this.paddedRect.w-2*Po)/this.pixelRatio,(this.paddedRect.h-2*Po)/this.pixelRatio]}}class VS{constructor(n,s){const c={},f={};this.haveRenderCallbacks=[];const y=[];this.addImages(n,c,y),this.addImages(s,f,y);const{w,h:E}=P0(y),A=new Hs({width:w||1,height:E||1});for(const I in n){const j=n[I],V=c[I].paddedRect;Hs.copy(j.data,A,{x:0,y:0},{x:V.x+Po,y:V.y+Po},j.data)}for(const I in s){const j=s[I],V=f[I].paddedRect,U=V.x+Po,q=V.y+Po,X=j.data.width,te=j.data.height;Hs.copy(j.data,A,{x:0,y:0},{x:U,y:q},j.data),Hs.copy(j.data,A,{x:0,y:te-1},{x:U,y:q-1},{width:X,height:1}),Hs.copy(j.data,A,{x:0,y:0},{x:U,y:q+te},{width:X,height:1}),Hs.copy(j.data,A,{x:X-1,y:0},{x:U-1,y:q},{width:1,height:te}),Hs.copy(j.data,A,{x:0,y:0},{x:U+X,y:q},{width:1,height:te})}this.image=A,this.iconPositions=c,this.patternPositions=f}addImages(n,s,c){for(const f in n){const y=n[f],w={x:0,y:0,w:y.data.width+2*Po,h:y.data.height+2*Po};c.push(w),s[f]=new R0(w,y),y.hasRenderCallback&&this.haveRenderCallbacks.push(f)}}patchUpdatedImages(n,s){this.haveRenderCallbacks=this.haveRenderCallbacks.filter((c=>n.hasImage(c))),n.dispatchRenderCallbacks(this.haveRenderCallbacks);for(const c in n.updatedImages)this.patchUpdatedImage(this.iconPositions[c],n.getImage(c),s),this.patchUpdatedImage(this.patternPositions[c],n.getImage(c),s)}patchUpdatedImage(n,s,c){if(!n||!s||n.version===s.version)return;n.version=s.version;const[f,y]=n.tl;c.update(s.data,void 0,{x:f,y})}}Ft(R0,"ImagePosition"),Ft(VS,"ImageAtlas");const wa={horizontal:1,vertical:2,horizontalOnly:3},US=-17;class Bg{constructor(){this.scale=1,this.fontStack="",this.imageName=null}static forText(n,s){const c=new Bg;return c.scale=n||1,c.fontStack=s,c}static forImage(n){const s=new Bg;return s.imageName=n,s}}class nm{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(n,s){const c=new nm;for(let f=0;f<n.sections.length;f++){const y=n.sections[f];y.image?c.addImageSection(y):c.addTextSection(y,s)}return c}length(){return this.text.length}getSection(n){return this.sections[this.sectionIndex[n]]}getSections(){return this.sections}getSectionIndex(n){return this.sectionIndex[n]}getCharCode(n){return this.text.charCodeAt(n)}verticalizePunctuation(n){this.text=(function(s,c){let f="";for(let y=0;y<s.length;y++){const w=s.charCodeAt(y+1)||null,E=s.charCodeAt(y-1)||null;f+=!c&&(w&&Bs(w)&&!zg[s[y+1]]||E&&Bs(E)&&!zg[s[y-1]])||!zg[s[y]]?s[y]:zg[s[y]]}return f})(this.text,n)}trim(){let n=0;for(let c=0;c<this.text.length&&U_[this.text.charCodeAt(c)];c++)n++;let s=this.text.length;for(let c=this.text.length-1;c>=0&&c>=n&&U_[this.text.charCodeAt(c)];c--)s--;this.text=this.text.substring(n,s),this.sectionIndex=this.sectionIndex.slice(n,s)}substring(n,s){const c=new nm;return c.text=this.text.substring(n,s),c.sectionIndex=this.sectionIndex.slice(n,s),c.sections=this.sections,c}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce(((n,s)=>Math.max(n,this.sections[s].scale)),0)}addTextSection(n,s){this.text+=n.text,this.sections.push(Bg.forText(n.scale,n.fontStack||s));const c=this.sections.length-1;for(let f=0;f<n.text.length;++f)this.sectionIndex.push(c)}addImageSection(n){const s=n.image?n.image.name:"";if(s.length===0)return void Xn("Can't add FormattedSection with an empty image.");const c=this.getNextImageSectionCharCode();c?(this.text+=String.fromCharCode(c),this.sections.push(Bg.forImage(s)),this.sectionIndex.push(this.sections.length-1)):Xn("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function N0(i,n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=nm.fromFeature(i,f);V===wa.vertical&&te.verticalizePunctuation(U);let ae=[];const ge=(function(Me,Qe,Xe,ft,It,nt){if(!Me)return[];const yt=[],_t=(function(Bt,Jt,$t,Nn,Nt,cn){let Dn=0;for(let cr=0;cr<Bt.length();cr++){const Ln=Bt.getSection(cr);Dn+=$S(Bt.getCharCode(cr),Ln,Nn,Nt,Jt,cn)}return Dn/Math.max(1,Math.ceil(Dn/$t))})(Me,Qe,Xe,ft,It,nt),Ct=Me.text.indexOf("")>=0;let Pt=0;for(let Bt=0;Bt<Me.length();Bt++){const Jt=Me.getSection(Bt),$t=Me.getCharCode(Bt);if(U_[$t]||(Pt+=$S($t,Jt,ft,It,Qe,nt)),Bt<Me.length()-1){const Nn=!((ct=$t)<11904||!(Ot["Bopomofo Extended"](ct)||Ot.Bopomofo(ct)||Ot["CJK Compatibility Forms"](ct)||Ot["CJK Compatibility Ideographs"](ct)||Ot["CJK Compatibility"](ct)||Ot["CJK Radicals Supplement"](ct)||Ot["CJK Strokes"](ct)||Ot["CJK Symbols and Punctuation"](ct)||Ot["CJK Unified Ideographs Extension A"](ct)||Ot["CJK Unified Ideographs"](ct)||Ot["Enclosed CJK Letters and Months"](ct)||Ot["Halfwidth and Fullwidth Forms"](ct)||Ot.Hiragana(ct)||Ot["Ideographic Description Characters"](ct)||Ot["Kangxi Radicals"](ct)||Ot["Katakana Phonetic Extensions"](ct)||Ot.Katakana(ct)||Ot["Vertical Forms"](ct)||Ot["Yi Radicals"](ct)||Ot["Yi Syllables"](ct)));(p5[$t]||Nn||Jt.imageName)&&yt.push(HS(Bt+1,Pt,_t,yt,m5($t,Me.getCharCode(Bt+1),Nn&&Ct),!1))}}var ct;return WS(HS(Me.length(),Pt,_t,yt,0,!0))})(te,I,y,n,c,q),{processBidirectionalText:Ce,processStyledBidirectionalText:ye}=D;if(Ce&&te.sections.length===1){const Me=Ce(te.toString(),ge);for(const Qe of Me){const Xe=new nm;Xe.text=Qe,Xe.sections=te.sections;for(let ft=0;ft<Qe.length;ft++)Xe.sectionIndex.push(0);ae.push(Xe)}}else if(ye){const Me=ye(te.text,te.sectionIndex,ge);for(const Qe of Me){const Xe=new nm;Xe.text=Qe[0],Xe.sectionIndex=Qe[1],Xe.sections=te.sections,ae.push(Xe)}}else ae=(function(Me,Qe){const Xe=[],ft=Me.text;let It=0;for(const nt of Qe)Xe.push(Me.substring(It,nt)),It=nt;return It<ft.length&&Xe.push(Me.substring(It,ft.length)),Xe})(te,ge);const Ee=[],Re={positionedLines:Ee,text:te.toString(),top:j[1],bottom:j[1],left:j[0],right:j[0],writingMode:V,iconsInText:!1,verticalizable:!1,hasBaseline:!1};return(function(Me,Qe,Xe,ft,It,nt,yt,_t,Ct,Pt,ct,Bt){let Jt=0,$t=0,Nn=0;const Nt=_t==="right"?1:_t==="left"?0:.5;let cn=!1;for(const On of It){const zn=On.getSections();for(const wr of zn){if(wr.imageName)continue;const Ir=Qe[wr.fontStack];if(Ir&&(cn=Ir.ascender!==void 0&&Ir.descender!==void 0,!cn))break}if(!cn)break}let Dn=0;for(const On of It){On.trim();const zn=On.getMaxScale(),wr=(zn-1)*hs,Ir={positionedGlyphs:[],lineOffset:0};Me.positionedLines[Dn]=Ir;const Mr=Ir.positionedGlyphs;let br=0;if(!On.length()){$t+=nt,++Dn;continue}let Wr=0,li=0;for(let Tr=0;Tr<On.length();Tr++){const Oi=On.getSection(Tr),Si=On.getSectionIndex(Tr),Qr=On.getCharCode(Tr);let pr=Oi.scale,Ei=null,Pr=null,mo=null,Ci=hs,fs=0;const es=!(Ct===wa.horizontal||!ct&&!bc(Qr)||ct&&(U_[Qr]||(cr=Qr,Ot.Arabic(cr)||Ot["Arabic Supplement"](cr)||Ot["Arabic Extended-A"](cr)||Ot["Arabic Presentation Forms-A"](cr)||Ot["Arabic Presentation Forms-B"](cr))));if(Oi.imageName){const go=ft[Oi.imageName];if(!go)continue;mo=Oi.imageName,Me.iconsInText=Me.iconsInText||!0,Pr=go.paddedRect;const ts=go.displaySize;pr=pr*hs/Bt,Ei={width:ts[0],height:ts[1],left:Po,top:-FS,advance:es?ts[1]:ts[0],localGlyph:!1},fs=cn?-Ei.height*pr:US+zn*hs-ts[1]*pr,Ci=Ei.advance;const Ll=(es?ts[0]:ts[1])*pr-hs*zn;Ll>0&&Ll>br&&(br=Ll)}else{const go=Xe[Oi.fontStack];if(!go)continue;go[Qr]&&(Pr=go[Qr]);const ts=Qe[Oi.fontStack];if(!ts)continue;const Ll=ts.glyphs[Qr];if(!Ll)continue;if(Ei=Ll.metrics,Ci=Qr!==8203?hs:0,cn){const cm=ts.ascender!==void 0?Math.abs(ts.ascender):0,Xg=ts.descender!==void 0?Math.abs(ts.descender):0,Kg=(cm+Xg)*pr;Wr<Kg&&(Wr=Kg,li=(cm-Xg)/2*pr),fs=-cm*pr}else fs=US+(zn-pr)*hs}es?(Me.verticalizable=!0,Mr.push({glyph:Qr,imageName:mo,x:Jt,y:$t+fs,vertical:es,scale:pr,localGlyph:Ei.localGlyph,fontStack:Oi.fontStack,sectionIndex:Si,metrics:Ei,rect:Pr}),Jt+=Ci*pr+Pt):(Mr.push({glyph:Qr,imageName:mo,x:Jt,y:$t+fs,vertical:es,scale:pr,localGlyph:Ei.localGlyph,fontStack:Oi.fontStack,sectionIndex:Si,metrics:Ei,rect:Pr}),Jt+=Ei.advance*pr+Pt)}Mr.length!==0&&(Nn=Math.max(Jt-Pt,Nn),cn?qS(Mr,Nt,br,li,nt*zn/2):qS(Mr,Nt,br,0,nt/2)),Jt=0;const Ti=nt*zn+br;Ir.lineOffset=Math.max(br,wr),$t+=Ti,++Dn}var cr;const Ln=$t,{horizontalAlign:wn,verticalAlign:Lr}=D0(yt);(function(On,zn,wr,Ir,Mr,br){const Wr=(zn-wr)*Mr,li=-br*Ir;for(const Ti of On)for(const Tr of Ti.positionedGlyphs)Tr.x+=Wr,Tr.y+=li})(Me.positionedLines,Nt,wn,Lr,Nn,Ln),Me.top+=-Lr*Ln,Me.bottom=Me.top+Ln,Me.left+=-wn*Nn,Me.right=Me.left+Nn,Me.hasBaseline=cn})(Re,n,s,c,ae,w,E,A,V,I,U,X),!(function(Me){for(const Qe of Me)if(Qe.positionedGlyphs.length!==0)return!1;return!0})(Ee)&&Re}const U_={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},p5={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function $S(i,n,s,c,f,y){if(n.imageName){const w=c[n.imageName];return w?w.displaySize[0]*n.scale*hs/y+f:0}{const w=s[n.fontStack],E=w&&w.glyphs[i];return E?E.metrics.advance*n.scale+f:0}}function GS(i,n,s,c){const f=Math.pow(i-n,2);return c?i<n?f/2:2*f:f+Math.abs(s)*s}function m5(i,n,s){let c=0;return i===10&&(c-=1e4),s&&(c+=150),i!==40&&i!==65288||(c+=50),n!==41&&n!==65289||(c+=50),c}function HS(i,n,s,c,f,y){let w=null,E=GS(n,s,f,y);for(const A of c){const I=GS(n-A.x,s,f,y)+A.badness;I<=E&&(w=A,E=I)}return{index:i,x:n,priorBreak:w,badness:E}}function WS(i){return i?WS(i.priorBreak).concat(i.index):[]}function D0(i){let n=.5,s=.5;switch(i){case"right":case"top-right":case"bottom-right":n=1;break;case"left":case"top-left":case"bottom-left":n=0}switch(i){case"bottom":case"bottom-right":case"bottom-left":s=1;break;case"top":case"top-right":case"top-left":s=0}return{horizontalAlign:n,verticalAlign:s}}function qS(i,n,s,c,f){if(!(n||s||c||f))return;const y=i.length-1,w=i[y],E=(w.x+w.metrics.advance*w.scale)*n;for(let A=0;A<=y;A++)i[A].x-=E,i[A].y+=s+c+f}function g5(i,n,s){const{horizontalAlign:c,verticalAlign:f}=D0(s),y=n[0]-i.displaySize[0]*c,w=n[1]-i.displaySize[1]*f;return{image:i,top:w,bottom:w+i.displaySize[1],left:y,right:y+i.displaySize[0]}}function ZS(i,n,s,c,f,y){const w=i.image;let E;if(w.content){const ae=w.content,ge=w.pixelRatio||1;E=[ae[0]/ge,ae[1]/ge,w.displaySize[0]-ae[2]/ge,w.displaySize[1]-ae[3]/ge]}const A=n.left*y,I=n.right*y;let j,V,U,q;s==="width"||s==="both"?(q=f[0]+A-c[3],V=f[0]+I+c[1]):(q=f[0]+(A+I-w.displaySize[0])/2,V=q+w.displaySize[0]);const X=n.top*y,te=n.bottom*y;return s==="height"||s==="both"?(j=f[1]+X-c[0],U=f[1]+te+c[2]):(j=f[1]+(X+te-w.displaySize[1])/2,U=j+w.displaySize[1]),{image:w,top:j,right:V,bottom:U,left:q,collisionPadding:E}}class Fu extends Pe{constructor(n,s,c,f,y){super(n,s),this.angle=f,this.z=c,y!==void 0&&(this.segment=y)}clone(){return new Fu(this.x,this.y,this.z,this.angle,this.segment)}}function XS(i,n,s,c,f){if(n.segment===void 0)return!0;let y=n,w=n.segment+1,E=0;for(;E>-s/2;){if(w--,w<0)return!1;E-=i[w].dist(y),y=i[w]}E+=i[w].dist(i[w+1]),w++;const A=[];let I=0;for(;E<s/2;){const j=i[w],V=i[w+1];if(!V)return!1;let U=i[w-1].angleTo(j)-j.angleTo(V);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),A.push({distance:E,angleDelta:U}),I+=U;E-A[0].distance>c;)I-=A.shift().angleDelta;if(I>f)return!1;w++,E+=j.dist(V)}return!0}function KS(i){let n=0;for(let s=0;s<i.length-1;s++)n+=i[s].dist(i[s+1]);return n}function YS(i,n,s){return i?.6*n*s:0}function JS(i,n){return Math.max(i?i.right-i.left:0,n?n.right-n.left:0)}function y5(i,n,s,c,f,y){const w=YS(s,f,y),E=JS(s,c)*y;let A=0;const I=KS(i)/2;for(let j=0;j<i.length-1;j++){const V=i[j],U=i[j+1],q=V.dist(U);if(A+q>I){const X=(I-A)/q,te=Kn(V.x,U.x,X),ae=Kn(V.y,U.y,X),ge=new Fu(te,ae,0,U.angleTo(V),j);return!w||XS(i,ge,E,w,n)?ge:void 0}A+=q}}function _5(i,n,s,c,f,y,w,E,A){const I=YS(c,y,w),j=JS(c,f),V=j*w,U=i[0].x===0||i[0].x===A||i[0].y===0||i[0].y===A;return n-V<n/4&&(n=V+n/4),QS(i,U?n/2*E%n:(j/2+2*y)*w*E%n,n,I,s,V,U,!1,A)}function QS(i,n,s,c,f,y,w,E,A){const I=y/2,j=KS(i);let V=0,U=n-s,q=[];for(let X=0;X<i.length-1;X++){const te=i[X],ae=i[X+1],ge=te.dist(ae),Ce=ae.angleTo(te);for(;U+s<V+ge;){U+=s;const ye=(U-V)/ge,Ee=Kn(te.x,ae.x,ye),Re=Kn(te.y,ae.y,ye);if(Ee>=0&&Ee<A&&Re>=0&&Re<A&&U-I>=0&&U+I<=j){const Me=new Fu(Ee,Re,0,Ce,X);Me._round(),c&&!XS(i,Me,y,c,f)||q.push(Me)}}V+=ge}return E||q.length||w||(q=QS(i,V/2,s,c,f,y,w,!0,A)),q}function eE(i,n,s,c,f){const y=[];for(let w=0;w<i.length;w++){const E=i[w];let A;for(let I=0;I<E.length-1;I++){let j=E[I],V=E[I+1];j.x<n&&V.x<n||(j.x<n?j=new Pe(n,j.y+(n-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x<n&&(V=new Pe(n,j.y+(n-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y<s&&V.y<s||(j.y<s?j=new Pe(j.x+(s-j.y)/(V.y-j.y)*(V.x-j.x),s)._round():V.y<s&&(V=new Pe(j.x+(s-j.y)/(V.y-j.y)*(V.x-j.x),s)._round()),j.x>=c&&V.x>=c||(j.x>=c?j=new Pe(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round():V.x>=c&&(V=new Pe(c,j.y+(c-j.x)/(V.x-j.x)*(V.y-j.y))._round()),j.y>=f&&V.y>=f||(j.y>=f?j=new Pe(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round():V.y>=f&&(V=new Pe(j.x+(f-j.y)/(V.y-j.y)*(V.x-j.x),f)._round()),A&&j.equals(A[A.length-1])||(A=[j],y.push(A)),A.push(V)))))}}return y}Ft(Fu,"Anchor");const Fg=1e20;function tE(i,n,s,c,f,y,w,E,A){for(let I=n;I<n+c;I++)nE(i,s*y+I,y,f,w,E,A);for(let I=s;I<s+f;I++)nE(i,I*y+n,1,c,w,E,A)}function nE(i,n,s,c,f,y,w){y[0]=0,w[0]=-Fg,w[1]=Fg,f[0]=i[n];for(let E=1,A=0,I=0;E<c;E++){f[E]=i[n+E*s];const j=E*E;do{const V=y[A];I=(f[E]-f[V]+j-V*V)/(E-V)/2}while(I<=w[A]&&--A>-1);A++,y[A]=E,w[A]=I,w[A+1]=Fg}for(let E=0,A=0;E<c;E++){for(;w[A+1]<E;)A++;const I=y[A],j=E-I;i[n+E*s]=f[I]+j*j}}const Nl=2,L0={none:0,ideographs:1,all:2};class rm{constructor(n,s,c){this.requestManager=n,this.localGlyphMode=s,this.localFontFamily=c,this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(n){this.url=n}getGlyphs(n,s){const c=[];for(const f in n)for(const y of n[f])c.push({stack:f,id:y});Fe(c,(({stack:f,id:y},w)=>{let E=this.entries[f];E||(E=this.entries[f]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let A=E.glyphs[y];if(A!==void 0)return void w(null,{stack:f,id:y,glyph:A});if(A=this._tinySDF(E,f,y),A)return E.glyphs[y]=A,void w(null,{stack:f,id:y,glyph:A});const I=Math.floor(y/256);if(256*I>65535)return void w(new Error("glyphs > 65535 not supported"));if(E.ranges[I])return void w(null,{stack:f,id:y,glyph:A});let j=E.requests[I];j||(j=E.requests[I]=[],rm.loadGlyphRange(f,I,this.url,this.requestManager,((V,U)=>{if(U){E.ascender=U.ascender,E.descender=U.descender;for(const q in U.glyphs)this._doesCharSupportLocalGlyph(+q)||(E.glyphs[+q]=U.glyphs[+q]);E.ranges[I]=!0}for(const q of j)q(V,U);delete E.requests[I]}))),j.push(((V,U)=>{V?w(V):U&&w(null,{stack:f,id:y,glyph:U.glyphs[y]||null})}))}),((f,y)=>{if(f)s(f);else if(y){const w={};for(const{stack:E,id:A,glyph:I}of y)w[E]===void 0&&(w[E]={}),w[E].glyphs===void 0&&(w[E].glyphs={}),w[E].glyphs[A]=I&&{id:I.id,bitmap:I.bitmap.clone(),metrics:I.metrics},w[E].ascender=this.entries[E].ascender,w[E].descender=this.entries[E].descender;s(null,w)}}))}_doesCharSupportLocalGlyph(n){return this.localGlyphMode!==L0.none&&(this.localGlyphMode===L0.all?!!this.localFontFamily:!!this.localFontFamily&&(Ot["CJK Unified Ideographs"](n)||Ot["Hangul Syllables"](n)||Ot.Hiragana(n)||Ot.Katakana(n)||Ot["CJK Symbols and Punctuation"](n)))}_tinySDF(n,s,c){const f=this.localFontFamily;if(!f||!this._doesCharSupportLocalGlyph(c))return;let y=n.tinySDF;if(!y){let te="400";/bold/i.test(s)?te="900":/medium/i.test(s)?te="500":/light/i.test(s)&&(te="200"),y=n.tinySDF=new rm.TinySDF({fontFamily:f,fontWeight:te,fontSize:24*Nl,buffer:3*Nl,radius:8*Nl}),y.fontWeight=te}if(this.localGlyphs[y.fontWeight][c])return this.localGlyphs[y.fontWeight][c];const w=String.fromCharCode(c),{data:E,width:A,height:I,glyphWidth:j,glyphHeight:V,glyphLeft:U,glyphTop:q,glyphAdvance:X}=y.draw(w);return this.localGlyphs[y.fontWeight][c]={id:c,bitmap:new fo({width:A,height:I},E),metrics:{width:j/Nl,height:V/Nl,left:U/Nl,top:q/Nl-27,advance:X/Nl,localGlyph:!0}}}}rm.loadGlyphRange=function(i,n,s,c,f){const y=256*n,w=y+255,E=c.transformRequest(c.normalizeGlyphsURL(s).replace("{fontstack}",i).replace("{range}",`${y}-${w}`),Ai.Glyphs);Ys(E,((A,I)=>{if(A)f(A);else if(I){const j={},V=(function(U){return new V_(U).readFields(d5,{})})(I);for(const U of V.glyphs)j[U.id]=U;f(null,{glyphs:j,ascender:V.ascender,descender:V.descender})}}))},rm.TinySDF=class{constructor({fontSize:i=24,buffer:n=3,radius:s=8,cutoff:c=.25,fontFamily:f="sans-serif",fontWeight:y="normal",fontStyle:w="normal"}={}){this.buffer=n,this.cutoff=c,this.radius=s;const E=this.size=i+4*n,A=this._createCanvas(E),I=this.ctx=A.getContext("2d",{willReadFrequently:!0});I.font=`${w} ${y} ${i}px ${f}`,I.textBaseline="alphabetic",I.textAlign="left",I.fillStyle="black",this.gridOuter=new Float64Array(E*E),this.gridInner=new Float64Array(E*E),this.f=new Float64Array(E),this.z=new Float64Array(E+1),this.v=new Uint16Array(E)}_createCanvas(i){const n=document.createElement("canvas");return n.width=n.height=i,n}draw(i){const{width:n,actualBoundingBoxAscent:s,actualBoundingBoxDescent:c,actualBoundingBoxLeft:f,actualBoundingBoxRight:y}=this.ctx.measureText(i),w=Math.ceil(s),E=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(y-f))),A=Math.min(this.size-this.buffer,w+Math.ceil(c)),I=E+2*this.buffer,j=A+2*this.buffer,V=Math.max(I*j,0),U=new Uint8ClampedArray(V),q={data:U,width:I,height:j,glyphWidth:E,glyphHeight:A,glyphTop:w,glyphLeft:0,glyphAdvance:n};if(E===0||A===0)return q;const{ctx:X,buffer:te,gridInner:ae,gridOuter:ge}=this;X.clearRect(te,te,E,A),X.fillText(i,te,te+w);const Ce=X.getImageData(te,te,E,A);ge.fill(Fg,0,V),ae.fill(0,0,V);for(let ye=0;ye<A;ye++)for(let Ee=0;Ee<E;Ee++){const Re=Ce.data[4*(ye*E+Ee)+3]/255;if(Re===0)continue;const Me=(ye+te)*I+Ee+te;if(Re===1)ge[Me]=0,ae[Me]=Fg;else{const Qe=.5-Re;ge[Me]=Qe>0?Qe*Qe:0,ae[Me]=Qe<0?Qe*Qe:0}}tE(ge,0,0,I,j,I,this.f,this.v,this.z),tE(ae,te,te,E,A,I,this.f,this.v,this.z);for(let ye=0;ye<V;ye++){const Ee=Math.sqrt(ge[ye])-Math.sqrt(ae[ye]);U[ye]=Math.round(255-255*(Ee/this.radius+this.cutoff))}return q}};const im=Po;function rE(i,n,s,c){const f=[],y=i.image,w=y.pixelRatio,E=y.paddedRect.w-2*im,A=y.paddedRect.h-2*im,I=i.right-i.left,j=i.bottom-i.top,V=y.stretchX||[[0,E]],U=y.stretchY||[[0,A]],q=(nt,yt)=>nt+yt[1]-yt[0],X=V.reduce(q,0),te=U.reduce(q,0),ae=E-X,ge=A-te;let Ce=0,ye=X,Ee=0,Re=te,Me=0,Qe=ae,Xe=0,ft=ge;if(y.content&&c){const nt=y.content;Ce=$_(V,0,nt[0]),Ee=$_(U,0,nt[1]),ye=$_(V,nt[0],nt[2]),Re=$_(U,nt[1],nt[3]),Me=nt[0]-Ce,Xe=nt[1]-Ee,Qe=nt[2]-nt[0]-ye,ft=nt[3]-nt[1]-Re}const It=(nt,yt,_t,Ct)=>{const Pt=G_(nt.stretch-Ce,ye,I,i.left),ct=H_(nt.fixed-Me,Qe,nt.stretch,X),Bt=G_(yt.stretch-Ee,Re,j,i.top),Jt=H_(yt.fixed-Xe,ft,yt.stretch,te),$t=G_(_t.stretch-Ce,ye,I,i.left),Nn=H_(_t.fixed-Me,Qe,_t.stretch,X),Nt=G_(Ct.stretch-Ee,Re,j,i.top),cn=H_(Ct.fixed-Xe,ft,Ct.stretch,te),Dn=new Pe(Pt,Bt),cr=new Pe($t,Bt),Ln=new Pe($t,Nt),wn=new Pe(Pt,Nt),Lr=new Pe(ct/w,Jt/w),On=new Pe(Nn/w,cn/w),zn=n*Math.PI/180;if(zn){const Mr=Math.sin(zn),br=Math.cos(zn),Wr=[br,-Mr,Mr,br];Dn._matMult(Wr),cr._matMult(Wr),wn._matMult(Wr),Ln._matMult(Wr)}const wr=nt.stretch+nt.fixed,Ir=yt.stretch+yt.fixed;return{tl:Dn,tr:cr,bl:wn,br:Ln,tex:{x:y.paddedRect.x+im+wr,y:y.paddedRect.y+im+Ir,w:_t.stretch+_t.fixed-wr,h:Ct.stretch+Ct.fixed-Ir},writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:Lr,pixelOffsetBR:On,minFontScaleX:Qe/w/I,minFontScaleY:ft/w/j,isSDF:s}};if(c&&(y.stretchX||y.stretchY)){const nt=iE(V,ae,X),yt=iE(U,ge,te);for(let _t=0;_t<nt.length-1;_t++){const Ct=nt[_t],Pt=nt[_t+1];for(let ct=0;ct<yt.length-1;ct++)f.push(It(Ct,yt[ct],Pt,yt[ct+1]))}}else f.push(It({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:E+1},{fixed:0,stretch:A+1}));return f}function $_(i,n,s){let c=0;for(const f of i)c+=Math.max(n,Math.min(s,f[1]))-Math.max(n,Math.min(s,f[0]));return c}function iE(i,n,s){const c=[{fixed:-im,stretch:0}];for(const[f,y]of i){const w=c[c.length-1];c.push({fixed:f-w.stretch,stretch:w.stretch}),c.push({fixed:f-w.stretch,stretch:w.stretch+(y-f)})}return c.push({fixed:n+im,stretch:s}),c}function G_(i,n,s,c){return i/n*s+c}function H_(i,n,s,c){return i-n*s/c}function x5(i,n,s,c){const f=n+i.positionedLines[c].lineOffset;return c===0?s+f/2:s+(f+(n+i.positionedLines[c-1].lineOffset))/2}class v5{constructor(n=[],s=w5){if(this.data=n,this.length=this.data.length,this.compare=s,this.length>0)for(let c=(this.length>>1)-1;c>=0;c--)this._down(c)}push(n){this.data.push(n),this.length++,this._up(this.length-1)}pop(){if(this.length===0)return;const n=this.data[0],s=this.data.pop();return this.length--,this.length>0&&(this.data[0]=s,this._down(0)),n}peek(){return this.data[0]}_up(n){const{data:s,compare:c}=this,f=s[n];for(;n>0;){const y=n-1>>1,w=s[y];if(c(f,w)>=0)break;s[n]=w,n=y}s[n]=f}_down(n){const{data:s,compare:c}=this,f=this.length>>1,y=s[n];for(;n<f;){let w=1+(n<<1),E=s[w];const A=w+1;if(A<this.length&&c(s[A],E)<0&&(w=A,E=s[A]),c(E,y)>=0)break;s[n]=E,n=w}s[n]=y}}function w5(i,n){return i<n?-1:i>n?1:0}function b5(i,n=1,s=!1){let c=1/0,f=1/0,y=-1/0,w=-1/0;const E=i[0];for(let q=0;q<E.length;q++){const X=E[q];(!q||X.x<c)&&(c=X.x),(!q||X.y<f)&&(f=X.y),(!q||X.x>y)&&(y=X.x),(!q||X.y>w)&&(w=X.y)}const A=Math.min(y-c,w-f);let I=A/2;const j=new v5([],T5);if(A===0)return new Pe(c,f);for(let q=c;q<y;q+=A)for(let X=f;X<w;X+=A)j.push(new sm(q+I,X+I,I,i));let V=(function(q){let X=0,te=0,ae=0;const ge=q[0];for(let Ce=0,ye=ge.length,Ee=ye-1;Ce<ye;Ee=Ce++){const Re=ge[Ce],Me=ge[Ee],Qe=Re.x*Me.y-Me.x*Re.y;te+=(Re.x+Me.x)*Qe,ae+=(Re.y+Me.y)*Qe,X+=3*Qe}return new sm(te/X,ae/X,0,q)})(i),U=j.length;for(;j.length;){const q=j.pop();(q.d>V.d||!V.d)&&(V=q,s&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,U)),q.max-V.d<=n||(I=q.h/2,j.push(new sm(q.p.x-I,q.p.y-I,I,i)),j.push(new sm(q.p.x+I,q.p.y-I,I,i)),j.push(new sm(q.p.x-I,q.p.y+I,I,i)),j.push(new sm(q.p.x+I,q.p.y+I,I,i)),U+=4)}return s&&(console.log(`num probes: ${U}`),console.log(`best distance: ${V.d}`)),V.p}function T5(i,n){return n.max-i.max}class sm{constructor(n,s,c,f){this.p=new Pe(n,s),this.h=c,this.d=(function(y,w){let E=!1,A=1/0;for(let I=0;I<w.length;I++){const j=w[I];for(let V=0,U=j.length,q=U-1;V<U;q=V++){const X=j[V],te=j[q];X.y>y.y!=te.y>y.y&&y.x<(te.x-X.x)*(y.y-X.y)/(te.y-X.y)+X.x&&(E=!E),A=Math.min(A,bg(y,X,te))}}return(E?1:-1)*Math.sqrt(A)})(this.p,f),this.max=this.d+this.h*Math.SQRT2}}const om=7,j0=Number.POSITIVE_INFINITY,S5=Math.sqrt(2);function sE(i,[n,s]){let c=0,f=0;if(s===j0){n<0&&(n=0);const y=n/S5;switch(i){case"top-right":case"top-left":f=y-om;break;case"bottom-right":case"bottom-left":f=-y+om;break;case"bottom":f=-n+om;break;case"top":f=n-om}switch(i){case"top-right":case"bottom-right":c=-y;break;case"top-left":case"bottom-left":c=y;break;case"left":c=n;break;case"right":c=-n}}else{switch(n=Math.abs(n),s=Math.abs(s),i){case"top-right":case"top-left":case"top":f=s-om;break;case"bottom-right":case"bottom-left":case"bottom":f=-s+om}switch(i){case"top-right":case"bottom-right":case"right":c=-n;break;case"top-left":case"bottom-left":case"left":c=n}}return[c,f]}function E5(i,n,s,c,f,y,w,E,A,I){i.createArrays(),i.tilePixelRatio=an/(512*i.overscaling),i.compareText={},i.iconsNeedLinear=!1;const j=i.layers[0].layout,V=i.layers[0]._unevaluatedLayout._values,U={};if(i.textSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=i.textSizeData;U.compositeTextSizes=[V["text-size"].possiblyEvaluate(new B(te),E),V["text-size"].possiblyEvaluate(new B(ae),E)]}if(i.iconSizeData.kind==="composite"){const{minZoom:te,maxZoom:ae}=i.iconSizeData;U.compositeIconSizes=[V["icon-size"].possiblyEvaluate(new B(te),E),V["icon-size"].possiblyEvaluate(new B(ae),E)]}U.layoutTextSize=V["text-size"].possiblyEvaluate(new B(A+1),E),U.layoutIconSize=V["icon-size"].possiblyEvaluate(new B(A+1),E),U.textMaxSize=V["text-size"].possiblyEvaluate(new B(18),E);const q=j.get("text-rotation-alignment")==="map"&&j.get("symbol-placement")!=="point",X=j.get("text-size");for(const te of i.features){const ae=j.get("text-font").evaluate(te,{},E).join(","),ge=X.evaluate(te,{},E),Ce=U.layoutTextSize.evaluate(te,{},E),ye=(U.layoutIconSize.evaluate(te,{},E),{horizontal:{},vertical:void 0}),Ee=te.text;let Re,Me=[0,0];if(Ee){const ft=Ee.toString(),It=j.get("text-letter-spacing").evaluate(te,{},E)*hs,nt=j.get("text-line-height").evaluate(te,{},E)*hs,yt=wc(ft)?It:0,_t=j.get("text-anchor").evaluate(te,{},E),Ct=j.get("text-variable-anchor");if(!Ct){const $t=j.get("text-radial-offset").evaluate(te,{},E);Me=$t?sE(_t,[$t*hs,j0]):j.get("text-offset").evaluate(te,{},E).map((Nn=>Nn*hs))}let Pt=q?"center":j.get("text-justify").evaluate(te,{},E);const ct=j.get("symbol-placement")==="point",Bt=ct?j.get("text-max-width").evaluate(te,{},E)*hs:1/0,Jt=$t=>{i.allowVerticalPlacement&&Fa(ft)&&(ye.vertical=N0(Ee,n,s,f,ae,Bt,nt,_t,$t,yt,Me,wa.vertical,!0,Ce,ge))};if(!q&&Ct){const $t=Pt==="auto"?Ct.map((Nt=>O0(Nt))):[Pt];let Nn=!1;for(let Nt=0;Nt<$t.length;Nt++){const cn=$t[Nt];if(!ye.horizontal[cn])if(Nn)ye.horizontal[cn]=ye.horizontal[0];else{const Dn=N0(Ee,n,s,f,ae,Bt,nt,"center",cn,yt,Me,wa.horizontal,!1,Ce,ge);Dn&&(ye.horizontal[cn]=Dn,Nn=Dn.positionedLines.length===1)}}Jt("left")}else{if(Pt==="auto"&&(Pt=O0(_t)),ct||j.get("text-writing-mode").indexOf("horizontal")>=0||!Fa(ft)){const $t=N0(Ee,n,s,f,ae,Bt,nt,_t,Pt,yt,Me,wa.horizontal,!1,Ce,ge);$t&&(ye.horizontal[Pt]=$t)}Jt(ct?"left":Pt)}}let Qe=!1;if(te.icon&&te.icon.name){const ft=c[te.icon.name];ft&&(Re=g5(f[te.icon.name],j.get("icon-offset").evaluate(te,{},E),j.get("icon-anchor").evaluate(te,{},E)),Qe=ft.sdf,i.sdfIcons===void 0?i.sdfIcons=ft.sdf:i.sdfIcons!==ft.sdf&&Xn("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ft.pixelRatio!==i.pixelRatio||j.get("icon-rotate").constantOr(1)!==0)&&(i.iconsNeedLinear=!0))}const Xe=aE(ye.horizontal)||ye.vertical;i.iconsInText||(i.iconsInText=!!Xe&&Xe.iconsInText),(Xe||Re)&&C5(i,te,ye,Re,c,U,Ce,0,Me,Qe,w,E,I)}y&&i.generateCollisionDebugBuffers(A,i.collisionBoxArray)}function O0(i){switch(i){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function C5(i,n,s,c,f,y,w,E,A,I,j,V,U){let q=y.textMaxSize.evaluate(n,{},V);q===void 0&&(q=w);const X=i.layers[0].layout,te=X.get("icon-offset").evaluate(n,{},V),ae=aE(s.horizontal)||s.vertical,ge=U.name==="globe",Ce=hs,ye=w/Ce,Ee=i.tilePixelRatio*q/Ce,Re=(_t=i.overscaling,i.zoom>18&&_t>2&&(_t>>=1),Math.max(an/(512*_t),1)*X.get("symbol-spacing")),Me=X.get("text-padding")*i.tilePixelRatio,Qe=X.get("icon-padding")*i.tilePixelRatio,Xe=gt(X.get("text-max-angle")),ft=X.get("text-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",It=X.get("icon-rotation-alignment")==="map"&&X.get("symbol-placement")!=="point",nt=X.get("symbol-placement"),yt=Re/2;var _t;const Ct=X.get("icon-text-fit");let Pt;c&&Ct!=="none"&&(i.allowVerticalPlacement&&s.vertical&&(Pt=ZS(c,s.vertical,Ct,X.get("icon-text-fit-padding"),te,ye)),ae&&(c=ZS(c,ae,Ct,X.get("icon-text-fit-padding"),te,ye)));const ct=(Bt,Jt,$t)=>{if(Jt.x<0||Jt.x>=an||Jt.y<0||Jt.y>=an)return;let Nn=null;if(ge){const{x:Nt,y:cn,z:Dn}=U.projectTilePoint(Jt.x,Jt.y,$t);Nn={anchor:new Fu(Nt,cn,Dn,0,void 0),up:U.upVector($t,Jt.x,Jt.y)}}(function(Nt,cn,Dn,cr,Ln,wn,Lr,On,zn,wr,Ir,Mr,br,Wr,li,Ti,Tr,Oi,Si,Qr,pr,Ei,Pr,mo,Ci){const fs=Nt.addToLineVertexArray(cn,cr);let es,go,ts,Ll,cm,Xg,Kg,FE=0,VE=0,UE=0,$E=0,J0=-1,Q0=-1;const zc={};let GE=ho("");const Mf=Dn?Dn.anchor:cn;let e1=0,t1=0;if(zn._unevaluatedLayout.getValue("text-radial-offset")===void 0?[e1,t1]=zn.layout.get("text-offset").evaluate(pr,{},Ci).map((Qo=>Qo*hs)):(e1=zn.layout.get("text-radial-offset").evaluate(pr,{},Ci)*hs,t1=j0),Nt.allowVerticalPlacement&&Ln.vertical){const Qo=Ln.vertical;if(li)Xg=z0(Qo),On&&(Kg=z0(On));else{const ea=zn.layout.get("text-rotate").evaluate(pr,{},Ci)+90;ts=W_(wr,Mf,cn,Ir,Mr,br,Qo,Wr,ea,Ti),On&&(Ll=W_(wr,Mf,cn,Ir,Mr,br,On,Oi,ea))}}if(wn){const Qo=zn.layout.get("icon-rotate").evaluate(pr,{},Ci),ea=zn.layout.get("icon-text-fit")!=="none",Yg=rE(wn,Qo,Pr,ea),r1=On?rE(On,Qo,Pr,ea):void 0;go=W_(wr,Mf,cn,Ir,Mr,br,wn,Oi,Qo),FE=4*Yg.length;const HE=Nt.iconSizeData;let Pf=null;HE.kind==="source"?(Pf=[Rl*zn.layout.get("icon-size").evaluate(pr,{},Ci)],Pf[0]>Fd&&Xn(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${Vg}. Reduce your "icon-size".`)):HE.kind==="composite"&&(Pf=[Rl*Ei.compositeIconSizes[0].evaluate(pr,{},Ci),Rl*Ei.compositeIconSizes[1].evaluate(pr,{},Ci)],(Pf[0]>Fd||Pf[1]>Fd)&&Xn(`${Nt.layerIds[0]}: Value for "icon-size" is >= ${Vg}. Reduce your "icon-size".`)),Nt.addSymbols(Nt.icon,Yg,Pf,Qr,Si,pr,!1,Dn,cn,fs.lineStartIndex,fs.lineLength,-1,mo,Ci),J0=Nt.icon.placedSymbolArray.length-1,r1&&(VE=4*r1.length,Nt.addSymbols(Nt.icon,r1,Pf,Qr,Si,pr,wa.vertical,Dn,cn,fs.lineStartIndex,fs.lineLength,-1,mo,Ci),Q0=Nt.icon.placedSymbolArray.length-1)}for(const Qo in Ln.horizontal){const ea=Ln.horizontal[Qo];es||(GE=ho(ea.text),li?cm=z0(ea):es=W_(wr,Mf,cn,Ir,Mr,br,ea,Wr,zn.layout.get("text-rotate").evaluate(pr,{},Ci),Ti));const Yg=ea.positionedLines.length===1;if(UE+=oE(Nt,Dn,cn,ea,Lr,zn,li,pr,Ti,fs,Ln.vertical?wa.horizontal:wa.horizontalOnly,Yg?Object.keys(Ln.horizontal):[Qo],zc,J0,Ei,mo,Ci),Yg)break}Ln.vertical&&($E+=oE(Nt,Dn,cn,Ln.vertical,Lr,zn,li,pr,Ti,fs,wa.vertical,["vertical"],zc,Q0,Ei,mo,Ci));let Wd=-1;const n1=(Qo,ea)=>Qo?Math.max(Qo,ea):ea;Wd=n1(cm,Wd),Wd=n1(Xg,Wd),Wd=n1(Kg,Wd);const ej=Wd>-1?1:0;Nt.glyphOffsetArray.length>=Ud.MAX_GLYPHS&&Xn("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),pr.sortKey!==void 0&&Nt.addToSortKeyRanges(Nt.symbolInstances.length,pr.sortKey),Nt.symbolInstances.emplaceBack(Mf.x,Mf.y,Mf.z,cn.x,cn.y,zc.right>=0?zc.right:-1,zc.center>=0?zc.center:-1,zc.left>=0?zc.left:-1,zc.vertical>=0?zc.vertical:-1,J0,Q0,GE,es!==void 0?es:Nt.collisionBoxArray.length,es!==void 0?es+1:Nt.collisionBoxArray.length,ts!==void 0?ts:Nt.collisionBoxArray.length,ts!==void 0?ts+1:Nt.collisionBoxArray.length,go!==void 0?go:Nt.collisionBoxArray.length,go!==void 0?go+1:Nt.collisionBoxArray.length,Ll||Nt.collisionBoxArray.length,Ll?Ll+1:Nt.collisionBoxArray.length,Ir,UE,$E,FE,VE,ej,0,e1,t1,Wd)})(i,Jt,Nn,Bt,s,c,f,Pt,i.layers[0],i.collisionBoxArray,n.index,n.sourceLayerIndex,i.index,Me,ft,A,0,Qe,It,te,n,y,I,j,V)};if(nt==="line")for(const Bt of eE(n.geometry,0,0,an,an)){const Jt=_5(Bt,Re,Xe,s.vertical||ae,c,Ce,Ee,i.overscaling,an);for(const $t of Jt)ae&&k5(i,ae.text,yt,$t)||ct(Bt,$t,V)}else if(nt==="line-center"){for(const Bt of n.geometry)if(Bt.length>1){const Jt=y5(Bt,Xe,s.vertical||ae,c,Ce,Ee);Jt&&ct(Bt,Jt,V)}}else if(n.type==="Polygon")for(const Bt of Dg(n.geometry,0)){const Jt=b5(Bt,16);ct(Bt[0],new Fu(Jt.x,Jt.y,0,0,void 0),V)}else if(n.type==="LineString")for(const Bt of n.geometry)ct(Bt,new Fu(Bt[0].x,Bt[0].y,0,0,void 0),V);else if(n.type==="Point")for(const Bt of n.geometry)for(const Jt of Bt)ct([Jt],new Fu(Jt.x,Jt.y,0,0,void 0),V)}const Vg=255,Fd=Vg*Rl;function oE(i,n,s,c,f,y,w,E,A,I,j,V,U,q,X,te,ae){const ge=(function(Ee,Re,Me,Qe,Xe,ft,It,nt){const yt=[];if(Re.positionedLines.length===0)return yt;const _t=Qe.layout.get("text-rotate").evaluate(ft,{})*Math.PI/180,Ct=(function($t){const Nn=$t[0],Nt=$t[1],cn=Nn*Nt;return cn>0?[Nn,-Nt]:cn<0?[-Nn,Nt]:Nn===0?[Nt,Nn]:[Nt,-Nn]})(Me);let Pt=Math.abs(Re.top-Re.bottom);for(const $t of Re.positionedLines)Pt-=$t.lineOffset;const ct=Re.positionedLines.length,Bt=Pt/ct;let Jt=Re.top-Me[1];for(let $t=0;$t<ct;++$t){const Nn=Re.positionedLines[$t];Jt=x5(Re,Bt,Jt,$t);for(const Nt of Nn.positionedGlyphs){if(!Nt.rect)continue;const cn=Nt.rect||{};let Dn=FS+1,cr=!0,Ln=1,wn=0;if(Nt.imageName){const Pr=It[Nt.imageName];if(!Pr)continue;if(Pr.sdf){Xn("SDF images are not supported in formatted text and will be ignored.");continue}cr=!1,Ln=Pr.pixelRatio,Dn=Po/Ln}const Lr=(Xe||nt)&&Nt.vertical,On=Nt.metrics.advance*Nt.scale/2,zn=Nt.metrics,wr=Nt.rect;if(wr===null)continue;nt&&Re.verticalizable&&(wn=Nt.imageName?On-Nt.metrics.width*Nt.scale/2:0);const Ir=Xe?[Nt.x+On,Nt.y]:[0,0];let Mr=[0,0],br=[0,0],Wr=!1;Xe||(Lr?(br=[Nt.x+On+Ct[0],Nt.y+Ct[1]-wn],Wr=!0):Mr=[Nt.x+On+Me[0],Nt.y+Me[1]-wn]);const li=wr.w*Nt.scale/(Ln*(Nt.localGlyph?Nl:1)),Ti=wr.h*Nt.scale/(Ln*(Nt.localGlyph?Nl:1));let Tr,Oi,Si,Qr;if(Lr){const Pr=Nt.y-Jt,mo=new Pe(-On,On-Pr),Ci=-Math.PI/2,fs=new Pe(...br);Tr=new Pe(-On+Mr[0],Mr[1]),Tr._rotateAround(Ci,mo)._add(fs),Tr.x+=-Pr+On,Tr.y-=(zn.left-Dn)*Nt.scale;const es=Nt.imageName?zn.advance*Nt.scale:hs*Nt.scale,go=String.fromCharCode(Nt.glyph);e5(go)?Tr.x+=(1-Dn)*Nt.scale:t5(go)?Tr.x+=es-zn.height*Nt.scale+(-Dn-1)*Nt.scale:Tr.x+=Nt.imageName||zn.width+2*Dn===wr.w&&zn.height+2*Dn===wr.h?(es-Ti)/2:(es-(zn.height+2*Dn)*Nt.scale)/2,Oi=new Pe(Tr.x,Tr.y-li),Si=new Pe(Tr.x+Ti,Tr.y),Qr=new Pe(Tr.x+Ti,Tr.y-li)}else{const Pr=(zn.left-Dn)*Nt.scale-On+Mr[0],mo=(-zn.top-Dn)*Nt.scale+Mr[1],Ci=Pr+li,fs=mo+Ti;Tr=new Pe(Pr,mo),Oi=new Pe(Ci,mo),Si=new Pe(Pr,fs),Qr=new Pe(Ci,fs)}if(_t){let Pr;Pr=Xe?new Pe(0,0):Wr?new Pe(Ct[0],Ct[1]):new Pe(Me[0],Me[1]),Tr._rotateAround(_t,Pr),Oi._rotateAround(_t,Pr),Si._rotateAround(_t,Pr),Qr._rotateAround(_t,Pr)}const pr=new Pe(0,0),Ei=new Pe(0,0);yt.push({tl:Tr,tr:Oi,bl:Si,br:Qr,tex:cn,writingMode:Re.writingMode,glyphOffset:Ir,sectionIndex:Nt.sectionIndex,isSDF:cr,pixelOffsetTL:pr,pixelOffsetBR:Ei,minFontScaleX:0,minFontScaleY:0})}}return yt})(0,c,A,y,w,E,f,i.allowVerticalPlacement),Ce=i.textSizeData;let ye=null;Ce.kind==="source"?(ye=[Rl*y.layout.get("text-size").evaluate(E,{},ae)],ye[0]>Fd&&Xn(`${i.layerIds[0]}: Value for "text-size" is >= ${Vg}. Reduce your "text-size".`)):Ce.kind==="composite"&&(ye=[Rl*X.compositeTextSizes[0].evaluate(E,{},ae),Rl*X.compositeTextSizes[1].evaluate(E,{},ae)],(ye[0]>Fd||ye[1]>Fd)&&Xn(`${i.layerIds[0]}: Value for "text-size" is >= ${Vg}. Reduce your "text-size".`)),i.addSymbols(i.text,ge,ye,A,w,E,j,n,s,I.lineStartIndex,I.lineLength,q,te,ae);for(const Ee of V)U[Ee]=i.text.placedSymbolArray.length-1;return 4*ge.length}function aE(i){for(const n in i)return i[n];return null}function W_(i,n,s,c,f,y,w,E,A,I){let j=w.top,V=w.bottom,U=w.left,q=w.right;const X=w.collisionPadding;if(X&&(U-=X[0],j-=X[1],q+=X[2],V+=X[3]),A){const te=new Pe(U,j),ae=new Pe(q,j),ge=new Pe(U,V),Ce=new Pe(q,V),ye=gt(A);let Ee=new Pe(0,0);I&&(Ee=new Pe(I[0],I[1])),te._rotateAround(ye,Ee),ae._rotateAround(ye,Ee),ge._rotateAround(ye,Ee),Ce._rotateAround(ye,Ee),U=Math.min(te.x,ae.x,ge.x,Ce.x),q=Math.max(te.x,ae.x,ge.x,Ce.x),j=Math.min(te.y,ae.y,ge.y,Ce.y),V=Math.max(te.y,ae.y,ge.y,Ce.y)}return i.emplaceBack(n.x,n.y,n.z,s.x,s.y,U,j,q,V,E,c,f,y),i.length-1}function z0(i){i.collisionPadding&&(i.top-=i.collisionPadding[1],i.bottom+=i.collisionPadding[3]);const n=i.bottom-i.top;return n>0?Math.max(10,n):null}function k5(i,n,s,c){const f=i.compareText;if(n in f){const y=f[n];for(let w=y.length-1;w>=0;w--)if(c.dist(y[w])<s)return!0}else f[n]=[];return f[n].push(c),!1}function lE(i,n){const s=i.fovAboveCenter,c=i.elevation?i.elevation.getMinElevationBelowMSL()*n:0,f=(i._camera.position[2]*i.worldSize-c)/Math.cos(i._pitch),y=Math.sin(s)*f/Math.sin(Math.max(Math.PI/2-i._pitch-s,.01)),w=Math.sin(i._pitch)*y+f;return Math.min(1.01*w,f*(1/i._horizonShift))}function Af(i,n){if(!n.isReprojectedInTileSpace)return{scale:1<<i.z,x:i.x,y:i.y,x2:i.x+1,y2:i.y+1,projection:n};const s=Math.pow(2,-i.z),c=i.x*s,f=(i.x+1)*s,y=i.y*s,w=(i.y+1)*s,E=Yi(c),A=Yi(f),I=ar(y),j=ar(w),V=n.project(E,I),U=n.project(A,I),q=n.project(A,j),X=n.project(E,j);let te=Math.min(V.x,U.x,q.x,X.x),ae=Math.min(V.y,U.y,q.y,X.y),ge=Math.max(V.x,U.x,q.x,X.x),Ce=Math.max(V.y,U.y,q.y,X.y);const ye=s/16;function Ee(Me,Qe,Xe,ft,It,nt){const yt=(Xe+It)/2,_t=(ft+nt)/2,Ct=n.project(Yi(yt),ar(_t)),Pt=Math.max(0,te-Ct.x,ae-Ct.y,Ct.x-ge,Ct.y-Ce);te=Math.min(te,Ct.x),ge=Math.max(ge,Ct.x),ae=Math.min(ae,Ct.y),Ce=Math.max(Ce,Ct.y),Pt>ye&&(Ee(Me,Ct,Xe,ft,yt,_t),Ee(Ct,Qe,yt,_t,It,nt))}Ee(V,U,c,y,f,y),Ee(U,q,f,y,f,w),Ee(q,X,f,w,c,w),Ee(X,V,c,w,c,y),te-=ye,ae-=ye,ge+=ye,Ce+=ye;const Re=1/Math.max(ge-te,Ce-ae);return{scale:Re,x:te*Re,y:ae*Re,x2:ge*Re,y2:Ce*Re,projection:n}}const A5=ga(new Float32Array(16));class Vd{constructor(n){this.spec=n,this.name=n.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(n,s){return{x:0,y:0,z:0}}unproject(n,s){return new dn(0,0)}projectTilePoint(n,s,c){return{x:n,y:s,z:0}}locationPoint(n,s,c=!0){return n._coordinatePoint(n.locationCoordinate(s),c)}pixelsPerMeter(n,s){return ai(1,n)*s}pixelSpaceConversion(n,s,c){return 1}farthestPixelDistance(n){return lE(n,n.pixelsPerMeter)}pointCoordinate(n,s,c,f){const y=n.horizonLineFromTop(!1),w=new Pe(s,Math.max(y,c));return n.rayIntersectionCoordinate(n.pointRayIntersection(w,f))}pointCoordinate3D(n,s,c){const f=new Pe(s,c);if(n.elevation)return n.elevation.pointCoordinate(f);{const y=this.pointCoordinate(n,f.x,f.y,0);return[y.x,y.y,y.z]}}isPointAboveHorizon(n,s){if(n.elevation)return!this.pointCoordinate3D(n,s.x,s.y);const c=n.horizonLineFromTop();return s.y<c}createInversionMatrix(n,s){return A5}createTileMatrix(n,s,c){let f,y,w;const E=c.canonical,A=ga(new Float64Array(16));if(this.isReprojectedInTileSpace){const I=Af(E,this);f=1,y=I.x+c.wrap*I.scale,w=I.y,Cc(A,A,[f/I.scale,f/I.scale,n.pixelsPerMeter/s])}else f=s/n.zoomScale(E.z),y=(E.x+Math.pow(2,E.z)*c.wrap)*f,w=E.y*f;return Ec(A,A,[y,w,0]),Cc(A,A,[f/an,f/an,1]),A}upVector(n,s,c){return[0,0,1]}upVectorScale(n,s,c){return{metersToTile:1}}}class I5 extends Vd{constructor(n){super(n),this.range=[4,7],this.center=n.center||[-96,37.5];const[s,c]=this.parallels=n.parallels||[29.5,45.5],f=Math.sin(gt(s));this.n=(f+Math.sin(gt(c)))/2,this.c=1+f*(2*this.n-f),this.r0=Math.sqrt(this.c)/this.n}project(n,s){const{n:c,c:f,r0:y}=this,w=gt(n-this.center[0]),E=gt(s),A=Math.sqrt(f-2*c*Math.sin(E))/c;return{x:A*Math.sin(w*c),y:A*Math.cos(w*c)-y,z:0}}unproject(n,s){const{n:c,c:f,r0:y}=this,w=y+s;let E=Math.atan2(n,Math.abs(w))*Math.sign(w);w*c<0&&(E-=Math.PI*Math.sign(n)*Math.sign(w));const A=gt(this.center[0])*c;E=he(E,-Math.PI-A,Math.PI-A);const I=xe(ht(E/c)+this.center[0],-180,180),j=Math.asin(xe((f-(n*n+w*w)*c*c)/(2*c),-1,1)),V=xe(ht(j),-Yr,Yr);return new dn(I,V)}}const Ug=1.340264,$g=-.081106,Gg=893e-6,Hg=.003796,q_=Math.sqrt(3)/2;class M5 extends Vd{project(n,s){s=s/180*Math.PI,n=n/180*Math.PI;const c=Math.asin(q_*Math.sin(s)),f=c*c,y=f*f*f;return{x:.5*(n*Math.cos(c)/(q_*(Ug+3*$g*f+y*(7*Gg+9*Hg*f)))/Math.PI+.5),y:1-.5*(c*(Ug+$g*f+y*(Gg+Hg*f))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=c*c,y=f*f*f;for(let j,V,U,q=0;q<12&&(V=c*(Ug+$g*f+y*(Gg+Hg*f))-s,U=Ug+3*$g*f+y*(7*Gg+9*Hg*f),j=V/U,c=xe(c-j,-Math.PI/3,Math.PI/3),f=c*c,y=f*f*f,!(Math.abs(j)<1e-12));++q);const w=q_*n*(Ug+3*$g*f+y*(7*Gg+9*Hg*f))/Math.cos(c),E=Math.asin(Math.sin(c)/q_),A=xe(180*w/Math.PI,-180,180),I=xe(180*E/Math.PI,-Yr,Yr);return new dn(A,I)}}class P5 extends Vd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){return{x:.5+n/360,y:.5-s/360,z:0}}unproject(n,s){const c=360*(n-.5),f=xe(360*(.5-s),-Yr,Yr);return new dn(c,f)}}const am=Math.PI/2;function Z_(i){return Math.tan((am+i)/2)}class R5 extends Vd{constructor(n){super(n),this.center=n.center||[0,30];const[s,c]=this.parallels=n.parallels||[30,30];let f=gt(s),y=gt(c);this.southernCenter=f+y<0,this.southernCenter&&(f=-f,y=-y);const w=Math.cos(f),E=Z_(f);this.n=f===y?Math.sin(f):Math.log(w/Math.cos(y))/Math.log(Z_(y)/E),this.f=w*Math.pow(Z_(f),this.n)/this.n}project(n,s){s=gt(s),this.southernCenter&&(s=-s),n=gt(n-this.center[0]);const c=1e-6,{n:f,f:y}=this;y>0?s<-am+c&&(s=-am+c):s>am-c&&(s=am-c);const w=y/Math.pow(Z_(s),f);let E=w*Math.sin(f*n),A=y-w*Math.cos(f*n);return E=.5*(E/Math.PI+.5),A=.5*(A/Math.PI+.5),{x:E,y:this.southernCenter?A:1-A,z:0}}unproject(n,s){n=(2*n-.5)*Math.PI,this.southernCenter&&(s=1-s),s=(2*(1-s)-.5)*Math.PI;const{n:c,f}=this,y=f-s,w=Math.sign(y),E=Math.sign(c)*Math.sqrt(n*n+y*y);let A=Math.atan2(n,Math.abs(y))*w;y*c<0&&(A-=Math.PI*Math.sign(n)*w);const I=xe(ht(A/c)+this.center[0],-180,180),j=xe(ht(2*Math.atan(Math.pow(f/E,1/c))-am),-Yr,Yr);return new dn(I,this.southernCenter?-j:j)}}class cE extends Vd{constructor(n){super(n),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(n,s){return{x:kr(n),y:Fr(s),z:0}}unproject(n,s){const c=Yi(n),f=ar(s);return new dn(c,f)}}const uE=gt(Yr);class N5 extends Vd{project(n,s){const c=(s=gt(s))*s,f=c*c;return{x:.5*((n=gt(n))*(.8707-.131979*c+f*(f*(.003971*c-.001529*f)-.013791))/Math.PI+.5),y:1-.5*(s*(1.007226+c*(.015085+f*(.028874*c-.044475-.005916*f)))/Math.PI+1),z:0}}unproject(n,s){n=(2*n-.5)*Math.PI;let c=s=(2*(1-s)-1)*Math.PI,f=25,y=0,w=c*c;do{w=c*c;const I=w*w;y=(c*(1.007226+w*(.015085+I*(.028874*w-.044475-.005916*I)))-s)/(1.007226+w*(.045255+I*(.259866*w-.311325-.005916*11*I))),c=xe(c-y,-uE,uE)}while(Math.abs(y)>1e-6&&--f>0);w=c*c;const E=xe(ht(n/(.8707+w*(w*(w*w*w*(.003971-.001529*w)-.013791)-.131979))),-180,180),A=ht(c);return new dn(E,A)}}const dE=gt(Yr);class D5 extends Vd{project(n,s){s=gt(s),n=gt(n);const c=Math.cos(s),f=2/Math.PI,y=Math.acos(c*Math.cos(n/2)),w=Math.sin(y)/y,E=.5*(n*f+2*c*Math.sin(n/2)/w)||0,A=.5*(s+Math.sin(s)/w)||0;return{x:.5*(E/Math.PI+.5),y:1-.5*(A/Math.PI+1),z:0}}unproject(n,s){let c=n=(2*n-.5)*Math.PI,f=s=(2*(1-s)-1)*Math.PI,y=25;const w=1e-6;let E=0,A=0;do{const I=Math.cos(f),j=Math.sin(f),V=2*j*I,U=j*j,q=I*I,X=Math.cos(c/2),te=Math.sin(c/2),ae=2*X*te,ge=te*te,Ce=1-q*X*X,ye=Ce?1/Ce:0,Ee=Ce?Math.acos(I*X)*Math.sqrt(1/Ce):0,Re=.5*(2*Ee*I*te+2*c/Math.PI)-n,Me=.5*(Ee*j+f)-s,Qe=.5*ye*(q*ge+Ee*I*X*U)+1/Math.PI,Xe=ye*(ae*V/4-Ee*j*te),ft=.125*ye*(V*te-Ee*j*q*ae),It=.5*ye*(U*X+Ee*ge*I)+.5,nt=Xe*ft-It*Qe;E=(Me*Xe-Re*It)/nt,A=(Re*ft-Me*Qe)/nt,c=xe(c-E,-Math.PI,Math.PI),f=xe(f-A,-dE,dE)}while((Math.abs(E)>w||Math.abs(A)>w)&&--y>0);return new dn(ht(c),ht(f))}}class hE extends Vd{constructor(n){super(n),this.center=n.center||[0,0],this.parallels=n.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(gt(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(n,s){const{scale:c,cosPhi:f}=this;return{x:gt(n)*f*c+.5,y:-Math.sin(gt(s))/f*c+.5,z:0}}unproject(n,s){const{scale:c,cosPhi:f}=this,y=-(s-.5)/c,w=xe(ht((n-.5)/c)/f,-180,180),E=Math.asin(xe(y*f,-1,1)),A=xe(ht(E),-Yr,Yr);return new dn(w,A)}}class L5 extends cE{constructor(n){super(n),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(n,s,c){const f=Yo(n,s,c);return Hr(f,f,Us(Mo(c))),{x:f[0],y:f[1],z:f[2]}}locationPoint(n,s){const c=ks(s.lat,s.lng),f=cs([],c),y=n.elevation?n.elevation.getAtPointOrZero(n.locationCoordinate(s),n._centerAltitude):n._centerAltitude;Ad(c,c,f,ai(1,0)*an*y);const w=ga(new Float64Array(16));return Il(w,n.pixelMatrix,n.globeMatrix),Hr(c,c,w),new Pe(c[0],c[1])}pixelsPerMeter(n,s){return ai(1,0)*s}pixelSpaceConversion(n,s,c){const f=ai(1,n)*s,y=Kn(ai(1,45)*s,f,c);return this.pixelsPerMeter(n,s)/y}createTileMatrix(n,s,c){const f=Bp(Mo(c.canonical));return Il(new Float64Array(16),n.globeMatrix,f)}createInversionMatrix(n,s){const{center:c}=n,f=Us(Mo(s));return of(f,f,gt(c.lng)),Ip(f,f,gt(c.lat)),Cc(f,f,[n._pixelsPerMercatorPixel,n._pixelsPerMercatorPixel,1]),Float32Array.from(f)}pointCoordinate(n,s,c,f){return mg(n,s,c,!0)||new Ic(0,0)}pointCoordinate3D(n,s,c){const f=this.pointCoordinate(n,s,c,0);return[f.x,f.y,f.z]}isPointAboveHorizon(n,s){return!mg(n,s.x,s.y,!1)}farthestPixelDistance(n){const s=(function(f,y){const w=f.cameraToCenterDistance,E=f._centerAltitude*y,A=f._camera,I=f._camera.forward(),j=Ha([],zr([],I,-w),[0,0,E]),V=f.worldSize/(2*Math.PI),U=[0,0,-V],q=f.width/f.height,X=Math.tan(f.fovAboveCenter),te=zr([],A.up(),X),ae=zr([],A.right(),X*q),ge=cs([],Ha([],Ha([],I,te),ae)),Ce=[];let ye;if(new Op(j,ge).closestPointOnSphere(U,V,Ce)){const Ee=Ha([],Ce,U),Re=Io([],Ee,j);ye=Math.cos(f.fovAboveCenter)*kd(Re)}else{const Ee=Io([],j,U),Re=Io([],U,j);cs(Re,Re);const Me=kd(Ee)-V;ye=Math.sqrt(Me*(Me+2*V));const Qe=Math.acos(ye/(V+Me))-Math.acos(Ao(I,Re));ye*=Math.cos(Qe)}return 1.01*ye})(n,this.pixelsPerMeter(n.center.lat,n.worldSize)),c=Nd(n.zoom);if(c>0){const f=lE(n,ai(1,n.center.lat)*n.worldSize),y=n.worldSize/(2*Math.PI),w=Math.max(n.width,n.height)/n.worldSize*Math.PI;return Kn(s,f+y*(1-Math.cos(w)),Math.pow(c,10))}return s}upVector(n,s,c){return Yo(s,c,n,1)}upVectorScale(n){return{metersToTile:Pd(pf(Mo(n)))}}}function fE(i){const n=i.parallels,s=!!n&&Math.abs(n[0]+n[1])<.01;switch(i.name){case"mercator":return new cE(i);case"equirectangular":return new P5(i);case"naturalEarth":return new N5(i);case"equalEarth":return new M5(i);case"winkelTripel":return new D5(i);case"albers":return s?new hE(i):new I5(i);case"lambertConformalConic":return s?new hE(i):new R5(i);case"globe":return new L5(i)}throw new Error(`Invalid projection name: ${i.name}`)}const j5=Sn.types,O5=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function X_(i,n,s,c,f,y,w,E,A,I,j,V,U){const q=E?Math.min(Fd,Math.round(E[0])):0,X=E?Math.min(Fd,Math.round(E[1])):0;i.emplaceBack(n,s,Math.round(32*c),Math.round(32*f),y,w,(q<<1)+(A?1:0),X,16*I,16*j,256*V,256*U)}function K_(i,n,s,c,f,y,w){i.emplaceBack(n,s,c,f,y,w)}function Y_(i,n,s,c,f){i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f),i.emplaceBack(n,s,c,f)}function z5(i){for(const n of i.sections)if(fa(n.text))return!0;return!1}class B0{constructor(n){this.layoutVertexArray=new xt,this.indexArray=new en,this.programConfigurations=n,this.segments=new oi,this.dynamicLayoutVertexArray=new Et,this.opacityVertexArray=new Qt,this.placedSymbolArray=new Gr,this.globeExtVertexArray=new At}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0}upload(n,s,c,f){this.isEmpty()||(c&&(this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,WL.members),this.indexBuffer=n.createIndexBuffer(this.indexArray,s),this.dynamicLayoutVertexBuffer=n.createVertexBuffer(this.dynamicLayoutVertexArray,ZL.members,!0),this.opacityVertexBuffer=n.createVertexBuffer(this.opacityVertexArray,O5,!0),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=n.createVertexBuffer(this.globeExtVertexArray,qL.members,!0)),this.opacityVertexBuffer.itemSize=1),(c||f)&&this.programConfigurations.upload(n))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy())}}Ft(B0,"SymbolBuffers");class F0{constructor(n,s,c){this.layoutVertexArray=new n,this.layoutAttributes=s,this.indexArray=new c,this.segments=new oi,this.collisionVertexArray=new jn,this.collisionVertexArrayExt=new Fn}upload(n){this.layoutVertexBuffer=n.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=n.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=n.createVertexBuffer(this.collisionVertexArray,XL.members,!0),this.collisionVertexBufferExt=n.createVertexBuffer(this.collisionVertexArrayExt,KL.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}Ft(F0,"CollisionBuffers");class Ud{constructor(n){this.collisionBoxArray=n.collisionBoxArray,this.zoom=n.zoom,this.overscaling=n.overscaling,this.layers=n.layers,this.layerIds=this.layers.map((w=>w.id)),this.index=n.index,this.pixelRatio=n.pixelRatio,this.sourceLayerIndex=n.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=ga([]),this.placementViewportMatrix=ga([]);const s=this.layers[0]._unevaluatedLayout._values;this.textSizeData=A0(this.zoom,s["text-size"]),this.iconSizeData=A0(this.zoom,s["icon-size"]);const c=this.layers[0].layout,f=c.get("symbol-sort-key"),y=c.get("symbol-z-order");this.canOverlap=c.get("text-allow-overlap")||c.get("icon-allow-overlap")||c.get("text-ignore-placement")||c.get("icon-ignore-placement"),this.sortFeaturesByKey=y!=="viewport-y"&&f.constantOr(1)!==void 0,this.sortFeaturesByY=(y==="viewport-y"||y==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=c.get("text-writing-mode").map((w=>wa[w])),this.stateDependentLayerIds=this.layers.filter((w=>w.isStateDependent())).map((w=>w.id)),this.sourceID=n.sourceID,this.projection=n.projection}createArrays(){this.text=new B0(new Sc(this.layers,this.zoom,(n=>/^text/.test(n)))),this.icon=new B0(new Sc(this.layers,this.zoom,(n=>/^icon/.test(n)))),this.glyphOffsetArray=new hi,this.lineVertexArray=new Dr,this.symbolInstances=new xr}calculateGlyphDependencies(n,s,c,f,y){for(let w=0;w<n.length;w++)if(s[n.charCodeAt(w)]=!0,f&&y){const E=zg[n.charAt(w)];E&&(s[E.charCodeAt(0)]=!0)}}populate(n,s,c,f){const y=this.layers[0],w=y.layout,E=this.projection.name==="globe",A=w.get("text-font"),I=w.get("text-field"),j=w.get("icon-image"),V=(I.value.kind!=="constant"||I.value.value instanceof Pi&&!I.value.value.isEmpty()||I.value.value.toString().length>0)&&(A.value.kind!=="constant"||A.value.value.length>0),U=j.value.kind!=="constant"||!!j.value.value||Object.keys(j.parameters).length>0,q=w.get("symbol-sort-key");if(this.features=[],!V&&!U)return;const X=s.iconDependencies,te=s.glyphDependencies,ae=s.availableImages,ge=new B(this.zoom);for(const{feature:Ce,id:ye,index:Ee,sourceLayerIndex:Re}of n){const Me=y._featureFilter.needGeometry,Qe=Xa(Ce,Me);if(!y._featureFilter.filter(ge,Qe,c))continue;if(Me||(Qe.geometry=As(Ce,c,f)),E&&Ce.type!==1&&c.z<=5){const nt=Qe.geometry,yt=.98078528056,_t=(Ct,Pt)=>Ao(Yo(Ct.x,Ct.y,c,1),Yo(Pt.x,Pt.y,c,1))<yt;for(let Ct=0;Ct<nt.length;Ct++)nt[Ct]=Ld(nt[Ct],_t)}let Xe,ft;if(V){const nt=y.getValueAndResolveTokens("text-field",Qe,c,ae),yt=Pi.factory(nt);z5(yt)&&(this.hasRTLText=!0),(!this.hasRTLText||C()==="unavailable"||this.hasRTLText&&D.isParsed())&&(Xe=QL(yt,y,Qe))}if(U){const nt=y.getValueAndResolveTokens("icon-image",Qe,c,ae);ft=nt instanceof no?nt:no.fromString(nt)}if(!Xe&&!ft)continue;const It=this.sortFeaturesByKey?q.evaluate(Qe,{},c):void 0;if(this.features.push({id:ye,text:Xe,icon:ft,index:Ee,sourceLayerIndex:Re,geometry:Qe.geometry,properties:Ce.properties,type:j5[Ce.type],sortKey:It}),ft&&(X[ft.name]=!0),Xe){const nt=A.evaluate(Qe,{},c).join(","),yt=w.get("text-rotation-alignment")==="map"&&w.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(wa.vertical)>=0;for(const _t of Xe.sections)if(_t.image)X[_t.image.name]=!0;else{const Ct=Fa(Xe.toString()),Pt=_t.fontStack||nt,ct=te[Pt]=te[Pt]||{};this.calculateGlyphDependencies(_t.text,ct,yt,this.allowVerticalPlacement,Ct)}}}w.get("symbol-placement")==="line"&&(this.features=(function(Ce){const ye={},Ee={},Re=[];let Me=0;function Qe(nt){Re.push(Ce[nt]),Me++}function Xe(nt,yt,_t){const Ct=Ee[nt];return delete Ee[nt],Ee[yt]=Ct,Re[Ct].geometry[0].pop(),Re[Ct].geometry[0]=Re[Ct].geometry[0].concat(_t[0]),Ct}function ft(nt,yt,_t){const Ct=ye[yt];return delete ye[yt],ye[nt]=Ct,Re[Ct].geometry[0].shift(),Re[Ct].geometry[0]=_t[0].concat(Re[Ct].geometry[0]),Ct}function It(nt,yt,_t){const Ct=_t?yt[0][yt[0].length-1]:yt[0][0];return`${nt}:${Ct.x}:${Ct.y}`}for(let nt=0;nt<Ce.length;nt++){const yt=Ce[nt],_t=yt.geometry,Ct=yt.text?yt.text.toString():null;if(!Ct){Qe(nt);continue}const Pt=It(Ct,_t),ct=It(Ct,_t,!0);if(Pt in Ee&&ct in ye&&Ee[Pt]!==ye[ct]){const Bt=ft(Pt,ct,_t),Jt=Xe(Pt,ct,Re[Bt].geometry);delete ye[Pt],delete Ee[ct],Ee[It(Ct,Re[Jt].geometry,!0)]=Jt,Re[Bt].geometry=null}else Pt in Ee?Xe(Pt,ct,_t):ct in ye?ft(Pt,ct,_t):(Qe(nt),ye[Pt]=Me-1,Ee[ct]=Me-1)}return Re.filter((nt=>nt.geometry))})(this.features)),this.sortFeaturesByKey&&this.features.sort(((Ce,ye)=>Ce.sortKey-ye.sortKey))}update(n,s,c,f){this.stateDependentLayers.length&&(this.text.programConfigurations.updatePaintArrays(n,s,this.layers,c,f),this.icon.programConfigurations.updatePaintArrays(n,s,this.layers,c,f))}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(n){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(n),this.iconCollisionBox.upload(n)),this.text.upload(n,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload),this.icon.upload(n,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=fE(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(n,s){const c=this.lineVertexArray.length;if(n.segment!==void 0)for(const{x:f,y}of s)this.lineVertexArray.emplaceBack(f,y);return{lineStartIndex:c,lineLength:this.lineVertexArray.length-c}}addSymbols(n,s,c,f,y,w,E,A,I,j,V,U,q,X){const te=n.indexArray,ae=n.layoutVertexArray,ge=n.globeExtVertexArray,Ce=n.segments.prepareSegment(4*s.length,ae,te,this.canOverlap?w.sortKey:void 0),ye=this.glyphOffsetArray.length,Ee=Ce.vertexLength,Re=this.allowVerticalPlacement&&E===wa.vertical?Math.PI/2:0,Me=w.text&&w.text.sections;for(let Xe=0;Xe<s.length;Xe++){const{tl:ft,tr:It,bl:nt,br:yt,tex:_t,pixelOffsetTL:Ct,pixelOffsetBR:Pt,minFontScaleX:ct,minFontScaleY:Bt,glyphOffset:Jt,isSDF:$t,sectionIndex:Nn}=s[Xe],Nt=Ce.vertexLength,cn=Jt[1];if(X_(ae,I.x,I.y,ft.x,cn+ft.y,_t.x,_t.y,c,$t,Ct.x,Ct.y,ct,Bt),X_(ae,I.x,I.y,It.x,cn+It.y,_t.x+_t.w,_t.y,c,$t,Pt.x,Ct.y,ct,Bt),X_(ae,I.x,I.y,nt.x,cn+nt.y,_t.x,_t.y+_t.h,c,$t,Ct.x,Pt.y,ct,Bt),X_(ae,I.x,I.y,yt.x,cn+yt.y,_t.x+_t.w,_t.y+_t.h,c,$t,Pt.x,Pt.y,ct,Bt),A){const{x:Dn,y:cr,z:Ln}=A.anchor,[wn,Lr,On]=A.up;K_(ge,Dn,cr,Ln,wn,Lr,On),K_(ge,Dn,cr,Ln,wn,Lr,On),K_(ge,Dn,cr,Ln,wn,Lr,On),K_(ge,Dn,cr,Ln,wn,Lr,On),Y_(n.dynamicLayoutVertexArray,Dn,cr,Ln,Re)}else Y_(n.dynamicLayoutVertexArray,I.x,I.y,I.z,Re);te.emplaceBack(Nt,Nt+1,Nt+2),te.emplaceBack(Nt+1,Nt+2,Nt+3),Ce.vertexLength+=4,Ce.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(Jt[0]),Xe!==s.length-1&&Nn===s[Xe+1].sectionIndex||n.programConfigurations.populatePaintArrays(ae.length,w,w.index,{},q,X,Me&&Me[Nn])}const Qe=A?A.anchor:I;n.placedSymbolArray.emplaceBack(Qe.x,Qe.y,Qe.z,I.x,I.y,ye,this.glyphOffsetArray.length-ye,Ee,j,V,I.segment,c?c[0]:0,c?c[1]:0,f[0],f[1],E,0,!1,0,U,0)}_commitLayoutVertex(n,s,c,f,y,w,E){n.emplaceBack(s,c,f,y,w,Math.round(E.x),Math.round(E.y))}_addCollisionDebugVertices(n,s,c,f,y,w,E){const A=c.segments.prepareSegment(4,c.layoutVertexArray,c.indexArray),I=A.vertexLength,j=E.tileAnchorX,V=E.tileAnchorY;for(let q=0;q<4;q++)c.collisionVertexArray.emplaceBack(0,0,0,0);c.collisionVertexArrayExt.emplaceBack(s,-n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,-n.padding),c.collisionVertexArrayExt.emplaceBack(s,n.padding,n.padding),c.collisionVertexArrayExt.emplaceBack(s,-n.padding,n.padding),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Pe(n.x1,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Pe(n.x2,n.y1)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Pe(n.x2,n.y2)),this._commitLayoutVertex(c.layoutVertexArray,f,y,w,j,V,new Pe(n.x1,n.y2)),A.vertexLength+=4;const U=c.indexArray;U.emplaceBack(I,I+1),U.emplaceBack(I+1,I+2),U.emplaceBack(I+2,I+3),U.emplaceBack(I+3,I),A.primitiveLength+=4}_addTextDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceTextSize(n,w,s,E);this._addCollisionDebugVertices(A,I,this.textCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,w)}}_addIconDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceIconSize(n,s,w.placedIconSymbolIndex);this._addCollisionDebugVertices(A,I,this.iconCollisionBox,A.projectedAnchorX,A.projectedAnchorY,A.projectedAnchorZ,w)}}generateCollisionDebugBuffers(n,s){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new F0(qt,RS.members,$r),this.iconCollisionBox=new F0(qt,RS.members,$r);const c=Qp(this.iconSizeData,n),f=Qp(this.textSizeData,n);for(let y=0;y<this.symbolInstances.length;y++){const w=this.symbolInstances.get(y);this._addTextDebugCollisionBoxes(f,n,s,w.textBoxStartIndex,w.textBoxEndIndex,w),this._addTextDebugCollisionBoxes(f,n,s,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._addIconDebugCollisionBoxes(c,n,s,w.iconBoxStartIndex,w.iconBoxEndIndex,w),this._addIconDebugCollisionBoxes(c,n,s,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w)}}getSymbolInstanceTextSize(n,s,c,f){const y=this.text.placedSymbolArray.get(s.rightJustifiedTextSymbolIndex>=0?s.rightJustifiedTextSymbolIndex:s.centerJustifiedTextSymbolIndex>=0?s.centerJustifiedTextSymbolIndex:s.leftJustifiedTextSymbolIndex>=0?s.leftJustifiedTextSymbolIndex:s.verticalPlacedTextSymbolIndex>=0?s.verticalPlacedTextSymbolIndex:f),w=B_(this.textSizeData,n,y)/hs;return this.tilePixelRatio*w}getSymbolInstanceIconSize(n,s,c){const f=this.icon.placedSymbolArray.get(c),y=B_(this.iconSizeData,n,f);return this.tilePixelRatio*y}_commitDebugCollisionVertexUpdate(n,s,c){n.emplaceBack(s,-c,-c),n.emplaceBack(s,c,-c),n.emplaceBack(s,c,c),n.emplaceBack(s,-c,c)}_updateTextDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceTextSize(n,w,s,E);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,I,A.padding)}}_updateIconDebugCollisionBoxes(n,s,c,f,y,w){for(let E=f;E<y;E++){const A=c.get(E),I=this.getSymbolInstanceIconSize(n,s,w);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,I,A.padding)}}updateCollisionDebugBuffers(n,s){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const c=Qp(this.iconSizeData,n),f=Qp(this.textSizeData,n);for(let y=0;y<this.symbolInstances.length;y++){const w=this.symbolInstances.get(y);this._updateTextDebugCollisionBoxes(f,n,s,w.textBoxStartIndex,w.textBoxEndIndex,w),this._updateTextDebugCollisionBoxes(f,n,s,w.verticalTextBoxStartIndex,w.verticalTextBoxEndIndex,w),this._updateIconDebugCollisionBoxes(c,n,s,w.iconBoxStartIndex,w.iconBoxEndIndex,w.placedIconSymbolIndex),this._updateIconDebugCollisionBoxes(c,n,s,w.verticalIconBoxStartIndex,w.verticalIconBoxEndIndex,w.placedIconSymbolIndex)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(n,s,c,f,y,w,E,A,I){const j={};if(s<c){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Re}=n.get(s);j.textBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee},j.textFeatureIndex=Re}if(f<y){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Re}=n.get(f);j.verticalTextBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee},j.verticalTextFeatureIndex=Re}if(w<E){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Re}=n.get(w);j.iconBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee},j.iconFeatureIndex=Re}if(A<I){const{x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee,featureIndex:Re}=n.get(A);j.verticalIconBox={x1:V,y1:U,x2:q,y2:X,padding:te,projectedAnchorX:ae,projectedAnchorY:ge,projectedAnchorZ:Ce,tileAnchorX:ye,tileAnchorY:Ee},j.verticalIconFeatureIndex=Re}return j}deserializeCollisionBoxes(n){this.collisionArrays=[];for(let s=0;s<this.symbolInstances.length;s++){const c=this.symbolInstances.get(s);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(n,c.textBoxStartIndex,c.textBoxEndIndex,c.verticalTextBoxStartIndex,c.verticalTextBoxEndIndex,c.iconBoxStartIndex,c.iconBoxEndIndex,c.verticalIconBoxStartIndex,c.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}addIndicesForPlacedSymbol(n,s){const c=n.placedSymbolArray.get(s),f=c.vertexStartIndex+4*c.numGlyphs;for(let y=c.vertexStartIndex;y<f;y+=4)n.indexArray.emplaceBack(y,y+1,y+2),n.indexArray.emplaceBack(y+1,y+2,y+3)}getSortedSymbolIndexes(n){if(this.sortedAngle===n&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const s=Math.sin(n),c=Math.cos(n),f=[],y=[],w=[];for(let E=0;E<this.symbolInstances.length;++E){w.push(E);const A=this.symbolInstances.get(E);f.push(0|Math.round(s*A.tileAnchorX+c*A.tileAnchorY)),y.push(A.featureIndex)}return w.sort(((E,A)=>f[E]-f[A]||y[A]-y[E])),w}addToSortKeyRanges(n,s){const c=this.sortKeyRanges[this.sortKeyRanges.length-1];c&&c.sortKey===s?c.symbolInstanceEnd=n+1:this.sortKeyRanges.push({sortKey:s,symbolInstanceStart:n,symbolInstanceEnd:n+1})}sortFeatures(n){if(this.sortFeaturesByY&&this.sortedAngle!==n&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(n),this.sortedAngle=n,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const s of this.symbolInstanceIndexes){const c=this.symbolInstances.get(s);this.featureSortOrder.push(c.featureIndex);const{rightJustifiedTextSymbolIndex:f,centerJustifiedTextSymbolIndex:y,leftJustifiedTextSymbolIndex:w,verticalPlacedTextSymbolIndex:E,placedIconSymbolIndex:A,verticalPlacedIconSymbolIndex:I}=c;f>=0&&this.addIndicesForPlacedSymbol(this.text,f),y>=0&&y!==f&&this.addIndicesForPlacedSymbol(this.text,y),w>=0&&w!==y&&w!==f&&this.addIndicesForPlacedSymbol(this.text,w),E>=0&&this.addIndicesForPlacedSymbol(this.text,E),A>=0&&this.addIndicesForPlacedSymbol(this.icon,A),I>=0&&this.addIndicesForPlacedSymbol(this.icon,I)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}Ft(Ud,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Ud.MAX_GLYPHS=65535,Ud.addDynamicAttributes=Y_;const B5=new ve({"symbol-placement":new Q(dt.layout_symbol["symbol-placement"]),"symbol-spacing":new Q(dt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Q(dt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new le(dt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Q(dt.layout_symbol["symbol-z-order"]),"icon-allow-overlap":new Q(dt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Q(dt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Q(dt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Q(dt.layout_symbol["icon-rotation-alignment"]),"icon-size":new le(dt.layout_symbol["icon-size"]),"icon-text-fit":new Q(dt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new Q(dt.layout_symbol["icon-text-fit-padding"]),"icon-image":new le(dt.layout_symbol["icon-image"]),"icon-rotate":new le(dt.layout_symbol["icon-rotate"]),"icon-padding":new Q(dt.layout_symbol["icon-padding"]),"icon-keep-upright":new Q(dt.layout_symbol["icon-keep-upright"]),"icon-offset":new le(dt.layout_symbol["icon-offset"]),"icon-anchor":new le(dt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Q(dt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Q(dt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Q(dt.layout_symbol["text-rotation-alignment"]),"text-field":new le(dt.layout_symbol["text-field"]),"text-font":new le(dt.layout_symbol["text-font"]),"text-size":new le(dt.layout_symbol["text-size"]),"text-max-width":new le(dt.layout_symbol["text-max-width"]),"text-line-height":new le(dt.layout_symbol["text-line-height"]),"text-letter-spacing":new le(dt.layout_symbol["text-letter-spacing"]),"text-justify":new le(dt.layout_symbol["text-justify"]),"text-radial-offset":new le(dt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Q(dt.layout_symbol["text-variable-anchor"]),"text-anchor":new le(dt.layout_symbol["text-anchor"]),"text-max-angle":new Q(dt.layout_symbol["text-max-angle"]),"text-writing-mode":new Q(dt.layout_symbol["text-writing-mode"]),"text-rotate":new le(dt.layout_symbol["text-rotate"]),"text-padding":new Q(dt.layout_symbol["text-padding"]),"text-keep-upright":new Q(dt.layout_symbol["text-keep-upright"]),"text-transform":new le(dt.layout_symbol["text-transform"]),"text-offset":new le(dt.layout_symbol["text-offset"]),"text-allow-overlap":new Q(dt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Q(dt.layout_symbol["text-ignore-placement"]),"text-optional":new Q(dt.layout_symbol["text-optional"])});var V0={paint:new ve({"icon-opacity":new le(dt.paint_symbol["icon-opacity"]),"icon-color":new le(dt.paint_symbol["icon-color"]),"icon-halo-color":new le(dt.paint_symbol["icon-halo-color"]),"icon-halo-width":new le(dt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new le(dt.paint_symbol["icon-halo-blur"]),"icon-translate":new Q(dt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Q(dt.paint_symbol["icon-translate-anchor"]),"text-opacity":new le(dt.paint_symbol["text-opacity"]),"text-color":new le(dt.paint_symbol["text-color"],{runtimeType:vs,getOverride:i=>i.textColor,hasOverride:i=>!!i.textColor}),"text-halo-color":new le(dt.paint_symbol["text-halo-color"]),"text-halo-width":new le(dt.paint_symbol["text-halo-width"]),"text-halo-blur":new le(dt.paint_symbol["text-halo-blur"]),"text-translate":new Q(dt.paint_symbol["text-translate"]),"text-translate-anchor":new Q(dt.paint_symbol["text-translate-anchor"])}),layout:B5};class pE{constructor(n){this.type=n.property.overrides?n.property.overrides.runtimeType:ia,this.defaultValue=n}evaluate(n){if(n.formattedSection){const s=this.defaultValue.property.overrides;if(s&&s.hasOverride(n.formattedSection))return s.getOverride(n.formattedSection)}return n.feature&&n.featureState?this.defaultValue.evaluate(n.feature,n.featureState):this.defaultValue.property.specification.default}eachChild(n){this.defaultValue.isConstant()||n(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}Ft(pE,"FormatSectionOverride",{omit:["defaultValue"]});class J_ extends ma{constructor(n){super(n,V0)}recalculate(n,s){super.recalculate(n,s),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const c=this.layout.get("text-writing-mode");if(c){const f=[];for(const y of c)f.indexOf(y)<0&&f.push(y);this.layout._values["text-writing-mode"]=f}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getValueAndResolveTokens(n,s,c,f){const y=this.layout.get(n).evaluate(s,{},c,f),w=this._unevaluatedLayout._values[n];return w.isDataDriven()||_l(w.value)||!y?y:(function(E,A){return A.replace(/{([^{}]+)}/g,((I,j)=>j in E?String(E[j]):""))})(s.properties,y)}createBucket(n){return new Ud(n)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const n of V0.paint.overridableProperties){if(!J_.hasPaintOverride(this.layout,n))continue;const s=this.paint.get(n),c=new pE(s),f=new yu(c,s.property.specification);let y=null;y=s.value.kind==="constant"||s.value.kind==="source"?new _u("source",f):new ja("composite",f,s.value.zoomStops,s.value._interpolationType),this.paint._values[n]=new de(s.property,y,s.parameters)}}_handleOverridablePaintPropertyUpdate(n,s,c){return!(!this.layout||s.isDataDriven()||c.isDataDriven())&&J_.hasPaintOverride(this.layout,n)}static hasPaintOverride(n,s){const c=n.get("text-field"),f=V0.paint.properties[s];let y=!1;const w=E=>{for(const A of E)if(f.overrides&&f.overrides.hasOverride(A))return void(y=!0)};if(c.value.kind==="constant"&&c.value.value instanceof Pi)w(c.value.value.sections);else if(c.value.kind==="source"){const E=I=>{y||(I instanceof wo&&Br(I.value)===cl?w(I.value.sections):I instanceof Uo?w(I.sections):I.eachChild(E))},A=c.value;A._styleExpression&&E(A._styleExpression.expression)}return y}getProgramConfiguration(n){return new kl(this,n)}}var F5={paint:new ve({"background-color":new Q(dt.paint_background["background-color"]),"background-pattern":new Q(dt.paint_background["background-pattern"]),"background-opacity":new Q(dt.paint_background["background-opacity"])})},V5={paint:new ve({"raster-opacity":new Q(dt.paint_raster["raster-opacity"]),"raster-hue-rotate":new Q(dt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Q(dt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Q(dt.paint_raster["raster-brightness-max"]),"raster-saturation":new Q(dt.paint_raster["raster-saturation"]),"raster-contrast":new Q(dt.paint_raster["raster-contrast"]),"raster-resampling":new Q(dt.paint_raster["raster-resampling"]),"raster-fade-duration":new Q(dt.paint_raster["raster-fade-duration"])})};class U5 extends ma{constructor(n){super(n,{}),this.implementation=n}is3D(){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isLayerDraped(){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(n){this.implementation.onAdd&&this.implementation.onAdd(n,n.painter.context.gl)}onRemove(n){this.implementation.onRemove&&this.implementation.onRemove(n,n.painter.context.gl)}}var $5={paint:new ve({"sky-type":new Q(dt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Q(dt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Q(dt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Q(dt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Q(dt.paint_sky["sky-gradient-radius"]),"sky-gradient":new _e(dt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Q(dt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Q(dt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Q(dt.paint_sky["sky-opacity"])})};function U0(i,n,s){const c=[0,0,1],f=cf([]);return fg(f,f,s?-gt(i)+Math.PI:gt(i)),k_(f,f,-gt(n)),Np(c,c,f),cs(c,c)}const G5={circle:class extends ma{constructor(i){super(i,R_)}createBucket(i){return new Nu(i)}queryRadius(i){const n=i;return Du("circle-radius",this,n)+Du("circle-stroke-width",this,n)+jd(this.paint.get("circle-translate"))}queryIntersectsFeature(i,n,s,c,f,y,w,E){const A=Hp(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),I=this.paint.get("circle-radius").evaluate(n,s)+this.paint.get("circle-stroke-width").evaluate(n,s);return Tg(i,c,y,w,E,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",A,I)}getProgramIds(){return["circle"]}getProgramConfiguration(i){return new kl(this,i)}},heatmap:class extends ma{createBucket(i){return new Eg(i)}constructor(i){super(i,mi),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=Ag({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(i){return Du("heatmap-radius",this,i)}queryIntersectsFeature(i,n,s,c,f,y,w,E){const A=this.paint.get("heatmap-radius").evaluate(n,s);return Tg(i,c,y,w,E,!0,!0,new Pe(0,0),A)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getProgramConfiguration(i){return new kl(this,i)}},hillshade:class extends ma{constructor(i){super(i,N_)}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}},fill:class extends ma{constructor(i){super(i,F)}getProgramIds(){const i=this.paint.get("fill-pattern"),n=i&&i.constantOr(1),s=[n?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&s.push(n&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),s}getProgramConfiguration(i){return new kl(this,i)}recalculate(i,n){super.recalculate(i,n);const s=this.paint._values["fill-outline-color"];s.value.kind==="constant"&&s.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(i){return new S(i)}queryRadius(){return jd(this.paint.get("fill-translate"))}queryIntersectsFeature(i,n,s,c,f,y){return!i.queryGeometry.isAboveHorizon&&_f(Pc(i.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),c)}isTileClipped(){return!0}},"fill-extrusion":class extends ma{constructor(i){super(i,zL)}createBucket(i){return new Lg(i)}queryRadius(){return jd(this.paint.get("fill-extrusion-translate"))}is3D(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}getProgramConfiguration(i){return new kl(this,i)}queryIntersectsFeature(i,n,s,c,f,y,w,E,A){const I=Hp(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),j=this.paint.get("fill-extrusion-height").evaluate(n,s),V=this.paint.get("fill-extrusion-base").evaluate(n,s),U=[0,0],q=E&&y.elevation,X=y.elevation?y.elevation.exaggeration():1,te=i.tile.getBucket(this);if(q&&te instanceof Lg){const Ee=te.centroidVertexArray,Re=A+1;Re<Ee.length&&(U[0]=Ee.geta_centroid_pos0(Re),U[1]=Ee.geta_centroid_pos1(Re))}if(U[0]===0&&U[1]===1)return!1;y.projection.name==="globe"&&(c=SS([c],[new Pe(0,0),new Pe(an,an)],i.tileID.canonical).map((Ee=>Ee.polygon)).flat());const ae=q?E:null,[ge,Ce]=(function(Ee,Re,Me,Qe,Xe,ft,It,nt,yt,_t,Ct){return Ee.projection.name==="globe"?(function(Pt,ct,Bt,Jt,$t,Nn,Nt,cn,Dn,cr,Ln){const wn=[],Lr=[],On=Pt.projection.upVectorScale(Ln,Pt.center.lat,Pt.worldSize).metersToTile,zn=[0,0,0,1],wr=[0,0,0,1],Ir=(br,Wr,li,Ti)=>{br[0]=Wr,br[1]=li,br[2]=Ti,br[3]=1},Mr=TS();Bt>0&&(Bt+=Mr),Jt+=Mr;for(const br of ct){const Wr=[],li=[];for(const Ti of br){const Tr=Ti.x+$t.x,Oi=Ti.y+$t.y,Si=Pt.projection.projectTilePoint(Tr,Oi,Ln),Qr=Pt.projection.upVector(Ln,Ti.x,Ti.y);let pr=Bt,Ei=Jt;if(Nt){const Pr=AS(Tr,Oi,Bt,Jt,Nt,cn,Dn,cr);pr+=Pr.base,Ei+=Pr.top}Bt!==0?Ir(zn,Si.x+Qr[0]*On*pr,Si.y+Qr[1]*On*pr,Si.z+Qr[2]*On*pr):Ir(zn,Si.x,Si.y,Si.z),Ir(wr,Si.x+Qr[0]*On*Ei,Si.y+Qr[1]*On*Ei,Si.z+Qr[2]*On*Ei),Hr(zn,zn,Nn),Hr(wr,wr,Nn),Wr.push(new Jp(zn[0],zn[1],zn[2])),li.push(new Jp(wr[0],wr[1],wr[2]))}wn.push(Wr),Lr.push(li)}return[wn,Lr]})(Ee,Re,Me,Qe,Xe,ft,It,nt,yt,_t,Ct):It?(function(Pt,ct,Bt,Jt,$t,Nn,Nt,cn,Dn){const cr=[],Ln=[],wn=[0,0,0,1];for(const Lr of Pt){const On=[],zn=[];for(const wr of Lr){const Ir=wr.x+Jt.x,Mr=wr.y+Jt.y,br=AS(Ir,Mr,ct,Bt,Nn,Nt,cn,Dn);wn[0]=Ir,wn[1]=Mr,wn[2]=br.base,wn[3]=1,kc(wn,wn,$t),wn[3]=Math.max(wn[3],1e-5);const Wr=new Jp(wn[0]/wn[3],wn[1]/wn[3],wn[2]/wn[3]);wn[0]=Ir,wn[1]=Mr,wn[2]=br.top,wn[3]=1,kc(wn,wn,$t),wn[3]=Math.max(wn[3],1e-5);const li=new Jp(wn[0]/wn[3],wn[1]/wn[3],wn[2]/wn[3]);On.push(Wr),zn.push(li)}cr.push(On),Ln.push(zn)}return[cr,Ln]})(Re,Me,Qe,Xe,ft,It,nt,yt,_t):(function(Pt,ct,Bt,Jt,$t){const Nn=[],Nt=[],cn=$t[8]*ct,Dn=$t[9]*ct,cr=$t[10]*ct,Ln=$t[11]*ct,wn=$t[8]*Bt,Lr=$t[9]*Bt,On=$t[10]*Bt,zn=$t[11]*Bt;for(const wr of Pt){const Ir=[],Mr=[];for(const br of wr){const Wr=br.x+Jt.x,li=br.y+Jt.y,Ti=$t[0]*Wr+$t[4]*li+$t[12],Tr=$t[1]*Wr+$t[5]*li+$t[13],Oi=$t[2]*Wr+$t[6]*li+$t[14],Si=$t[3]*Wr+$t[7]*li+$t[15],Qr=Ti+cn,pr=Tr+Dn,Ei=Oi+cr,Pr=Math.max(Si+Ln,1e-5),mo=Ti+wn,Ci=Tr+Lr,fs=Oi+On,es=Math.max(Si+zn,1e-5);Ir.push(new Jp(Qr/Pr,pr/Pr,Ei/Pr)),Mr.push(new Jp(mo/es,Ci/es,fs/es))}Nn.push(Ir),Nt.push(Mr)}return[Nn,Nt]})(Re,Me,Qe,Xe,ft)})(y,c,V,j,I,w,ae,U,X,y.center.lat,i.tileID.canonical),ye=i.queryGeometry;return(function(Ee,Re,Me){let Qe=1/0;_f(Me,Re)&&(Qe=kS(Me,Re[0]));for(let Xe=0;Xe<Re.length;Xe++){const ft=Re[Xe],It=Ee[Xe];for(let nt=0;nt<ft.length-1;nt++){const yt=ft[nt],_t=[yt,ft[nt+1],It[nt+1],It[nt],yt];Up(Me,_t)&&(Qe=Math.min(Qe,kS(Me,_t)))}}return Qe!==1/0&&Qe})(ge,Ce,ye.isPointQuery()?ye.screenBounds:ye.screenGeometry)}},line:class extends ma{constructor(i){super(i,IS),this.gradientVersion=0}_handleSpecialPaintPropertyUpdate(i){if(i==="line-gradient"){const n=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=n._styleExpression&&n._styleExpression.expression instanceof Oh,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(i,n){super.recalculate(i,n),this.paint._values["line-floorwidth"]=MS.possiblyEvaluate(this._transitioningPaint._values["line-width"].value,i)}createBucket(i){return new z_(i)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getProgramConfiguration(i){return new kl(this,i)}queryRadius(i){const n=i,s=PS(Du("line-width",this,n),Du("line-gap-width",this,n)),c=Du("line-offset",this,n);return s/2+Math.abs(c)+jd(this.paint.get("line-translate"))}queryIntersectsFeature(i,n,s,c,f,y){if(i.queryGeometry.isAboveHorizon)return!1;const w=Pc(i.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),y.angle,i.pixelToTileUnitsFactor),E=i.pixelToTileUnitsFactor/2*PS(this.paint.get("line-width").evaluate(n,s),this.paint.get("line-gap-width").evaluate(n,s)),A=this.paint.get("line-offset").evaluate(n,s);return A&&(c=(function(I,j){const V=[],U=new Pe(0,0);for(let q=0;q<I.length;q++){const X=I[q],te=[];for(let ae=0;ae<X.length;ae++){const ge=X[ae],Ce=X[ae+1],ye=ae===0?U:ge.sub(X[ae-1])._unit()._perp(),Ee=ae===X.length-1?U:Ce.sub(ge)._unit()._perp(),Re=ye._add(Ee)._unit();Re._mult(1/(Re.x*Ee.x+Re.y*Ee.y)),te.push(Re._mult(j)._add(ge))}V.push(te)}return V})(c,A*i.pixelToTileUnitsFactor)),(function(I,j,V){for(let U=0;U<j.length;U++){const q=j[U];if(I.length>=3){for(let X=0;X<q.length;X++)if(Pl(I,q[X]))return!0}if(Gs(I,q,V))return!0}return!1})(w,c,E)}isTileClipped(){return!0}},symbol:J_,background:class extends ma{constructor(i){super(i,F5)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}},raster:class extends ma{constructor(i){super(i,V5)}getProgramIds(){return["raster"]}},sky:class extends ma{constructor(i){super(i,$5),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(i){i==="sky-gradient"?this._updateColorRamp():i!=="sky-atmosphere-sun"&&i!=="sky-atmosphere-halo-color"&&i!=="sky-atmosphere-color"&&i!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=Ag({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(i){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const n=i.style.light.properties.get("position");return this._lightPosition.azimuthal!==n.azimuthal||this._lightPosition.polar!==n.polar}return!1}getCenter(i,n){if(this.paint.get("sky-type")==="atmosphere"){const c=this.paint.get("sky-atmosphere-sun"),f=!c,y=i.style.light,w=y.properties.get("position");return f&&y.properties.get("anchor")==="viewport"&&Xn("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),f?U0(w.azimuthal,90-w.polar,n):U0(c[0],90-c[1],n)}const s=this.paint.get("sky-gradient-center");return U0(s[0],90-s[1],n)}is3D(){return!1}isSky(){return!0}markSkyboxValid(i){this._skyboxInvalidated=!1,this._lightPosition=i.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const i=this.paint.get("sky-type");return i==="atmosphere"?["skyboxCapture","skybox"]:i==="gradient"?["skyboxGradient"]:null}}};class Wg{constructor(n,s,c,f){this.context=n,this.format=c,this.texture=n.gl.createTexture(),this.update(s,f)}update(n,s,c){const{width:f,height:y}=n,{context:w}=this,{gl:E}=w,{HTMLImageElement:A,HTMLCanvasElement:I,HTMLVideoElement:j,ImageData:V,ImageBitmap:U}=k;if(E.bindTexture(E.TEXTURE_2D,this.texture),w.pixelStoreUnpackFlipY.set(!1),w.pixelStoreUnpack.set(1),w.pixelStoreUnpackPremultiplyAlpha.set(this.format===E.RGBA&&(!s||s.premultiply!==!1)),c||this.size&&this.size[0]===f&&this.size[1]===y){const{x:q,y:X}=c||{x:0,y:0};n instanceof A||n instanceof I||n instanceof j||n instanceof V||U&&n instanceof U?E.texSubImage2D(E.TEXTURE_2D,0,q,X,E.RGBA,E.UNSIGNED_BYTE,n):E.texSubImage2D(E.TEXTURE_2D,0,q,X,f,y,E.RGBA,E.UNSIGNED_BYTE,n.data)}else this.size=[f,y],n instanceof A||n instanceof I||n instanceof j||n instanceof V||U&&n instanceof U?E.texImage2D(E.TEXTURE_2D,0,this.format,this.format,E.UNSIGNED_BYTE,n):E.texImage2D(E.TEXTURE_2D,0,this.format,f,y,0,this.format,E.UNSIGNED_BYTE,n.data);this.useMipmap=!!(s&&s.useMipmap&&this.isSizePowerOfTwo()),this.useMipmap&&E.generateMipmap(E.TEXTURE_2D)}bind(n,s){const{context:c}=this,{gl:f}=c;f.bindTexture(f.TEXTURE_2D,this.texture),n!==this.filter&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MAG_FILTER,n),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_MIN_FILTER,this.useMipmap?n===f.NEAREST?f.NEAREST_MIPMAP_NEAREST:f.LINEAR_MIPMAP_NEAREST:n),this.filter=n),s!==this.wrap&&(f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_S,s),f.texParameteri(f.TEXTURE_2D,f.TEXTURE_WRAP_T,s),this.wrap=s)}isSizePowerOfTwo(){return this.size[0]===this.size[1]&&Math.log(this.size[0])/Math.LN2%1==0}destroy(){const{gl:n}=this.context;n.deleteTexture(this.texture),this.texture=null}}class H5{constructor(n){this._callback=n,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout((()=>{this._triggered=!1,this._callback()}),0))}remove(){this._channel=void 0,this._callback=()=>{}}}class W5{constructor(){this.tasks={},this.taskQueue=[],fn(["process"],this),this.invoker=new H5(this.process),this.nextId=0}add(n,s){const c=this.nextId++,f=(function({type:y,isSymbolTile:w,zoom:E}){return E=E||0,y==="message"?0:y!=="maybePrepare"||w?y!=="parseTile"||w?y==="parseTile"&&w?300-E:y==="maybePrepare"&&w?400-E:500:200-E:100-E})(s);return f===0?(xi(),n(),{cancel:()=>{}}):(this.tasks[c]={fn:n,metadata:s,priority:f,id:c},this.taskQueue.push(c),this.invoker.trigger(),{cancel:()=>{delete this.tasks[c]}})}process(){xi();{if(this.taskQueue=this.taskQueue.filter((c=>!!this.tasks[c])),!this.taskQueue.length)return;const n=this.pick();if(n===null)return;const s=this.tasks[n];if(delete this.tasks[n],this.taskQueue.length&&this.invoker.trigger(),!s)return;s.fn()}}pick(){let n=null,s=1/0;for(let f=0;f<this.taskQueue.length;f++){const y=this.tasks[this.taskQueue[f]];y.priority<s&&(s=y.priority,n=f)}if(n===null)return null;const c=this.taskQueue[n];return this.taskQueue.splice(n,1),c}remove(){this.invoker.remove()}}class mE{constructor(n){this._stringToNumber={},this._numberToString=[];for(let s=0;s<n.length;s++){const c=n[s];this._stringToNumber[c]=s,this._numberToString[s]=c}}encode(n){return this._stringToNumber[n]}decode(n){return this._numberToString[n]}}const q5=["tile","layer","source","sourceLayer","state"];class gE{constructor(n,s,c,f,y){this.type="Feature",this._vectorTileFeature=n,this._z=s,this._x=c,this._y=f,this.properties=n.properties,this.id=y}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(n){this._geometry=n}toJSON(){const n={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};this.id!==void 0&&(n.id=this.id);for(const s of q5)this[s]!==void 0&&(n[s]=this[s]);return n}}const Ya=32,Lc=33,$d=new Uint16Array(8184);for(let i=0;i<2046;i++){let n=i+2,s=0,c=0,f=0,y=0,w=0,E=0;for(1&n?f=y=w=Ya:s=c=E=Ya;(n>>=1)>1;){const I=s+f>>1,j=c+y>>1;1&n?(f=s,y=c,s=w,c=E):(s=f,c=y,f=w,y=E),w=I,E=j}const A=4*i;$d[A+0]=s,$d[A+1]=c,$d[A+2]=f,$d[A+3]=y}const jc=new Uint16Array(2178),Gd=new Uint8Array(1089),Q_=new Uint16Array(1089);function yE(i){return i===0?-.03125:i===32?.03125:0}var _E=Ue([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);const xE={type:2,extent:an,loadGeometry:()=>[[new Pe(0,0),new Pe(an+1,0),new Pe(an+1,an+1),new Pe(0,an+1),new Pe(0,0)]]};class $0{constructor(n,s,c,f,y){this.tileID=n,this.uid=rn(),this.uses=0,this.tileSize=s,this.tileZoom=c,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=y,this.expiredRequestCount=0,this.state="loading",f&&f.transform&&(this.projection=f.transform.projection)}registerFadeDuration(n){const s=n+this.timeAdded;s<Bo.now()||this.fadeEndTime&&s<this.fadeEndTime||(this.fadeEndTime=s)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=Af(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(n,s,c){if(this.unloadVectorData(),this.state="loaded",n){n.featureIndex&&(this.latestFeatureIndex=n.featureIndex,n.rawTileData?(this.latestRawTileData=n.rawTileData,this.latestFeatureIndex.rawTileData=n.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=n.collisionBoxArray,this.buckets=(function(f,y){const w={};if(!y)return w;for(const E of f){const A=E.layerIds.map((I=>y.getLayer(I))).filter(Boolean);if(A.length!==0){E.layers=A,E.stateDependentLayerIds&&(E.stateDependentLayers=E.stateDependentLayerIds.map((I=>A.filter((j=>j.id===I))[0])));for(const I of A)w[I.id]=E}}return w})(n.buckets,s.style),this.hasSymbolBuckets=!1;for(const f in this.buckets){const y=this.buckets[f];if(y instanceof Ud){if(this.hasSymbolBuckets=!0,!c)break;y.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const f in this.buckets){const y=this.buckets[f];if(y instanceof Ud&&y.hasRTLText){this.hasRTLText=!0,D.isLoading()||D.isLoaded()||C()!=="deferred"||N();break}}this.queryPadding=0;for(const f in this.buckets){const y=this.buckets[f];this.queryPadding=Math.max(this.queryPadding,s.style.getLayer(f).queryRadius(y))}n.imageAtlas&&(this.imageAtlas=n.imageAtlas),n.glyphAtlasImage&&(this.glyphAtlasImage=n.glyphAtlasImage),n.lineAtlas&&(this.lineAtlas=n.lineAtlas)}else this.collisionBoxArray=new fr}unloadVectorData(){if(this.hasData()){for(const n in this.buckets)this.buckets[n].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}getBucket(n){return this.buckets[n.id]}upload(n){for(const c in this.buckets){const f=this.buckets[c];f.uploadPending()&&f.upload(n)}const s=n.gl;this.imageAtlas&&!this.imageAtlas.uploaded&&(this.imageAtlasTexture=new Wg(n,this.imageAtlas.image,s.RGBA),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new Wg(n,this.glyphAtlasImage,s.ALPHA),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new Wg(n,this.lineAtlas.image,s.ALPHA),this.lineAtlas.uploaded=!0)}prepare(n){this.imageAtlas&&this.imageAtlas.patchUpdatedImages(n,this.imageAtlasTexture)}queryRenderedFeatures(n,s,c,f,y,w,E,A){return this.latestFeatureIndex&&this.latestFeatureIndex.rawTileData?this.latestFeatureIndex.query({tileResult:f,pixelPosMatrix:E,transform:w,params:y,tileTransform:this.tileTransform},n,s,c):{}}querySourceFeatures(n,s){const c=this.latestFeatureIndex;if(!c||!c.rawTileData)return;const f=c.loadVTLayers(),y=s?s.sourceLayer:"",w=f._geojsonTileLayer||f[y];if(!w)return;const E=gc(s&&s.filter),{z:A,x:I,y:j}=this.tileID.canonical,V={z:A,x:I,y:j};for(let U=0;U<w.length;U++){const q=w.feature(U);if(E.needGeometry){const ae=Xa(q,!0);if(!E.filter(new B(this.tileID.overscaledZ),ae,this.tileID.canonical))continue}else if(!E.filter(new B(this.tileID.overscaledZ),q))continue;const X=c.getId(q,y),te=new gE(q,A,I,j,X);te.tile=V,n.push(te)}}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!Object.keys(this.imageAtlas.patternPositions).length}setExpiryData(n){const s=this.expirationTime;if(n.cacheControl){const c=Zr(n.cacheControl);c["max-age"]&&(this.expirationTime=Date.now()+1e3*c["max-age"])}else n.expires&&(this.expirationTime=new Date(n.expires).getTime());if(this.expirationTime){const c=Date.now();let f=!1;if(this.expirationTime>c)f=!1;else if(s)if(this.expirationTime<s)f=!0;else{const y=this.expirationTime-s;y?this.expirationTime=c+Math.max(y,3e4):f=!0}else f=!0;f?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}setFeatureState(n,s){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData||Object.keys(n).length===0||!s)return;const c=this.latestFeatureIndex.loadVTLayers(),f=s.style.listImages();for(const y in this.buckets){if(!s.style.hasLayer(y))continue;const w=this.buckets[y],E=w.layers[0].sourceLayer||"_geojsonTileLayer",A=c[E],I=n[E];if(!A||!I||Object.keys(I).length===0)continue;if(w.update(I,A,f,this.imageAtlas&&this.imageAtlas.patternPositions||{}),w instanceof z_||w instanceof S){const V=s.style._getSourceCache(w.layers[0].source);s._terrain&&s._terrain.enabled&&V&&w.programConfigurations.needsUpload&&s._terrain._clearRenderCacheForTile(V.id,this.tileID)}const j=s&&s.style&&s.style.getLayer(y);j&&(this.queryPadding=Math.max(this.queryPadding,j.queryRadius(w)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<Bo.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(n){this.symbolFadeHoldUntil=Bo.now()+n}setTexture(n,s){const c=s.context,f=c.gl;this.texture=this.texture||s.getTileTexture(n.width),this.texture?this.texture.update(n,{useMipmap:!0}):(this.texture=new Wg(c,n,f.RGBA,{useMipmap:!0}),this.texture.bind(f.LINEAR,f.CLAMP_TO_EDGE))}setDependencies(n,s){const c={};for(const f of s)c[f]=!0;this.dependencies[n]=c}hasDependency(n,s){for(const c of n){const f=this.dependencies[c];if(f){for(const y of s)if(f[y])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(n,s){if(!s||s.name==="mercator"||this._tileDebugBuffer)return;const c=As(xE,this.tileID.canonical,this.tileTransform)[0],f=new kt,y=new Vs;for(let w=0;w<c.length;w++){const{x:E,y:A}=c[w];f.emplaceBack(E,A),y.emplaceBack(w)}y.emplaceBack(0),this._tileDebugIndexBuffer=n.createIndexBuffer(y),this._tileDebugBuffer=n.createVertexBuffer(f,df.members),this._tileDebugSegments=oi.simpleSegment(0,0,f.length,y.length)}_makeTileBoundsBuffers(n,s){if(this._tileBoundsBuffer||!s||s.name==="mercator")return;const c=As(xE,this.tileID.canonical,this.tileTransform)[0];let f,y;if(this.isRaster){const w=(function(E,A){const I=Af(E,A),j=Math.pow(2,E.z);for(let ae=0;ae<Lc;ae++)for(let ge=0;ge<Lc;ge++){const Ce=Yi((E.x+(ge+yE(ge))/Ya)/j),ye=ar((E.y+(ae+yE(ae))/Ya)/j),Ee=A.project(Ce,ye),Re=ae*Lc+ge;jc[2*Re+0]=Math.round((Ee.x*I.scale-I.x)*an),jc[2*Re+1]=Math.round((Ee.y*I.scale-I.y)*an)}Gd.fill(0),Q_.fill(0);for(let ae=2045;ae>=0;ae--){const ge=4*ae,Ce=$d[ge+0],ye=$d[ge+1],Ee=$d[ge+2],Re=$d[ge+3],Me=Ce+Ee>>1,Qe=ye+Re>>1,Xe=Me+Qe-ye,ft=Qe+Ce-Me,It=ye*Lc+Ce,nt=Re*Lc+Ee,yt=Qe*Lc+Me,_t=Math.hypot((jc[2*It+0]+jc[2*nt+0])/2-jc[2*yt+0],(jc[2*It+1]+jc[2*nt+1])/2-jc[2*yt+1])>=16;Gd[yt]=Gd[yt]||(_t?1:0),ae<1022&&(Gd[yt]=Gd[yt]||Gd[(ye+ft>>1)*Lc+(Ce+Xe>>1)]||Gd[(Re+ft>>1)*Lc+(Ee+Xe>>1)])}const V=new at,U=new en;let q=0;function X(ae,ge){const Ce=ge*Lc+ae;return Q_[Ce]===0&&(V.emplaceBack(jc[2*Ce+0],jc[2*Ce+1],ae*an/Ya,ge*an/Ya),Q_[Ce]=++q),Q_[Ce]-1}function te(ae,ge,Ce,ye,Ee,Re){const Me=ae+Ce>>1,Qe=ge+ye>>1;if(Math.abs(ae-Ee)+Math.abs(ge-Re)>1&&Gd[Qe*Lc+Me])te(Ee,Re,ae,ge,Me,Qe),te(Ce,ye,Ee,Re,Me,Qe);else{const Xe=X(ae,ge),ft=X(Ce,ye),It=X(Ee,Re);U.emplaceBack(Xe,ft,It)}}return te(0,0,Ya,Ya,Ya,0),te(Ya,Ya,0,0,0,Ya),{vertices:V,indices:U}})(this.tileID.canonical,s);f=w.vertices,y=w.indices}else{f=new at,y=new en;for(const{x:E,y:A}of c)f.emplaceBack(E,A,0,0);const w=Kp(f.int16,void 0,4);for(let E=0;E<w.length;E+=3)y.emplaceBack(w[E],w[E+1],w[E+2])}this._tileBoundsBuffer=n.createVertexBuffer(f,_E.members),this._tileBoundsIndexBuffer=n.createIndexBuffer(y),this._tileBoundsSegments=oi.simpleSegment(0,0,f.length,y.length)}_makeGlobeTileDebugBuffers(n,s){const c=s.projection;if(!c||c.name!=="globe"||s.freezeTileCoverage)return;const f=this.tileID.canonical,y=Us(gg(f,s)),w=Nd(s.zoom);let E;w>0&&(E=ko(new Float64Array(16),s.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(n,f,s,y,E,w),this._makeGlobeTileDebugTextBuffer(n,f,s,y,E,w)}_globePoint(n,s,c,f,y,w,E){let A=Yo(n,s,c);if(w){const I=1<<c.z,j=kr(f.center.lng),V=Fr(f.center.lat),U=(c.x+.5)/I-j;let q=0;U>.5?q=-1:U<-.5&&(q=1);let X=(n/an+c.x)/I+q,te=(s/an+c.y)/I;X=(X-j)*f._pixelsPerMercatorPixel+j,te=(te-V)*f._pixelsPerMercatorPixel+V;const ae=[X*f.worldSize,te*f.worldSize,0];Hr(ae,ae,w),A=Ml(A,ae,E)}return Hr(A,A,y)}_makeGlobeTileDebugBorderBuffer(n,s,c,f,y,w){const E=new kt,A=new Vs,I=new qe,j=(U,q,X,te,ae)=>{const ge=(X-U)/(ae-1),Ce=(te-q)/(ae-1),ye=E.length;for(let Ee=0;Ee<ae;Ee++){const Re=U+Ee*ge,Me=q+Ee*Ce;E.emplaceBack(Re,Me);const Qe=this._globePoint(Re,Me,s,c,f,y,w);I.emplaceBack(Qe[0],Qe[1],Qe[2]),A.emplaceBack(ye+Ee)}},V=an;j(0,0,V,0,16),j(V,0,V,V,16),j(V,V,0,V,16),j(0,V,0,0,16),this._tileDebugIndexBuffer=n.createIndexBuffer(A),this._tileDebugBuffer=n.createVertexBuffer(E,df.members),this._globeTileDebugBorderBuffer=n.createVertexBuffer(I,Wa.members),this._tileDebugSegments=oi.simpleSegment(0,0,E.length,A.length)}_makeGlobeTileDebugTextBuffer(n,s,c,f,y,w){const E=an/4,A=new kt,I=new en,j=new qe,V=25;I.reserve(32),A.reserve(V),j.reserve(V);const U=(q,X)=>V*q+X;for(let q=0;q<V;q++){const X=q*E;for(let te=0;te<V;te++){const ae=te*E;A.emplaceBack(ae,X);const ge=this._globePoint(ae,X,s,c,f,y,w);j.emplaceBack(ge[0],ge[1],ge[2])}}for(let q=0;q<4;q++)for(let X=0;X<4;X++){const te=U(q,X),ae=U(q,X+1),ge=U(q+1,X),Ce=U(q+1,X+1);I.emplaceBack(te,ae,ge),I.emplaceBack(ge,ae,Ce)}this._tileDebugTextIndexBuffer=n.createIndexBuffer(I),this._tileDebugTextBuffer=n.createVertexBuffer(A,df.members),this._globeTileDebugTextBuffer=n.createVertexBuffer(j,Wa.members),this._tileDebugTextSegments=oi.simpleSegment(0,0,V,32)}}class Z5{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(n,s,c){const f=String(s);if(this.stateChanges[n]=this.stateChanges[n]||{},this.stateChanges[n][f]=this.stateChanges[n][f]||{},vt(this.stateChanges[n][f],c),this.deletedStates[n]===null){this.deletedStates[n]={};for(const y in this.state[n])y!==f&&(this.deletedStates[n][y]=null)}else if(this.deletedStates[n]&&this.deletedStates[n][f]===null){this.deletedStates[n][f]={};for(const y in this.state[n][f])c[y]||(this.deletedStates[n][f][y]=null)}else for(const y in c)this.deletedStates[n]&&this.deletedStates[n][f]&&this.deletedStates[n][f][y]===null&&delete this.deletedStates[n][f][y]}removeFeatureState(n,s,c){if(this.deletedStates[n]===null)return;const f=String(s);if(this.deletedStates[n]=this.deletedStates[n]||{},c&&s!==void 0)this.deletedStates[n][f]!==null&&(this.deletedStates[n][f]=this.deletedStates[n][f]||{},this.deletedStates[n][f][c]=null);else if(s!==void 0)if(this.stateChanges[n]&&this.stateChanges[n][f])for(c in this.deletedStates[n][f]={},this.stateChanges[n][f])this.deletedStates[n][f][c]=null;else this.deletedStates[n][f]=null;else this.deletedStates[n]=null}getState(n,s){const c=String(s),f=vt({},(this.state[n]||{})[c],(this.stateChanges[n]||{})[c]);if(this.deletedStates[n]===null)return{};if(this.deletedStates[n]){const y=this.deletedStates[n][s];if(y===null)return{};for(const w in y)delete f[w]}return f}initializeTileState(n,s){n.setFeatureState(this.state,s)}coalesceChanges(n,s){const c={};for(const f in this.stateChanges){this.state[f]=this.state[f]||{};const y={};for(const w in this.stateChanges[f])this.state[f][w]||(this.state[f][w]={}),vt(this.state[f][w],this.stateChanges[f][w]),y[w]=this.state[f][w];c[f]=y}for(const f in this.deletedStates){this.state[f]=this.state[f]||{};const y={};if(this.deletedStates[f]===null)for(const w in this.state[f])y[w]={},this.state[f][w]={};else for(const w in this.deletedStates[f]){if(this.deletedStates[f][w]===null)this.state[f][w]={};else if(this.state[f][w])for(const E of Object.keys(this.deletedStates[f][w]))delete this.state[f][w][E];y[w]=this.state[f][w]}c[f]=c[f]||{},vt(c[f],y)}if(this.stateChanges={},this.deletedStates={},Object.keys(c).length!==0)for(const f in n)n[f].setFeatureState(c,s)}}class vE{constructor(n){this.size=n,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(n,s){const c=this.toIdx(n,s);return{min:this.minimums[c],max:this.maximums[c]}}isLeaf(n,s){return this.leaves[this.toIdx(n,s)]}toIdx(n,s){return s*this.size+n}}function wE(i,n,s,c){let f=0,y=Number.MAX_VALUE;for(let w=0;w<3;w++)if(Math.abs(c[w])<1e-15){if(s[w]<i[w]||s[w]>n[w])return null}else{const E=1/c[w];let A=(i[w]-s[w])*E,I=(n[w]-s[w])*E;if(A>I){const j=A;A=I,I=j}if(A>f&&(f=A),I<y&&(y=I),f>y)return null}return f}function bE(i,n,s,c,f,y,w,E,A,I,j){const V=c-i,U=f-n,q=y-s,X=w-i,te=E-n,ae=A-s,ge=j[1]*ae-j[2]*te,Ce=j[2]*X-j[0]*ae,ye=j[0]*te-j[1]*X,Ee=V*ge+U*Ce+q*ye;if(Math.abs(Ee)<1e-15)return null;const Re=1/Ee,Me=I[0]-i,Qe=I[1]-n,Xe=I[2]-s,ft=(Me*ge+Qe*Ce+Xe*ye)*Re;if(ft<0||ft>1)return null;const It=Qe*q-Xe*U,nt=Xe*V-Me*q,yt=Me*U-Qe*V,_t=(j[0]*It+j[1]*nt+j[2]*yt)*Re;return _t<0||ft+_t>1?null:(X*It+te*nt+ae*yt)*Re}function TE(i,n,s){return(i-n)/(s-n)}function SE(i,n,s,c,f,y,w,E,A){const I=1<<s,j=y-c,V=w-f,U=(i+1)/I*j+c,q=(n+0)/I*V+f,X=(n+1)/I*V+f;E[0]=(i+0)/I*j+c,E[1]=q,A[0]=U,A[1]=X}class EE{constructor(n){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=n,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const s=(function(y){const w=Math.ceil(Math.log2(y.dim/8)),E=[];let A=Math.ceil(Math.pow(2,w));const I=1/A,j=(q,X,te,ae,ge)=>{const Ce=ae?1:0,ye=(q+1)*te-Ce,Ee=X*te,Re=(X+1)*te-Ce;ge[0]=q*te,ge[1]=Ee,ge[2]=ye,ge[3]=Re};let V=new vE(A);const U=[];for(let q=0;q<A*A;q++){j(q%A,Math.floor(q/A),I,!1,U);const X=Hd(U[0],U[1],y),te=Hd(U[2],U[1],y),ae=Hd(U[2],U[3],y),ge=Hd(U[0],U[3],y);V.minimums.push(Math.min(X,te,ae,ge)),V.maximums.push(Math.max(X,te,ae,ge)),V.leaves.push(1)}for(E.push(V),A/=2;A>=1;A/=2){const q=E[E.length-1];V=new vE(A);for(let X=0;X<A*A;X++){j(X%A,Math.floor(X/A),2,!0,U);const te=q.getElevation(U[0],U[1]),ae=q.getElevation(U[2],U[1]),ge=q.getElevation(U[2],U[3]),Ce=q.getElevation(U[0],U[3]),ye=q.isLeaf(U[0],U[1]),Ee=q.isLeaf(U[2],U[1]),Re=q.isLeaf(U[2],U[3]),Me=q.isLeaf(U[0],U[3]),Qe=Math.min(te.min,ae.min,ge.min,Ce.min),Xe=Math.max(te.max,ae.max,ge.max,Ce.max),ft=ye&&Ee&&Re&&Me;V.maximums.push(Xe),V.minimums.push(Qe),V.leaves.push(Xe-Qe<=5&&ft?1:0)}E.push(V)}return E})(this.dem),c=s.length-1,f=s[c];this._addNode(f.minimums[0],f.maximums[0],f.leaves[0]),this._construct(s,0,0,c,0)}raycastRoot(n,s,c,f,y,w,E=1){return wE([n,s,-100],[c,f,this.maximums[0]*E],y,w)}raycast(n,s,c,f,y,w,E=1){if(!this.nodeCount)return null;const A=this.raycastRoot(n,s,c,f,y,w,E);if(A==null)return null;const I=[],j=[],V=[],U=[],q=[{idx:0,t:A,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:X,t:te,nodex:ae,nodey:ge,depth:Ce}=q.pop();if(this.leaves[X]){SE(ae,ge,Ce,n,s,c,f,V,U);const Ee=1<<Ce,Re=(ae+0)/Ee,Me=(ae+1)/Ee,Qe=(ge+0)/Ee,Xe=(ge+1)/Ee,ft=Hd(Re,Qe,this.dem)*E,It=Hd(Me,Qe,this.dem)*E,nt=Hd(Me,Xe,this.dem)*E,yt=Hd(Re,Xe,this.dem)*E,_t=bE(V[0],V[1],ft,U[0],V[1],It,U[0],U[1],nt,y,w),Ct=bE(U[0],U[1],nt,V[0],U[1],yt,V[0],V[1],ft,y,w),Pt=Math.min(_t!==null?_t:Number.MAX_VALUE,Ct!==null?Ct:Number.MAX_VALUE);if(Pt!==Number.MAX_VALUE)return Pt;{const ct=Ad([],y,w,te);if(CE(ft,It,yt,nt,TE(ct[0],V[0],U[0]),TE(ct[1],V[1],U[1]))>=ct[2])return te}continue}let ye=0;for(let Ee=0;Ee<this._siblingOffset.length;Ee++){SE((ae<<1)+this._siblingOffset[Ee][0],(ge<<1)+this._siblingOffset[Ee][1],Ce+1,n,s,c,f,V,U),V[2]=-100,U[2]=this.maximums[this.childOffsets[X]+Ee]*E;const Re=wE(V,U,y,w);if(Re!=null){const Me=Re;I[Ee]=Me;let Qe=!1;for(let Xe=0;Xe<ye&&!Qe;Xe++)Me>=I[j[Xe]]&&(j.splice(Xe,0,Ee),Qe=!0);Qe||(j[ye]=Ee),ye++}}for(let Ee=0;Ee<ye;Ee++){const Re=j[Ee];q.push({idx:this.childOffsets[X]+Re,t:I[Re],nodex:(ae<<1)+this._siblingOffset[Re][0],nodey:(ge<<1)+this._siblingOffset[Re][1],depth:Ce+1})}}return null}_addNode(n,s,c){return this.minimums.push(n),this.maximums.push(s),this.leaves.push(c),this.childOffsets.push(0),this.nodeCount++}_construct(n,s,c,f,y){if(n[f].isLeaf(s,c)===1)return;this.childOffsets[y]||(this.childOffsets[y]=this.nodeCount);const w=f-1,E=n[w];let A=0,I=0;for(let j=0;j<this._siblingOffset.length;j++){const V=2*s+this._siblingOffset[j][0],U=2*c+this._siblingOffset[j][1],q=E.getElevation(V,U),X=E.isLeaf(V,U),te=this._addNode(q.min,q.max,X);X&&(A|=1<<j),I||(I=te)}for(let j=0;j<this._siblingOffset.length;j++)A&1<<j||this._construct(n,2*s+this._siblingOffset[j][0],2*c+this._siblingOffset[j][1],w,I+j)}}function CE(i,n,s,c,f,y){return Kn(Kn(i,s,y),Kn(n,c,y),f)}function Hd(i,n,s){const c=s.dim,f=xe(i*c-.5,0,c-1),y=xe(n*c-.5,0,c-1),w=Math.floor(f),E=Math.floor(y),A=Math.min(w+1,c-1),I=Math.min(E+1,c-1);return CE(s.get(w,E),s.get(A,E),s.get(w,I),s.get(A,I),f-w,y-E)}const kE={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function X5(i,n,s){return(256*i*256+256*n+s)/10-1e4}function K5(i,n,s){return 256*i+n+s/256-32768}class ex{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(n,s,c,f=!1,y=!1){if(this.uid=n,s.height!==s.width)throw new RangeError("DEM tiles must be square");if(c&&c!=="mapbox"&&c!=="terrarium")return Xn(`"${c}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=s.height;const w=this.dim=s.height-2,E=new Uint32Array(s.data.buffer);if(this.pixels=new Uint8Array(s.data.buffer),this.encoding=c||"mapbox",this.borderReady=f,!f){for(let A=0;A<w;A++)E[this._idx(-1,A)]=E[this._idx(0,A)],E[this._idx(w,A)]=E[this._idx(w-1,A)],E[this._idx(A,-1)]=E[this._idx(A,0)],E[this._idx(A,w)]=E[this._idx(A,w-1)];E[this._idx(-1,-1)]=E[this._idx(0,0)],E[this._idx(w,-1)]=E[this._idx(w-1,0)],E[this._idx(-1,w)]=E[this._idx(0,w-1)],E[this._idx(w,w)]=E[this._idx(w-1,w-1)],y&&this._buildQuadTree()}}_buildQuadTree(){this._tree=new EE(this)}get(n,s,c=!1){c&&(n=xe(n,-1,this.dim),s=xe(s,-1,this.dim));const f=4*this._idx(n,s);return(this.encoding==="terrarium"?K5:X5)(this.pixels[f],this.pixels[f+1],this.pixels[f+2])}static getUnpackVector(n){return kE[n]}get unpackVector(){return kE[this.encoding]}_idx(n,s){if(n<-1||n>=this.dim+1||s<-1||s>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(s+1)*this.stride+(n+1)}static pack(n,s){const c=[0,0,0,0],f=ex.getUnpackVector(s);let y=Math.floor((n+f[3])/f[2]);return c[2]=y%256,y=Math.floor(y/256),c[1]=y%256,y=Math.floor(y/256),c[0]=y,c}getPixels(){return new Hs({width:this.stride,height:this.stride},this.pixels)}backfillBorder(n,s,c){if(this.dim!==n.dim)throw new Error("dem dimension mismatch");let f=s*this.dim,y=s*this.dim+this.dim,w=c*this.dim,E=c*this.dim+this.dim;switch(s){case-1:f=y-1;break;case 1:y=f+1}switch(c){case-1:w=E-1;break;case 1:E=w+1}const A=-s*this.dim,I=-c*this.dim;for(let j=w;j<E;j++)for(let V=f;V<y;V++){const U=4*this._idx(V,j),q=4*this._idx(V+A,j+I);this.pixels[U+0]=n.pixels[q+0],this.pixels[U+1]=n.pixels[q+1],this.pixels[U+2]=n.pixels[q+2],this.pixels[U+3]=n.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}Ft(ex,"DEMData"),Ft(EE,"DemMinMaxQuadTree",{omit:["dem"]});class Y5{constructor(n,s){this.max=n,this.onRemove=s,this.reset()}reset(){for(const n in this.data)for(const s of this.data[n])s.timeout&&clearTimeout(s.timeout),this.onRemove(s.value);return this.data={},this.order=[],this}add(n,s,c){const f=n.wrapped().key;this.data[f]===void 0&&(this.data[f]=[]);const y={value:s,timeout:void 0};if(c!==void 0&&(y.timeout=setTimeout((()=>{this.remove(n,y)}),c)),this.data[f].push(y),this.order.push(f),this.order.length>this.max){const w=this._getAndRemoveByKey(this.order[0]);w&&this.onRemove(w)}return this}has(n){return n.wrapped().key in this.data}getAndRemove(n){return this.has(n)?this._getAndRemoveByKey(n.wrapped().key):null}_getAndRemoveByKey(n){const s=this.data[n].shift();return s.timeout&&clearTimeout(s.timeout),this.data[n].length===0&&delete this.data[n],this.order.splice(this.order.indexOf(n),1),s.value}getByKey(n){const s=this.data[n];return s?s[0].value:null}get(n){return this.has(n)?this.data[n.wrapped().key][0].value:null}remove(n,s){if(!this.has(n))return this;const c=n.wrapped().key,f=s===void 0?0:this.data[c].indexOf(s),y=this.data[c][f];return this.data[c].splice(f,1),y.timeout&&clearTimeout(y.timeout),this.data[c].length===0&&delete this.data[c],this.onRemove(y.value),this.order.splice(this.order.indexOf(c),1),this}setMaxSize(n){for(this.max=n;this.order.length>this.max;){const s=this._getAndRemoveByKey(this.order[0]);s&&this.onRemove(s)}return this}filter(n){const s=[];for(const c in this.data)for(const f of this.data[c])n(f.value)||s.push(f);for(const c of s)this.remove(c.value.tileID,c)}}class lm{constructor(n,s,c){this.func=n,this.mask=s,this.range=c}}lm.ReadOnly=!1,lm.ReadWrite=!0,lm.disabled=new lm(519,lm.ReadOnly,[0,1]);const G0=7680;class H0{constructor(n,s,c,f,y,w){this.test=n,this.ref=s,this.mask=c,this.fail=f,this.depthFail=y,this.pass=w}}H0.disabled=new H0({func:519,mask:0},0,0,G0,G0,G0);class Oc{constructor(n,s,c){this.blendFunction=n,this.blendColor=s,this.mask=c}}Oc.Replace=[1,0],Oc.disabled=new Oc(Oc.Replace,_r.transparent,[!1,!1,!1,!1]),Oc.unblended=new Oc(Oc.Replace,_r.transparent,[!0,!0,!0,!0]),Oc.alphaBlended=new Oc([1,771],_r.transparent,[!0,!0,!0,!0]);const W0=1029,q0=2305;class Dl{constructor(n,s,c){this.enable=n,this.mode=s,this.frontFace=c}}Dl.disabled=new Dl(!1,W0,q0),Dl.backCCW=new Dl(!0,W0,q0),Dl.backCW=new Dl(!0,W0,2304),Dl.frontCW=new Dl(!0,1028,2304),Dl.frontCCW=new Dl(!0,1028,q0);class If extends xs{constructor(n,s,c){super(),this.id=n,this._onlySymbols=c,s.on("data",(f=>{f.dataType==="source"&&f.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&f.dataType==="source"&&f.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))})),s.on("error",(()=>{this._sourceErrored=!0})),this._source=s,this._tiles={},this._cache=new Y5(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=s.minTileCacheSize,this._maxTileCacheSize=s.maxTileCacheSize,this._loadedParentTiles={},this._coveredTiles={},this._state=new Z5,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(n){this.map=n,this._minTileCacheSize=this._minTileCacheSize===void 0&&n?n._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&n?n._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const n in this._tiles){const s=this._tiles[n];if(s.state!=="loaded"&&s.state!=="errored")return!1}return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const n=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,n&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(n,s){return n.isSymbolTile=this._onlySymbols,this._source.loadTile(n,s)}_unloadTile(n){if(this._source.unloadTile)return this._source.unloadTile(n,(()=>{}))}_abortTile(n){if(this._source.abortTile)return this._source.abortTile(n,(()=>{}))}serialize(){return this._source.serialize()}prepare(n){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const s in this._tiles){const c=this._tiles[s];c.upload(n),c.prepare(this.map.style.imageManager)}}getIds(){return it(this._tiles).map((n=>n.tileID)).sort(AE).map((n=>n.key))}getRenderableIds(n){const s=[];for(const c in this._tiles)this._isIdRenderable(+c,n)&&s.push(this._tiles[c]);return n?s.sort(((c,f)=>{const y=c.tileID,w=f.tileID,E=new Pe(y.canonical.x,y.canonical.y)._rotate(this.transform.angle),A=new Pe(w.canonical.x,w.canonical.y)._rotate(this.transform.angle);return y.overscaledZ-w.overscaledZ||A.y-E.y||A.x-E.x})).map((c=>c.tileID.key)):s.map((c=>c.tileID)).sort(AE).map((c=>c.key))}hasRenderableParent(n){const s=this.findLoadedParent(n,0);return!!s&&this._isIdRenderable(s.tileID.key)}_isIdRenderable(n,s){return this._tiles[n]&&this._tiles[n].hasData()&&!this._coveredTiles[n]&&(s||!this._tiles[n].holdingForFade())}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const n in this._tiles)this._tiles[n].state!=="errored"&&this._reloadTile(+n,"reloading")}}_reloadTile(n,s){const c=this._tiles[n];c&&(c.state!=="loading"&&(c.state=s),this._loadTile(c,this._tileLoaded.bind(this,c,n,s)))}_tileLoaded(n,s,c,f){if(f)if(n.state="errored",f.status!==404)this._source.fire(new Qs(f,{tile:n}));else if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const y=this.map.painter.terrain;this.update(this.transform,y.getScaledDemTileSize(),!0),y.resetTileLookupCache(this.id)}else this.update(this.transform);else n.timeAdded=Bo.now(),c==="expired"&&(n.refreshedUponExpiration=!0),this._setTileReloadTimer(s,n),this._source.type==="raster-dem"&&n.dem&&this._backfillDEM(n),this._state.initializeTileState(n,this.map?this.map.painter:null),this._source.fire(new ka("data",{dataType:"source",tile:n,coord:n.tileID,sourceCacheId:this.id}))}_backfillDEM(n){const s=this.getRenderableIds();for(let f=0;f<s.length;f++){const y=s[f];if(n.neighboringTiles&&n.neighboringTiles[y]){const w=this.getTileByID(y);c(n,w),c(w,n)}}function c(f,y){if(!f.dem||f.dem.borderReady)return;f.needsHillshadePrepare=!0,f.needsDEMTextureUpload=!0;let w=y.tileID.canonical.x-f.tileID.canonical.x;const E=y.tileID.canonical.y-f.tileID.canonical.y,A=Math.pow(2,f.tileID.canonical.z),I=y.tileID.key;w===0&&E===0||Math.abs(E)>1||(Math.abs(w)>1&&(Math.abs(w+A)===1?w+=A:Math.abs(w-A)===1&&(w-=A)),y.dem&&f.dem&&(f.dem.backfillBorder(y.dem,w,E),f.neighboringTiles&&f.neighboringTiles[I]&&(f.neighboringTiles[I].backfilled=!0)))}}getTile(n){return this.getTileByID(n.key)}getTileByID(n){return this._tiles[n]}_retainLoadedChildren(n,s,c,f){for(const y in this._tiles){let w=this._tiles[y];if(f[y]||!w.hasData()||w.tileID.overscaledZ<=s||w.tileID.overscaledZ>c)continue;let E=w.tileID;for(;w&&w.tileID.overscaledZ>s+1;){const I=w.tileID.scaledTo(w.tileID.overscaledZ-1);w=this._tiles[I.key],w&&w.hasData()&&(E=I)}let A=E;for(;A.overscaledZ>s;)if(A=A.scaledTo(A.overscaledZ-1),n[A.key]){f[E.key]=E;break}}}findLoadedParent(n,s){if(n.key in this._loadedParentTiles){const c=this._loadedParentTiles[n.key];return c&&c.tileID.overscaledZ>=s?c:null}for(let c=n.overscaledZ-1;c>=s;c--){const f=n.scaledTo(c),y=this._getLoadedTile(f);if(y)return y}}_getLoadedTile(n){const s=this._tiles[n.key];return s&&s.hasData()?s:this._cache.getByKey(this._source.reparseOverscaled?n.wrapped().key:n.canonical.key)}updateCacheSize(n,s){s=s||this._source.tileSize;const c=Math.ceil(n.width/s)+1,f=Math.ceil(n.height/s)+1,y=Math.floor(c*f*5),w=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,y):y,E=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,w):w;this._cache.setMaxSize(E)}handleWrapJump(n){const s=Math.round((n-(this._prevLng===void 0?n:this._prevLng))/360);if(this._prevLng=n,s){const c={};for(const f in this._tiles){const y=this._tiles[f];y.tileID=y.tileID.unwrapTo(y.tileID.wrap+s),c[y.tileID.key]=y}this._tiles=c;for(const f in this._timers)clearTimeout(this._timers[f]),delete this._timers[f];for(const f in this._tiles)this._setTileReloadTimer(+f,this._tiles[f])}}update(n,s,c){if(this.transform=n,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!c)return;let f;this.updateCacheSize(n,s),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._coveredTiles={},this.used||this.usedForTerrain?this._source.tileID?f=n.getVisibleUnwrappedCoordinates(this._source.tileID).map((E=>new po(E.canonical.z,E.wrap,E.canonical.z,E.canonical.x,E.canonical.y))):(f=n.coveringTiles({tileSize:s||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!c,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain}),this._source.hasTile&&(f=f.filter((E=>this._source.hasTile(E))))):f=[];const y=this._updateRetainedTiles(f);if(IE(this._source.type)&&f.length!==0){const E={},A={},I=Object.keys(y);for(const V of I){const U=y[V],q=this._tiles[V];if(!q||q.fadeEndTime&&q.fadeEndTime<=Bo.now())continue;const X=this.findLoadedParent(U,Math.max(U.overscaledZ-If.maxOverzooming,this._source.minzoom));X&&(this._addTile(X.tileID),E[X.tileID.key]=X.tileID),A[V]=U}const j=f[f.length-1].overscaledZ;for(const V in this._tiles){const U=this._tiles[V];if(y[V]||!U.hasData())continue;let q=U.tileID;for(;q.overscaledZ>j;){q=q.scaledTo(q.overscaledZ-1);const X=this._tiles[q.key];if(X&&X.hasData()&&A[q.key]){y[V]=U.tileID;break}}}for(const V in E)y[V]||(this._coveredTiles[V]=!0,y[V]=E[V])}for(const E in y)this._tiles[E].clearFadeHold();const w=(function(E,A){const I=[];for(const j in E)j in A||I.push(j);return I})(this._tiles,y);for(const E of w){const A=this._tiles[E];A.hasSymbolBuckets&&!A.holdingForFade()?A.setHoldDuration(this.map._fadeDuration):A.hasSymbolBuckets&&!A.symbolFadeFinished()||this._removeTile(+E)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const n in this._tiles)this._tiles[n].holdingForFade()&&this._removeTile(+n)}_updateRetainedTiles(n){const s={};if(n.length===0)return s;const c={},f=n.reduce(((I,j)=>Math.min(I,j.overscaledZ)),1/0),y=n[0].overscaledZ,w=Math.max(y-If.maxOverzooming,this._source.minzoom),E=Math.max(y+If.maxUnderzooming,this._source.minzoom),A={};for(const I of n){const j=this._addTile(I);s[I.key]=I,j.hasData()||f<this._source.maxzoom&&(A[I.key]=I)}this._retainLoadedChildren(A,f,E,s);for(const I of n){let j=this._tiles[I.key];if(j.hasData())continue;if(I.canonical.z>=this._source.maxzoom){const U=I.children(this._source.maxzoom)[0],q=this.getTile(U);if(q&&q.hasData()){s[U.key]=U;continue}}else{const U=I.children(this._source.maxzoom);if(s[U[0].key]&&s[U[1].key]&&s[U[2].key]&&s[U[3].key])continue}let V=j.wasRequested();for(let U=I.overscaledZ-1;U>=w;--U){const q=I.scaledTo(U);if(c[q.key]||(c[q.key]=!0,j=this.getTile(q),!j&&V&&(j=this._addTile(q)),j&&(s[q.key]=q,V=j.wasRequested(),j.hasData())))break}}return s}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const n in this._tiles){const s=[];let c,f=this._tiles[n].tileID;for(;f.overscaledZ>0;){if(f.key in this._loadedParentTiles){c=this._loadedParentTiles[f.key];break}s.push(f.key);const y=f.scaledTo(f.overscaledZ-1);if(c=this._getLoadedTile(y),c)break;f=y}for(const y of s)this._loadedParentTiles[y]=c}}_addTile(n){let s=this._tiles[n.key];if(s)return s;s=this._cache.getAndRemove(n),s&&(this._setTileReloadTimer(n.key,s),s.tileID=n,this._state.initializeTileState(s,this.map?this.map.painter:null),this._cacheTimers[n.key]&&(clearTimeout(this._cacheTimers[n.key]),delete this._cacheTimers[n.key],this._setTileReloadTimer(n.key,s)));const c=!!s;if(!c){const f=this.map?this.map.painter:null;s=new $0(n,this._source.tileSize*n.overscaleFactor(),this.transform.tileZoom,f,this._isRaster),this._loadTile(s,this._tileLoaded.bind(this,s,n.key,s.state))}return s?(s.uses++,this._tiles[n.key]=s,c||this._source.fire(new ka("dataloading",{tile:s,coord:s.tileID,dataType:"source"})),s):null}_setTileReloadTimer(n,s){n in this._timers&&(clearTimeout(this._timers[n]),delete this._timers[n]);const c=s.getExpiryTimeout();c&&(this._timers[n]=setTimeout((()=>{this._reloadTile(n,"expired"),delete this._timers[n]}),c))}_removeTile(n){const s=this._tiles[n];s&&(s.uses--,delete this._tiles[n],this._timers[n]&&(clearTimeout(this._timers[n]),delete this._timers[n]),s.uses>0||(s.hasData()&&s.state!=="reloading"?this._cache.add(s.tileID,s,s.getExpiryTimeout()):(s.aborted=!0,this._abortTile(s),this._unloadTile(s))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const n in this._tiles)this._removeTile(+n);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(n,s,c){const f=[],y=this.transform;if(!y)return f;const w=y.projection.name==="globe",E=kr(y.center.lng);for(const A in this._tiles){const I=this._tiles[A];if(c&&I.clearQueryDebugViz(),I.holdingForFade())continue;let j;if(w){const V=I.tileID.canonical;if(V.z===0){const U=[Math.abs(xe(E,...qg(V,-1))-E),Math.abs(xe(E,...qg(V,1))-E)];j=[0,2*U.indexOf(Math.min(...U))-1]}else{const U=[Math.abs(xe(E,...qg(V,-1))-E),Math.abs(xe(E,...qg(V,0))-E),Math.abs(xe(E,...qg(V,1))-E)];j=[U.indexOf(Math.min(...U))-1]}}else j=[0];for(const V of j){const U=n.containsTile(I,y,s,V);U&&f.push(U)}}return f}getVisibleCoordinates(n){const s=this.getRenderableIds(n).map((c=>this._tiles[c].tileID));for(const c of s)c.projMatrix=this.transform.calculateProjMatrix(c.toUnwrapped());return s}hasTransition(){if(this._source.hasTransition())return!0;if(IE(this._source.type))for(const n in this._tiles){const s=this._tiles[n];if(s.fadeEndTime!==void 0&&s.fadeEndTime>=Bo.now())return!0}return!1}setFeatureState(n,s,c){this._state.updateState(n=n||"_geojsonTileLayer",s,c)}removeFeatureState(n,s,c){this._state.removeFeatureState(n=n||"_geojsonTileLayer",s,c)}getFeatureState(n,s){return this._state.getState(n=n||"_geojsonTileLayer",s)}setDependencies(n,s,c){const f=this._tiles[n];f&&f.setDependencies(s,c)}reloadTilesForDependencies(n,s){for(const c in this._tiles)this._tiles[c].hasDependency(n,s)&&this._reloadTile(+c,"reloading");this._cache.filter((c=>!c.hasDependency(n,s)))}_preloadTiles(n,s){if(!this._sourceLoaded){const E=()=>{this._sourceLoaded&&(this._source.off("data",E),this._preloadTiles(n,s))};return void this._source.on("data",E)}const c=new Map,f=Array.isArray(n)?n:[n],y=this.map.painter.terrain,w=this.usedForTerrain&&y?y.getScaledDemTileSize():this._source.tileSize;for(const E of f){const A=E.coveringTiles({tileSize:w,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const I of A)c.set(I.key,I);this.usedForTerrain&&E.updateElevation(!1)}Fe(Array.from(c.values()),((E,A)=>{const I=new $0(E,this._source.tileSize*E.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster);this._loadTile(I,(j=>{this._source.type==="raster-dem"&&I.dem&&this._backfillDEM(I),A(j,I)}))}),s)}}function AE(i,n){const s=Math.abs(2*i.wrap)-+(i.wrap<0),c=Math.abs(2*n.wrap)-+(n.wrap<0);return i.overscaledZ-n.overscaledZ||c-s||n.canonical.y-i.canonical.y||n.canonical.x-i.canonical.x}function IE(i){return i==="raster"||i==="image"||i==="video"||i==="custom"}function qg(i,n){const s=1<<i.z;return[i.x/s+n,(i.x+1)/s+n]}If.maxOverzooming=10,If.maxUnderzooming=3;class tx{constructor(n,s,c){this._demTile=n,this._dem=this._demTile.dem,this._scale=s,this._offset=c}static create(n,s,c){const f=c||n.findDEMTileFor(s);if(!f||!f.dem)return;const y=f.dem,w=f.tileID,E=1<<s.canonical.z-w.canonical.z;return new tx(f,f.tileSize/an/E,[(s.canonical.x/E-w.canonical.x)*y.dim,(s.canonical.y/E-w.canonical.y)*y.dim])}tileCoordToPixel(n,s){const c=s*this._scale+this._offset[1],f=Math.floor(n*this._scale+this._offset[0]),y=Math.floor(c);return new Pe(f,y)}getElevationAt(n,s,c,f){const y=n*this._scale+this._offset[0],w=s*this._scale+this._offset[1],E=Math.floor(y),A=Math.floor(w),I=this._dem;return f=!!f,c?Kn(Kn(I.get(E,A,f),I.get(E,A+1,f),w-A),Kn(I.get(E+1,A,f),I.get(E+1,A+1,f),w-A),y-E):I.get(E,A,f)}getElevationAtPixel(n,s,c){return this._dem.get(n,s,!!c)}getMeterToDEM(n){return(1<<this._demTile.tileID.canonical.z)*ai(1,n)*this._dem.stride}}class ME{constructor(n,s){this.tileID=n,this.x=n.canonical.x,this.y=n.canonical.y,this.z=n.canonical.z,this.grid=new qo(an,16,0),this.featureIndexArray=new Kr,this.promoteId=s}insert(n,s,c,f,y,w=0){const E=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(c,f,y,w);const A=this.grid;for(let I=0;I<s.length;I++){const j=s[I],V=[1/0,1/0,-1/0,-1/0];for(let U=0;U<j.length;U++){const q=j[U];V[0]=Math.min(V[0],q.x),V[1]=Math.min(V[1],q.y),V[2]=Math.max(V[2],q.x),V[3]=Math.max(V[3],q.y)}V[0]<an&&V[1]<an&&V[2]>=0&&V[3]>=0&&A.insert(E,V[0],V[1],V[2],V[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new mn(new V_(this.rawTileData)).layers,this.sourceLayerCoder=new mE(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const n in this.vtLayers)this.vtFeatures[n]=[]}return this.vtLayers}query(n,s,c,f){this.loadVTLayers();const y=n.params||{},w=gc(y.filter),E=n.tileResult,A=n.transform,I=E.bufferedTilespaceBounds,j=this.grid.query(I.min.x,I.min.y,I.max.x,I.max.y,((X,te,ae,ge)=>P_(E.bufferedTilespaceGeometry,X,te,ae,ge)));j.sort(J5);let V=null;A.elevation&&j.length>0&&(V=tx.create(A.elevation,this.tileID));const U={};let q;for(let X=0;X<j.length;X++){const te=j[X];if(te===q)continue;q=te;const ae=this.featureIndexArray.get(te);let ge=null;this.loadMatchingFeature(U,ae,w,y.layers,y.availableImages,s,c,f,((Ce,ye,Ee,Re=0)=>(ge||(ge=As(Ce,this.tileID.canonical,n.tileTransform)),ye.queryIntersectsFeature(E,Ce,Ee,ge,this.z,n.transform,n.pixelPosMatrix,V,Re))))}return U}loadMatchingFeature(n,s,c,f,y,w,E,A,I){const{featureIndex:j,bucketIndex:V,sourceLayerIndex:U,layoutVertexArrayOffset:q}=s,X=this.bucketLayerIDs[V];if(f&&!(function(Ce,ye){for(let Ee=0;Ee<Ce.length;Ee++)if(ye.indexOf(Ce[Ee])>=0)return!0;return!1})(f,X))return;const te=this.sourceLayerCoder.decode(U),ae=this.vtLayers[te].feature(j);if(c.needGeometry){const Ce=Xa(ae,!0);if(!c.filter(new B(this.tileID.overscaledZ),Ce,this.tileID.canonical))return}else if(!c.filter(new B(this.tileID.overscaledZ),ae))return;const ge=this.getId(ae,te);for(let Ce=0;Ce<X.length;Ce++){const ye=X[Ce];if(f&&f.indexOf(ye)<0)continue;const Ee=w[ye];if(!Ee)continue;let Re={};ge!==void 0&&A&&(Re=A.getState(Ee.sourceLayer||"_geojsonTileLayer",ge));const Me=vt({},E[ye]);Me.paint=PE(Me.paint,Ee.paint,ae,Re,y),Me.layout=PE(Me.layout,Ee.layout,ae,Re,y);const Qe=!I||I(ae,Ee,Re,q);if(!Qe)continue;const Xe=new gE(ae,this.z,this.x,this.y,ge);Xe.layer=Me;let ft=n[ye];ft===void 0&&(ft=n[ye]=[]),ft.push({featureIndex:j,feature:Xe,intersectionZ:Qe})}}lookupSymbolFeatures(n,s,c,f,y,w,E,A){const I={};this.loadVTLayers();const j=gc(y);for(const V of n)this.loadMatchingFeature(I,{bucketIndex:c,sourceLayerIndex:f,featureIndex:V,layoutVertexArrayOffset:0},j,w,E,A,s);return I}loadFeature(n){const{featureIndex:s,sourceLayerIndex:c}=n;this.loadVTLayers();const f=this.sourceLayerCoder.decode(c),y=this.vtFeatures[f];if(y[s])return y[s];const w=this.vtLayers[f].feature(s);return y[s]=w,w}hasLayer(n){for(const s of this.bucketLayerIDs)for(const c of s)if(n===c)return!0;return!1}getId(n,s){let c=n.id;if(this.promoteId){const f=typeof this.promoteId=="string"?this.promoteId:this.promoteId[s];f!=null&&(c=n.properties[f]),typeof c=="boolean"&&(c=Number(c))}return c}}function PE(i,n,s,c,f){return tn(i,((y,w)=>{const E=n instanceof me?n.get(w):null;return E&&E.evaluate?E.evaluate(s,c,f):E}))}function J5(i,n){return n-i}Ft(ME,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});class RE{constructor(n,s){this.width=n,this.height=s,this.nextRow=0,this.image=new fo({width:n,height:s}),this.positions={},this.uploaded=!1}getDash(n,s){const c=this.getKey(n,s);return this.positions[c]}trim(){const n=this.width,s=this.height=Kt(this.nextRow);this.image.resize({width:n,height:s})}getKey(n,s){return n.join(",")+s}getDashRanges(n,s,c){const f=[];let y=n.length%2==1?-n[n.length-1]*c:0,w=n[0]*c,E=!0;f.push({left:y,right:w,isDash:E,zeroLength:n[0]===0});let A=n[0];for(let I=1;I<n.length;I++){E=!E;const j=n[I];y=A*c,A+=j,w=A*c,f.push({left:y,right:w,isDash:E,zeroLength:j===0})}return f}addRoundDash(n,s,c){const f=s/2;for(let y=-c;y<=c;y++){const w=this.width*(this.nextRow+c+y);let E=0,A=n[E];for(let I=0;I<this.width;I++){I/A.right>1&&(A=n[++E]);const j=Math.abs(I-A.left),V=Math.abs(I-A.right),U=Math.min(j,V);let q;const X=y/c*(f+1);if(A.isDash){const te=f-Math.abs(X);q=Math.sqrt(U*U+te*te)}else q=f-Math.sqrt(U*U+X*X);this.image.data[w+I]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(n,s){for(let A=n.length-1;A>=0;--A){const I=n[A],j=n[A+1];I.zeroLength?n.splice(A,1):j&&j.isDash===I.isDash&&(j.left=I.left,n.splice(A,1))}const c=n[0],f=n[n.length-1];c.isDash===f.isDash&&(c.left=f.left-this.width,f.right=c.right+this.width);const y=this.width*this.nextRow;let w=0,E=n[w];for(let A=0;A<this.width;A++){A/E.right>1&&(E=n[++w]);const I=Math.abs(A-E.left),j=Math.abs(A-E.right),V=Math.min(I,j);this.image.data[y+A]=Math.max(0,Math.min(255,(E.isDash?V:-V)+s+128))}}addDash(n,s){const c=this.getKey(n,s);if(this.positions[c])return this.positions[c];const f=s==="round",y=f?7:0,w=2*y+1;if(this.nextRow+w>this.height)return Xn("LineAtlas out of space"),null;n.length===0&&n.push(1);let E=0;for(let j=0;j<n.length;j++)n[j]<0&&(Xn("Negative value is found in line dasharray, replacing values with 0"),n[j]=0),E+=n[j];if(E!==0){const j=this.width/E,V=this.getDashRanges(n,this.width,j);f?this.addRoundDash(V,j,y):this.addRegularDash(V,s==="square"?.5*j:0)}const A=this.nextRow+y;this.nextRow+=w;const I={tl:[A,y],br:[E,0]};return this.positions[c]=I,I}}Ft(RE,"LineAtlas");const NE=1*Nl;class DE{constructor(n){const s={},c=[];for(const E in n){const A=n[E],I=s[E]={};for(const j in A.glyphs){const V=A.glyphs[+j];if(!V||V.bitmap.width===0||V.bitmap.height===0)continue;const U=V.metrics.localGlyph?NE:1,q={x:0,y:0,w:V.bitmap.width+2*U,h:V.bitmap.height+2*U};c.push(q),I[j]=q}}const{w:f,h:y}=P0(c),w=new fo({width:f||1,height:y||1});for(const E in n){const A=n[E];for(const I in A.glyphs){const j=A.glyphs[+I];if(!j||j.bitmap.width===0||j.bitmap.height===0)continue;const V=s[E][I],U=j.metrics.localGlyph?NE:1;fo.copy(j.bitmap,w,{x:0,y:0},{x:V.x+U,y:V.y+U},j.bitmap)}}this.image=w,this.positions=s}}Ft(DE,"GlyphAtlas");class Q5{constructor(n){this.tileID=new po(n.tileID.overscaledZ,n.tileID.wrap,n.tileID.canonical.z,n.tileID.canonical.x,n.tileID.canonical.y),this.tileZoom=n.tileZoom,this.uid=n.uid,this.zoom=n.zoom,this.canonical=n.tileID.canonical,this.pixelRatio=n.pixelRatio,this.tileSize=n.tileSize,this.source=n.source,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=n.showCollisionBoxes,this.collectResourceTiming=!!n.collectResourceTiming,this.returnDependencies=!!n.returnDependencies,this.promoteId=n.promoteId,this.enableTerrain=!!n.enableTerrain,this.isSymbolTile=n.isSymbolTile,this.tileTransform=Af(n.tileID.canonical,n.projection),this.projection=n.projection}parse(n,s,c,f,y){this.status="parsing",this.data=n,this.collisionBoxArray=new fr;const w=new mE(Object.keys(n.layers).sort()),E=new ME(this.tileID,this.promoteId);E.bucketLayerIDs=[];const A={},I=new RE(256,256),j={featureIndex:E,iconDependencies:{},patternDependencies:{},glyphDependencies:{},lineAtlas:I,availableImages:c},V=s.familiesBySource[this.source];for(const Re in V){const Me=n.layers[Re];if(!Me)continue;let Qe=!1,Xe=!1;for(const nt of V[Re])nt[0].type==="symbol"?Qe=!0:Xe=!0;if(this.isSymbolTile===!0&&!Qe||this.isSymbolTile===!1&&!Xe)continue;Me.version===1&&Xn(`Vector tile source "${this.source}" layer "${Re}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const ft=w.encode(Re),It=[];for(let nt=0;nt<Me.length;nt++){const yt=Me.feature(nt),_t=E.getId(yt,Re);It.push({feature:yt,id:_t,index:nt,sourceLayerIndex:ft})}for(const nt of V[Re]){const yt=nt[0];this.isSymbolTile!==void 0&&yt.type==="symbol"!==this.isSymbolTile||yt.minzoom&&this.zoom<Math.floor(yt.minzoom)||yt.maxzoom&&this.zoom>=yt.maxzoom||yt.visibility!=="none"&&(Z0(nt,this.zoom,c),(A[yt.id]=yt.createBucket({index:E.bucketLayerIDs.length,layers:nt,zoom:this.zoom,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:ft,sourceID:this.source,enableTerrain:this.enableTerrain,projection:this.projection.spec,availableImages:c})).populate(It,j,this.tileID.canonical,this.tileTransform),E.bucketLayerIDs.push(nt.map((_t=>_t.id))))}}let U,q,X,te;I.trim();const ae={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},ge=()=>{if(U)return y(U);if(q&&X&&te){const Re=new DE(q),Me=new VS(X,te);for(const Qe in A){const Xe=A[Qe];Xe instanceof Ud?(Z0(Xe.layers,this.zoom,c),E5(Xe,q,Re.positions,X,Me.iconPositions,this.showCollisionBoxes,c,this.tileID.canonical,this.tileZoom,this.projection)):Xe.hasPattern&&(Xe instanceof z_||Xe instanceof S||Xe instanceof Lg)&&(Z0(Xe.layers,this.zoom,c),Xe.addFeatures(j,this.tileID.canonical,Me.patternPositions,c,this.tileTransform))}this.status="done",y(null,{buckets:it(A).filter((Qe=>!Qe.isEmpty())),featureIndex:E,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:Re.image,lineAtlas:I,imageAtlas:Me,glyphMap:this.returnDependencies?q:null,iconMap:this.returnDependencies?X:null,glyphPositions:this.returnDependencies?Re.positions:null})}},Ce=tn(j.glyphDependencies,(Re=>Object.keys(Re).map(Number)));Object.keys(Ce).length?f.send("getGlyphs",{uid:this.uid,stacks:Ce},((Re,Me)=>{U||(U=Re,q=Me,ge())}),void 0,!1,ae):q={};const ye=Object.keys(j.iconDependencies);ye.length?f.send("getImages",{icons:ye,source:this.source,tileID:this.tileID,type:"icons"},((Re,Me)=>{U||(U=Re,X=Me,ge())}),void 0,!1,ae):X={};const Ee=Object.keys(j.patternDependencies);Ee.length?f.send("getImages",{icons:Ee,source:this.source,tileID:this.tileID,type:"patterns"},((Re,Me)=>{U||(U=Re,te=Me,ge())}),void 0,!1,ae):te={},ge()}}function Z0(i,n,s){const c=new B(n);for(const f of i)f.recalculate(c,s)}class LE{constructor(n){this.entries={},this.scheduler=n}request(n,s,c,f){const y=this.entries[n]=this.entries[n]||{callbacks:[]};if(y.result){const[w,E]=y.result;return this.scheduler?this.scheduler.add((()=>{f(w,E)}),s):f(w,E),()=>{}}return y.callbacks.push(f),y.cancel||(y.cancel=c(((w,E)=>{y.result=[w,E];for(const A of y.callbacks)this.scheduler?this.scheduler.add((()=>{A(w,E)}),s):A(w,E);setTimeout((()=>delete this.entries[n]),3e3)}))),()=>{y.result||(y.callbacks=y.callbacks.filter((w=>w!==f)),y.callbacks.length||(y.cancel(),delete this.entries[n]))}}}function jE(i,n,s){const c=JSON.stringify(i.request);return i.data&&(this.deduped.entries[c]={result:[null,i.data]}),this.deduped.request(c,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom},(f=>{const y=Ys(i.request,((w,E,A,I)=>{w?f(w):E&&f(null,{vectorTile:s?void 0:new mn(new V_(E)),rawData:E,cacheControl:A,expires:I})}));return()=>{y.cancel(),f()}}),n)}const OE=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class X0{static from(n){if(!(n instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[s,c]=new Uint8Array(n,0,2);if(s!==219)throw new Error("Data does not appear to be in a KDBush format.");const f=c>>4;if(f!==1)throw new Error(`Got v${f} data when expected v1.`);const y=OE[15&c];if(!y)throw new Error("Unrecognized array type.");const[w]=new Uint16Array(n,2,1),[E]=new Uint32Array(n,4,1);return new X0(E,w,y,n)}constructor(n,s=64,c=Float64Array,f){if(isNaN(n)||n<0)throw new Error(`Unpexpected numItems value: ${n}.`);this.numItems=+n,this.nodeSize=Math.min(Math.max(+s,2),65535),this.ArrayType=c,this.IndexArrayType=n<65536?Uint16Array:Uint32Array;const y=OE.indexOf(this.ArrayType),w=2*n*this.ArrayType.BYTES_PER_ELEMENT,E=n*this.IndexArrayType.BYTES_PER_ELEMENT,A=(8-E%8)%8;if(y<0)throw new Error(`Unexpected typed array class: ${c}.`);f&&f instanceof ArrayBuffer?(this.data=f,this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+A,2*n),this._pos=2*n,this._finished=!0):(this.data=new ArrayBuffer(8+w+E+A),this.ids=new this.IndexArrayType(this.data,8,n),this.coords=new this.ArrayType(this.data,8+E+A,2*n),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+y]),new Uint16Array(this.data,2,1)[0]=s,new Uint32Array(this.data,4,1)[0]=n)}add(n,s){const c=this._pos>>1;return this.ids[c]=c,this.coords[this._pos++]=n,this.coords[this._pos++]=s,c}finish(){const n=this._pos>>1;if(n!==this.numItems)throw new Error(`Added ${n} items when expected ${this.numItems}.`);return K0(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(n,s,c,f){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:y,coords:w,nodeSize:E}=this,A=[0,y.length-1,0],I=[];for(;A.length;){const j=A.pop()||0,V=A.pop()||0,U=A.pop()||0;if(V-U<=E){for(let ae=U;ae<=V;ae++){const ge=w[2*ae],Ce=w[2*ae+1];ge>=n&&ge<=c&&Ce>=s&&Ce<=f&&I.push(y[ae])}continue}const q=U+V>>1,X=w[2*q],te=w[2*q+1];X>=n&&X<=c&&te>=s&&te<=f&&I.push(y[q]),(j===0?n<=X:s<=te)&&(A.push(U),A.push(q-1),A.push(1-j)),(j===0?c>=X:f>=te)&&(A.push(q+1),A.push(V),A.push(1-j))}return I}within(n,s,c){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:f,coords:y,nodeSize:w}=this,E=[0,f.length-1,0],A=[],I=c*c;for(;E.length;){const j=E.pop()||0,V=E.pop()||0,U=E.pop()||0;if(V-U<=w){for(let ae=U;ae<=V;ae++)BE(y[2*ae],y[2*ae+1],n,s)<=I&&A.push(f[ae]);continue}const q=U+V>>1,X=y[2*q],te=y[2*q+1];BE(X,te,n,s)<=I&&A.push(f[q]),(j===0?n-c<=X:s-c<=te)&&(E.push(U),E.push(q-1),E.push(1-j)),(j===0?n+c>=X:s+c>=te)&&(E.push(q+1),E.push(V),E.push(1-j))}return A}}function K0(i,n,s,c,f,y){if(f-c<=s)return;const w=c+f>>1;zE(i,n,w,c,f,y),K0(i,n,s,c,w-1,1-y),K0(i,n,s,w+1,f,1-y)}function zE(i,n,s,c,f,y){for(;f>c;){if(f-c>600){const I=f-c+1,j=s-c+1,V=Math.log(I),U=.5*Math.exp(2*V/3),q=.5*Math.sqrt(V*U*(I-U)/I)*(j-I/2<0?-1:1);zE(i,n,s,Math.max(c,Math.floor(s-j*U/I+q)),Math.min(f,Math.floor(s+(I-j)*U/I+q)),y)}const w=n[2*s+y];let E=c,A=f;for(Zg(i,n,c,s),n[2*f+y]>w&&Zg(i,n,c,f);E<A;){for(Zg(i,n,E,A),E++,A--;n[2*E+y]<w;)E++;for(;n[2*A+y]>w;)A--}n[2*c+y]===w?Zg(i,n,c,A):(A++,Zg(i,n,A,f)),A<=s&&(c=A+1),s<=A&&(f=A-1)}}function Zg(i,n,s,c){Y0(i,s,c),Y0(n,2*s,2*c),Y0(n,2*s+1,2*c+1)}function Y0(i,n,s){const c=i[n];i[n]=i[s],i[s]=c}function BE(i,n,s,c){const f=i-s,y=n-c;return f*f+y*y}a.ARRAY_TYPE=ls,a.AUTH_ERR_MSG=Se,a.Aabb=us,a.Actor=class{constructor(i,n,s){this.target=i,this.parent=n,this.mapId=s,this.callbacks={},this.cancelCallbacks={},fn(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.globalScope=xi()?i:k,this.scheduler=new W5}send(i,n,s,c,f=!1,y){const w=Math.round(1e18*Math.random()).toString(36).substring(0,10);s&&(s.metadata=y,this.callbacks[w]=s);const E=rs(this.globalScope)?void 0:[];return this.target.postMessage({id:w,type:i,hasCallback:!!s,targetMapId:c,mustQueue:f,sourceMapId:this.mapId,data:Tl(n,E)},E),{cancel:()=>{s&&delete this.callbacks[w],this.target.postMessage({id:w,type:"<cancel>",targetMapId:c,sourceMapId:this.mapId})}}}receive(i){const n=i.data,s=n.id;if(s&&(!n.targetMapId||this.mapId===n.targetMapId))if(n.type==="<cancel>"){const c=this.cancelCallbacks[s];delete this.cancelCallbacks[s],c&&c.cancel()}else if(n.mustQueue||xi()){const c=this.callbacks[s];this.cancelCallbacks[s]=this.scheduler.add((()=>this.processTask(s,n)),c&&c.metadata||{type:"message"})}else this.processTask(s,n)}processTask(i,n){if(n.type==="<response>"){const s=this.callbacks[i];delete this.callbacks[i],s&&(n.error?s(Sl(n.error)):s(null,Sl(n.data)))}else{const s=rs(this.globalScope)?void 0:[],c=n.hasCallback?(y,w)=>{delete this.cancelCallbacks[i],this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:y?Tl(y):null,data:Tl(w,s)},s)}:y=>{},f=Sl(n.data);if(this.parent[n.type])this.parent[n.type](n.sourceMapId,f,c);else if(this.parent.getWorkerSource){const y=n.type.split(".");this.parent.getWorkerSource(n.sourceMapId,y[0],f.source)[y[1]](f,c)}else c(new Error(`Could not find function ${n.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}},a.CanonicalTileID=O_,a.Color=_r,a.ColorMode=Oc,a.CullFaceMode=Dl,a.DEMData=ex,a.DataConstantProperty=Q,a.DedupedRequest=LE,a.DepthMode=lm,a.EXTENT=an,a.Elevation=class{isDataAvailableAtPoint(i){const n=this._source();if(this.isUsingMockSource()||!n||i.y<0||i.y>1)return!1;const s=n.getSource().maxzoom,c=1<<s,f=Math.floor(i.x),y=Math.floor((i.x-f)*c),w=Math.floor(i.y*c),E=this.findDEMTileFor(new po(s,f,s,y,w));return!(!E||!E.dem)}getAtPointOrZero(i,n=0){return this.getAtPoint(i,n)||0}getAtPoint(i,n,s=!0){if(this.isUsingMockSource())return null;n==null&&(n=null);const c=this._source();if(!c||i.y<0||i.y>1)return n;const f=c.getSource().maxzoom,y=1<<f,w=Math.floor(i.x),E=i.x-w,A=new po(f,w,f,Math.floor(E*y),Math.floor(i.y*y)),I=this.findDEMTileFor(A);if(!I||!I.dem)return n;const j=I.dem,V=1<<I.tileID.canonical.z,U=(E*V-I.tileID.canonical.x)*j.dim,q=(i.y*V-I.tileID.canonical.y)*j.dim,X=Math.floor(U),te=Math.floor(q);return(s?this.exaggeration():1)*Kn(Kn(j.get(X,te),j.get(X,te+1),q-te),Kn(j.get(X+1,te),j.get(X+1,te+1),q-te),U-X)}getAtTileOffset(i,n,s){const c=1<<i.canonical.z;return this.getAtPointOrZero(new Ic(i.wrap+(i.canonical.x+n/an)/c,(i.canonical.y+s/an)/c))}getAtTileOffsetFunc(i,n,s,c){return f=>{const y=this.getAtTileOffset(i,f.x,f.y),w=c.upVector(i.canonical,f.x,f.y);return zr(w,w,y*c.upVectorScale(i.canonical,n,s).metersToTile),w}}getForTilePoints(i,n,s,c){if(this.isUsingMockSource())return!1;const f=tx.create(this,i,c);return!!f&&(n.forEach((y=>{y[2]=this.exaggeration()*f.getElevationAt(y[0],y[1],s)})),!0)}getMinMaxForTile(i){if(this.isUsingMockSource())return null;const n=this.findDEMTileFor(i);if(!n||!n.dem)return null;const s=n.dem.tree,c=n.tileID,f=1<<i.canonical.z-c.canonical.z;let y=i.canonical.x/f-c.canonical.x,w=i.canonical.y/f-c.canonical.y,E=0;for(let A=0;A<i.canonical.z-c.canonical.z&&!s.leaves[E];A++){y*=2,w*=2;const I=2*Math.floor(w)+Math.floor(y);E=s.childOffsets[E]+I,y%=1,w%=1}return{min:this.exaggeration()*s.minimums[E],max:this.exaggeration()*s.maximums[E]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(i,n,s){throw new Error("Pure virtual method called.")}pointCoordinate(i){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(i){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}},a.ErrorEvent=Qs,a.EvaluationParameters=B,a.Event=ka,a.Evented=xs,a.FillExtrusionBucket=Lg,a.Frustum=zp,a.FrustumCorners=hf,a.GLOBE_RADIUS=qa,a.GLOBE_SCALE_MATCH_LATITUDE=45,a.GLOBE_ZOOM_THRESHOLD_MAX=ds,a.GLOBE_ZOOM_THRESHOLD_MIN=Iu,a.GlobeSharedBuffers=class{constructor(i){this._createGrid(i),this._createPoles(i)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const i of this._poleSegments)i.destroy();for(const i of this._gridSegments)i.withSkirts.destroy(),i.withoutSkirts.destroy();if(this._wireframeIndexBuffer){this._wireframeIndexBuffer.destroy();for(const i of this._wireframeSegments)i.destroy()}}_fillGridMeshWithLods(i,n){const s=new kt,c=new en,f=[],y=i+1+2,w=n[0]+1,E=n[0]+1+(1+n.length),A=(I,j,V)=>{let U=I===y-1?I-2:I===0?I:I-1;return U+=V?24575:0,[U,j]};for(let I=0;I<y;++I)s.emplaceBack(...A(I,0,!0));for(let I=0;I<w;++I)for(let j=0;j<y;++j)s.emplaceBack(...A(j,I,(j===0||j===y-1)&&!0));for(let I=0;I<n.length;++I){const j=n[I];for(let V=0;V<y;++V)s.emplaceBack(...A(V,j,!0))}for(let I=0;I<n.length;++I){const j=c.length,V=n[I]+1+2,U=new en;for(let te=0;te<V-1;te++){const ae=te===V-2,ge=ae?y*(E-n.length+I-te):y;for(let Ce=0;Ce<y-1;Ce++){const ye=te*y+Ce;te===0||ae||Ce===0||Ce===y-2?(U.emplaceBack(ye+1,ye,ye+ge),U.emplaceBack(ye+ge,ye+ge+1,ye+1)):(c.emplaceBack(ye+1,ye,ye+ge),c.emplaceBack(ye+ge,ye+ge+1,ye+1))}}const q=oi.simpleSegment(0,j,s.length,c.length-j);for(let te=0;te<U.uint16.length;te+=3)c.emplaceBack(U.uint16[te],U.uint16[te+1],U.uint16[te+2]);const X=oi.simpleSegment(0,j,s.length,c.length-j);f.push({withoutSkirts:q,withSkirts:X})}return{vertices:s,indices:c,segments:f}}_createGrid(i){const n=this._fillGridMeshWithLods(Za,Li);this._gridSegments=n.segments,this._gridBuffer=i.createVertexBuffer(n.vertices,df.members),this._gridIndexBuffer=i.createIndexBuffer(n.indices,!0)}_createPoles(i){const n=new en;for(let f=0;f<=Za;f++)n.emplaceBack(0,f+1,f+2);this._poleIndexBuffer=i.createIndexBuffer(n,!0);const s=new tr,c=new tr;this._poleSegments=[];for(let f=0,y=0;f<Iu;f++){const w=360/(1<<f);s.emplaceBack(0,-qa,0,.5,0),c.emplaceBack(0,-qa,0,.5,1);for(let E=0;E<=Za;E++){const A=E/Za,I=Kn(0,w,A),[j,V,U]=pi(M_,w0,I,qa);s.emplaceBack(j,V,U,A,0),c.emplaceBack(j,V,U,A,1)}this._poleSegments.push(oi.simpleSegment(y,0,66,64)),y+=66}this._poleNorthVertexBuffer=i.createVertexBuffer(s,uf,!1),this._poleSouthVertexBuffer=i.createVertexBuffer(c,uf,!1)}getGridBuffers(i,n){return[this._gridBuffer,this._gridIndexBuffer,n?this._gridSegments[i].withSkirts:this._gridSegments[i].withoutSkirts]}getPoleBuffers(i){return[this._poleNorthVertexBuffer,this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[i]]}getWirefameBuffers(i,n){if(!this._wireframeSegments){const s=new $r,c=Za,f=c+1+2,y=1;this._wireframeSegments=[];for(let w=0,E=0;w<Li.length;w++){const A=Li[w];for(let j=y;j<A+y;j++)for(let V=y;V<c+y;V++){const U=j*f+V;s.emplaceBack(U,U+1),s.emplaceBack(U,U+f),s.emplaceBack(U,U+f+1)}const I=A*c*3;this._wireframeSegments.push(oi.simpleSegment(0,E,(A+1)*f,I)),E+=I}this._wireframeIndexBuffer=i.createIndexBuffer(s)}return[this._gridBuffer,this._wireframeIndexBuffer,this._wireframeSegments[n]]}},a.GlyphManager=rm,a.ImagePosition=R0,a.KDBush=X0,a.LivePerformanceUtils=up,a.LngLat=dn,a.LngLatBounds=Al,a.LocalGlyphMode=L0,a.MAX_MERCATOR_LATITUDE=Yr,a.MercatorCoordinate=Ic,a.ONE_EM=hs,a.OverscaledTileID=po,a.PerformanceMarkers=ll,a.Point=Pe,a.Properties=ve,a.RGBAImage=Hs,a.Ray=Op,a.RequestManager=class{constructor(i,n,s){this._transformRequestFn=i,this._customAccessToken=n,this._silenceAuthErrors=!!s,this._createSkuToken()}_createSkuToken(){const i=(function(){let n="";for(let s=0;s<10;s++)n+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",ie,n].join(""),tokenExpiresAt:Date.now()+432e5}})();this._skuToken=i.token,this._skuTokenExpiresAt=i.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(i,n){return this._transformRequestFn&&this._transformRequestFn(i,n)||{url:i}}normalizeStyleURL(i,n){if(!be(i))return i;const s=Rt(i);return s.path=`/styles/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeGlyphsURL(i,n){if(!be(i))return i;const s=Rt(i);return s.path=`/fonts/v1${s.path}`,this._makeAPIURL(s,this._customAccessToken||n)}normalizeSourceURL(i,n,s,c){if(!be(i))return i;const f=Rt(i);return f.path=`/v4/${f.authority}.json`,f.params.push("secure"),s&&f.params.push(`language=${s}`),c&&f.params.push(`worldview=${c}`),this._makeAPIURL(f,this._customAccessToken||n)}normalizeSpriteURL(i,n,s,c){const f=Rt(i);return be(i)?(f.path=`/styles/v1${f.path}/sprite${n}${s}`,this._makeAPIURL(f,this._customAccessToken||c)):(f.path+=`${n}${s}`,bt(f))}normalizeTileURL(i,n,s){if(this._isSkuTokenExpired()&&this._createSkuToken(),i&&!be(i))return i;const c=Rt(i);c.path=c.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${n||s&&c.authority!=="raster"&&s===512?"@2x":""}${O.supported?".webp":"$1"}`),c.authority==="raster"?c.path=`/${z.RASTER_URL_PREFIX}${c.path}`:(c.path=c.path.replace(/^.+\/v4\//,"/"),c.path=`/${z.TILE_URL_VERSION}${c.path}`);const f=this._customAccessToken||(function(y){for(const w of y){const E=w.match(/^access_token=(.*)$/);if(E)return E[1]}return null})(c.params)||z.ACCESS_TOKEN;return z.REQUIRE_ACCESS_TOKEN&&f&&this._skuToken&&c.params.push(`sku=${this._skuToken}`),this._makeAPIURL(c,f)}canonicalizeTileURL(i,n){const s=Rt(i);if(!s.path.match(/^(\/v4\/|\/raster\/v1\/)/)||!s.path.match(/\.[\w]+$/))return i;let c="mapbox://";s.path.match(/^\/raster\/v1\//)?c+=`raster/${s.path.replace(`/${z.RASTER_URL_PREFIX}/`,"")}`:c+=`tiles/${s.path.replace(`/${z.TILE_URL_VERSION}/`,"")}`;let f=s.params;return n&&(f=f.filter((y=>!y.match(/^access_token=/)))),f.length&&(c+=`?${f.join("&")}`),c}canonicalizeTileset(i,n){const s=!!n&&be(n),c=[];for(const f of i.tiles||[])Oe(f)?c.push(this.canonicalizeTileURL(f,s)):c.push(f);return c}_makeAPIURL(i,n){const s="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",c=Rt(z.API_URL);if(i.protocol=c.protocol,i.authority=c.authority,i.protocol==="http"){const f=i.params.indexOf("secure");f>=0&&i.params.splice(f,1)}if(c.path!=="/"&&(i.path=`${c.path}${i.path}`),!z.REQUIRE_ACCESS_TOKEN)return bt(i);if(n=n||z.ACCESS_TOKEN,!this._silenceAuthErrors){if(!n)throw new Error(`An API access token is required to use Mapbox GL. ${s}`);if(n[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${s}`)}return i.params=i.params.filter((f=>f.indexOf("access_token")===-1)),i.params.push(`access_token=${n||""}`),bt(i)}},a.ResourceType=Ai,a.SegmentVector=oi,a.SourceCache=If,a.StencilMode=H0,a.StructArrayLayout1ui2=Vs,a.StructArrayLayout2f1f2i16=un,a.StructArrayLayout2i4=kt,a.StructArrayLayout2ui4=$r,a.StructArrayLayout3f12=Fn,a.StructArrayLayout3ui6=en,a.StructArrayLayout4i8=at,a.StructArrayLayout5f20=tr,a.Texture=Wg,a.Tile=$0,a.Transitionable=J,a.Uniform1f=rf,a.Uniform1i=class extends $a{constructor(i){super(i),this.current=0}set(i,n,s){this.fetchUniformLocation(i,n)&&this.current!==s&&(this.current=s,this.gl.uniform1i(this.location,s))}},a.Uniform2f=class extends $a{constructor(i){super(i),this.current=[0,0]}set(i,n,s){this.fetchUniformLocation(i,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]||(this.current=s,this.gl.uniform2f(this.location,s[0],s[1])))}},a.Uniform3f=class extends $a{constructor(i){super(i),this.current=[0,0,0]}set(i,n,s){this.fetchUniformLocation(i,n)&&(s[0]===this.current[0]&&s[1]===this.current[1]&&s[2]===this.current[2]||(this.current=s,this.gl.uniform3f(this.location,s[0],s[1],s[2])))}},a.Uniform4f=og,a.UniformColor=ag,a.UniformMatrix2f=class extends $a{constructor(i){super(i),this.current=y_}set(i,n,s){if(this.fetchUniformLocation(i,n)){for(let c=0;c<4;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix2fv(this.location,!1,s);break}}}},a.UniformMatrix3f=class extends $a{constructor(i){super(i),this.current=g_}set(i,n,s){if(this.fetchUniformLocation(i,n)){for(let c=0;c<9;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix3fv(this.location,!1,s);break}}}},a.UniformMatrix4f=class extends $a{constructor(i){super(i),this.current=m_}set(i,n,s){if(this.fetchUniformLocation(i,n)){if(s[12]!==this.current[12]||s[0]!==this.current[0])return this.current=s,void this.gl.uniformMatrix4fv(this.location,!1,s);for(let c=1;c<16;c++)if(s[c]!==this.current[c]){this.current=s,this.gl.uniformMatrix4fv(this.location,!1,s);break}}}},a.UnwrappedTileID=CS,a.ValidationError=zt,a.VectorTileFeature=Sn,a.VectorTileWorkerSource=class extends xs{constructor(i,n,s,c,f){super(),this.actor=i,this.layerIndex=n,this.availableImages=s,this.loadVectorData=f||jE,this.loading={},this.loaded={},this.deduped=new LE(i.scheduler),this.isSpriteLoaded=c,this.scheduler=i.scheduler}loadTile(i,n){const s=i.uid,c=i&&i.request,f=c&&c.collectResourceTiming,y=this.loading[s]=new Q5(i);y.abort=this.loadVectorData(i,((w,E)=>{const A=!this.loading[s];if(delete this.loading[s],A||w||!E)return y.status="done",A||(this.loaded[s]=y),n(w);const I=E.rawData,j={};E.expires&&(j.expires=E.expires),E.cacheControl&&(j.cacheControl=E.cacheControl),y.vectorTile=E.vectorTile||new mn(new V_(I));const V=()=>{y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,((U,q)=>{if(U||!q)return n(U);const X={};if(f){const te=kh(c);te.length>0&&(X.resourceTiming=JSON.parse(JSON.stringify(te)))}n(null,vt({rawTileData:I.slice(0)},q,j,X))}))};this.isSpriteLoaded?V():this.once("isSpriteLoaded",(()=>{this.scheduler?this.scheduler.add(V,{type:"parseTile",isSymbolTile:i.isSymbolTile,zoom:i.tileZoom}):V()})),this.loaded=this.loaded||{},this.loaded[s]=y}))}reloadTile(i,n){const s=this.loaded,c=i.uid,f=this;if(s&&s[c]){const y=s[c];y.showCollisionBoxes=i.showCollisionBoxes,y.enableTerrain=!!i.enableTerrain,y.projection=i.projection,y.tileTransform=Af(i.tileID.canonical,i.projection);const w=(E,A)=>{const I=y.reloadCallback;I&&(delete y.reloadCallback,y.parse(y.vectorTile,f.layerIndex,this.availableImages,f.actor,I)),n(E,A)};y.status==="parsing"?y.reloadCallback=w:y.status==="done"&&(y.vectorTile?y.parse(y.vectorTile,this.layerIndex,this.availableImages,this.actor,w):w())}}abortTile(i,n){const s=i.uid,c=this.loading[s];c&&(c.abort&&c.abort(),delete this.loading[s]),n()}removeTile(i,n){const s=this.loaded,c=i.uid;s&&s[c]&&delete s[c],n()}},a.WritingMode=wa,a.ZoomDependentExpression=ja,a.add=Ha,a.addDynamicAttributes=Y_,a.adjoint=function(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=n[4],E=n[5],A=n[6],I=n[7],j=n[8];return i[0]=w*j-E*I,i[1]=f*I-c*j,i[2]=c*E-f*w,i[3]=E*A-y*j,i[4]=s*j-f*A,i[5]=f*y-s*E,i[6]=y*I-w*A,i[7]=c*A-s*I,i[8]=s*w-c*y,i},a.asyncAll=Fe,a.bezier=pt,a.bindAll=fn,a.boundsAttributes=_E,a.bufferConvexPolygon=function(i,n){const s=[];for(let c=0;c<i.length;c++){const f=he(c-1,-1,i.length-1),y=he(c+1,-1,i.length-1),w=i[c],E=i[y],A=i[f].sub(w).unit(),I=E.sub(w).unit(),j=I.angleWithSep(A.x,A.y),V=A.add(I).unit().mult(-1*n/Math.sin(j/2));s.push(w.add(V))}return s},a.cacheEntryPossiblyAdded=function(i){Ks++,Ks>is&&(i.getActor().send("enforceCacheSizeLimit",Vr),Ks=0)},a.calculateGlobeLabelMatrix=function(i,n){const{x:s,y:c}=i.point,f=ya(s,c,i.worldSize/i._pixelsPerMercatorPixel,0,0);return Il(f,f,Bp(Mo(n)))},a.calculateGlobeMatrix=function(i){const{x:n,y:s}=i.point,{lng:c,lat:f}=i._center;return ya(n,s,i.worldSize,c,f)},a.calculateGlobeMercatorMatrix=function(i){const n=i.pixelsPerMeter,s=n/ai(1,i.center.lat),c=ga(new Float64Array(16));return Ec(c,c,[i.point.x,i.point.y,0]),Cc(c,c,[s,s,n]),Float32Array.from(c)},a.circumferenceAtLatitude=ji,a.clamp=xe,a.clearTileCache=function(i){if(!qi())return;const n=k.caches.delete(_s);i&&n.catch(i).then((()=>i()))},a.clipLine=eE,a.clone=function(i){var n=new ls(16);return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],n},a.clone$1=hr,a.collisionCircleLayout=YL,a.config=z,a.conjugate=function(i,n){return i[0]=-n[0],i[1]=-n[1],i[2]=-n[2],i[3]=n[3],i},a.create=function(){var i=new ls(16);return ls!=Float32Array&&(i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0),i[0]=1,i[5]=1,i[10]=1,i[15]=1,i},a.create$1=b_,a.createExpression=gr,a.createLayout=Ue,a.createStyleLayer=function(i){return i.type==="custom"?new U5(i):new G5[i.type](i)},a.cross=Rp,a.degToRad=gt,a.distance=function(i,n){return Math.hypot(n[0]-i[0],n[1]-i[1],n[2]-i[2])},a.div=function(i,n,s){return i[0]=n[0]/s[0],i[1]=n[1]/s[1],i[2]=n[2]/s[2],i},a.dot=Ao,a.earthRadius=Ac,a.ease=Ae,a.easeCubicInOut=mt,a.ecefToLatLng=function([i,n,s]){const c=Math.hypot(i,n,s),f=Math.atan2(i,s),y=.5*Math.PI-Math.acos(-n/c);return new dn(ht(f),ht(y))},a.emitValidationErrors=as,a.endsWith=Cn,a.enforceCacheSizeLimit=function(i){ki(),vi&&vi.then((n=>{n.keys().then((s=>{for(let c=0;c<s.length-i;c++)n.delete(s[c])}))}))},a.evaluateSizeForFeature=B_,a.evaluateSizeForZoom=Qp,a.evaluateVariableOffset=sE,a.evented=T,a.exactEquals=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]&&i[3]===n[3]},a.exactEquals$1=function(i,n){return i[0]===n[0]&&i[1]===n[1]&&i[2]===n[2]},a.exported=Bo,a.exported$1=O,a.extend=vt,a.extend$1=bi,a.fillExtrusionHeightLift=TS,a.filterObject=mr,a.fromMat4=function(i,n){return i[0]=n[0],i[1]=n[1],i[2]=n[2],i[3]=n[4],i[4]=n[5],i[5]=n[6],i[6]=n[8],i[7]=n[9],i[8]=n[10],i},a.fromQuat=function(i,n){var s=n[0],c=n[1],f=n[2],y=n[3],w=s+s,E=c+c,A=f+f,I=s*w,j=c*w,V=c*E,U=f*w,q=f*E,X=f*A,te=y*w,ae=y*E,ge=y*A;return i[0]=1-V-X,i[1]=j+ge,i[2]=U-ae,i[3]=0,i[4]=j-ge,i[5]=1-I-X,i[6]=q+te,i[7]=0,i[8]=U+ae,i[9]=q-te,i[10]=1-I-V,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,i},a.fromRotation=function(i,n){var s=Math.sin(n),c=Math.cos(n);return i[0]=c,i[1]=s,i[2]=0,i[3]=-s,i[4]=c,i[5]=0,i[6]=0,i[7]=0,i[8]=1,i},a.fromScaling=Mp,a.furthestTileCorner=function(i){const n=Math.round((i+45+360)%360/90)%4;return Lt[n]},a.getAABBPointSquareDist=function(i,n,s){let c=0;for(let f=0;f<2;++f){const y=s?s[f]:0;i[f]>y&&(c+=(i[f]-y)*(i[f]-y)),n[f]<y&&(c+=(y-n[f])*(y-n[f]))}return c},a.getAnchorAlignment=D0,a.getAnchorJustification=O0,a.getBounds=function(i){let n=1/0,s=1/0,c=-1/0,f=-1/0;for(const y of i)n=Math.min(n,y.x),s=Math.min(s,y.y),c=Math.max(c,y.x),f=Math.max(f,y.y);return{min:new Pe(n,s),max:new Pe(c,f)}},a.getColumn=Ms,a.getDefaultExportFromCjs=pe,a.getGridMatrix=function(i,n,s,c){const f=n.getNorth(),y=n.getSouth(),w=n.getWest(),E=n.getEast(),A=1<<i.z,I=E-w,j=f-y,V=I/Za,U=-j/Li[s],q=[0,V,0,U,0,0,f,w,0];if(i.z>0){const X=180/c;T_(q,q,[X/I+1,0,0,0,X/j+1,0,-.5*X/V,.5*X/U,1])}return q[2]=A,q[5]=i.x,q[8]=i.y,q},a.getImage=ue,a.getJSON=function(i,n){return Rs(vt(i,{type:"json"}),n)},a.getLatitudinalLod=function(i){const n=Yr-5;i=xe(i,-n,n)/n*90;const s=Math.pow(Math.abs(Math.sin(gt(i))),3);return Math.round(s*(Li.length-1))},a.getMapSessionAPI=wi,a.getPerformanceMeasurement=kh,a.getProjection=fE,a.getRTLTextPluginStatus=C,a.getReferrer=ri,a.getTilePoint=function(i,{x:n,y:s},c=0){return new Pe(((n-c)*i.scale-i.x)*an,(s*i.scale-i.y)*an)},a.getTileVec3=function(i,n,s=0){return Au(((n.x-s)*i.scale-i.x)*an,(n.y*i.scale-i.y)*an,Dd(n.z,n.y))},a.getVideo=function(i,n){const s=k.document.createElement("video");s.muted=!0,s.onloadstart=function(){n(null,s)};for(let c=0;c<i.length;c++){const f=k.document.createElement("source");_o(i[c])||(s.crossOrigin="Anonymous"),f.src=i[c],s.appendChild(f)}return{cancel:()=>{}}},a.globeCenterToScreenPoint=function(i){const n=[0,0,0],s=ga(new Float64Array(16));return Il(s,i.pixelMatrix,i.globeMatrix),Hr(n,n,s),new Pe(n[0],n[1])},a.globeDenormalizeECEF=Bp,a.globeECEFOrigin=function(i,n){const s=[0,0,0];return Hr(s,s,Us(Mo(n.canonical))),Hr(s,s,i),s},a.globeMetersToEcef=Pd,a.globeNormalizeECEF=Us,a.globePixelsToTileUnits=function(i,n){return an/(512*Math.pow(2,i))*pf(Mo(n))},a.globePoleMatrixForTile=function(i,n,s){const c=ga(new Float64Array(16)),f=(n/(1<<i)-.5)*Math.PI*2;return of(c,s.globeMatrix,f),Float32Array.from(c)},a.globeTileBounds=Mo,a.globeTiltAtLngLat=xg,a.globeToMercatorTransition=Nd,a.globeUseCustomAntiAliasing=function(i,n,s){const c=Nd(s.zoom),f=i.style.map._antialias,y=!!n.extStandardDerivatives,w=n.extStandardDerivativesForceOff||i.terrain&&i.terrain.exaggeration()>0;return c===0&&!f&&!w&&y},a.identity=ga,a.identity$1=cf,a.invert=ko,a.isFullscreen=function(){return!!k.document.fullscreenElement||!!k.document.webkitFullscreenElement},a.isLngLatBehindGlobe=Fp,a.isMapAuthenticated=function(i){return os.has(i)},a.isMapboxURL=be,a.isSafariWithAntialiasingBug=function(i){const n=i.navigator?i.navigator.userAgent:null;return!!rs(i)&&n&&(n.match("Version/15.4")||n.match("Version/15.5")||n.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/))},a.latFromMercatorY=ar,a.latLngToECEF=ks,a.len=C_,a.length=kd,a.length$1=function(i){return Math.hypot(i[0],i[1],i[2],i[3])},a.lngFromMercatorX=Yi,a.loadVectorTile=jE,a.makeRequest=Rs,a.mapValue=function(i,n,s,c,f){return xe((i-n)/(s-n)*(f-c)+c,c,f)},a.mercatorScale=mf,a.mercatorXfromLng=kr,a.mercatorYfromLat=Fr,a.mercatorZfromAltitude=ai,a.mul=dg,a.mul$1=E_,a.multiply=Il,a.multiply$1=T_,a.multiply$2=hg,a.nextPowerOfTwo=Kt,a.normalize=cs,a.normalize$1=pg,a.normalize$2=Lp,a.number=Kn,a.ortho=function(i,n,s,c,f,y,w){var E=1/(n-s),A=1/(c-f),I=1/(y-w);return i[0]=-2*E,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=-2*A,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[10]=2*I,i[11]=0,i[12]=(n+s)*E,i[13]=(f+c)*A,i[14]=(w+y)*I,i[15]=1,i},a.pbf=NS,a.perspective=function(i,n,s,c,f){var y,w=1/Math.tan(n/2);return i[0]=w/s,i[1]=0,i[2]=0,i[3]=0,i[4]=0,i[5]=w,i[6]=0,i[7]=0,i[8]=0,i[9]=0,i[11]=-1,i[12]=0,i[13]=0,i[15]=0,f!=null&&f!==1/0?(i[10]=(f+c)*(y=1/(c-f)),i[14]=2*f*c*y):(i[10]=-1,i[14]=-2*c),i},a.pick=function(i,n){const s={};for(let c=0;c<n.length;c++){const f=n[c];f in i&&(s[f]=i[f])}return s},a.plugin=D,a.pointGeometry=Ge,a.polesInViewport=function(i){const n=ga(new Float64Array(16));Il(n,i.pixelMatrix,i.globeMatrix);const s=[0,Ko,0],c=[0,Yt,0];return Hr(s,s,n),Hr(c,c,n),[s[0]>0&&s[0]<=i.width&&s[1]>0&&s[1]<=i.height&&!Fp(i,new dn(i.center.lat,90)),c[0]>0&&c[0]<=i.width&&c[1]>0&&c[1]<=i.height&&!Fp(i,new dn(i.center.lat,-90))]},a.polygonContainsPoint=Pl,a.polygonIntersectsBox=P_,a.polygonIntersectsPolygon=Up,a.polygonizeBounds=function(i,n,s=0,c=!0){const f=new Pe(s,s),y=i.sub(f),w=n.add(f),E=[y,new Pe(w.x,y.y),w,new Pe(y.x,w.y)];return c&&E.push(y.clone()),E},a.posAttributes=df,a.postMapLoadEvent=ii,a.postPerformanceEvent=Rr,a.postTurnstileEvent=$n,a.potpack=P0,a.prevPowerOfTwo=function(i){return i<=1?1:Math.pow(2,Math.floor(Math.log(i)/Math.LN2))},a.radToDeg=ht,a.refProperties=["type","source","source-layer","minzoom","maxzoom","filter","layout"],a.registerForPluginStateChange=function(i){return i({pluginStatus:g,pluginURL:o}),T.on("pluginStateChange",i),i},a.removeAuthState=function(i){os.delete(i)},a.renderColorRamp=Ag,a.resample=$s,a.rotateX=Ip,a.rotateX$1=k_,a.rotateY=of,a.rotateY$1=fg,a.rotateZ=function(i,n,s){var c=Math.sin(s),f=Math.cos(s),y=n[0],w=n[1],E=n[2],A=n[3],I=n[4],j=n[5],V=n[6],U=n[7];return n!==i&&(i[8]=n[8],i[9]=n[9],i[10]=n[10],i[11]=n[11],i[12]=n[12],i[13]=n[13],i[14]=n[14],i[15]=n[15]),i[0]=y*f+I*c,i[1]=w*f+j*c,i[2]=E*f+V*c,i[3]=A*f+U*c,i[4]=I*f-y*c,i[5]=j*f-w*c,i[6]=V*f-E*c,i[7]=U*f-A*c,i},a.rotateZ$1=function(i,n,s){s*=.5;var c=n[0],f=n[1],y=n[2],w=n[3],E=Math.sin(s),A=Math.cos(s);return i[0]=c*A+f*E,i[1]=f*A-c*E,i[2]=y*A+w*E,i[3]=w*A-y*E,i},a.scale=Cc,a.scale$1=Dp,a.scale$2=zr,a.scaleAndAdd=Ad,a.set=function(i,n,s,c){return i[0]=n,i[1]=s,i[2]=c,i},a.setCacheLimits=function(i,n){Vr=i,is=n},a.setColumn=function(i,n,s){i[4*n+0]=s[0],i[4*n+1]=s[1],i[4*n+2]=s[2],i[4*n+3]=s[3]},a.setRTLTextPlugin=function(i,n,s=!1){if(g===Eo||g===pa||g===Sd)throw new Error("setRTLTextPlugin cannot be called multiple times.");o=Bo.resolveURL(i),g=Eo,Va=n,_(),s||N()},a.smoothstep=We,a.spec=dt,a.squaredLength=function(i){var n=i[0],s=i[1],c=i[2];return n*n+s*s+c*c},a.storeAuthState=function(i,n){n?os.add(i):os.delete(i)},a.sub=Io,a.subtract=Pp,a.symbolSize=JL,a.tileAABB=function(i,n,s,c,f,y,w,E,A){if(A.name==="globe")return I_(i,n,new O_(s,c,f));const I=Af({z:s,x:c,y:f},A);return new us([(y+I.x/I.scale)*n,n*(I.y/I.scale),w],[(y+I.x2/I.scale)*n,n*(I.y2/I.scale),E])},a.tileCornersToBounds=Rd,a.tileTransform=Af,a.transformMat3=function(i,n,s){var c=n[0],f=n[1],y=n[2];return i[0]=c*s[0]+f*s[3]+y*s[6],i[1]=c*s[1]+f*s[4]+y*s[7],i[2]=c*s[2]+f*s[5]+y*s[8],i},a.transformMat4=Hr,a.transformMat4$1=kc,a.transformQuat=Np,a.transitionTileAABBinECEF=gg,a.translate=Ec,a.transpose=function(i,n){if(i===n){var s=n[1],c=n[2],f=n[5];i[1]=n[3],i[2]=n[6],i[3]=s,i[5]=n[7],i[6]=c,i[7]=f}else i[0]=n[0],i[1]=n[3],i[2]=n[6],i[3]=n[1],i[4]=n[4],i[5]=n[7],i[6]=n[2],i[7]=n[5],i[8]=n[8];return i},a.triggerPluginCompletionEvent=h,a.uniqueId=rn,a.updateGlobeVertexNormal=function(i,n,s,c,f){const y=5*n+2;i.float32[y+0]=s,i.float32[y+1]=c,i.float32[y+2]=f},a.validateCustomStyleLayer=function(i){const n=[],s=i.id;return s===void 0&&n.push({message:`layers.${s}: missing required property "id"`}),i.render===void 0&&n.push({message:`layers.${s}: missing required method "render"`}),i.renderingMode&&i.renderingMode!=="2d"&&i.renderingMode!=="3d"&&n.push({message:`layers.${s}: property "renderingMode" must be either "2d" or "3d"`}),n},a.validateFilter=i=>$i(Ss(i)),a.validateFog=i=>$i(ha(i)),a.validateLayer=i=>$i(Ep(i)),a.validateLight=i=>$i(bd(i)),a.validateSource=i=>$i(wl(i)),a.validateStyle=Ui,a.validateTerrain=i=>$i(za(i)),a.values=it,a.vectorTile=st,a.version=M,a.warnOnce=Xn,a.window=k,a.wrap=he})),v(["./shared"],(function(a){function k(Te){if(typeof Te=="number"||typeof Te=="boolean"||typeof Te=="string"||Te==null)return JSON.stringify(Te);if(Array.isArray(Te)){let re="[";for(const ue of Te)re+=`${k(ue)},`;return`${re}]`}let ne="{";for(const re of Object.keys(Te).sort())ne+=`${re}:${k(Te[re])},`;return`${ne}}`}function M(Te){let ne="";for(const re of a.refProperties)ne+=`/${k(Te[re])}`;return ne}class L{constructor(ne){this.keyCache={},ne&&this.replace(ne)}replace(ne){this._layerConfigs={},this._layers={},this.update(ne,[])}update(ne,re){for(const Se of ne)this._layerConfigs[Se.id]=Se,(this._layers[Se.id]=a.createStyleLayer(Se)).compileFilter(),this.keyCache[Se.id]&&delete this.keyCache[Se.id];for(const Se of re)delete this.keyCache[Se],delete this._layerConfigs[Se],delete this._layers[Se];this.familiesBySource={};const ue=(function(Se,be){const Oe={};for(let je=0;je<Se.length;je++){const Ze=be&&be[Se[je].id]||M(Se[je]);be&&(be[Se[je].id]=Ze);let St=Oe[Ze];St||(St=Oe[Ze]=[]),St.push(Se[je])}const Be=[];for(const je in Oe)Be.push(Oe[je]);return Be})(a.values(this._layerConfigs),this.keyCache);for(const Se of ue){const be=Se.map((Rt=>this._layers[Rt.id])),Oe=be[0];if(Oe.visibility==="none")continue;const Be=Oe.source||"";let je=this.familiesBySource[Be];je||(je=this.familiesBySource[Be]={});const Ze=Oe.sourceLayer||"_geojsonTileLayer";let St=je[Ze];St||(St=je[Ze]=[]),St.push(be)}}}class z{loadTile(ne,re){const{uid:ue,encoding:Se,rawImageData:be,padding:Oe,buildQuadTree:Be}=ne,je=a.window.ImageBitmap&&be instanceof a.window.ImageBitmap?this.getImageData(be,Oe):be;re(null,new a.DEMData(ue,je,Se,Oe<1,Be))}getImageData(ne,re){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(ne.width,ne.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=ne.width,this.offscreenCanvas.height=ne.height,this.offscreenCanvasContext.drawImage(ne,0,0,ne.width,ne.height);const ue=this.offscreenCanvasContext.getImageData(-re,-re,ne.width+2*re,ne.height+2*re);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),ue}}function O(Te,ne){if(Te.length!==0){K(Te[0],ne);for(var re=1;re<Te.length;re++)K(Te[re],!ne)}}function K(Te,ne){for(var re=0,ue=0,Se=0,be=Te.length,Oe=be-1;Se<be;Oe=Se++){var Be=(Te[Se][0]-Te[Oe][0])*(Te[Oe][1]+Te[Se][1]),je=re+Be;ue+=Math.abs(re)>=Math.abs(Be)?re-je+Be:Be-je+re,re=je}re+ue>=0!=!!ne&&Te.reverse()}var H=a.getDefaultExportFromCjs((function Te(ne,re){var ue,Se=ne&&ne.type;if(Se==="FeatureCollection")for(ue=0;ue<ne.features.length;ue++)Te(ne.features[ue],re);else if(Se==="GeometryCollection")for(ue=0;ue<ne.geometries.length;ue++)Te(ne.geometries[ue],re);else if(Se==="Feature")Te(ne.geometry,re);else if(Se==="Polygon")O(ne.coordinates,re);else if(Se==="MultiPolygon")for(ue=0;ue<ne.coordinates.length;ue++)O(ne.coordinates[ue],re);return ne}));const Z=a.VectorTileFeature.prototype.toGeoJSON;var Y={exports:{}},ee=a.pointGeometry,ie=a.vectorTile.VectorTileFeature,pe=we;function we(Te,ne){this.options=ne||{},this.features=Te,this.length=Te.length}function ke(Te,ne){this.id=typeof Te.id=="number"?Te.id:void 0,this.type=Te.type,this.rawGeometry=Te.type===1?[Te.geometry]:Te.geometry,this.properties=Te.tags,this.extent=ne||4096}we.prototype.feature=function(Te){return new ke(this.features[Te],this.options.extent)},ke.prototype.loadGeometry=function(){var Te=this.rawGeometry;this.geometry=[];for(var ne=0;ne<Te.length;ne++){for(var re=Te[ne],ue=[],Se=0;Se<re.length;Se++)ue.push(new ee(re[Se][0],re[Se][1]));this.geometry.push(ue)}return this.geometry},ke.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Te=this.geometry,ne=1/0,re=-1/0,ue=1/0,Se=-1/0,be=0;be<Te.length;be++)for(var Oe=Te[be],Be=0;Be<Oe.length;Be++){var je=Oe[Be];ne=Math.min(ne,je.x),re=Math.max(re,je.x),ue=Math.min(ue,je.y),Se=Math.max(Se,je.y)}return[ne,ue,re,Se]},ke.prototype.toGeoJSON=ie.prototype.toGeoJSON;var ze=a.pbf,Ge=pe;function tt(Te){var ne=new ze;return(function(re,ue){for(var Se in re.layers)ue.writeMessage(3,Pe,re.layers[Se])})(Te,ne),ne.finish()}function Pe(Te,ne){var re;ne.writeVarintField(15,Te.version||1),ne.writeStringField(1,Te.name||""),ne.writeVarintField(5,Te.extent||4096);var ue={keys:[],values:[],keycache:{},valuecache:{}};for(re=0;re<Te.length;re++)ue.feature=Te.feature(re),ne.writeMessage(2,ot,ue);var Se=ue.keys;for(re=0;re<Se.length;re++)ne.writeStringField(3,Se[re]);var be=ue.values;for(re=0;re<be.length;re++)ne.writeMessage(4,mt,be[re])}function ot(Te,ne){var re=Te.feature;re.id!==void 0&&ne.writeVarintField(1,re.id),ne.writeMessage(2,ut,Te),ne.writeVarintField(3,re.type),ne.writeMessage(4,Lt,re)}function ut(Te,ne){var re=Te.feature,ue=Te.keys,Se=Te.values,be=Te.keycache,Oe=Te.valuecache;for(var Be in re.properties){var je=re.properties[Be],Ze=be[Be];if(je!==null){Ze===void 0&&(ue.push(Be),be[Be]=Ze=ue.length-1),ne.writeVarint(Ze);var St=typeof je;St!=="string"&&St!=="boolean"&&St!=="number"&&(je=JSON.stringify(je));var Rt=St+":"+je,bt=Oe[Rt];bt===void 0&&(Se.push(je),Oe[Rt]=bt=Se.length-1),ne.writeVarint(bt)}}}function gt(Te,ne){return(ne<<3)+(7&Te)}function ht(Te){return Te<<1^Te>>31}function Lt(Te,ne){for(var re=Te.loadGeometry(),ue=Te.type,Se=0,be=0,Oe=re.length,Be=0;Be<Oe;Be++){var je=re[Be],Ze=1;ue===1&&(Ze=je.length),ne.writeVarint(gt(1,Ze));for(var St=ue===3?je.length-1:je.length,Rt=0;Rt<St;Rt++){Rt===1&&ue!==1&&ne.writeVarint(gt(2,St-1));var bt=je[Rt].x-Se,vn=je[Rt].y-be;ne.writeVarint(ht(bt)),ne.writeVarint(ht(vn)),Se+=bt,be+=vn}ue===3&&ne.writeVarint(gt(7,1))}}function mt(Te,ne){var re=typeof Te;re==="string"?ne.writeStringField(1,Te):re==="boolean"?ne.writeBooleanField(7,Te):re==="number"&&(Te%1!=0?ne.writeDoubleField(3,Te):Te<0?ne.writeSVarintField(6,Te):ne.writeVarintField(5,Te))}Y.exports=tt,Y.exports.fromVectorTileJs=tt,Y.exports.fromGeojsonVt=function(Te,ne){ne=ne||{};var re={};for(var ue in Te)re[ue]=new Ge(Te[ue].features,ne),re[ue].name=ue,re[ue].version=ne.version,re[ue].extent=ne.extent;return tt({layers:re})},Y.exports.GeoJSONWrapper=Ge;var pt=a.getDefaultExportFromCjs(Y.exports);const Ae={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:Te=>Te},xe=Math.fround||(We=new Float32Array(1),Te=>(We[0]=+Te,We[0]));var We;const he=3,Fe=5,it=6;class vt{constructor(ne){this.options=Object.assign(Object.create(Ae),ne),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(ne){const{log:re,minZoom:ue,maxZoom:Se}=this.options;re&&console.time("total time");const be=`prepare ${ne.length} points`;re&&console.time(be),this.points=ne;const Oe=[];for(let je=0;je<ne.length;je++){const Ze=ne[je];if(!Ze.geometry)continue;const[St,Rt]=Ze.geometry.coordinates,bt=xe(wt(St)),vn=xe(Kt(Rt));Oe.push(bt,vn,1/0,je,-1,1),this.options.reduce&&Oe.push(0)}let Be=this.trees[Se+1]=this._createTree(Oe);re&&console.timeEnd(be);for(let je=Se;je>=ue;je--){const Ze=+Date.now();Be=this.trees[je]=this._createTree(this._cluster(Be,je)),re&&console.log("z%d: %d clusters in %dms",je,Be.numItems,+Date.now()-Ze)}return re&&console.timeEnd("total time"),this}getClusters(ne,re){let ue=((ne[0]+180)%360+360)%360-180;const Se=Math.max(-90,Math.min(90,ne[1]));let be=ne[2]===180?180:((ne[2]+180)%360+360)%360-180;const Oe=Math.max(-90,Math.min(90,ne[3]));if(ne[2]-ne[0]>=360)ue=-180,be=180;else if(ue>be){const Rt=this.getClusters([ue,Se,180,Oe],re),bt=this.getClusters([-180,Se,be,Oe],re);return Rt.concat(bt)}const Be=this.trees[this._limitZoom(re)],je=Be.range(wt(ue),Kt(Oe),wt(be),Kt(Se)),Ze=Be.data,St=[];for(const Rt of je){const bt=this.stride*Rt;St.push(Ze[bt+Fe]>1?Wt(Ze,bt,this.clusterProps):this.points[Ze[bt+he]])}return St}getChildren(ne){const re=this._getOriginId(ne),ue=this._getOriginZoom(ne),Se="No cluster with the specified id.",be=this.trees[ue];if(!be)throw new Error(Se);const Oe=be.data;if(re*this.stride>=Oe.length)throw new Error(Se);const Be=this.options.radius/(this.options.extent*Math.pow(2,ue-1)),je=be.within(Oe[re*this.stride],Oe[re*this.stride+1],Be),Ze=[];for(const St of je){const Rt=St*this.stride;Oe[Rt+4]===ne&&Ze.push(Oe[Rt+Fe]>1?Wt(Oe,Rt,this.clusterProps):this.points[Oe[Rt+he]])}if(Ze.length===0)throw new Error(Se);return Ze}getLeaves(ne,re,ue){const Se=[];return this._appendLeaves(Se,ne,re=re||10,ue=ue||0,0),Se}getTile(ne,re,ue){const Se=this.trees[this._limitZoom(ne)],be=Math.pow(2,ne),{extent:Oe,radius:Be}=this.options,je=Be/Oe,Ze=(ue-je)/be,St=(ue+1+je)/be,Rt={features:[]};return this._addTileFeatures(Se.range((re-je)/be,Ze,(re+1+je)/be,St),Se.data,re,ue,be,Rt),re===0&&this._addTileFeatures(Se.range(1-je/be,Ze,1,St),Se.data,be,ue,be,Rt),re===be-1&&this._addTileFeatures(Se.range(0,Ze,je/be,St),Se.data,-1,ue,be,Rt),Rt.features.length?Rt:null}getClusterExpansionZoom(ne){let re=this._getOriginZoom(ne)-1;for(;re<=this.options.maxZoom;){const ue=this.getChildren(ne);if(re++,ue.length!==1)break;ne=ue[0].properties.cluster_id}return re}_appendLeaves(ne,re,ue,Se,be){const Oe=this.getChildren(re);for(const Be of Oe){const je=Be.properties;if(je&&je.cluster?be+je.point_count<=Se?be+=je.point_count:be=this._appendLeaves(ne,je.cluster_id,ue,Se,be):be<Se?be++:ne.push(Be),ne.length===ue)break}return be}_createTree(ne){const re=new a.KDBush(ne.length/this.stride|0,this.options.nodeSize,Float32Array);for(let ue=0;ue<ne.length;ue+=this.stride)re.add(ne[ue],ne[ue+1]);return re.finish(),re.data=ne,re}_addTileFeatures(ne,re,ue,Se,be,Oe){for(const Be of ne){const je=Be*this.stride,Ze=re[je+Fe]>1;let St,Rt,bt;if(Ze)St=rn(re,je,this.clusterProps),Rt=re[je],bt=re[je+1];else{const kn=this.points[re[je+he]];St=kn.properties;const[Pn,$n]=kn.geometry.coordinates;Rt=wt(Pn),bt=Kt($n)}const vn={type:1,geometry:[[Math.round(this.options.extent*(Rt*be-ue)),Math.round(this.options.extent*(bt*be-Se))]],tags:St};let An;An=Ze||this.options.generateId?re[je+he]:this.points[re[je+he]].id,An!==void 0&&(vn.id=An),Oe.features.push(vn)}}_limitZoom(ne){return Math.max(this.options.minZoom,Math.min(Math.floor(+ne),this.options.maxZoom+1))}_cluster(ne,re){const{radius:ue,extent:Se,reduce:be,minPoints:Oe}=this.options,Be=ue/(Se*Math.pow(2,re)),je=ne.data,Ze=[],St=this.stride;for(let Rt=0;Rt<je.length;Rt+=St){if(je[Rt+2]<=re)continue;je[Rt+2]=re;const bt=je[Rt],vn=je[Rt+1],An=ne.within(je[Rt],je[Rt+1],Be),kn=je[Rt+Fe];let Pn=kn;for(const $n of An){const jr=$n*St;je[jr+2]>re&&(Pn+=je[jr+Fe])}if(Pn>kn&&Pn>=Oe){let $n,jr=bt*kn,ii=vn*kn,Zi=-1;const Rr=((Rt/St|0)<<5)+(re+1)+this.points.length;for(const xo of An){const wi=xo*St;if(je[wi+2]<=re)continue;je[wi+2]=re;const os=je[wi+Fe];jr+=je[wi]*os,ii+=je[wi+1]*os,je[wi+4]=Rr,be&&($n||($n=this._map(je,Rt,!0),Zi=this.clusterProps.length,this.clusterProps.push($n)),be($n,this._map(je,wi)))}je[Rt+4]=Rr,Ze.push(jr/Pn,ii/Pn,1/0,Rr,-1,Pn),be&&Ze.push(Zi)}else{for(let $n=0;$n<St;$n++)Ze.push(je[Rt+$n]);if(Pn>1)for(const $n of An){const jr=$n*St;if(!(je[jr+2]<=re)){je[jr+2]=re;for(let ii=0;ii<St;ii++)Ze.push(je[jr+ii])}}}}return Ze}_getOriginId(ne){return ne-this.points.length>>5}_getOriginZoom(ne){return(ne-this.points.length)%32}_map(ne,re,ue){if(ne[re+Fe]>1){const Oe=this.clusterProps[ne[re+it]];return ue?Object.assign({},Oe):Oe}const Se=this.points[ne[re+he]].properties,be=this.options.map(Se);return ue&&be===Se?Object.assign({},be):be}}function Wt(Te,ne,re){return{type:"Feature",id:Te[ne+he],properties:rn(Te,ne,re),geometry:{type:"Point",coordinates:[(ue=Te[ne],360*(ue-.5)),Tn(Te[ne+1])]}};var ue}function rn(Te,ne,re){const ue=Te[ne+Fe],Se=ue>=1e4?`${Math.round(ue/1e3)}k`:ue>=1e3?Math.round(ue/100)/10+"k":ue,be=Te[ne+it],Oe=be===-1?{}:Object.assign({},re[be]);return Object.assign(Oe,{cluster:!0,cluster_id:Te[ne+he],point_count:ue,point_count_abbreviated:Se})}function wt(Te){return Te/360+.5}function Kt(Te){const ne=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Tn(Te){const ne=(180-360*Te)*Math.PI/180;return 360*Math.atan(Math.exp(ne))/Math.PI-90}function fn(Te,ne,re,ue){for(var Se,be=ue,Oe=re-ne>>1,Be=re-ne,je=Te[ne],Ze=Te[ne+1],St=Te[re],Rt=Te[re+1],bt=ne+3;bt<re;bt+=3){var vn=Cn(Te[bt],Te[bt+1],je,Ze,St,Rt);if(vn>be)Se=bt,be=vn;else if(vn===be){var An=Math.abs(bt-Oe);An<Be&&(Se=bt,Be=An)}}be>ue&&(Se-ne>3&&fn(Te,ne,Se,ue),Te[Se+2]=be,re-Se>3&&fn(Te,Se,re,ue))}function Cn(Te,ne,re,ue,Se,be){var Oe=Se-re,Be=be-ue;if(Oe!==0||Be!==0){var je=((Te-re)*Oe+(ne-ue)*Be)/(Oe*Oe+Be*Be);je>1?(re=Se,ue=be):je>0&&(re+=Oe*je,ue+=Be*je)}return(Oe=Te-re)*Oe+(Be=ne-ue)*Be}function tn(Te,ne,re,ue){var Se={id:Te===void 0?null:Te,type:ne,geometry:re,tags:ue,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};return(function(be){var Oe=be.geometry,Be=be.type;if(Be==="Point"||Be==="MultiPoint"||Be==="LineString")mr(be,Oe);else if(Be==="Polygon"||Be==="MultiLineString")for(var je=0;je<Oe.length;je++)mr(be,Oe[je]);else if(Be==="MultiPolygon")for(je=0;je<Oe.length;je++)for(var Ze=0;Ze<Oe[je].length;Ze++)mr(be,Oe[je][Ze])})(Se),Se}function mr(Te,ne){for(var re=0;re<ne.length;re+=3)Te.minX=Math.min(Te.minX,ne[re]),Te.minY=Math.min(Te.minY,ne[re+1]),Te.maxX=Math.max(Te.maxX,ne[re]),Te.maxY=Math.max(Te.maxY,ne[re+1])}function hr(Te,ne,re,ue){if(ne.geometry){var Se=ne.geometry.coordinates,be=ne.geometry.type,Oe=Math.pow(re.tolerance/((1<<re.maxZoom)*re.extent),2),Be=[],je=ne.id;if(re.promoteId?je=ne.properties[re.promoteId]:re.generateId&&(je=ue||0),be==="Point")_i(Se,Be);else if(be==="MultiPoint")for(var Ze=0;Ze<Se.length;Ze++)_i(Se[Ze],Be);else if(be==="LineString")Xn(Se,Be,Oe,!1);else if(be==="MultiLineString"){if(re.lineMetrics){for(Ze=0;Ze<Se.length;Ze++)Xn(Se[Ze],Be=[],Oe,!1),Te.push(tn(je,"LineString",Be,ne.properties));return}Er(Se,Be,Oe,!1)}else if(be==="Polygon")Er(Se,Be,Oe,!0);else{if(be!=="MultiPolygon"){if(be==="GeometryCollection"){for(Ze=0;Ze<ne.geometry.geometries.length;Ze++)hr(Te,{id:je,geometry:ne.geometry.geometries[Ze],properties:ne.properties},re,ue);return}throw new Error("Input data is not a valid GeoJSON object.")}for(Ze=0;Ze<Se.length;Ze++){var St=[];Er(Se[Ze],St,Oe,!0),Be.push(St)}}Te.push(tn(je,be,Be,ne.properties))}}function _i(Te,ne){ne.push(Xs(Te[0])),ne.push(xi(Te[1])),ne.push(0)}function Xn(Te,ne,re,ue){for(var Se,be,Oe=0,Be=0;Be<Te.length;Be++){var je=Xs(Te[Be][0]),Ze=xi(Te[Be][1]);ne.push(je),ne.push(Ze),ne.push(0),Be>0&&(Oe+=ue?(Se*Ze-je*be)/2:Math.sqrt(Math.pow(je-Se,2)+Math.pow(Ze-be,2))),Se=je,be=Ze}var St=ne.length-3;ne[2]=1,fn(ne,0,St,re),ne[St+2]=1,ne.size=Math.abs(Oe),ne.start=0,ne.end=ne.size}function Er(Te,ne,re,ue){for(var Se=0;Se<Te.length;Se++){var be=[];Xn(Te[Se],be,re,ue),ne.push(be)}}function Xs(Te){return Te/360+.5}function xi(Te){var ne=Math.sin(Te*Math.PI/180),re=.5-.25*Math.log((1+ne)/(1-ne))/Math.PI;return re<0?0:re>1?1:re}function Zr(Te,ne,re,ue,Se,be,Oe,Be){if(ue/=ne,be>=(re/=ne)&&Oe<ue)return Te;if(Oe<re||be>=ue)return null;for(var je=[],Ze=0;Ze<Te.length;Ze++){var St=Te[Ze],Rt=St.geometry,bt=St.type,vn=Se===0?St.minX:St.minY,An=Se===0?St.maxX:St.maxY;if(vn>=re&&An<ue)je.push(St);else if(!(An<re||vn>=ue)){var kn=[];if(bt==="Point"||bt==="MultiPoint")ni(Rt,kn,re,ue,Se);else if(bt==="LineString")rs(Rt,kn,re,ue,Se,!1,Be.lineMetrics);else if(bt==="MultiLineString")Ms(Rt,kn,re,ue,Se,!1);else if(bt==="Polygon")Ms(Rt,kn,re,ue,Se,!0);else if(bt==="MultiPolygon")for(var Pn=0;Pn<Rt.length;Pn++){var $n=[];Ms(Rt[Pn],$n,re,ue,Se,!0),$n.length&&kn.push($n)}if(kn.length){if(Be.lineMetrics&&bt==="LineString"){for(Pn=0;Pn<kn.length;Pn++)je.push(tn(St.id,bt,kn[Pn],St.tags));continue}bt!=="LineString"&&bt!=="MultiLineString"||(kn.length===1?(bt="LineString",kn=kn[0]):bt="MultiLineString"),bt!=="Point"&&bt!=="MultiPoint"||(bt=kn.length===3?"Point":"MultiPoint"),je.push(tn(St.id,bt,kn,St.tags))}}}return je.length?je:null}function ni(Te,ne,re,ue,Se){for(var be=0;be<Te.length;be+=3){var Oe=Te[be+Se];Oe>=re&&Oe<=ue&&(ne.push(Te[be]),ne.push(Te[be+1]),ne.push(Te[be+2]))}}function rs(Te,ne,re,ue,Se,be,Oe){for(var Be,je,Ze=Wi(Te),St=Se===0?Vr:is,Rt=Te.start,bt=0;bt<Te.length-3;bt+=3){var vn=Te[bt],An=Te[bt+1],kn=Te[bt+2],Pn=Te[bt+3],$n=Te[bt+4],jr=Se===0?vn:An,ii=Se===0?Pn:$n,Zi=!1;Oe&&(Be=Math.sqrt(Math.pow(vn-Pn,2)+Math.pow(An-$n,2))),jr<re?ii>re&&(je=St(Ze,vn,An,Pn,$n,re),Oe&&(Ze.start=Rt+Be*je)):jr>ue?ii<ue&&(je=St(Ze,vn,An,Pn,$n,ue),Oe&&(Ze.start=Rt+Be*je)):_s(Ze,vn,An,kn),ii<re&&jr>=re&&(je=St(Ze,vn,An,Pn,$n,re),Zi=!0),ii>ue&&jr<=ue&&(je=St(Ze,vn,An,Pn,$n,ue),Zi=!0),!be&&Zi&&(Oe&&(Ze.end=Rt+Be*je),ne.push(Ze),Ze=Wi(Te)),Oe&&(Rt+=Be)}var Rr=Te.length-3;vn=Te[Rr],An=Te[Rr+1],kn=Te[Rr+2],(jr=Se===0?vn:An)>=re&&jr<=ue&&_s(Ze,vn,An,kn),Rr=Ze.length-3,be&&Rr>=3&&(Ze[Rr]!==Ze[0]||Ze[Rr+1]!==Ze[1])&&_s(Ze,Ze[0],Ze[1],Ze[2]),Ze.length&&ne.push(Ze)}function Wi(Te){var ne=[];return ne.size=Te.size,ne.start=Te.start,ne.end=Te.end,ne}function Ms(Te,ne,re,ue,Se,be){for(var Oe=0;Oe<Te.length;Oe++)rs(Te[Oe],ne,re,ue,Se,be,!1)}function _s(Te,ne,re,ue){Te.push(ne),Te.push(re),Te.push(ue)}function Vr(Te,ne,re,ue,Se,be){var Oe=(be-ne)/(ue-ne);return Te.push(be),Te.push(re+(Se-re)*Oe),Te.push(1),Oe}function is(Te,ne,re,ue,Se,be){var Oe=(be-re)/(Se-re);return Te.push(ne+(ue-ne)*Oe),Te.push(be),Te.push(1),Oe}function vi(Te,ne){for(var re=[],ue=0;ue<Te.length;ue++){var Se,be=Te[ue],Oe=be.type;if(Oe==="Point"||Oe==="MultiPoint"||Oe==="LineString")Se=Ps(be.geometry,ne);else if(Oe==="MultiLineString"||Oe==="Polygon"){Se=[];for(var Be=0;Be<be.geometry.length;Be++)Se.push(Ps(be.geometry[Be],ne))}else if(Oe==="MultiPolygon")for(Se=[],Be=0;Be<be.geometry.length;Be++){for(var je=[],Ze=0;Ze<be.geometry[Be].length;Ze++)je.push(Ps(be.geometry[Be][Ze],ne));Se.push(je)}re.push(tn(be.id,Oe,Se,be.tags))}return re}function Ps(Te,ne){var re=[];re.size=Te.size,Te.start!==void 0&&(re.start=Te.start,re.end=Te.end);for(var ue=0;ue<Te.length;ue+=3)re.push(Te[ue]+ne,Te[ue+1],Te[ue+2]);return re}function qi(Te,ne){if(Te.transformed)return Te;var re,ue,Se,be=1<<Te.z,Oe=Te.x,Be=Te.y;for(re=0;re<Te.features.length;re++){var je=Te.features[re],Ze=je.geometry,St=je.type;if(je.geometry=[],St===1)for(ue=0;ue<Ze.length;ue+=2)je.geometry.push(ki(Ze[ue],Ze[ue+1],ne,be,Oe,Be));else for(ue=0;ue<Ze.length;ue++){var Rt=[];for(Se=0;Se<Ze[ue].length;Se+=2)Rt.push(ki(Ze[ue][Se],Ze[ue][Se+1],ne,be,Oe,Be));je.geometry.push(Rt)}}return Te.transformed=!0,Te}function ki(Te,ne,re,ue,Se,be){return[Math.round(re*(Te*ue-Se)),Math.round(re*(ne*ue-be))]}function yo(Te,ne,re,ue,Se){for(var be=ne===Se.maxZoom?0:Se.tolerance/((1<<ne)*Se.extent),Oe={features:[],numPoints:0,numSimplified:0,numFeatures:0,source:null,x:re,y:ue,z:ne,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0},Be=0;Be<Te.length;Be++){Oe.numFeatures++,Ks(Oe,Te[Be],be,Se);var je=Te[Be].minX,Ze=Te[Be].minY,St=Te[Be].maxX,Rt=Te[Be].maxY;je<Oe.minX&&(Oe.minX=je),Ze<Oe.minY&&(Oe.minY=Ze),St>Oe.maxX&&(Oe.maxX=St),Rt>Oe.maxY&&(Oe.maxY=Rt)}return Oe}function Ks(Te,ne,re,ue){var Se=ne.geometry,be=ne.type,Oe=[];if(be==="Point"||be==="MultiPoint")for(var Be=0;Be<Se.length;Be+=3)Oe.push(Se[Be]),Oe.push(Se[Be+1]),Te.numPoints++,Te.numSimplified++;else if(be==="LineString")Ai(Oe,Se,Te,re,!1,!1);else if(be==="MultiLineString"||be==="Polygon")for(Be=0;Be<Se.length;Be++)Ai(Oe,Se[Be],Te,re,be==="Polygon",Be===0);else if(be==="MultiPolygon")for(var je=0;je<Se.length;je++){var Ze=Se[je];for(Be=0;Be<Ze.length;Be++)Ai(Oe,Ze[Be],Te,re,!0,Be===0)}if(Oe.length){var St=ne.tags||null;if(be==="LineString"&&ue.lineMetrics){for(var Rt in St={},ne.tags)St[Rt]=ne.tags[Rt];St.mapbox_clip_start=Se.start/Se.size,St.mapbox_clip_end=Se.end/Se.size}var bt={geometry:Oe,type:be==="Polygon"||be==="MultiPolygon"?3:be==="LineString"||be==="MultiLineString"?2:1,tags:St};ne.id!==null&&(bt.id=ne.id),Te.features.push(bt)}}function Ai(Te,ne,re,ue,Se,be){var Oe=ue*ue;if(ue>0&&ne.size<(Se?Oe:ue))re.numPoints+=ne.length/3;else{for(var Be=[],je=0;je<ne.length;je+=3)(ue===0||ne[je+2]>Oe)&&(re.numSimplified++,Be.push(ne[je]),Be.push(ne[je+1])),re.numPoints++;Se&&(function(Ze,St){for(var Rt=0,bt=0,vn=Ze.length,An=vn-2;bt<vn;An=bt,bt+=2)Rt+=(Ze[bt]-Ze[An])*(Ze[bt+1]+Ze[An+1]);if(Rt>0===St)for(bt=0,vn=Ze.length;bt<vn/2;bt+=2){var kn=Ze[bt],Pn=Ze[bt+1];Ze[bt]=Ze[vn-2-bt],Ze[bt+1]=Ze[vn-1-bt],Ze[vn-2-bt]=kn,Ze[vn-1-bt]=Pn}})(Be,be),Te.push(Be)}}function ss(Te,ne){var re=(ne=this.options=(function(Se,be){for(var Oe in be)Se[Oe]=be[Oe];return Se})(Object.create(this.options),ne)).debug;if(re&&console.time("preprocess data"),ne.maxZoom<0||ne.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ne.promoteId&&ne.generateId)throw new Error("promoteId and generateId cannot be used together.");var ue=(function(Se,be){var Oe=[];if(Se.type==="FeatureCollection")for(var Be=0;Be<Se.features.length;Be++)hr(Oe,Se.features[Be],be,Be);else hr(Oe,Se.type==="Feature"?Se:{geometry:Se},be);return Oe})(Te,ne);this.tiles={},this.tileCoords=[],re&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ne.indexMaxZoom,ne.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),ue=(function(Se,be){var Oe=be.buffer/be.extent,Be=Se,je=Zr(Se,1,-1-Oe,Oe,0,-1,2,be),Ze=Zr(Se,1,1-Oe,2+Oe,0,-1,2,be);return(je||Ze)&&(Be=Zr(Se,1,-Oe,1+Oe,0,-1,2,be)||[],je&&(Be=vi(je,1).concat(Be)),Ze&&(Be=Be.concat(vi(Ze,-1)))),Be})(ue,ne),ue.length&&this.splitTile(ue,0,0,0),re&&(ue.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}function ri(Te,ne,re){return 32*((1<<Te)*re+ne)+Te}function Rs(Te,ne){const re=Te.tileID.canonical;if(!this._geoJSONIndex)return ne(null,null);const ue=this._geoJSONIndex.getTile(re.z,re.x,re.y);if(!ue)return ne(null,null);const Se=new class{constructor(Oe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=a.EXTENT,this.length=Oe.length,this._features=Oe}feature(Oe){return new class{constructor(Be){this._feature=Be,this.extent=a.EXTENT,this.type=Be.type,this.properties=Be.tags,"id"in Be&&!isNaN(Be.id)&&(this.id=parseInt(Be.id,10))}loadGeometry(){if(this._feature.type===1){const Be=[];for(const je of this._feature.geometry)Be.push([new a.Point(je[0],je[1])]);return Be}{const Be=[];for(const je of this._feature.geometry){const Ze=[];for(const St of je)Ze.push(new a.Point(St[0],St[1]));Be.push(Ze)}return Be}}toGeoJSON(Be,je,Ze){return Z.call(this,Be,je,Ze)}}(this._features[Oe])}}(ue.features);let be=pt(Se);be.byteOffset===0&&be.byteLength===be.buffer.byteLength||(be=new Uint8Array(be)),ne(null,{vectorTile:Se,rawData:be.buffer})}ss.prototype.options={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0},ss.prototype.splitTile=function(Te,ne,re,ue,Se,be,Oe){for(var Be=[Te,ne,re,ue],je=this.options,Ze=je.debug;Be.length;){ue=Be.pop(),re=Be.pop(),ne=Be.pop(),Te=Be.pop();var St=1<<ne,Rt=ri(ne,re,ue),bt=this.tiles[Rt];if(!bt&&(Ze>1&&console.time("creation"),bt=this.tiles[Rt]=yo(Te,ne,re,ue,je),this.tileCoords.push({z:ne,x:re,y:ue}),Ze)){Ze>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ne,re,ue,bt.numFeatures,bt.numPoints,bt.numSimplified),console.timeEnd("creation"));var vn="z"+ne;this.stats[vn]=(this.stats[vn]||0)+1,this.total++}if(bt.source=Te,Se){if(ne===je.maxZoom||ne===Se)continue;var An=1<<Se-ne;if(re!==Math.floor(be/An)||ue!==Math.floor(Oe/An))continue}else if(ne===je.indexMaxZoom||bt.numPoints<=je.indexMaxPoints)continue;if(bt.source=null,Te.length!==0){Ze>1&&console.time("clipping");var kn,Pn,$n,jr,ii,Zi,Rr=.5*je.buffer/je.extent,xo=.5-Rr,wi=.5+Rr,os=1+Rr;kn=Pn=$n=jr=null,ii=Zr(Te,St,re-Rr,re+wi,0,bt.minX,bt.maxX,je),Zi=Zr(Te,St,re+xo,re+os,0,bt.minX,bt.maxX,je),Te=null,ii&&(kn=Zr(ii,St,ue-Rr,ue+wi,1,bt.minY,bt.maxY,je),Pn=Zr(ii,St,ue+xo,ue+os,1,bt.minY,bt.maxY,je),ii=null),Zi&&($n=Zr(Zi,St,ue-Rr,ue+wi,1,bt.minY,bt.maxY,je),jr=Zr(Zi,St,ue+xo,ue+os,1,bt.minY,bt.maxY,je),Zi=null),Ze>1&&console.timeEnd("clipping"),Be.push(kn||[],ne+1,2*re,2*ue),Be.push(Pn||[],ne+1,2*re,2*ue+1),Be.push($n||[],ne+1,2*re+1,2*ue),Be.push(jr||[],ne+1,2*re+1,2*ue+1)}}},ss.prototype.getTile=function(Te,ne,re){var ue=this.options,Se=ue.extent,be=ue.debug;if(Te<0||Te>24)return null;var Oe=1<<Te,Be=ri(Te,ne=(ne%Oe+Oe)%Oe,re);if(this.tiles[Be])return qi(this.tiles[Be],Se);be>1&&console.log("drilling down to z%d-%d-%d",Te,ne,re);for(var je,Ze=Te,St=ne,Rt=re;!je&&Ze>0;)Ze--,St=Math.floor(St/2),Rt=Math.floor(Rt/2),je=this.tiles[ri(Ze,St,Rt)];return je&&je.source?(be>1&&console.log("found parent tile z%d-%d-%d",Ze,St,Rt),be>1&&console.time("drilling down"),this.splitTile(je.source,Ze,St,Rt,Te,ne,re),be>1&&console.timeEnd("drilling down"),this.tiles[Be]?qi(this.tiles[Be],Se):null):null};class Ys extends a.VectorTileWorkerSource{constructor(ne,re,ue,Se,be){super(ne,re,ue,Se,Rs),be&&(this.loadGeoJSON=be)}loadData(ne,re){const ue=ne&&ne.request,Se=ue&&ue.collectResourceTiming;this.loadGeoJSON(ne,((be,Oe)=>{if(be||!Oe)return re(be);if(typeof Oe!="object")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));{H(Oe,!0);try{if(ne.filter){const je=a.createExpression(ne.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(je.result==="error")throw new Error(je.value.map((St=>`${St.key}: ${St.message}`)).join(", "));Oe={type:"FeatureCollection",features:Oe.features.filter((St=>je.value.evaluate({zoom:0},St)))}}this._geoJSONIndex=ne.cluster?new vt((function({superclusterOptions:je,clusterProperties:Ze}){if(!Ze||!je)return je;const St={},Rt={},bt={accumulated:null,zoom:0},vn={properties:null},An=Object.keys(Ze);for(const kn of An){const[Pn,$n]=Ze[kn],jr=a.createExpression($n),ii=a.createExpression(typeof Pn=="string"?[Pn,["accumulated"],["get",kn]]:Pn);St[kn]=jr.value,Rt[kn]=ii.value}return je.map=kn=>{vn.properties=kn;const Pn={};for(const $n of An)Pn[$n]=St[$n].evaluate(bt,vn);return Pn},je.reduce=(kn,Pn)=>{vn.properties=Pn;for(const $n of An)bt.accumulated=kn[$n],kn[$n]=Rt[$n].evaluate(bt,vn)},je})(ne)).load(Oe.features):(function(je,Ze){return new ss(je,Ze)})(Oe,ne.geojsonVtOptions)}catch(je){return re(je)}this.loaded={};const Be={};if(Se){const je=a.getPerformanceMeasurement(ue);je&&(Be.resourceTiming={},Be.resourceTiming[ne.source]=JSON.parse(JSON.stringify(je)))}re(null,Be)}}))}reloadTile(ne,re){const ue=this.loaded;return ue&&ue[ne.uid]?super.reloadTile(ne,re):this.loadTile(ne,re)}loadGeoJSON(ne,re){if(ne.request)a.getJSON(ne.request,re);else{if(typeof ne.data!="string")return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`));try{return re(null,JSON.parse(ne.data))}catch{return re(new Error(`Input data given to '${ne.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(ne,re){try{re(null,this._geoJSONIndex.getClusterExpansionZoom(ne.clusterId))}catch(ue){re(ue)}}getClusterChildren(ne,re){try{re(null,this._geoJSONIndex.getChildren(ne.clusterId))}catch(ue){re(ue)}}getClusterLeaves(ne,re){try{re(null,this._geoJSONIndex.getLeaves(ne.clusterId,ne.limit,ne.offset))}catch(ue){re(ue)}}}class _o{constructor(ne){this.self=ne,this.actor=new a.Actor(ne,this),this.layerIndexes={},this.availableImages={},this.isSpriteLoaded={},this.projections={},this.defaultProjection=a.getProjection({name:"mercator"}),this.workerSourceTypes={vector:a.VectorTileWorkerSource,geojson:Ys},this.workerSources={},this.demWorkerSources={},this.self.registerWorkerSource=(re,ue)=>{if(this.workerSourceTypes[re])throw new Error(`Worker source with name "${re}" already registered.`);this.workerSourceTypes[re]=ue},this.self.registerRTLTextPlugin=re=>{if(a.plugin.isParsed())throw new Error("RTL text plugin already registered.");a.plugin.applyArabicShaping=re.applyArabicShaping,a.plugin.processBidirectionalText=re.processBidirectionalText,a.plugin.processStyledBidirectionalText=re.processStyledBidirectionalText}}clearCaches(ne,re,ue){delete this.layerIndexes[ne],delete this.availableImages[ne],delete this.workerSources[ne],delete this.demWorkerSources[ne],ue()}checkIfReady(ne,re,ue){ue()}setReferrer(ne,re){this.referrer=re}spriteLoaded(ne,re){this.isSpriteLoaded[ne]=re;for(const ue in this.workerSources[ne]){const Se=this.workerSources[ne][ue];for(const be in Se)Se[be]instanceof a.VectorTileWorkerSource&&(Se[be].isSpriteLoaded=re,Se[be].fire(new a.Event("isSpriteLoaded")))}}setImages(ne,re,ue){this.availableImages[ne]=re;for(const Se in this.workerSources[ne]){const be=this.workerSources[ne][Se];for(const Oe in be)be[Oe].availableImages=re}ue()}enableTerrain(ne,re,ue){this.terrain=re,ue()}setProjection(ne,re){this.projections[ne]=a.getProjection(re)}setLayers(ne,re,ue){this.getLayerIndex(ne).replace(re),ue()}updateLayers(ne,re,ue){this.getLayerIndex(ne).update(re.layers,re.removedIds),ue()}loadTile(ne,re,ue){const Se=this.enableTerrain?a.extend({enableTerrain:this.terrain},re):re;Se.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).loadTile(Se,ue)}loadDEMTile(ne,re,ue){const Se=this.enableTerrain?a.extend({buildQuadTree:this.terrain},re):re;this.getDEMWorkerSource(ne,re.source).loadTile(Se,ue)}reloadTile(ne,re,ue){const Se=this.enableTerrain?a.extend({enableTerrain:this.terrain},re):re;Se.projection=this.projections[ne]||this.defaultProjection,this.getWorkerSource(ne,re.type,re.source).reloadTile(Se,ue)}abortTile(ne,re,ue){this.getWorkerSource(ne,re.type,re.source).abortTile(re,ue)}removeTile(ne,re,ue){this.getWorkerSource(ne,re.type,re.source).removeTile(re,ue)}removeSource(ne,re,ue){if(!this.workerSources[ne]||!this.workerSources[ne][re.type]||!this.workerSources[ne][re.type][re.source])return;const Se=this.workerSources[ne][re.type][re.source];delete this.workerSources[ne][re.type][re.source],Se.removeSource!==void 0?Se.removeSource(re,ue):ue()}loadWorkerSource(ne,re,ue){try{this.self.importScripts(re.url),ue()}catch(Se){ue(Se.toString())}}syncRTLPluginState(ne,re,ue){try{a.plugin.setState(re);const Se=a.plugin.getPluginURL();if(a.plugin.isLoaded()&&!a.plugin.isParsed()&&Se!=null){this.self.importScripts(Se);const be=a.plugin.isParsed();ue(be?void 0:new Error(`RTL Text Plugin failed to import scripts from ${Se}`),be)}}catch(Se){ue(Se.toString())}}getAvailableImages(ne){let re=this.availableImages[ne];return re||(re=[]),re}getLayerIndex(ne){let re=this.layerIndexes[ne];return re||(re=this.layerIndexes[ne]=new L),re}getWorkerSource(ne,re,ue){if(this.workerSources[ne]||(this.workerSources[ne]={}),this.workerSources[ne][re]||(this.workerSources[ne][re]={}),!this.workerSources[ne][re][ue]){const Se={send:(be,Oe,Be,je,Ze,St)=>{this.actor.send(be,Oe,Be,ne,Ze,St)},scheduler:this.actor.scheduler};this.workerSources[ne][re][ue]=new this.workerSourceTypes[re](Se,this.getLayerIndex(ne),this.getAvailableImages(ne),this.isSpriteLoaded[ne])}return this.workerSources[ne][re][ue]}getDEMWorkerSource(ne,re){return this.demWorkerSources[ne]||(this.demWorkerSources[ne]={}),this.demWorkerSources[ne][re]||(this.demWorkerSources[ne][re]=new z),this.demWorkerSources[ne][re]}enforceCacheSizeLimit(ne,re){a.enforceCacheSizeLimit(re)}getWorkerPerformanceMetrics(ne,re,ue){ue(void 0,void 0)}}return typeof WorkerGlobalScope<"u"&&typeof self<"u"&&self instanceof WorkerGlobalScope&&(self.worker=new _o(self)),_o})),v(["./shared"],(function(a){function k(g,o){if(Array.isArray(g)){if(!Array.isArray(o)||g.length!==o.length)return!1;for(let h=0;h<g.length;h++)if(!k(g[h],o[h]))return!1;return!0}if(typeof g=="object"&&g!==null&&o!==null){if(typeof o!="object"||Object.keys(g).length!==Object.keys(o).length)return!1;for(const h in g)if(!k(g[h],o[h]))return!1;return!0}return g===o}var M=L;function L(g){return!(function(o){return typeof window>"u"||typeof document>"u"?"not a browser":Array.prototype&&Array.prototype.every&&Array.prototype.filter&&Array.prototype.forEach&&Array.prototype.indexOf&&Array.prototype.lastIndexOf&&Array.prototype.map&&Array.prototype.some&&Array.prototype.reduce&&Array.prototype.reduceRight&&Array.isArray?Function.prototype&&Function.prototype.bind?Object.keys&&Object.create&&Object.getPrototypeOf&&Object.getOwnPropertyNames&&Object.isSealed&&Object.isFrozen&&Object.isExtensible&&Object.getOwnPropertyDescriptor&&Object.defineProperty&&Object.defineProperties&&Object.seal&&Object.freeze&&Object.preventExtensions?"JSON"in window&&"parse"in JSON&&"stringify"in JSON?(function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var _,T,C=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(C);try{T=new Worker(N),_=!0}catch{_=!1}return T&&T.terminate(),URL.revokeObjectURL(N),_})()?"Uint8ClampedArray"in window?ArrayBuffer.isView?(function(){var _=document.createElement("canvas");_.width=_.height=1;var T=_.getContext("2d");if(!T)return!1;var C=T.getImageData(0,0,1,1);return C&&C.width===_.width})()?(z[h=o&&o.failIfMajorPerformanceCaveat]===void 0&&(z[h]=(function(_){var T,C=(function(N){var D=document.createElement("canvas"),B=Object.create(L.webGLContextAttributes);return B.failIfMajorPerformanceCaveat=N,D.getContext("webgl",B)||D.getContext("experimental-webgl",B)})(_);if(!C)return!1;try{T=C.createShader(C.VERTEX_SHADER)}catch{return!1}return!(!T||C.isContextLost())&&(C.shaderSource(T,"void main() {}"),C.compileShader(T),C.getShaderParameter(T,C.COMPILE_STATUS)===!0)})(h)),z[h]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL support"):"insufficient Canvas/getImageData support":"insufficient ArrayBuffer support":"insufficient Uint8ClampedArray support":"insufficient worker support":"insufficient JSON support":"insufficient Object support":"insufficient Function support":"insufficent Array support";var h})(g)}var z={};function O(g,o,h){const _=a.window.document.createElement(g);return o!==void 0&&(_.className=o),h&&h.appendChild(_),_}function K(g,o,h){const _=a.window.document.createElementNS("http://www.w3.org/2000/svg",g);for(const T of Object.keys(o))_.setAttributeNS(null,T,o[T]);return h&&h.appendChild(_),_}L.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0};const H=a.window.document&&a.window.document.documentElement.style,Z=H&&H.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Y;function ee(){H&&Z&&(Y=H[Z],H[Z]="none")}function ie(){H&&Z&&(H[Z]=Y)}function pe(g){g.preventDefault(),g.stopPropagation(),a.window.removeEventListener("click",pe,!0)}function we(){a.window.addEventListener("click",pe,!0),a.window.setTimeout((()=>{a.window.removeEventListener("click",pe,!0)}),0)}function ke(g,o){const h=g.getBoundingClientRect();return tt(g,h,o)}function ze(g,o){const h=g.getBoundingClientRect(),_=[];for(let T=0;T<o.length;T++)_.push(tt(g,h,o[T]));return _}function Ge(g){return a.window.InstallTrigger!==void 0&&g.button===2&&g.ctrlKey&&a.window.navigator.platform.toUpperCase().indexOf("MAC")>=0?0:g.button}function tt(g,o,h){const _=g.offsetWidth===o.width?1:g.offsetWidth/o.width;return new a.Point((h.clientX-o.left)*_,(h.clientY-o.top)*_)}function Pe(g,o){var h=o[0],_=o[1],T=o[2],C=o[3],N=h*C-T*_;return N?(g[0]=C*(N=1/N),g[1]=-_*N,g[2]=-T*N,g[3]=h*N,g):null}function ot(g){const{userImage:o}=g;return!!(o&&o.render&&o.render())&&(g.data.replace(new Uint8Array(o.data.buffer)),!0)}class ut extends a.Evented{constructor(){super(),this.images={},this.updatedImages={},this.callbackDispatchedThisFrame={},this.loaded=!1,this.requestors=[],this.patterns={},this.atlasImage=new a.RGBAImage({width:1,height:1}),this.dirty=!0}isLoaded(){return this.loaded}setLoaded(o){if(this.loaded!==o&&(this.loaded=o,o)){for(const{ids:h,callback:_}of this.requestors)this._notify(h,_);this.requestors=[]}}hasImage(o){return!!this.getImage(o)}getImage(o){return this.images[o]}addImage(o,h){this._validate(o,h)&&(this.images[o]=h)}_validate(o,h){let _=!0;return this._validateStretch(h.stretchX,h.data&&h.data.width)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchX" value`))),_=!1),this._validateStretch(h.stretchY,h.data&&h.data.height)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "stretchY" value`))),_=!1),this._validateContent(h.content,h)||(this.fire(new a.ErrorEvent(new Error(`Image "${o}" has invalid "content" value`))),_=!1),_}_validateStretch(o,h){if(!o)return!0;let _=0;for(const T of o){if(T[0]<_||T[1]<T[0]||h<T[1])return!1;_=T[1]}return!0}_validateContent(o,h){return!(o&&(o.length!==4||o[0]<0||h.data.width<o[0]||o[1]<0||h.data.height<o[1]||o[2]<0||h.data.width<o[2]||o[3]<0||h.data.height<o[3]||o[2]<o[0]||o[3]<o[1]))}updateImage(o,h){h.version=this.images[o].version+1,this.images[o]=h,this.updatedImages[o]=!0}removeImage(o){const h=this.images[o];delete this.images[o],delete this.patterns[o],h.userImage&&h.userImage.onRemove&&h.userImage.onRemove()}listImages(){return Object.keys(this.images)}getImages(o,h){let _=!0;if(!this.isLoaded())for(const T of o)this.images[T]||(_=!1);this.isLoaded()||_?this._notify(o,h):this.requestors.push({ids:o,callback:h})}_notify(o,h){const _={};for(const T of o){this.images[T]||this.fire(new a.Event("styleimagemissing",{id:T}));const C=this.images[T];C?_[T]={data:C.data.clone(),pixelRatio:C.pixelRatio,sdf:C.sdf,version:C.version,stretchX:C.stretchX,stretchY:C.stretchY,content:C.content,hasRenderCallback:!!(C.userImage&&C.userImage.render)}:a.warnOnce(`Image "${T}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`)}h(null,_)}getPixelSize(){const{width:o,height:h}=this.atlasImage;return{width:o,height:h}}getPattern(o){const h=this.patterns[o],_=this.getImage(o);if(!_)return null;if(h&&h.position.version===_.version)return h.position;if(h)h.position.version=_.version;else{const T={w:_.data.width+2,h:_.data.height+2,x:0,y:0},C=new a.ImagePosition(T,_);this.patterns[o]={bin:T,position:C}}return this._updatePatternAtlas(),this.patterns[o].position}bind(o){const h=o.gl;this.atlasTexture?this.dirty&&(this.atlasTexture.update(this.atlasImage),this.dirty=!1):this.atlasTexture=new a.Texture(o,this.atlasImage,h.RGBA),this.atlasTexture&&this.atlasTexture.bind(h.LINEAR,h.CLAMP_TO_EDGE)}_updatePatternAtlas(){const o=[];for(const C in this.patterns)o.push(this.patterns[C].bin);const{w:h,h:_}=a.potpack(o),T=this.atlasImage;T.resize({width:h||1,height:_||1});for(const C in this.patterns){const{bin:N}=this.patterns[C],D=N.x+1,B=N.y+1,G=this.images[C].data,$=G.width,J=G.height;a.RGBAImage.copy(G,T,{x:0,y:0},{x:D,y:B},{width:$,height:J}),a.RGBAImage.copy(G,T,{x:0,y:J-1},{x:D,y:B-1},{width:$,height:1}),a.RGBAImage.copy(G,T,{x:0,y:0},{x:D,y:B+J},{width:$,height:1}),a.RGBAImage.copy(G,T,{x:$-1,y:0},{x:D-1,y:B},{width:1,height:J}),a.RGBAImage.copy(G,T,{x:0,y:0},{x:D+$,y:B},{width:1,height:J})}this.dirty=!0}beginFrame(){this.callbackDispatchedThisFrame={}}dispatchRenderCallbacks(o){for(const h of o){if(this.callbackDispatchedThisFrame[h])continue;this.callbackDispatchedThisFrame[h]=!0;const _=this.images[h];ot(_)&&this.updateImage(h,_)}}}const gt=new a.Properties({anchor:new a.DataConstantProperty(a.spec.light.anchor),position:new class{constructor(){this.specification=a.spec.light.position}possiblyEvaluate(g,o){return(function([h,_,T]){const C=a.degToRad(_+90),N=a.degToRad(T);return{x:h*Math.cos(C)*Math.sin(N),y:h*Math.sin(C)*Math.sin(N),z:h*Math.cos(N),azimuthal:_,polar:T}})(g.expression.evaluate(o))}interpolate(g,o,h){return{x:a.number(g.x,o.x,h),y:a.number(g.y,o.y,h),z:a.number(g.z,o.z,h),azimuthal:a.number(g.azimuthal,o.azimuthal,h),polar:a.number(g.polar,o.polar,h)}}},color:new a.DataConstantProperty(a.spec.light.color),intensity:new a.DataConstantProperty(a.spec.light.intensity)});class ht extends a.Evented{constructor(o){super(),this._transitionable=new a.Transitionable(gt),this.setLight(o),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,h={}){if(!this._validate(a.validateLight,o,h))for(const _ in o){const T=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),T):this._transitionable.setValue(_,T)}}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}const Lt=new a.Properties({source:new a.DataConstantProperty(a.spec.terrain.source),exaggeration:new a.DataConstantProperty(a.spec.terrain.exaggeration)});let mt=class extends a.Evented{constructor(g,o){super(),this._transitionable=new a.Transitionable(Lt),this.set(g),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o}get(){return this._transitionable.serialize()}set(g){for(const o in g){const h=g[o];a.endsWith(o,"-transition")?this._transitionable.setTransition(o.slice(0,-11),h):this._transitionable.setValue(o,h)}}updateTransitions(g){this._transitioning=this._transitionable.transitioned(g,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(g){this.properties=this._transitioning.possiblyEvaluate(g)}};function pt(g,o,h,_){const T=a.smoothstep(45,65,h),[C,N]=Ae(g,_),D=a.length(o);let B=1-Math.min(1,Math.exp((D-C)/(N-C)*-6));return B*=B*B,B=Math.min(1,1.00747*B),B*T*g.alpha}function Ae(g,o){const h=.5/Math.tan(.5*o);return[g.range[0]+h,g.range[1]+h]}const xe=new a.Properties({range:new a.DataConstantProperty(a.spec.fog.range),color:new a.DataConstantProperty(a.spec.fog.color),"high-color":new a.DataConstantProperty(a.spec.fog["high-color"]),"space-color":new a.DataConstantProperty(a.spec.fog["space-color"]),"horizon-blend":new a.DataConstantProperty(a.spec.fog["horizon-blend"]),"star-intensity":new a.DataConstantProperty(a.spec.fog["star-intensity"])});class We extends a.Evented{constructor(o,h){super(),this._transitionable=new a.Transitionable(xe),this.set(o),this._transitioning=this._transitionable.untransitioned(),this._transform=h}get state(){const o=this._transform,h=o.projection.name==="globe",_=a.globeToMercatorTransition(o.zoom),T=this.properties.get("range"),C=[.5,3];return{range:h?[a.number(C[0],T[0],_),a.number(C[1],T[1],_)]:T,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,h={}){if(!this._validate(a.validateFog,o,h)){for(const _ of Object.keys(a.spec.fog))o&&o[_]===void 0&&(o[_]=a.spec.fog[_].default);for(const _ in o){const T=o[_];a.endsWith(_,"-transition")?this._transitionable.setTransition(_.slice(0,-11),T):this._transitionable.setValue(_,T)}}}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const h=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:a.smoothstep(45,65,o))*h.a}getOpacityAtLatLng(o,h){return this._transform.projection.supportsFog?(function(_,T,C){const N=a.MercatorCoordinate.fromLngLat(T),D=C.elevation?C.elevation.getAtPointOrZero(N):0,B=[N.x,N.y,D];return a.transformMat4(B,B,C.mercatorFogMatrix),pt(_,B,C.pitch,C._fov)})(this.state,o,h):0}getFovAdjustedRange(o){return this._transform.projection.supportsFog?Ae(this.state,o):[0,1]}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,h,_){return(!_||_.validate!==!1)&&a.emitValidationErrors(this,o.call(a.validateStyle,a.extend({value:h,style:{glyphs:!0,sprite:!0},styleSpec:a.spec})))}}class he{constructor(o,h){this.workerPool=o,this.actors=[],this.currentActor=0,this.id=a.uniqueId();const _=this.workerPool.acquire(this.id);for(let T=0;T<_.length;T++){const C=new he.Actor(_[T],h,this.id);C.name=`Worker ${T}`,this.actors.push(C)}this.ready=!1,this.broadcast("checkIfReady",null,(()=>{this.ready=!0}))}broadcast(o,h,_){a.asyncAll(this.actors,((T,C)=>{T.send(o,h,C)}),_=_||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach((o=>{o.remove()})),this.actors=[],this.workerPool.release(this.id)}}function Fe(g,o,h){return o*(a.EXTENT/(g.tileSize*Math.pow(2,h-g.tileID.overscaledZ)))}he.Actor=a.Actor;class it{constructor(o,h,_,T){this.screenBounds=o,this.cameraPoint=h,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=_,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,T)}static createFromScreenPoints(o,h){let _,T;if(o instanceof a.Point||typeof o[0]=="number"){const C=a.Point.convert(o);_=[C],T=h.isPointAboveHorizon(C)}else{const C=a.Point.convert(o[0]),N=a.Point.convert(o[1]);_=[C,N],T=a.polygonizeBounds(C,N).every((D=>h.isPointAboveHorizon(D)))}return new it(_,h.getCameraPoint(),T,h)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return a.polygonizeBounds(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],T=a.polygonizeBounds(h,_,0,!1);return this.cameraPoint.y>_.y&&(this.cameraPoint.x>h.x&&this.cameraPoint.x<_.x?T.splice(3,0,this.cameraPoint):this.cameraPoint.x>=_.x?T[2]=this.cameraPoint:this.cameraPoint.x<=h.x&&(T[3]=this.cameraPoint)),a.bufferConvexPolygon(T,o)}bufferedCameraGeometryGlobe(o){const h=this.screenBounds[0],_=this.screenBounds.length===1?this.screenBounds[0].add(new a.Point(1,1)):this.screenBounds[1],T=a.polygonizeBounds(h,_,o),C=this.cameraPoint.clone();switch(3*((C.y>h.y)+(C.y>_.y))+((C.x>h.x)+(C.x>_.x))){case 0:T[0]=C,T[4]=C.clone();break;case 1:T.splice(1,0,C);break;case 2:T[1]=C;break;case 3:T.splice(4,0,C);break;case 5:T.splice(2,0,C);break;case 6:T[3]=C;break;case 7:T.splice(3,0,C);break;case 8:T[2]=C}return T}containsTile(o,h,_,T=0){const C=o.queryPadding/h._pixelsPerMercatorPixel+1,N=_?this._bufferedCameraMercator(C,h):this._bufferedScreenMercator(C,h);let D=o.tileID.wrap+(N.unwrapped?T:0);const B=N.polygon.map((me=>a.getTilePoint(o.tileTransform,me,D)));if(!a.polygonIntersectsBox(B,0,0,a.EXTENT,a.EXTENT))return;D=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?T:0);const G=this.screenGeometryMercator.polygon.map((me=>a.getTileVec3(o.tileTransform,me,D))),$=G.map((me=>new a.Point(me[0],me[1]))),J=h.getFreeCameraOptions().position||new a.MercatorCoordinate(0,0,0),oe=a.getTileVec3(o.tileTransform,J,D),ce=G.map((me=>{const Q=a.sub(me,me,oe);return a.normalize(Q,Q),new a.Ray(oe,Q)})),fe=Fe(o,1,h.zoom)*h._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:$,tilespaceRays:ce,bufferedTilespaceGeometry:B,bufferedTilespaceBounds:(de=a.getBounds(B),de.min.x=a.clamp(de.min.x,0,a.EXTENT),de.min.y=a.clamp(de.min.y,0,a.EXTENT),de.max.x=a.clamp(de.max.x,0,a.EXTENT),de.max.y=a.clamp(de.max.y,0,a.EXTENT),de),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:fe};var de}_bufferedScreenMercator(o,h){const _=rn(o);if(this._screenRaycastCache[_])return this._screenRaycastCache[_];{let T;return T=h.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),h):{polygon:this.bufferedScreenGeometry(o).map((C=>h.pointCoordinate3D(C))),unwrapped:!0},this._screenRaycastCache[_]=T,T}}_bufferedCameraMercator(o,h){const _=rn(o);if(this._cameraRaycastCache[_])return this._cameraRaycastCache[_];{let T;return T=h.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),h):{polygon:this.bufferedCameraGeometry(o).map((C=>h.pointCoordinate3D(C))),unwrapped:!0},this._cameraRaycastCache[_]=T,T}}_projectAndResample(o,h){const _=(function(C,N){const D=a.multiply([],N.pixelMatrix,N.globeMatrix),B=[0,-a.GLOBE_RADIUS,0,1],G=[0,a.GLOBE_RADIUS,0,1],$=[0,0,0,1];a.transformMat4$1(B,B,D),a.transformMat4$1(G,G,D),a.transformMat4$1($,$,D);const J=new a.Point(B[0]/B[3],B[1]/B[3]),oe=new a.Point(G[0]/G[3],G[1]/G[3]),ce=a.polygonContainsPoint(C,J)&&B[3]<$[3],fe=a.polygonContainsPoint(C,oe)&&G[3]<$[3];if(!ce&&!fe)return null;const de=(function(De,$e,Ue){for(let Ye=1;Ye<De.length;Ye++){const kt=Wt($e.pointCoordinate3D(De[Ye-1]).x),qe=Wt($e.pointCoordinate3D(De[Ye]).x);if(Ue<0){if(kt<qe)return{idx:Ye,t:-kt/(qe-1-kt)}}else if(qe<kt)return{idx:Ye,t:(1-kt)/(qe+1-kt)}}return null})(C,N,ce?-1:1);if(!de)return null;const{idx:me,t:Q}=de;let le=me>1?vt(C.slice(0,me),N):[],_e=me<C.length?vt(C.slice(me),N):[];le=le.map((De=>new a.Point(Wt(De.x),De.y))),_e=_e.map((De=>new a.Point(Wt(De.x),De.y)));const ve=[...le];ve.length===0&&ve.push(_e[_e.length-1]);const Ne=a.number(ve[ve.length-1].y,(_e.length===0?le[0]:_e[0]).y,Q);let Le;return Le=ce?[new a.Point(0,Ne),new a.Point(0,0),new a.Point(1,0),new a.Point(1,Ne)]:[new a.Point(1,Ne),new a.Point(1,1),new a.Point(0,1),new a.Point(0,Ne)],ve.push(...Le),_e.length===0?ve.push(le[0]):ve.push(..._e),{polygon:ve.map((De=>new a.MercatorCoordinate(De.x,De.y))),unwrapped:!1}})(o,h);if(_)return _;const T=(function(C,N){let D=!1,B=-1/0,G=0;for(let J=0;J<C.length-1;J++)C[J].x>B&&(B=C[J].x,G=J);for(let J=0;J<C.length-1;J++){const oe=(G+J)%(C.length-1),ce=C[oe],fe=C[oe+1];Math.abs(ce.x-fe.x)>.5&&(ce.x<fe.x?(ce.x+=1,oe===0&&(C[C.length-1].x+=1)):(fe.x+=1,oe+1===C.length-1&&(C[0].x+=1)),D=!0)}const $=a.mercatorXfromLng(N.center.lng);return D&&$<Math.abs($-1)&&C.forEach((J=>{J.x-=1})),{polygon:C,unwrapped:D}})(vt(o,h).map((C=>new a.Point(Wt(C.x),C.y))),h);return{polygon:T.polygon.map((C=>new a.MercatorCoordinate(C.x,C.y))),unwrapped:T.unwrapped}}}function vt(g,o){return a.resample(g,(h=>{const _=o.pointCoordinate3D(h);h.x=_.x,h.y=_.y}),1/256)}function Wt(g){return g<0?1+g%1:g%1}function rn(g){return 100*g|0}function wt(g,o,h,_,T){const C=function(N,D){if(N)return T(N);if(D){g.url&&D.tiles&&g.tiles&&delete g.tiles;const B=a.pick(a.extend(D,g),["tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","scheme","tileSize","encoding"]);D.vector_layers&&(B.vectorLayers=D.vector_layers,B.vectorLayerIds=B.vectorLayers.map((G=>G.id))),B.tiles=o.canonicalizeTileset(B,g.url),T(null,B)}};return g.url?a.getJSON(o.transformRequest(o.normalizeSourceURL(g.url,null,h,_),a.ResourceType.Source),C):a.exported.frame((()=>C(null,g)))}class Kt{constructor(o,h,_){this.bounds=a.LngLatBounds.convert(this.validateBounds(o)),this.minzoom=h||0,this.maxzoom=_||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}contains(o){const h=Math.pow(2,o.z),_=Math.floor(a.mercatorXfromLng(this.bounds.getWest())*h),T=Math.floor(a.mercatorYfromLat(this.bounds.getNorth())*h),C=Math.ceil(a.mercatorXfromLng(this.bounds.getEast())*h),N=Math.ceil(a.mercatorYfromLat(this.bounds.getSouth())*h);return o.x>=_&&o.x<C&&o.y>=T&&o.y<N}}class Tn{constructor(o,h,_){this.context=o;const T=o.gl;this.buffer=T.createBuffer(),this.dynamicDraw=!!_,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),T.bufferData(T.ELEMENT_ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?T.DYNAMIC_DRAW:T.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.context.unbindVAO(),this.bind(),h.bufferSubData(h.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}const fn={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class Cn{constructor(o,h,_,T){this.length=h.length,this.attributes=_,this.itemSize=h.bytesPerElement,this.dynamicDraw=T,this.context=o;const C=o.gl;this.buffer=C.createBuffer(),o.bindVertexBuffer.set(this.buffer),C.bufferData(C.ARRAY_BUFFER,h.arrayBuffer,this.dynamicDraw?C.DYNAMIC_DRAW:C.STATIC_DRAW),this.dynamicDraw||h.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const h=this.context.gl;this.bind(),h.bufferSubData(h.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,h){for(let _=0;_<this.attributes.length;_++){const T=h.attributes[this.attributes[_].name];T!==void 0&&o.enableVertexAttribArray(T)}}setVertexAttribPointers(o,h,_){for(let T=0;T<this.attributes.length;T++){const C=this.attributes[T],N=h.attributes[C.name];N!==void 0&&o.vertexAttribPointer(N,C.components,o[fn[C.type]],!1,this.itemSize,C.offset+this.itemSize*(_||0))}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class tn{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class mr extends tn{getDefault(){return a.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class hr extends tn{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class _i extends tn{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class Xn extends tn{getDefault(){return[!0,!0,!0,!0]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Er extends tn{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class Xs extends tn{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class xi extends tn{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const h=this.current;(o.func!==h.func||o.ref!==h.ref||o.mask!==h.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class Zr extends tn{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class ni extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.STENCIL_TEST):h.disable(h.STENCIL_TEST),this.current=o,this.dirty=!1}}class rs extends tn{getDefault(){return[0,1]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class Wi extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.DEPTH_TEST):h.disable(h.DEPTH_TEST),this.current=o,this.dirty=!1}}class Ms extends tn{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class _s extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.BLEND):h.disable(h.BLEND),this.current=o,this.dirty=!1}}class Vr extends tn{getDefault(){const o=this.gl;return[o.ONE,o.ZERO]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||this.dirty)&&(this.gl.blendFunc(o[0],o[1]),this.current=o,this.dirty=!1)}}class is extends tn{getDefault(){return a.Color.transparent}set(o){const h=this.current;(o.r!==h.r||o.g!==h.g||o.b!==h.b||o.a!==h.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class vi extends tn{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquation(o),this.current=o,this.dirty=!1)}}class Ps extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;o?h.enable(h.CULL_FACE):h.disable(h.CULL_FACE),this.current=o,this.dirty=!1}}class qi extends tn{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class ki extends tn{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let yo,Ks=class extends tn{getDefault(){return null}set(g){(g!==this.current||this.dirty)&&(this.gl.useProgram(g),this.current=g,this.dirty=!1)}};class Ai extends tn{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class ss extends tn{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const h=this.current;(o[0]!==h[0]||o[1]!==h[1]||o[2]!==h[2]||o[3]!==h[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class ri extends tn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindFramebuffer(h.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Rs extends tn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindRenderbuffer(h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Ys extends tn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindTexture(h.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class _o extends tn{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.bindBuffer(h.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class Te extends tn{getDefault(){return null}set(o){const h=this.gl;h.bindBuffer(h.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class ne extends tn{constructor(o){super(o),this.vao=o.extVertexArrayObject}getDefault(){return null}set(o){this.vao&&(o!==this.current||this.dirty)&&(this.vao.bindVertexArrayOES(o),this.current=o,this.dirty=!1)}}class re extends tn{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class ue extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Se extends tn{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const h=this.gl;h.pixelStorei(h.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class be extends tn{constructor(o,h){super(o),this.context=o,this.parent=h}getDefault(){return null}}class Oe extends be{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Be extends be{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const h=this.gl;h.framebufferRenderbuffer(h.FRAMEBUFFER,this.attachment(),h.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class je extends Be{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}class Ze{constructor(o,h,_,T){this.context=o,this.width=h,this.height=_;const C=this.framebuffer=o.gl.createFramebuffer();this.colorAttachment=new Oe(o,C),T&&(this.depthAttachment=new Be(o,C))}destroy(){const o=this.context.gl,h=this.colorAttachment.get();if(h&&o.deleteTexture(h),this.depthAttachment){const _=this.depthAttachment.get();_&&o.deleteRenderbuffer(_)}o.deleteFramebuffer(this.framebuffer)}}class St{constructor(o,h=!1){if(this.gl=o,this.isWebGL2=h,this.extVertexArrayObject=this.gl.getExtension("OES_vertex_array_object"),h){const _=o;this.extVertexArrayObject={createVertexArrayOES:_.createVertexArray.bind(o),deleteVertexArrayOES:_.deleteVertexArray.bind(o),bindVertexArrayOES:_.bindVertexArray.bind(o)}}this.clearColor=new mr(this),this.clearDepth=new hr(this),this.clearStencil=new _i(this),this.colorMask=new Xn(this),this.depthMask=new Er(this),this.stencilMask=new Xs(this),this.stencilFunc=new xi(this),this.stencilOp=new Zr(this),this.stencilTest=new ni(this),this.depthRange=new rs(this),this.depthTest=new Wi(this),this.depthFunc=new Ms(this),this.blend=new _s(this),this.blendFunc=new Vr(this),this.blendColor=new is(this),this.blendEquation=new vi(this),this.cullFace=new Ps(this),this.cullFaceSide=new qi(this),this.frontFace=new ki(this),this.program=new Ks(this),this.activeTexture=new Ai(this),this.viewport=new ss(this),this.bindFramebuffer=new ri(this),this.bindRenderbuffer=new Rs(this),this.bindTexture=new Ys(this),this.bindVertexBuffer=new _o(this),this.bindElementBuffer=new Te(this),this.bindVertexArrayOES=this.extVertexArrayObject&&new ne(this),this.pixelStoreUnpack=new re(this),this.pixelStoreUnpackPremultiplyAlpha=new ue(this),this.pixelStoreUnpackFlipY=new Se(this),this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT)),this.extTextureFilterAnisotropicForceOff=!1,this.extStandardDerivativesForceOff=!1,this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),h||(this.extTextureHalfFloat=o.getExtension("OES_texture_half_float")),(h||this.extTextureHalfFloat&&o.getExtension("OES_texture_half_float_linear"))&&(this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float")),this.extStandardDerivatives=h||o.getExtension("OES_standard_derivatives"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE)}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.extVertexArrayObject&&(this.bindVertexArrayOES.dirty=!0),this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,h){return new Tn(this,o,h)}createVertexBuffer(o,h,_){return new Cn(this,o,h,_)}createRenderbuffer(o,h,_){const T=this.gl,C=T.createRenderbuffer();return this.bindRenderbuffer.set(C),T.renderbufferStorage(T.RENDERBUFFER,o,h,_),this.bindRenderbuffer.set(null),C}createFramebuffer(o,h,_){return new Ze(this,o,h,_)}clear({color:o,depth:h,stencil:_}){const T=this.gl;let C=0;o&&(C|=T.COLOR_BUFFER_BIT,this.clearColor.set(o),this.colorMask.set([!0,!0,!0,!0])),h!==void 0&&(C|=T.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(h),this.depthMask.set(!0)),_!==void 0&&(C|=T.STENCIL_BUFFER_BIT,this.clearStencil.set(_),this.stencilMask.set(255)),T.clear(C)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){k(o.blendFunction,a.ColorMode.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor)),this.colorMask.set(o.mask)}unbindVAO(){this.extVertexArrayObject&&this.bindVertexArrayOES.set(null)}}class Rt extends a.Evented{constructor(o,h,_,T){if(super(),this.id=o,this.dispatcher=_,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,a.extend(this,a.pick(h,["url","scheme","tileSize","promoteId"])),this._options=a.extend({type:"vector"},h),this._collectResourceTiming=h.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(T),this._tileWorkers={},this._deduped=new a.DedupedRequest}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"}));const h=Array.isArray(this.map._language)?this.map._language.join():this.map._language,_=this.map._worldview;this._tileJSONRequest=wt(this._options,this.map._requestManager,h,_,((T,C)=>{this._tileJSONRequest=null,this._loaded=!0,T?(h&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${h}`),_&&_.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${_}`),this.fire(new a.ErrorEvent(T))):C&&(a.extend(this,C),C.bounds&&(this.tileBounds=new Kt(C.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(C.tiles,this.map._requestManager._customAccessToken),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(T)}))}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}loadTile(o,h){const _=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme)),T={request:this.map._requestManager.transformRequest(_,a.ResourceType.Tile),data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile};if(T.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=h:o.request=o.actor.send("reloadTile",T,C.bind(this));else if(o.actor=this._tileWorkers[_]=this._tileWorkers[_]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",T,C.bind(this),void 0,!0);else{const N=a.loadVectorTile.call({deduped:this._deduped},T,((D,B)=>{D||!B?C.call(this,D):(T.data={cacheControl:B.cacheControl,expires:B.expires,rawData:B.rawData.slice(0)},o.actor&&o.actor.send("loadTile",T,C.bind(this),void 0,!0))}),!0);o.request={cancel:N}}function C(N,D){return delete o.request,o.aborted?h(null):N&&N.status!==404?h(N):(D&&D.resourceTiming&&(o.resourceTiming=D.resourceTiming),this.map._refreshExpiredTiles&&D&&o.setExpiryData(D),o.loadVectorData(D,this.map.painter),a.cacheEntryPossiblyAdded(this.dispatcher),h(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id})}unloadTile(o){o.unloadVectorData(),o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id})}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class bt extends a.Evented{constructor(o,h,_,T){super(),this.id=o,this.dispatcher=_,this.setEventedParent(T),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=a.extend({type:"raster"},h),a.extend(this,a.pick(h,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._tileJSONRequest=wt(this._options,this.map._requestManager,null,null,((h,_)=>{this._tileJSONRequest=null,this._loaded=!0,h?this.fire(new a.ErrorEvent(h)):_&&(a.extend(this,_),_.bounds&&(this.tileBounds=new Kt(_.bounds,this.minzoom,this.maxzoom)),a.postTurnstileEvent(_.tiles),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))),o&&o(h)}))}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest(),this.load((()=>this.map.style._clearSource(this.id)))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(){this.cancelTileJSONRequest()}serialize(){return a.extend({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,h){const _=a.exported.devicePixelRatio>=2,T=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),_,this.tileSize);o.request=a.getImage(this.map._requestManager.transformRequest(T,a.ResourceType.Tile),((C,N,D,B)=>(delete o.request,o.aborted?(o.state="unloaded",h(null)):C?(o.state="errored",h(C)):N?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:D,expires:B}),o.setTexture(N,this.map.painter),o.state="loaded",a.cacheEntryPossiblyAdded(this.dispatcher),void h(null)):h(null))))}static loadTileData(o,h,_){o.setTexture(h,_)}static unloadTileData(o,h){o.texture&&h.saveTileTexture(o.texture)}abortTile(o,h){o.request&&(o.request.cancel(),delete o.request),h()}unloadTile(o,h){o.texture&&this.map.painter.saveTileTexture(o.texture),h()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}function vn(g,o,h,_,T,C,N,D){const B=[g,h,T,o,_,C,1,1,1],G=[N,D,1],$=a.adjoint([],B),[J,oe,ce]=a.transformMat3(G,G,a.transpose($,$));return a.multiply$1(B,[J,0,0,0,oe,0,0,0,ce],B)}class An extends a.Evented{constructor(o,h,_,T){super(),this.id=o,this.dispatcher=_,this.coordinates=h.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.setEventedParent(T),this.options=h,this._dirty=!1}load(o,h){this._loaded=h||!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this.url=this.options.url,this._imageRequest=a.getImage(this.map._requestManager.transformRequest(this.url,a.ResourceType.Image),((_,T)=>{if(this._imageRequest=null,this._loaded=!0,_)this.fire(new a.ErrorEvent(_));else if(T){const{HTMLImageElement:C}=a.window;this.image=T instanceof C?a.exported.getImageData(T):T,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,o&&(this.coordinates=o),this._finishLoading()}}))}loaded(){return this._loaded}updateImage(o){return this.image&&o.url?(this._imageRequest&&o.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=o.url,this.load(o.coordinates,this._loaded),this):this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(o){this.map=o,this.load()}onRemove(){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),this.texture&&this.texture.destroy()}setCoordinates(o){this.coordinates=o,this._boundsArray=void 0;const h=o.map(a.MercatorCoordinate.fromLngLat);return this.tileID=(function(_){let T=1/0,C=1/0,N=-1/0,D=-1/0;for(const J of _)T=Math.min(T,J.x),C=Math.min(C,J.y),N=Math.max(N,J.x),D=Math.max(D,J.y);const B=Math.max(N-T,D-C),G=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),$=Math.pow(2,G);return new a.CanonicalTileID(G,Math.floor((T+N)/2*$),Math.floor((C+D)/2*$))})(h),this.minzoom=this.maxzoom=this.tileID.z,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0}_prepareData(o){for(const B in this.tiles){const G=this.tiles[B];G.state!=="loaded"&&(G.state="loaded",G.texture=this.texture)}if(this._boundsArray)return;const h=a.tileTransform(this.tileID,this.map.transform.projection),[_,T,C,N]=this.coordinates.map((B=>{const G=h.projection.project(B[0],B[1]);return a.getTilePoint(h,G)._round()}));this.perspectiveTransform=(function(B,G,$,J,oe,ce,fe,de,me,Q){const le=vn(0,0,B,0,0,G,B,G),_e=vn($,J,oe,ce,fe,de,me,Q);return a.multiply$1(_e,a.adjoint(le,le),_e),[_e[6]/_e[8]*B/a.EXTENT,_e[7]/_e[8]*G/a.EXTENT]})(this.width,this.height,_.x,_.y,T.x,T.y,N.x,N.y,C.x,C.y);const D=this._boundsArray=new a.StructArrayLayout4i8;D.emplaceBack(_.x,_.y,0,0),D.emplaceBack(T.x,T.y,a.EXTENT,0),D.emplaceBack(N.x,N.y,0,a.EXTENT),D.emplaceBack(C.x,C.y,a.EXTENT,a.EXTENT),this.boundsBuffer&&this.boundsBuffer.destroy(),this.boundsBuffer=o.createVertexBuffer(D,a.boundsAttributes.members),this.boundsSegments=a.SegmentVector.simpleSegment(0,0,4,2)}prepare(){if(Object.keys(this.tiles).length===0||!this.image)return;const o=this.map.painter.context,h=o.gl;this._dirty&&(this.texture?this.texture.update(this.image):(this.texture=new a.Texture(o,this.image,h.RGBA),this.texture.bind(h.LINEAR,h.CLAMP_TO_EDGE)),this._dirty=!1),this._prepareData(o)}loadTile(o,h){this.tileID&&this.tileID.equals(o.tileID.canonical)?(this.tiles[String(o.tileID.wrap)]=o,o.buckets={},h(null)):(o.state="errored",h(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}}const kn={vector:Rt,raster:bt,"raster-dem":class extends bt{constructor(g,o,h,_){super(g,o,h,_),this.type="raster-dem",this.maxzoom=22,this._options=a.extend({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(g,o){const h=this.map._requestManager.normalizeTileURL(g.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function _(T,C){T&&(g.state="errored",o(T)),C&&(g.dem=C,g.dem.onDeserialize(),g.needsHillshadePrepare=!0,g.needsDEMTextureUpload=!0,g.state="loaded",o(null))}g.request=a.getImage(this.map._requestManager.transformRequest(h,a.ResourceType.Tile),(function(T,C,N,D){if(delete g.request,g.aborted)g.state="unloaded",o(null);else if(T)g.state="errored",o(T);else if(C){this.map._refreshExpiredTiles&&g.setExpiryData({cacheControl:N,expires:D});const B=a.window.ImageBitmap&&C instanceof a.window.ImageBitmap&&(yo==null&&(yo=a.window.OffscreenCanvas&&new a.window.OffscreenCanvas(1,1).getContext("2d")&&typeof a.window.createImageBitmap=="function"),yo),G=1-(C.width-a.prevPowerOfTwo(C.width))/2;G<1||g.neighboringTiles||(g.neighboringTiles=this._getNeighboringTiles(g.tileID));const $=B?C:a.exported.getImageData(C,G),J={uid:g.uid,coord:g.tileID,source:this.id,rawImageData:$,encoding:this.encoding,padding:G};g.actor&&g.state!=="expired"||(g.actor=this.dispatcher.getActor(),g.actor.send("loadDEMTile",J,_.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(g){const o=g.canonical,h=Math.pow(2,o.z),_=(o.x-1+h)%h,T=o.x===0?g.wrap-1:g.wrap,C=(o.x+1+h)%h,N=o.x+1===h?g.wrap+1:g.wrap,D={};return D[new a.OverscaledTileID(g.overscaledZ,T,o.z,_,o.y).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,N,o.z,C,o.y).key]={backfilled:!1},o.y>0&&(D[new a.OverscaledTileID(g.overscaledZ,T,o.z,_,o.y-1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,g.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,N,o.z,C,o.y-1).key]={backfilled:!1}),o.y+1<h&&(D[new a.OverscaledTileID(g.overscaledZ,T,o.z,_,o.y+1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,g.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},D[new a.OverscaledTileID(g.overscaledZ,N,o.z,C,o.y+1).key]={backfilled:!1}),D}unloadTile(g){g.demTexture&&this.map.painter.saveTileTexture(g.demTexture),g.fbo&&(g.fbo.destroy(),delete g.fbo),g.dem&&delete g.dem,delete g.neighboringTiles,g.state="unloaded"}},geojson:class extends a.Evented{constructor(g,o,h,_){super(),this.id=g,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=h.getActor(),this.setEventedParent(_),this._data=o.data,this._options=a.extend({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const T=a.EXTENT/this.tileSize;this.workerOptions=a.extend({source:this.id,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*T,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*T,extent:a.EXTENT,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:a.EXTENT,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*T,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter},o.workerOptions)}onAdd(g){this.map=g,this.setData(this._data)}setData(g){return this._data=g,this._updateWorkerData(),this}getClusterExpansionZoom(g,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:g,source:this.id},o),this}getClusterChildren(g,o){return this.actor.send("geojson.getClusterChildren",{clusterId:g,source:this.id},o),this}getClusterLeaves(g,o,h,_){return this.actor.send("geojson.getClusterLeaves",{source:this.id,clusterId:g,limit:o,offset:h},_),this}_updateWorkerData(){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new a.Event("dataloading",{dataType:"source"})),this._loaded=!1;const g=a.extend({},this.workerOptions),o=this._data;typeof o=="string"?(g.request=this.map._requestManager.transformRequest(a.exported.resolveURL(o),a.ResourceType.Source),g.request.collectResourceTiming=this._collectResourceTiming):g.data=JSON.stringify(o),this._pendingLoad=this.actor.send(`${this.type}.loadData`,g,((h,_)=>{if(this._loaded=!0,this._pendingLoad=null,h)this.fire(new a.ErrorEvent(h));else{const T={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&_&&_.resourceTiming&&_.resourceTiming[this.id]&&(T.resourceTiming=_.resourceTiming[this.id]),this.fire(new a.Event("data",T)),this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(),this._coalesce=!1)}))}loaded(){return this._loaded}loadTile(g,o){const h=g.actor?"reloadTile":"loadTile";g.actor=this.actor,g.request=this.actor.send(h,{type:this.type,uid:g.uid,tileID:g.tileID,tileZoom:g.tileZoom,zoom:g.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,pixelRatio:a.exported.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId},((_,T)=>(delete g.request,g.unloadVectorData(),g.aborted?o(null):_?o(_):(g.loadVectorData(T,this.map.painter,h==="reloadTile"),o(null)))),void 0,h==="loadTile")}abortTile(g){g.request&&(g.request.cancel(),delete g.request),g.aborted=!0}unloadTile(g){g.unloadVectorData(),this.actor.send("removeTile",{uid:g.uid,type:this.type,source:this.id})}onRemove(){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return a.extend({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends An{constructor(g,o,h,_){super(g,o,h,_),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const g=this.options;this.urls=[];for(const o of g.urls)this.urls.push(this.map._requestManager.transformRequest(o,a.ResourceType.Source).url);a.getVideo(this.urls,((o,h)=>{this._loaded=!0,o?this.fire(new a.ErrorEvent(o)):h&&(this.video=h,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",(()=>{this.map.triggerRepaint()})),this.map&&this.video.play(),this._finishLoading())}))}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(g){if(this.video){const o=this.video.seekable;g<o.start(0)||g>o.end(0)?this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=g}}getVideo(){return this.video}onAdd(g){this.map||(this.map=g,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const g=this.map.painter.context,o=g.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new a.Texture(g,this.video,o.RGBA),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(g)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:An,canvas:class extends An{constructor(g,o,h,_){super(g,o,h,_),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some((T=>!Array.isArray(T)||T.length!==2||T.some((C=>typeof C!="number"))))||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof a.window.HTMLCanvasElement||this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new a.ErrorEvent(new a.ValidationError(`sources.${g}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof a.window.HTMLCanvasElement?this.options.canvas:a.window.document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new a.ErrorEvent(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(g){this.map=g,this.load(),this.canvas&&this.animate&&this.play()}onRemove(){this.pause()}prepare(){let g=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,g=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,g=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?(g||this._playing)&&this.texture.update(this.canvas,{premultiply:!0}):this.texture=new a.Texture(o,this.canvas,o.gl.RGBA,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const g of[this.canvas.width,this.canvas.height])if(isNaN(g)||g<=0)return!0;return!1}},custom:class extends a.Evented{constructor(g,o,h,_){super(),this.id=g,this.type="custom",this._dataType="raster",this._dispatcher=h,this._implementation=o,this.setEventedParent(_),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new a.ErrorEvent(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new a.ErrorEvent(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new Kt(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),a.extend(this,a.pick(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return a.pick(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new a.Event("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(g){this._map=g,this._loaded=!1,this.fire(new a.Event("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(g),this.load()}onRemove(g){this._implementation.onRemove&&this._implementation.onRemove(g)}hasTile(g){if(this._implementation.hasTile){const{x:o,y:h,z:_}=g.canonical;return this._implementation.hasTile({x:o,y:h,z:_})}return!this.tileBounds||this.tileBounds.contains(g.canonical)}loadTile(g,o){const{x:h,y:_,z:T}=g.tileID.canonical,C=new a.window.AbortController;g.request=Promise.resolve(this._implementation.loadTile({x:h,y:_,z:T},{signal:C.signal})).then((function(N){return delete g.request,g.aborted?(g.state="unloaded",o(null)):N===void 0?(g.state="errored",o(null)):N===null?(this.loadTileData(g,{width:this.tileSize,height:this.tileSize,data:null}),g.state="loaded",o(null)):(function(D){return D instanceof a.window.ImageData||D instanceof a.window.HTMLCanvasElement||D instanceof a.window.ImageBitmap||D instanceof a.window.HTMLImageElement})(N)?(this.loadTileData(g,N),g.state="loaded",void o(null)):(g.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch((N=>{N.code!==20&&(g.state="errored",o(N))})),g.request.cancel=()=>C.abort()}loadTileData(g,o){bt.loadTileData(g,o,this._map.painter)}unloadTileData(g){bt.unloadTileData(g,this._map.painter)}unloadTile(g,o){if(this.unloadTileData(g),this._implementation.unloadTile){const{x:h,y:_,z:T}=g.tileID.canonical;this._implementation.unloadTile({x:h,y:_,z:T})}o()}abortTile(g,o){g.request&&g.request.cancel&&(g.request.cancel(),delete g.request),o()}hasTransition(){return!1}_coveringTiles(){return this._map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map((g=>({x:g.canonical.x,y:g.canonical.y,z:g.canonical.z})))}_clearTiles(){this._map.style._clearSource(this.id)}_update(){this.fire(new a.Event("data",{dataType:"source",sourceDataType:"content"}))}}},Pn=function(g,o,h,_){const T=new kn[o.type](g,o,h,_);if(T.id!==g)throw new Error(`Expected Source id to be ${g} instead of ${T.id}`);return a.bindAll(["load","abort","unload","serialize","prepare"],T),T};function $n(g,o){const h=a.identity([]);return a.scale(h,h,[.5*g.width,.5*-g.height,1]),a.translate(h,h,[1,-1,0]),a.multiply(h,h,g.calculateProjMatrix(o.toUnwrapped())),Float32Array.from(h)}function jr(g,o,h,_,T,C,N,D=!1){const B=g.tilesIn(_,N,D);B.sort(Zi);const G=[];for(const J of B)G.push({wrappedTileID:J.tile.tileID.wrapped().key,queryResults:J.tile.queryRenderedFeatures(o,h,g._state,J,T,C,$n(g.transform,J.tile.tileID),D)});const $=(function(J){const oe={},ce={};for(const fe of J){const de=fe.queryResults,me=fe.wrappedTileID,Q=ce[me]=ce[me]||{};for(const le in de){const _e=de[le],ve=Q[le]=Q[le]||{},Ne=oe[le]=oe[le]||[];for(const Le of _e)ve[Le.featureIndex]||(ve[Le.featureIndex]=!0,Ne.push(Le))}}return oe})(G);for(const J in $)$[J].forEach((oe=>{const ce=oe.feature,fe=ce.layer;fe&&fe.type!=="background"&&fe.type!=="sky"&&(ce.source=fe.source,fe["source-layer"]&&(ce.sourceLayer=fe["source-layer"]),ce.state=ce.id!==void 0?g.getFeatureState(fe["source-layer"],ce.id):{})}));return $}function ii(g,o){const h=g.getRenderableIds().map((C=>g.getTileByID(C))),_=[],T={};for(let C=0;C<h.length;C++){const N=h[C],D=N.tileID.canonical.key;T[D]||(T[D]=!0,N.querySourceFeatures(_,o))}return _}function Zi(g,o){const h=g.tileID,_=o.tileID;return h.overscaledZ-_.overscaledZ||h.canonical.y-_.canonical.y||h.wrap-_.wrap||h.canonical.x-_.canonical.x}function Rr(){return Va.workerClass!=null?new Va.workerClass:new a.window.Worker(Va.workerUrl)}const xo="mapboxgl_preloaded_worker_pool";class wi{constructor(){this.active={}}acquire(o){if(!this.workers)for(this.workers=[];this.workers.length<wi.workerCount;)this.workers.push(new Rr);return this.active[o]=!0,this.workers.slice()}release(o){delete this.active[o],this.numActive()===0&&(this.workers.forEach((h=>{h.terminate()})),this.workers=null)}isPreloaded(){return!!this.active[xo]}numActive(){return Object.keys(this.active).length}}let os;function ll(){return os||(os=new wi),os}function up(g,o){const h={};for(const _ in g)_!=="ref"&&(h[_]=g[_]);return a.refProperties.forEach((_=>{_ in o&&(h[_]=o[_])})),h}function Ch(g){g=g.slice();const o=Object.create(null);for(let h=0;h<g.length;h++)o[g[h].id]=g[h];for(let h=0;h<g.length;h++)"ref"in g[h]&&(g[h]=up(g[h],o[g[h].ref]));return g}wi.workerCount=2;const nr={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setProjection:"setProjection"};function kh(g,o,h){h.push({command:nr.addSource,args:[g,o[g]]})}function Qc(g,o,h){o.push({command:nr.removeSource,args:[g]}),h[g]=!0}function Ur(g,o,h,_){Qc(g,h,_),kh(g,o,h)}function nd(g,o,h){let _;for(_ in g[h])if(g[h].hasOwnProperty(_)&&_!=="data"&&!k(g[h][_],o[h][_]))return!1;for(_ in o[h])if(o[h].hasOwnProperty(_)&&_!=="data"&&!k(g[h][_],o[h][_]))return!1;return!0}function Js(g,o,h,_,T,C){let N;for(N in o=o||{},g=g||{})g.hasOwnProperty(N)&&(k(g[N],o[N])||h.push({command:C,args:[_,N,o[N],T]}));for(N in o)o.hasOwnProperty(N)&&!g.hasOwnProperty(N)&&(k(g[N],o[N])||h.push({command:C,args:[_,N,o[N],T]}))}function Bo(g){return g.id}function Zl(g,o){return g[o.id]=o,g}class Ah{constructor(o,h){this.reset(o,h)}reset(o,h){this.points=o||[],this._distances=[0];for(let _=1;_<this.points.length;_++)this._distances[_]=this._distances[_-1]+this.points[_].dist(this.points[_-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(h||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=a.clamp(o,0,1);let h=1,_=this._distances[h];const T=o*this.paddedLength+this.padding;for(;_<T&&h<this._distances.length;)_=this._distances[++h];const C=h-1,N=this._distances[C],D=_-N,B=D>0?(T-N)/D:0;return this.points[C].mult(1-B).add(this.points[h].mult(B))}}class ka{constructor(o,h,_){const T=this.boxCells=[],C=this.circleCells=[];this.xCellCount=Math.ceil(o/_),this.yCellCount=Math.ceil(h/_);for(let N=0;N<this.xCellCount*this.yCellCount;N++)T.push([]),C.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=h,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/h,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,h,_,T,C){this._forEachCell(h,_,T,C,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(h),this.bboxes.push(_),this.bboxes.push(T),this.bboxes.push(C)}insertCircle(o,h,_,T){this._forEachCell(h-T,_-T,h+T,_+T,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(h),this.circles.push(_),this.circles.push(T)}_insertBoxCell(o,h,_,T,C,N){this.boxCells[C].push(N)}_insertCircleCell(o,h,_,T,C,N){this.circleCells[C].push(N)}_query(o,h,_,T,C,N){if(_<0||o>this.width||T<0||h>this.height)return!C&&[];const D=[];if(o<=0&&h<=0&&this.width<=_&&this.height<=T){if(C)return!0;for(let B=0;B<this.boxKeys.length;B++)D.push({key:this.boxKeys[B],x1:this.bboxes[4*B],y1:this.bboxes[4*B+1],x2:this.bboxes[4*B+2],y2:this.bboxes[4*B+3]});for(let B=0;B<this.circleKeys.length;B++){const G=this.circles[3*B],$=this.circles[3*B+1],J=this.circles[3*B+2];D.push({key:this.circleKeys[B],x1:G-J,y1:$-J,x2:G+J,y2:$+J})}return N?D.filter(N):D}return this._forEachCell(o,h,_,T,this._queryCell,D,{hitTest:C,seenUids:{box:{},circle:{}}},N),C?D.length>0:D}_queryCircle(o,h,_,T,C){const N=o-_,D=o+_,B=h-_,G=h+_;if(D<0||N>this.width||G<0||B>this.height)return!T&&[];const $=[];return this._forEachCell(N,B,D,G,this._queryCellCircle,$,{hitTest:T,circle:{x:o,y:h,radius:_},seenUids:{box:{},circle:{}}},C),T?$.length>0:$}query(o,h,_,T,C){return this._query(o,h,_,T,!1,C)}hitTest(o,h,_,T,C){return this._query(o,h,_,T,!0,C)}hitTestCircle(o,h,_,T){return this._queryCircle(o,h,_,!0,T)}_queryCell(o,h,_,T,C,N,D,B){const G=D.seenUids,$=this.boxCells[C];if($!==null){const oe=this.bboxes;for(const ce of $)if(!G.box[ce]){G.box[ce]=!0;const fe=4*ce;if(o<=oe[fe+2]&&h<=oe[fe+3]&&_>=oe[fe+0]&&T>=oe[fe+1]&&(!B||B(this.boxKeys[ce]))){if(D.hitTest)return N.push(!0),!0;N.push({key:this.boxKeys[ce],x1:oe[fe],y1:oe[fe+1],x2:oe[fe+2],y2:oe[fe+3]})}}}const J=this.circleCells[C];if(J!==null){const oe=this.circles;for(const ce of J)if(!G.circle[ce]){G.circle[ce]=!0;const fe=3*ce;if(this._circleAndRectCollide(oe[fe],oe[fe+1],oe[fe+2],o,h,_,T)&&(!B||B(this.circleKeys[ce]))){if(D.hitTest)return N.push(!0),!0;{const de=oe[fe],me=oe[fe+1],Q=oe[fe+2];N.push({key:this.circleKeys[ce],x1:de-Q,y1:me-Q,x2:de+Q,y2:me+Q})}}}}}_queryCellCircle(o,h,_,T,C,N,D,B){const G=D.circle,$=D.seenUids,J=this.boxCells[C];if(J!==null){const ce=this.bboxes;for(const fe of J)if(!$.box[fe]){$.box[fe]=!0;const de=4*fe;if(this._circleAndRectCollide(G.x,G.y,G.radius,ce[de+0],ce[de+1],ce[de+2],ce[de+3])&&(!B||B(this.boxKeys[fe])))return N.push(!0),!0}}const oe=this.circleCells[C];if(oe!==null){const ce=this.circles;for(const fe of oe)if(!$.circle[fe]){$.circle[fe]=!0;const de=3*fe;if(this._circlesCollide(ce[de],ce[de+1],ce[de+2],G.x,G.y,G.radius)&&(!B||B(this.circleKeys[fe])))return N.push(!0),!0}}}_forEachCell(o,h,_,T,C,N,D,B){const G=this._convertToXCellCoord(o),$=this._convertToYCellCoord(h),J=this._convertToXCellCoord(_),oe=this._convertToYCellCoord(T);for(let ce=G;ce<=J;ce++)for(let fe=$;fe<=oe;fe++)if(C.call(this,o,h,_,T,this.xCellCount*fe+ce,N,D,B))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,h,_,T,C,N){const D=T-o,B=C-h,G=_+N;return G*G>D*D+B*B}_circleAndRectCollide(o,h,_,T,C,N,D){const B=(N-T)/2,G=Math.abs(o-(T+B));if(G>B+_)return!1;const $=(D-C)/2,J=Math.abs(h-(C+$));if(J>$+_)return!1;if(G<=B||J<=$)return!0;const oe=G-B,ce=J-$;return oe*oe+ce*ce<=_*_}}const Qs={unknown:0,flipRequired:1,flipNotRequired:2},xs=Math.tan(85*Math.PI/180);function dt(g,o,h,_,T,C,N){const D=a.create();if(h)if(C.name==="globe"){const B=a.calculateGlobeLabelMatrix(T,o);a.multiply(D,D,B)}else{const B=Pe([],N);D[0]=B[0],D[1]=B[1],D[4]=B[2],D[5]=B[3],_||a.rotateZ(D,D,T.angle)}else a.multiply(D,T.labelPlaneMatrix,g);return D}function bi(g,o,h,_,T,C,N){const D=dt(g,o,h,_,T,C,N);return C.name==="globe"&&h||(D[2]=D[6]=D[10]=D[14]=0),D}function si(g,o,h,_,T,C,N){if(h){if(C.name==="globe"){const D=dt(g,o,h,_,T,C,N);return a.invert(D,D),a.multiply(D,g,D),D}{const D=a.clone(g),B=a.identity([]);return B[0]=N[0],B[1]=N[1],B[4]=N[2],B[5]=N[3],a.multiply(D,D,B),_||a.rotateZ(D,D,-T.angle),D}}return T.glCoordMatrix}function Ii(g,o,h,_){const T=[g,o,h,1];h?a.transformMat4$1(T,T,_):Rn(T,T,_);const C=T[3];return T[0]/=C,T[1]/=C,T[2]/=C,T}function dp(g,o){return Math.min(.5+g/o*.5,1.5)}function Ns(g,o){const h=g[0]/g[3],_=g[1]/g[3];return h>=-o[0]&&h<=o[0]&&_>=-o[1]&&_<=o[1]}function Xl(g,o,h,_,T,C,N,D,B,G){const $=h.transform,J=_?g.textSizeData:g.iconSizeData,oe=a.evaluateSizeForZoom(J,h.transform.zoom),ce=$.projection.name==="globe",fe=[256/h.width*2+1,256/h.height*2+1],de=_?g.text.dynamicLayoutVertexArray:g.icon.dynamicLayoutVertexArray;de.clear();let me=null;ce&&(me=_?g.text.globeExtVertexArray:g.icon.globeExtVertexArray);const Q=g.lineVertexArray,le=_?g.text.placedSymbolArray:g.icon.placedSymbolArray,_e=h.transform.width/h.transform.height;let ve,Ne=!1;for(let Le=0;Le<le.length;Le++){const De=le.get(Le),{numGlyphs:$e,writingMode:Ue}=De;if(Ue!==a.WritingMode.vertical||Ne||ve===a.WritingMode.horizontal||(Ne=!0),ve=Ue,(De.hidden||Ue===a.WritingMode.vertical)&&!Ne){Ds($e,de);continue}Ne=!1;const Ye=new a.Point(De.tileAnchorX,De.tileAnchorY);let{x:kt,y:qe,z:at}=$.projection.projectTilePoint(Ye.x,Ye.y,G.canonical);if(B){const[yn,qt,un]=B(Ye);kt+=yn,qe+=qt,at+=un}const Je=[kt,qe,at,1];if(a.transformMat4$1(Je,Je,o),!Ns(Je,fe)){Ds($e,de);continue}const Et=dp(h.transform.cameraToCenterDistance,Je[3]),Ke=a.evaluateSizeForFeature(J,oe,De),lt=N?Ke/Et:Ke*Et,Tt=Ii(kt,qe,at,T);if(Tt[3]<=0){Ds($e,de);continue}let xt={};const At=N?null:B,Qt=Ut(De,lt,!1,D,o,T,C,g.glyphOffsetArray,Q,de,me,Tt,Ye,xt,_e,At,$.projection,G,N);Ne=Qt.useVertical,At&&Qt.needsFlipping&&(xt={}),(Qt.notEnoughRoom||Ne||Qt.needsFlipping&&Ut(De,lt,!0,D,o,T,C,g.glyphOffsetArray,Q,de,me,Tt,Ye,xt,_e,At,$.projection,G,N).notEnoughRoom)&&Ds($e,de)}_?(g.text.dynamicLayoutVertexBuffer.updateData(de),me&&g.text.globeExtVertexBuffer.updateData(me)):(g.icon.dynamicLayoutVertexBuffer.updateData(de),me&&g.icon.globeExtVertexBuffer.updateData(me))}function Kl(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de){const{lineStartIndex:me,glyphStartIndex:Q,segment:le}=D,_e=Q+D.numGlyphs,ve=me+D.lineLength,Ne=o.getoffsetX(Q),Le=o.getoffsetX(_e-1),De=vs(g*Ne,h,_,T,C,N,le,me,ve,B,G,$,J,oe,!0,ce,fe,de);if(!De)return null;const $e=vs(g*Le,h,_,T,C,N,le,me,ve,B,G,$,J,oe,!0,ce,fe,de);return $e?{first:De,last:$e}:null}function ia(g,o,h,_){return g===a.WritingMode.horizontal&&Math.abs(_)>Math.abs(h)?{useVertical:!0}:g===a.WritingMode.vertical?_>0?{needsFlipping:!0}:null:o!==Qs.unknown&&(function(T,C){return T===0||Math.abs(C/T)>xs})(h,_)?o===Qs.flipRequired?{needsFlipping:!0}:null:h<0?{needsFlipping:!0}:null}function Ut(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de,me,Q,le){const _e=o/24,ve=g.lineOffsetX*_e,Ne=g.lineOffsetY*_e,{lineStartIndex:Le,glyphStartIndex:De,numGlyphs:$e,segment:Ue,writingMode:Ye,flipState:kt}=g,qe=Le+g.lineLength,at=Je=>{if($){const[Tt,xt,At]=Je.up,Qt=G.length;a.updateGlobeVertexNormal($,Qt+0,Tt,xt,At),a.updateGlobeVertexNormal($,Qt+1,Tt,xt,At),a.updateGlobeVertexNormal($,Qt+2,Tt,xt,At),a.updateGlobeVertexNormal($,Qt+3,Tt,xt,At)}const[Et,Ke,lt]=Je.point;a.addDynamicAttributes(G,Et,Ke,lt,Je.angle)};if($e>1){const Je=Kl(_e,D,ve,Ne,h,J,oe,g,B,C,ce,de,!1,me,Q,le);if(!Je)return{notEnoughRoom:!0};if(_&&!h){let[Et,Ke,lt]=Je.first.point,[Tt,xt,At]=Je.last.point;[Et,Ke]=Ii(Et,Ke,lt,N),[Tt,xt]=Ii(Tt,xt,At,N);const Qt=ia(Ye,kt,(Tt-Et)*fe,xt-Ke);if(g.flipState=Qt&&Qt.needsFlipping?Qs.flipRequired:Qs.flipNotRequired,Qt)return Qt}at(Je.first);for(let Et=De+1;Et<De+$e-1;Et++){const Ke=vs(_e*D.getoffsetX(Et),ve,Ne,h,J,oe,Ue,Le,qe,B,C,ce,de,!1,!1,me,Q,le);if(!Ke)return G.length-=4*(Et-De),{notEnoughRoom:!0};at(Ke)}at(Je.last)}else{if(_&&!h){const Et=Ii(oe.x,oe.y,0,T),Ke=Le+Ue+1,lt=new a.Point(B.getx(Ke),B.gety(Ke)),Tt=Ii(lt.x,lt.y,0,T),xt=Tt[3]>0?Tt:Bn(oe,lt,Et,1,T,void 0,me,Q.canonical),At=ia(Ye,kt,(xt[0]-Et[0])*fe,xt[1]-Et[1]);if(g.flipState=At&&At.needsFlipping?Qs.flipRequired:Qs.flipNotRequired,At)return At}const Je=vs(_e*D.getoffsetX(De),ve,Ne,h,J,oe,Ue,Le,qe,B,C,ce,de,!1,!1,me,Q,le);if(!Je)return{notEnoughRoom:!0};at(Je)}return{}}function Hn(g,o,h,_,T){const{x:C,y:N,z:D}=_.projectTilePoint(g.x,g.y,o);if(!T)return Ii(C,N,D,h);const[B,G,$]=T(g);return Ii(C+B,N+G,D+$,h)}function Bn(g,o,h,_,T,C,N,D){const B=Hn(g.sub(o)._unit()._add(g),D,T,N,C);return a.sub(B,h,B),a.normalize(B,B),a.scaleAndAdd(B,h,B,_)}function vs(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de,me,Q){const le=_?g-o:g+o;let _e=le>0?1:-1,ve=0;_&&(_e*=-1,ve=Math.PI),_e<0&&(ve+=Math.PI);let Ne=D+N+(_e>0?0:1)|0,Le=T,De=T,$e=0,Ue=0;const Ye=Math.abs(le),kt=[],qe=[];let at=C,Je=at;const Et=()=>Bn(Je,at,De,Ye-$e+1,$,oe,de,me.canonical);for(;$e+Ue<=Ye;){if(Ne+=_e,Ne<D||Ne>=B)return null;if(De=Le,Je=at,kt.push(De),ce&&qe.push(Je),at=new a.Point(G.getx(Ne),G.gety(Ne)),Le=J[Ne],!Le){const un=Hn(at,me.canonical,$,de,oe);Le=un[3]>0?J[Ne]=un:Et()}$e+=Ue,Ue=a.distance(De,Le)}fe&&oe&&(J[Ne]&&(Le=Et(),Ue=a.distance(De,Le)),J[Ne]=Le);const Ke=(Ye-$e)/Ue,lt=at.sub(Je)._mult(Ke)._add(Je),Tt=a.sub([],Le,De),xt=a.scaleAndAdd([],De,Tt,Ke);let At=[0,0,1],Qt=Tt[0],yn=Tt[1];if(Q&&(At=de.upVector(me.canonical,lt.x,lt.y),At[0]!==0||At[1]!==0||At[2]!==1)){const un=[At[2],0,-At[0]],jn=a.cross([],At,un);a.normalize(un,un),a.normalize(jn,jn),Qt=a.dot(Tt,un),yn=a.dot(Tt,jn)}if(h){const un=a.cross([],At,Tt);a.normalize(un,un),a.scaleAndAdd(xt,xt,un,h*_e)}const qt=ve+Math.atan2(yn,Qt);return kt.push(xt),ce&&qe.push(lt),{point:xt,angle:qt,path:kt,tilePath:qe,up:At}}function Ds(g,o){const h=o.length,_=h+4*g;o.resize(_),o.float32.fill(-1/0,4*h,4*_)}function Rn(g,o,h){const _=o[0],T=o[1];return g[0]=h[0]*_+h[4]*T+h[12],g[1]=h[1]*_+h[5]*T+h[13],g[3]=h[3]*_+h[7]*T+h[15],g}const Ls=100;class cl{constructor(o,h,_=new ka(o.width+200,o.height+200,25),T=new ka(o.width+200,o.height+200,25)){this.transform=o,this.grid=_,this.ignoredGrid=T,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+Ls,this.screenBottomBoundary=o.height+Ls,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=h}placeCollisionBox(o,h,_,T,C,N,D,B){let G=_.projectedAnchorX,$=_.projectedAnchorY,J=_.projectedAnchorZ;const oe=_.elevation,ce=_.tileID,fe=o.getProjection();if(oe&&ce){const[Le,De,$e]=fe.upVector(ce.canonical,_.tileAnchorX,_.tileAnchorY),Ue=fe.upVectorScale(ce.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;G+=Le*oe*Ue,$+=De*oe*Ue,J+=$e*oe*Ue}const de=this.projectAndGetPerspectiveRatio(D,G,$,J,_.tileID,fe.name==="globe"||!!oe||this.transform.pitch>0,fe),me=N*de.perspectiveRatio,Q=(_.x1*h+T.x-_.padding)*me+de.point.x,le=(_.y1*h+T.y-_.padding)*me+de.point.y,_e=(_.x2*h+T.x+_.padding)*me+de.point.x,ve=(_.y2*h+T.y+_.padding)*me+de.point.y,Ne=de.perspectiveRatio<=.55||de.occluded;return!this.isInsideGrid(Q,le,_e,ve)||!C&&this.grid.hitTest(Q,le,_e,ve,B)||Ne?{box:[],offscreen:!1,occluded:de.occluded}:{box:[Q,le,_e,ve],offscreen:this.isOffscreen(Q,le,_e,ve),occluded:!1}}placeCollisionCircles(o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de){const me=[],Q=this.transform.elevation,le=o.getProjection(),_e=Q?Q.getAtTileOffsetFunc(de,this.transform.center.lat,this.transform.worldSize,le):null,ve=new a.Point(_.tileAnchorX,_.tileAnchorY);let{x:Ne,y:Le,z:De}=le.projectTilePoint(ve.x,ve.y,de.canonical);if(_e){const[lt,Tt,xt]=_e(ve);Ne+=lt,Le+=Tt,De+=xt}const $e=le.name==="globe",Ue=this.projectAndGetPerspectiveRatio(D,Ne,Le,De,de,$e||!!Q||this.transform.pitch>0,le),{perspectiveRatio:Ye}=Ue,kt=(J?N/Ye:N*Ye)/a.ONE_EM,qe=Ii(Ne,Le,De,B),at=Ue.signedDistanceFromCamera>0?Kl(kt,C,_.lineOffsetX*kt,_.lineOffsetY*kt,!1,qe,ve,_,T,B,{},Q&&!J?_e:null,J&&!!Q,le,de,J):null;let Je=!1,Et=!1,Ke=!0;if(at&&!Ue.occluded){const lt=.5*ce*Ye+fe,Tt=new a.Point(-100,-100),xt=new a.Point(this.screenRightBoundary,this.screenBottomBoundary),At=new Ah,{first:Qt,last:yn}=at,qt=Qt.path.length;let un=[];for(let en=qt-1;en>=1;en--)un.push(Qt.path[en]);for(let en=1;en<yn.path.length;en++)un.push(yn.path[en]);const jn=2.5*lt;G&&(un=un.map((([en,Gn,sr],or)=>(_e&&!$e&&(sr=_e(or<qt-1?Qt.tilePath[qt-1-or]:yn.tilePath[or-qt+2])[2]),Ii(en,Gn,sr,G)))),un.some((en=>en[3]<=0))&&(un=[]));let Fn=[];if(un.length>0){let en=1/0,Gn=-1/0,sr=1/0,or=-1/0;for(const tr of un)en=Math.min(en,tr[0]),sr=Math.min(sr,tr[1]),Gn=Math.max(Gn,tr[0]),or=Math.max(or,tr[1]);Gn>=Tt.x&&en<=xt.x&&or>=Tt.y&&sr<=xt.y&&(Fn=[un.map((tr=>new a.Point(tr[0],tr[1])))],(en<Tt.x||Gn>xt.x||sr<Tt.y||or>xt.y)&&(Fn=a.clipLine(Fn,Tt.x,Tt.y,xt.x,xt.y)))}for(const en of Fn){At.reset(en,.25*lt);let Gn=0;Gn=At.length<=.5*lt?1:Math.ceil(At.paddedLength/jn)+1;for(let sr=0;sr<Gn;sr++){const or=sr/Math.max(Gn-1,1),tr=At.lerp(or),Ni=tr.x+Ls,$r=tr.y+Ls;me.push(Ni,$r,lt,0);const Vs=Ni-lt,lo=$r-lt,In=Ni+lt,fr=$r+lt;if(Ke=Ke&&this.isOffscreen(Vs,lo,In,fr),Et=Et||this.isInsideGrid(Vs,lo,In,fr),!h&&this.grid.hitTestCircle(Ni,$r,lt,oe)&&(Je=!0,!$))return{circles:[],offscreen:!1,collisionDetected:Je,occluded:!1}}}}return{circles:!$&&Je||!Et?[]:me,offscreen:Ke,collisionDetected:Je,occluded:Ue.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const h=[];let _=1/0,T=1/0,C=-1/0,N=-1/0;for(const $ of o){const J=new a.Point($.x+Ls,$.y+Ls);_=Math.min(_,J.x),T=Math.min(T,J.y),C=Math.max(C,J.x),N=Math.max(N,J.y),h.push(J)}const D=this.grid.query(_,T,C,N).concat(this.ignoredGrid.query(_,T,C,N)),B={},G={};for(const $ of D){const J=$.key;if(B[J.bucketInstanceId]===void 0&&(B[J.bucketInstanceId]={}),B[J.bucketInstanceId][J.featureIndex])continue;const oe=[new a.Point($.x1,$.y1),new a.Point($.x2,$.y1),new a.Point($.x2,$.y2),new a.Point($.x1,$.y2)];a.polygonIntersectsPolygon(h,oe)&&(B[J.bucketInstanceId][J.featureIndex]=!0,G[J.bucketInstanceId]===void 0&&(G[J.bucketInstanceId]=[]),G[J.bucketInstanceId].push(J.featureIndex))}return G}insertCollisionBox(o,h,_,T,C){(h?this.ignoredGrid:this.grid).insert({bucketInstanceId:_,featureIndex:T,collisionGroupID:C},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,h,_,T,C){const N=h?this.ignoredGrid:this.grid,D={bucketInstanceId:_,featureIndex:T,collisionGroupID:C};for(let B=0;B<o.length;B+=4)N.insertCircle(D,o[B],o[B+1],o[B+2])}projectAndGetPerspectiveRatio(o,h,_,T,C,N,D){const B=[h,_,T,1];let G=!1;T||this.transform.pitch>0?(a.transformMat4$1(B,B,o),this.fogState&&C&&D.name!=="globe"&&(G=(function(oe,ce,fe,de,me,Q){const le=Q.calculateFogTileMatrix(me),_e=[ce,fe,de];return a.transformMat4(_e,_e,le),pt(oe,_e,Q.pitch,Q._fov)})(this.fogState,h,_,T,C.toUnwrapped(),this.transform)>.9)):Rn(B,B,o);const $=B[3];return{point:new a.Point((B[0]/$+1)/2*this.transform.width+Ls,(-B[1]/$+1)/2*this.transform.height+Ls),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(D)/$*.5,1.5),signedDistanceFromCamera:$,occluded:N&&B[2]>$||G}}isOffscreen(o,h,_,T){return _<Ls||o>=this.screenRightBoundary||T<Ls||h>this.screenBottomBoundary}isInsideGrid(o,h,_,T){return _>=0&&o<this.gridRightBoundary&&T>=0&&h<this.gridBottomBoundary}getViewportMatrix(){const o=a.identity([]);return a.translate(o,o,[-100,-100,0]),o}}function rr(g,o,h){const _=o.createTileMatrix(g,g.worldSize,h.toUnwrapped());return a.multiply(new Float32Array(16),g.projMatrix,_)}function js(g,o,h){if(o.projection.name===h.projection.name)return g.projMatrix;const _=h.clone();return _.setProjection(o.projection),rr(_,o.getProjection(),g)}function Cr(g,o,h){return o.name===h.projection.name?g.projMatrix:rr(h,o,g)}class rd{constructor(o,h,_,T){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?h:-h))):T&&_?1:0,this.placed=_}isHidden(){return this.opacity===0&&!this.placed}}class Fo{constructor(o,h,_,T,C,N=!1){this.text=new rd(o?o.text:null,h,_,C),this.icon=new rd(o?o.icon:null,h,T,C),this.clipped=N}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class Yl{constructor(o,h,_,T=!1){this.text=o,this.icon=h,this.skipFade=_,this.clipped=T}}class Jl{constructor(){this.invProjMatrix=a.create(),this.viewportMatrix=a.create(),this.circles=[]}}class eu{constructor(o,h,_,T,C){this.bucketInstanceId=o,this.featureIndex=h,this.sourceLayerIndex=_,this.bucketIndex=T,this.tileID=C}}class tu{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const h=++this.maxGroupID;this.collisionGroups[o]={ID:h,predicate:_=>_.collisionGroupID===h}}return this.collisionGroups[o]}}function eo(g,o,h,_,T){const{horizontalAlign:C,verticalAlign:N}=a.getAnchorAlignment(g),D=-(C-.5)*o,B=-(N-.5)*h,G=a.evaluateVariableOffset(g,_);return new a.Point(D+G[0]*T,B+G[1]*T)}function to(g,o,h,_,T){const C=new a.Point(g,o);return h&&C._rotate(_?T:-T),C}class vo{constructor(o,h,_,T,C){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new cl(this.transform,C),this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=h,this.retainedQueryData={},this.collisionGroups=new tu(_),this.collisionCircleArrays={},this.prevPlacement=T,T&&(T.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,h,_,T){const C=_.getBucket(h),N=_.latestFeatureIndex;if(!C||!N||h.id!==C.layerIds[0])return;const D=C.layers[0].layout,B=_.collisionBoxArray,G=Math.pow(2,this.transform.zoom-_.tileID.overscaledZ),$=_.tileSize/a.EXTENT,J=_.tileID.toUnwrapped();this.transform.setProjection(C.projection);const oe=(ce=_.tileID,fe=C.getProjection(),de=this.transform,fe.name===this.projection?de.calculateProjMatrix(ce.toUnwrapped()):rr(de,fe,ce));var ce,fe,de;const me=D.get("text-pitch-alignment")==="map",Q=D.get("text-rotation-alignment")==="map";h.compileFilter();const le=h.dynamicFilter(),_e=h.dynamicFilterNeedsFeature(),ve=this.transform.calculatePixelsToTileUnitsMatrix(_),Ne=bi(oe,_.tileID.canonical,me,Q,this.transform,C.getProjection(),ve);let Le=null;if(me){const Ue=si(oe,_.tileID.canonical,me,Q,this.transform,C.getProjection(),ve);Le=a.multiply([],this.transform.labelPlaneMatrix,Ue)}let De=null;le&&_.latestFeatureIndex&&(De={unwrappedTileID:J,dynamicFilter:le,dynamicFilterNeedsFeature:_e,featureIndex:_.latestFeatureIndex}),this.retainedQueryData[C.bucketInstanceId]=new eu(C.bucketInstanceId,N,C.sourceLayerIndex,C.index,_.tileID);const $e={bucket:C,layout:D,posMatrix:oe,textLabelPlaneMatrix:Ne,labelToScreenMatrix:Le,clippingData:De,scale:G,textPixelRatio:$,holdingForFade:_.holdingForFade(),collisionBoxArray:B,partiallyEvaluatedTextSize:a.evaluateSizeForZoom(C.textSizeData,this.transform.zoom),partiallyEvaluatedIconSize:a.evaluateSizeForZoom(C.iconSizeData,this.transform.zoom),collisionGroup:this.collisionGroups.get(C.sourceID)};if(T)for(const Ue of C.sortKeyRanges){const{sortKey:Ye,symbolInstanceStart:kt,symbolInstanceEnd:qe}=Ue;o.push({sortKey:Ye,symbolInstanceStart:kt,symbolInstanceEnd:qe,parameters:$e})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:$e})}attemptAnchorPlacement(o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de,me,Q,le){const{textOffset0:_e,textOffset1:ve,crossTileID:Ne}=oe,Le=[_e,ve],De=eo(o,_,T,Le,C),$e=this.collisionIndex.placeCollisionBox(fe,C,h,to(De.x,De.y,N,D,this.transform.angle),J,B,G,$.predicate);if(me){const Ue=fe.getSymbolInstanceIconSize(le,this.transform.zoom,oe.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(fe,Ue,me,to(De.x,De.y,N,D,this.transform.angle),J,B,G,$.predicate).box.length===0)return}if($e.box.length>0){let Ue;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ne]&&this.prevPlacement.placements[Ne]&&this.prevPlacement.placements[Ne].text&&(Ue=this.prevPlacement.variableOffsets[Ne].anchor),this.variableOffsets[Ne]={textOffset:Le,width:_,height:T,anchor:o,textScale:C,prevAnchor:Ue},this.markUsedJustification(fe,o,oe,de),fe.allowVerticalPlacement&&(this.markUsedOrientation(fe,de,oe),this.placedOrientations[Ne]=de),{shift:De,placedGlyphBoxes:$e}}}placeLayerBucketPart(o,h,_,T){const{bucket:C,layout:N,posMatrix:D,textLabelPlaneMatrix:B,labelToScreenMatrix:G,clippingData:$,textPixelRatio:J,holdingForFade:oe,collisionBoxArray:ce,partiallyEvaluatedTextSize:fe,partiallyEvaluatedIconSize:de,collisionGroup:me}=o.parameters,Q=N.get("text-optional"),le=N.get("icon-optional"),_e=N.get("text-allow-overlap"),ve=N.get("icon-allow-overlap"),Ne=N.get("text-rotation-alignment")==="map",Le=N.get("text-pitch-alignment")==="map",De=N.get("icon-text-fit")!=="none",$e=N.get("symbol-z-order")==="viewport-y";this.transform.setProjection(C.projection);let Ue=_e&&(ve||!C.hasIconData()||le),Ye=ve&&(_e||!C.hasTextData()||Q);!C.collisionArrays&&ce&&C.deserializeCollisionBoxes(ce),_&&T&&C.updateCollisionDebugBuffers(this.transform.zoom,ce);const kt=(qe,at,Je)=>{const{crossTileID:Et,numVerticalGlyphVertices:Ke}=qe;if($){const In={zoom:this.transform.zoom,pitch:this.transform.pitch};let fr=null;if($.dynamicFilterNeedsFeature){const Qn=this.retainedQueryData[C.bucketInstanceId];fr=$.featureIndex.loadFeature({featureIndex:qe.featureIndex,bucketIndex:Qn.bucketIndex,sourceLayerIndex:Qn.sourceLayerIndex,layoutVertexArrayOffset:0})}if(!(0,$.dynamicFilter)(In,fr,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new a.Point(qe.tileAnchorX,qe.tileAnchorY),this.transform.calculateDistanceTileData($.unwrappedTileID)))return this.placements[Et]=new Yl(!1,!1,!1,!0),void h.add(Et)}if(h.has(Et))return;if(oe)return void(this.placements[Et]=new Yl(!1,!1,!1));let lt=!1,Tt=!1,xt=!0,At=!1,Qt=!1,yn=null,qt={box:null,offscreen:null,occluded:null},un={box:null},jn=null,Fn=null,en=null,Gn=0,sr=0,or=0;Je.textFeatureIndex?Gn=Je.textFeatureIndex:qe.useRuntimeCollisionCircles&&(Gn=qe.featureIndex),Je.verticalTextFeatureIndex&&(sr=Je.verticalTextFeatureIndex);const tr=In=>{In.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const fr=this.transform.elevation;(fr||In.elevation)&&(In.elevation=fr?fr.getAtTileOffset(In.tileID,In.tileAnchorX,In.tileAnchorY):0)},Ni=Je.textBox;if(Ni){tr(Ni);const In=Qn=>{let Gr=a.WritingMode.horizontal;if(C.allowVerticalPlacement&&!Qn&&this.prevPlacement){const Di=this.prevPlacement.placedOrientations[Et];Di&&(this.placedOrientations[Et]=Di,Gr=Di,this.markUsedOrientation(C,Gr,qe))}return Gr},fr=(Qn,Gr)=>{if(C.allowVerticalPlacement&&Ke>0&&Je.verticalTextBox){for(const Di of C.writingModes)if(Di===a.WritingMode.vertical?(qt=Gr(),un=qt):qt=Qn(),qt&&qt.box&&qt.box.length)break}else qt=Qn()};if(N.get("text-variable-anchor")){let Qn=N.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[Et]){const xr=this.prevPlacement.variableOffsets[Et];Qn.indexOf(xr.anchor)>0&&(Qn=Qn.filter((hi=>hi!==xr.anchor)),Qn.unshift(xr.anchor))}const Gr=(xr,hi,Dr)=>{const Or=C.getSymbolInstanceTextSize(fe,qe,this.transform.zoom,at),Kr=(xr.x2-xr.x1)*Or+2*xr.padding,co=(xr.y2-xr.y1)*Or+2*xr.padding,uo=De&&!ve?hi:null;uo&&tr(uo);let Co={box:[],offscreen:!1,occluded:!1};const Ed=_e?2*Qn.length:Qn.length;for(let fi=0;fi<Ed;++fi){const Eu=this.attemptAnchorPlacement(Qn[fi%Qn.length],xr,Kr,co,Or,Ne,Le,J,D,me,fi>=Qn.length,qe,at,C,Dr,uo,fe,de);if(Eu&&(Co=Eu.placedGlyphBoxes,Co&&Co.box&&Co.box.length)){lt=!0,yn=Eu.shift;break}}return Co};fr((()=>Gr(Ni,Je.iconBox,a.WritingMode.horizontal)),(()=>{const xr=Je.verticalTextBox;return xr&&tr(xr),C.allowVerticalPlacement&&!(qt&&qt.box&&qt.box.length)&&Ke>0&&xr?Gr(xr,Je.verticalIconBox,a.WritingMode.vertical):{box:null,offscreen:null,occluded:null}})),qt&&(lt=qt.box,xt=qt.offscreen,At=qt.occluded);const Di=In(!(!qt||!qt.box));if(!lt&&this.prevPlacement){const xr=this.prevPlacement.variableOffsets[Et];xr&&(this.variableOffsets[Et]=xr,this.markUsedJustification(C,xr.anchor,qe,Di))}}else{const Qn=(Gr,Di)=>{const xr=C.getSymbolInstanceTextSize(fe,qe,this.transform.zoom,at),hi=this.collisionIndex.placeCollisionBox(C,xr,Gr,new a.Point(0,0),_e,J,D,me.predicate);return hi&&hi.box&&hi.box.length&&(this.markUsedOrientation(C,Di,qe),this.placedOrientations[Et]=Di),hi};fr((()=>Qn(Ni,a.WritingMode.horizontal)),(()=>{const Gr=Je.verticalTextBox;return C.allowVerticalPlacement&&Ke>0&&Gr?(tr(Gr),Qn(Gr,a.WritingMode.vertical)):{box:null,offscreen:null,occluded:null}})),In(!!(qt&&qt.box&&qt.box.length))}}if(jn=qt,lt=jn&&jn.box&&jn.box.length>0,xt=jn&&jn.offscreen,At=jn&&jn.occluded,qe.useRuntimeCollisionCircles){const In=C.text.placedSymbolArray.get(qe.centerJustifiedTextSymbolIndex>=0?qe.centerJustifiedTextSymbolIndex:qe.verticalPlacedTextSymbolIndex),fr=a.evaluateSizeForFeature(C.textSizeData,fe,In),Qn=N.get("text-padding");Fn=this.collisionIndex.placeCollisionCircles(C,_e,In,C.lineVertexArray,C.glyphOffsetArray,fr,D,B,G,_,Le,me.predicate,qe.collisionCircleDiameter*fr/a.ONE_EM,Qn,this.retainedQueryData[C.bucketInstanceId].tileID),lt=_e||Fn.circles.length>0&&!Fn.collisionDetected,xt=xt&&Fn.offscreen,At=Fn.occluded}if(Je.iconFeatureIndex&&(or=Je.iconFeatureIndex),Je.iconBox){const In=fr=>{tr(fr);const Qn=De&&yn?to(yn.x,yn.y,Ne,Le,this.transform.angle):new a.Point(0,0),Gr=C.getSymbolInstanceIconSize(de,this.transform.zoom,qe.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,Gr,fr,Qn,ve,J,D,me.predicate)};un&&un.box&&un.box.length&&Je.verticalIconBox?(en=In(Je.verticalIconBox),Tt=en.box.length>0):(en=In(Je.iconBox),Tt=en.box.length>0),xt=xt&&en.offscreen,Qt=en.occluded}const $r=Q||qe.numHorizontalGlyphVertices===0&&Ke===0,Vs=le||qe.numIconVertices===0;if($r||Vs?Vs?$r||(Tt=Tt&&lt):lt=Tt&&lt:Tt=lt=Tt&&lt,lt&&jn&&jn.box&&this.collisionIndex.insertCollisionBox(jn.box,N.get("text-ignore-placement"),C.bucketInstanceId,un&&un.box&&sr?sr:Gn,me.ID),Tt&&en&&this.collisionIndex.insertCollisionBox(en.box,N.get("icon-ignore-placement"),C.bucketInstanceId,or,me.ID),Fn&&(lt&&this.collisionIndex.insertCollisionCircles(Fn.circles,N.get("text-ignore-placement"),C.bucketInstanceId,Gn,me.ID),_)){const In=C.bucketInstanceId;let fr=this.collisionCircleArrays[In];fr===void 0&&(fr=this.collisionCircleArrays[In]=new Jl);for(let Qn=0;Qn<Fn.circles.length;Qn+=4)fr.circles.push(Fn.circles[Qn+0]),fr.circles.push(Fn.circles[Qn+1]),fr.circles.push(Fn.circles[Qn+2]),fr.circles.push(Fn.collisionDetected?1:0)}const lo=C.projection.name!=="globe";Ue=Ue&&(lo||!At),Ye=Ye&&(lo||!Qt),this.placements[Et]=new Yl(lt||Ue,Tt||Ye,xt||C.justReloaded),h.add(Et)};if($e){const qe=C.getSortedSymbolIndexes(this.transform.angle);for(let at=qe.length-1;at>=0;--at){const Je=qe[at];kt(C.symbolInstances.get(Je),Je,C.collisionArrays[Je])}}else for(let qe=o.symbolInstanceStart;qe<o.symbolInstanceEnd;qe++)kt(C.symbolInstances.get(qe),qe,C.collisionArrays[qe]);if(_&&C.bucketInstanceId in this.collisionCircleArrays){const qe=this.collisionCircleArrays[C.bucketInstanceId];a.invert(qe.invProjMatrix,D),qe.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,h,_,T){const{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:N,rightJustifiedTextSymbolIndex:D,verticalPlacedTextSymbolIndex:B,crossTileID:G}=_,$=a.getAnchorJustification(h),J=T===a.WritingMode.vertical?B:$==="left"?C:$==="center"?N:$==="right"?D:-1;C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=J>=0&&C!==J?0:G),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=J>=0&&N!==J?0:G),D>=0&&(o.text.placedSymbolArray.get(D).crossTileID=J>=0&&D!==J?0:G),B>=0&&(o.text.placedSymbolArray.get(B).crossTileID=J>=0&&B!==J?0:G)}markUsedOrientation(o,h,_){const T=h===a.WritingMode.horizontal||h===a.WritingMode.horizontalOnly?h:0,C=h===a.WritingMode.vertical?h:0,{leftJustifiedTextSymbolIndex:N,centerJustifiedTextSymbolIndex:D,rightJustifiedTextSymbolIndex:B,verticalPlacedTextSymbolIndex:G}=_,$=o.text.placedSymbolArray;N>=0&&($.get(N).placedOrientation=T),D>=0&&($.get(D).placedOrientation=T),B>=0&&($.get(B).placedOrientation=T),G>=0&&($.get(G).placedOrientation=C)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const h=this.prevPlacement;let _=!1;this.prevZoomAdjustment=h?h.zoomAdjustment(this.transform.zoom):0;const T=h?h.symbolFadeChange(o):1,C=h?h.opacities:{},N=h?h.variableOffsets:{},D=h?h.placedOrientations:{};for(const B in this.placements){const G=this.placements[B],$=C[B];$?(this.opacities[B]=new Fo($,T,G.text,G.icon,null,G.clipped),_=_||G.text!==$.text.placed||G.icon!==$.icon.placed):(this.opacities[B]=new Fo(null,T,G.text,G.icon,G.skipFade,G.clipped),_=_||G.text||G.icon)}for(const B in C){const G=C[B];if(!this.opacities[B]){const $=new Fo(G,T,!1,!1);$.isHidden()||(this.opacities[B]=$,_=_||G.text.placed||G.icon.placed)}}for(const B in N)this.variableOffsets[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.variableOffsets[B]=N[B]);for(const B in D)this.placedOrientations[B]||!this.opacities[B]||this.opacities[B].isHidden()||(this.placedOrientations[B]=D[B]);_?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=h?h.lastPlacementChangeTime:o)}updateLayerOpacities(o,h){const _=new Set;for(const T of h){const C=T.getBucket(o);C&&T.latestFeatureIndex&&o.id===C.layerIds[0]&&this.updateBucketOpacities(C,_,T.collisionBoxArray)}}updateBucketOpacities(o,h,_){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const T=o.layers[0].layout,C=!!o.layers[0].dynamicFilter(),N=new Fo(null,0,!1,!1,!0),D=T.get("text-allow-overlap"),B=T.get("icon-allow-overlap"),G=T.get("text-variable-anchor"),$=T.get("text-rotation-alignment")==="map",J=T.get("text-pitch-alignment")==="map",oe=T.get("icon-text-fit")!=="none",ce=new Fo(null,0,D&&(B||!o.hasIconData()||T.get("icon-optional")),B&&(D||!o.hasTextData()||T.get("text-optional")),!0);!o.collisionArrays&&_&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(_);const fe=(me,Q,le)=>{for(let _e=0;_e<Q/4;_e++)me.opacityVertexArray.emplaceBack(le)};let de=0;for(let me=0;me<o.symbolInstances.length;me++){const Q=o.symbolInstances.get(me),{numHorizontalGlyphVertices:le,numVerticalGlyphVertices:_e,crossTileID:ve,numIconVertices:Ne}=Q,Le=h.has(ve);let De=this.opacities[ve];Le?De=N:De||(De=ce,this.opacities[ve]=De),h.add(ve);const $e=le>0||_e>0,Ue=Ne>0,Ye=this.placedOrientations[ve],kt=Ye===a.WritingMode.vertical,qe=Ye===a.WritingMode.horizontal||Ye===a.WritingMode.horizontalOnly;if(!$e&&!Ue||De.isHidden()||de++,$e){const at=Aa(De.text);fe(o.text,le,kt?Br:at),fe(o.text,_e,qe?Br:at);const Je=De.text.isHidden(),{leftJustifiedTextSymbolIndex:Et,centerJustifiedTextSymbolIndex:Ke,rightJustifiedTextSymbolIndex:lt,verticalPlacedTextSymbolIndex:Tt}=Q,xt=o.text.placedSymbolArray,At=Je||kt?1:0;Et>=0&&(xt.get(Et).hidden=At),Ke>=0&&(xt.get(Ke).hidden=At),lt>=0&&(xt.get(lt).hidden=At),Tt>=0&&(xt.get(Tt).hidden=Je||qe?1:0);const Qt=this.variableOffsets[ve];Qt&&this.markUsedJustification(o,Qt.anchor,Q,Ye);const yn=this.placedOrientations[ve];yn&&(this.markUsedJustification(o,"left",Q,yn),this.markUsedOrientation(o,yn,Q))}if(Ue){const at=Aa(De.icon),{placedIconSymbolIndex:Je,verticalPlacedIconSymbolIndex:Et}=Q,Ke=o.icon.placedSymbolArray,lt=De.icon.isHidden()?1:0;Je>=0&&(fe(o.icon,Ne,kt?Br:at),Ke.get(Je).hidden=lt),Et>=0&&(fe(o.icon,Q.numVerticalIconVertices,qe?Br:at),Ke.get(Et).hidden=lt)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const at=o.collisionArrays[me];if(at){let Je=new a.Point(0,0),Et=!0;if(at.textBox||at.verticalTextBox){if(G){const lt=this.variableOffsets[ve];lt?(Je=eo(lt.anchor,lt.width,lt.height,lt.textOffset,lt.textScale),$&&Je._rotate(J?this.transform.angle:-this.transform.angle)):Et=!1}C&&(Et=!De.clipped),at.textBox&&Vo(o.textCollisionBox.collisionVertexArray,De.text.placed,!Et||kt,Je.x,Je.y),at.verticalTextBox&&Vo(o.textCollisionBox.collisionVertexArray,De.text.placed,!Et||qe,Je.x,Je.y)}const Ke=Et&&!!(!qe&&at.verticalIconBox);at.iconBox&&Vo(o.iconCollisionBox.collisionVertexArray,De.icon.placed,Ke,oe?Je.x:0,oe?Je.y:0),at.verticalIconBox&&Vo(o.iconCollisionBox.collisionVertexArray,De.icon.placed,!Ke,oe?Je.x:0,oe?Je.y:0)}}}if(o.fullyClipped=de===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const me=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=me.invProjMatrix,o.placementViewportMatrix=me.viewportMatrix,o.collisionCircleArray=me.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,h){const _=this.zoomAtLastRecencyCheck===h?1-this.zoomAdjustment(h):1;return this.zoomAtLastRecencyCheck=h,this.commitTime+this.fadeDuration*_>o}setStale(){this.stale=!0}}function Vo(g,o,h,_,T){g.emplaceBack(o?1:0,h?1:0,_||0,T||0),g.emplaceBack(o?1:0,h?1:0,_||0,T||0),g.emplaceBack(o?1:0,h?1:0,_||0,T||0),g.emplaceBack(o?1:0,h?1:0,_||0,T||0)}const Mi=Math.pow(2,25),_r=Math.pow(2,24),Ih=Math.pow(2,17),id=Math.pow(2,16),Pi=Math.pow(2,9),no=Math.pow(2,8),Mh=Math.pow(2,1);function Aa(g){if(g.opacity===0&&!g.placed)return 0;if(g.opacity===1&&g.placed)return 4294967295;const o=g.placed?1:0,h=Math.floor(127*g.opacity);return h*Mi+o*_r+h*Ih+o*id+h*Pi+o*no+h*Mh+o}const Br=0;class nu{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,h,_,T,C){const N=this._bucketParts;for(;this._currentTileIndex<o.length;)if(h.getBucketParts(N,T,o[this._currentTileIndex],this._sortAcrossTiles),this._currentTileIndex++,C())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,N.sort(((D,B)=>D.sortKey-B.sortKey)));this._currentPartIndex<N.length;){const D=N[this._currentPartIndex];if(h.placeLayerBucketPart(D,this._seenCrossTileIDs,_,D.symbolInstanceStart===0),this._currentPartIndex++,C())return!0}return!1}}class ul{constructor(o,h,_,T,C,N,D,B){this.placement=new vo(o,C,N,D,B),this._currentPlacementIndex=h.length-1,this._forceFullPlacement=_,this._showCollisionBoxes=T,this._done=!1}isDone(){return this._done}continuePlacement(o,h,_){const T=a.exported.now(),C=()=>{const N=a.exported.now()-T;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=h[o[this._currentPlacementIndex]],D=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=D)&&(!N.maxzoom||N.maxzoom>D)){if(this._inProgressLayer||(this._inProgressLayer=new nu(N)),this._inProgressLayer.continuePlacement(_[N.source],this.placement,this._showCollisionBoxes,N,C))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const wo=512/a.EXTENT/2;class Xr{constructor(o,h,_){this.tileID=o,this.bucketInstanceId=_,this.index=new a.KDBush(h.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const T=o.canonical.x*a.EXTENT,C=o.canonical.y*a.EXTENT;for(let N=0;N<h.length;N++){const{key:D,crossTileID:B,tileAnchorX:G,tileAnchorY:$}=h.get(N),J=Math.floor((T+G)*wo),oe=Math.floor((C+$)*wo);this.index.add(J,oe),this.keys.push(D),this.crossTileIDs.push(B)}this.index.finish()}findMatches(o,h,_){const T=this.tileID.canonical.z<h.canonical.z?1:Math.pow(2,this.tileID.canonical.z-h.canonical.z),C=wo/Math.pow(2,h.canonical.z-this.tileID.canonical.z),N=h.canonical.x*a.EXTENT,D=h.canonical.y*a.EXTENT;for(let B=0;B<o.length;B++){const G=o.get(B);if(G.crossTileID)continue;const{key:$,tileAnchorX:J,tileAnchorY:oe}=G,ce=Math.floor((N+J)*C),fe=Math.floor((D+oe)*C),de=this.index.range(ce-T,fe-T,ce+T,fe+T);for(const me of de){const Q=this.crossTileIDs[me];if(this.keys[me]===$&&!_.has(Q)){_.add(Q),G.crossTileID=Q;break}}}}}class Ql{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ph{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const h=Math.round((o-this.lng)/360);if(h!==0)for(const _ in this.indexes){const T=this.indexes[_],C={};for(const N in T){const D=T[N];D.tileID=D.tileID.unwrapTo(D.tileID.wrap+h),C[D.tileID.key]=D}this.indexes[_]=C}this.lng=o}addBucket(o,h,_){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===h.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let C=0;C<h.symbolInstances.length;C++)h.symbolInstances.get(C).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const T=this.usedCrossTileIDs[o.overscaledZ];for(const C in this.indexes){const N=this.indexes[C];if(Number(C)>o.overscaledZ)for(const D in N){const B=N[D];B.tileID.isChildOf(o)&&B.findMatches(h.symbolInstances,o,T)}else{const D=N[o.scaledTo(Number(C)).key];D&&D.findMatches(h.symbolInstances,o,T)}}for(let C=0;C<h.symbolInstances.length;C++){const N=h.symbolInstances.get(C);N.crossTileID||(N.crossTileID=_.generate(),T.add(N.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Xr(o,h.symbolInstances,h.bucketInstanceId),!0}removeBucketCrossTileIDs(o,h){for(const _ of h.crossTileIDs)this.usedCrossTileIDs[o].delete(_)}removeStaleBuckets(o){let h=!1;for(const _ in this.indexes){const T=this.indexes[_];for(const C in T)o[T[C].bucketInstanceId]||(this.removeBucketCrossTileIDs(_,T[C]),delete T[C],h=!0)}return h}}class sa{constructor(){this.layerIndexes={},this.crossTileIDs=new Ql,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,h,_,T){let C=this.layerIndexes[o.id];C===void 0&&(C=this.layerIndexes[o.id]=new Ph);let N=!1;const D={};T.name!=="globe"&&C.handleWrapJump(_);for(const B of h){const G=B.getBucket(o);G&&o.id===G.layerIds[0]&&(G.bucketInstanceId||(G.bucketInstanceId=++this.maxBucketInstanceId),C.addBucket(B.tileID,G,this.crossTileIDs)&&(N=!0),D[G.bucketInstanceId]=!0)}return C.removeStaleBuckets(D)&&(N=!0),N}pruneUnusedLayers(o){const h={};o.forEach((_=>{h[_]=!0}));for(const _ in this.layerIndexes)h[_]||delete this.layerIndexes[_]}}const Uo=(g,o)=>a.emitValidationErrors(g,o&&o.filter((h=>h.identifier!=="source.canvas"))),dl=a.pick(nr,["addLayer","removeLayer","setPaintProperty","setLayoutProperty","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setProjection"]),Rh=a.pick(nr,["setCenter","setZoom","setBearing","setPitch"]),sd={version:8,layers:[],sources:{}},Os={fill:!0,line:!0,background:!0,hillshade:!0,raster:!0};class ro extends a.Evented{constructor(o,h={}){super(),this.map=o,this.dispatcher=new he(ll(),this),this.imageManager=new ut,this.imageManager.setEventedParent(this),this.glyphManager=new a.GlyphManager(o._requestManager,h.localFontFamily?a.LocalGlyphMode.all:h.localIdeographFontFamily?a.LocalGlyphMode.ideographs:a.LocalGlyphMode.none,h.localFontFamily||h.localIdeographFontFamily),this.crossTileSymbolIndex=new sa,this._layers={},this._num3DLayers=0,this._numSymbolLayers=0,this._numCircleLayers=0,this._serializedLayers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._availableImages=[],this._order=[],this._drapedFirstOrder=[],this._markersNeedUpdate=!1,this._resetUpdates(),this.dispatcher.broadcast("setReferrer",a.getReferrer());const _=this;this._rtlTextPluginCallback=ro.registerForPluginStateChange((T=>{_.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:T.pluginStatus,pluginURL:T.pluginURL},((C,N)=>{if(a.triggerPluginCompletionEvent(C),N&&N.every((D=>D)))for(const D in _._sourceCaches){const B=_._sourceCaches[D],G=B.getSource().type;G!=="vector"&&G!=="geojson"||B.reload()}}))})),this.on("data",(T=>{if(T.dataType!=="source"||T.sourceDataType!=="metadata")return;const C=this.getSource(T.sourceId);if(C&&C.vectorLayerIds)for(const N in this._layers){const D=this._layers[N];D.source===C.id&&this._validateLayer(D)}}))}loadURL(o,h={}){this.fire(new a.Event("dataloading",{dataType:"style"}));const _=typeof h.validate=="boolean"?h.validate:!a.isMapboxURL(o);o=this.map._requestManager.normalizeStyleURL(o,h.accessToken);const T=this.map._requestManager.transformRequest(o,a.ResourceType.Style);this._request=a.getJSON(T,((C,N)=>{this._request=null,C?this.fire(new a.ErrorEvent(C)):N&&this._load(N,_)}))}loadJSON(o,h={}){this.fire(new a.Event("dataloading",{dataType:"style"})),this._request=a.exported.frame((()=>{this._request=null,this._load(o,h.validate!==!1)}))}loadEmpty(){this.fire(new a.Event("dataloading",{dataType:"style"})),this._load(sd,!1)}_updateLayerCount(o,h){const _=h?1:-1;o.is3D()&&(this._num3DLayers+=_),o.type==="circle"&&(this._numCircleLayers+=_),o.type==="symbol"&&(this._numSymbolLayers+=_)}_load(o,h){if(h&&Uo(this,a.validateStyle(o)))return;this._loaded=!0,this.stylesheet=a.clone$1(o),this._updateMapProjection();for(const T in o.sources)this.addSource(T,o.sources[T],{validate:!1});this._changed=!1,o.sprite?this._loadSprite(o.sprite):(this.imageManager.setLoaded(!0),this.dispatcher.broadcast("spriteLoaded",!0)),this.glyphManager.setURL(o.glyphs);const _=Ch(this.stylesheet.layers);this._order=_.map((T=>T.id)),this._layers={},this._serializedLayers={};for(const T of _){const C=a.createStyleLayer(T);C.setEventedParent(this,{layer:{id:C.id}}),this._layers[C.id]=C,this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}this.dispatcher.broadcast("setLayers",this._serializeLayers(this._order)),this.light=new ht(this.stylesheet.light),this.stylesheet.terrain&&!this.terrainSetForDrapingOnly()&&this._createTerrain(this.stylesheet.terrain,1),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this._updateDrapeFirstLayers(),this.fire(new a.Event("data",{dataType:"style"})),this.fire(new a.Event("style.load"))}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?this.getTerrain()||this.stylesheet.terrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null))}_updateMapProjection(){this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.stylesheet.projection)}_loadSprite(o){this._spriteRequest=(function(h,_,T){let C,N,D;const B=a.exported.devicePixelRatio>1?"@2x":"";let G=a.getJSON(_.transformRequest(_.normalizeSpriteURL(h,B,".json"),a.ResourceType.SpriteJSON),((oe,ce)=>{G=null,D||(D=oe,C=ce,J())})),$=a.getImage(_.transformRequest(_.normalizeSpriteURL(h,B,".png"),a.ResourceType.SpriteImage),((oe,ce)=>{$=null,D||(D=oe,N=ce,J())}));function J(){if(D)T(D);else if(C&&N){const oe=a.exported.getImageData(N),ce={};for(const fe in C){const{width:de,height:me,x:Q,y:le,sdf:_e,pixelRatio:ve,stretchX:Ne,stretchY:Le,content:De}=C[fe],$e=new a.RGBAImage({width:de,height:me});a.RGBAImage.copy(oe,$e,{x:Q,y:le},{x:0,y:0},{width:de,height:me}),ce[fe]={data:$e,pixelRatio:ve,sdf:_e,stretchX:Ne,stretchY:Le,content:De}}T(null,ce)}}return{cancel(){G&&(G.cancel(),G=null),$&&($.cancel(),$=null)}}})(o,this.map._requestManager,((h,_)=>{if(this._spriteRequest=null,h)this.fire(new a.ErrorEvent(h));else if(_)for(const T in _)this.imageManager.addImage(T,_[T]);this.imageManager.setLoaded(!0),this._availableImages=this.imageManager.listImages(),this.dispatcher.broadcast("setImages",this._availableImages),this.dispatcher.broadcast("spriteLoaded",!0),this.fire(new a.Event("data",{dataType:"style"}))}))}_validateLayer(o){const h=this.getSource(o.source);if(!h)return;const _=o.sourceLayer;_&&(h.type==="geojson"||h.vectorLayerIds&&h.vectorLayerIds.indexOf(_)===-1)&&this.fire(new a.ErrorEvent(new Error(`Source layer "${_}" does not exist on source "${h.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._updatedSources).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;return!!this.imageManager.isLoaded()}_serializeLayers(o){const h=[];for(const _ of o){const T=this._layers[_];T.type!=="custom"&&h.push(T.serialize())}return h}hasTransitions(){if(this.light&&this.light.hasTransition()||this.fog&&this.fog.hasTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.map._optimizeForTerrain&&this.terrain?this._drapedFirstOrder:this._order}isLayerDraped(o){return!!this.terrain&&(typeof o.isLayerDraped=="function"?o.isLayerDraped():Os[o.type])}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}update(o){if(!this._loaded)return;const h=this._changed;if(this._changed){const T=Object.keys(this._updatedLayers),C=Object.keys(this._removedLayers);(T.length||C.length)&&this._updateWorkerLayers(T,C);for(const N in this._updatedSources){const D=this._updatedSources[N];D==="reload"?this._reloadSource(N):D==="clear"&&this._clearSource(N)}this._updateTilesForChangedImages();for(const N in this._updatedPaintProps)this._layers[N].updateTransitions(o);this.light.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this._resetUpdates()}const _={};for(const T in this._sourceCaches){const C=this._sourceCaches[T];_[T]=C.used,C.used=!1}for(const T of this._order){const C=this._layers[T];if(C.recalculate(o,this._availableImages),!C.isHidden(o.zoom)){const D=this._getLayerSourceCache(C);D&&(D.used=!0)}const N=this.map.painter;if(N){const D=C.getProgramIds();if(!D)continue;const B=C.getProgramConfiguration(o.zoom);for(const G of D)N.useProgram(G,B)}}for(const T in _){const C=this._sourceCaches[T];_[T]!==C.used&&C.getSource().fire(new a.Event("data",{sourceDataType:"visibility",dataType:"source",sourceId:C.getSource().id}))}this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),h&&this.fire(new a.Event("data",{dataType:"style"}))}_updateTilesForChangedImages(){const o=Object.keys(this._changedImages);if(o.length){for(const h in this._sourceCaches)this._sourceCaches[h].reloadTilesForDependencies(["icons","patterns"],o);this._changedImages={}}}_updateWorkerLayers(o,h){this.dispatcher.broadcast("updateLayers",{layers:this._serializeLayers(o),removedIds:h})}_resetUpdates(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSources={},this._updatedPaintProps={},this._changedImages={}}setState(o){if(this._checkLoaded(),Uo(this,a.validateStyle(o)))return!1;(o=a.clone$1(o)).layers=Ch(o.layers);const h=(function(T,C){if(!T)return[{command:nr.setStyle,args:[C]}];let N=[];try{if(!k(T.version,C.version))return[{command:nr.setStyle,args:[C]}];k(T.center,C.center)||N.push({command:nr.setCenter,args:[C.center]}),k(T.zoom,C.zoom)||N.push({command:nr.setZoom,args:[C.zoom]}),k(T.bearing,C.bearing)||N.push({command:nr.setBearing,args:[C.bearing]}),k(T.pitch,C.pitch)||N.push({command:nr.setPitch,args:[C.pitch]}),k(T.sprite,C.sprite)||N.push({command:nr.setSprite,args:[C.sprite]}),k(T.glyphs,C.glyphs)||N.push({command:nr.setGlyphs,args:[C.glyphs]}),k(T.transition,C.transition)||N.push({command:nr.setTransition,args:[C.transition]}),k(T.light,C.light)||N.push({command:nr.setLight,args:[C.light]}),k(T.fog,C.fog)||N.push({command:nr.setFog,args:[C.fog]}),k(T.projection,C.projection)||N.push({command:nr.setProjection,args:[C.projection]});const D={},B=[];(function(J,oe,ce,fe){let de;for(de in oe=oe||{},J=J||{})J.hasOwnProperty(de)&&(oe.hasOwnProperty(de)||Qc(de,ce,fe));for(de in oe){if(!oe.hasOwnProperty(de))continue;const me=oe[de];J.hasOwnProperty(de)?k(J[de],me)||(J[de].type==="geojson"&&me.type==="geojson"&&nd(J,oe,de)?ce.push({command:nr.setGeoJSONSourceData,args:[de,me.data]}):Ur(de,oe,ce,fe)):kh(de,oe,ce)}})(T.sources,C.sources,B,D);const G=[];T.layers&&T.layers.forEach((J=>{J.source&&D[J.source]?N.push({command:nr.removeLayer,args:[J.id]}):G.push(J)}));let $=T.terrain;$&&D[$.source]&&(N.push({command:nr.setTerrain,args:[void 0]}),$=void 0),N=N.concat(B),k($,C.terrain)||N.push({command:nr.setTerrain,args:[C.terrain]}),(function(J,oe,ce){oe=oe||[];const fe=(J=J||[]).map(Bo),de=oe.map(Bo),me=J.reduce(Zl,{}),Q=oe.reduce(Zl,{}),le=fe.slice(),_e=Object.create(null);let ve,Ne,Le,De,$e,Ue,Ye;for(ve=0,Ne=0;ve<fe.length;ve++)Le=fe[ve],Q.hasOwnProperty(Le)?Ne++:(ce.push({command:nr.removeLayer,args:[Le]}),le.splice(le.indexOf(Le,Ne),1));for(ve=0,Ne=0;ve<de.length;ve++)Le=de[de.length-1-ve],le[le.length-1-ve]!==Le&&(me.hasOwnProperty(Le)?(ce.push({command:nr.removeLayer,args:[Le]}),le.splice(le.lastIndexOf(Le,le.length-Ne),1)):Ne++,Ue=le[le.length-ve],ce.push({command:nr.addLayer,args:[Q[Le],Ue]}),le.splice(le.length-ve,0,Le),_e[Le]=!0);for(ve=0;ve<de.length;ve++)if(Le=de[ve],De=me[Le],$e=Q[Le],!_e[Le]&&!k(De,$e))if(k(De.source,$e.source)&&k(De["source-layer"],$e["source-layer"])&&k(De.type,$e.type)){for(Ye in Js(De.layout,$e.layout,ce,Le,null,nr.setLayoutProperty),Js(De.paint,$e.paint,ce,Le,null,nr.setPaintProperty),k(De.filter,$e.filter)||ce.push({command:nr.setFilter,args:[Le,$e.filter]}),k(De.minzoom,$e.minzoom)&&k(De.maxzoom,$e.maxzoom)||ce.push({command:nr.setLayerZoomRange,args:[Le,$e.minzoom,$e.maxzoom]}),De)De.hasOwnProperty(Ye)&&Ye!=="layout"&&Ye!=="paint"&&Ye!=="filter"&&Ye!=="metadata"&&Ye!=="minzoom"&&Ye!=="maxzoom"&&(Ye.indexOf("paint.")===0?Js(De[Ye],$e[Ye],ce,Le,Ye.slice(6),nr.setPaintProperty):k(De[Ye],$e[Ye])||ce.push({command:nr.setLayerProperty,args:[Le,Ye,$e[Ye]]}));for(Ye in $e)$e.hasOwnProperty(Ye)&&!De.hasOwnProperty(Ye)&&Ye!=="layout"&&Ye!=="paint"&&Ye!=="filter"&&Ye!=="metadata"&&Ye!=="minzoom"&&Ye!=="maxzoom"&&(Ye.indexOf("paint.")===0?Js(De[Ye],$e[Ye],ce,Le,Ye.slice(6),nr.setPaintProperty):k(De[Ye],$e[Ye])||ce.push({command:nr.setLayerProperty,args:[Le,Ye,$e[Ye]]}))}else ce.push({command:nr.removeLayer,args:[Le]}),Ue=le[le.lastIndexOf(Le)+1],ce.push({command:nr.addLayer,args:[$e,Ue]})})(G,C.layers,N)}catch(D){console.warn("Unable to compute style diff:",D),N=[{command:nr.setStyle,args:[C]}]}return N})(this.serialize(),o).filter((T=>!(T.command in Rh)));if(h.length===0)return!1;const _=h.filter((T=>!(T.command in dl)));if(_.length>0)throw new Error(`Unimplemented: ${_.map((T=>T.command)).join(", ")}.`);return h.forEach((T=>{T.command!=="setTransition"&&T.command!=="setProjection"&&this[T.command].apply(this,T.args)})),this.stylesheet=o,this._updateMapProjection(),!0}addImage(o,h){return this.getImage(o)?this.fire(new a.ErrorEvent(new Error("An image with this name already exists."))):(this.imageManager.addImage(o,h),this._afterImageUpdated(o),this)}updateImage(o,h){this.imageManager.updateImage(o,h)}getImage(o){return this.imageManager.getImage(o)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o),this._afterImageUpdated(o),this):this.fire(new a.ErrorEvent(new Error("No image with this name exists.")))}_afterImageUpdated(o){this._availableImages=this.imageManager.listImages(),this._changedImages[o]=!0,this._changed=!0,this.dispatcher.broadcast("setImages",this._availableImages),this.fire(new a.Event("data",{dataType:"style"}))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addSource(o,h,_={}){if(this._checkLoaded(),this.getSource(o)!==void 0)throw new Error("There is already a source with this ID");if(!h.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(h).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(h.type)>=0&&this._validate(a.validateSource,`sources.${o}`,h,null,_))return;this.map&&this.map._collectResourceTiming&&(h.collectResourceTiming=!0);const T=Pn(o,h,this.dispatcher,this);T.setEventedParent(this,(()=>({isSourceLoaded:this._isSourceCacheLoaded(o),source:T.serialize(),sourceId:o})));const C=N=>{const D=(N?"symbol:":"other:")+o,B=this._sourceCaches[D]=new a.SourceCache(D,T,N);(N?this._symbolSourceCaches:this._otherSourceCaches)[o]=B,B.style=this,B.onAdd(this.map)};C(!1),h.type!=="vector"&&h.type!=="geojson"||C(!0),T.onAdd&&T.onAdd(this.map),this._changed=!0}removeSource(o){this._checkLoaded();const h=this.getSource(o);if(!h)throw new Error("There is no source with this ID");for(const T in this._layers)if(this._layers[T].source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while layer "${T}" is using it.`)));if(this.terrain&&this.terrain.get().source===o)return this.fire(new a.ErrorEvent(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));const _=this._getSourceCaches(o);for(const T of _)delete this._sourceCaches[T.id],delete this._updatedSources[T.id],T.fire(new a.Event("data",{sourceDataType:"metadata",dataType:"source",sourceId:T.getSource().id})),T.setEventedParent(null),T.clearTiles();return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],h.setEventedParent(null),h.onRemove&&h.onRemove(this.map),this._changed=!0,this}setGeoJSONSourceData(o,h){this._checkLoaded(),this.getSource(o).setData(h),this._changed=!0}getSource(o){const h=this._getSourceCache(o);return h&&h.getSource()}_getSources(){const o=[];for(const h in this._otherSourceCaches){const _=this._getSourceCache(h);_&&o.push(_.getSource())}return o}addLayer(o,h,_={}){this._checkLoaded();const T=o.id;if(this.getLayer(T))return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${T}" already exists on this map`)));let C;if(o.type==="custom"){if(Uo(this,a.validateCustomStyleLayer(o)))return;C=a.createStyleLayer(o)}else{if(typeof o.source=="object"&&(this.addSource(T,o.source),o=a.clone$1(o),o=a.extend(o,{source:T})),this._validate(a.validateLayer,`layers.${T}`,o,{arrayIndex:-1},_))return;C=a.createStyleLayer(o),this._validateLayer(C),C.setEventedParent(this,{layer:{id:T}}),this._serializedLayers[C.id]=C.serialize(),this._updateLayerCount(C,!0)}const N=h?this._order.indexOf(h):this._order.length;if(h&&N===-1)return void this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`)));this._order.splice(N,0,T),this._layerOrderChanged=!0,this._layers[T]=C;const D=this._getLayerSourceCache(C);if(this._removedLayers[T]&&C.source&&D&&C.type!=="custom"){const B=this._removedLayers[T];delete this._removedLayers[T],B.type!==C.type?this._updatedSources[C.source]="clear":(this._updatedSources[C.source]="reload",D.pause())}this._updateLayer(C),C.onAdd&&C.onAdd(this.map),this._updateDrapeFirstLayers()}moveLayer(o,h){if(this._checkLoaded(),this._changed=!0,!this._layers[o])return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be moved.`)));if(o===h)return;const _=this._order.indexOf(o);this._order.splice(_,1);const T=h?this._order.indexOf(h):this._order.length;h&&T===-1?this.fire(new a.ErrorEvent(new Error(`Layer with id "${h}" does not exist on this map.`))):(this._order.splice(T,0,o),this._layerOrderChanged=!0,this._updateDrapeFirstLayers())}removeLayer(o){this._checkLoaded();const h=this._layers[o];if(!h)return void this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be removed.`)));h.setEventedParent(null),this._updateLayerCount(h,!1);const _=this._order.indexOf(o);this._order.splice(_,1),this._layerOrderChanged=!0,this._changed=!0,this._removedLayers[o]=h,delete this._layers[o],delete this._serializedLayers[o],delete this._updatedLayers[o],delete this._updatedPaintProps[o],h.onRemove&&h.onRemove(this.map),this._updateDrapeFirstLayers()}getLayer(o){return this._layers[o]}hasLayer(o){return o in this._layers}hasLayerType(o){for(const h in this._layers)if(this._layers[h].type===o)return!0;return!1}setLayerZoomRange(o,h,_){this._checkLoaded();const T=this.getLayer(o);T?T.minzoom===h&&T.maxzoom===_||(h!=null&&(T.minzoom=h),_!=null&&(T.maxzoom=_),this._updateLayer(T)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot have zoom extent.`)))}setFilter(o,h,_={}){this._checkLoaded();const T=this.getLayer(o);if(T){if(!k(T.filter,h))return h==null?(T.filter=void 0,void this._updateLayer(T)):void(this._validate(a.validateFilter,`layers.${T.id}.filter`,h,{layerType:T.type},_)||(T.filter=a.clone$1(h),this._updateLayer(T)))}else this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be filtered.`)))}getFilter(o){const h=this.getLayer(o);return h&&a.clone$1(h.filter)}setLayoutProperty(o,h,_,T={}){this._checkLoaded();const C=this.getLayer(o);C?k(C.getLayoutProperty(h),_)||(C.setLayoutProperty(h,_,T),this._updateLayer(C)):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getLayoutProperty(o,h){const _=this.getLayer(o);if(_)return _.getLayoutProperty(h);this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style.`)))}setPaintProperty(o,h,_,T={}){this._checkLoaded();const C=this.getLayer(o);C?k(C.getPaintProperty(h),_)||(C.setPaintProperty(h,_,T)&&this._updateLayer(C),this._changed=!0,this._updatedPaintProps[o]=!0):this.fire(new a.ErrorEvent(new Error(`The layer '${o}' does not exist in the map's style and cannot be styled.`)))}getPaintProperty(o,h){const _=this.getLayer(o);return _&&_.getPaintProperty(h)}setFeatureState(o,h){this._checkLoaded();const _=o.source,T=o.sourceLayer,C=this.getSource(_);if(!C)return void this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const N=C.type;if(N==="geojson"&&T)return void this.fire(new a.ErrorEvent(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(N==="vector"&&!T)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided.")));const D=this._getSourceCaches(_);for(const B of D)B.setFeatureState(T,o.id,h)}removeFeatureState(o,h){this._checkLoaded();const _=o.source,T=this.getSource(_);if(!T)return void this.fire(new a.ErrorEvent(new Error(`The source '${_}' does not exist in the map's style.`)));const C=T.type,N=C==="vector"?o.sourceLayer:void 0;if(C==="vector"&&!N)return void this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")));if(h&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new a.ErrorEvent(new Error("A feature id is required to remove its specific state property.")));const D=this._getSourceCaches(_);for(const B of D)B.removeFeatureState(N,o.id,h)}getFeatureState(o){this._checkLoaded();const h=o.source,_=o.sourceLayer,T=this.getSource(h);if(T){if(T.type!=="vector"||_)return o.id===void 0&&this.fire(new a.ErrorEvent(new Error("The feature id parameter must be provided."))),this._getSourceCaches(h)[0].getFeatureState(_,o.id);this.fire(new a.ErrorEvent(new Error("The sourceLayer parameter must be provided for vector source types.")))}else this.fire(new a.ErrorEvent(new Error(`The source '${h}' does not exist in the map's style.`)))}getTransition(){return a.extend({duration:300,delay:0},this.stylesheet&&this.stylesheet.transition)}serialize(){const o={};for(const h in this._sourceCaches){const _=this._sourceCaches[h].getSource();o[_.id]||(o[_.id]=_.serialize())}return a.filterObject({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,light:this.stylesheet.light,terrain:this.getTerrain()||void 0,fog:this.stylesheet.fog,center:this.stylesheet.center,zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:o,layers:this._serializeLayers(this._order)},(h=>h!==void 0))}_updateLayer(o){this._updatedLayers[o.id]=!0;const h=this._getLayerSourceCache(o);o.source&&!this._updatedSources[o.source]&&h&&h.getSource().type!=="raster"&&(this._updatedSources[o.source]="reload",h.pause()),this._changed=!0,o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const h=N=>this._layers[N].type==="fill-extrusion",_={},T=[];for(let N=this._order.length-1;N>=0;N--){const D=this._order[N];if(h(D)){_[D]=N;for(const B of o){const G=B[D];if(G)for(const $ of G)T.push($)}}}T.sort(((N,D)=>D.intersectionZ-N.intersectionZ));const C=[];for(let N=this._order.length-1;N>=0;N--){const D=this._order[N];if(h(D))for(let B=T.length-1;B>=0;B--){const G=T[B].feature;if(_[G.layer.id]<N)break;C.push(G),T.pop()}else for(const B of o){const G=B[D];if(G)for(const $ of G)C.push($.feature)}}return C}queryRenderedFeatures(o,h,_){h&&h.filter&&this._validate(a.validateFilter,"queryRenderedFeatures.filter",h.filter,null,h);const T={};if(h&&h.layers){if(!Array.isArray(h.layers))return this.fire(new a.ErrorEvent(new Error("parameters.layers must be an Array."))),[];for(const B of h.layers){const G=this._layers[B];if(!G)return this.fire(new a.ErrorEvent(new Error(`The layer '${B}' does not exist in the map's style and cannot be queried for features.`))),[];T[G.source]=!0}}const C=[];h.availableImages=this._availableImages;const N=h&&h.layers?h.layers.some((B=>{const G=this.getLayer(B);return G&&G.is3D()})):this.has3DLayers(),D=it.createFromScreenPoints(o,_);for(const B in this._sourceCaches){const G=this._sourceCaches[B].getSource().id;h.layers&&!T[G]||C.push(jr(this._sourceCaches[B],this._layers,this._serializedLayers,D,h,_,N,!!this.map._showQueryGeometry))}return this.placement&&C.push((function(B,G,$,J,oe,ce,fe){const de={},me=ce.queryRenderedSymbols(J),Q=[];for(const le of Object.keys(me).map(Number))Q.push(fe[le]);Q.sort(Zi);for(const le of Q){const _e=le.featureIndex.lookupSymbolFeatures(me[le.bucketInstanceId],G,le.bucketIndex,le.sourceLayerIndex,oe.filter,oe.layers,oe.availableImages,B);for(const ve in _e){const Ne=de[ve]=de[ve]||[],Le=_e[ve];Le.sort(((De,$e)=>{const Ue=le.featureSortOrder;if(Ue){const Ye=Ue.indexOf(De.featureIndex);return Ue.indexOf($e.featureIndex)-Ye}return $e.featureIndex-De.featureIndex}));for(const De of Le)Ne.push(De)}}for(const le in de)de[le].forEach((_e=>{const ve=_e.feature,Ne=$(B[le]);if(!Ne)return;const Le=Ne.getFeatureState(ve.layer["source-layer"],ve.id);ve.source=ve.layer.source,ve.layer["source-layer"]&&(ve.sourceLayer=ve.layer["source-layer"]),ve.state=Le}));return de})(this._layers,this._serializedLayers,this._getLayerSourceCache.bind(this),D.screenGeometry,h,this.placement.collisionIndex,this.placement.retainedQueryData)),this._flattenAndSortRenderedFeatures(C)}querySourceFeatures(o,h){h&&h.filter&&this._validate(a.validateFilter,"querySourceFeatures.filter",h.filter,null,h);const _=this._getSourceCaches(o);let T=[];for(const C of _)T=T.concat(ii(C,h));return T}addSourceType(o,h,_){return ro.getSourceType(o)?_(new Error(`A source type called "${o}" already exists.`)):(ro.setSourceType(o,h),h.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:h.workerSourceURL},_):_(null,null))}getLight(){return this.light.getLight()}setLight(o,h={}){this._checkLoaded();const _=this.light.getLight();let T=!1;for(const N in o)if(!k(o[N],_[N])){T=!0;break}if(!T)return;const C=this._setTransitionParameters({duration:300,delay:0});this.light.setLight(o,h),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}setTerrain(o,h=1){if(this._checkLoaded(),!o)return delete this.terrain,delete this.stylesheet.terrain,this.dispatcher.broadcast("enableTerrain",!1),this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);let _=o;if(h===1){if(typeof _.source=="object"){const T="terrain-dem-src";this.addSource(T,_.source),_=a.clone$1(_),_=a.extend(_,{source:T})}if(this._validate(a.validateTerrain,"terrain",_))return}if(!this.terrain||this.terrain&&h!==this.terrain.drapeRenderMode){if(!_)return;this._createTerrain(_,h)}else{const T=this.terrain,C=T.get();for(const N of Object.keys(a.spec.terrain))!_.hasOwnProperty(N)&&a.spec.terrain[N].default&&(_[N]=a.spec.terrain[N].default);for(const N in _)if(!k(_[N],C[N])){T.set(_),this.stylesheet.terrain=_;const D=this._setTransitionParameters({duration:0});T.updateTransitions(D);break}}this._updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const h=this.fog=new We(o,this.map.transform);this.stylesheet.fog=o;const _=this._setTransitionParameters({duration:0});h.updateTransitions(_)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask((()=>{for(const o of this.map._markers)o._evaluateOpacity()}))}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const h=this.fog,_=h.get();Object.keys(o).length===0&&h.set(o);for(const T in o)if(!k(o[T],_[T])){h.set(o),this.stylesheet.fog=o;const C=this._setTransitionParameters({duration:0});h.updateTransitions(C);break}}else this._createFog(o);this._markersNeedUpdate=!0}_setTransitionParameters(o){return{now:a.exported.now(),transition:a.extend(o,this.stylesheet.transition)}}_updateDrapeFirstLayers(){if(!this.map._optimizeForTerrain||!this.terrain)return;const o=this._order.filter((_=>this.isLayerDraped(this._layers[_]))),h=this._order.filter((_=>!this.isLayerDraped(this._layers[_])));this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...h)}_createTerrain(o,h){const _=this.terrain=new mt(o,h);this.stylesheet.terrain=o,this.dispatcher.broadcast("enableTerrain",!this.terrainSetForDrapingOnly()),this._force3DLayerUpdate();const T=this._setTransitionParameters({duration:0});_.updateTransitions(T)}_force3DLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="fill-extrusion"&&this._updateLayer(h)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const h=this._layers[o];h.type==="symbol"&&this._updateLayer(h)}}_validate(o,h,_,T,C={}){return(!C||C.validate!==!1)&&Uo(this,o.call(a.validateStyle,a.extend({key:h,style:this.serialize(),value:_,styleSpec:a.spec},T)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),a.evented.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._layers)this._layers[o].setEventedParent(null);for(const o in this._sourceCaches)this._sourceCaches[o].clearTiles(),this._sourceCaches[o].setEventedParent(null);this.imageManager.setEventedParent(null),this.setEventedParent(null),this.dispatcher.remove()}_clearSource(o){const h=this._getSourceCaches(o);for(const _ of h)_.clearTiles()}_reloadSource(o){const h=this._getSourceCaches(o);for(const _ of h)_.resume(),_.reload()}_reloadSources(){for(const o of this._getSources())o.reload&&o.reload()}_updateSources(o){for(const h in this._sourceCaches)this._sourceCaches[h].update(o)}_generateCollisionBoxes(){for(const o in this._sourceCaches){const h=this._sourceCaches[o];h.resume(),h.reload()}}_updatePlacement(o,h,_,T,C=!1){let N=!1,D=!1;const B={};for(const G of this._order){const $=this._layers[G];if($.type!=="symbol")continue;if(!B[$.source]){const oe=this._getLayerSourceCache($);if(!oe)continue;B[$.source]=oe.getRenderableIds(!0).map((ce=>oe.getTileByID(ce))).sort(((ce,fe)=>fe.tileID.overscaledZ-ce.tileID.overscaledZ||(ce.tileID.isLessThan(fe.tileID)?-1:1)))}const J=this.crossTileSymbolIndex.addLayer($,B[$.source],o.center.lng,o.projection);N=N||J}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._order),C=C||this._layerOrderChanged||_===0,this._layerOrderChanged&&this.fire(new a.Event("neworder")),(C||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(a.exported.now(),o.zoom))&&(this.pauseablePlacement=new ul(o,this._order,C,h,_,T,this.placement,this.fog&&o.projection.supportsFog?this.fog.state:null),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._order,this._layers,B),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(a.exported.now()),D=!0),N&&this.pauseablePlacement.placement.setStale()),D||N)for(const G of this._order){const $=this._layers[G];$.type==="symbol"&&this.placement.updateLayerOpacities($,B[$.source])}return!this.pauseablePlacement.isDone()||this.placement.hasTransitions(a.exported.now())}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}getImages(o,h,_){this.imageManager.getImages(h.icons,_),this._updateTilesForChangedImages();const T=C=>{C&&C.setDependencies(h.tileID.key,h.type,h.icons)};T(this._otherSourceCaches[h.source]),T(this._symbolSourceCaches[h.source])}getGlyphs(o,h,_){this.glyphManager.getGlyphs(h.stacks,_)}getResource(o,h,_){return a.makeRequest(h,_)}_getSourceCache(o){return this._otherSourceCaches[o]}_getLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}_getSourceCaches(o){const h=[];return this._otherSourceCaches[o]&&h.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&h.push(this._symbolSourceCaches[o]),h}_isSourceCacheLoaded(o){const h=this._getSourceCaches(o);return h.length===0?(this.fire(new a.ErrorEvent(new Error(`There is no source with ID '${o}'`))),!1):h.every((_=>_.loaded()))}has3DLayers(){return this._num3DLayers>0}hasSymbolLayers(){return this._numSymbolLayers>0}hasCircleLayers(){return this._numCircleLayers>0}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}ro.getSourceType=function(g){return kn[g]},ro.setSourceType=function(g,o){kn[g]=o},ro.registerForPluginStateChange=a.registerForPluginStateChange;var ec=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#define EXTENT 8192.0
#define HALF_PI PI/2.0
#define QUARTER_PI PI/4.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0`,Ia="attribute highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;varying highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",io=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}
#ifdef TERRAIN
#ifdef TERRAIN_DEM_FLOAT_FORMAT
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;
#else
uniform sampler2D u_dem;uniform sampler2D u_dem_prev;
#endif
uniform vec4 u_dem_unpack;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;uniform sampler2D u_depth;uniform vec2 u_depth_size_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float decodeElevation(vec4 v) {return dot(vec4(v.xyz*255.0,-1.0),u_dem_unpack);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem,pos));
#ifdef TERRAIN_DEM_NEAREST_FILTER
return u_exaggeration*tl;
#endif
float tr=decodeElevation(texture2D(u_dem,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture2D(u_dem_prev,pos).a;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=decodeElevation(texture2D(u_dem_prev,pos));float tr=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,0.0)));float bl=decodeElevation(texture2D(u_dem_prev,pos+vec2(0.0,dd)));float br=decodeElevation(texture2D(u_dem_prev,pos+vec2(dd,dd)));return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;float depth=unpack_depth(texture2D(u_depth,(coord.xy+1.0)*0.5));return coord.z > depth+0.0005;}float occlusionFade(vec4 frag) {vec3 coord=frag.xyz/frag.w;vec3 df=vec3(5.0*u_depth_size_inv,0.0);vec2 uv=0.5*coord.xy+0.5;vec4 depth=vec4(
unpack_depth(texture2D(u_depth,uv-df.xz)),unpack_depth(texture2D(u_depth,uv+df.xz)),unpack_depth(texture2D(u_depth,uv-df.zy)),unpack_depth(texture2D(u_depth,uv+df.zy))
);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z-0.001)-depth),0.0,1.0));}vec4 fourSample(vec2 pos,vec2 off) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
float tl=texture2D(u_dem,pos).a;float tr=texture2D(u_dem,pos+vec2(off.x,0.0)).a;float bl=texture2D(u_dem,pos+vec2(0.0,off.y)).a;float br=texture2D(u_dem,pos+off).a;
#else
vec4 demtl=vec4(texture2D(u_dem,pos).xyz*255.0,-1.0);float tl=dot(demtl,u_dem_unpack);vec4 demtr=vec4(texture2D(u_dem,pos+vec2(off.x,0.0)).xyz*255.0,-1.0);float tr=dot(demtr,u_dem_unpack);vec4 dembl=vec4(texture2D(u_dem,pos+vec2(0.0,off.y)).xyz*255.0,-1.0);float bl=dot(dembl,u_dem_unpack);vec4 dembr=vec4(texture2D(u_dem,pos+off).xyz*255.0,-1.0);float br=dot(dembr,u_dem_unpack);
#endif
return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }bool isOccluded(vec4 frag) { return false; }float occlusionFade(vec4 frag) { return 1.0; }
#endif`,Ma=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;varying vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,$o=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump float u_fog_temporal_offset;varying vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,opacity);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec3 fog_dither(vec3 color) {vec2 dither_seed=gl_FragCoord.xy+u_fog_temporal_offset;return dither(color,dither_seed);}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`;let Xi={},bo={};const hl=[];Go(ec,hl),Go(io,hl),Go(Ma,hl),Go($o,hl),Xi=Yn("",io),bo=Yn($o,Ma);const tc=Yn(`
#if __VERSION__ >=300
#define varying in
#define gl_FragColor glFragColor
#define texture2D texture
#define textureCube texture
out vec4 glFragColor;
#endif
highp vec3 hash(highp vec2 p) {highp vec3 p3=fract(p.xyx*vec3(443.8975,397.2973,491.1871));p3+=dot(p3,p3.yxz+19.19);return fract((p3.xxy+p3.yzz)*p3.zyx);}vec3 dither(vec3 color,highp vec2 seed) {vec3 rnd=hash(seed)+hash(seed+0.59374)-0.5;return color+rnd/255.0;}highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}`,`
#if __VERSION__ >=300
#define attribute in
#define varying out
#define texture2D texture
#endif
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (tile_units_to_pixels*pos+offset)/pattern_size;}const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);//Normalized device coordinate that is not rendered.`),od=ec,ru=`
#ifdef GL_ES
precision mediump float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`;var iu={background:Yn(`uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
varying vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform vec4 u_color;varying vec4 v_color;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(u_color);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:Yn(`uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform sampler2D u_image;varying vec2 v_pos;void main() {vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),circle:Yn(`varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float extrude_length=length(extrude);lowp float antialiasblur=v_data.z;float antialiased_blur=-max(blur,antialiasblur);float opacity_t=smoothstep(0.0,antialiased_blur,extrude_length-1.0);float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
gl_FragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec3 v_data;varying float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:Yn("void main() {gl_FragColor=vec4(1.0);}","attribute vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:Yn(`uniform highp float u_intensity;varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);gl_FragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {gl_FragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
varying vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:Yn(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;varying vec2 v_pos;void main() {float t=texture2D(u_image,v_pos).r;vec4 color=texture2D(u_color_ramp,vec2(t,0.5));gl_FragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(0.0);
#endif
}`,"attribute vec2 a_pos;varying vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:Yn("varying float v_placed;varying float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);gl_FragColor =mix(red,blue,step(0.5,v_placed))*0.5;gl_FragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`attribute vec3 a_pos;attribute vec2 a_anchor_pos;attribute vec2 a_extrude;attribute vec2 a_placed;attribute vec2 a_shift;attribute float a_size_scale;attribute vec2 a_padding;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;varying float v_placed;varying float v_notUsed;void main() {vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*elevation(a_anchor_pos),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:Yn("varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);gl_FragColor=color*alpha*opacity_t;}",`attribute vec2 a_pos_2f;attribute float a_radius;attribute vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;varying float v_radius;varying vec2 v_extrude;varying float v_perspective_ratio;varying float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:Yn("uniform highp vec4 u_color;uniform sampler2D u_overlay;varying vec2 v_uv;void main() {vec4 overlay_color=texture2D(u_overlay,v_uv);gl_FragColor=mix(u_color,overlay_color,overlay_color.a);}",`attribute vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;
#endif
varying vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),fill:Yn(`#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutline:Yn(`varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec2 a_pos;uniform mat4 u_matrix;uniform vec2 u_world;varying vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:Yn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;varying vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;gl_Position=u_matrix*vec4(a_pos,0,1);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:Yn(`uniform vec2 u_texsize;uniform sampler2D u_image;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;attribute vec2 a_pos;varying vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:Yn(`varying vec4 v_color;
#ifdef RENDER_SHADOWS
varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
void main() {
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
vec3 normal=v_normal;
#endif
float z;vec4 color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);color=mix(v_color,v_roof_color,z);
#else
color=v_color;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);color.rgb=color.rgb*shade;
#endif
#ifdef RENDER_SHADOWS
#ifdef ZERO_ROOF_RADIUS
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#endif
color.xyz=shadowed_color_normal(color.xyz,normalize(normal),v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec4 v_color;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying highp vec4 v_pos_light_view_0;varying highp vec4 v_pos_light_view_1;varying float v_depth;
#endif
#ifdef ZERO_ROOF_RADIUS
varying vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
varying highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS)
v_normal=normal;
#endif
base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele;vec3 pos;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
v_pos_light_view_0=u_light_matrix_0*vec4(pos,1);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1);v_depth=gl_Position.w;
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}v_color=vec4(0.0,0.0,0.0,1.0);
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting(color,NdotL);
#else
v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_color*=u_opacity;
#ifdef ZERO_ROOF_RADIUS
v_roof_color=vec4(0.0,0.0,0.0,1.0);
#ifdef LIGHTING_3D_MODE
v_roof_color=apply_lighting(color,calculate_NdotL(vec3(0.0,0.0,1.0)));
#else
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));
#endif
v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionPattern:Yn(`uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
varying vec2 v_pos;varying vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 imagecoord=mod(v_pos,1.0);vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);vec4 out_color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,v_NdotL)*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
gl_FragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;attribute vec4 a_pos_normal_ed;attribute vec2 a_centroid_pos;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_pos_3;attribute vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
varying vec2 v_pos;varying vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;varying vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
varying float v_NdotL;
#endif
#pragma mapbox: define lowp float base
#pragma mapbox: define lowp float height
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float base
#pragma mapbox: initialize lowp float height
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool flat_roof=centroid_pos.x !=0.0 && t > 0.0;ele=elevation(pos_nx.xy);c_ele=flat_roof ? centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos) : ele;h=flat_roof ? max(c_ele+height,ele+base+2.0) : ele+(t > 0.0 ? height : base==0.0 ?-5.0 : base);p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float hidden=float(centroid_pos.x==0.0 && centroid_pos.y==1.0);gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_NdotL=NdotL;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif 
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),hillshadePrepare:Yn(`#ifdef GL_ES
precision highp float;
#endif
uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;uniform vec4 u_unpack;float getElevation(vec2 coord) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
return texture2D(u_image,coord).a/4.0;
#else
vec4 data=texture2D(u_image,coord)*255.0;data.a=-1.0;return dot(data,u_unpack)/4.0;
#endif
}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));gl_FragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:Yn(`uniform sampler2D u_image;varying vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;void main() {vec4 pixel=texture2D(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);gl_FragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
gl_FragColor=apply_lighting(gl_FragColor);
#endif
#ifdef FOG
gl_FragColor=fog_dither(fog_apply_premultiplied(gl_FragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:Yn(`uniform lowp float u_device_pixel_ratio;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;varying vec2 v_width2;varying vec2 v_normal;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
uniform float u_border_width;uniform vec4 u_border_color;float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture2D(u_dash_image,v_tex).a;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;alpha*=linearstep(0.5-sdfgamma/floorwidth,0.5+sdfgamma/floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture2D(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trimmed=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float start=v_uv[2];highp float end=v_uv[3];highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=(start+(v_uv.x)*(end-start));if (trim_end > trim_start) {if (line_progress <=trim_end && line_progress >=trim_start) {out_color=vec4(0,0,0,0);trimmed=0.0;}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef RENDER_LINE_ALPHA_DISCARD
if (alpha < u_alpha_discard_threshold) {discard;}
#endif
#ifdef RENDER_LINE_BORDER
float edgeBlur=(u_border_width+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);
#ifdef RENDER_LINE_BORDER_AUTO
float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}
#else
out_color.rgb=mix(u_border_color.rgb*u_border_color.a*trimmed,out_color.rgb,smoothAlpha);
#endif
}
#endif
gl_FragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define EXTRUDE_SCALE 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
attribute highp vec4 a_packed;
#endif
#ifdef RENDER_LINE_DASH
attribute float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_gamma_scale;varying highp vec4 v_uv;
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;varying vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float a_clip_start=a_packed[2];highp float a_clip_end=a_packed[3];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec4(a_uv_x,a_split_index*texel_height-half_texel_height,a_clip_start,a_clip_end);
#else
v_uv=vec4(a_uv_x,0.0,a_clip_start,a_clip_end);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/floorwidth,(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),linePattern:Yn(`uniform lowp float u_device_pixel_ratio;uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;uniform sampler2D u_image;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;vec2 pattern_size=vec2(display_size.x/u_tile_units_to_pixels,display_size.y);float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);float x=mod(v_linesofar/pattern_size.x*aspect,1.0);float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));vec4 color=texture2D(u_image,pos);
#ifdef LIGHTING_3D_MODE
color=apply_lighting(color);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`
#define scale 0.015873016
attribute vec2 a_pos_normal;attribute vec4 a_data;attribute float a_linesofar;uniform mat4 u_matrix;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform lowp float u_device_pixel_ratio;varying vec2 v_normal;varying vec2 v_width2;varying float v_linesofar;varying float v_gamma_scale;varying float v_width;
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 pattern
#pragma mapbox: define lowp float pixel_ratio
void main() {
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=width/2.0;offset=-1.0*offset;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*scale;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);vec4 projected_extrude=u_matrix*vec4(dist*u_pixels_to_tile_units,0.0,0.0);gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude;
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude.xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=extrude_length_without_perspective/extrude_length_with_perspective;
#else
v_gamma_scale=1.0;
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=floorwidth;
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),raster:Yn(`uniform float u_fade_t;uniform float u_opacity;uniform sampler2D u_image0;uniform sampler2D u_image1;varying vec2 v_pos0;varying vec2 v_pos1;uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;void main() {vec4 color0=texture2D(u_image0,v_pos0);vec4 color1=texture2D(u_image1,v_pos1);if (color0.a > 0.0) {color0.rgb=color0.rgb/color0.a;}if (color1.a > 0.0) {color1.rgb=color1.rgb/color1.a;}vec4 color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply(out_color,v_fog_pos));
#endif
gl_FragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;attribute vec2 a_pos;attribute vec2 a_texture_pos;varying vec2 v_pos0;varying vec2 v_pos1;void main() {float w=1.0+dot(a_texture_pos,u_perspective_transform);gl_Position=u_matrix*vec4(a_pos*w,0,w);v_pos0=a_texture_pos/8192.0;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),symbolIcon:Yn(`uniform sampler2D u_texture;varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
lowp float alpha=opacity*v_fade_opacity;gl_FragColor=texture2D(u_texture,v_tex)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform highp float u_camera_to_center_distance;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform float u_fade_change;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_tex;varying float v_fade_opacity;
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize lowp float opacity
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetProjected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetProjected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetProjected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetProjected_point.xy/offsetProjected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_tex=a_tex/u_texsize;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;v_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change))*projection_transition_fade;}`),symbolSDF:Yn(`#define SDF_PX 8.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float EDGE_GAMMA=0.105/u_device_pixel_ratio;vec2 tex=v_data0.xy;float gamma_scale=v_data1.x;float size=v_data1.y;float fade_opacity=v_data1[2];float fontScale=u_is_text ? size/24.0 : size;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_pixeloffset;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec2 v_data0;varying vec3 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float fontScale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);
#endif
vec2 a=projected_point.xy/projected_point.w;vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*fontScale+a_pxoffset);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));v_data0=a_tex/u_texsize;v_data1=vec3(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade);}`),symbolTextAndIcon:Yn(`#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform bool u_is_halo;uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
float fade_opacity=v_data1[2];if (v_data1.w==ICON) {vec2 tex_icon=v_data0.zw;lowp float alpha=opacity*fade_opacity;gl_FragColor=texture2D(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
return;}vec2 tex=v_data0.xy;float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_data1.x;float size=v_data1.y;float fontScale=size/24.0;lowp vec4 color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;if (u_is_halo) {color=halo_color;gamma=(halo_blur*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width/fontScale)/SDF_PX;}lowp float dist=texture2D(u_texture,tex).a;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);gl_FragColor=color*(alpha*opacity*fade_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`attribute vec4 a_pos_offset;attribute vec4 a_tex_size;attribute vec4 a_projected_pos;attribute float a_fade_opacity;
#ifdef PROJECTION_GLOBE_VIEW
attribute vec3 a_globe_anchor;attribute vec3 a_globe_normal;
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
varying vec4 v_data0;varying vec4 v_data1;
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);float is_sdf=a_size[0]-2.0*a_size_min;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;vec3 h=elevationVector(tile_anchor)*elevation(tile_anchor);float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos=mix_globe_mercator(a_globe_anchor+h,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=size/24.0;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offset_projected_point=u_matrix*vec4(a_pos+vec2(1,0),0,1);vec2 a=projected_point.xy/projected_point.w;vec2 b=offset_projected_point.xy/offset_projected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz+h,mercator_pos,u_zoom_transition);projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*font_scale);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
float occlusion_fade=occlusionFade(projected_point)*globe_occlusion_fade;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);gl_Position=mix(u_coord_matrix*vec4(projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#else
gl_Position=mix(u_coord_matrix*vec4(projected_pos.xy/projected_pos.w+offset,z,1.0),AWAY,float(projected_point.w <=0.0 || occlusion_fade==0.0));
#endif
float gamma_scale=gl_Position.w;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float interpolated_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));float projection_transition_fade=1.0;
#if defined(PROJECTED_POS_ON_VIEWPORT) && defined(PROJECTION_GLOBE_VIEW)
projection_transition_fade=1.0-step(EPSILON,u_zoom_transition);
#endif
v_data0.xy=a_tex/u_texsize;v_data0.zw=a_tex/u_texsize_icon;v_data1=vec4(gamma_scale,size,interpolated_fade_opacity*projection_transition_fade,is_sdf);}`),terrainRaster:Yn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
void main() {vec4 color=texture2D(u_image0,v_pos0);
#ifdef RENDER_SHADOWS
color.xyz=shadowed_color(color.xyz,v_pos_light_view_0,v_pos_light_view_1,v_depth);
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_matrix;uniform float u_skirt_height;attribute vec2 a_pos;varying vec2 v_pos0;
#ifdef FOG
varying float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;varying vec4 v_pos_light_view_0;varying vec4 v_pos_light_view_1;varying float v_depth;
#endif
const float wireframeOffset=0.00015;void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;
#ifdef TERRAIN_WIREFRAME
elevation+=wireframeOffset;
#endif
v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);v_depth=gl_Position.w;
#endif
}`),terrainDepth:Yn(`#ifdef GL_ES
precision highp float;
#endif
varying float v_depth;void main() {gl_FragColor=pack_depth(v_depth);}`,"uniform mat4 u_matrix;attribute vec2 a_pos;varying float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}"),skybox:Yn(`
varying lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=textureCube(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color.rgb=dither(sky_color.rgb,gl_FragCoord.xy+u_temporal_offset);sky_color+=0.1*sun_disk(v_uv,u_sun_direction);gl_FragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxGradient:Yn(`varying highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture2D(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;color.rgb=dither(color.rgb,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=color;
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,Ia),skyboxCapture:Yn(`
varying highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;
#ifdef GL_ES
precision highp float;
#endif
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;gl_FragColor=vec4(color,1.0);}`,"attribute highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;varying highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:Yn(`uniform sampler2D u_image0;varying vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);vec3 dir=normalize(ray_dir);vec3 closest_point=dot(u_globe_pos,dir)*dir;float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture2D(u_image0,v_pos0);color=vec4(raster.rgb*antialias,raster.a*antialias);
#else
color=texture2D(u_image0,v_pos0);
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
gl_FragColor=color;
#ifdef TERRAIN_WIREFRAME
gl_FragColor=vec4(1.0,0.0,0.0,0.8);
#endif
#ifdef OVERDRAW_INSPECTOR
gl_FragColor=vec4(1.0);
#endif
}`,`uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
attribute vec3 a_globe_pos;attribute vec2 a_uv;
#else
attribute vec2 a_pos;
#endif
varying vec2 v_pos0;const float wireframeOffset=1e3;float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(QUARTER_PI+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);
#ifdef TERRAIN_WIREFRAME
height+=wireframeOffset;
#endif
globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:Yn(`uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec3 u_start_color;uniform vec4 u_color;uniform vec4 u_space_color;uniform vec4 u_high_color;uniform float u_star_intensity;uniform float u_star_size;uniform float u_star_density;uniform float u_horizon_angle;uniform mat4 u_rotation_matrix;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;highp float random(highp vec3 p) {p=fract(p*vec3(23.2342,97.1231,91.2342));p+=dot(p.zxy,p.yxz+123.1234);return fract(p.x*p.y);}float stars(vec3 p,float scale,vec2 offset) {vec2 uv_scale=(u_viewport/u_star_size)*scale;vec3 position=vec3(p.xy*uv_scale+offset*u_viewport,p.z);vec3 q=fract(position)-0.5;vec3 id=floor(position);float random_visibility=step(random(id),u_star_density);float circle=smoothstep(0.5+u_star_intensity,0.5,length(q));return circle*random_visibility;}void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {discard;return;}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(dot(dir,horizon_dir)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;float closest_point_to_center=length(closest_point-u_globe_pos);float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c =mix(color_stop_2,c2,t);float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);vec2 uv=gl_FragCoord.xy/u_viewport-0.5;float aspect_ratio=u_viewport.x/u_viewport.y;vec4 uv_dir=vec4(normalize(vec3(uv.x*aspect_ratio,uv.y,1.0)),1.0);uv_dir=u_rotation_matrix*uv_dir;vec3 n=abs(uv_dir.xyz);vec2 uv_remap=(n.x > n.y && n.x > n.z) ? uv_dir.yz/uv_dir.x:
(n.y > n.x && n.y > n.z) ? uv_dir.zx/uv_dir.y:
uv_dir.xy/uv_dir.z;uv_remap.x/=aspect_ratio;vec3 D=vec3(uv_remap,1.0);highp float star_field=0.0;if (u_star_intensity > 0.0) {star_field+=stars(D,1.2,vec2(0.0,0.0));star_field+=stars(D,1.0,vec2(1.0,0.0));star_field+=stars(D,0.8,vec2(0.0,1.0));star_field+=stars(D,0.6,vec2(1.0,1.0));star_field*=(1.0-pow(t,0.25+(1.0-u_high_color.a)*0.75));c+=star_field*alpha_2;}c=dither(c,gl_FragCoord.xy+u_temporal_offset);gl_FragColor=vec4(c,a);}`,`attribute vec3 a_pos;attribute vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;varying highp vec3 v_ray_dir;varying highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`)};function Go(g,o){const h=g.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let _ of h)if(_=_.trim(),_[0]==="#"&&_.includes("if")&&!_.includes("endif")){_=_.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const T=_.split(" ");for(const C of T)o.includes(C)||o.push(C)}}function Yn(g,o){const h=/#pragma mapbox: ([\w]+) ([\w]+) ([\w]+) ([\w]+)/g,_=o.match(/attribute (highp |mediump |lowp )?([\w]+) ([\w]+)/g),T={},C=[...hl];return Go(g,C),Go(o,C),{fragmentSource:g=g.replace(h,((N,D,B,G,$)=>(T[$]=!0,D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
varying ${B} ${G} ${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:`
#ifdef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = u_${$};
#endif
`))),vertexSource:o=o.replace(h,((N,D,B,G,$)=>{const J=G==="float"?"vec2":"vec4",oe=$.match(/color/)?"color":J;return T[$]?D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${J} a_${$};
varying ${B} ${G} ${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = a_${$};
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:D==="define"?`
#ifndef HAS_UNIFORM_u_${$}
uniform lowp float u_${$}_t;
attribute ${B} ${J} a_${$};
#else
uniform ${B} ${G} u_${$};
#endif
`:oe==="vec4"?`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = a_${$};
#else
    ${B} ${G} ${$} = u_${$};
#endif
`:`
#ifndef HAS_UNIFORM_u_${$}
    ${B} ${G} ${$} = unpack_mix_${oe}(a_${$}, u_${$}_t);
#else
    ${B} ${G} ${$} = u_${$};
#endif
`})),staticAttributes:_,usedDefines:C}}class hp{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,h,_,T,C,N,D){this.context=o;let B=this.boundPaintVertexBuffers.length!==T.length;for(let $=0;!B&&$<T.length;$++)this.boundPaintVertexBuffers[$]!==T[$]&&(B=!0);let G=this.boundDynamicVertexBuffers.length!==D.length;for(let $=0;!G&&$<D.length;$++)this.boundDynamicVertexBuffers[$]!==D[$]&&(G=!0);if(!o.extVertexArrayObject||!this.vao||this.boundProgram!==h||this.boundLayoutVertexBuffer!==_||B||G||this.boundIndexBuffer!==C||this.boundVertexOffset!==N)this.freshBind(h,_,T,C,N,D);else{o.bindVertexArrayOES.set(this.vao);for(const $ of D)$&&$.bind();C&&C.dynamicDraw&&C.bind()}}freshBind(o,h,_,T,C,N){let D;const B=o.numAttributes,G=this.context,$=G.gl;if(G.extVertexArrayObject)this.vao&&this.destroy(),this.vao=G.extVertexArrayObject.createVertexArrayOES(),G.bindVertexArrayOES.set(this.vao),D=0,this.boundProgram=o,this.boundLayoutVertexBuffer=h,this.boundPaintVertexBuffers=_,this.boundIndexBuffer=T,this.boundVertexOffset=C,this.boundDynamicVertexBuffers=N;else{D=G.currentNumAttributes||0;for(let J=B;J<D;J++)$.disableVertexAttribArray(J)}h.enableAttributes($,o),h.bind(),h.setVertexAttribPointers($,o,C);for(const J of _)J.enableAttributes($,o),J.bind(),J.setVertexAttribPointers($,o,C);for(const J of N)J&&(J.enableAttributes($,o),J.bind(),J.setVertexAttribPointers($,o,C));T&&T.bind(),G.currentNumAttributes=B}destroy(){this.vao&&(this.context.extVertexArrayObject.deleteVertexArrayOES(this.vao),this.vao=null)}}function Nh(g,o){const h=Math.pow(2,o.canonical.z),_=o.canonical.y;return[new a.MercatorCoordinate(0,_/h).toLngLat().lat,new a.MercatorCoordinate(0,(_+1)/h).toLngLat().lat]}function fp(g,o,h,_,T,C,N){const D=g.context,B=D.gl,G=h.fbo;if(!G)return;g.prepareDrawTile();const $=g.useProgram("hillshade");D.activeTexture.set(B.TEXTURE0),B.bindTexture(B.TEXTURE_2D,G.colorAttachment.get());const J=((de,me,Q,le)=>{const _e=Q.paint.get("hillshade-shadow-color"),ve=Q.paint.get("hillshade-highlight-color"),Ne=Q.paint.get("hillshade-accent-color");let Le=Q.paint.get("hillshade-illumination-direction")*(Math.PI/180);Q.paint.get("hillshade-illumination-anchor")==="viewport"&&(Le-=de.transform.angle);const De=!de.options.moving;return{u_matrix:le||de.transform.calculateProjMatrix(me.tileID.toUnwrapped(),De),u_image:0,u_latrange:Nh(0,me.tileID),u_light:[Q.paint.get("hillshade-exaggeration"),Le],u_shadow:_e,u_highlight:ve,u_accent:Ne}})(g,h,_,g.terrain?o.projMatrix:null);g.prepareDrawProgram(D,$,o.toUnwrapped());const{tileBoundsBuffer:oe,tileBoundsIndexBuffer:ce,tileBoundsSegments:fe}=g.getTileBoundsBuffers(h);$.draw(D,B.TRIANGLES,T,C,N,a.CullFaceMode.disabled,J,_.id,oe,ce,fe)}function Dh(g,o,h){if(!o.needsDEMTextureUpload)return;const _=g.context,T=_.gl;_.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||g.getTileTexture(h.stride);const C=h.getPixels();o.demTexture?o.demTexture.update(C,{premultiply:!1}):o.demTexture=new a.Texture(_,C,T.RGBA,{premultiply:!1}),o.needsDEMTextureUpload=!1}function ad(g,o,h,_,T,C){const N=g.context,D=N.gl;if(!o.dem)return;const B=o.dem;if(N.activeTexture.set(D.TEXTURE1),Dh(g,o,B),!o.demTexture)return;o.demTexture.bind(D.NEAREST,D.CLAMP_TO_EDGE);const G=B.dim;N.activeTexture.set(D.TEXTURE0);let $=o.fbo;if(!$){const fe=new a.Texture(N,{width:G,height:G,data:null},D.RGBA);fe.bind(D.LINEAR,D.CLAMP_TO_EDGE),$=o.fbo=N.createFramebuffer(G,G,!0),$.colorAttachment.set(fe.texture)}N.bindFramebuffer.set($.framebuffer),N.viewport.set([0,0,G,G]);const{tileBoundsBuffer:J,tileBoundsIndexBuffer:oe,tileBoundsSegments:ce}=g.getMercatorTileBoundsBuffers();g.useProgram("hillshadePrepare").draw(N,D.TRIANGLES,_,T,C,a.CullFaceMode.disabled,((fe,de)=>{const me=de.stride,Q=a.create();return a.ortho(Q,0,a.EXTENT,-a.EXTENT,0,0,1),a.translate(Q,Q,[0,-a.EXTENT,0]),{u_matrix:Q,u_image:1,u_dimension:[me,me],u_zoom:fe.overscaledZ,u_unpack:de.unpackVector}})(o.tileID,B),h.id,J,oe,ce),o.needsHillshadePrepare=!1}const Lh=g=>({u_matrix:new a.UniformMatrix4f(g),u_image0:new a.Uniform1i(g),u_skirt_height:new a.Uniform1f(g)}),nc=(g,o)=>({u_matrix:g,u_image0:0,u_skirt_height:o}),ld=(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe)=>({u_proj_matrix:Float32Array.from(g),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(_),u_merc_matrix:h,u_zoom_transition:T,u_merc_center:C,u_image0:0,u_frustum_tl:N,u_frustum_tr:D,u_frustum_br:B,u_frustum_bl:G,u_globe_pos:$,u_globe_radius:J,u_viewport:oe,u_grid_matrix:fe?Float32Array.from(fe):new Float32Array(9),u_skirt_height:ce});function rc(g,o){return g!=null&&o!=null&&!(!g.hasData()||!o.hasData())&&g.demTexture!=null&&o.demTexture!=null&&g.tileID.key!==o.tileID.key}const oa=new class{constructor(){this.operations={}}newMorphing(g,o,h,_,T){if(g in this.operations){const C=this.operations[g];C.to.tileID.key!==h.tileID.key&&(C.queued=h)}else this.operations[g]={startTime:_,phase:0,duration:T,from:o,to:h,queued:null}}getMorphValuesForProxy(g){if(!(g in this.operations))return null;const o=this.operations[g];return{from:o.from,to:o.to,phase:o.phase}}update(g){for(const o in this.operations){const h=this.operations[o];for(h.phase=(g-h.startTime)/h.duration;h.phase>=1||!this._validOp(h);)if(!this._nextOp(h,g)){delete this.operations[o];break}}}_nextOp(g,o){return!!g.queued&&(g.from=g.to,g.to=g.queued,g.queued=null,g.phase=0,g.startTime=o,!0)}_validOp(g){return g.from.hasData()&&g.to.hasData()}},Pa={0:null,1:"TERRAIN_VERTEX_MORPHING",2:"TERRAIN_WIREFRAME"};function cd(g){return 6*Math.pow(1.5,22-g)}function pp(g,o){const h=1<<g.z;return!o&&(g.x===0||g.x===h-1)||g.y===0||g.y===h-1}const su=g=>({u_matrix:g});function jh(g,o,h,_,T){if(T>0){const C=a.exported.now(),N=(C-g.timeAdded)/T,D=o?(C-o.timeAdded)/T:-1,B=h.getSource(),G=_.coveringZoomLevel({tileSize:B.tileSize,roundZoom:B.roundZoom}),$=!o||Math.abs(o.tileID.overscaledZ-G)>Math.abs(g.tileID.overscaledZ-G),J=$&&g.refreshedUponExpiration?1:a.clamp($?N:1-D,0,1);return g.refreshedUponExpiration&&N>=1&&(g.refreshedUponExpiration=!1),o?{opacity:1,mix:1-J}:{opacity:J,mix:0}}return{opacity:1,mix:0}}class ou extends a.SourceCache{constructor(o){const h={type:"raster-dem",maxzoom:o.transform.maxZoom},_=new he(ll(),null),T=Pn("mock-dem",h,_,o.style);super("mock-dem",T,!1),T.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,h){o.state="loaded",h(null)}}class ud extends a.SourceCache{constructor(o){const h=Pn("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new he(ll(),null),o.style);super("proxy",h,!1),h.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,h,_){if(o.freezeTileCoverage)return;this.transform=o;const T=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce(((C,N)=>{if(C[N.key]="",!this._tiles[N.key]){const D=new a.Tile(N,this._source.tileSize*N.overscaleFactor(),o.tileZoom);D.state="loaded",this._tiles[N.key]=D}return C}),{});for(const C in this._tiles)C in T||(this.freeFBO(C),this._tiles[C].unloadVectorData(),delete this._tiles[C])}freeFBO(o){const h=this.proxyCachedFBO[o];if(h!==void 0){const _=Object.values(h);this.renderCachePool.push(..._),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach((o=>o.fb.destroy())),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class dd extends a.OverscaledTileID{constructor(o,h,_){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=h,this.projMatrix=_}}class Oh extends a.Elevation{constructor(o,h){super(),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[_,T,C]=(function(B){const G=new a.StructArrayLayout2i4,$=new a.StructArrayLayout3ui6,J=131;G.reserve(17161),$.reserve(33800);const oe=a.EXTENT/128,ce=a.EXTENT+oe/2,fe=ce+oe;for(let me=-oe;me<fe;me+=oe)for(let Q=-oe;Q<fe;Q+=oe){const le=Q<0||Q>ce||me<0||me>ce?24575:0,_e=a.clamp(Math.round(Q),0,a.EXTENT),ve=a.clamp(Math.round(me),0,a.EXTENT);G.emplaceBack(_e+le,ve)}const de=(me,Q)=>{const le=Q*J+me;$.emplaceBack(le+1,le,le+J),$.emplaceBack(le+J,le+J+1,le+1)};for(let me=1;me<129;me++)for(let Q=1;Q<129;Q++)de(Q,me);return[0,129].forEach((me=>{for(let Q=0;Q<130;Q++)de(Q,me),de(me,Q)})),[G,$,32768]})(),N=o.context;this.gridBuffer=N.createVertexBuffer(_,a.posAttributes.members),this.gridIndexBuffer=N.createIndexBuffer(T),this.gridSegments=a.SegmentVector.simpleSegment(0,0,_.length,T.length),this.gridNoSkirtSegments=a.SegmentVector.simpleSegment(0,0,_.length,C),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new ud(h.map),this.orthoMatrix=a.create(),a.ortho(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,a.EXTENT,0,a.EXTENT,0,1);const D=N.gl;this._overlapStencilMode=new a.StencilMode({func:D.GEQUAL,mask:255},0,255,D.KEEP,D.KEEP,D.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=h,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new ou(h.map)}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),o.on("neworder",this._checkRenderCacheEfficiency.bind(this)),this._style=o,this._checkRenderCacheEfficiency(),this._style.map.on("moveend",(()=>{this._clearLineLayersFromRenderCache()}))}update(o,h,_){if(o&&o.terrain){this._style!==o&&(this.style=o),this.enabled=!0;const T=o.terrain.properties;this.sourceCache=o.terrain.drapeRenderMode===0?this._mockSourceCache:o._getSourceCache(T.get("source")),this._exaggeration=T.get("exaggeration");const C=()=>{this.sourceCache.used&&a.warnOnce(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const N=this.getScaledDemTileSize();this.sourceCache.update(h,N,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,C(),this._initializing=!0),C(),h.updateElevation(!0,_),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(h),this._emptyDEMTextureDirty=!0}else this._disable()}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_checkRenderCacheEfficiency(){const o=this.renderCacheEfficiency(this._style);this._style.map._optimizeForTerrain||o.efficiency!==100&&a.warnOnce(`Terrain render cache efficiency is not optimal (${o.efficiency}%) and performance
                may be affected negatively, consider placing all background, fill and line layers before layer
                with id '${o.firstUndrapedLayer}' or create a map using optimizeForTerrain: true option.`)}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this._invalidateRenderCache=!0)}_disable(){if(this.enabled&&(this.enabled=!1,this._sharedDepthStencil=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._sourceCaches)this._style._sourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this._emptyDepthBufferTexture&&this._emptyDepthBufferTexture.destroy(),this.pool.forEach((o=>o.fb.destroy())),this.pool=[],this._depthFBO&&(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0)}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this._exaggeration}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const h=this.proxySourceCache,_=this.painter.transform;this._initializing&&(this._initializing=_._centerAltitude===0&&this.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(_.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const T=this.proxyCoords=h.getIds().map((B=>{const G=h.getTileByID(B).tileID;return G.projMatrix=_.calculateProjMatrix(G.toUnwrapped()),G}));(function(B,G){const $=G.transform.pointCoordinate(G.transform.getCameraPoint()),J=new a.Point($.x,$.y);B.sort(((oe,ce)=>{if(ce.overscaledZ-oe.overscaledZ)return ce.overscaledZ-oe.overscaledZ;const fe=new a.Point(oe.canonical.x+(1<<oe.canonical.z)*oe.wrap,oe.canonical.y),de=new a.Point(ce.canonical.x+(1<<ce.canonical.z)*ce.wrap,ce.canonical.y),me=J.mult(1<<oe.canonical.z);return me.x-=.5,me.y-=.5,me.distSqr(fe)-me.distSqr(de)}))})(T,this.painter),this._previousZoom=_.zoom;const C=this.proxyToSource||{};this.proxyToSource={},T.forEach((B=>{this.proxyToSource[B.key]={}})),this.terrainTileForTile={};const N=this._style._sourceCaches;for(const B in N){const G=N[B];if(!G.used||(G!==this.sourceCache&&this.resetTileLookupCache(G.id),this._setupProxiedCoordsForOrtho(G,o[B],C),G.usedForTerrain))continue;const $=o[B];G.getSource().reparseOverscaled&&this._assignTerrainTiles($)}this.proxiedCoords[h.id]=T.map((B=>new dd(B,B.key,this.orthoMatrix))),this._assignTerrainTiles(T),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(C),this.renderingToTexture=!1,this._updateTimestamp=a.exported.now();const D={};this._visibleDemTiles=[];for(const B of this.proxyCoords){const G=this.terrainTileForTile[B.key];if(!G)continue;const $=G.tileID.key;$ in D||(this._visibleDemTiles.push(G),D[$]=$)}}_assignTerrainTiles(o){this._initializing||o.forEach((h=>{if(this.terrainTileForTile[h.key])return;const _=this._findTileCoveringTileID(h,this.sourceCache);_&&(this.terrainTileForTile[h.key]=_)}))}_prepareDEMTextures(){const o=this.painter.context,h=o.gl;for(const _ in this.terrainTileForTile){const T=this.terrainTileForTile[_],C=T.dem;!C||T.demTexture&&!T.needsDEMTextureUpload||(o.activeTexture.set(h.TEXTURE1),Dh(this.painter,T,C))}}_prepareDemTileUniforms(o,h,_,T){if(!h||h.demTexture==null)return!1;const C=o.tileID.canonical,N=Math.pow(2,h.tileID.canonical.z-C.z),D=T||"";return _[`u_dem_tl${D}`]=[C.x*N%1,C.y*N%1],_[`u_dem_scale${D}`]=N,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}get emptyDepthBufferTexture(){const o=this.painter.context,h=o.gl;if(!this._emptyDepthBufferTexture){const _=new a.RGBAImage({width:1,height:1},Uint8Array.of(255,255,255,255));this._emptyDepthBufferTexture=new a.Texture(o,_,h.RGBA,{premultiply:!1})}return this._emptyDepthBufferTexture}_getLoadedAreaMinimum(){let o=0;const h=this._visibleDemTiles.reduce(((_,T)=>{if(!T.dem)return _;const C=T.dem.tree.minimums[0];return C>0&&o++,_+C}),0);return o?h/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,h=o.gl;o.activeTexture.set(h.TEXTURE2);const _=this._getLoadedAreaMinimum(),T=new a.RGBAImage({width:1,height:1},new Uint8Array(a.DEMData.pack(_,this.sourceCache.getSource().encoding)));this._emptyDEMTextureDirty=!1;let C=this._emptyDEMTexture;return C?C.update(T,{premultiply:!1}):C=this._emptyDEMTexture=new a.Texture(o,T,h.RGBA,{premultiply:!1}),C}setupElevationDraw(o,h,_){const T=this.painter.context,C=T.gl,N=(D=this.sourceCache.getSource().encoding,{u_dem:2,u_dem_prev:4,u_dem_unpack:a.DEMData.getUnpackVector(D),u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_exaggeration:0});var D;N.u_dem_size=this.sourceCache.getSource().tileSize,N.u_exaggeration=this.exaggeration();let B=null,G=null,$=1;if(_&&_.morphing&&this._useVertexMorphing){const J=_.morphing.srcDemTile,oe=_.morphing.dstDemTile;$=_.morphing.phase,J&&oe&&(this._prepareDemTileUniforms(o,J,N,"_prev")&&(G=J),this._prepareDemTileUniforms(o,oe,N)&&(B=oe))}if(G&&B?(T.activeTexture.set(C.TEXTURE2),B.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),T.activeTexture.set(C.TEXTURE4),G.demTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE,C.NEAREST),N.u_dem_lerp=$):(B=this.terrainTileForTile[o.tileID.key],T.activeTexture.set(C.TEXTURE2),(this._prepareDemTileUniforms(o,B,N)?B.demTexture:this.emptyDEMTexture).bind(C.NEAREST,C.CLAMP_TO_EDGE)),T.activeTexture.set(C.TEXTURE3),_&&_.useDepthForOcclusion?(this._depthTexture&&this._depthTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),this._depthFBO&&(N.u_depth_size_inv=[1/this._depthFBO.width,1/this._depthFBO.height])):(this.emptyDepthBufferTexture.bind(C.NEAREST,C.CLAMP_TO_EDGE),N.u_depth_size_inv=[1,1]),_&&_.useMeterToDem&&B){const J=(1<<B.tileID.canonical.z)*a.mercatorZfromAltitude(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;N.u_meter_to_dem=J}if(_&&_.labelPlaneMatrixInv&&(N.u_label_plane_matrix_inv=_.labelPlaneMatrixInv),h.setTerrainUniformValues(T,N),this.painter.transform.projection.name==="globe"){const J=this.globeUniformValues(this.painter.transform,o.tileID.canonical,_&&_.useDenormalizedUpVectorScale);h.setGlobeUniformValues(T,J)}}globeUniformValues(o,h,_){const T=o.projection;return{u_tile_tl_up:T.upVector(h,0,0),u_tile_tr_up:T.upVector(h,a.EXTENT,0),u_tile_br_up:T.upVector(h,a.EXTENT,a.EXTENT),u_tile_bl_up:T.upVector(h,0,a.EXTENT),u_tile_up_scale:_?a.globeMetersToEcef(1):T.upVectorScale(h,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const h=this.painter,_=this.painter.context;o.length!==0&&(_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),h.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,(function(T,C,N,D,B){if(T.transform.projection.name==="globe")(function(G,$,J,oe,ce){const fe=G.context,de=fe.gl;let me,Q;const le=G.options.showTerrainWireframe?2:0,_e=G.transform,ve=a.globeUseCustomAntiAliasing(G,fe,_e),Ne=(Et,Ke)=>{if(Q===Et)return;const lt=[Pa[Et],"PROJECTION_GLOBE_VIEW"];ve&&lt.push("CUSTOM_ANTIALIASING"),Ke&&lt.push(Pa[le]),me=G.useProgram("globeRaster",null,lt),Q=Et},Le=G.colorModeForRenderPass(),De=new a.DepthMode(de.LEQUAL,a.DepthMode.ReadWrite,G.depthRangeFor3D);oa.update(ce);const $e=a.calculateGlobeMercatorMatrix(_e),Ue=[a.mercatorXfromLng(_e.center.lng),a.mercatorYfromLat(_e.center.lat)],Ye=le?[!1,!0]:[!1],kt=G.globeSharedBuffers,qe=[_e.width*a.exported.devicePixelRatio,_e.height*a.exported.devicePixelRatio],at=Float32Array.from(_e.globeMatrix),Je={useDenormalizedUpVectorScale:!0};if(Ye.forEach((Et=>{const Ke=G.transform,lt=cd(Ke.zoom)*$.exaggeration();Q=-1;const Tt=Et?de.LINES:de.TRIANGLES;for(const xt of oe){const At=J.getTile(xt),Qt=a.StencilMode.disabled,yn=$.prevTerrainTileForTile[xt.key],qt=$.terrainTileForTile[xt.key];rc(yn,qt)&&oa.newMorphing(xt.key,yn,qt,ce,250),fe.activeTexture.set(de.TEXTURE0),At.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);const un=oa.getMorphValuesForProxy(xt.key),jn=un?1:0;un&&a.extend$1(Je,{morphing:{srcDemTile:un.from,dstDemTile:un.to,phase:a.easeCubicInOut(un.phase)}});const Fn=a.tileCornersToBounds(xt.canonical),en=a.getLatitudinalLod(Fn.getCenter().lat),Gn=a.getGridMatrix(xt.canonical,Fn,en,Ke.worldSize/Ke._pixelsPerMercatorPixel),sr=a.globeNormalizeECEF(a.globeTileBounds(xt.canonical)),or=ld(Ke.projMatrix,at,$e,sr,a.globeToMercatorTransition(Ke.zoom),Ue,Ke.frustumCorners.TL,Ke.frustumCorners.TR,Ke.frustumCorners.BR,Ke.frustumCorners.BL,Ke.globeCenterInViewSpace,Ke.globeRadius,qe,lt,Gn);if(Ne(jn,Et),$.setupElevationDraw(At,me,Je),G.prepareDrawProgram(fe,me,xt.toUnwrapped()),kt){const[tr,Ni,$r]=Et?kt.getWirefameBuffers(G.context,en):kt.getGridBuffers(en,lt!==0);me.draw(fe,Tt,De,Qt,Le,a.CullFaceMode.backCCW,or,"globe_raster",tr,Ni,$r)}}})),kt){const Et=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];ve&&Et.push("CUSTOM_ANTIALIASING"),me=G.useProgram("globeRaster",null,Et);for(const Ke of oe){const{x:lt,y:Tt,z:xt}=Ke.canonical,At=Tt===0,Qt=Tt===(1<<xt)-1,[yn,qt,un,jn]=kt.getPoleBuffers(xt);if(jn&&(At||Qt)){const Fn=J.getTile(Ke);fe.activeTexture.set(de.TEXTURE0),Fn.texture.bind(de.LINEAR,de.CLAMP_TO_EDGE);let en=a.globePoleMatrixForTile(xt,lt,_e);const Gn=a.globeNormalizeECEF(a.globeTileBounds(Ke.canonical)),sr=(or,tr)=>or.draw(fe,de.TRIANGLES,De,a.StencilMode.disabled,Le,a.CullFaceMode.disabled,ld(_e.projMatrix,en,en,Gn,0,Ue,_e.frustumCorners.TL,_e.frustumCorners.TR,_e.frustumCorners.BR,_e.frustumCorners.BL,_e.globeCenterInViewSpace,_e.globeRadius,qe,0),"globe_pole_raster",tr,un,jn);$.setupElevationDraw(Fn,me,Je),G.prepareDrawProgram(fe,me,Ke.toUnwrapped()),At&&sr(me,yn),Qt&&(en=a.scale(a.create(),en,[1,-1,1]),sr(me,qt))}}}})(T,C,N,D,B);else{const G=T.context,$=G.gl;let J,oe;const ce=T.options.showTerrainWireframe?2:0,fe=(_e,ve)=>{if(oe===_e)return;const Ne=[Pa[_e]];ve&&Ne.push(Pa[ce]),J=T.useProgram("terrainRaster",null,Ne),oe=_e},de=T.colorModeForRenderPass(),me=new a.DepthMode($.LEQUAL,a.DepthMode.ReadWrite,T.depthRangeFor3D);oa.update(B);const Q=T.transform,le=cd(Q.zoom)*C.exaggeration();(ce?[!1,!0]:[!1]).forEach((_e=>{oe=-1;const ve=_e?$.LINES:$.TRIANGLES,[Ne,Le]=_e?C.getWirefameBuffer():[C.gridIndexBuffer,C.gridSegments];for(const De of D){const $e=N.getTile(De),Ue=a.StencilMode.disabled,Ye=C.prevTerrainTileForTile[De.key],kt=C.terrainTileForTile[De.key];rc(Ye,kt)&&oa.newMorphing(De.key,Ye,kt,B,250),G.activeTexture.set($.TEXTURE0),$e.texture.bind($.LINEAR,$.CLAMP_TO_EDGE,$.LINEAR_MIPMAP_NEAREST);const qe=oa.getMorphValuesForProxy(De.key),at=qe?1:0;let Je;qe&&(Je={morphing:{srcDemTile:qe.from,dstDemTile:qe.to,phase:a.easeCubicInOut(qe.phase)}});const Et=nc(De.projMatrix,pp(De.canonical,Q.renderWorldCopies)?le/10:le);fe(at,_e),C.setupElevationDraw($e,J,Je),T.prepareDrawProgram(G,J,De.toUnwrapped()),J.draw(G,ve,me,Ue,de,a.CullFaceMode.backCCW,Et,"terrain_raster",C.gridBuffer,Ne,Le)}}))}})(h,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,h.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const h=this.painter,_=this.painter.context,T=this.proxySourceCache,C=this.proxiedCoords[T.id],N=this._drapedRenderBatches.shift(),D=[],B=h.style.order;let G=0;for(const $ of C){const J=T.getTileByID($.proxyTileKey),oe=T.proxyCachedFBO[$.key]?T.proxyCachedFBO[$.key][o]:void 0,ce=oe!==void 0?T.renderCache[oe]:this.pool[G++],fe=oe!==void 0;if(J.texture=ce.tex,fe&&!ce.dirty){D.push(J.tileID);continue}let de;_.bindFramebuffer.set(ce.fb.framebuffer),this.renderedToTile=!1,ce.dirty&&(_.clear({color:a.Color.transparent,stencil:0}),ce.dirty=!1);for(let me=N.start;me<=N.end;++me){const Q=h.style._layers[B[me]];if(Q.isHidden(h.transform.zoom))continue;const le=h.style._getLayerSourceCache(Q),_e=le?this.proxyToSource[$.key][le.id]:[$];if(!_e)continue;const ve=_e;_.viewport.set([0,0,ce.fb.width,ce.fb.height]),de!==(le?le.id:null)&&(this._setupStencil(ce,_e,Q,le),de=le?le.id:null),h.renderLayer(h,le,Q,ve)}this.renderedToTile?(ce.dirty=!0,D.push(J.tileID)):fe||--G,G===5&&(G=0,this.renderToBackBuffer(D))}return this.renderToBackBuffer(D),this.renderingToTexture=!1,_.bindFramebuffer.set(null),_.viewport.set([0,0,h.width,h.height]),N.end+1}postRender(){}renderCacheEfficiency(o){const h=o.order.length;if(h===0)return{efficiency:100};let _,T=0,C=0,N=!1;for(let D=0;D<h;++D){const B=o._layers[o.order[D]];this._style.isLayerDraped(B)?(N&&++T,++C):N||(N=!0,_=B.id)}return C===0?{efficiency:100}:{efficiency:100*(1-T/C),firstUndrapedLayer:_}}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter((h=>h.dem)).forEach((h=>{o=Math.min(o,h.dem.tree.minimums[0])})),o===0?o:(o-30)*this._exaggeration}raycast(o,h,_){if(!this._visibleDemTiles)return null;const T=this._visibleDemTiles.filter((C=>C.dem)).map((C=>{const N=C.tileID,D=1<<N.overscaledZ,{x:B,y:G}=N.canonical,$=B/D,J=(B+1)/D,oe=G/D,ce=(G+1)/D;return{minx:$,miny:oe,maxx:J,maxy:ce,t:C.dem.tree.raycastRoot($,oe,J,ce,o,h,_),tile:C}}));T.sort(((C,N)=>(C.t!==null?C.t:Number.MAX_VALUE)-(N.t!==null?N.t:Number.MAX_VALUE)));for(const C of T){if(C.t==null)return null;const N=C.tile.dem.tree.raycast(C.minx,C.miny,C.maxx,C.maxy,o,h,_);if(N!=null)return N}return null}_createFBO(){const o=this.painter.context,h=o.gl,_=this.drapeBufferSize;o.activeTexture.set(h.TEXTURE0);const T=new a.Texture(o,{width:_[0],height:_[1],data:null},h.RGBA);T.bind(h.LINEAR,h.CLAMP_TO_EDGE);const C=o.createFramebuffer(_[0],_[1],!1);return C.colorAttachment.set(T.texture),C.depthAttachment=new je(o,C.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,_[0],_[1]),this._stencilRef=0,C.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):C.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&!o.extTextureFilterAnisotropicForceOff&&h.texParameterf(h.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:C,tex:T,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._style.light&&this._style.light.hasTransition())return!0;for(const o in this._style._sourceCaches)if(this._style._sourceCaches[o].hasTransition())return!0;return this._style.order.some((o=>{const h=this._style._layers[o],_=h.isHidden(this.painter.transform.zoom);return h.type==="custom"?!_&&h.shouldRedrape():!_&&h.hasTransition()}))}_clearLineLayersFromRenderCache(){let o=!1;for(const _ of this._style._getSources())if(_ instanceof Rt){o=!0;break}if(!o)return;const h={};for(let _=0;_<this._style.order.length;++_){const T=this._style._layers[this._style.order[_]],C=this._style._getLayerSourceCache(T);if(C&&!h[C.id]&&!T.isHidden(this.painter.transform.zoom)&&T.type==="line"&&T.widthExpression()instanceof a.ZoomDependentExpression){h[C.id]=!0;for(const N of this.proxyCoords){const D=this.proxyToSource[N.key][C.id];if(D)for(const B of D)this._clearRenderCacheForTile(C.id,B)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const _ in this._style._sourceCaches)if(this._style._sourceCaches[_]._source instanceof bt){o=!0;break}if(!o)return;const h={};for(let _=0;_<this._style.order.length;++_){const T=this._style._layers[this._style.order[_]],C=this._style._getLayerSourceCache(T);if(!C||h[C.id]||T.isHidden(this.painter.transform.zoom)||T.type!=="raster")continue;const N=T.paint.get("raster-fade-duration");for(const D of this.proxyCoords){const B=this.proxyToSource[D.key][C.id];if(B)for(const G of B){const $=jh(C.getTile(G),C.findLoadedParent(G,0),C,this.painter.transform,N);($.opacity!==1||$.mix!==0)&&this._clearRenderCacheForTile(C.id,G)}}}}_setupDrapedRenderBatches(){const o=this._style.order,h=o.length;if(h===0)return;const _=[];let T,C=0,N=this._style._layers[o[C]];for(;!this._style.isLayerDraped(N)&&N.isHidden(this.painter.transform.zoom)&&++C<h;)N=this._style._layers[o[C]];for(;C<h;++C){const D=this._style._layers[o[C]];D.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(D)?T===void 0&&(T=C):T!==void 0&&(_.push({start:T,end:C-1}),T=void 0))}T!==void 0&&_.push({start:T,end:C-1}),this._drapedRenderBatches=_}_setupRenderCache(o){const h=this.proxySourceCache;if(this._shouldDisableRenderCache()||this._invalidateRenderCache){if(this._invalidateRenderCache=!1,h.renderCache.length>h.renderCachePool.length){const N=Object.values(h.proxyCachedFBO);h.proxyCachedFBO={};for(let D=0;D<N.length;++D){const B=Object.values(N[D]);h.renderCachePool.push(...B)}}return}this._clearRasterLayersFromRenderCache();const _=this.proxyCoords,T=this._tilesDirty;for(let N=_.length-1;N>=0;N--){const D=_[N];if(h.getTileByID(D.key),h.proxyCachedFBO[D.key]!==void 0){const B=o[D.key],G=this.proxyToSource[D.key];let $=0;for(const J in G){const oe=G[J],ce=B[J];if(!ce||ce.length!==oe.length||oe.some(((fe,de)=>fe!==ce[de]||T[J]&&T[J].hasOwnProperty(fe.key)))){$=-1;break}++$}for(const J in h.proxyCachedFBO[D.key])h.renderCache[h.proxyCachedFBO[D.key][J]].dirty=$<0||$!==Object.values(B).length}}const C=[...this._drapedRenderBatches];C.sort(((N,D)=>D.end-D.start-(N.end-N.start)));for(const N of C)for(const D of _){if(h.proxyCachedFBO[D.key])continue;let B=h.renderCachePool.pop();B===void 0&&h.renderCache.length<50&&(B=h.renderCache.length,h.renderCache.push(this._createFBO())),B!==void 0&&(h.proxyCachedFBO[D.key]={},h.proxyCachedFBO[D.key][N.start]=B,h.renderCache[B].dirty=!0)}this._tilesDirty={}}_setupStencil(o,h,_,T){if(!T||!this._sourceTilesOverlap[T.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const C=this.painter.context,N=C.gl;if(h.length<=1)return void(this._overlapStencilType=!1);let D;if(_.isTileClipped())D=h.length,this._overlapStencilMode.test={func:N.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(h[0].overscaledZ>h[h.length-1].overscaledZ))return void(this._overlapStencilType=!1);D=1,this._overlapStencilMode.test={func:N.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+D>255&&(C.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=D,this._overlapStencilMode.ref=this._stencilRef,_.isTileClipped()&&this._renderTileClippingMasks(h,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):a.StencilMode.disabled}_renderTileClippingMasks(o,h){const _=this.painter,T=this.painter.context,C=T.gl;_._tileClippingMaskIDs={},T.setColorMode(a.ColorMode.disabled),T.setDepthMode(a.DepthMode.disabled);const N=_.useProgram("clippingMask");for(const D of o){const B=_._tileClippingMaskIDs[D.key]=--h;N.draw(T,C.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:C.ALWAYS,mask:0},B,255,C.KEEP,C.KEEP,C.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,su(D.projMatrix),"$clipping",_.tileExtentBuffer,_.quadTriangleIndexBuffer,_.tileExtentSegments)}}pointCoordinate(o){const h=this.painter.transform;if(o.x<0||o.x>h.width||o.y<0||o.y>h.height)return null;const _=[o.x,o.y,1,1];a.transformMat4$1(_,_,h.pixelMatrixInverse),a.scale$1(_,_,1/_[3]),_[0]/=h.worldSize,_[1]/=h.worldSize;const T=h._camera.position,C=a.mercatorZfromAltitude(1,h.center.lat),N=[T[0],T[1],T[2]/C,0],D=a.subtract([],_.slice(0,3),N);a.normalize(D,D);const B=this.raycast(N,D,this._exaggeration);return B!==null&&B?(a.scaleAndAdd(N,N,D,B),N[3]=N[2],N[2]*=C,N):null}drawDepth(){const o=this.painter,h=o.context,_=this.proxySourceCache,T=Math.ceil(o.width),C=Math.ceil(o.height);if(!this._depthFBO||this._depthFBO.width===T&&this._depthFBO.height===C||(this._depthFBO.destroy(),this._depthFBO=void 0,this._depthTexture=void 0),!this._depthFBO){const N=h.gl,D=h.createFramebuffer(T,C,!0);h.activeTexture.set(N.TEXTURE0);const B=new a.Texture(h,{width:T,height:C,data:null},N.RGBA);B.bind(N.NEAREST,N.CLAMP_TO_EDGE),D.colorAttachment.set(B.texture);const G=h.createRenderbuffer(h.gl.DEPTH_COMPONENT16,T,C);D.depthAttachment.set(G),this._depthFBO=D,this._depthTexture=B}h.bindFramebuffer.set(this._depthFBO.framebuffer),h.viewport.set([0,0,T,C]),(function(N,D,B,G){if(N.transform.projection.name==="globe")return;const $=N.context,J=$.gl;$.clear({depth:1});const oe=N.useProgram("terrainDepth"),ce=new a.DepthMode(J.LESS,a.DepthMode.ReadWrite,N.depthRangeFor3D);for(const fe of G){const de=B.getTile(fe),me=nc(fe.projMatrix,0);D.setupElevationDraw(de,oe),oe.draw($,J.TRIANGLES,ce,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.backCCW,me,"terrain_depth",D.gridBuffer,D.gridIndexBuffer,D.gridNoSkirtSegments)}})(o,this,_,this.proxyCoords)}_setupProxiedCoordsForOrtho(o,h,_){if(o.getSource()instanceof An)return this._setupProxiedCoordsForImageSource(o,h,_);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const T=this.proxiedCoords[o.id]=[],C=this.proxyCoords;for(let D=0;D<C.length;D++){const B=C[D],G=this._findTileCoveringTileID(B,o);if(G){const $=this._createProxiedId(B,G,_[B.key]&&_[B.key][o.id]);T.push($),this.proxyToSource[B.key][o.id]=[$]}}let N=!1;for(let D=0;D<h.length;D++){const B=o.getTile(h[D]);if(!B||!B.hasData())continue;const G=this._findTileCoveringTileID(B.tileID,this.proxySourceCache);if(G&&G.tileID.canonical.z!==B.tileID.canonical.z){const $=this.proxyToSource[G.tileID.key][o.id],J=this._createProxiedId(G.tileID,B,_[G.tileID.key]&&_[G.tileID.key][o.id]);$?$.splice($.length-1,0,J):this.proxyToSource[G.tileID.key][o.id]=[J],T.push(J),N=!0}}this._sourceTilesOverlap[o.id]=N}_setupProxiedCoordsForImageSource(o,h,_){if(!o.getSource().loaded())return;const T=this.proxiedCoords[o.id]=[],C=this.proxyCoords,N=o.getSource(),D=new a.Point(N.tileID.x,N.tileID.y)._div(1<<N.tileID.z),B=N.coordinates.map(a.MercatorCoordinate.fromLngLat).reduce((($,J)=>($.min.x=Math.min($.min.x,J.x-D.x),$.min.y=Math.min($.min.y,J.y-D.y),$.max.x=Math.max($.max.x,J.x-D.x),$.max.y=Math.max($.max.y,J.y-D.y),$)),{min:new a.Point(Number.MAX_VALUE,Number.MAX_VALUE),max:new a.Point(-Number.MAX_VALUE,-Number.MAX_VALUE)}),G=($,J)=>{const oe=$.wrap+$.canonical.x/(1<<$.canonical.z),ce=$.canonical.y/(1<<$.canonical.z),fe=a.EXTENT/(1<<$.canonical.z),de=J.wrap+J.canonical.x/(1<<J.canonical.z),me=J.canonical.y/(1<<J.canonical.z);return oe+fe<de+B.min.x||oe>de+B.max.x||ce+fe<me+B.min.y||ce>me+B.max.y};for(let $=0;$<C.length;$++){const J=C[$];for(let oe=0;oe<h.length;oe++){const ce=o.getTile(h[oe]);if(!ce||!ce.hasData()||G(J,ce.tileID))continue;const fe=this._createProxiedId(J,ce,_[J.key]&&_[J.key][o.id]),de=this.proxyToSource[J.key][o.id];de?de.push(fe):this.proxyToSource[J.key][o.id]=[fe],T.push(fe)}}}_createProxiedId(o,h,_){let T=this.orthoMatrix;if(_){const C=_.find((N=>N.key===h.tileID.key));if(C)return C}if(h.tileID.key!==o.key){const C=o.canonical.z-h.tileID.canonical.z;let N,D,B;T=a.create();const G=h.tileID.wrap-o.wrap<<o.overscaledZ;C>0?(N=a.EXTENT>>C,D=N*((h.tileID.canonical.x<<C)-o.canonical.x+G),B=N*((h.tileID.canonical.y<<C)-o.canonical.y)):(N=a.EXTENT<<-C,D=a.EXTENT*(h.tileID.canonical.x-(o.canonical.x+G<<-C)),B=a.EXTENT*(h.tileID.canonical.y-(o.canonical.y<<-C))),a.ortho(T,0,N,0,N,0,1),a.translate(T,T,[D,B,0])}return new dd(h.tileID,o.key,T)}_findTileCoveringTileID(o,h){let _=h.getTile(o);if(_&&_.hasData())return _;const T=this._findCoveringTileCache[h.id],C=T[o.key];if(_=C?h.getTileByID(C):null,_&&_.hasData()||C===null)return _;let N=_?_.tileID:o,D=N.overscaledZ;const B=h.getSource().minzoom,G=[];if(!C){const J=h.getSource().maxzoom;if(o.canonical.z>=J){const oe=o.canonical.z-J;h.getSource().reparseOverscaled?(D=Math.max(o.canonical.z+2,h.transform.tileZoom),N=new a.OverscaledTileID(D,o.wrap,J,o.canonical.x>>oe,o.canonical.y>>oe)):oe!==0&&(D=J,N=new a.OverscaledTileID(D,o.wrap,J,o.canonical.x>>oe,o.canonical.y>>oe))}N.key!==o.key&&(G.push(N.key),_=h.getTile(N))}const $=J=>{G.forEach((oe=>{T[oe]=J})),G.length=0};for(D-=1;D>=B&&(!_||!_.hasData());D--){_&&$(_.tileID.key);const J=N.calculateScaledKey(D);if(_=h.getTileByID(J),_&&_.hasData())break;const oe=T[J];if(oe===null)break;oe===void 0?G.push(J):_=h.getTileByID(oe)}return $(_?_.tileID.key:null),_&&_.hasData()?_:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,h){let _=this._tilesDirty[o];_||(_=this._tilesDirty[o]={}),_[h.key]=!0}getWirefameBuffer(){if(!this.wireframeSegments){const o=(function(h){let _=0;const T=new a.StructArrayLayout2ui4,C=131;for(let N=1;N<129;N++){for(let D=1;D<129;D++)_=N*C+D,T.emplaceBack(_,_+1),T.emplaceBack(_,_+C),T.emplaceBack(_+1,_+C),N===128&&T.emplaceBack(_+C,_+C+1);T.emplaceBack(_+1,_+1+C)}return T})();this.wireframeIndexBuffer=this.painter.context.createIndexBuffer(o),this.wireframeSegments=a.SegmentVector.simpleSegment(0,0,this.gridBuffer.length,o.length)}return[this.wireframeIndexBuffer,this.wireframeSegments]}}class Kn{static cacheKey(o,h,_,T){let C=`${h}${T?T.cacheKey:""}`;for(const N of _)o.usedDefines.includes(N)&&(C+=`/${N}`);return C}constructor(o,h,_,T,C,N){const D=o.gl;this.program=D.createProgram();const B=(function(Q){const le=[];for(let _e=0;_e<Q.length;_e++){if(Q[_e]===null)continue;const ve=Q[_e].split(" ");le.push(ve.pop())}return le})(_.staticAttributes),G=T?T.getBinderAttributes():[],$=B.concat(G);let J=T?T.defines():[];J=J.concat(N.map((Q=>`#define ${Q}`)));const oe=o.isWebGL2?`#version 300 es
`:"",ce=oe+J.concat(o.extStandardDerivatives&&oe.length===0?`#extension GL_OES_standard_derivatives : enable
`.concat(ru):ru,ru,od,tc.fragmentSource,bo.fragmentSource,_.fragmentSource).join(`
`),fe=oe+J.concat(`
#ifdef GL_ES
precision highp float;
#else

#if !defined(lowp)
#define lowp
#endif

#if !defined(mediump)
#define mediump
#endif

#if !defined(highp)
#define highp
#endif

#endif`,od,tc.vertexSource,bo.vertexSource,Xi.vertexSource,_.vertexSource).join(`
`),de=D.createShader(D.FRAGMENT_SHADER);if(D.isContextLost())return void(this.failedToCreate=!0);D.shaderSource(de,ce),D.compileShader(de),D.attachShader(this.program,de);const me=D.createShader(D.VERTEX_SHADER);if(D.isContextLost())this.failedToCreate=!0;else{D.shaderSource(me,fe),D.compileShader(me),D.attachShader(this.program,me),this.attributes={},this.numAttributes=$.length;for(let Q=0;Q<this.numAttributes;Q++)$[Q]&&(D.bindAttribLocation(this.program,Q,$[Q]),this.attributes[$[Q]]=Q);D.linkProgram(this.program),D.deleteShader(me),D.deleteShader(de),this.fixedUniforms=C(o),this.binderUniforms=T?T.getUniforms(o):[],N.includes("TERRAIN")&&(this.terrainUniforms=(Q=>({u_dem:new a.Uniform1i(Q),u_dem_prev:new a.Uniform1i(Q),u_dem_unpack:new a.Uniform4f(Q),u_dem_tl:new a.Uniform2f(Q),u_dem_scale:new a.Uniform1f(Q),u_dem_tl_prev:new a.Uniform2f(Q),u_dem_scale_prev:new a.Uniform1f(Q),u_dem_size:new a.Uniform1f(Q),u_dem_lerp:new a.Uniform1f(Q),u_exaggeration:new a.Uniform1f(Q),u_depth:new a.Uniform1i(Q),u_depth_size_inv:new a.Uniform2f(Q),u_meter_to_dem:new a.Uniform1f(Q),u_label_plane_matrix_inv:new a.UniformMatrix4f(Q)}))(o)),N.includes("GLOBE")&&(this.globeUniforms=(Q=>({u_tile_tl_up:new a.Uniform3f(Q),u_tile_tr_up:new a.Uniform3f(Q),u_tile_br_up:new a.Uniform3f(Q),u_tile_bl_up:new a.Uniform3f(Q),u_tile_up_scale:new a.Uniform1f(Q)}))(o)),N.includes("FOG")&&(this.fogUniforms=(Q=>({u_fog_matrix:new a.UniformMatrix4f(Q),u_fog_range:new a.Uniform2f(Q),u_fog_color:new a.Uniform4f(Q),u_fog_horizon_blend:new a.Uniform1f(Q),u_fog_temporal_offset:new a.Uniform1f(Q),u_frustum_tl:new a.Uniform3f(Q),u_frustum_tr:new a.Uniform3f(Q),u_frustum_br:new a.Uniform3f(Q),u_frustum_bl:new a.Uniform3f(Q),u_globe_pos:new a.Uniform3f(Q),u_globe_radius:new a.Uniform1f(Q),u_globe_transition:new a.Uniform1f(Q),u_is_globe:new a.Uniform1i(Q),u_viewport:new a.Uniform2f(Q)}))(o))}}setTerrainUniformValues(o,h){if(!this.terrainUniforms)return;const _=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)_[T]&&_[T].set(this.program,T,h[T])}}setGlobeUniformValues(o,h){if(!this.globeUniforms)return;const _=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)_[T]&&_[T].set(this.program,T,h[T])}}setFogUniformValues(o,h){if(!this.fogUniforms)return;const _=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const T in h)_[T].set(this.program,T,h[T])}}draw(o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de){const me=o.gl;if(this.failedToCreate)return;o.program.set(this.program),o.setDepthMode(_),o.setStencilMode(T),o.setColorMode(C),o.setCullFace(N);for(const le of Object.keys(this.fixedUniforms))this.fixedUniforms[le].set(this.program,le,D[le]);fe&&fe.setUniforms(this.program,o,this.binderUniforms,oe,{zoom:ce});const Q={[me.LINES]:2,[me.TRIANGLES]:3,[me.LINE_STRIP]:1}[h];for(const le of J.get()){const _e=le.vaos||(le.vaos={});(_e[B]||(_e[B]=new hp)).bind(o,this,G,fe?fe.getPaintVertexBuffers():[],$,le.vertexOffset,de||[]),me.drawElements(h,le.primitiveLength*Q,me.UNSIGNED_SHORT,le.primitiveOffset*Q*2)}}}function au(g,o){const h=Math.pow(2,o.tileID.overscaledZ),_=o.tileSize*Math.pow(2,g.transform.tileZoom)/h,T=_*(o.tileID.canonical.x+o.tileID.wrap*h),C=_*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture.size,u_tile_units_to_pixels:1/Fe(o,1,g.transform.tileZoom),u_pixel_coord_upper:[T>>16,C>>16],u_pixel_coord_lower:[65535&T,65535&C]}}const mp=a.create(),zh=(g,o,h,_,T,C,N,D,B,G,$)=>{const J=o.style.light,oe=J.properties.get("position"),ce=[oe.x,oe.y,oe.z],fe=a.create$1();J.properties.get("anchor")==="viewport"&&(a.fromRotation(fe,-o.transform.angle),a.transformMat3(ce,ce,fe));const de=J.properties.get("color"),me=o.transform,Q={u_matrix:g,u_lightpos:ce,u_lightintensity:J.properties.get("intensity"),u_lightcolor:[de.r,de.g,de.b],u_vertical_gradient:+h,u_opacity:_,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:mp,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_ao:T,u_edge_radius:C};return me.projection.name==="globe"&&(Q.u_tile_id=[N.canonical.x,N.canonical.y,1<<N.canonical.z],Q.u_zoom_transition=B,Q.u_inv_rot_matrix=$,Q.u_merc_center=G,Q.u_up_dir=me.projection.upVector(new a.CanonicalTileID(0,0,0),G[0]*a.EXTENT,G[1]*a.EXTENT),Q.u_height_lift=D),Q},gp=(g,o,h,_,T,C,N,D,B,G,$,J)=>{const oe=zh(g,o,h,_,T,C,N,B,G,$,J),ce={u_height_factor:-Math.pow(2,N.overscaledZ)/D.tileSize/8};return a.extend(oe,au(o,D),ce)},fl=g=>({u_matrix:g}),Bh=(g,o,h)=>a.extend(fl(g),au(o,h)),ng=(g,o)=>({u_matrix:g,u_world:o}),Fh=(g,o,h,_)=>a.extend(Bh(g,o,h),{u_world:_}),lu=a.create(),Vh=(g,o,h,_,T,C)=>{const N=g.transform,D=N.projection.name==="globe";let B;if(C.paint.get("circle-pitch-alignment")==="map")if(D){const $=a.globePixelsToTileUnits(N.zoom,o.canonical)*N._pixelsPerMercatorPixel;B=Float32Array.from([$,0,0,$])}else B=N.calculatePixelsToTileUnitsMatrix(h);else B=new Float32Array([N.pixelsToGLUnits[0],0,0,N.pixelsToGLUnits[1]]);const G={u_camera_to_center_distance:N.cameraToCenterDistance,u_matrix:g.translatePosMatrix(o.projMatrix,h,C.paint.get("circle-translate"),C.paint.get("circle-translate-anchor")),u_device_pixel_ratio:a.exported.devicePixelRatio,u_extrude_scale:B,u_inv_rot_matrix:lu,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(D){G.u_inv_rot_matrix=_,G.u_merc_center=T,G.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],G.u_zoom_transition=a.globeToMercatorTransition(N.zoom);const $=T[0]*a.EXTENT,J=T[1]*a.EXTENT;G.u_up_dir=N.projection.upVector(new a.CanonicalTileID(0,0,0),$,J)}return G},hd=g=>{const o=[];return g.paint.get("circle-pitch-alignment")==="map"&&o.push("PITCH_WITH_MAP"),g.paint.get("circle-pitch-scale")==="map"&&o.push("SCALE_WITH_MAP"),o},fd=(g,o,h,_)=>{const T=a.EXTENT/h.tileSize;return{u_matrix:g,u_camera_to_center_distance:o.getCameraToCenterDistance(_),u_extrude_scale:[o.pixelsToGLUnits[0]/T,o.pixelsToGLUnits[1]/T]}},cu=(g,o,h=1)=>({u_matrix:g,u_color:o,u_overlay:0,u_overlay_scale:h}),Uh=a.create(),$h=(g,o,h,_,T,C,N)=>{const D=g.transform,B=D.projection.name==="globe",G=B?a.globePixelsToTileUnits(D.zoom,o.canonical)*D._pixelsPerMercatorPixel:Fe(h,1,C),$={u_matrix:o.projMatrix,u_extrude_scale:G,u_intensity:N,u_inv_rot_matrix:Uh,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(B){$.u_inv_rot_matrix=_,$.u_merc_center=T,$.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],$.u_zoom_transition=a.globeToMercatorTransition(D.zoom);const J=T[0]*a.EXTENT,oe=T[1]*a.EXTENT;$.u_up_dir=D.projection.upVector(new a.CanonicalTileID(0,0,0),J,oe)}return $},ic=(g,o,h,_,T,C,N)=>{const D=g.transform,B=D.calculatePixelsToTileUnitsMatrix(o);return{u_matrix:Gh(g,o,h,_),u_pixels_to_tile_units:B,u_device_pixel_ratio:C,u_units_to_pixels:[1/D.pixelsToGLUnits[0],1/D.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:T,u_texsize:oc(h)?o.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:sc(o,g.transform),u_alpha_discard_threshold:0,u_trim_offset:N}},uu=(g,o,h,_,T)=>{const C=g.transform;return{u_matrix:Gh(g,o,h,_),u_texsize:o.imageAtlasTexture.size,u_pixels_to_tile_units:C.calculatePixelsToTileUnitsMatrix(o),u_device_pixel_ratio:T,u_image:0,u_tile_units_to_pixels:sc(o,C),u_units_to_pixels:[1/C.pixelsToGLUnits[0],1/C.pixelsToGLUnits[1]],u_alpha_discard_threshold:0}};function sc(g,o){return 1/Fe(g,1,o.tileZoom)}function Gh(g,o,h,_){return g.translatePosMatrix(_||o.tileID.projMatrix,o,h.paint.get("line-translate"),h.paint.get("line-translate-anchor"))}function oc(g){const o=g.paint.get("line-dasharray").value;return o.value||o.kind!=="constant"}const pd=(g,o,h,_,T,C)=>{return{u_matrix:g,u_tl_parent:o,u_scale_parent:h,u_fade_t:_.mix,u_opacity:_.opacity*T.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:T.paint.get("raster-brightness-min"),u_brightness_high:T.paint.get("raster-brightness-max"),u_saturation_factor:(D=T.paint.get("raster-saturation"),D>0?1-1/(1.001-D):-D),u_contrast_factor:(N=T.paint.get("raster-contrast"),N>0?1/(1-N):1+N),u_spin_weights:ws(T.paint.get("raster-hue-rotate")),u_perspective_transform:C};var N,D};function ws(g){g*=Math.PI/180;const o=Math.sin(g),h=Math.cos(g);return[(2*h+1)/3,(-Math.sqrt(3)*o-h+1)/3,(Math.sqrt(3)*o-h+1)/3]}const Ra=a.create(),Hh=(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de)=>{const me=T.transform,Q={u_is_size_zoom_constant:+(g==="constant"||g==="source"),u_is_size_feature_constant:+(g==="constant"||g==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:me.cameraToCenterDistance,u_rotate_symbol:+h,u_aspect_ratio:me.width/me.height,u_fade_change:T.options.fadeDuration?T.symbolFadeChange:1,u_matrix:C,u_label_plane_matrix:N,u_coord_matrix:D,u_is_text:+B,u_pitch_with_map:+_,u_texsize:G,u_texture:0,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:Ra,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:Ra,u_up_vector:[0,-1,0]};return de.name==="globe"&&(Q.u_tile_id=[$.canonical.x,$.canonical.y,1<<$.canonical.z],Q.u_zoom_transition=J,Q.u_inv_rot_matrix=ce,Q.u_merc_center=oe,Q.u_camera_forward=me._camera.forward(),Q.u_ecef_origin=a.globeECEFOrigin(me.globeMatrix,$.toUnwrapped()),Q.u_tile_matrix=Float32Array.from(me.globeMatrix),Q.u_up_vector=fe),Q},pl=(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de,me)=>a.extend(Hh(g,o,h,_,T,C,N,D,B,G,J,oe,ce,fe,de,me),{u_gamma_scale:_?T.transform.cameraToCenterDistance*Math.cos(T.terrain?0:T.transform._pitch):1,u_device_pixel_ratio:a.exported.devicePixelRatio,u_is_halo:1}),yp=(g,o,h,_,T,C,N,D,B,G,$,J,oe,ce,fe,de)=>a.extend(pl(g,o,h,_,T,C,N,D,!0,B,!0,$,J,oe,ce,fe,de),{u_texsize_icon:G,u_texture_icon:1}),md=(g,o,h)=>({u_matrix:g,u_opacity:o,u_color:h}),Wh=(g,o,h,_,T)=>a.extend((function(C,N,D){const B=N.imageManager.getPattern(C.toString()),{width:G,height:$}=N.imageManager.getPixelSize(),J=Math.pow(2,D.tileID.overscaledZ),oe=D.tileSize*Math.pow(2,N.transform.tileZoom)/J,ce=oe*(D.tileID.canonical.x+D.tileID.wrap*J),fe=oe*D.tileID.canonical.y;return{u_image:0,u_pattern_tl:B.tl,u_pattern_br:B.br,u_texsize:[G,$],u_pattern_size:B.displaySize,u_tile_units_to_pixels:1/Fe(D,1,N.transform.tileZoom),u_pixel_coord_upper:[ce>>16,fe>>16],u_pixel_coord_lower:[65535&ce,65535&fe]}})(_,h,T),{u_matrix:g,u_opacity:o}),du={fillExtrusion:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g)}),fillExtrusionPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_lightpos:new a.Uniform3f(g),u_lightintensity:new a.Uniform1f(g),u_lightcolor:new a.Uniform3f(g),u_vertical_gradient:new a.Uniform1f(g),u_height_factor:new a.Uniform1f(g),u_edge_radius:new a.Uniform1f(g),u_ao:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_up_dir:new a.Uniform3f(g),u_height_lift:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g)}),fill:g=>({u_matrix:new a.UniformMatrix4f(g)}),fillPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),fillOutline:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g)}),fillOutlinePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_world:new a.Uniform2f(g),u_image:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),circle:g=>({u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),collisionBox:g=>({u_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_extrude_scale:new a.Uniform2f(g)}),collisionCircle:g=>({u_matrix:new a.UniformMatrix4f(g),u_inv_matrix:new a.UniformMatrix4f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_viewport_size:new a.Uniform2f(g)}),debug:g=>({u_color:new a.UniformColor(g),u_matrix:new a.UniformMatrix4f(g),u_overlay:new a.Uniform1i(g),u_overlay_scale:new a.Uniform1f(g)}),clippingMask:g=>({u_matrix:new a.UniformMatrix4f(g)}),heatmap:g=>({u_extrude_scale:new a.Uniform1f(g),u_intensity:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_up_dir:new a.Uniform3f(g)}),heatmapTexture:g=>({u_image:new a.Uniform1i(g),u_color_ramp:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g)}),hillshade:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_latrange:new a.Uniform2f(g),u_light:new a.Uniform2f(g),u_shadow:new a.UniformColor(g),u_highlight:new a.UniformColor(g),u_accent:new a.UniformColor(g)}),hillshadePrepare:g=>({u_matrix:new a.UniformMatrix4f(g),u_image:new a.Uniform1i(g),u_dimension:new a.Uniform2f(g),u_zoom:new a.Uniform1f(g),u_unpack:new a.Uniform4f(g)}),line:g=>({u_matrix:new a.UniformMatrix4f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_units_to_pixels:new a.Uniform2f(g),u_dash_image:new a.Uniform1i(g),u_gradient_image:new a.Uniform1i(g),u_image_height:new a.Uniform1f(g),u_texsize:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g),u_trim_offset:new a.Uniform2f(g)}),linePattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_texsize:new a.Uniform2f(g),u_pixels_to_tile_units:new a.UniformMatrix2f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_units_to_pixels:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g),u_alpha_discard_threshold:new a.Uniform1f(g)}),raster:g=>({u_matrix:new a.UniformMatrix4f(g),u_tl_parent:new a.Uniform2f(g),u_scale_parent:new a.Uniform1f(g),u_fade_t:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_image0:new a.Uniform1i(g),u_image1:new a.Uniform1i(g),u_brightness_low:new a.Uniform1f(g),u_brightness_high:new a.Uniform1f(g),u_saturation_factor:new a.Uniform1f(g),u_contrast_factor:new a.Uniform1f(g),u_spin_weights:new a.Uniform3f(g),u_perspective_transform:new a.Uniform2f(g)}),symbolIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_texture:new a.Uniform1i(g)}),symbolSDF:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_tile_id:new a.Uniform3f(g),u_zoom_transition:new a.Uniform1f(g),u_inv_rot_matrix:new a.UniformMatrix4f(g),u_merc_center:new a.Uniform2f(g),u_camera_forward:new a.Uniform3f(g),u_tile_matrix:new a.UniformMatrix4f(g),u_up_vector:new a.Uniform3f(g),u_ecef_origin:new a.Uniform3f(g),u_is_halo:new a.Uniform1i(g)}),symbolTextAndIcon:g=>({u_is_size_zoom_constant:new a.Uniform1i(g),u_is_size_feature_constant:new a.Uniform1i(g),u_size_t:new a.Uniform1f(g),u_size:new a.Uniform1f(g),u_camera_to_center_distance:new a.Uniform1f(g),u_rotate_symbol:new a.Uniform1i(g),u_aspect_ratio:new a.Uniform1f(g),u_fade_change:new a.Uniform1f(g),u_matrix:new a.UniformMatrix4f(g),u_label_plane_matrix:new a.UniformMatrix4f(g),u_coord_matrix:new a.UniformMatrix4f(g),u_is_text:new a.Uniform1i(g),u_pitch_with_map:new a.Uniform1i(g),u_texsize:new a.Uniform2f(g),u_texsize_icon:new a.Uniform2f(g),u_texture:new a.Uniform1i(g),u_texture_icon:new a.Uniform1i(g),u_gamma_scale:new a.Uniform1f(g),u_device_pixel_ratio:new a.Uniform1f(g),u_is_halo:new a.Uniform1i(g)}),background:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_color:new a.UniformColor(g)}),backgroundPattern:g=>({u_matrix:new a.UniformMatrix4f(g),u_opacity:new a.Uniform1f(g),u_image:new a.Uniform1i(g),u_pattern_tl:new a.Uniform2f(g),u_pattern_br:new a.Uniform2f(g),u_texsize:new a.Uniform2f(g),u_pattern_size:new a.Uniform2f(g),u_pixel_coord_upper:new a.Uniform2f(g),u_pixel_coord_lower:new a.Uniform2f(g),u_tile_units_to_pixels:new a.Uniform1f(g)}),terrainRaster:Lh,terrainDepth:Lh,skybox:g=>({u_matrix:new a.UniformMatrix4f(g),u_sun_direction:new a.Uniform3f(g),u_cubemap:new a.Uniform1i(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxGradient:g=>({u_matrix:new a.UniformMatrix4f(g),u_color_ramp:new a.Uniform1i(g),u_center_direction:new a.Uniform3f(g),u_radius:new a.Uniform1f(g),u_opacity:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g)}),skyboxCapture:g=>({u_matrix_3f:new a.UniformMatrix3f(g),u_sun_direction:new a.Uniform3f(g),u_sun_intensity:new a.Uniform1f(g),u_color_tint_r:new a.Uniform4f(g),u_color_tint_m:new a.Uniform4f(g),u_luminance:new a.Uniform1f(g)}),globeRaster:g=>({u_proj_matrix:new a.UniformMatrix4f(g),u_globe_matrix:new a.UniformMatrix4f(g),u_normalize_matrix:new a.UniformMatrix4f(g),u_merc_matrix:new a.UniformMatrix4f(g),u_zoom_transition:new a.Uniform1f(g),u_merc_center:new a.Uniform2f(g),u_image0:new a.Uniform1i(g),u_grid_matrix:new a.UniformMatrix3f(g),u_skirt_height:new a.Uniform1f(g),u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_globe_pos:new a.Uniform3f(g),u_globe_radius:new a.Uniform1f(g),u_viewport:new a.Uniform2f(g)}),globeAtmosphere:g=>({u_frustum_tl:new a.Uniform3f(g),u_frustum_tr:new a.Uniform3f(g),u_frustum_br:new a.Uniform3f(g),u_frustum_bl:new a.Uniform3f(g),u_horizon:new a.Uniform1f(g),u_transition:new a.Uniform1f(g),u_fadeout_range:new a.Uniform1f(g),u_color:new a.Uniform4f(g),u_high_color:new a.Uniform4f(g),u_space_color:new a.Uniform4f(g),u_star_intensity:new a.Uniform1f(g),u_star_density:new a.Uniform1f(g),u_star_size:new a.Uniform1f(g),u_temporal_offset:new a.Uniform1f(g),u_horizon_angle:new a.Uniform1f(g),u_rotation_matrix:new a.UniformMatrix4f(g)})};let hu;function ac(g,o,h,_,T,C,N){const D=g.context,B=D.gl,G=g.transform,$=g.useProgram("collisionBox"),J=[];let oe=0,ce=0;for(let ve=0;ve<_.length;ve++){const Ne=_[ve],Le=o.getTile(Ne),De=Le.getBucket(h);if(!De)continue;const $e=js(Ne,De,G);let Ue=$e;T[0]===0&&T[1]===0||(Ue=g.translatePosMatrix($e,Le,T,C));const Ye=N?De.textCollisionBox:De.iconCollisionBox,kt=De.collisionCircleArray;if(kt.length>0){const qe=a.create(),at=Ue;a.mul(qe,De.placementInvProjMatrix,G.glCoordMatrix),a.mul(qe,qe,De.placementViewportMatrix),J.push({circleArray:kt,circleOffset:ce,transform:at,invTransform:qe,projection:De.getProjection()}),oe+=kt.length/4,ce=oe}Ye&&(g.terrain&&g.terrain.setupElevationDraw(Le,$),$.draw(D,B.LINES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,fd(Ue,G,Le,De.getProjection()),h.id,Ye.layoutVertexBuffer,Ye.indexBuffer,Ye.segments,null,G.zoom,null,[Ye.collisionVertexBuffer,Ye.collisionVertexBufferExt]))}if(!N||!J.length)return;const fe=g.useProgram("collisionCircle"),de=new a.StructArrayLayout2f1f2i16;de.resize(4*oe),de._trim();let me=0;for(const ve of J)for(let Ne=0;Ne<ve.circleArray.length/4;Ne++){const Le=4*Ne,De=ve.circleArray[Le+0],$e=ve.circleArray[Le+1],Ue=ve.circleArray[Le+2],Ye=ve.circleArray[Le+3];de.emplace(me++,De,$e,Ue,Ye,0),de.emplace(me++,De,$e,Ue,Ye,1),de.emplace(me++,De,$e,Ue,Ye,2),de.emplace(me++,De,$e,Ue,Ye,3)}(!hu||hu.length<2*oe)&&(hu=(function(ve){const Ne=2*ve,Le=new a.StructArrayLayout3ui6;Le.resize(Ne),Le._trim();for(let De=0;De<Ne;De++){const $e=6*De;Le.uint16[$e+0]=4*De+0,Le.uint16[$e+1]=4*De+1,Le.uint16[$e+2]=4*De+2,Le.uint16[$e+3]=4*De+2,Le.uint16[$e+4]=4*De+3,Le.uint16[$e+5]=4*De+0}return Le})(oe));const Q=D.createIndexBuffer(hu,!0),le=D.createVertexBuffer(de,a.collisionCircleLayout.members,!0);for(const ve of J){const Ne={u_matrix:ve.transform,u_inv_matrix:ve.invTransform,u_camera_to_center_distance:(_e=G).getCameraToCenterDistance(ve.projection),u_viewport_size:[_e.width,_e.height]};fe.draw(D,B.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,g.colorModeForRenderPass(),a.CullFaceMode.disabled,Ne,h.id,le,Q,a.SegmentVector.simpleSegment(0,2*ve.circleOffset,ve.circleArray.length,ve.circleArray.length/2),null,G.zoom)}var _e;le.destroy(),Q.destroy()}const qh=a.create();function Zh({width:g,height:o,anchor:h,textOffset:_,textScale:T},C){const{horizontalAlign:N,verticalAlign:D}=a.getAnchorAlignment(h),B=-(N-.5)*g,G=-(D-.5)*o,$=a.evaluateVariableOffset(h,_);return new a.Point((B/T+$[0])*C,(G/T+$[1])*C)}function rg(g,o,h,_,T,C,N,D,B,G,$){const J=g.text.placedSymbolArray,oe=g.text.dynamicLayoutVertexArray,ce=g.icon.dynamicLayoutVertexArray,fe={},de=g.getProjection(),me=Cr(D,de,C),Q=C.elevation,le=de.upVectorScale(D.canonical,C.center.lat,C.worldSize).metersToTile;oe.clear();for(let _e=0;_e<J.length;_e++){const ve=J.get(_e),{tileAnchorX:Ne,tileAnchorY:Le,numGlyphs:De}=ve,$e=ve.hidden||!ve.crossTileID||g.allowVerticalPlacement&&!ve.placedOrientation?null:_[ve.crossTileID];if($e){let Ue=0,Ye=0,kt=0;if(Q){const At=Q?Q.getAtTileOffset(D,Ne,Le):0,[Qt,yn,qt]=de.upVector(D.canonical,Ne,Le);Ue=At*Qt*le,Ye=At*yn*le,kt=At*qt*le}let[qe,at,Je,Et]=Ii(ve.projectedAnchorX+Ue,ve.projectedAnchorY+Ye,ve.projectedAnchorZ+kt,h?me:N);const Ke=dp(C.getCameraToCenterDistance(de),Et);let lt=T.evaluateSizeForFeature(g.textSizeData,G,ve)*Ke/a.ONE_EM;h&&(lt*=g.tilePixelRatio/B);const Tt=Zh($e,lt);h?({x:qe,y:at,z:Je}=de.projectTilePoint(Ne+Tt.x,Le+Tt.y,D.canonical),[qe,at,Je]=Ii(qe+Ue,at+Ye,Je+kt,N)):(o&&Tt._rotate(-C.angle),qe+=Tt.x,at+=Tt.y,Je=0);const xt=g.allowVerticalPlacement&&ve.placedOrientation===a.WritingMode.vertical?Math.PI/2:0;for(let At=0;At<De;At++)a.addDynamicAttributes(oe,qe,at,Je,xt);$&&ve.associatedIconIndex>=0&&(fe[ve.associatedIconIndex]={x:qe,y:at,z:Je,angle:xt})}else Ds(De,oe)}if($){ce.clear();const _e=g.icon.placedSymbolArray;for(let ve=0;ve<_e.length;ve++){const Ne=_e.get(ve),{numGlyphs:Le}=Ne,De=fe[ve];if(Ne.hidden||!De)Ds(Le,ce);else{const{x:$e,y:Ue,z:Ye,angle:kt}=De;for(let qe=0;qe<Le;qe++)a.addDynamicAttributes(ce,$e,Ue,Ye,kt)}}g.icon.dynamicLayoutVertexBuffer.updateData(ce)}g.text.dynamicLayoutVertexBuffer.updateData(oe)}function Xh(g,o,h){return h.iconsInText&&o?"symbolTextAndIcon":g?"symbolSDF":"symbolIcon"}function _p(g,o,h,_,T,C,N,D,B,G,$,J){const oe=g.context,ce=oe.gl,fe=g.transform,de=D==="map",me=B==="map",Q=de&&h.layout.get("symbol-placement")!=="point",le=de&&!me&&!Q,_e=h.layout.get("symbol-sort-key").constantOr(1)!==void 0;let ve=!1;const Ne=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),Le=[a.mercatorXfromLng(fe.center.lng),a.mercatorYfromLat(fe.center.lat)],De=h.layout.get("text-variable-anchor"),$e=fe.projection.name==="globe",Ue=[],Ye=[0,-1,0];let kt=Ye;!$e&&!fe.mercatorFromTransition||de||(kt=(function(qe){const at=qe._camera.getWorldToCamera(qe.worldSize,1),Je=a.multiply([],at,qe.globeMatrix);a.invert(Je,Je);const Et=[0,0,0],Ke=[0,1,0,0];return a.transformMat4$1(Ke,Ke,Je),Et[0]=Ke[0],Et[1]=Ke[1],Et[2]=Ke[2],a.normalize(Et,Et),Et})(fe));for(const qe of _){const at=o.getTile(qe),Je=at.getBucket(h);if(!Je||Je.projection.name==="mercator"&&$e)continue;const Et=T?Je.text:Je.icon;if(!Et||Je.fullyClipped||!Et.segments.get().length)continue;const Ke=Et.programConfigurations.get(h.id),lt=T||Je.sdfIcons,Tt=T?Je.textSizeData:Je.iconSizeData,xt=me||fe.pitch!==0,At=a.evaluateSizeForZoom(Tt,fe.zoom);let Qt,yn,qt,un,jn=[0,0],Fn=null;if(T)yn=at.glyphAtlasTexture,qt=ce.LINEAR,Qt=at.glyphAtlasTexture.size,Je.iconsInText&&(jn=at.imageAtlasTexture.size,Fn=at.imageAtlasTexture,un=xt||g.options.rotating||g.options.zooming||Tt.kind==="composite"||Tt.kind==="camera"?ce.LINEAR:ce.NEAREST);else{const co=h.layout.get("icon-size").constantOr(0)!==1||Je.iconsNeedLinear;yn=at.imageAtlasTexture,qt=lt||g.options.rotating||g.options.zooming||co||xt?ce.LINEAR:ce.NEAREST,Qt=at.imageAtlasTexture.size}const en=Je.projection.name==="globe",Gn=en?kt:Ye,sr=en?a.globeToMercatorTransition(fe.zoom):0,or=Cr(qe,Je.getProjection(),fe),tr=fe.calculatePixelsToTileUnitsMatrix(at),Ni=dt(or,at.tileID.canonical,me,de,fe,Je.getProjection(),tr),$r=g.terrain&&me&&Q?a.invert(a.create(),Ni):qh,Vs=si(or,at.tileID.canonical,me,de,fe,Je.getProjection(),tr),lo=De&&Je.hasTextData(),In=h.layout.get("icon-text-fit")!=="none"&&lo&&Je.hasIconData();if(Q){const co=fe.elevation,uo=co?co.getAtTileOffsetFunc(qe,fe.center.lat,fe.worldSize,Je.getProjection()):null,Co=bi(or,at.tileID.canonical,me,de,fe,Je.getProjection(),tr);Xl(Je,or,g,T,Co,Vs,me,G,uo,qe)}const fr=Q||T&&De||In,Qn=g.translatePosMatrix(or,at,C,N),Gr=fr?qh:Ni,Di=g.translatePosMatrix(Vs,at,C,N,!0),xr=Je.getProjection().createInversionMatrix(fe,qe.canonical),hi=[];g.terrainRenderModeElevated()&&me&&hi.push("PITCH_WITH_MAP_TERRAIN"),en&&hi.push("PROJECTION_GLOBE_VIEW"),fr&&hi.push("PROJECTED_POS_ON_VIEWPORT");const Dr=lt&&h.paint.get(T?"text-halo-width":"icon-halo-width").constantOr(1)!==0;let Or;Or=lt?Je.iconsInText?yp(Tt.kind,At,le,me,g,Qn,Gr,Di,Qt,jn,qe,sr,Le,xr,Gn,Je.getProjection()):pl(Tt.kind,At,le,me,g,Qn,Gr,Di,T,Qt,!0,qe,sr,Le,xr,Gn,Je.getProjection()):Hh(Tt.kind,At,le,me,g,Qn,Gr,Di,T,Qt,qe,sr,Le,xr,Gn,Je.getProjection());const Kr={program:g.useProgram(Xh(lt,T,Je),Ke,hi),buffers:Et,uniformValues:Or,atlasTexture:yn,atlasTextureIcon:Fn,atlasInterpolation:qt,atlasInterpolationIcon:un,isSDF:lt,hasHalo:Dr,tile:at,labelPlaneMatrixInv:$r};if(_e&&Je.canOverlap){ve=!0;const co=Et.segments.get();for(const uo of co)Ue.push({segments:new a.SegmentVector([uo]),sortKey:uo.sortKey,state:Kr})}else Ue.push({segments:Et.segments,sortKey:0,state:Kr})}ve&&Ue.sort(((qe,at)=>qe.sortKey-at.sortKey));for(const qe of Ue){const at=qe.state;if(g.terrain&&g.terrain.setupElevationDraw(at.tile,at.program,{useDepthForOcclusion:!$e,labelPlaneMatrixInv:at.labelPlaneMatrixInv}),oe.activeTexture.set(ce.TEXTURE0),at.atlasTexture.bind(at.atlasInterpolation,ce.CLAMP_TO_EDGE),at.atlasTextureIcon&&(oe.activeTexture.set(ce.TEXTURE1),at.atlasTextureIcon&&at.atlasTextureIcon.bind(at.atlasInterpolationIcon,ce.CLAMP_TO_EDGE)),at.isSDF){const Je=at.uniformValues;at.hasHalo&&(Je.u_is_halo=1,fu(at.buffers,qe.segments,h,g,at.program,Ne,$,J,Je)),Je.u_is_halo=0}fu(at.buffers,qe.segments,h,g,at.program,Ne,$,J,at.uniformValues)}}function fu(g,o,h,_,T,C,N,D,B){const G=_.context,$=[g.dynamicLayoutVertexBuffer,g.opacityVertexBuffer,g.globeExtVertexBuffer];T.draw(G,G.gl.TRIANGLES,C,N,D,a.CullFaceMode.disabled,B,h.id,g.layoutVertexBuffer,g.indexBuffer,o,h.paint,_.transform.zoom,g.programConfigurations.get(h.id),$)}function so(g,o,h,_,T,C,N){const D=g.context.gl,B=h.paint.get("fill-pattern"),G=B&&B.constantOr(1);let $,J,oe,ce,fe;N?(J=G&&!h.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",$=D.LINES):(J=G?"fillPattern":"fill",$=D.TRIANGLES);for(const de of _){const me=o.getTile(de);if(G&&!me.patternsLoaded())continue;const Q=me.getBucket(h);if(!Q)continue;g.prepareDrawTile();const le=Q.programConfigurations.get(h.id),_e=g.useProgram(J,le);G&&(g.context.activeTexture.set(D.TEXTURE0),me.imageAtlasTexture.bind(D.LINEAR,D.CLAMP_TO_EDGE),le.updatePaintBuffers());const ve=B.constantOr(null);if(ve&&me.imageAtlas){const Le=me.imageAtlas.patternPositions[ve.toString()];Le&&le.setConstantPatternPositions(Le)}const Ne=g.translatePosMatrix(de.projMatrix,me,h.paint.get("fill-translate"),h.paint.get("fill-translate-anchor"));if(N){ce=Q.indexBuffer2,fe=Q.segments2;const Le=g.terrain&&g.terrain.renderingToTexture?g.terrain.drapeBufferSize:[D.drawingBufferWidth,D.drawingBufferHeight];oe=J==="fillOutlinePattern"&&G?Fh(Ne,g,me,Le):ng(Ne,Le)}else ce=Q.indexBuffer,fe=Q.segments,oe=G?Bh(Ne,g,me):fl(Ne);g.prepareDrawProgram(g.context,_e,de.toUnwrapped()),_e.draw(g.context,$,T,g.stencilModeForClipping(de),C,a.CullFaceMode.disabled,oe,h.id,Q.layoutVertexBuffer,ce,fe,h.paint,g.transform.zoom,le)}}function Na(g,o,h,_,T,C,N){const D=g.context,B=D.gl,G=g.transform,$=h.paint.get("fill-extrusion-pattern"),J=$.constantOr(1),oe=h.paint.get("fill-extrusion-opacity"),ce=[h.paint.get("fill-extrusion-ambient-occlusion-intensity"),h.paint.get("fill-extrusion-ambient-occlusion-radius")],fe=h.layout.get("fill-extrusion-edge-radius"),de=fe>0&&!h.paint.get("fill-extrusion-rounded-roof"),me=de?0:fe,Q=G.projection.name==="globe"?a.fillExtrusionHeightLift():0,le=G.projection.name==="globe",_e=le?a.globeToMercatorTransition(G.zoom):0,ve=[a.mercatorXfromLng(G.center.lng),a.mercatorYfromLat(G.center.lat)],Ne=[];le&&Ne.push("PROJECTION_GLOBE_VIEW"),ce[0]>0&&Ne.push("FAUX_AO"),de&&Ne.push("ZERO_ROOF_RADIUS");for(const Le of _){const De=o.getTile(Le),$e=De.getBucket(h);if(!$e||$e.projection.name!==G.projection.name)continue;const Ue=$e.programConfigurations.get(h.id),Ye=g.useProgram(J?"fillExtrusionPattern":"fillExtrusion",Ue,Ne);if(g.terrain){const lt=g.terrain;if(g.style.terrainSetForDrapingOnly())lt.setupElevationDraw(De,Ye,{useMeterToDem:!0});else{if(!$e.enableTerrain)continue;if(lt.setupElevationDraw(De,Ye,{useMeterToDem:!0}),Kh(D,o,Le,$e,h,lt),!$e.centroidVertexBuffer){const Tt=Ye.attributes.a_centroid_pos;Tt!==void 0&&B.vertexAttrib2f(Tt,0,0)}}}J&&(g.context.activeTexture.set(B.TEXTURE0),De.imageAtlasTexture.bind(B.LINEAR,B.CLAMP_TO_EDGE),Ue.updatePaintBuffers());const kt=$.constantOr(null);if(kt&&De.imageAtlas){const lt=De.imageAtlas.patternPositions[kt.toString()];lt&&Ue.setConstantPatternPositions(lt)}const qe=g.translatePosMatrix(Le.projMatrix,De,h.paint.get("fill-extrusion-translate"),h.paint.get("fill-extrusion-translate-anchor")),at=G.projection.createInversionMatrix(G,Le.canonical),Je=h.paint.get("fill-extrusion-vertical-gradient"),Et=J?gp(qe,g,Je,oe,ce,me,Le,De,Q,_e,ve,at):zh(qe,g,Je,oe,ce,me,Le,Q,_e,ve,at);g.prepareDrawProgram(D,Ye,Le.toUnwrapped());const Ke=[];g.terrain&&Ke.push($e.centroidVertexBuffer),le&&Ke.push($e.layoutVertexExtBuffer),Ye.draw(D,D.gl.TRIANGLES,T,C,N,a.CullFaceMode.backCCW,Et,h.id,$e.layoutVertexBuffer,$e.indexBuffer,$e.segments,h.paint,g.transform.zoom,Ue,Ke)}}function Kh(g,o,h,_,T,C){const N=[Q=>{let le=Q.canonical.x-1,_e=Q.wrap;return le<0&&(le=(1<<Q.canonical.z)-1,_e--),new a.OverscaledTileID(Q.overscaledZ,_e,Q.canonical.z,le,Q.canonical.y)},Q=>{let le=Q.canonical.x+1,_e=Q.wrap;return le===1<<Q.canonical.z&&(le=0,_e++),new a.OverscaledTileID(Q.overscaledZ,_e,Q.canonical.z,le,Q.canonical.y)},Q=>new a.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,(Q.canonical.y===0?1<<Q.canonical.z:Q.canonical.y)-1),Q=>new a.OverscaledTileID(Q.overscaledZ,Q.wrap,Q.canonical.z,Q.canonical.x,Q.canonical.y===(1<<Q.canonical.z)-1?0:Q.canonical.y+1)],D=Q=>{const le=o.getSource().minzoom,_e=Ne=>{const Le=o.getTileByID(Ne);if(Le&&Le.hasData())return Le.getBucket(T)},ve=[0,-1,1];for(const Ne of ve){if(Q.overscaledZ+Ne<le)continue;const Le=_e(Q.calculateScaledKey(Q.overscaledZ+Ne));if(Le)return Le}},B=[0,0,0],G=(Q,le)=>(B[0]=Math.min(Q.min.y,le.min.y),B[1]=Math.max(Q.max.y,le.max.y),B[2]=a.EXTENT-le.min.x>Q.max.x?le.min.x-a.EXTENT:Q.max.x,B),$=(Q,le)=>(B[0]=Math.min(Q.min.x,le.min.x),B[1]=Math.max(Q.max.x,le.max.x),B[2]=a.EXTENT-le.min.y>Q.max.y?le.min.y-a.EXTENT:Q.max.y,B),J=[(Q,le)=>G(Q,le),(Q,le)=>G(le,Q),(Q,le)=>$(Q,le),(Q,le)=>$(le,Q)],oe=new a.Point(0,0);let ce,fe,de;const me=(Q,le,_e,ve,Ne)=>{const Le=[[ve?_e:Q,ve?Q:_e,0],[ve?_e:le,ve?le:_e,0]],De=Ne<0?a.EXTENT+Ne:Ne,$e=[ve?De:(Q+le)/2,ve?(Q+le)/2:De,0];return _e===0&&Ne<0||_e!==0&&Ne>0?C.getForTilePoints(de,[$e],!0,fe):Le.push($e),C.getForTilePoints(h,Le,!0,ce),Math.max(Le[0][2],Le[1][2],$e[2])/C.exaggeration()};for(let Q=0;Q<4;Q++){const le=(Q<2?1:5)-Q,_e=_.borders[Q];if(_e.length===0)continue;const ve=de=N[Q](h),Ne=D(ve);if(!(Ne&&Ne instanceof a.FillExtrusionBucket&&Ne.enableTerrain)||_.borderDoneWithNeighborZ[Q]===Ne.canonical.z&&Ne.borderDoneWithNeighborZ[le]===_.canonical.z||(fe=C.findDEMTileFor(ve),!fe||!fe.dem))continue;if(!ce){const Ue=C.findDEMTileFor(h);if(!Ue||!Ue.dem)return;ce=Ue}const Le=Ne.borders[le];let De=0;const $e=Ne.borderDoneWithNeighborZ[le]!==_.canonical.z;if(_.canonical.z===Ne.canonical.z){for(let Ue=0;Ue<_e.length;Ue++){const Ye=_.featuresOnBorder[_e[Ue]],kt=Ye.borders[Q];let qe;for(;De<Le.length&&(qe=Ne.featuresOnBorder[Le[De]],!(qe.borders[le][1]>kt[0]+3));)$e&&Ne.encodeCentroid(void 0,qe,!1),De++;if(qe&&De<Le.length){const at=De;let Je=0;for(;!(qe.borders[le][0]>kt[1]-3)&&(Je++,++De!==Le.length);)qe=Ne.featuresOnBorder[Le[De]];if(qe=Ne.featuresOnBorder[Le[at]],Ye.intersectsCount()>1||qe.intersectsCount()>1||Je!==1){Je!==1&&(De=at),_.encodeCentroid(void 0,Ye,!1),$e&&Ne.encodeCentroid(void 0,qe,!1);continue}const Et=J[Q](Ye,qe),Ke=Q%2?a.EXTENT-1:0;oe.x=me(Et[0],Math.min(a.EXTENT-1,Et[1]),Ke,Q<2,Et[2]),oe.y=0,_.encodeCentroid(oe,Ye,!1),$e&&Ne.encodeCentroid(oe,qe,!1)}else _.encodeCentroid(void 0,Ye,!1)}_.borderDoneWithNeighborZ[Q]=Ne.canonical.z,_.needsCentroidUpdate=!0,$e&&(Ne.borderDoneWithNeighborZ[le]=_.canonical.z,Ne.needsCentroidUpdate=!0)}else{for(const Ue of _e)_.encodeCentroid(void 0,_.featuresOnBorder[Ue],!1);if($e){for(const Ue of Le)Ne.encodeCentroid(void 0,Ne.featuresOnBorder[Ue],!1);Ne.borderDoneWithNeighborZ[le]=_.canonical.z,Ne.needsCentroidUpdate=!0}_.borderDoneWithNeighborZ[Q]=Ne.canonical.z,_.needsCentroidUpdate=!0}}(_.needsCentroidUpdate||!_.centroidVertexBuffer&&_.centroidVertexArray.length!==0)&&_.uploadCentroid(g)}const ml=new a.Color(1,0,0,1),xp=new a.Color(0,1,0,1),vp=new a.Color(0,0,1,1),Yh=new a.Color(1,0,1,1),ig=new a.Color(0,1,1,1);function sg(g,o,h){const _=g.context,T=g.transform,C=_.gl,N=T.projection.name==="globe",D=N?["PROJECTION_GLOBE_VIEW"]:null;let B=h.projMatrix;if(N&&a.globeToMercatorTransition(T.zoom)>0){const Ye=a.transitionTileAABBinECEF(h.canonical,T),kt=a.globeDenormalizeECEF(Ye);B=a.multiply(new Float32Array(16),T.globeMatrix,kt),a.multiply(B,T.projMatrix,B)}const G=g.useProgram("debug",null,D),$=o.getTileByID(h.key);g.terrain&&g.terrain.setupElevationDraw($,G);const J=a.DepthMode.disabled,oe=a.StencilMode.disabled,ce=g.colorModeForRenderPass(),fe="$debug";_.activeTexture.set(C.TEXTURE0),g.emptyTexture.bind(C.LINEAR,C.CLAMP_TO_EDGE),N?$._makeGlobeTileDebugBuffers(g.context,T):$._makeDebugTileBoundsBuffers(g.context,T.projection);const de=$._tileDebugBuffer||g.debugBuffer,me=$._tileDebugIndexBuffer||g.debugIndexBuffer,Q=$._tileDebugSegments||g.debugSegments;G.draw(_,C.LINE_STRIP,J,oe,ce,a.CullFaceMode.disabled,cu(B,a.Color.red),fe,de,me,Q,null,null,null,[$._globeTileDebugBorderBuffer]);const le=$.latestRawTileData,_e=Math.floor((le&&le.byteLength||0)/1024),ve=o.getTile(h).tileSize,Ne=512/Math.min(ve,512)*(h.overscaledZ/T.zoom)*.5;let Le=h.canonical.toString();h.overscaledZ!==h.canonical.z&&(Le+=` => ${h.overscaledZ}`),Le+=` ${_e}kb`,(function(Ye,kt){Ye.initDebugOverlayCanvas();const qe=Ye.debugOverlayCanvas,at=Ye.context.gl,Je=Ye.debugOverlayCanvas.getContext("2d");Je.clearRect(0,0,qe.width,qe.height),Je.shadowColor="white",Je.shadowBlur=2,Je.lineWidth=1.5,Je.strokeStyle="white",Je.textBaseline="top",Je.font="bold 36px Open Sans, sans-serif",Je.fillText(kt,5,5),Je.strokeText(kt,5,5),Ye.debugOverlayTexture.update(qe),Ye.debugOverlayTexture.bind(at.LINEAR,at.CLAMP_TO_EDGE)})(g,Le);const De=$._tileDebugTextBuffer||g.debugBuffer,$e=$._tileDebugTextIndexBuffer||g.quadTriangleIndexBuffer,Ue=$._tileDebugTextSegments||g.debugSegments;G.draw(_,C.TRIANGLES,J,oe,a.ColorMode.alphaBlended,a.CullFaceMode.disabled,cu(B,a.Color.transparent,Ne),fe,De,$e,Ue,null,null,null,[$._globeTileDebugTextBuffer])}function gl(g,o,h,_){Ho(g,0,o+h/2,g.transform.width,h,_)}function lc(g,o,h,_){Ho(g,o-h/2,0,h,g.transform.height,_)}function Ho(g,o,h,_,T,C){const N=g.context,D=N.gl;D.enable(D.SCISSOR_TEST),D.scissor(o*a.exported.devicePixelRatio,h*a.exported.devicePixelRatio,_*a.exported.devicePixelRatio,T*a.exported.devicePixelRatio),N.clear({color:C}),D.disable(D.SCISSOR_TEST)}const gd=a.createLayout([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:Jh}=gd;function oo(g,o,h,_){g.emplaceBack(o,h,_)}class aa{constructor(o){this.vertexArray=new a.StructArrayLayout3f12,this.indices=new a.StructArrayLayout3ui6,oo(this.vertexArray,-1,-1,1),oo(this.vertexArray,1,-1,1),oo(this.vertexArray,-1,1,1),oo(this.vertexArray,1,1,1),oo(this.vertexArray,-1,-1,-1),oo(this.vertexArray,1,-1,-1),oo(this.vertexArray,-1,1,-1),oo(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,Jh),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=a.SegmentVector.simpleSegment(0,0,36,12)}}function bs(g,o,h,_,T,C){const N=g.gl,D=o.paint.get("sky-atmosphere-color"),B=o.paint.get("sky-atmosphere-halo-color"),G=o.paint.get("sky-atmosphere-sun-intensity"),$=((J,oe,ce,fe,de)=>({u_matrix_3f:J,u_sun_direction:oe,u_sun_intensity:ce,u_color_tint_r:[fe.r,fe.g,fe.b,fe.a],u_color_tint_m:[de.r,de.g,de.b,de.a],u_luminance:5e-5}))(a.fromMat4(a.create$1(),_),T,G,D,B);N.framebufferTexture2D(N.FRAMEBUFFER,N.COLOR_ATTACHMENT0,N.TEXTURE_CUBE_MAP_POSITIVE_X+C,o.skyboxTexture,0),h.draw(g,N.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,a.ColorMode.unblended,a.CullFaceMode.frontCW,$,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const cc=a.createLayout([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class pu{constructor(o){const h=new a.StructArrayLayout5f20;h.emplaceBack(-1,1,1,0,0),h.emplaceBack(1,1,1,1,0),h.emplaceBack(1,-1,1,1,1),h.emplaceBack(-1,-1,1,0,1);const _=new a.StructArrayLayout3ui6;_.emplaceBack(0,1,2),_.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(h,cc.members),this.indexBuffer=o.createIndexBuffer(_),this.segments=a.SegmentVector.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const Da={symbol:function(g,o,h,_,T){if(g.renderPass!=="translucent")return;const C=a.StencilMode.disabled,N=g.colorModeForRenderPass();h.layout.get("text-variable-anchor")&&(function(D,B,G,$,J,oe,ce){const fe=B.transform,de=J==="map",me=oe==="map";for(const Q of D){const le=$.getTile(Q),_e=le.getBucket(G);if(!_e||!_e.text||!_e.text.segments.get().length)continue;const ve=a.evaluateSizeForZoom(_e.textSizeData,fe.zoom),Ne=Cr(Q,_e.getProjection(),fe),Le=fe.calculatePixelsToTileUnitsMatrix(le),De=dt(Ne,le.tileID.canonical,me,de,fe,_e.getProjection(),Le),$e=G.layout.get("icon-text-fit")!=="none"&&_e.hasIconData();if(ve){const Ue=Math.pow(2,fe.zoom-le.tileID.overscaledZ);rg(_e,de,me,ce,a.symbolSize,fe,De,Q,Ue,ve,$e)}}})(_,g,h,o,h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),T),h.paint.get("icon-opacity").constantOr(1)!==0&&_p(g,o,h,_,!1,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),h.layout.get("icon-rotation-alignment"),h.layout.get("icon-pitch-alignment"),h.layout.get("icon-keep-upright"),C,N),h.paint.get("text-opacity").constantOr(1)!==0&&_p(g,o,h,_,!0,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),h.layout.get("text-rotation-alignment"),h.layout.get("text-pitch-alignment"),h.layout.get("text-keep-upright"),C,N),o.map.showCollisionBoxes&&(ac(g,o,h,_,h.paint.get("text-translate"),h.paint.get("text-translate-anchor"),!0),ac(g,o,h,_,h.paint.get("icon-translate"),h.paint.get("icon-translate-anchor"),!1))},circle:function(g,o,h,_){if(g.renderPass!=="translucent")return;const T=h.paint.get("circle-opacity"),C=h.paint.get("circle-stroke-width"),N=h.paint.get("circle-stroke-opacity"),D=h.layout.get("circle-sort-key").constantOr(1)!==void 0;if(T.constantOr(1)===0&&(C.constantOr(1)===0||N.constantOr(1)===0))return;const B=g.context,G=B.gl,$=g.transform,J=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),oe=a.StencilMode.disabled,ce=g.colorModeForRenderPass(),fe=$.projection.name==="globe",de=[a.mercatorXfromLng($.center.lng),a.mercatorYfromLat($.center.lat)],me=[];for(let le=0;le<_.length;le++){const _e=_[le],ve=o.getTile(_e),Ne=ve.getBucket(h);if(!Ne||Ne.projection.name!==$.projection.name)continue;const Le=Ne.programConfigurations.get(h.id),De=hd(h);fe&&De.push("PROJECTION_GLOBE_VIEW");const $e=g.useProgram("circle",Le,De),Ue=Ne.layoutVertexBuffer,Ye=Ne.globeExtVertexBuffer,kt=Ne.indexBuffer,qe=$.projection.createInversionMatrix($,_e.canonical),at={programConfiguration:Le,program:$e,layoutVertexBuffer:Ue,globeExtVertexBuffer:Ye,indexBuffer:kt,uniformValues:Vh(g,_e,ve,qe,de,h),tile:ve};if(D){const Je=Ne.segments.get();for(const Et of Je)me.push({segments:new a.SegmentVector([Et]),sortKey:Et.sortKey,state:at})}else me.push({segments:Ne.segments,sortKey:0,state:at})}D&&me.sort(((le,_e)=>le.sortKey-_e.sortKey));const Q={useDepthForOcclusion:!fe};for(const le of me){const{programConfiguration:_e,program:ve,layoutVertexBuffer:Ne,globeExtVertexBuffer:Le,indexBuffer:De,uniformValues:$e,tile:Ue}=le.state,Ye=le.segments;g.terrain&&g.terrain.setupElevationDraw(Ue,ve,Q),g.prepareDrawProgram(B,ve,Ue.tileID.toUnwrapped()),ve.draw(B,G.TRIANGLES,J,oe,ce,a.CullFaceMode.disabled,$e,h.id,Ne,De,Ye,h.paint,$.zoom,_e,[Le])}},heatmap:function(g,o,h,_){if(h.paint.get("heatmap-opacity")!==0)if(g.renderPass==="offscreen"){const T=g.context,C=T.gl,N=a.StencilMode.disabled,D=new a.ColorMode([C.ONE,C.ONE],a.Color.transparent,[!0,!0,!0,!0]);(function(ce,fe,de,me){const Q=ce.gl,le=fe.width*me,_e=fe.height*me;ce.activeTexture.set(Q.TEXTURE1),ce.viewport.set([0,0,le,_e]);let ve=de.heatmapFbo;if(!ve||ve&&(ve.width!==le||ve.height!==_e)){ve&&ve.destroy();const Ne=Q.createTexture();Q.bindTexture(Q.TEXTURE_2D,Ne),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_S,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_WRAP_T,Q.CLAMP_TO_EDGE),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MIN_FILTER,Q.LINEAR),Q.texParameteri(Q.TEXTURE_2D,Q.TEXTURE_MAG_FILTER,Q.LINEAR),ve=de.heatmapFbo=ce.createFramebuffer(le,_e,!1),(function(Le,De,$e,Ue,Ye,kt){const qe=Le.gl;qe.texImage2D(qe.TEXTURE_2D,0,Le.isWebGL2&&Le.extRenderToTextureHalfFloat?qe.RGBA16F:qe.RGBA,Ye,kt,0,qe.RGBA,Le.extRenderToTextureHalfFloat?Le.isWebGL2?qe.HALF_FLOAT:Le.extTextureHalfFloat.HALF_FLOAT_OES:qe.UNSIGNED_BYTE,null),Ue.colorAttachment.set($e)})(ce,0,Ne,ve,le,_e)}else Q.bindTexture(Q.TEXTURE_2D,ve.colorAttachment.get()),ce.bindFramebuffer.set(ve.framebuffer)})(T,g,h,g.transform.projection.name==="globe"?.5:.25),T.clear({color:a.Color.transparent});const B=g.transform,G=B.projection.name==="globe",$=G?["PROJECTION_GLOBE_VIEW"]:null,J=G?a.CullFaceMode.frontCCW:a.CullFaceMode.disabled,oe=[a.mercatorXfromLng(B.center.lng),a.mercatorYfromLat(B.center.lat)];for(let ce=0;ce<_.length;ce++){const fe=_[ce];if(o.hasRenderableParent(fe))continue;const de=o.getTile(fe),me=de.getBucket(h);if(!me||me.projection.name!==B.projection.name)continue;const Q=me.programConfigurations.get(h.id),le=g.useProgram("heatmap",Q,$),{zoom:_e}=g.transform;g.terrain&&g.terrain.setupElevationDraw(de,le),g.prepareDrawProgram(T,le,fe.toUnwrapped());const ve=B.projection.createInversionMatrix(B,fe.canonical);le.draw(T,C.TRIANGLES,a.DepthMode.disabled,N,D,J,$h(g,fe,de,ve,oe,_e,h.paint.get("heatmap-intensity")),h.id,me.layoutVertexBuffer,me.indexBuffer,me.segments,h.paint,g.transform.zoom,Q,G?[me.globeExtVertexBuffer]:null)}T.viewport.set([0,0,g.width,g.height])}else g.renderPass==="translucent"&&(g.context.setColorMode(g.colorModeForRenderPass()),(function(T,C){const N=T.context,D=N.gl,B=C.heatmapFbo;if(!B)return;N.activeTexture.set(D.TEXTURE0),D.bindTexture(D.TEXTURE_2D,B.colorAttachment.get()),N.activeTexture.set(D.TEXTURE1);let G=C.colorRampTexture;G||(G=C.colorRampTexture=new a.Texture(N,C.colorRamp,D.RGBA)),G.bind(D.LINEAR,D.CLAMP_TO_EDGE),T.useProgram("heatmapTexture").draw(N,D.TRIANGLES,a.DepthMode.disabled,a.StencilMode.disabled,T.colorModeForRenderPass(),a.CullFaceMode.disabled,(($,J,oe,ce)=>({u_image:0,u_color_ramp:1,u_opacity:J.paint.get("heatmap-opacity")}))(0,C),C.id,T.viewportBuffer,T.quadTriangleIndexBuffer,T.viewportSegments,C.paint,T.transform.zoom)})(g,h))},line:function(g,o,h,_){if(g.renderPass!=="translucent")return;const T=h.paint.get("line-opacity"),C=h.paint.get("line-width");if(T.constantOr(1)===0||C.constantOr(1)===0)return;const N=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),D=g.colorModeForRenderPass(),B=g.terrain&&g.terrain.renderingToTexture?1:a.exported.devicePixelRatio,G=h.paint.get("line-dasharray"),$=G.constantOr(1),J=h.layout.get("line-cap"),oe=h.paint.get("line-pattern"),ce=oe.constantOr(1),fe=h.paint.get("line-gradient"),de=ce?"linePattern":"line",me=g.context,Q=me.gl,le=(ve=>{const Ne=[];oc(ve)&&Ne.push("RENDER_LINE_DASH"),ve.paint.get("line-gradient")&&Ne.push("RENDER_LINE_GRADIENT");const Le=ve.paint.get("line-trim-offset");Le[0]===0&&Le[1]===0||Ne.push("RENDER_LINE_TRIM_OFFSET");const De=ve.paint.get("line-pattern").constantOr(1),$e=ve.paint.get("line-opacity").constantOr(1)!==1;return!De&&$e&&Ne.push("RENDER_LINE_ALPHA_DISCARD"),Ne})(h);let _e=le.includes("RENDER_LINE_ALPHA_DISCARD");g.terrain&&g.terrain.clipOrMaskOverlapStencilType()&&(_e=!1);for(const ve of _){const Ne=o.getTile(ve);if(ce&&!Ne.patternsLoaded())continue;const Le=Ne.getBucket(h);if(!Le)continue;g.prepareDrawTile();const De=Le.programConfigurations.get(h.id),$e=g.useProgram(de,De,le),Ue=oe.constantOr(null);if(Ue&&Ne.imageAtlas){const lt=Ne.imageAtlas.patternPositions[Ue.toString()];lt&&De.setConstantPatternPositions(lt)}const Ye=G.constantOr(null),kt=J.constantOr(null);if(!ce&&Ye&&kt&&Ne.lineAtlas){const lt=Ne.lineAtlas.getDash(Ye,kt);lt&&De.setConstantPatternPositions(lt)}let[qe,at]=h.paint.get("line-trim-offset");(kt==="round"||kt==="square")&&qe!==at&&(qe===0&&(qe-=1),at===1&&(at+=1));const Je=g.terrain?ve.projMatrix:null,Et=ce?uu(g,Ne,h,Je,B):ic(g,Ne,h,Je,Le.lineClipsArray.length,B,[qe,at]);if(fe){const lt=Le.gradients[h.id];let Tt=lt.texture;if(h.gradientVersion!==lt.version){let xt=256;if(h.stepInterpolant){const At=o.getSource().maxzoom,Qt=ve.canonical.z===At?Math.ceil(1<<g.transform.maxZoom-ve.canonical.z):1;xt=a.clamp(a.nextPowerOfTwo(Le.maxLineLength/a.EXTENT*1024*Qt),256,me.maxTextureSize)}lt.gradient=a.renderColorRamp({expression:h.gradientExpression(),evaluationKey:"lineProgress",resolution:xt,image:lt.gradient||void 0,clips:Le.lineClipsArray}),lt.texture?lt.texture.update(lt.gradient):lt.texture=new a.Texture(me,lt.gradient,Q.RGBA),lt.version=h.gradientVersion,Tt=lt.texture}me.activeTexture.set(Q.TEXTURE1),Tt.bind(h.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}$&&(me.activeTexture.set(Q.TEXTURE0),Ne.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),De.updatePaintBuffers()),ce&&(me.activeTexture.set(Q.TEXTURE0),Ne.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),De.updatePaintBuffers()),g.prepareDrawProgram(me,$e,ve.toUnwrapped());const Ke=lt=>{$e.draw(me,Q.TRIANGLES,N,lt,D,a.CullFaceMode.disabled,Et,h.id,Le.layoutVertexBuffer,Le.indexBuffer,Le.segments,h.paint,g.transform.zoom,De,[Le.layoutVertexBuffer2])};if(_e){const lt=g.stencilModeForClipping(ve).ref;lt===0&&g.terrain&&me.clear({stencil:0});const Tt={func:Q.EQUAL,mask:255};Et.u_alpha_discard_threshold=.8,Ke(new a.StencilMode(Tt,lt,255,Q.KEEP,Q.KEEP,Q.INVERT)),Et.u_alpha_discard_threshold=0,Ke(new a.StencilMode(Tt,lt,255,Q.KEEP,Q.KEEP,Q.KEEP))}else Ke(g.stencilModeForClipping(ve))}_e&&(g.resetStencilClippingMasks(),g.terrain&&me.clear({stencil:0}))},fill:function(g,o,h,_){const T=h.paint.get("fill-color"),C=h.paint.get("fill-opacity");if(C.constantOr(1)===0)return;const N=g.colorModeForRenderPass(),D=h.paint.get("fill-pattern"),B=g.opaquePassEnabledForLayer()&&!D.constantOr(1)&&T.constantOr(a.Color.transparent).a===1&&C.constantOr(0)===1?"opaque":"translucent";if(g.renderPass===B){const G=g.depthModeForSublayer(1,g.renderPass==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly);so(g,o,h,_,G,N,!1)}if(g.renderPass==="translucent"&&h.paint.get("fill-antialias")){const G=g.depthModeForSublayer(h.getPaintProperty("fill-outline-color")?2:0,a.DepthMode.ReadOnly);so(g,o,h,_,G,N,!0)}},"fill-extrusion":function(g,o,h,_){const T=h.paint.get("fill-extrusion-opacity");if(T!==0&&g.renderPass==="translucent"){const C=new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D);if(T!==1||h.paint.get("fill-extrusion-pattern").constantOr(1))Na(g,o,h,_,C,a.StencilMode.disabled,a.ColorMode.disabled),Na(g,o,h,_,C,g.stencilModeFor3D(),g.colorModeForRenderPass()),g.resetStencilClippingMasks();else{const N=g.colorModeForRenderPass();Na(g,o,h,_,C,a.StencilMode.disabled,N)}}},hillshade:function(g,o,h,_){if(g.renderPass!=="offscreen"&&g.renderPass!=="translucent")return;const T=g.context,C=g.depthModeForSublayer(0,a.DepthMode.ReadOnly),N=g.colorModeForRenderPass(),D=g.terrain&&g.terrain.renderingToTexture,[B,G]=g.renderPass!=="translucent"||D?[{},_]:g.stencilConfigForOverlap(_);for(const $ of G){const J=o.getTile($);if(J.needsHillshadePrepare&&g.renderPass==="offscreen")ad(g,J,h,C,a.StencilMode.disabled,N);else if(g.renderPass==="translucent"){const oe=D&&g.terrain?g.terrain.stencilModeForRTTOverlap($):B[$.overscaledZ];fp(g,$,J,h,C,oe,N)}}T.viewport.set([0,0,g.width,g.height]),g.resetStencilClippingMasks()},raster:function(g,o,h,_,T,C){if(g.renderPass!=="translucent"||h.paint.get("raster-opacity")===0||!_.length)return;const N=g.context,D=N.gl,B=o.getSource(),G=g.useProgram("raster"),$=g.colorModeForRenderPass(),J=g.terrain&&g.terrain.renderingToTexture,[oe,ce]=B instanceof An||J?[{},_]:g.stencilConfigForOverlap(_),fe=ce[ce.length-1].overscaledZ,de=!g.options.moving;for(const me of ce){const Q=J?a.DepthMode.disabled:g.depthModeForSublayer(me.overscaledZ-fe,h.paint.get("raster-opacity")===1?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly,D.LESS),le=me.toUnwrapped(),_e=o.getTile(me);if(J&&(!_e||!_e.hasData()))continue;const ve=J?me.projMatrix:g.transform.calculateProjMatrix(le,de),Ne=g.terrain&&J?g.terrain.stencilModeForRTTOverlap(me):oe[me.overscaledZ],Le=C?0:h.paint.get("raster-fade-duration");_e.registerFadeDuration(Le);const De=o.findLoadedParent(me,0),$e=jh(_e,De,o,g.transform,Le);let Ue,Ye;g.terrain&&g.terrain.prepareDrawTile();const kt=h.paint.get("raster-resampling")==="nearest"?D.NEAREST:D.LINEAR;N.activeTexture.set(D.TEXTURE0),_e.texture.bind(kt,D.CLAMP_TO_EDGE),N.activeTexture.set(D.TEXTURE1),De?(De.texture.bind(kt,D.CLAMP_TO_EDGE),Ue=Math.pow(2,De.tileID.overscaledZ-_e.tileID.overscaledZ),Ye=[_e.tileID.canonical.x*Ue%1,_e.tileID.canonical.y*Ue%1]):_e.texture.bind(kt,D.CLAMP_TO_EDGE),_e.texture.useMipmap&&N.extTextureFilterAnisotropic&&g.transform.pitch>20&&D.texParameterf(D.TEXTURE_2D,N.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,N.extTextureFilterAnisotropicMax);const qe=pd(ve,Ye||[0,0],Ue||1,$e,h,B instanceof An?B.perspectiveTransform:[0,0]);if(g.prepareDrawProgram(N,G,le),B instanceof An)B.boundsBuffer&&B.boundsSegments&&G.draw(N,D.TRIANGLES,Q,a.StencilMode.disabled,$,a.CullFaceMode.disabled,qe,h.id,B.boundsBuffer,g.quadTriangleIndexBuffer,B.boundsSegments);else{const{tileBoundsBuffer:at,tileBoundsIndexBuffer:Je,tileBoundsSegments:Et}=g.getTileBoundsBuffers(_e);G.draw(N,D.TRIANGLES,Q,Ne,$,a.CullFaceMode.disabled,qe,h.id,at,Je,Et)}}g.resetStencilClippingMasks()},background:function(g,o,h,_){const T=h.paint.get("background-color"),C=h.paint.get("background-opacity");if(C===0)return;const N=g.context,D=N.gl,B=g.transform,G=B.tileSize,$=h.paint.get("background-pattern");if(g.isPatternMissing($))return;const J=!$&&T.a===1&&C===1&&g.opaquePassEnabledForLayer()?"opaque":"translucent";if(g.renderPass!==J)return;const oe=a.StencilMode.disabled,ce=g.depthModeForSublayer(0,J==="opaque"?a.DepthMode.ReadWrite:a.DepthMode.ReadOnly),fe=g.colorModeForRenderPass(),de=g.useProgram($?"backgroundPattern":"background");let me,Q=_;Q||(me=g.getBackgroundTiles(),Q=Object.values(me).map((le=>le.tileID))),$&&(N.activeTexture.set(D.TEXTURE0),g.imageManager.bind(g.context));for(const le of Q){const _e=le.toUnwrapped(),ve=_?le.projMatrix:g.transform.calculateProjMatrix(_e);g.prepareDrawTile();const Ne=o?o.getTile(le):me?me[le.key]:new a.Tile(le,G,B.zoom,g),Le=$?Wh(ve,C,g,$,{tileID:le,tileSize:G}):md(ve,C,T);g.prepareDrawProgram(N,de,_e);const{tileBoundsBuffer:De,tileBoundsIndexBuffer:$e,tileBoundsSegments:Ue}=g.getTileBoundsBuffers(Ne);de.draw(N,D.TRIANGLES,ce,oe,fe,a.CullFaceMode.disabled,Le,h.id,De,$e,Ue)}},sky:function(g,o,h){const _=g.transform,T=_.projection.name==="mercator"||_.projection.name==="globe"?1:a.smoothstep(7,8,_.zoom),C=h.paint.get("sky-opacity")*T;if(C===0)return;const N=g.context,D=h.paint.get("sky-type"),B=new a.DepthMode(N.gl.LEQUAL,a.DepthMode.ReadOnly,[0,1]),G=g.frameCounter/1e3%1;D==="atmosphere"?g.renderPass==="offscreen"?h.needsSkyboxCapture(g)&&((function($,J,oe,ce){const fe=$.context,de=fe.gl;let me=J.skyboxFbo;if(!me){me=J.skyboxFbo=fe.createFramebuffer(32,32,!1),J.skyboxGeometry=new aa(fe),J.skyboxTexture=fe.gl.createTexture(),de.bindTexture(de.TEXTURE_CUBE_MAP,J.skyboxTexture),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_S,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_WRAP_T,de.CLAMP_TO_EDGE),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MIN_FILTER,de.LINEAR),de.texParameteri(de.TEXTURE_CUBE_MAP,de.TEXTURE_MAG_FILTER,de.LINEAR);for(let ve=0;ve<6;++ve)de.texImage2D(de.TEXTURE_CUBE_MAP_POSITIVE_X+ve,0,de.RGBA,32,32,0,de.RGBA,de.UNSIGNED_BYTE,null)}fe.bindFramebuffer.set(me.framebuffer),fe.viewport.set([0,0,32,32]);const Q=J.getCenter($,!0),le=$.useProgram("skyboxCapture"),_e=new Float64Array(16);a.identity(_e),a.rotateY(_e,_e,.5*-Math.PI),bs(fe,J,le,_e,Q,0),a.identity(_e),a.rotateY(_e,_e,.5*Math.PI),bs(fe,J,le,_e,Q,1),a.identity(_e),a.rotateX(_e,_e,.5*-Math.PI),bs(fe,J,le,_e,Q,2),a.identity(_e),a.rotateX(_e,_e,.5*Math.PI),bs(fe,J,le,_e,Q,3),a.identity(_e),bs(fe,J,le,_e,Q,4),a.identity(_e),a.rotateY(_e,_e,Math.PI),bs(fe,J,le,_e,Q,5),fe.viewport.set([0,0,$.width,$.height])})(g,h),h.markSkyboxValid(g)):g.renderPass==="sky"&&(function($,J,oe,ce,fe){const de=$.context,me=de.gl,Q=$.transform,le=$.useProgram("skybox");de.activeTexture.set(me.TEXTURE0),me.bindTexture(me.TEXTURE_CUBE_MAP,J.skyboxTexture);const _e=((ve,Ne,Le,De,$e)=>({u_matrix:ve,u_sun_direction:Ne,u_cubemap:0,u_opacity:De,u_temporal_offset:$e}))(Q.skyboxMatrix,J.getCenter($,!1),0,ce,fe);$.prepareDrawProgram(de,le),le.draw(de,me.TRIANGLES,oe,a.StencilMode.disabled,$.colorModeForRenderPass(),a.CullFaceMode.backCW,_e,"skybox",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)})(g,h,B,C,G):D==="gradient"&&g.renderPass==="sky"&&(function($,J,oe,ce,fe){const de=$.context,me=de.gl,Q=$.transform,le=$.useProgram("skyboxGradient");J.skyboxGeometry||(J.skyboxGeometry=new aa(de)),de.activeTexture.set(me.TEXTURE0);let _e=J.colorRampTexture;_e||(_e=J.colorRampTexture=new a.Texture(de,J.colorRamp,me.RGBA)),_e.bind(me.LINEAR,me.CLAMP_TO_EDGE);const ve=((Ne,Le,De,$e,Ue)=>({u_matrix:Ne,u_color_ramp:0,u_center_direction:Le,u_radius:a.degToRad(De),u_opacity:$e,u_temporal_offset:Ue}))(Q.skyboxMatrix,J.getCenter($,!1),J.paint.get("sky-gradient-radius"),ce,fe);$.prepareDrawProgram(de,le),le.draw(de,me.TRIANGLES,oe,a.StencilMode.disabled,$.colorModeForRenderPass(),a.CullFaceMode.backCW,ve,"skyboxGradient",J.skyboxGeometry.vertexBuffer,J.skyboxGeometry.indexBuffer,J.skyboxGeometry.segment)})(g,h,B,C,G)},debug:function(g,o,h){for(let _=0;_<h.length;_++)sg(g,o,h[_])},custom:function(g,o,h,_){const T=g.context,C=h.implementation;if(!g.transform.projection.unsupportedLayers||!g.transform.projection.unsupportedLayers.includes("custom")||g.terrain&&(g.terrain.renderingToTexture||g.renderPass==="offscreen")&&h.isLayerDraped()){if(g.renderPass==="offscreen"){const N=C.prerender;if(N){if(g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;N.call(C,T.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else N.call(C,T.gl,g.transform.customLayerMatrix());T.setDirty(),g.setBaseState()}}else if(g.renderPass==="translucent"){if(g.terrain&&g.terrain.renderingToTexture){const D=C.renderToTile;if(D){const B=_[0].canonical,G=new a.MercatorCoordinate(B.x+_[0].wrap*(1<<B.z),B.y,B.z);T.setDepthMode(a.DepthMode.disabled),T.setStencilMode(a.StencilMode.disabled),T.setColorMode(g.colorModeForRenderPass()),g.setCustomLayerDefaults(),D.call(C,T.gl,G),T.setDirty(),g.setBaseState()}return}g.setCustomLayerDefaults(),T.setColorMode(g.colorModeForRenderPass()),T.setStencilMode(a.StencilMode.disabled);const N=C.renderingMode==="3d"?new a.DepthMode(g.context.gl.LEQUAL,a.DepthMode.ReadWrite,g.depthRangeFor3D):g.depthModeForSublayer(0,a.DepthMode.ReadOnly);if(T.setDepthMode(N),g.transform.projection.name==="globe"){const D=g.transform.pointMerc;C.render(T.gl,g.transform.customLayerMatrix(),g.transform.getProjection(),g.transform.globeToMercatorMatrix(),a.globeToMercatorTransition(g.transform.zoom),[D.x,D.y],g.transform.pixelsPerMeterRatio)}else C.render(T.gl,g.transform.customLayerMatrix());T.setDirty(),g.setBaseState(),T.bindFramebuffer.set(null)}}else a.warnOnce("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")}};class yl{constructor(o,h,_=!1){this.context=new St(o,_),this.transform=h,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.setup(),this.numSublayers=a.SourceCache.maxUnderzooming+a.SourceCache.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={}}updateTerrain(o,h){const _=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(_||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Oh(this,o));const T=this._terrain;this.transform.elevation=_?T:null,T.update(o,this.transform,h)}_updateFog(o){const h=o.fog;if(!h||this.transform.projection.name==="globe"||h.getOpacity(this.transform.pitch)<1||h.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[_,T]=h.getFovAdjustedRange(this.transform._fov);if(_>T)return void(this.transform.fogCullDistSq=null);const C=_+.78*(T-_);this.transform.fogCullDistSq=C*C}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled?this._terrain:null}resize(o,h){if(this.width=o*a.exported.devicePixelRatio,this.height=h*a.exported.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const _ of this.style.order)this.style._layers[_].resize()}setup(){const o=this.context,h=new a.StructArrayLayout2i4;h.emplaceBack(0,0),h.emplaceBack(a.EXTENT,0),h.emplaceBack(0,a.EXTENT),h.emplaceBack(a.EXTENT,a.EXTENT),this.tileExtentBuffer=o.createVertexBuffer(h,a.posAttributes.members),this.tileExtentSegments=a.SegmentVector.simpleSegment(0,0,4,2);const _=new a.StructArrayLayout2i4;_.emplaceBack(0,0),_.emplaceBack(a.EXTENT,0),_.emplaceBack(0,a.EXTENT),_.emplaceBack(a.EXTENT,a.EXTENT),this.debugBuffer=o.createVertexBuffer(_,a.posAttributes.members),this.debugSegments=a.SegmentVector.simpleSegment(0,0,4,5);const T=new a.StructArrayLayout2i4;T.emplaceBack(-1,-1),T.emplaceBack(1,-1),T.emplaceBack(-1,1),T.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(T,a.posAttributes.members),this.viewportSegments=a.SegmentVector.simpleSegment(0,0,4,2);const C=new a.StructArrayLayout4i8;C.emplaceBack(0,0,0,0),C.emplaceBack(a.EXTENT,0,a.EXTENT,0),C.emplaceBack(0,a.EXTENT,0,a.EXTENT),C.emplaceBack(a.EXTENT,a.EXTENT,a.EXTENT,a.EXTENT),this.mercatorBoundsBuffer=o.createVertexBuffer(C,a.boundsAttributes.members),this.mercatorBoundsSegments=a.SegmentVector.simpleSegment(0,0,4,2);const N=new a.StructArrayLayout3ui6;N.emplaceBack(0,1,2),N.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(N);const D=new a.StructArrayLayout1ui2;for(const G of[0,1,3,2,0])D.emplaceBack(G);this.debugIndexBuffer=o.createIndexBuffer(D),this.emptyTexture=new a.Texture(o,new a.RGBAImage({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA),this.identityMat=a.create();const B=this.context.gl;this.stencilClearMode=new a.StencilMode({func:B.ALWAYS,mask:0},0,255,B.ZERO,B.ZERO,B.ZERO),this.loadTimeStamps.push(a.window.performance.now()),this.atmosphereBuffer=new pu(this.context)}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context,h=o.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.useProgram("clippingMask").draw(o,h.TRIANGLES,a.DepthMode.disabled,this.stencilClearMode,a.ColorMode.disabled,a.CullFaceMode.disabled,su(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,h,_){if(!h||this.currentStencilSource===h.id||!o.isTileClipped()||!_||_.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let D=!1;for(const B of _)if(this._tileClippingMaskIDs[B.key]===void 0){D=!0;break}if(!D)return}this.currentStencilSource=h.id;const T=this.context,C=T.gl;this.nextStencilID+_.length>256&&this.clearStencil(),T.setColorMode(a.ColorMode.disabled),T.setDepthMode(a.DepthMode.disabled);const N=this.useProgram("clippingMask");this._tileClippingMaskIDs={};for(const D of _){const B=h.getTile(D),G=this._tileClippingMaskIDs[D.key]=this.nextStencilID++,{tileBoundsBuffer:$,tileBoundsIndexBuffer:J,tileBoundsSegments:oe}=this.getTileBoundsBuffers(B);N.draw(T,C.TRIANGLES,a.DepthMode.disabled,new a.StencilMode({func:C.ALWAYS,mask:0},G,255,C.KEEP,C.KEEP,C.REPLACE),a.ColorMode.disabled,a.CullFaceMode.disabled,su(D.projMatrix),"$clipping",$,J,oe)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,h=this.context.gl;return new a.StencilMode({func:h.NOTEQUAL,mask:255},o,255,h.KEEP,h.KEEP,h.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const h=this.context.gl;return new a.StencilMode({func:h.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,h.KEEP,h.KEEP,h.REPLACE)}stencilConfigForOverlap(o){const h=this.context.gl,_=o.sort(((N,D)=>D.overscaledZ-N.overscaledZ)),T=_[_.length-1].overscaledZ,C=_[0].overscaledZ-T+1;if(C>1){this.currentStencilSource=void 0,this.nextStencilID+C>256&&this.clearStencil();const N={};for(let D=0;D<C;D++)N[D+T]=new a.StencilMode({func:h.GEQUAL,mask:255},D+this.nextStencilID,255,h.KEEP,h.KEEP,h.REPLACE);return this.nextStencilID+=C,[N,_]}return[{[T]:a.StencilMode.disabled},_]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new a.ColorMode([o.CONSTANT_COLOR,o.ONE],new a.Color(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?a.ColorMode.unblended:a.ColorMode.alphaBlended}depthModeForSublayer(o,h,_){if(!this.opaquePassEnabledForLayer())return a.DepthMode.disabled;const T=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new a.DepthMode(_||this.context.gl.LEQUAL,h,[T,T])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}render(o,h){this.style=o,this.options=h,this.imageManager=o.imageManager,this.glyphManager=o.glyphManager,this.symbolFadeChange=o.placement.symbolFadeChange(a.exported.now()),this.imageManager.beginFrame();const _=this.style.order,T=this.style._sourceCaches;for(const G in T){const $=T[G];$.used&&$.prepare(this.context)}const C={},N={},D={};for(const G in T){const $=T[G];C[G]=$.getVisibleCoordinates(),N[G]=C[G].slice().reverse(),D[G]=$.getVisibleCoordinates(!0).reverse()}this.opaquePassCutoff=1/0;for(let G=0;G<_.length;G++)if(this.style._layers[_[G]].is3D()){this.opaquePassCutoff=G;break}if(this.terrain&&(this.terrain.updateTileBinding(D),this.opaquePassCutoff=0),this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new a.GlobeSharedBuffers(this.context)),!a.isMapAuthenticated(this.context.gl))return;this.renderPass="offscreen";for(const G of _){const $=this.style._layers[G],J=o._getLayerSourceCache($);if(!$.hasOffscreenPass()||$.isHidden(this.transform.zoom))continue;const oe=J?N[J.id]:void 0;($.type==="custom"||$.isSky()||oe&&oe.length)&&this.renderLayer(this,J,$,oe)}this.depthRangeFor3D=[0,1-(o.order.length+2)*this.numSublayers*this.depthEpsilon];const B=this.terrain;if(B&&(this.style.hasSymbolLayers()||this.style.hasCircleLayers())&&B.drawDepth(),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]),this.context.clear({color:h.showOverdrawInspector?a.Color.black:a.Color.transparent,depth:1}),this.clearStencil(),this._showOverdrawInspector=h.showOverdrawInspector,this.renderPass="opaque",!this.terrain)for(this.currentLayer=_.length-1;this.currentLayer>=0;this.currentLayer--){const G=this.style._layers[_[this.currentLayer]],$=o._getLayerSourceCache(G);if(G.isSky())continue;const J=$?N[$.id]:void 0;this._renderTileClippingMasks(G,$,J),this.renderLayer(this,$,G,J)}if(this.style.fog&&this.transform.projection.supportsFog&&(function(G,$){const J=G.context,oe=J.gl,ce=G.transform,fe=new a.DepthMode(oe.LEQUAL,a.DepthMode.ReadOnly,[0,1]),de=G.useProgram("globeAtmosphere",null,ce.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"]),me=a.globeToMercatorTransition(ce.zoom),Q=$.properties.get("color").toArray01(),le=$.properties.get("high-color").toArray01(),_e=$.properties.get("space-color").toArray01PremultipliedAlpha(),ve=a.identity$1([]);a.rotateY$1(ve,ve,-a.degToRad(ce._center.lng)),a.rotateX$1(ve,ve,a.degToRad(ce._center.lat)),a.rotateZ$1(ve,ve,ce.angle),a.rotateX$1(ve,ve,-ce._pitch);const Ne=a.fromQuat(new Float32Array(16),ve),Le=a.mapValue($.properties.get("star-intensity"),0,1,0,.25),De=5e-4,$e=a.mapValue($.properties.get("horizon-blend"),0,1,De,.25),Ue=a.globeUseCustomAntiAliasing(G,J,ce)&&$e===De?ce.worldSize/(2*Math.PI*1.025)-1:ce.globeRadius,Ye=G.frameCounter/1e3%1,kt=a.length(ce.globeCenterInViewSpace),qe=Math.sqrt(Math.pow(kt,2)-Math.pow(Ue,2)),at=Math.acos(qe/kt),Je=((Ke,lt,Tt,xt,At,Qt,yn,qt,un,jn,Fn,en,Gn,sr)=>({u_frustum_tl:Ke,u_frustum_tr:lt,u_frustum_br:Tt,u_frustum_bl:xt,u_horizon:At,u_transition:Qt,u_fadeout_range:yn,u_color:qt,u_high_color:un,u_space_color:jn,u_star_intensity:Fn,u_star_size:5*a.exported.devicePixelRatio,u_star_density:0,u_temporal_offset:en,u_horizon_angle:Gn,u_rotation_matrix:sr}))(ce.frustumCorners.TL,ce.frustumCorners.TR,ce.frustumCorners.BR,ce.frustumCorners.BL,ce.frustumCorners.horizon,me,$e,Q,le,_e,Le,Ye,at,Ne);G.prepareDrawProgram(J,de);const Et=G.atmosphereBuffer;Et&&de.draw(J,oe.TRIANGLES,fe,a.StencilMode.disabled,a.ColorMode.alphaBlended,a.CullFaceMode.backCW,Je,"skybox",Et.vertexBuffer,Et.indexBuffer,Et.segments)})(this,this.style.fog),this.renderPass="sky",(a.globeToMercatorTransition(this.transform.zoom)>0||this.transform.projection.name!=="globe")&&this.transform.isHorizonVisible())for(this.currentLayer=0;this.currentLayer<_.length;this.currentLayer++){const G=this.style._layers[_[this.currentLayer]],$=o._getLayerSourceCache(G);G.isSky()&&this.renderLayer(this,$,G,$?N[$.id]:void 0)}for(this.renderPass="translucent",this.currentLayer=0;this.currentLayer<_.length;){const G=this.style._layers[_[this.currentLayer]],$=o._getLayerSourceCache(G);if(G.isSky()){++this.currentLayer;continue}if(this.terrain&&this.style.isLayerDraped(G)){if(G.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer);continue}const J=$?(G.type==="symbol"?D:N)[$.id]:void 0;this._renderTileClippingMasks(G,$,$?C[$.id]:void 0),this.renderLayer(this,$,G,J),++this.currentLayer}if(this.terrain&&this.terrain.postRender(),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let G=null;a.values(this.style._layers).forEach(($=>{const J=o._getLayerSourceCache($);J&&!$.isHidden(this.transform.zoom)&&(!G||G.getSource().maxzoom<J.getSource().maxzoom)&&(G=J)})),G&&this.options.showTileBoundaries&&Da.debug(this,G,G.getVisibleCoordinates())}this.options.showPadding&&(function(G){const $=G.transform.padding;gl(G,G.transform.height-($.top||0),3,ml),gl(G,$.bottom||0,3,xp),lc(G,$.left||0,3,vp),lc(G,G.transform.width-($.right||0),3,Yh);const J=G.transform.centerPoint;(function(oe,ce,fe,de){Ho(oe,ce-1,fe-10,2,20,de),Ho(oe,ce-10,fe-1,20,2,de)})(G,J.x,G.transform.height-J.y,ig)})(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(a.window.performance.now()),this.saveCanvasCopy())}renderLayer(o,h,_,T){_.isHidden(this.transform.zoom)||(_.type==="background"||_.type==="sky"||_.type==="custom"||T&&T.length)&&(this.id=_.id,this.gpuTimingStart(_),(!o.transform.projection.unsupportedLayers||!o.transform.projection.unsupportedLayers.includes(_.type)||o.terrain&&_.type==="custom")&&Da[_.type](o,h,_,T,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const h=this.context.extTimerQuery;let _=this.gpuTimers[o.id];_||(_=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:h.createQueryEXT()}),_.calls++,h.beginQueryEXT(h.TIME_ELAPSED_EXT,_.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,h=o.createQueryEXT();this.deferredRenderGpuTimeQueries.push(h),o.beginQueryEXT(o.TIME_ELAPSED_EXT,h)}}gpuTimingDeferredRenderEnd(){if(!this.options.gpuTimingDeferredRender)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}gpuTimingEnd(){if(!this.options.gpuTiming)return;const o=this.context.extTimerQuery;o.endQueryEXT(o.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const h={};for(const _ in o){const T=o[_],C=this.context.extTimerQuery,N=C.getQueryObjectEXT(T.query,C.QUERY_RESULT_EXT)/1e6;C.deleteQueryEXT(T.query),h[_]=N}return h}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const h=this.context.extTimerQuery;let _=0;for(const T of o)_+=h.getQueryObjectEXT(T,h.QUERY_RESULT_EXT)/1e6,h.deleteQueryEXT(T);return _}translatePosMatrix(o,h,_,T,C){if(!_[0]&&!_[1])return o;const N=C?T==="map"?this.transform.angle:0:T==="viewport"?-this.transform.angle:0;if(N){const G=Math.sin(N),$=Math.cos(N);_=[_[0]*$-_[1]*G,_[0]*G+_[1]*$]}const D=[C?_[0]:Fe(h,_[0],this.transform.zoom),C?_[1]:Fe(h,_[1],this.transform.zoom),0],B=new Float32Array(16);return a.translate(B,o,D),B}saveTileTexture(o){const h=this._tileTextures[o.size[0]];h?h.push(o):this._tileTextures[o.size[0]]=[o]}getTileTexture(o){const h=this._tileTextures[o];return h&&h.length>0?h.pop():null}isPatternMissing(o){return o===null||o!==void 0&&!this.imageManager.getPattern(o.toString())}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture}currentGlobalDefines(){const o=this.terrain&&this.terrain.renderingToTexture,h=this.terrain&&this.terrain.exaggeration()===0,_=this.style&&this.style.fog,T=[];return this.terrainRenderModeElevated()&&T.push("TERRAIN"),this.transform.projection.name==="globe"&&T.push("GLOBE"),h&&T.push("ZERO_EXAGGERATION"),_&&!o&&_.getOpacity(this.transform.pitch)!==0&&T.push("FOG"),o&&T.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&T.push("OVERDRAW_INSPECTOR"),T}useProgram(o,h,_){this.cache=this.cache||{};const T=_||[],C=this.currentGlobalDefines().concat(T),N=Kn.cacheKey(iu[o],o,C,h);return this.cache[N]||(this.cache[N]=new Kn(this.context,o,iu[o],h,du[o],C)),this.cache[N]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=a.window.document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new a.Texture(this.context,this.debugOverlayCanvas,this.context.gl.RGBA))}destroy(){this._terrain&&this._terrain.destroy(),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this.atmosphereBuffer&&this.atmosphereBuffer.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}prepareDrawProgram(o,h,_){if(this.terrain&&this.terrain.renderingToTexture)return;const T=this.style.fog;if(T){const C=T.getOpacity(this.transform.pitch),N=((D,B,G,$,J,oe,ce,fe,de,me,Q)=>{const le=D.transform,_e=B.properties.get("color").toArray01();_e[3]=$;const ve=D.frameCounter/1e3%1;return{u_fog_matrix:G?le.calculateFogTileMatrix(G):D.identityMat,u_fog_range:B.getFovAdjustedRange(le._fov),u_fog_color:_e,u_fog_horizon_blend:B.properties.get("horizon-blend"),u_fog_temporal_offset:ve,u_frustum_tl:J,u_frustum_tr:oe,u_frustum_br:ce,u_frustum_bl:fe,u_globe_pos:de,u_globe_radius:me,u_viewport:Q,u_globe_transition:a.globeToMercatorTransition(le.zoom),u_is_globe:+(le.projection.name==="globe")}})(this,T,_,C,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*a.exported.devicePixelRatio,this.transform.height*a.exported.devicePixelRatio]);h.setFogUniformValues(o,N)}}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,h=o.createTexture();return o.bindTexture(o.TEXTURE_2D,h),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),h}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,h=this._backgroundTiles={},_=this.transform.coveringTiles({tileSize:512});for(const T of _)h[T.key]=o[T.key]||new a.Tile(T,512,this.transform.tileZoom,this);return h}clearBackgroundTiles(){this._backgroundTiles={}}}class mu{constructor(o=0,h=0,_=0,T=0){if(isNaN(o)||o<0||isNaN(h)||h<0||isNaN(_)||_<0||isNaN(T)||T<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=h,this.left=_,this.right=T}interpolate(o,h,_){return h.top!=null&&o.top!=null&&(this.top=a.number(o.top,h.top,_)),h.bottom!=null&&o.bottom!=null&&(this.bottom=a.number(o.bottom,h.bottom,_)),h.left!=null&&o.left!=null&&(this.left=a.number(o.left,h.left,_)),h.right!=null&&o.right!=null&&(this.right=a.number(o.right,h.right,_)),this}getCenter(o,h){const _=a.clamp((this.left+o-this.right)/2,0,o),T=a.clamp((this.top+h-this.bottom)/2,0,h);return new a.Point(_,T)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new mu(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}function gu(g,o){const h=a.getColumn(g,3);a.fromQuat(g,o),a.setColumn(g,3,h)}function Jn(g,o){const h=a.identity$1([]);return a.rotateZ$1(h,h,-o),a.rotateX$1(h,h,-g),h}function uc(g,o){const h=[g[0],g[1],0],_=[o[0],o[1],0];if(a.length(h)>=1e-15){const N=a.normalize([],h);a.scale$2(_,N,a.dot(_,N)),o[0]=_[0],o[1]=_[1]}const T=a.cross([],o,g);if(a.len(T)<1e-15)return null;const C=Math.atan2(-T[1],T[0]);return Jn(Math.atan2(Math.sqrt(g[0]*g[0]+g[1]*g[1]),-g[2]),C)}class la{constructor(o,h){this.position=o,this.orientation=h}get position(){return this._position}set position(o){if(o){const h=o instanceof a.MercatorCoordinate?o:new a.MercatorCoordinate(o[0],o[1],o[2]);this._renderWorldCopies&&(h.x=a.wrap(h.x,0,1)),this._position=h}else this._position=null}lookAtPoint(o,h){if(this.orientation=null,!this.position)return;const _=this.position,T=this._elevation?this._elevation.getAtPointOrZero(a.MercatorCoordinate.fromLngLat(o)):0,C=a.MercatorCoordinate.fromLngLat(o,T),N=[C.x-_.x,C.y-_.y,C.z-_.z];h||(h=[0,0,1]),h[2]=Math.abs(h[2]),this.orientation=uc(N,h)}setPitchBearing(o,h){this.orientation=Jn(a.degToRad(o),a.degToRad(-h))}}class dc{constructor(o,h){this._transform=a.identity([]),this.orientation=h,this.position=o}get mercatorPosition(){const o=this.position;return new a.MercatorCoordinate(o[0],o[1],o[2])}get position(){const o=a.getColumn(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var h;o&&a.setColumn(this._transform,3,[(h=o)[0],h[1],h[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||a.identity$1([]),o&&gu(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),h=this.right();return{bearing:Math.atan2(-h[1],h[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,h){this._orientation=Jn(o,h),gu(this._transform,this._orientation)}forward(){const o=a.getColumn(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=a.getColumn(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=a.getColumn(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,h){const _=new Float64Array(16);return a.invert(_,this.getWorldToCamera(o,h)),_}getWorldToCameraPosition(o,h,_){const T=this.position;a.scale$2(T,T,-o);const C=new Float64Array(16);return a.fromScaling(C,[_,_,_]),a.translate(C,C,T),C[10]*=h,C}getWorldToCamera(o,h){const _=new Float64Array(16),T=new Float64Array(4),C=this.position;return a.conjugate(T,this._orientation),a.scale$2(C,C,-o),a.fromQuat(_,T),a.translate(_,_,C),_[1]*=-1,_[5]*=-1,_[9]*=-1,_[13]*=-1,_[8]*=h,_[9]*=h,_[10]*=h,_[11]*=h,_}getCameraToClipPerspective(o,h,_,T){const C=new Float64Array(16);return a.perspective(C,o,h,_,T),C}getDistanceToElevation(o,h=!1){const _=o===0?0:a.mercatorZfromAltitude(o,h?a.latFromMercatorY(this.position[1]):this.position[1]),T=this.forward();return(_-this.position[2])/T[2]}clone(){return new dc([...this.position],[...this.orientation])}}function La(g,o){const h=yd(g.projection,g.zoom,g.width,g.height),_=(function(C,N,D,B,G){const $=new a.LngLat(D.lng-180*zs,D.lat),J=new a.LngLat(D.lng+180*zs,D.lat),oe=C.project($.lng,$.lat),ce=C.project(J.lng,J.lat),fe=-Math.atan2(ce.y-oe.y,ce.x-oe.x),de=a.MercatorCoordinate.fromLngLat(D);de.y=a.clamp(de.y,-1+zs,1-zs);const me=de.toLngLat(),Q=C.project(me.lng,me.lat),le=a.MercatorCoordinate.fromLngLat(me);le.x+=zs;const _e=le.toLngLat(),ve=C.project(_e.lng,_e.lat),Ne=yu(ve.x-Q.x,ve.y-Q.y,fe),Le=a.MercatorCoordinate.fromLngLat(me);Le.y+=zs;const De=Le.toLngLat(),$e=C.project(De.lng,De.lat),Ue=yu($e.x-Q.x,$e.y-Q.y,fe),Ye=Math.abs(Ne.x)/Math.abs(Ue.y),kt=a.identity([]);a.rotateZ(kt,kt,-fe*(1-(G?0:B)));const qe=a.identity([]);return a.scale(qe,qe,[1,1-(1-Ye)*B,1]),qe[4]=-Ue.x/Ue.y*B,a.rotateZ(qe,qe,fe),a.multiply(qe,kt,qe),qe})(g.projection,0,g.center,h,o),T=wp(g);return a.scale(_,_,[T,T,1]),_}function wp(g){const o=g.projection,h=yd(g.projection,g.zoom,g.width,g.height),_=bp(o,g.center),T=bp(o,a.LngLat.convert(o.center));return Math.pow(2,_*h+(1-h)*T)}function yd(g,o,h,_,T=1/0){const C=g.range;if(!C)return 0;const N=Math.min(T,Math.max(h,_)),D=Math.log(N/1024)/Math.LN2;return a.smoothstep(C[0]+D,C[1]+D,o)}const zs=1/4e4;function bp(g,o){const h=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),_=new a.LngLat(o.lng-180*zs,h),T=new a.LngLat(o.lng+180*zs,h),C=g.project(_.lng,h),N=g.project(T.lng,h),D=a.MercatorCoordinate.fromLngLat(_),B=a.MercatorCoordinate.fromLngLat(T),G=N.x-C.x,$=N.y-C.y,J=B.x-D.x,oe=B.y-D.y,ce=Math.sqrt((J*J+oe*oe)/(G*G+$*$));return Math.log(ce)/Math.LN2}function yu(g,o,h){const _=Math.cos(h),T=Math.sin(h);return{x:g*_-o*T,y:g*T+o*_}}class _l{constructor(o,h,_,T,C,N,D){this.tileSize=512,this._renderWorldCopies=C===void 0||C,this._minZoom=o||0,this._maxZoom=h||22,this._minPitch=_??0,this._maxPitch=T??60,this.setProjection(N),this.setMaxBounds(D),this.width=0,this.height=0,this._center=new a.LngLat(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new mu,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._distanceTileDataCache={},this._camera=new dc,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._horizonShift=.1}clone(){const o=new _l(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection());return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}updateElevation(o,h=!1){const _=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||_)&&this._updateCameraOnTerrain(),(o||_)&&this._constrainCamera(h),this._calcMatrices()}getProjection(){return a.pick(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const h=this.projection?this.getProjection():void 0;this.projection=a.getProjection(this.projectionOptions);const _=!k(h,this.getProjection());return _&&this._calcMatrices(),this.mercatorFromTransition=!1,_}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=a.getProjection({name:"mercator"});const h=o!==this.projection.name;return h&&this._calcMatrices(),h}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return a.mercatorZfromAltitude(this.center.lat,this.cameraWorldSizeForFog)}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new a.Point(this.width,this.height)}get bearing(){return a.wrap(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const h=-o*Math.PI/180;var _;this.angle!==h&&(this._unmodified=!1,this.angle=h,this._calcMatrices(),this.rotationMatrix=(_=new a.ARRAY_TYPE(4),a.ARRAY_TYPE!=Float32Array&&(_[1]=0,_[2]=0),_[0]=1,_[3]=1,_),(function(T,C,N){var D=C[0],B=C[1],G=C[2],$=C[3],J=Math.sin(N),oe=Math.cos(N);T[0]=D*oe+G*J,T[1]=B*oe+$*J,T[2]=D*-J+G*oe,T[3]=B*-J+$*oe})(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const h=a.clamp(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==h&&(this._unmodified=!1,this._pitch=h,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=a.degToRad(o),this._calcMatrices())}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const h=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==h&&(this._unmodified=!1,this._setZoom(h),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}_updateCameraOnTerrain(){if(!this._elevation||!this._elevation.isDataAvailableAtPoint(this.locationCoordinate(this.center)))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const o=this._elevation;this._centerAltitude=o.getAtPointOrZero(this.locationCoordinate(this.center)),this._centerAltitudeValidForExaggeration=o.exaggeration(),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){this._centerAltitudeValidForExaggeration!==void 0&&(this._seaLevelZoom=this._zoomFromMercatorZ((this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize))}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,h=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],_=this.horizonLineFromTop();let T=0,C=0;for(let N=0;N<h.length;N++){const D=new a.Point(h[N][0]*this.width,_+h[N][1]*(this.height-_)),B=o.pointCoordinate(D);if(!B)continue;const G=1/Math.hypot(B[0]-this._camera.position[0],B[1]-this._camera.position[1]);T+=B[3]*G,C+=G}return C===0?NaN:T/C}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,h=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),_=this.pixelsPerMeter/this.worldSize*h,T=this._mercatorZfromZoom(o),C=this._mercatorZfromZoom(this._maxZoom),N=Math.max(T-_,C);this._setZoom(this._zoomFromMercatorZ(N))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const h=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let _;_=o.z<this._camera.position[2]?[h.x,h.y,h.z]:[o.x,o.y,o.z];const T=a.length(a.sub([],this._camera.position,_));return a.clamp(this._zoomFromMercatorZ(T),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let h=!1;if(o.orientation&&!a.exactEquals(o.orientation,this._camera.orientation)&&(h=this._setCameraOrientation(o.orientation)),o.position){const _=[o.position.x,o.position.y,o.position.z];a.exactEquals$1(_,this._camera.position)||(this._setCameraPosition(_),h=!0)}h&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,h=new la;return h.position=new a.MercatorCoordinate(o[0],o[1],o[2]),h.orientation=this._camera.orientation,h._elevation=this.elevation,h._renderWorldCopies=this.renderWorldCopies,h}_setCameraOrientation(o){if(!a.length$1(o))return!1;a.normalize$1(o,o);const h=a.transformQuat([],[0,0,-1],o),_=a.transformQuat([],[0,-1,0],o);if(_[2]<0)return!1;const T=uc(h,_);return!!T&&(this._camera.orientation=T,!0)}_setCameraPosition(o){const h=this.zoomScale(this.minZoom)*this.tileSize,_=this.zoomScale(this.maxZoom)*this.tileSize,T=this.cameraToCenterDistance;o[2]=a.clamp(o[2],T/_,T/h),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,h,_){this._unmodified=!1,this._edgeInsets.interpolate(o,h,_),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const h=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,h)}getVisibleUnwrappedCoordinates(o){const h=[new a.UnwrappedTileID(0,o)];if(this.renderWorldCopies){const _=this.pointCoordinate(new a.Point(0,0)),T=this.pointCoordinate(new a.Point(this.width,0)),C=this.pointCoordinate(new a.Point(this.width,this.height)),N=this.pointCoordinate(new a.Point(0,this.height)),D=Math.floor(Math.min(_.x,T.x,C.x,N.x)),B=Math.floor(Math.max(_.x,T.x,C.x,N.x)),G=1;for(let $=D-G;$<=B+G;$++)$!==0&&h.push(new a.UnwrappedTileID($,o))}return h}coveringTiles(o){let h=this.coveringZoomLevel(o);const _=h,T=this.elevation&&!o.isTerrainDEM,C=this.projection.name==="mercator";if(o.minzoom!==void 0&&h<o.minzoom)return[];o.maxzoom!==void 0&&h>o.maxzoom&&(h=o.maxzoom);const N=this.locationCoordinate(this.center),D=this.center.lat,B=1<<h,G=[B*N.x,B*N.y,0],$=this.projection.name==="globe",J=!$,oe=a.Frustum.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,h,J),ce=$?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),fe=B*a.mercatorZfromAltitude(1,this.center.lat),de=this._camera.position[2]/a.mercatorZfromAltitude(1,this.center.lat),me=[B*ce.x,B*ce.y,de*(J?1:fe)],Q=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),le=this.pitch<=60&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace?h:0,_e=o.isTerrainDEM&&this._elevation?1e4*this._elevation.exaggeration():this._centerAltitude,ve=o.isTerrainDEM?-_e:this._elevation?this._elevation.getMinElevationBelowMSL():0,Ne=this.projection.isReprojectedInTileSpace?wp(this):1,Le=Ke=>{const Tt=new a.MercatorCoordinate(Ke.x+25e-6,Ke.y,Ke.z),xt=new a.MercatorCoordinate(Ke.x,Ke.y+25e-6,Ke.z),At=Ke.toLngLat(),Qt=Tt.toLngLat(),yn=xt.toLngLat(),qt=this.locationCoordinate(At),un=this.locationCoordinate(Qt),jn=this.locationCoordinate(yn),Fn=Math.hypot(un.x-qt.x,un.y-qt.y),en=Math.hypot(jn.x-qt.x,jn.y-qt.y);return Math.sqrt(Fn*en)*Ne/25e-6},De=Ke=>{const lt=_e,Tt=ve;return{aabb:a.tileAABB(this,B,0,0,0,Ke,Tt,lt,this.projection),zoom:0,x:0,y:0,minZ:Tt,maxZ:lt,wrap:Ke,fullyVisible:!1}},$e=[];let Ue=[];const Ye=h,kt=o.reparseOverscaled?_:h,qe=Ke=>Ke*Ke,at=qe((de-this._centerAltitude)*fe),Je=Ke=>{if(!this._elevation||!Ke.tileID||!C)return;const lt=this._elevation.getMinMaxForTile(Ke.tileID),Tt=Ke.aabb;lt?(Tt.min[2]=lt.min,Tt.max[2]=lt.max,Tt.center[2]=(Tt.min[2]+Tt.max[2])/2):(Ke.shouldSplit=Et(Ke),Ke.shouldSplit||(Tt.min[2]=Tt.max[2]=Tt.center[2]=this._centerAltitude))},Et=Ke=>{if(Ke.zoom<le)return!0;if(Ke.zoom===Ye)return!1;if(Ke.shouldSplit!=null)return Ke.shouldSplit;const lt=Ke.aabb.distanceX(me),Tt=Ke.aabb.distanceY(me);let xt=at,At=1;if($){xt=qe(Ke.aabb.distanceZ(me));const qt=Math.pow(2,Ke.zoom),un=a.latFromMercatorY((Ke.y+1)/qt),jn=a.latFromMercatorY(Ke.y/qt),Fn=Math.min(Math.max(D,un),jn),en=a.circumferenceAtLatitude(Fn)/a.circumferenceAtLatitude(D);if(At=Fn===D?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,en/this._mercatorScaleRatio),this.zoom<=a.GLOBE_ZOOM_THRESHOLD_MIN&&Ke.zoom===Ye-1&&en>=.9)return!0}else if(T&&(xt=qe(Ke.aabb.distanceZ(me)*fe)),this.projection.isReprojectedInTileSpace&&_<=5){const qt=Math.pow(2,Ke.zoom),un=Le(new a.MercatorCoordinate((Ke.x+.5)/qt,(Ke.y+.5)/qt));At=un>.85?1:un}const Qt=lt*lt+Tt*Tt+xt,yn=qe((1<<Ye-Ke.zoom)*Q*At*((qt,un)=>{if(un*qe(.707)<qt)return 1;const jn=Math.sqrt(un/qt);return jn/(1.4144271570014144+(Math.pow(1.1,jn-1.4144271570014144+1)-1)/(1.1-1)-1)})(Math.max(xt,at),Qt));return Qt<yn};if(this.renderWorldCopies)for(let Ke=1;Ke<=3;Ke++)$e.push(De(-Ke)),$e.push(De(Ke));for($e.push(De(0));$e.length>0;){const Ke=$e.pop(),lt=Ke.x,Tt=Ke.y;let xt=Ke.fullyVisible;if(!xt){const At=Ke.aabb.intersects(oe);if(At===0)continue;xt=At===2}if(Ke.zoom!==Ye&&Et(Ke))for(let At=0;At<4;At++){const Qt=(lt<<1)+At%2,yn=(Tt<<1)+(At>>1),qt={aabb:C?Ke.aabb.quadrant(At):a.tileAABB(this,B,Ke.zoom+1,Qt,yn,Ke.wrap,Ke.minZ,Ke.maxZ,this.projection),zoom:Ke.zoom+1,x:Qt,y:yn,wrap:Ke.wrap,fullyVisible:xt,tileID:void 0,shouldSplit:void 0,minZ:Ke.minZ,maxZ:Ke.maxZ};T&&!$&&(qt.tileID=new a.OverscaledTileID(Ke.zoom+1===Ye?kt:Ke.zoom+1,Ke.wrap,Ke.zoom+1,Qt,yn),Je(qt)),$e.push(qt)}else{const At=Ke.zoom===Ye?kt:Ke.zoom;if(o.minzoom&&o.minzoom>At)continue;const Qt=G[0]-(.5+lt+(Ke.wrap<<Ke.zoom))*(1<<h-Ke.zoom),yn=G[1]-.5-Tt,qt=Ke.tileID?Ke.tileID:new a.OverscaledTileID(At,Ke.wrap,Ke.zoom,lt,Tt);Ue.push({tileID:qt,distanceSq:Qt*Qt+yn*yn})}}if(this.fogCullDistSq){const Ke=this.fogCullDistSq,lt=this.horizonLineFromTop();Ue=Ue.filter((Tt=>{const xt=[0,0,0,1],At=[a.EXTENT,a.EXTENT,0,1],Qt=this.calculateFogTileMatrix(Tt.tileID.toUnwrapped());a.transformMat4$1(xt,xt,Qt),a.transformMat4$1(At,At,Qt);const yn=a.getAABBPointSquareDist(xt,At);if(yn===0)return!0;let qt=!1;const un=this._elevation;if(un&&yn>Ke&&lt!==0){const jn=this.calculateProjMatrix(Tt.tileID.toUnwrapped());let Fn;o.isTerrainDEM||(Fn=un.getMinMaxForTile(Tt.tileID)),Fn||(Fn={min:ve,max:_e});const en=a.furthestTileCorner(this.rotation),Gn=[en[0]*a.EXTENT,en[1]*a.EXTENT,Fn.max];a.transformMat4(Gn,Gn,jn),qt=(1-Gn[1])*this.height*.5<lt}return yn<Ke||qt}))}return Ue.sort(((Ke,lt)=>Ke.distanceSq-lt.distanceSq)).map((Ke=>Ke.tileID))}resize(o,h){this.width=o,this.height=h,this.pixelsToGLUnits=[2/o,-2/h],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const h=a.clamp(o.lat,-a.MAX_MERCATOR_LATITUDE,a.MAX_MERCATOR_LATITUDE),_=this.projection.project(o.lng,h);return new a.Point(_.x*this.worldSize,_.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/a.mercatorZfromAltitude(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,h){let _,T;const C=this.centerPoint;if(this.projection.name==="globe"){const D=this.worldSize;_=(h.x-C.x)/D,T=(h.y-C.y)/D}else{const D=this.pointCoordinate(h),B=this.pointCoordinate(C);_=D.x-B.x,T=D.y-B.y}const N=this.locationCoordinate(o);this.setLocation(new a.MercatorCoordinate(N.x-_,N.y-T))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o){return this.projection.locationPoint(this,o)}locationPoint3D(o){return this.projection.locationPoint(this,o,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o){return this.coordinateLocation(this.pointCoordinate3D(o))}locationCoordinate(o,h){const _=h?a.mercatorZfromAltitude(h,o.lat):void 0,T=this.projection.project(o.lng,o.lat);return new a.MercatorCoordinate(T.x,T.y,_)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,h){const _=h??this._centerAltitude,T=[o.x,o.y,0,1],C=[o.x,o.y,1,1];a.transformMat4$1(T,T,this.pixelMatrixInverse),a.transformMat4$1(C,C,this.pixelMatrixInverse);const N=C[3];a.scale$1(T,T,1/T[3]),a.scale$1(C,C,1/N);const D=T[2],B=C[2];return{p0:T,p1:C,t:D===B?0:(_-D)/(B-D)}}screenPointToMercatorRay(o){const h=[o.x,o.y,0,1],_=[o.x,o.y,1,1];return a.transformMat4$1(h,h,this.pixelMatrixInverse),a.transformMat4$1(_,_,this.pixelMatrixInverse),a.scale$1(h,h,1/h[3]),a.scale$1(_,_,1/_[3]),h[2]=a.mercatorZfromAltitude(h[2],this._center.lat)*this.worldSize,_[2]=a.mercatorZfromAltitude(_[2],this._center.lat)*this.worldSize,a.scale$1(h,h,1/this.worldSize),a.scale$1(_,_,1/this.worldSize),new a.Ray([h[0],h[1],h[2]],a.normalize([],a.sub([],_,h)))}rayIntersectionCoordinate(o){const{p0:h,p1:_,t:T}=o,C=a.mercatorZfromAltitude(h[2],this._center.lat),N=a.mercatorZfromAltitude(_[2],this._center.lat);return new a.MercatorCoordinate(a.number(h[0],_[0],T)/this.worldSize,a.number(h[1],_[1],T)/this.worldSize,a.number(C,N,T))}pointCoordinate(o,h=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,h)}pointCoordinate3D(o){if(!this.elevation)return this.pointCoordinate(o);let h=this.projection.pointCoordinate3D(this,o.x,o.y);if(h)return new a.MercatorCoordinate(h[0],h[1],h[2]);let _=0,T=this.horizonLineFromTop();if(o.y>T)return this.pointCoordinate(o);const C=.02*T,N=o.clone();for(let D=0;D<10&&T-_>C;D++){N.y=a.number(_,T,.66);const B=this.projection.pointCoordinate3D(this,N.x,N.y);B?(T=N.y,h=B):_=N.y}return h?new a.MercatorCoordinate(h[0],h[1],h[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX)return!this.isPointAboveHorizon(o);const h=this.pointCoordinate(o);return h.y>=0&&h.y<=1}_coordinatePoint(o,h){const _=h&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,T=[o.x*this.worldSize,o.y*this.worldSize,_+o.toAltitude(),1];return a.transformMat4$1(T,T,this.pixelMatrix),T[3]>0?new a.Point(T[0]/T[3],T[1]/T[3]):new a.Point(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:h}=this._edgeInsets,_=this.height-this._edgeInsets.bottom,T=this.width-this._edgeInsets.right,C=this.pointLocation3D(new a.Point(h,o)),N=this.pointLocation3D(new a.Point(T,o)),D=this.pointLocation3D(new a.Point(T,_)),B=this.pointLocation3D(new a.Point(h,_));let G=Math.min(C.lng,N.lng,D.lng,B.lng),$=Math.max(C.lng,N.lng,D.lng,B.lng),J=Math.min(C.lat,N.lat,D.lat,B.lat),oe=Math.max(C.lat,N.lat,D.lat,B.lat);const ce=Math.pow(2,-this.zoom)/16*270,fe=this.projection.name==="globe"?1:4,de=(me,Q,le,_e,ve)=>{const Ne=(me+le)/2,Le=(Q+_e)/2,De=new a.Point(Ne,Le),{lng:$e,lat:Ue}=this.pointLocation3D(De),Ye=Math.max(0,G-$e,J-Ue,$e-$,Ue-oe);G=Math.min(G,$e),$=Math.max($,$e),J=Math.min(J,Ue),oe=Math.max(oe,Ue),(ve<fe||Ye>ce)&&(de(me,Q,Ne,Le,ve+1),de(Ne,Le,le,_e,ve+1))};if(de(h,o,T,o,1),de(T,o,T,_,1),de(T,_,h,_,1),de(h,_,h,o,1),this.projection.name==="globe"){const[me,Q]=a.polesInViewport(this);me?(oe=90,$=180,G=-180):Q&&(J=-90,$=180,G=-180)}return new a.LngLatBounds(new a.LngLat(G,J),new a.LngLat($,oe))}_getBoundsRectangular(o,h){const{top:_,left:T}=this._edgeInsets,C=this.height-this._edgeInsets.bottom,N=this.width-this._edgeInsets.right,D=new a.Point(T,_),B=new a.Point(N,_),G=new a.Point(N,C),$=new a.Point(T,C);let J=this.pointCoordinate(D,o),oe=this.pointCoordinate(B,o);const ce=this.pointCoordinate(G,h),fe=this.pointCoordinate($,h),de=(me,Q)=>(Q.y-me.y)/(Q.x-me.x);return J.y>1&&oe.y>=0?J=new a.MercatorCoordinate((1-fe.y)/de(fe,J)+fe.x,1):J.y<0&&oe.y<=1&&(J=new a.MercatorCoordinate(-fe.y/de(fe,J)+fe.x,0)),oe.y>1&&J.y>=0?oe=new a.MercatorCoordinate((1-ce.y)/de(ce,oe)+ce.x,1):oe.y<0&&J.y<=1&&(oe=new a.MercatorCoordinate(-ce.y/de(ce,oe)+ce.x,0)),new a.LngLatBounds().extend(this.coordinateLocation(J)).extend(this.coordinateLocation(oe)).extend(this.coordinateLocation(fe)).extend(this.coordinateLocation(ce))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const h=o.visibleDemTiles.reduce(((_,T)=>{if(T.dem){const C=T.dem.tree;_.min=Math.min(_.min,C.minimums[0]),_.max=Math.max(_.max,C.maximums[0])}return _}),{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(h.min*o.exaggeration(),h.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const h=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))+this.centerOffset.y,_=this.height/2-h*(1-this._horizonShift);return o?Math.max(0,_):_}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-a.MAX_MERCATOR_LATITUDE,this.maxLat=a.MAX_MERCATOR_LATITUDE,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=a.mercatorXfromLng(this.minLng)*this.tileSize,this.worldMaxX=a.mercatorXfromLng(this.maxLng)*this.tileSize,this.worldMinY=a.mercatorYfromLat(this.maxLat)*this.tileSize,this.worldMaxY=a.mercatorYfromLat(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,h){return this.projection.createTileMatrix(this,h,o)}calculateDistanceTileData(o){const h=o.key,_=this._distanceTileDataCache;if(_[h])return _[h];const T=o.canonical,C=1/this.height,N=this.cameraWorldSize,D=N/this.zoomScale(T.z),B=(T.x+Math.pow(2,T.z)*o.wrap)*D,G=T.y*D,$=this.point;$.x*=N/this.worldSize,$.y*=N/this.worldSize;const J=this.angle,oe=Math.sin(-J),ce=-Math.cos(-J);return _[h]={bearing:[oe,ce],center:[($.x-B)*C,($.y-G)*C],scale:D/a.EXTENT*C},_[h]}calculateFogTileMatrix(o){const h=o.key,_=this._fogTileMatrixCache;if(_[h])return _[h];const T=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return a.multiply(T,this.worldToFogMatrix,T),_[h]=new Float32Array(T),_[h]}calculateProjMatrix(o,h=!1){const _=o.key,T=h?this._alignedProjMatrixCache:this._projMatrixCache;if(T[_])return T[_];const C=this.calculatePosMatrix(o,this.worldSize);return a.multiply(C,this.projection.isReprojectedInTileSpace?this.mercatorMatrix:h?this.alignedProjMatrix:this.projMatrix,C),T[_]=new Float32Array(C),T[_]}calculatePixelsToTileUnitsMatrix(o){const h=o.tileID.key,_=this._pixelsToTileUnitsCache;if(_[h])return _[h];const T=(function(C,N){const{scale:D}=C.tileTransform,B=D*a.EXTENT/(C.tileSize*Math.pow(2,N.zoom-C.tileID.overscaledZ+C.tileID.canonical.z));return G=new Float32Array(4),oe=($=N.inverseAdjustmentMatrix)[1],ce=$[2],fe=$[3],me=(J=[B,B])[1],G[0]=$[0]*(de=J[0]),G[1]=oe*de,G[2]=ce*me,G[3]=fe*me,G;var G,$,J,oe,ce,fe,de,me})(o,this);return _[h]=T,_[h]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,h=a.fromScaling([],[o,o,o]);return a.multiply(h,h,this.globeMatrix),h}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const h=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,_=this._computeCameraPosition(h),T=this._camera.forward(),C=a.mercatorZfromAltitude(1,this._center.lat);_[2]/=C,T[2]/=C,a.normalize(T,T);const N=o.raycast(_,T,o.exaggeration());if(N){const D=a.scaleAndAdd([],_,T,N),B=new a.MercatorCoordinate(D[0],D[1],a.mercatorZfromAltitude(D[2],a.latFromMercatorY(D[1]))),G=(B.z+a.length([B.x-_[0],B.y-_[1],B.z-_[2]*C]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(G),this._centerAltitude=B.toAltitude(),this._center=this.coordinateLocation(B),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const h=this._elevation,_=a.mercatorZfromAltitude(1,this._center.lat)*this.worldSize,T=this._computeCameraPosition(_),C=h.getAtPointOrZero(new a.MercatorCoordinate(...T)),N=this.pixelsPerMeter/this.worldSize*C,D=this._minimumHeightOverTerrain(),B=T[2]-N;if(B<=D)if(B<0||o){const G=this.locationCoordinate(this._center,this._centerAltitude),$=[T[0],T[1],G.z-T[2]],J=a.length($);$[2]-=(D-B)/this._pixelsPerMercatorPixel;const oe=a.length($);if(oe===0)return;a.scale$2($,$,J/oe*this._pixelsPerMercatorPixel),this._camera.position=[T[0],T[1],G.z*this._pixelsPerMercatorPixel-$[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const oe=this.center;return oe.lat=a.clamp(oe.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(oe.lng=a.clamp(oe.lng,this.minLng,this.maxLng)),this.center=oe,void(this._constraining=!1)}const h=this._unmodified,{x:_,y:T}=this.point;let C=0,N=_,D=T;const B=this.width/2,G=this.height/2,$=this.worldMinY*this.scale,J=this.worldMaxY*this.scale;if(T-G<$&&(D=$+G),T+G>J&&(D=J-G),J-$<this.height&&(C=Math.max(C,this.height/(J-$)),D=(J+$)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const oe=this.worldMinX*this.scale,ce=this.worldMaxX*this.scale,fe=this.worldSize/2-(oe+ce)/2;N=(_+fe+this.worldSize)%this.worldSize-fe,N-B<oe&&(N=oe+B),N+B>ce&&(N=ce-B),ce-oe<this.width&&(C=Math.max(C,this.width/(ce-oe)),N=(ce+oe)/2)}N===_&&D===T||(this.center=this.unproject(new a.Point(N,D))),C&&(this.zoom+=this.scaleZoom(C)),this._constrainCamera(),this._unmodified=h,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(this.height/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,h=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=a.mercatorZfromAltitude(1,this.center.lat)/a.mercatorZfromAltitude(1,a.GLOBE_SCALE_MATCH_LATITUDE));const _=yd(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,_),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const T=this.projection.zAxisUnit==="meters"?h:1,C=this._camera.getWorldToCamera(this.worldSize,T),N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);N[8]=2*-o.x/this.width,N[9]=2*o.y/this.height;let D=a.mul([],N,C);if(this.projection.isReprojectedInTileSpace){const Le=this.locationCoordinate(this.center),De=a.identity([]);a.translate(De,De,[Le.x*this.worldSize,Le.y*this.worldSize,0]),a.multiply(De,De,La(this)),a.translate(De,De,[-Le.x*this.worldSize,-Le.y*this.worldSize,0]),a.multiply(D,D,De),this.inverseAdjustmentMatrix=(function($e){const Ue=La($e,!0);return Pe([],[Ue[0],Ue[1],Ue[4],Ue[5]])})(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];this.mercatorMatrix=a.scale([],D,[this.worldSize,this.worldSize,this.worldSize/T,1]),this.projMatrix=D,this.invProjMatrix=a.invert(new Float64Array(16),this.projMatrix);const B=a.invert([],N);this.frustumCorners=a.FrustumCorners.fromInvProjectionMatrix(B,this.horizonLineFromTop(),this.height);const G=new Float32Array(16);a.identity(G),a.scale(G,G,[1,-1,1]),a.rotateX(G,G,this._pitch),a.rotateZ(G,G,this.angle);const $=a.perspective(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ),J=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;$[8]=2*-o.x/this.width,$[9]=2*(o.y+J)/this.height,this.skyboxMatrix=a.multiply(G,$,G);const oe=this.point,ce=oe.x,fe=oe.y,de=this.width%2/2,me=this.height%2/2,Q=Math.cos(this.angle),le=Math.sin(this.angle),_e=ce-Math.round(ce)+Q*de+le*me,ve=fe-Math.round(fe)+Q*me+le*de,Ne=new Float64Array(D);if(a.translate(Ne,Ne,[_e>.5?_e-1:_e,ve>.5?ve-1:ve,0]),this.alignedProjMatrix=Ne,D=a.create(),a.scale(D,D,[this.width/2,-this.height/2,1]),a.translate(D,D,[1,-1,0]),this.labelPlaneMatrix=D,D=a.create(),a.scale(D,D,[1,-1,1]),a.translate(D,D,[-1,-1,0]),a.scale(D,D,[2/this.width,2/this.height,1]),this.glCoordMatrix=D,this.pixelMatrix=a.multiply(new Float64Array(16),this.labelPlaneMatrix,this.projMatrix),this._calcFogMatrices(),this._distanceTileDataCache={},D=a.invert(new Float64Array(16),this.pixelMatrix),!D)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=D,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=a.calculateGlobeMatrix(this);const Le=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=a.transformMat4(Le,Le,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=D;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,h=this.cameraPixelsPerMeter,_=this._camera.position,T=1/this.height/this._pixelsPerMercatorPixel,C=[o,o,h];a.scale$2(C,C,T),a.scale$2(_,_,-1),a.multiply$2(_,_,C);const N=a.create();a.translate(N,N,_),a.scale(N,N,C),this.mercatorFogMatrix=N,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,h,T)}_computeCameraPosition(o){const h=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,_=this._camera.forward(),T=this.point,C=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*h-o/this.worldSize*this._centerAltitude;return[T.x/this.worldSize-_[0]*C,T.y/this.worldSize-_[1]*C,o/this.worldSize*this._centerAltitude-_[2]*C]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const h=this._maxCameraBoundsDistance()*Math.cos(this._pitch),_=this._camera.position[2],T=o[2];let C=1;this.projection.wrap&&(this.center=this.center.wrap()),T>0&&(C=Math.min((h-_)/T,1)),this._camera.position=a.scaleAndAdd([],this._camera.position,o,C),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,h=this._camera.forward(),{pitch:_,bearing:T}=this._camera.getPitchBearing(),C=a.mercatorZfromAltitude(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,N=this._mercatorZfromZoom(this._maxZoom)*Math.cos(a.degToRad(this._maxPitch)),D=Math.max((o[2]-C)/Math.cos(_),N),B=this._zoomFromMercatorZ(D);a.scaleAndAdd(o,o,h,D),this._pitch=a.clamp(_,a.degToRad(this.minPitch),a.degToRad(this.maxPitch)),this.angle=a.wrap(T,-Math.PI,Math.PI),this._setZoom(a.clamp(B,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new a.MercatorCoordinate(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min((this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom)+4,this._maxZoom);return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(o*this.tileSize))}zoomFromMercatorZAdjusted(o){let h=0,_=a.GLOBE_ZOOM_THRESHOLD_MAX,T=0,C=1/0;for(;_-h>1e-6&&_>h;){const N=h+.5*(_-h),D=this.tileSize*Math.pow(2,N),B=this.getCameraToCenterDistance(this.projection,N,D),G=this.scaleZoom(B/(o*this.tileSize)),$=Math.abs(N-G);$<C&&(C=$,T=N),N<G?h=N:_=N}return T}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(a.warnOnce("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,h){const _=Math.min(o.x,h.x),T=Math.max(o.x,h.x),C=Math.min(o.y,h.y),N=Math.max(o.y,h.y);if(C<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const D=[new a.Point(_,C),new a.Point(T,N),new a.Point(_,N),new a.Point(T,C)],B=this.renderWorldCopies?-3:0,G=this.renderWorldCopies?4:1;for(const $ of D){const J=this.pointRayIntersection($);if(J.t<0)return!0;const oe=this.rayIntersectionCoordinate(J);if(oe.x<B||oe.y<0||oe.x>G||oe.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+a.radToDeg(this.fovAboveCenter)>88||this.anyCornerOffEdge(new a.Point(0,0),new a.Point(this.width,this.height))}zoomDeltaToMovement(o,h){const _=a.length(a.sub([],this._camera.position,o)),T=this._zoomFromMercatorZ(_)+h;return _-this._mercatorZfromZoom(T)}getCameraPoint(){if(this.projection.name==="globe"){const o=(function([h,_,T],C){const N=[h,_,T,1];a.transformMat4$1(N,N,C);const D=N[3]=Math.max(N[3],1e-6);return N[0]/=D,N[1]/=D,N[2]/=D,N})([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new a.Point(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new a.Point(0,o))}}getCameraToCenterDistance(o,h=this.zoom,_=this.worldSize){const T=yd(o,h,this.width,this.height,1024),C=o.pixelSpaceConversion(this.center.lat,_,T);return .5/Math.tan(.5*this._fov)*this.height*C}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&a.multiply(o,o,this.globeMatrix),o}}function gr(g,o){let h=!1,_=null;const T=()=>{_=null,h&&(g(),_=setTimeout(T,o),h=!1)};return()=>(h=!0,_||T(),_)}class _u{constructor(o){this._hashName=o&&encodeURIComponent(o),a.bindAll(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=gr(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,a.window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),a.window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const h=ja(o);if(this._hashName){const _=this._hashName;let T=!1;const C=a.window.location.hash.slice(1).split("&").map((N=>{const D=N.split("=")[0];return D===_?(T=!0,`${D}=${h}`):N})).filter((N=>N));return T||C.push(`${_}=${h}`),`#${C.join("&")}`}return`#${h}`}_getCurrentHash(){const o=a.window.location.hash.replace("#","");if(this._hashName){let h;return o.split("&").map((_=>_.split("="))).forEach((_=>{_[0]===this._hashName&&(h=_)})),(h&&h[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const h=this._getCurrentHash();if(h.length>=3&&!h.some((_=>isNaN(_)))){const _=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(h[3]||0):o.getBearing();return o.jumpTo({center:[+h[2],+h[1]],zoom:+h[0],bearing:_,pitch:+(h[4]||0)}),!0}return!1}_updateHashUnthrottled(){const o=a.window.location.href.replace(/(#.+)?$/,this.getHashString());a.window.history.replaceState(a.window.history.state,null,o)}}function ja(g,o){const h=g.getCenter(),_=Math.round(100*g.getZoom())/100,T=Math.ceil((_*Math.LN2+Math.log(512/360/.5))/Math.LN10),C=Math.pow(10,T),N=Math.round(h.lng*C)/C,D=Math.round(h.lat*C)/C,B=g.getBearing(),G=g.getPitch();let $=o?`/${N}/${D}/${_}`:`${_}/${D}/${N}`;return(B||G)&&($+="/"+Math.round(10*B)/10),G&&($+=`/${Math.round(G)}`),$}const ca={linearity:.3,easing:a.bezier(0,0,.3,1)},xu=a.extend({deceleration:2500,maxSpeed:1400},ca),hc=a.extend({deceleration:20,maxSpeed:1400},ca),zt=a.extend({deceleration:1e3,maxSpeed:360},ca),Ts=a.extend({deceleration:1e3,maxSpeed:90},ca);class xl{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:a.exported.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,h=a.exported.now();for(;o.length>0&&h-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const h={zoom:0,bearing:0,pitch:0,pan:new a.Point(0,0),pinchAround:void 0,around:void 0};for(const{settings:C}of this._inertiaBuffer)h.zoom+=C.zoomDelta||0,h.bearing+=C.bearingDelta||0,h.pitch+=C.pitchDelta||0,C.panDelta&&h.pan._add(C.panDelta),C.around&&(h.around=C.around),C.pinchAround&&(h.pinchAround=C.pinchAround);const _=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,T={};if(h.pan.mag()){const C=vu(h.pan.mag(),_,a.extend({},xu,o||{}));T.offset=h.pan.mult(C.amount/h.pan.mag()),T.center=this._map.transform.center,fc(T,C)}if(h.zoom){const C=vu(h.zoom,_,hc);T.zoom=this._map.transform.zoom+C.amount,fc(T,C)}if(h.bearing){const C=vu(h.bearing,_,zt);T.bearing=this._map.transform.bearing+a.clamp(C.amount,-179,179),fc(T,C)}if(h.pitch){const C=vu(h.pitch,_,Ts);T.pitch=this._map.transform.pitch+C.amount,fc(T,C)}if(T.zoom||T.bearing){const C=h.pinchAround===void 0?h.around:h.pinchAround;T.around=C?this._map.unproject(C):this._map.getCenter()}return this.clear(),T.noMoveStart=!0,T}}function fc(g,o){(!g.duration||g.duration<o.duration)&&(g.duration=o.duration,g.easing=o.easing)}function vu(g,o,h){const{maxSpeed:_,linearity:T,deceleration:C}=h,N=a.clamp(g*T/(o/1e3),-_,_),D=Math.abs(N)/(C*T);return{easing:h.easing,duration:1e3*D,amount:N*(D/2)}}class Ri extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,_,T={}){const C=ke(h.getCanvasContainer(),_),N=h.unproject(C);super(o,a.extend({point:C,lngLat:N,originalEvent:_},T)),this._defaultPrevented=!1,this.target=h}}class pc extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,_){const T=o==="touchend"?_.changedTouches:_.touches,C=ze(h.getCanvasContainer(),T),N=C.map((B=>h.unproject(B))),D=C.reduce(((B,G,$,J)=>B.add(G.div(J.length))),new a.Point(0,0));super(o,{points:C,point:D,lngLats:N,lngLat:h.unproject(D),originalEvent:_}),this._defaultPrevented=!1}}class vl extends a.Event{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,h,_){super(o,{originalEvent:_}),this._defaultPrevented=!1}}class mc{constructor(o,h){this._map=o,this._clickTolerance=h.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new vl(o.type,this._map,o))}mousedown(o,h){return this._mousedownPos=h,this._firePreventable(new Ri(o.type,this._map,o))}mouseup(o){this._map.fire(new Ri(o.type,this._map,o))}preclick(o){const h=a.extend({},o);h.type="preclick",this._map.fire(new Ri(h.type,this._map,h))}click(o,h){this._mousedownPos&&this._mousedownPos.dist(h)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Ri(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Ri(o.type,this._map,o))}mouseover(o){this._map.fire(new Ri(o.type,this._map,o))}mouseout(o){this._map.fire(new Ri(o.type,this._map,o))}touchstart(o){return this._firePreventable(new pc(o.type,this._map,o))}touchmove(o){this._map.fire(new pc(o.type,this._map,o))}touchend(o){this._map.fire(new pc(o.type,this._map,o))}touchcancel(o){this._map.fire(new pc(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class gc{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Ri(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Ri("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Ri(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class _d{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=h.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,h){this.isEnabled()&&o.shiftKey&&o.button===0&&(ee(),this._startPos=this._lastPos=h,this._active=!0)}mousemoveWindow(o,h){if(!this._active)return;const _=h,T=this._startPos,C=this._lastPos;if(!T||!C||C.equals(_)||!this._box&&_.dist(T)<this._clickTolerance)return;this._lastPos=_,this._box||(this._box=O("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const N=Math.min(T.x,_.x),D=Math.max(T.x,_.x),B=Math.min(T.y,_.y),G=Math.max(T.y,_.y);this._map._requestDomTask((()=>{this._box&&(this._box.style.transform=`translate(${N}px,${B}px)`,this._box.style.width=D-N+"px",this._box.style.height=G-B+"px")}))}mouseupWindow(o,h){if(!this._active)return;const _=this._startPos,T=h;if(_&&o.button===0){if(this.reset(),we(),_.x!==T.x||_.y!==T.y)return this._map.fire(new a.Event("boxzoomend",{originalEvent:o})),{cameraAnimation:C=>C.fitScreenCoordinates(_,T,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),ie(),delete this._startPos,delete this._lastPos}_fireEvent(o,h){return this._map.fire(new a.Event(o,{originalEvent:h}))}}function yc(g,o){const h={};for(let _=0;_<g.length;_++)h[g[_].identifier]=o[_];return h}class Oa{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,h,_){(this.centroid||_.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),_.length===this.numTouches&&(this.centroid=(function(T){const C=new a.Point(0,0);for(const N of T)C._add(N);return C.div(T.length)})(h),this.touches=yc(_,h)))}touchmove(o,h,_){if(this.aborted||!this.centroid)return;const T=yc(_,h);for(const C in this.touches){const N=T[C];(!N||N.dist(this.touches[C])>30)&&(this.aborted=!0)}}touchend(o,h,_){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),_.length===0){const T=!this.aborted&&this.centroid;if(this.reset(),T)return T}}}class Qh{constructor(o){this.singleTap=new Oa(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,h,_){this.singleTap.touchstart(o,h,_)}touchmove(o,h,_){this.singleTap.touchmove(o,h,_)}touchend(o,h,_){const T=this.singleTap.touchend(o,h,_);if(T){const C=o.timeStamp-this.lastTime<500,N=!this.lastTap||this.lastTap.dist(T)<30;if(C&&N||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=T,this.count===this.numTaps)return this.reset(),T}}}class Tp{constructor(){this._zoomIn=new Qh({numTouches:1,numTaps:2}),this._zoomOut=new Qh({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,h,_){this._zoomIn.touchstart(o,h,_),this._zoomOut.touchstart(o,h,_)}touchmove(o,h,_){this._zoomIn.touchmove(o,h,_),this._zoomOut.touchmove(o,h,_)}touchend(o,h,_){const T=this._zoomIn.touchend(o,h,_),C=this._zoomOut.touchend(o,h,_);return T?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()+1,around:N.unproject(T)},{originalEvent:o})}):C?(this._active=!0,o.preventDefault(),setTimeout((()=>this.reset()),0),{cameraAnimation:N=>N.easeTo({duration:300,zoom:N.getZoom()-1,around:N.unproject(C)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const Sp={0:1,2:2};class _c{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,h){return!1}_move(o,h){return{}}mousedown(o,h){if(this._lastPoint)return;const _=Ge(o);this._correctButton(o,_)&&(this._lastPoint=h,this._eventButton=_)}mousemoveWindow(o,h){const _=this._lastPoint;if(_){if(o.preventDefault(),this._eventButton!=null&&(function(T,C){const N=Sp[C];return T.buttons===void 0||(T.buttons&N)!==N})(o,this._eventButton))this.reset();else if(this._moved||!(h.dist(_)<this._clickTolerance))return this._moved=!0,this._lastPoint=h,this._move(_,h)}}mouseupWindow(o){this._lastPoint&&Ge(o)===this._eventButton&&(this._moved&&we(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class wu extends _c{mousedown(o,h){super.mousedown(o,h),this._lastPoint&&(this._active=!0)}_correctButton(o,h){return h===0&&!o.ctrlKey}_move(o,h){return{around:h,panDelta:h.sub(o)}}}class Wo extends _c{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const _=.8*(h.x-o.x);if(_)return this._active=!0,{bearingDelta:_}}contextmenu(o){o.preventDefault()}}class xd extends _c{_correctButton(o,h){return h===0&&o.ctrlKey||h===2}_move(o,h){const _=-.5*(h.y-o.y);if(_)return this._active=!0,{pitchDelta:_}}contextmenu(o){o.preventDefault()}}class ua{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=h.clickTolerance||1,this.reset(),a.bindAll(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new a.Point(0,0)}touchstart(o,h,_){return this._calculateTransform(o,h,_)}touchmove(o,h,_){if(this._active&&!(_.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(_.length===1&&!a.isFullscreen())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,h,_)}}touchend(o,h,_){this._calculateTransform(o,h,_),this._active&&_.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,h,_){_.length>0&&(this._active=!0);const T=yc(_,h),C=new a.Point(0,0),N=new a.Point(0,0);let D=0;for(const G in T){const $=T[G],J=this._touches[G];J&&(C._add($),N._add($.sub(J)),D++,T[G]=$)}if(this._touches=T,D<this._minTouches||!N.mag())return;const B=N.div(D);return this._sum._add(B),this._sum.mag()<this._clickTolerance?void 0:{around:C.div(D),panDelta:B}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=O("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","null")}),500)}}class Ss{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,h,_){return{}}touchstart(o,h,_){this._firstTwoTouches||_.length<2||(this._firstTwoTouches=[_[0].identifier,_[1].identifier],this._start([h[0],h[1]]))}touchmove(o,h,_){const T=this._firstTwoTouches;if(!T)return;o.preventDefault();const[C,N]=T,D=da(_,h,C),B=da(_,h,N);if(!D||!B)return;const G=this._aroundCenter?null:D.add(B).div(2);return this._move([D,B],G,o)}touchend(o,h,_){if(!this._firstTwoTouches)return;const[T,C]=this._firstTwoTouches,N=da(_,h,T),D=da(_,h,C);N&&D||(this._active&&we(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function da(g,o,h){for(let _=0;_<g.length;_++)if(g[_].identifier===h)return o[_]}function To(g,o){return Math.log(g/o)/Math.LN2}class vd extends Ss{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,h){const _=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(To(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:To(this._distance,_),pinchAround:h}}}function ef(g,o){return 180*g.angleWith(o)/Math.PI}class Ep extends Ss{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,h){const _=this._vector;if(this._vector=o[0].sub(o[1]),_&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:ef(this._vector,_),pinchAround:h}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const h=25/(Math.PI*this._minDiameter)*360,_=this._startVector;if(!_)return!1;const T=ef(o,_);return Math.abs(T)<h}}function Es(g){return Math.abs(g.y)>Math.abs(g.x)}class xc extends Ss{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,Es(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,h,_){const T=this._lastPoints;if(!T)return;const C=o[0].sub(T[0]),N=o[1].sub(T[1]);return this._map._cooperativeGestures&&!a.isFullscreen()&&_.touches.length<3||(this._valid=this.gestureBeginsVertically(C,N,_.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(C.y+N.y)/2*-.5})}gestureBeginsVertically(o,h,_){if(this._valid!==void 0)return this._valid;const T=o.mag()>=2,C=h.mag()>=2;if(!T&&!C)return;if(!T||!C)return this._firstMove==null&&(this._firstMove=_),_-this._firstMove<100&&void 0;const N=o.y>0==h.y>0;return Es(o)&&Es(h)&&N}}const wl={panStep:100,bearingStep:15,pitchStep:10};class wd{constructor(){const o=wl;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let h=0,_=0,T=0,C=0,N=0;switch(o.keyCode){case 61:case 107:case 171:case 187:h=1;break;case 189:case 109:case 173:h=-1;break;case 37:o.shiftKey?_=-1:(o.preventDefault(),C=-1);break;case 39:o.shiftKey?_=1:(o.preventDefault(),C=1);break;case 38:o.shiftKey?T=1:(o.preventDefault(),N=-1);break;case 40:o.shiftKey?T=-1:(o.preventDefault(),N=1);break;default:return}return this._rotationDisabled&&(_=0,T=0),{cameraAnimation:D=>{const B=D.getZoom();D.easeTo({duration:300,easeId:"keyboardHandler",easing:bd,zoom:h?Math.round(B)+h*(o.shiftKey?2:1):B,bearing:D.getBearing()+_*this._bearingStep,pitch:D.getPitch()+T*this._pitchStep,offset:[-C*this._panStep,-N*this._panStep],center:D.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function bd(g){return g*(2-g)}const za=4.000244140625;class ha{constructor(o,h){this._map=o,this._el=o.getCanvasContainer(),this._handler=h,this._delta=0,this._defaultZoomRate=.01,this._wheelZoomRate=.0022222222222222222,a.bindAll(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||a.isFullscreen()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let h=o.deltaMode===a.window.WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const _=a.exported.now(),T=_-(this._lastWheelEventTime||0);this._lastWheelEventTime=_,h!==0&&h%za==0?this._type="wheel":h!==0&&Math.abs(h)<4?this._type="trackpad":T>400?(this._type=null,this._lastValue=h,this._timeout=setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(T*h)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,h+=this._lastValue)),o.shiftKey&&h&&(h/=4),this._type&&(this._lastWheelEvent=o,this._delta-=h,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const h=ke(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:h,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const h=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const B=this._type==="wheel"&&Math.abs(this._delta)>za?this._wheelZoomRate:this._defaultZoomRate;let G=2/(1+Math.exp(-Math.abs(this._delta*B)));this._delta<0&&G!==0&&(G=1/G);const $=h(),J=Math.pow(2,$),oe=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):J;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(oe*G))),this._type==="wheel"&&(this._startZoom=$,this._easing=this._smoothOutEasing(200)),this._delta=0}const _=typeof this._targetZoom=="number"?this._targetZoom:h(),T=this._startZoom,C=this._easing;let N,D=!1;if(this._type==="wheel"&&T&&C){const B=Math.min((a.exported.now()-this._lastWheelEventTime)/200,1),G=C(B);N=a.number(T,_,G),B<1?this._frameId||(this._frameId=!0):D=!0}else N=_,D=!0;return this._active=!0,D&&(this._active=!1,this._finishTimeout=setTimeout((()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout}),200)),{noInertia:!0,needsRenderFrame:!D,zoomDelta:N-h(),around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let h=a.ease;if(this._prevEase){const _=this._prevEase,T=(a.exported.now()-_.start)/_.duration,C=_.easing(T+.01)-_.easing(T),N=.27/Math.sqrt(C*C+1e-4)*.01,D=Math.sqrt(.0729-N*N);h=a.bezier(N,D,.25,1)}return this._prevEase={start:a.exported.now(),duration:o,easing:h},h}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=O("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(a.window.navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=setTimeout((()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","null")}),200)}}class Nr{constructor(o,h){this._clickZoom=o,this._tapZoom=h}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Wn{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,h){return o.preventDefault(),{cameraAnimation:_=>{_.easeTo({duration:300,zoom:_.getZoom()+(o.shiftKey?-1:1),around:_.unproject(h)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ba{constructor(){this._tap=new Qh({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,h,_){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?_.length>0&&(this._swipePoint=h[0],this._swipeTouch=_[0].identifier):this._tap.touchstart(o,h,_))}touchmove(o,h,_){if(this._tapTime){if(this._swipePoint){if(_[0].identifier!==this._swipeTouch)return;const T=h[0],C=T.y-this._swipePoint.y;return this._swipePoint=T,o.preventDefault(),this._active=!0,{zoomDelta:C/128}}}else this._tap.touchmove(o,h,_)}touchend(o,h,_){this._tapTime?this._swipePoint&&_.length===0&&this.reset():this._tap.touchend(o,h,_)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Ui{constructor(o,h,_){this._el=o,this._mousePan=h,this._touchPan=_}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Cs{constructor(o,h,_){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=h,this._mousePitch=_}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class bl{constructor(o,h,_,T){this._el=o,this._touchZoom=h,this._touchRotate=_,this._tapDragZoom=T,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const $i=g=>g.zoom||g.drag||g.pitch||g.rotate;class as extends a.Event{}class Td{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,h){const _=a.sub([],h,o);this.radius=a.length(_[2]<0?a.div([],_,this.constants):[_[0],_[1],0])}projectRay(o){a.div(o,o,this.constants),a.normalize(o,o),a.mul$1(o,o,this.constants);const h=a.scale$2([],o,this.radius);if(h[2]>0){const _=a.scale$2([],[0,0,1],a.dot(h,[0,0,1])),T=a.scale$2([],a.normalize([],[h[0],h[1],0]),this.radius),C=a.add([],h,a.scale$2([],a.sub([],a.add([],T,_),h),2));h[0]=C[0],h[1]=C[1]}return h}}function ao(g){return g.panDelta&&g.panDelta.mag()||g.zoomDelta||g.bearingDelta||g.pitchDelta}class So{constructor(o,h){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new xl(o),this._bearingSnap=h.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Td,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(h),a.bindAll(["handleEvent","handleWindowEvent"],this);const _=this._el;this._listeners=[[_,"touchstart",{passive:!0}],[_,"touchmove",{passive:!1}],[_,"touchend",void 0],[_,"touchcancel",void 0],[_,"mousedown",void 0],[_,"mousemove",void 0],[_,"mouseup",void 0],[a.window.document,"mousemove",{capture:!0}],[a.window.document,"mouseup",void 0],[_,"mouseover",void 0],[_,"mouseout",void 0],[_,"dblclick",void 0],[_,"click",void 0],[_,"keydown",{capture:!1}],[_,"keyup",void 0],[_,"wheel",{passive:!1}],[_,"contextmenu",void 0],[a.window,"blur",void 0]];for(const[T,C,N]of this._listeners)T.addEventListener(C,T===a.window.document?this.handleWindowEvent:this.handleEvent,N)}destroy(){for(const[o,h,_]of this._listeners)o.removeEventListener(h,o===a.window.document?this.handleWindowEvent:this.handleEvent,_)}_addDefaultHandlers(o){const h=this._map,_=h.getCanvasContainer();this._add("mapEvent",new mc(h,o));const T=h.boxZoom=new _d(h,o);this._add("boxZoom",T);const C=new Tp,N=new Wn;h.doubleClickZoom=new Nr(N,C),this._add("tapZoom",C),this._add("clickZoom",N);const D=new Ba;this._add("tapDragZoom",D);const B=h.touchPitch=new xc(h);this._add("touchPitch",B);const G=new Wo(o),$=new xd(o);h.dragRotate=new Cs(o,G,$),this._add("mouseRotate",G,["mousePitch"]),this._add("mousePitch",$,["mouseRotate"]);const J=new wu(o),oe=new ua(h,o);h.dragPan=new Ui(_,J,oe),this._add("mousePan",J),this._add("touchPan",oe,["touchZoom","touchRotate"]);const ce=new Ep,fe=new vd;h.touchZoomRotate=new bl(_,fe,ce,D),this._add("touchRotate",ce,["touchPan","touchZoom"]),this._add("touchZoom",fe,["touchPan","touchRotate"]),this._add("blockableMapEvent",new gc(h));const de=h.scrollZoom=new ha(h,this);this._add("scrollZoom",de,["mousePan"]);const me=h.keyboard=new wd;this._add("keyboard",me);for(const Q of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[Q]&&h[Q].enable(o[Q])}_add(o,h,_){this._handlers.push({handlerName:o,handler:h,allowed:_}),this._handlersById[o]=h}stop(o){if(!this._updatingCamera){for(const{handler:h}of this._handlers)h.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[]}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!$i(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,h,_){for(const T in o)if(T!==_&&(!h||h.indexOf(T)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const h=[];for(const _ of o)this._el.contains(_.target)&&h.push(_);return h}handleEvent(o,h){this._updatingCamera=!0;const _=o.type==="renderFrame",T=_?void 0:o,C={needsRenderFrame:!1},N={},D={},B=o.touches?this._getMapTouches(o.touches):void 0,G=B?ze(this._el,B):_?void 0:ke(this._el,o);for(const{handlerName:oe,handler:ce,allowed:fe}of this._handlers){if(!ce.isEnabled())continue;let de;this._blockedByActive(D,fe,oe)?ce.reset():ce[h||o.type]&&(de=ce[h||o.type](o,G,B),this.mergeHandlerResult(C,N,de,oe,T),de&&de.needsRenderFrame&&this._triggerRenderFrame()),(de||ce.isActive())&&(D[oe]=ce)}const $={};for(const oe in this._previousActiveHandlers)D[oe]||($[oe]=T);this._previousActiveHandlers=D,(Object.keys($).length||ao(C))&&(this._changes.push([C,N,$]),this._triggerRenderFrame()),(Object.keys(D).length||ao(C))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:J}=C;J&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],J(this._map))}mergeHandlerResult(o,h,_,T,C){if(!_)return;a.extend(o,_);const N={handlerName:T,originalEvent:_.originalEvent||C};_.zoomDelta!==void 0&&(h.zoom=N),_.panDelta!==void 0&&(h.drag=N),_.pitchDelta!==void 0&&(h.pitch=N),_.bearingDelta!==void 0&&(h.rotate=N)}_applyChanges(){const o={},h={},_={};for(const[T,C,N]of this._changes)T.panDelta&&(o.panDelta=(o.panDelta||new a.Point(0,0))._add(T.panDelta)),T.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+T.zoomDelta),T.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+T.bearingDelta),T.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+T.pitchDelta),T.around!==void 0&&(o.around=T.around),T.aroundCoord!==void 0&&(o.aroundCoord=T.aroundCoord),T.pinchAround!==void 0&&(o.pinchAround=T.pinchAround),T.noInertia&&(o.noInertia=T.noInertia),a.extend(h,C),a.extend(_,N);this._updateMapTransform(o,h,_),this._changes=[]}_updateMapTransform(o,h,_){const T=this._map,C=T.transform,N=le=>[le.x,le.y,le.z];if((le=>{const _e=this._eventsInProgress.drag;return _e&&!this._handlersById[_e.handlerName].isActive()})()&&!ao(o)){const le=C.zoom;C.cameraElevationReference="sea",C.recenterOnTerrain(),C.cameraElevationReference="ground",le!==C.zoom&&this._map._update(!0)}if(C._isCameraConstrained&&T._stop(!0),!ao(o))return void this._fireEvents(h,_,!0);let{panDelta:D,zoomDelta:B,bearingDelta:G,pitchDelta:$,around:J,aroundCoord:oe,pinchAround:ce}=o;C._isCameraConstrained&&(B>0&&(B=0),C._isCameraConstrained=!1),ce!==void 0&&(J=ce),(B||(le=>h[le]&&!this._eventsInProgress[le])("drag"))&&J&&(this._dragOrigin=N(C.pointCoordinate3D(J)),this._trackingEllipsoid.setup(C._camera.position,this._dragOrigin)),C.cameraElevationReference="sea",T._stop(!0),J=J||T.transform.centerPoint,G&&(C.bearing+=G),$&&(C.pitch+=$),C._updateCameraState();const fe=[0,0,0];if(D)if(C.projection.name==="mercator"){const le=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(J).dir),_e=this._trackingEllipsoid.projectRay(C.screenPointToMercatorRay(J.sub(D)).dir);fe[0]=_e[0]-le[0],fe[1]=_e[1]-le[1]}else{const le=C.pointCoordinate(J);if(C.projection.name==="globe"){D=D.rotate(-C.angle);const _e=C._pixelsPerMercatorPixel/C.worldSize;fe[0]=-D.x*a.mercatorScale(a.latFromMercatorY(le.y))*_e,fe[1]=-D.y*a.mercatorScale(C.center.lat)*_e}else{const _e=C.pointCoordinate(J.sub(D));le&&_e&&(fe[0]=_e.x-le.x,fe[1]=_e.y-le.y)}}const de=C.zoom,me=[0,0,0];if(B){const le=N(oe||C.pointCoordinate3D(J)),_e={dir:a.normalize([],a.sub([],le,C._camera.position))};if(_e.dir[2]<0){const ve=C.zoomDeltaToMovement(le,B);a.scale$2(me,_e.dir,ve)}}const Q=a.add(fe,fe,me);C._translateCameraConstrained(Q),B&&Math.abs(C.zoom-de)>1e-4&&C.recenterOnTerrain(),C.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(h,_,!0)}_fireEvents(o,h,_){const T=$i(this._eventsInProgress),C=$i(o),N={};for(const $ in o){const{originalEvent:J}=o[$];this._eventsInProgress[$]||(N[`${$}start`]=J),this._eventsInProgress[$]=o[$]}!T&&C&&this._fireEvent("movestart",C.originalEvent);for(const $ in N)this._fireEvent($,N[$]);C&&this._fireEvent("move",C.originalEvent);for(const $ in o){const{originalEvent:J}=o[$];this._fireEvent($,J)}const D={};let B;for(const $ in this._eventsInProgress){const{handlerName:J,originalEvent:oe}=this._eventsInProgress[$];this._handlersById[J].isActive()||(delete this._eventsInProgress[$],B=h[J]||oe,D[`${$}end`]=B)}for(const $ in D)this._fireEvent($,D[$]);const G=$i(this._eventsInProgress);if(_&&(T||C)&&!G){this._updatingCamera=!0;const $=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),J=oe=>oe!==0&&-this._bearingSnap<oe&&oe<this._bearingSnap;$?(J($.bearing||this._map.getBearing())&&($.bearing=0),this._map.easeTo($,{originalEvent:B})):(this._map.fire(new a.Event("moveend",{originalEvent:B})),J(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,h){this._map.fire(new a.Event(o,h?{originalEvent:h}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add((o=>{this._frameId=void 0,this.handleEvent(new as("renderFrame",{timeStamp:o})),this._applyChanges()}))}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const qo="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class bu extends a.Evented{constructor(o,h){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=h.bearingSnap,this._respectPrefersReducedMotion=h.respectPrefersReducedMotion!==!1,a.bindAll(["_renderFrameCallback"],this)}getCenter(){return new a.LngLat(this.transform.center.lng,this.transform.center.lat)}setCenter(o,h){return this.jumpTo({center:o},h)}panBy(o,h,_){return o=a.Point.convert(o).mult(-1),this.panTo(this.transform.center,a.extend({offset:o},h),_)}panTo(o,h,_){return this.easeTo(a.extend({center:o},h),_)}getZoom(){return this.transform.zoom}setZoom(o,h){return this.jumpTo({zoom:o},h),this}zoomTo(o,h,_){return this.easeTo(a.extend({zoom:o},h),_)}zoomIn(o,h){return this.zoomTo(this.getZoom()+1,o,h),this}zoomOut(o,h){return this.zoomTo(this.getZoom()-1,o,h),this}getBearing(){return this.transform.bearing}setBearing(o,h){return this.jumpTo({bearing:o},h),this}getPadding(){return this.transform.padding}setPadding(o,h){return this.jumpTo({padding:o},h),this}rotateTo(o,h,_){return this.easeTo(a.extend({bearing:o},h),_)}resetNorth(o,h){return this.rotateTo(0,a.extend({duration:1e3},o),h),this}resetNorthPitch(o,h){return this.easeTo(a.extend({bearing:0,pitch:0,duration:1e3},o),h),this}snapToNorth(o,h){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,h):this}getPitch(){return this.transform.pitch}setPitch(o,h){return this.jumpTo({pitch:o},h),this}cameraForBounds(o,h){o=a.LngLatBounds.convert(o);const _=h&&h.bearing||0,T=h&&h.pitch||0,C=o.getNorthWest(),N=o.getSouthEast();return this._cameraForBounds(this.transform,C,N,_,T,h)}_extendCameraOptions(o){const h={top:0,bottom:0,right:0,left:0};if(typeof(o=a.extend({padding:h,offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=="number"){const _=o.padding;o.padding={top:_,bottom:_,right:_,left:_}}return o.padding=a.extend(h,o.padding),o}_minimumAABBFrustumDistance(o,h){const _=h.max[0]-h.min[0],T=h.max[1]-h.min[1];return _/T>o.aspect?_/(2*Math.tan(.5*o.fovX)*o.aspect):T/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,h,_,T,C,N){const D=o.clone(),B=this._extendCameraOptions(N);D.bearing=T,D.pitch=C;const G=a.LngLat.convert(h),$=a.LngLat.convert(_),J=.5*(G.lat+$.lat),oe=.5*(G.lng+$.lng),ce=a.latLngToECEF(J,oe),fe=a.normalize([],ce),de=a.normalize([],a.cross([],fe,[0,1,0])),me=a.cross([],de,fe),Q=[de[0],de[1],de[2],0,me[0],me[1],me[2],0,fe[0],fe[1],fe[2],0,0,0,0,1],le=[ce,a.latLngToECEF(G.lat,G.lng),a.latLngToECEF($.lat,G.lng),a.latLngToECEF($.lat,$.lng),a.latLngToECEF(G.lat,$.lng),a.latLngToECEF(J,G.lng),a.latLngToECEF(J,$.lng),a.latLngToECEF(G.lat,oe),a.latLngToECEF($.lat,oe)];let _e=a.Aabb.fromPoints(le.map((xt=>[a.dot(de,xt),a.dot(me,xt),a.dot(fe,xt)])));const ve=a.transformMat4([],_e.center,Q);a.squaredLength(ve)===0&&a.set(ve,0,0,1),a.normalize(ve,ve),a.scale$2(ve,ve,a.GLOBE_RADIUS),D.center=a.ecefToLatLng(ve);const Ne=D.getWorldToCameraMatrix(),Le=a.invert(new Float64Array(16),Ne);_e=a.Aabb.applyTransform(_e,a.multiply([],Ne,Q)),a.transformMat4(ve,ve,Ne);const De=.5*(_e.max[2]-_e.min[2]),$e=this._minimumAABBFrustumDistance(D,_e),Ue=a.scale$2([],[0,0,1],De),Ye=a.add(Ue,ve,Ue),kt=$e+(D.pitch===0?0:a.distance(ve,Ye)),qe=D.globeCenterInViewSpace,at=a.sub([],ve,[qe[0],qe[1],qe[2]]);a.normalize(at,at),a.scale$2(at,at,kt);const Je=a.add([],ve,at);a.transformMat4(Je,Je,Le);const Et=a.earthRadius/a.GLOBE_RADIUS,Ke=a.length(Je),lt=a.mercatorZfromAltitude(Math.max(Ke*Et-a.earthRadius,Number.EPSILON),0),Tt=Math.min(D.zoomFromMercatorZAdjusted(lt),B.maxZoom);return Tt>.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"mercator"}),D.zoom=Tt,this._cameraForBounds(D,h,_,T,C,N)):{center:D.center,zoom:Tt,bearing:T,pitch:C}}queryTerrainElevation(o,h){const _=this.transform.elevation;return _?(h=a.extend({},{exaggerated:!0},h),_.getAtPoint(a.MercatorCoordinate.fromLngLat(o),null,h.exaggerated)):null}_cameraForBounds(o,h,_,T,C,N){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,h,_,T,C,N);const D=o.clone(),B=this._extendCameraOptions(N),G=D.padding;D.bearing=T,D.pitch=C;const $=a.LngLat.convert(h),J=a.LngLat.convert(_),oe=new a.LngLat($.lng,J.lat),ce=new a.LngLat(J.lng,$.lat),fe=D.project($),de=D.project(J),me=this.queryTerrainElevation($),Q=this.queryTerrainElevation(J),le=this.queryTerrainElevation(oe),_e=this.queryTerrainElevation(ce),ve=[[fe.x,fe.y,Math.min(me||0,Q||0,le||0,_e||0)],[de.x,de.y,Math.max(me||0,Q||0,le||0,_e||0)]];let Ne=a.Aabb.fromPoints(ve);const Le=D.getWorldToCameraMatrix(),De=a.invert(new Float64Array(16),Le);Ne=a.Aabb.applyTransform(Ne,Le);const $e=a.sub([],Ne.max,Ne.min),Ue=G.left||0,Ye=G.right||0,kt=G.bottom||0,qe=G.top||0,{left:at,right:Je,top:Et,bottom:Ke}=B.padding,lt=.5*(Ue+Ye),Tt=.5*(qe+kt),xt=Math.min(D.scaleZoom(D.scale*Math.min((D.width-(Ue+Ye+at+Je))/$e[0],(D.height-(kt+qe+Ke+Et))/$e[1])),B.maxZoom),At=D.scale/D.zoomScale(xt);Ne=new a.Aabb([Ne.min[0]-(at+lt)*At,Ne.min[1]-(Ke+Tt)*At,Ne.min[2]],[Ne.max[0]+(Je+lt)*At,Ne.max[1]+(Et+Tt)*At,Ne.max[2]]);const Qt=.5*$e[2],yn=this._minimumAABBFrustumDistance(D,Ne),qt=[0,0,1,0];a.transformMat4$1(qt,qt,Le),a.normalize$2(qt,qt);const un=a.scale$2([],qt,yn+Qt),jn=a.add([],Ne.center,un),Fn=(typeof B.offset.x=="number"&&typeof B.offset.y=="number"?new a.Point(B.offset.x,B.offset.y):a.Point.convert(B.offset)).rotate(-a.degToRad(T));Ne.center[0]-=Fn.x*At,Ne.center[1]+=Fn.y*At,a.transformMat4(Ne.center,Ne.center,De),a.transformMat4(jn,jn,De);const en=[Ne.center[0],Ne.center[1],jn[2]*D.pixelsPerMeter];a.scale$2(en,en,1/D.worldSize);const Gn=a.lngFromMercatorX(en[0]),sr=a.latFromMercatorY(en[1]),or=Math.min(D._zoomFromMercatorZ(en[2]),B.maxZoom),tr=new a.LngLat(Gn,sr);return D.mercatorFromTransition&&or<.5*(a.GLOBE_ZOOM_THRESHOLD_MIN+a.GLOBE_ZOOM_THRESHOLD_MAX)?(D.setProjection({name:"globe"}),D.zoom=or,this._cameraForBounds(D,h,_,T,C,N)):{center:tr,zoom:or,bearing:T,pitch:C}}fitBounds(o,h,_){const T=this.cameraForBounds(o,h);return this._fitInternal(T,h,_)}fitScreenCoordinates(o,h,_,T,C){const N=a.Point.convert(o),D=a.Point.convert(h),B=new a.Point(Math.min(N.x,D.x),Math.min(N.y,D.y)),G=new a.Point(Math.max(N.x,D.x),Math.max(N.y,D.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(N,D))return this;const $=this.transform.pointLocation3D(B),J=this.transform.pointLocation3D(G),oe=this.transform.pointLocation3D(new a.Point(B.x,G.y)),ce=this.transform.pointLocation3D(new a.Point(G.x,B.y)),fe=[Math.min($.lng,J.lng,oe.lng,ce.lng),Math.min($.lat,J.lat,oe.lat,ce.lat)],de=[Math.max($.lng,J.lng,oe.lng,ce.lng),Math.max($.lat,J.lat,oe.lat,ce.lat)],me=T&&T.pitch?T.pitch:this.getPitch(),Q=this._cameraForBounds(this.transform,fe,de,_,me,T);return this._fitInternal(Q,T,C)}_fitInternal(o,h,_){return o?(delete(h=a.extend(o,h)).padding,h.linear?this.easeTo(h,_):this.flyTo(h,_)):this}jumpTo(o,h){this.stop();const _=o.preloadOnly?this.transform.clone():this.transform;let T=!1,C=!1,N=!1;return"zoom"in o&&_.zoom!==+o.zoom&&(T=!0,_.zoom=+o.zoom),o.center!==void 0&&(_.center=a.LngLat.convert(o.center)),"bearing"in o&&_.bearing!==+o.bearing&&(C=!0,_.bearing=+o.bearing),"pitch"in o&&_.pitch!==+o.pitch&&(N=!0,_.pitch=+o.pitch),o.padding==null||_.isPaddingEqual(o.padding)||(_.padding=o.padding),o.preloadOnly?(this._preloadTiles(_),this):(this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),T&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),C&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),N&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||a.warnOnce(qo),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,h){const _=this.transform;if(!_.projection.supportsFreeCamera)return a.warnOnce(qo),this;this.stop();const T=_.zoom,C=_.pitch,N=_.bearing;_.setFreeCameraOptions(o);const D=T!==_.zoom,B=C!==_.pitch,G=N!==_.bearing;return this.fire(new a.Event("movestart",h)).fire(new a.Event("move",h)),D&&this.fire(new a.Event("zoomstart",h)).fire(new a.Event("zoom",h)).fire(new a.Event("zoomend",h)),G&&this.fire(new a.Event("rotatestart",h)).fire(new a.Event("rotate",h)).fire(new a.Event("rotateend",h)),B&&this.fire(new a.Event("pitchstart",h)).fire(new a.Event("pitch",h)).fire(new a.Event("pitchend",h)),this.fire(new a.Event("moveend",h)),this}easeTo(o,h){this._stop(!1,o.easeId),((o=a.extend({offset:[0,0],duration:500,easing:a.ease},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const _=this.transform,T=this.getZoom(),C=this.getBearing(),N=this.getPitch(),D=this.getPadding(),B="zoom"in o?+o.zoom:T,G="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:N,J="padding"in o?o.padding:_.padding,oe=a.Point.convert(o.offset);let ce,fe,de;if(_.projection.name==="globe"){const Ue=a.MercatorCoordinate.fromLngLat(_.center),Ye=oe.rotate(-_.angle);Ue.x+=Ye.x/_.worldSize,Ue.y+=Ye.y/_.worldSize;const kt=Ue.toLngLat(),qe=a.LngLat.convert(o.center||kt);this._normalizeCenter(qe),ce=_.centerPoint.add(Ye),fe=new a.Point(Ue.x,Ue.y).mult(_.worldSize),de=new a.Point(a.mercatorXfromLng(qe.lng),a.mercatorYfromLat(qe.lat)).mult(_.worldSize).sub(fe)}else{ce=_.centerPoint.add(oe);const Ue=_.pointLocation(ce),Ye=a.LngLat.convert(o.center||Ue);this._normalizeCenter(Ye),fe=_.project(Ue),de=_.project(Ye).sub(fe)}const me=_.zoomScale(B-T);let Q,le;o.around&&(Q=a.LngLat.convert(o.around),le=_.locationPoint(Q));const _e=this._zooming||B!==T,ve=this._rotating||C!==G,Ne=this._pitching||$!==N,Le=!_.isPaddingEqual(J),De=Ue=>Ye=>{if(_e&&(Ue.zoom=a.number(T,B,Ye)),ve&&(Ue.bearing=a.number(C,G,Ye)),Ne&&(Ue.pitch=a.number(N,$,Ye)),Le&&(Ue.interpolatePadding(D,J,Ye),ce=Ue.centerPoint.add(oe)),Q)Ue.setLocationAtPoint(Q,le);else{const kt=Ue.zoomScale(Ue.zoom-T),qe=B>T?Math.min(2,me):Math.max(.5,me),at=Math.pow(qe,1-Ye),Je=Ue.unproject(fe.add(de.mult(Ye*at)).mult(kt));Ue.setLocationAtPoint(Ue.renderWorldCopies?Je.wrap():Je,ce)}return o.preloadOnly||this._fireMoveEvents(h),Ue};if(o.preloadOnly){const Ue=this._emulate(De,o.duration,_);return this._preloadTiles(Ue),this}const $e={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=_e,this._rotating=ve,this._pitching=Ne,this._padding=Le,this._easeId=o.easeId,this._prepareEase(h,o.noMoveStart,$e),this._ease(De(_),(Ue=>{_.recenterOnTerrain(),this._afterEase(h,Ue)}),o),this}_prepareEase(o,h,_={}){this._moving=!0,this.transform.cameraElevationReference="sea",h||_.moving||this.fire(new a.Event("movestart",o)),this._zooming&&!_.zooming&&this.fire(new a.Event("zoomstart",o)),this._rotating&&!_.rotating&&this.fire(new a.Event("rotatestart",o)),this._pitching&&!_.pitching&&this.fire(new a.Event("pitchstart",o))}_fireMoveEvents(o){this.fire(new a.Event("move",o)),this._zooming&&this.fire(new a.Event("zoom",o)),this._rotating&&this.fire(new a.Event("rotate",o)),this._pitching&&this.fire(new a.Event("pitch",o))}_afterEase(o,h){if(this._easeId&&h&&this._easeId===h)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const _=this._zooming,T=this._rotating,C=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,_&&this.fire(new a.Event("zoomend",o)),T&&this.fire(new a.Event("rotateend",o)),C&&this.fire(new a.Event("pitchend",o)),this.fire(new a.Event("moveend",o))}flyTo(o,h){if(this._prefersReducedMotion(o)){const xt=a.pick(o,["center","zoom","bearing","pitch","around"]);return this.jumpTo(xt,h)}this.stop(),o=a.extend({offset:[0,0],speed:1.2,curve:1.42,easing:a.ease},o);const _=this.transform,T=this.getZoom(),C=this.getBearing(),N=this.getPitch(),D=this.getPadding(),B="zoom"in o?a.clamp(+o.zoom,_.minZoom,_.maxZoom):T,G="bearing"in o?this._normalizeBearing(o.bearing,C):C,$="pitch"in o?+o.pitch:N,J="padding"in o?o.padding:_.padding,oe=_.zoomScale(B-T),ce=a.Point.convert(o.offset);let fe=_.centerPoint.add(ce);const de=_.pointLocation(fe),me=a.LngLat.convert(o.center||de);this._normalizeCenter(me);const Q=_.project(de),le=_.project(me).sub(Q);let _e=o.curve;const ve=Math.max(_.width,_.height),Ne=ve/oe,Le=le.mag();if("minZoom"in o){const xt=a.clamp(Math.min(o.minZoom,T,B),_.minZoom,_.maxZoom),At=ve/_.zoomScale(xt-T);_e=Math.sqrt(At/Le*2)}const De=_e*_e;function $e(xt){const At=(Ne*Ne-ve*ve+(xt?-1:1)*De*De*Le*Le)/(2*(xt?Ne:ve)*De*Le);return Math.log(Math.sqrt(At*At+1)-At)}function Ue(xt){return(Math.exp(xt)-Math.exp(-xt))/2}function Ye(xt){return(Math.exp(xt)+Math.exp(-xt))/2}const kt=$e(0);let qe=function(xt){return Ye(kt)/Ye(kt+_e*xt)},at=function(xt){return ve*((Ye(kt)*(Ue(At=kt+_e*xt)/Ye(At))-Ue(kt))/De)/Le;var At},Je=($e(1)-kt)/_e;if(Math.abs(Le)<1e-6||!isFinite(Je)){if(Math.abs(ve-Ne)<1e-6)return this.easeTo(o,h);const xt=Ne<ve?-1:1;Je=Math.abs(Math.log(Ne/ve))/_e,at=function(){return 0},qe=function(At){return Math.exp(xt*_e*At)}}o.duration="duration"in o?+o.duration:1e3*Je/("screenSpeed"in o?+o.screenSpeed/_e:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const Et=C!==G,Ke=$!==N,lt=!_.isPaddingEqual(J),Tt=xt=>At=>{const Qt=At*Je,yn=1/qe(Qt);xt.zoom=At===1?B:T+xt.scaleZoom(yn),Et&&(xt.bearing=a.number(C,G,At)),Ke&&(xt.pitch=a.number(N,$,At)),lt&&(xt.interpolatePadding(D,J,At),fe=xt.centerPoint.add(ce));const qt=At===1?me:xt.unproject(Q.add(le.mult(at(Qt))).mult(yn));return xt.setLocationAtPoint(xt.renderWorldCopies?qt.wrap():qt,fe),xt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(h),xt};if(o.preloadOnly){const xt=this._emulate(Tt,o.duration,_);return this._preloadTiles(xt),this}return this._zooming=!0,this._rotating=Et,this._pitching=Ke,this._padding=lt,this._prepareEase(h,!1),this._ease(Tt(_),(()=>this._afterEase(h)),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_stop(o,h){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const _=this._onEaseEnd;this._onEaseEnd=void 0,_.call(this,h)}if(!o){const _=this.handlers;_&&_.stop(!1)}return this}_ease(o,h,_){_.animate===!1||_.duration===0?(o(1),h()):(this._easeStart=a.exported.now(),this._easeOptions=_,this._onEaseFrame=o,this._onEaseEnd=h,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((a.exported.now()-this._easeStart)/this._easeOptions.duration,1),h=this._onEaseFrame;h&&h(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,h){o=a.wrap(o,-180,180);const _=Math.abs(o-h);return Math.abs(o-360-h)<_&&(o-=360),Math.abs(o+360-h)<_&&(o+=360),o}_normalizeCenter(o){const h=this.transform;if(!h.renderWorldCopies||h.maxBounds)return;const _=o.lng-h.center.lng;o.lng+=_>180?-360:_<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&a.exported.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,h,_){const T=Math.ceil(15*h/1e3),C=[],N=o(_.clone());for(let D=0;D<=T;D++){const B=N(D/T);C.push(B.clone())}return C}}class Ft{constructor(o={}){this.options=o,a.bindAll(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const h=this.options&&this.options.compact;return this._map=o,this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=O("button","mapboxgl-ctrl-attrib-button",this._container),O("span","mapboxgl-ctrl-icon",this._compactButton).setAttribute("aria-hidden","true"),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._setElementTitle(this._compactButton,"ToggleAttribution"),this._innerContainer=O("div","mapboxgl-ctrl-attrib-inner",this._container),this._innerContainer.setAttribute("role","list"),h&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),h===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_setElementTitle(o,h){const _=this._map._getUIString(`AttributionControl.${h}`);o.setAttribute("aria-label",_),o.removeAttribute("title"),o.firstElementChild&&o.firstElementChild.setAttribute("title",_)}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const h=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||a.config.ACCESS_TOKEN}];if(o){const _=h.reduce(((T,C,N)=>(C.value&&(T+=`${C.key}=${C.value}${N<h.length-1?"&":""}`),T)),"?");o.href=`${a.config.FEEDBACK_URL}/${_}#${ja(this._map,!0)}`,o.rel="noopener nofollow",this._setElementTitle(o,"MapFeedback")}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const T=this._map.style.stylesheet;this.styleOwner=T.owner,this.styleId=T.id}const h=this._map.style._sourceCaches;for(const T in h){const C=h[T];if(C.used){const N=C.getSource();N.attribution&&o.indexOf(N.attribution)<0&&o.push(N.attribution)}}o.sort(((T,C)=>T.length-C.length)),o=o.filter(((T,C)=>{for(let N=C+1;N<o.length;N++)if(o[N].indexOf(T)>=0)return!1;return!0})),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const _=o.join(" | ");_!==this._attribHTML&&(this._attribHTML=_,o.length?(this._innerContainer.innerHTML=_,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class vc{constructor(){a.bindAll(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=O("div","mapboxgl-ctrl");const h=O("a","mapboxgl-ctrl-logo");return h.target="_blank",h.rel="noopener nofollow",h.href="https://www.mapbox.com/",h.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),h.setAttribute("rel","noopener nofollow"),this._container.appendChild(h),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const h in o){const _=o[h].getSource();if(_.hasOwnProperty("mapbox_logo")&&!_.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const h=o[0];this._map.getCanvasContainer().offsetWidth<250?h.classList.add("mapboxgl-compact"):h.classList.remove("mapboxgl-compact")}}}class Tu{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const h=++this._id;return this._queue.push({callback:o,id:h,cancelled:!1}),h}remove(o){const h=this._currentlyRunning,_=h?this._queue.concat(h):this._queue;for(const T of _)if(T.id===o)return void(T.cancelled=!0)}run(o=0){const h=this._currentlyRunning=this._queue;this._queue=[];for(const _ of h)if(!_.cancelled&&(_.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}function Tl(g,o,h){if(g=new a.LngLat(g.lng,g.lat),o){const _=new a.LngLat(g.lng-360,g.lat),T=new a.LngLat(g.lng+360,g.lat),C=360*Math.ceil(Math.abs(g.lng-h.center.lng)/360),N=h.locationPoint(g).distSqr(o),D=o.x<0||o.y<0||o.x>h.width||o.y>h.height;h.locationPoint(_).distSqr(o)<N&&(D||Math.abs(_.lng-h.center.lng)<C)?g=_:h.locationPoint(T).distSqr(o)<N&&(D||Math.abs(T.lng-h.center.lng)<C)&&(g=T)}for(;Math.abs(g.lng-h.center.lng)>180;){const _=h.locationPoint(g);if(_.x>=0&&_.y>=0&&_.x<=h.width&&_.y<=h.height)break;g.lng>h.center.lng?g.lng-=360:g.lng+=360}return g}const Sl={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"};class Ot extends a.Evented{constructor(o,h){if(super(),(o instanceof a.window.HTMLElement||h)&&(o=a.extend({element:o},h)),a.bindAll(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this),this._anchor=o&&o.anchor||"center",this._color=o&&o.color||"#3FB1CE",this._scale=o&&o.scale||1,this._draggable=o&&o.draggable||!1,this._clickTolerance=o&&o.clickTolerance||0,this._isDragging=!1,this._state="inactive",this._rotation=o&&o.rotation||0,this._rotationAlignment=o&&o.rotationAlignment||"auto",this._pitchAlignment=o&&o.pitchAlignment&&o.pitchAlignment||"auto",this._updateMoving=()=>this._update(!0),this._occludedOpacity=o&&o.occludedOpacity||.2,o&&o.element)this._element=o.element,this._offset=a.Point.convert(o&&o.offset||[0,0]);else{this._defaultMarker=!0,this._element=O("div");const T=41,C=27,N=K("svg",{display:"block",height:T*this._scale+"px",width:C*this._scale+"px",viewBox:`0 0 ${C} ${T}`},this._element),D=K("radialGradient",{id:"shadowGradient"},K("defs",{},N));K("stop",{offset:"10%","stop-opacity":.4},D),K("stop",{offset:"100%","stop-opacity":.05},D),K("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},N),K("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},N),K("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},N),K("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},N),this._offset=a.Point.convert(o&&o.offset||[0,-14])}this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",(T=>{T.preventDefault()})),this._element.addEventListener("mousedown",(T=>{T.preventDefault()}));const _=this._element.classList;for(const T in Sl)_.remove(`mapboxgl-marker-anchor-${T}`);_.add(`mapboxgl-marker-anchor-${this._anchor}`),this._popup=null}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=a.LngLat.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const T=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[T,-1*(38.1-13.5+T)],"bottom-right":[-T,-1*(38.1-13.5+T)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const h=o.code,_=o.charCode||o.keyCode;h!=="Space"&&h!=="Enter"&&_!==32&&_!==13||this.togglePopup()}_onMapClick(o){const h=o.originalEvent.target,_=this._element;this._popup&&(h===_||_.contains(h))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,h=this._pos;if(!o||!h)return!1;const _=o.unproject(h),T=o.getFreeCameraOptions();if(!T.position)return!1;const C=T.position.toLngLat();return C.distanceTo(_)<.9*C.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const h=this._pos;if(!h||h.x<0||h.x>o.transform.width||h.y<0||h.y>o.transform.height)return void this._clearFadeTimer();const _=o.unproject(h);let T;o._showingGlobe()&&a.isLngLatBehindGlobe(o.transform,this._lngLat)?T=0:(T=1-o._queryFogOpacity(_),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(T*=this._occludedOpacity)),this._element.style.opacity=`${T}`,this._element.style.pointerEvents=T>0?"auto":"none",this._popup&&this._popup._setOpacity(T),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const h=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${Sl[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${h.x}px,${h.y}px)
        `}_calculateXYTransform(){const o=this._pos,h=this._map,_=this.getPitchAlignment();if(!h||!o||_!=="map")return"";if(!h._showingGlobe()){const B=h.getPitch();return B?`rotateX(${B}deg)`:""}const T=a.radToDeg(a.globeTiltAtLngLat(h.transform,this._lngLat)),C=o.sub(a.globeCenterToScreenPoint(h.transform)),N=Math.abs(C.x)+Math.abs(C.y);if(N===0)return"";const D=T/N;return`rotateX(${-C.y*D}deg) rotateY(${C.x*D}deg)`}_calculateZTransform(){const o=this._pos,h=this._map;if(!h||!o)return"";let _=0;const T=this.getRotationAlignment();if(T==="map")if(h._showingGlobe()){const C=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat+.001)),N=h.project(new a.LngLat(this._lngLat.lng,this._lngLat.lat-.001)).sub(C);_=a.radToDeg(Math.atan2(N.y,N.x))-90}else _=-h.getBearing();else if(T==="horizon"){const C=a.smoothstep(4,6,h.getZoom()),N=a.globeCenterToScreenPoint(h.transform);N.y+=C*h.transform.height;const D=o.sub(N),B=a.radToDeg(Math.atan2(D.y,D.x));_=(B>90?B-270:B+90)*(1-C)}return _+=this._rotation,_?`rotateZ(${_}deg)`:""}_update(o){a.window.cancelAnimationFrame(this._updateFrameId);const h=this._map;h&&(h.transform.renderWorldCopies&&(this._lngLat=Tl(this._lngLat,this._pos,h.transform)),this._pos=h.project(this._lngLat),o===!0?this._updateFrameId=a.window.requestAnimationFrame((()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())})):this._pos=this._pos.round(),h._requestDomTask((()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(h._showingGlobe()||h.getTerrain()||h.getFog())&&!this._fadeTimer&&(this._fadeTimer=setTimeout(this._evaluateOpacity.bind(this),60)))})))}getOffset(){return this._offset}setOffset(o){return this._offset=a.Point.convert(o),this._update(),this}_onMove(o){const h=this._map;if(!h)return;const _=this._pointerdownPos,T=this._positionDelta;if(_&&T){if(!this._isDragging){const C=this._clickTolerance||h._clickTolerance;if(o.point.dist(_)<C)return;this._isDragging=!0}this._pos=o.point.sub(T),this._lngLat=h.unproject(this._pos),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new a.Event("dragstart"))),this.fire(new a.Event("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new a.Event("dragend")),this._state="inactive"}_addDragHandler(o){const h=this._map,_=this._pos;h&&_&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(_),this._pointerdownPos=o.point,this._state="pending",h.on("mousemove",this._onMove),h.on("touchmove",this._onMove),h.once("mouseup",this._onUp),h.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const h=this._map;return h&&(o?(h.on("mousedown",this._addDragHandler),h.on("touchstart",this._addDragHandler)):(h.off("mousedown",this._addDragHandler),h.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||0,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||"auto",this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||"auto",this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||.2,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Fa={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px"},wc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Su(g=new a.Point(0,0),o="bottom"){if(typeof g=="number"){const h=Math.round(Math.sqrt(.5*Math.pow(g,2)));switch(o){case"top":return new a.Point(0,g);case"top-left":return new a.Point(h,h);case"top-right":return new a.Point(-h,h);case"bottom":return new a.Point(0,-g);case"bottom-left":return new a.Point(h,-h);case"bottom-right":return new a.Point(-h,-h);case"left":return new a.Point(g,0);case"right":return new a.Point(-g,0)}return new a.Point(0,0)}return g instanceof a.Point||Array.isArray(g)?a.Point.convert(g):a.Point.convert(g[o]||[0,0])}class bc{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const h=a.easeCubicInOut((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-h)+this._end*h}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,h,_){this._start=this.getValue(h),this._end=o,this._startTime=h,this._endTime=h+_}}const Bs={"AttributionControl.ToggleAttribution":"Toggle attribution","AttributionControl.MapFeedback":"Map feedback","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox logo","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use  + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"},Fs={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,optimizeForTerrain:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0},El={showCompass:!0,showZoom:!0,visualizePitch:!1};class fa{constructor(o,h,_=!1){this._clickTolerance=10,this.element=h,this.mouseRotate=new Wo({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,_&&(this.mousePitch=new xd({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),a.bindAll(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),h.addEventListener("mousedown",this.mousedown),h.addEventListener("touchstart",this.touchstart,{passive:!1}),h.addEventListener("touchmove",this.touchmove),h.addEventListener("touchend",this.touchend),h.addEventListener("touchcancel",this.reset)}down(o,h){this.mouseRotate.mousedown(o,h),this.mousePitch&&this.mousePitch.mousedown(o,h),ee()}move(o,h){const _=this.map,T=this.mouseRotate.mousemoveWindow(o,h),C=T&&T.bearingDelta;if(C&&_.setBearing(_.getBearing()+C),this.mousePitch){const N=this.mousePitch.mousemoveWindow(o,h),D=N&&N.pitchDelta;D&&_.setPitch(_.getPitch()+D)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart,{passive:!1}),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){ie(),a.window.removeEventListener("mousemove",this.mousemove),a.window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(a.extend({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),ke(this.element,o)),a.window.addEventListener("mousemove",this.mousemove),a.window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,ke(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=ze(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=ze(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}const Eo={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},pa={maxWidth:100,unit:"metric"},Sd={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},Va={version:a.version,supported:M,setRTLTextPlugin:a.setRTLTextPlugin,getRTLTextPluginStatus:a.getRTLTextPluginStatus,Map:class extends bu{constructor(g){if(a.LivePerformanceUtils.mark(a.PerformanceMarkers.create),(g=a.extend({},Fs,g)).minZoom!=null&&g.maxZoom!=null&&g.minZoom>g.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(g.minPitch!=null&&g.maxPitch!=null&&g.minPitch>g.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(g.minPitch!=null&&g.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(g.maxPitch!=null&&g.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(g.antialias&&a.isSafariWithAntialiasingBug(a.window)&&(g.antialias=!1,a.warnOnce("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new _l(g.minZoom,g.maxZoom,g.minPitch,g.maxPitch,g.renderWorldCopies),g),this._interactive=g.interactive,this._minTileCacheSize=g.minTileCacheSize,this._maxTileCacheSize=g.maxTileCacheSize,this._failIfMajorPerformanceCaveat=g.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=g.preserveDrawingBuffer,this._antialias=g.antialias,this._useWebGL2=g.useWebGL2,this._trackResize=g.trackResize,this._bearingSnap=g.bearingSnap,this._refreshExpiredTiles=g.refreshExpiredTiles,this._fadeDuration=g.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=g.crossSourceCollisions,this._collectResourceTiming=g.collectResourceTiming,this._optimizeForTerrain=g.optimizeForTerrain,this._language=this._parseLanguage(g.language),this._worldview=g.worldview,this._renderTaskQueue=new Tu,this._domRenderTaskQueue=new Tu,this._controls=[],this._markers=[],this._popups=[],this._mapId=a.uniqueId(),this._locale=a.extend({},Bs,g.locale),this._clickTolerance=g.clickTolerance,this._cooperativeGestures=g.cooperativeGestures,this._performanceMetricsCollection=g.performanceMetricsCollection,this._containerWidth=0,this._containerHeight=0,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new bc(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._requestManager=new a.RequestManager(g.transformRequest,g.accessToken,g.testMode),this._silenceAuthErrors=!!g.testMode,typeof g.container=="string"){if(this._container=a.window.document.getElementById(g.container),!this._container)throw new Error(`Container '${g.container}' not found.`)}else{if(!(g.container instanceof a.window.HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=g.container}if(this._container.childNodes.length>0&&a.warnOnce("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),g.maxBounds&&this.setMaxBounds(g.maxBounds),a.bindAll(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");this.on("move",(()=>this._update(!1))),this.on("moveend",(()=>this._update(!1))),this.on("zoom",(()=>this._update(!0))),a.window!==void 0&&(a.window.addEventListener("online",this._onWindowOnline,!1),a.window.addEventListener("resize",this._onWindowResize,!1),a.window.addEventListener("orientationchange",this._onWindowResize,!1),a.window.addEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.addEventListener("visibilitychange",this._onVisibilityChange,!1)),this.handlers=new So(this,g),this._localFontFamily=g.localFontFamily,this._localIdeographFontFamily=g.localIdeographFontFamily,g.style&&this.setStyle(g.style,{localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),g.projection&&this.setProjection(g.projection),this._hash=g.hash&&new _u(typeof g.hash=="string"&&g.hash||void 0).addTo(this),this._hash&&this._hash._onHashChange()||(this.jumpTo({center:g.center,zoom:g.zoom,bearing:g.bearing,pitch:g.pitch}),g.bounds&&(this.resize(),this.fitBounds(g.bounds,a.extend({},g.fitBoundsOptions,{duration:0})))),this.resize(),g.attributionControl&&this.addControl(new Ft({customAttribution:g.customAttribution})),this._logoControl=new vc,this.addControl(this._logoControl,g.logoPosition),this.on("style.load",(()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet)})),this.on("data",(o=>{this._update(o.dataType==="style"),this.fire(new a.Event(`${o.dataType}data`,o))})),this.on("dataloading",(o=>{this.fire(new a.Event(`${o.dataType}dataloading`,o))}))}_getMapId(){return this._mapId}addControl(g,o){if(o===void 0&&(o=g.getDefaultPosition?g.getDefaultPosition():"top-right"),!g||!g.onAdd)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const h=g.onAdd(this);this._controls.push(g);const _=this._controlPositions[o];return o.indexOf("bottom")!==-1?_.insertBefore(h,_.firstChild):_.appendChild(h),this}removeControl(g){if(!g||!g.onRemove)return this.fire(new a.ErrorEvent(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(g);return o>-1&&this._controls.splice(o,1),g.onRemove(this),this}hasControl(g){return this._controls.indexOf(g)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(g){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new a.Event("movestart",g)).fire(new a.Event("move",g)),this.fire(new a.Event("resize",g)),o&&this.fire(new a.Event("moveend",g)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(g){return this.transform.setMaxBounds(a.LngLatBounds.convert(g)),this._update()}setMinZoom(g){if((g=g??-2)>=-2&&g<=this.transform.maxZoom)return this.transform.minZoom=g,this._update(),this.getZoom()<g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(g){if((g=g??22)>=this.transform.minZoom)return this.transform.maxZoom=g,this._update(),this.getZoom()>g?this.setZoom(g):this.fire(new a.Event("zoomstart")).fire(new a.Event("zoom")).fire(new a.Event("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(g){if((g=g??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(g>=0&&g<=this.transform.maxPitch)return this.transform.minPitch=g,this._update(),this.getPitch()<g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(g){if((g=g??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(g>=this.transform.minPitch)return this.transform.maxPitch=g,this._update(),this.getPitch()>g?this.setPitch(g):this.fire(new a.Event("pitchstart")).fire(new a.Event("pitch")).fire(new a.Event("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(g){return this.transform.renderWorldCopies=g,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(g){return g==="auto"?a.window.navigator.language:Array.isArray(g)?g.length===0?void 0:g.map((o=>o==="auto"?a.window.navigator.language:o)):g}setLanguage(g){const o=this._parseLanguage(g);if(!this.style||o===this._language)return this;this._language=o,this.style._reloadSources();for(const h of this._controls)h._setLanguage&&h._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(g){return this.style&&g!==this._worldview?(this._worldview=g,this.style._reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(g){return this._lazyInitEmptyStyle(),g?typeof g=="string"&&(g={name:g}):g=null,this._useExplicitProjection=!!g,this._prioritizeAndUpdateProjection(g,this.style.stylesheet?this.style.stylesheet.projection:null)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const g=this.transform,o=g.projection.name;let h;o==="globe"&&g.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?(g.setMercatorFromTransition(),h=!0):o==="mercator"&&g.zoom<a.GLOBE_ZOOM_THRESHOLD_MAX&&(g.setProjection({name:"globe"}),h=!0),h&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate())}_prioritizeAndUpdateProjection(g,o){return this._updateProjection(g||o||{name:"mercator"})}_updateProjection(g){let o;if(o=g.name==="globe"&&this.transform.zoom>=a.GLOBE_ZOOM_THRESHOLD_MAX?this.transform.setMercatorFromTransition():this.transform.setProjection(g),this.style.applyProjectionUpdate(),o){this.painter.clearBackgroundTiles();for(const h in this.style._sourceCaches)this.style._sourceCaches[h].clearTiles();this._update(!0),this._forceMarkerAndPopupUpdate(!0)}return this}project(g){return this.transform.locationPoint3D(a.LngLat.convert(g))}unproject(g){return this.transform.pointLocation3D(a.Point.convert(g))}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(g,o,h){if(g==="mouseenter"||g==="mouseover"){let _=!1;const T=N=>{const D=o.filter((G=>this.getLayer(G))),B=D.length?this.queryRenderedFeatures(N.point,{layers:D}):[];B.length?_||(_=!0,h.call(this,new Ri(g,this,N.originalEvent,{features:B}))):_=!1},C=()=>{_=!1};return{layers:new Set(o),listener:h,delegates:{mousemove:T,mouseout:C}}}if(g==="mouseleave"||g==="mouseout"){let _=!1;const T=N=>{const D=o.filter((B=>this.getLayer(B)));(D.length?this.queryRenderedFeatures(N.point,{layers:D}):[]).length?_=!0:_&&(_=!1,h.call(this,new Ri(g,this,N.originalEvent)))},C=N=>{_&&(_=!1,h.call(this,new Ri(g,this,N.originalEvent)))};return{layers:new Set(o),listener:h,delegates:{mousemove:T,mouseout:C}}}{const _=T=>{const C=o.filter((D=>this.getLayer(D))),N=C.length?this.queryRenderedFeatures(T.point,{layers:C}):[];N.length&&(T.features=N,h.call(this,T),delete T.features)};return{layers:new Set(o),listener:h,delegates:{[g]:_}}}}on(g,o,h){if(h===void 0)return super.on(g,o);Array.isArray(o)||(o=[o]);const _=this._createDelegatedListener(g,o,h);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[g]=this._delegatedListeners[g]||[],this._delegatedListeners[g].push(_);for(const T in _.delegates)this.on(T,_.delegates[T]);return this}once(g,o,h){if(h===void 0)return super.once(g,o);Array.isArray(o)||(o=[o]);const _=this._createDelegatedListener(g,o,h);for(const T in _.delegates)this.once(T,_.delegates[T]);return this}off(g,o,h){if(h===void 0)return super.off(g,o);o=new Set(Array.isArray(o)?o:[o]);const _=(C,N)=>{if(C.size!==N.size)return!1;for(const D of C)if(!N.has(D))return!1;return!0},T=this._delegatedListeners?this._delegatedListeners[g]:void 0;return T&&(C=>{for(let N=0;N<C.length;N++){const D=C[N];if(D.listener===h&&_(D.layers,o)){for(const B in D.delegates)this.off(B,D.delegates[B]);return C.splice(N,1),this}}})(T),this}queryRenderedFeatures(g,o){return this.style?(o!==void 0||g===void 0||g instanceof a.Point||Array.isArray(g)||(o=g,g=void 0),this.style.queryRenderedFeatures(g=g||[[0,0],[this.transform.width,this.transform.height]],o=o||{},this.transform)):[]}querySourceFeatures(g,o){return this.style.querySourceFeatures(g,o)}isPointOnSurface(g){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&a.warnOnce(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(a.Point.convert(g))}setStyle(g,o){return(o=a.extend({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o)).diff!==!1&&o.localIdeographFontFamily===this._localIdeographFontFamily&&o.localFontFamily===this._localFontFamily&&this.style&&g?(this._diffStyle(g,o),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(g,o))}_getUIString(g){const o=this._locale[g];if(o==null)throw new Error(`Missing UI string '${g}'`);return o}_updateStyle(g,o){return this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),g&&(this.style=new ro(this,o||{}),this.style.setEventedParent(this,{style:this.style}),typeof g=="string"?this.style.loadURL(g):this.style.loadJSON(g)),this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new ro(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}_diffStyle(g,o){if(typeof g=="string"){const h=this._requestManager.normalizeStyleURL(g),_=this._requestManager.transformRequest(h,a.ResourceType.Style);a.getJSON(_,((T,C)=>{T?this.fire(new a.ErrorEvent(T)):C&&this._updateDiff(C,o)}))}else typeof g=="object"&&this._updateDiff(g,o)}_updateDiff(g,o){try{this.style.setState(g)&&this._update(!0)}catch(h){a.warnOnce(`Unable to perform style diff: ${h.message||h.error||h}.  Rebuilding the style from scratch.`),this._updateStyle(g,o)}}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(a.warnOnce("There is no style added to the map."),!1)}addSource(g,o){return this._lazyInitEmptyStyle(),this.style.addSource(g,o),this._update(!0)}isSourceLoaded(g){return!!this.style&&this.style._isSourceCacheLoaded(g)}areTilesLoaded(){const g=this.style&&this.style._sourceCaches;for(const o in g){const h=g[o]._tiles;for(const _ in h){const T=h[_];if(T.state!=="loaded"&&T.state!=="errored")return!1}}return!0}addSourceType(g,o,h){this._lazyInitEmptyStyle(),this.style.addSourceType(g,o,h)}removeSource(g){return this.style.removeSource(g),this._updateTerrain(),this._update(!0)}getSource(g){return this.style.getSource(g)}addImage(g,o,{pixelRatio:h=1,sdf:_=!1,stretchX:T,stretchY:C,content:N}={}){if(this._lazyInitEmptyStyle(),o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap){const{width:D,height:B,data:G}=a.exported.getImageData(o);this.style.addImage(g,{data:new a.RGBAImage({width:D,height:B},G),pixelRatio:h,stretchX:T,stretchY:C,content:N,sdf:_,version:0})}else if(o.width===void 0||o.height===void 0)this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:D,height:B}=o,G=o;this.style.addImage(g,{data:new a.RGBAImage({width:D,height:B},new Uint8Array(G.data)),pixelRatio:h,stretchX:T,stretchY:C,content:N,sdf:_,version:0,userImage:G}),G.onAdd&&G.onAdd(this,g)}}updateImage(g,o){const h=this.style.getImage(g);if(!h)return void this.fire(new a.ErrorEvent(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const _=o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap?a.exported.getImageData(o):o,{width:T,height:C}=_;T!==void 0&&C!==void 0?T===h.data.width&&C===h.data.height?(h.data.replace(_.data,!(o instanceof a.window.HTMLImageElement||a.window.ImageBitmap&&o instanceof a.window.ImageBitmap)),this.style.updateImage(g,h)):this.fire(new a.ErrorEvent(new Error(`The width and height of the updated image (${T}, ${C})
                must be that same as the previous version of the image
                (${h.data.width}, ${h.data.height})`))):this.fire(new a.ErrorEvent(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")))}hasImage(g){return g?!!this.style.getImage(g):(this.fire(new a.ErrorEvent(new Error("Missing required image id"))),!1)}removeImage(g){this.style.removeImage(g)}loadImage(g,o){a.getImage(this._requestManager.transformRequest(g,a.ResourceType.Image),((h,_)=>{o(h,_ instanceof a.window.HTMLImageElement?a.exported.getImageData(_):_)}))}listImages(){return this.style.listImages()}addLayer(g,o){return this._lazyInitEmptyStyle(),this.style.addLayer(g,o),this._update(!0)}moveLayer(g,o){return this.style.moveLayer(g,o),this._update(!0)}removeLayer(g){return this.style.removeLayer(g),this._update(!0)}getLayer(g){return this.style.getLayer(g)}setLayerZoomRange(g,o,h){return this.style.setLayerZoomRange(g,o,h),this._update(!0)}setFilter(g,o,h={}){return this.style.setFilter(g,o,h),this._update(!0)}getFilter(g){return this.style.getFilter(g)}setPaintProperty(g,o,h,_={}){return this.style.setPaintProperty(g,o,h,_),this._update(!0)}getPaintProperty(g,o){return this.style.getPaintProperty(g,o)}setLayoutProperty(g,o,h,_={}){return this.style.setLayoutProperty(g,o,h,_),this._update(!0)}getLayoutProperty(g,o){return this.style.getLayoutProperty(g,o)}setLight(g,o={}){return this._lazyInitEmptyStyle(),this.style.setLight(g,o),this._update(!0)}getLight(){return this.style.getLight()}setTerrain(g){return this._lazyInitEmptyStyle(),!g&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(g),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(g){return this._lazyInitEmptyStyle(),this.style.setFog(g),this._update(!0)}getFog(){return this.style?this.style.getFog():null}_queryFogOpacity(g){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(a.LngLat.convert(g),this.transform):0}setFeatureState(g,o){return this.style.setFeatureState(g,o),this._update()}removeFeatureState(g,o){return this.style.removeFeatureState(g,o),this._update()}getFeatureState(g){return this.style.getFeatureState(g)}_updateContainerDimensions(){if(!this._container)return;const g=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let h,_,T,C=this._container;for(;C&&(!_||!T);){const N=a.window.getComputedStyle(C).transform;N&&N!=="none"&&(h=N.match(/matrix.*\((.+)\)/)[1].split(", "),h[0]&&h[0]!=="0"&&h[0]!=="1"&&(_=h[0]),h[3]&&h[3]!=="0"&&h[3]!=="1"&&(T=h[3])),C=C.parentElement}this._containerWidth=_?Math.abs(g/_):g,this._containerHeight=T?Math.abs(o/T):o}_detectMissingCSS(){a.window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&a.warnOnce("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const g=this._container;g.classList.add("mapboxgl-map"),(this._missingCSSCanary=O("div","mapboxgl-canary",g)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=O("div","mapboxgl-canvas-container",g);this._interactive&&o.classList.add("mapboxgl-interactive"),this._canvas=O("canvas","mapboxgl-canvas",o),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("tabindex","0"),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const h=this._controlContainer=O("div","mapboxgl-control-container",g),_=this._controlPositions={};["top-left","top-right","bottom-left","bottom-right"].forEach((T=>{_[T]=O("div",`mapboxgl-ctrl-${T}`,h)})),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(g,o){const h=a.exported.devicePixelRatio||1;this._canvas.width=h*Math.ceil(g),this._canvas.height=h*Math.ceil(o),this._canvas.style.width=`${g}px`,this._canvas.style.height=`${o}px`}_addMarker(g){this._markers.push(g)}_removeMarker(g){const o=this._markers.indexOf(g);o!==-1&&this._markers.splice(o,1)}_addPopup(g){this._popups.push(g)}_removePopup(g){const o=this._popups.indexOf(g);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const g=a.extend({},M.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._useWebGL2&&this._canvas.getContext("webgl2",g),h=o||this._canvas.getContext("webgl",g)||this._canvas.getContext("experimental-webgl",g);h?(this._useWebGL2&&!o&&a.warnOnce("Failed to create WebGL 2 context. Using WebGL 1."),a.storeAuthState(h,!0),this.painter=new yl(h,this.transform,!!o),this.on("data",(_=>{_.dataType==="source"&&this.painter.setTileLoadedFlag(!0)})),a.exported$1.testSupport(h)):this.fire(new a.ErrorEvent(new Error("Failed to initialize WebGL")))}_contextLost(g){g.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new a.Event("webglcontextlost",{originalEvent:g}))}_contextRestored(g){this._setupPainter(),this.resize(),this._update(),this.fire(new a.Event("webglcontextrestored",{originalEvent:g}))}_onMapScroll(g){if(g.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}_update(g){return this.style?(this._styleDirty=this._styleDirty||g,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(g){return this._update(),this._renderTaskQueue.add(g)}_cancelRenderFrame(g){this._renderTaskQueue.remove(g)}_requestDomTask(g){!this.loaded()||this.loaded()&&!this.isMoving()?g():this._domRenderTaskQueue.add(g)}_render(g){let o;const h=this.painter.context.extTimerQuery,_=a.exported.now();if(this.listens("gpu-timing-frame")&&(o=h.createQueryEXT(),h.beginQueryEXT(h.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],a.window.performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],a.window.performance.now())),this._renderTaskQueue.run(g),this._domRenderTaskQueue.run(g),this._removed)return;this._updateProjectionTransition();const T=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const D=this.transform.zoom,B=this.transform.pitch,G=a.exported.now(),$=new a.EvaluationParameters(D,{now:G,fadeDuration:T,pitch:B,transition:this.style.getTransition()});this.style.update($)}this.style&&this.style.fog&&this.style.fog.hasTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;if(this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(_),this.style._updateSources(this.transform),this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(_),this._placementDirty=this.style&&this.style._updatePlacement(this.painter.transform,this.showCollisionBoxes,T,this._crossSourceCollisions),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showTerrainWireframe:this.showTerrainWireframe,showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:T,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new a.Event("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,this.fire(new a.Event("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const D=a.exported.now()-_;h.endQueryEXT(h.TIME_ELAPSED_EXT,o),setTimeout((()=>{const B=h.getQueryObjectEXT(o,h.QUERY_RESULT_EXT)/1e6;h.deleteQueryEXT(o),this.fire(new a.Event("gpu-timing-frame",{cpuTime:D,gpuTime:B})),a.window.performance.mark("frame-gpu",{startTime:_,detail:{gpuTime:B}})}),50)}if(this.listens("gpu-timing-layer")){const D=this.painter.collectGpuTimers();setTimeout((()=>{const B=this.painter.queryGpuTimers(D);this.fire(new a.Event("gpu-timing-layer",{layerTimes:B}))}),50)}if(this.listens("gpu-timing-deferred-render")){const D=this.painter.collectDeferredRenderGpuQueries();setTimeout((()=>{const B=this.painter.queryGpuTimeDeferredRender(D);this.fire(new a.Event("gpu-timing-deferred-render",{gpuTime:B}))}),50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(N||this._repaint)this.triggerRepaint();else{const D=!this.isMoving()&&this.loaded();if(D&&(C=this._updateAverageElevation(_,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),D&&(this.fire(new a.Event("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const B=this._calculateSpeedIndex();this.fire(new a.Event("speedindexcompleted",{speedIndex:B})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,a.LivePerformanceUtils.mark(a.PerformanceMarkers.fullLoad),this._performanceMetricsCollection&&a.postPerformanceEvent(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(g){for(const o of this._markers)g&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!g||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(g,o=!1){const h=_=>(this.transform.averageElevation=_,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&h(0);if((o||g-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(g)){const _=this.transform.averageElevation;let T=this.transform.sampleAverageElevation(),C=!1;this.transform.elevation&&(C=this.transform.elevation.exaggeration()!==this._averageElevationExaggeration,this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(T)?T=0:this._averageElevationLastSampledAt=g;const N=Math.abs(_-T);if(N>1){if(this._isInitialLoad||C)return this._averageElevation.jumpTo(T),h(T);this._averageElevation.easeTo(T,g,300)}else if(N>1e-4)return this._averageElevation.jumpTo(T),h(T)}return!!this._averageElevation.isEasing(g)&&h(this._averageElevation.getValue(g))}_authenticate(){a.getMapSessionAPI(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(g=>{if(g&&(g.message===a.AUTH_ERR_MSG||g.status===401)){const o=this.painter.context.gl;a.storeAuthState(o,!1),this._logoControl instanceof vc&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new a.ErrorEvent(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}})),a.postMapLoadEvent(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,(()=>{}))}_updateTerrain(){const g=this._isDragging();this.painter.updateTerrain(this.style,g)}_calculateSpeedIndex(){const g=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const h=this.painter.context.gl,_=h.createFramebuffer();function T(C){h.framebufferTexture2D(h.FRAMEBUFFER,h.COLOR_ATTACHMENT0,h.TEXTURE_2D,C,0);const N=new Uint8Array(h.drawingBufferWidth*h.drawingBufferHeight*4);return h.readPixels(0,0,h.drawingBufferWidth,h.drawingBufferHeight,h.RGBA,h.UNSIGNED_BYTE,N),N}return h.bindFramebuffer(h.FRAMEBUFFER,_),this._canvasPixelComparison(T(g),o.canvasCopies.map(T),o.timeStamps)}_canvasPixelComparison(g,o,h){let _=h[1]-h[0];const T=g.length/4;for(let C=0;C<o.length;C++){const N=o[C];let D=0;for(let B=0;B<N.length;B+=4)N[B]===g[B]&&N[B+1]===g[B+1]&&N[B+2]===g[B+2]&&N[B+3]===g[B+3]&&(D+=1);_+=(h[C+2]-h[C+1])*(1-D/T)}return _}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),a.window!==void 0&&(a.window.removeEventListener("resize",this._onWindowResize,!1),a.window.removeEventListener("orientationchange",this._onWindowResize,!1),a.window.removeEventListener("webkitfullscreenchange",this._onWindowResize,!1),a.window.removeEventListener("online",this._onWindowOnline,!1),a.window.removeEventListener("visibilitychange",this._onVisibilityChange,!1));const g=this.painter.context.gl.getExtension("WEBGL_lose_context");g&&g.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),a.removeAuthState(this.painter.context.gl),this._removed=!0,this.fire(new a.Event("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(g){this._renderNextFrame=this._renderNextFrame||g,this.style&&!this._frame&&(this._frame=a.exported.frame((o=>{const h=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,h&&this._render(o)})))}_preloadTiles(g){const o=this.style?Object.values(this.style._sourceCaches):[];return a.asyncAll(o,((h,_)=>h._preloadTiles(g,_)),(()=>{this.triggerRepaint()})),this}_onWindowOnline(){this._update()}_onWindowResize(g){this._trackResize&&this.resize({originalEvent:g})._update()}_onVisibilityChange(){a.window.document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(g){this._showTileBoundaries!==g&&(this._showTileBoundaries=g,this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(g){this._showTerrainWireframe!==g&&(this._showTerrainWireframe=g,this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(g){this._speedIndexTiming!==g&&(this._speedIndexTiming=g,this._update())}get showPadding(){return!!this._showPadding}set showPadding(g){this._showPadding!==g&&(this._showPadding=g,this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(g){this._showCollisionBoxes!==g&&(this._showCollisionBoxes=g,g?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(g){this._showOverdrawInspector!==g&&(this._showOverdrawInspector=g,this._update())}get repaint(){return!!this._repaint}set repaint(g){this._repaint!==g&&(this._repaint=g,this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(g){this._vertices=g,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(g){this._showTileAABBs!==g&&(this._showTileAABBs=g,g&&this._update())}_setCacheLimits(g,o){a.setCacheLimits(g,o)}get version(){return a.version}},NavigationControl:class{constructor(g){this.options=a.extend({},El,g),this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this.options.showZoom&&(a.bindAll(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",(o=>{this._map&&this._map.zoomIn({},{originalEvent:o})})),O("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",(o=>{this._map&&this._map.zoomOut({},{originalEvent:o})})),O("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(a.bindAll(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",(o=>{const h=this._map;h&&(this.options.visualizePitch?h.resetNorthPitch({},{originalEvent:o}):h.resetNorth({},{originalEvent:o}))})),this._compassIcon=O("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const g=this._map;if(!g)return;const o=g.getZoom(),h=o===g.getMaxZoom(),_=o===g.getMinZoom();this._zoomInButton.disabled=h,this._zoomOutButton.disabled=_,this._zoomInButton.setAttribute("aria-disabled",h.toString()),this._zoomOutButton.setAttribute("aria-disabled",_.toString())}_rotateCompassArrow(){const g=this._map;if(!g)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(g.transform.pitch*(Math.PI/180)),.5)}) rotateX(${g.transform.pitch}deg) rotateZ(${g.transform.angle*(180/Math.PI)}deg)`:`rotate(${g.transform.angle*(180/Math.PI)}deg)`;g._requestDomTask((()=>{this._compassIcon&&(this._compassIcon.style.transform=o)}))}onAdd(g){return this._map=g,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),g.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&g.on("pitch",this._rotateCompassArrow),g.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new fa(g,this._compass,this.options.visualizePitch)),this._container}onRemove(){const g=this._map;g&&(this._container.remove(),this.options.showZoom&&g.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&g.off("pitch",this._rotateCompassArrow),g.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(g,o){const h=O("button",g,this._container);return h.type="button",h.addEventListener("click",o),h}_setButtonTitle(g,o){if(!this._map)return;const h=this._map._getUIString(`NavigationControl.${o}`);g.setAttribute("aria-label",h),g.firstElementChild&&g.firstElementChild.setAttribute("title",h)}},GeolocateControl:class extends a.Evented{constructor(g){super(),this.options=a.extend({geolocation:a.window.navigator.geolocation},Eo,g),a.bindAll(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=gr(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(g){return this._map=g,this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(g){const o=(h=!!this.options.geolocation)=>{this._supportsGeolocation=h,g(h)};this._supportsGeolocation!==void 0?g(this._supportsGeolocation):a.window.navigator.permissions!==void 0?a.window.navigator.permissions.query({name:"geolocation"}).then((h=>o(h.state!=="denied"))).catch((()=>o())):o()}_isOutOfMapMaxBounds(g){const o=this._map.getMaxBounds(),h=g.coords;return!!o&&(h.longitude<o.getWest()||h.longitude>o.getEast()||h.latitude<o.getSouth()||h.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(g){if(this._map){if(this._isOutOfMapMaxBounds(g))return this._setErrorState(),this.fire(new a.Event("outofmaxbounds",g)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=g,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(g),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(g),this.options.showUserLocation&&this._dotElement.classList.remove("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("geolocate",g)),this._finish()}}_updateCamera(g){const o=new a.LngLat(g.coords.longitude,g.coords.latitude),h=g.coords.accuracy,_=this._map.getBearing(),T=a.extend({bearing:_},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(h),T,{geolocateSource:!0})}_updateMarker(g){if(g){const o=new a.LngLat(g.coords.longitude,g.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=g.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const g=this._map.transform,o=a.mercatorZfromAltitude(1,g._center.lat)*g.worldSize,h=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${h}px`,this._circleElement.style.height=`${h}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._dotElement.classList.add("mapboxgl-user-location-show-heading")):(this._dotElement.classList.remove("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(g){if(this._map){if(this.options.trackUserLocation)if(g.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(g.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._dotElement.classList.add("mapboxgl-user-location-dot-stale"),this.fire(new a.Event("error",g)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(g){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",(o=>o.preventDefault())),this._geolocateButton=O("button","mapboxgl-ctrl-geolocate",this._container),O("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",g===!1){a.warnOnce("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=O("div","mapboxgl-user-location"),this._dotElement.appendChild(O("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(O("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Ot({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=O("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Ot({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",(o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new a.Event("trackuserlocationend")))}))}}_onDeviceOrientation(g){this._userLocationDotMarker&&(g.webkitCompassHeading?this._heading=g.webkitCompassHeading:g.absolute===!0&&(this._heading=-1*g.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return a.warnOnce("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new a.Event("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new a.Event("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new a.Event("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let g;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(g={maximumAge:6e5,timeout:0},this._noTimeout=!0):(g=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,g),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const g=()=>{a.window.addEventListener("ondeviceorientationabsolute"in a.window?"deviceorientationabsolute":"deviceorientation",this._onDeviceOrientation)};a.window.DeviceMotionEvent!==void 0&&typeof a.window.DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then((o=>{o==="granted"&&g()})).catch(console.error):g()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),a.window.removeEventListener("deviceorientation",this._onDeviceOrientation),a.window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:Ft,ScaleControl:class{constructor(g){this.options=a.extend({},pa,g),this._isNumberFormatSupported=(function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}})(),a.bindAll(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const g=this.options.maxWidth||100,o=this._map,h=o._containerHeight/2,_=o._containerWidth/2-g/2,T=o.unproject([_,h]),C=o.unproject([_+g,h]),N=T.distanceTo(C);if(this.options.unit==="imperial"){const D=3.2808*N;D>5280?this._setScale(g,D/5280,"mile"):this._setScale(g,D,"foot")}else this.options.unit==="nautical"?this._setScale(g,N/1852,"nautical-mile"):N>=1e3?this._setScale(g,N/1e3,"kilometer"):this._setScale(g,N,"meter")}_setScale(g,o,h){this._map._requestDomTask((()=>{const _=(function(C){const N=Math.pow(10,`${Math.floor(C)}`.length-1);let D=C/N;return D=D>=10?10:D>=5?5:D>=3?3:D>=2?2:D>=1?1:(function(B){const G=Math.pow(10,Math.ceil(-Math.log(B)/Math.LN10));return Math.round(B*G)/G})(D),N*D})(o),T=_/o;this._container.innerHTML=this._isNumberFormatSupported&&h!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:h}).format(_):`${_}&nbsp;${Sd[h]}`,this._container.style.width=g*T+"px"}))}onAdd(g){return this._map=g,this._language=g.getLanguage(),this._container=O("div","mapboxgl-ctrl mapboxgl-ctrl-scale",g.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(g){this._language=g,this._update()}setUnit(g){this.options.unit=g,this._update()}},FullscreenControl:class{constructor(g){this._fullscreen=!1,g&&g.container&&(g.container instanceof a.window.HTMLElement?this._container=g.container:a.warnOnce("Full screen control 'container' must be a DOM element.")),a.bindAll(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in a.window.document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in a.window.document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(g){return this._map=g,this._container||(this._container=this._map.getContainer()),this._controlContainer=O("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",a.warnOnce("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,a.window.document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!a.window.document.fullscreenEnabled&&!a.window.document.webkitFullscreenEnabled)}_setupUI(){const g=this._fullscreenButton=O("button","mapboxgl-ctrl-fullscreen",this._controlContainer);O("span","mapboxgl-ctrl-icon",g).setAttribute("aria-hidden","true"),g.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),a.window.document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const g=this._getTitle();this._fullscreenButton.setAttribute("aria-label",g),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",g)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(a.window.document.fullscreenElement||a.window.document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?a.window.document.exitFullscreen?a.window.document.exitFullscreen():a.window.document.webkitCancelFullScreen&&a.window.document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends a.Evented{constructor(g){super(),this.options=a.extend(Object.create(Fa),g),a.bindAll(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(g&&g.className?g.className.trim().split(/\s+/):[])}addTo(g){return this._map&&this.remove(),this._map=g,this.options.closeOnClick&&g.on("preclick",this._onClose),this.options.closeOnMove&&g.on("move",this._onClose),g.on("remove",this.remove),this._update(),g._addPopup(this),this._focusFirstElement(),this._trackPointer?(g.on("mousemove",this._onMouseEvent),g.on("mouseup",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")):g.on("move",this._update),this.fire(new a.Event("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const g=this._map;return g&&(g.off("move",this._update),g.off("move",this._onClose),g.off("preclick",this._onClose),g.off("click",this._onClose),g.off("remove",this.remove),g.off("mousemove",this._onMouseEvent),g.off("mouseup",this._onMouseEvent),g.off("drag",this._onMouseEvent),g._canvasContainer&&g._canvasContainer.classList.remove("mapboxgl-track-pointer"),g._removePopup(this),this._map=void 0),this.fire(new a.Event("close")),this}getLngLat(){return this._lngLat}setLngLat(g){this._lngLat=a.LngLat.convert(g),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const g=this._map;return g&&(g.off("move",this._update),g.on("mousemove",this._onMouseEvent),g.on("drag",this._onMouseEvent),g._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(g){return this.setDOMContent(a.window.document.createTextNode(g))}setHTML(g){const o=a.window.document.createDocumentFragment(),h=a.window.document.createElement("body");let _;for(h.innerHTML=g;_=h.firstChild,_;)o.appendChild(_);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(g){return this.options.maxWidth=g,this._update(),this}setDOMContent(g){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=O("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(g),this.options.closeButton){const h=this._closeButton=O("button","mapboxgl-popup-close-button",o);h.type="button",h.setAttribute("aria-label","Close popup"),h.setAttribute("aria-hidden","true"),h.innerHTML="&#215;",h.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(g){return this._classList.add(g),this._updateClassList(),this}removeClassName(g){return this._classList.delete(g),this._updateClassList(),this}setOffset(g){return this.options.offset=g,this._update(),this}toggleClassName(g){let o;return this._classList.delete(g)?o=!1:(this._classList.add(g),o=!0),this._updateClassList(),o}_onMouseEvent(g){this._update(g.point)}_getAnchor(g){if(this.options.anchor)return this.options.anchor;const o=this._map,h=this._container,_=this._pos;if(!o||!h||!_)return"bottom";const T=h.offsetWidth,C=h.offsetHeight,N=_.x<T/2,D=_.x>o.transform.width-T/2;if(_.y+g<C)return N?"top-left":D?"top-right":"top";if(_.y>o.transform.height-C){if(N)return"bottom-left";if(D)return"bottom-right"}return N?"left":D?"right":"bottom"}_updateClassList(){const g=this._container;if(!g)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),g.className=o.join(" ")}_update(g){const o=this._map,h=this._content;if(!o||!this._lngLat&&!this._trackPointer||!h)return;let _=this._container;if(_||(_=this._container=O("div","mapboxgl-popup",o.getContainer()),this._tip=O("div","mapboxgl-popup-tip",_),_.appendChild(h)),this.options.maxWidth&&_.style.maxWidth!==this.options.maxWidth&&(_.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=Tl(this._lngLat,this._pos,o.transform)),!this._trackPointer||g){const T=this._pos=this._trackPointer&&g?g:o.project(this._lngLat),C=Su(this.options.offset),N=this._anchor=this._getAnchor(C.y),D=Su(this.options.offset,N),B=T.add(D).round();o._requestDomTask((()=>{this._container&&N&&(this._container.style.transform=`${Sl[N]} translate(${B.x}px,${B.y}px)`)}))}if(!this._marker&&o._showingGlobe()){const T=a.isLngLatBehindGlobe(o.transform,this._lngLat)?0:1;this._setOpacity(T)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const g=this._container.querySelector(wc);g&&g.focus()}_onClose(){this.remove()}_setOpacity(g){this._container&&(this._container.style.opacity=`${g}`),this._content&&(this._content.style.pointerEvents=g?"auto":"none")}},Marker:Ot,Style:ro,LngLat:a.LngLat,LngLatBounds:a.LngLatBounds,Point:a.Point,MercatorCoordinate:a.MercatorCoordinate,FreeCameraOptions:la,Evented:a.Evented,config:a.config,prewarm:function(){ll().acquire(xo)},clearPrewarmedResources:function(){const g=os;g&&(g.isPreloaded()&&g.numActive()===1?(g.release(xo),os=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},get accessToken(){return a.config.ACCESS_TOKEN},set accessToken(g){a.config.ACCESS_TOKEN=g},get baseApiUrl(){return a.config.API_URL},set baseApiUrl(g){a.config.API_URL=g},get workerCount(){return wi.workerCount},set workerCount(g){wi.workerCount=g},get maxParallelImageRequests(){return a.config.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(g){a.config.MAX_PARALLEL_IMAGE_REQUESTS=g},clearStorage(g){a.clearTileCache(g)},workerUrl:"",workerClass:null,setNow:a.exported.setNow,restoreNow:a.exported.restoreNow};return Va}));var b=m;return b}))})(Dx)),Dx.exports}var P3=KW();const zl=xb(P3),YW=UI({__proto__:null,default:zl},[P3]),ZA={lat:21.038,lng:105.782},GT=[{id:"A1",name:"Building A1",nameVi:"A1",type:"building",lat:21.039716029400708,lng:105.7832080286106,description:"Ta nh A1 - Khu ging ng chnh",descriptionEn:"Building A1 - Main lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A2",name:"Building A2",nameVi:"A2",type:"building",lat:21.039241956752605,lng:105.78308893318581,description:"Ta nh A2 - Khu ging ng",descriptionEn:"Building A2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A3",name:"Building A3",nameVi:"A3",type:"building",lat:21.039111478563356,lng:105.78279039415679,description:"Ta nh A3 - Khu ging ng",descriptionEn:"Building A3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A4",name:"Building A4",nameVi:"A4",type:"building",lat:21.039805,lng:105.782784,description:"Ta nh A4 - Khu ging ng",descriptionEn:"Building A4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A5",name:"Building A5",nameVi:"A5",type:"building",lat:21.039853372191985,lng:105.78296008714364,description:"Ta nh A5 - Khu ging ng",descriptionEn:"Building A5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A6",name:"Building A6",nameVi:"A6",type:"building",lat:21.040221833014513,lng:105.78293897060121,description:"Ta nh A6 - Khu ging ng",descriptionEn:"Building A6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A7",name:"Building A7",nameVi:"A7",type:"building",lat:21.039954182925683,lng:105.78157815521064,description:"Ta nh A7 - Khu ging ng",descriptionEn:"Building A7 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"A8",name:"Building A8",nameVi:"A8",type:"building",lat:21.040014,lng:105.781236,description:"Ta nh A8 - Khu ging ng",descriptionEn:"Building A8 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B1",name:"Building B1",nameVi:"B1",type:"building",lat:21.03806856546437,lng:105.78122336937986,description:"Ta nh B1 - Khu ging ng",descriptionEn:"Building B1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B2",name:"Building B2",nameVi:"B2",type:"building",lat:21.037537005578642,lng:105.78243174427888,description:"Ta nh B2 - Khu ging ng",descriptionEn:"Building B2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B3",name:"Building B3",nameVi:"B3",type:"building",lat:21.03842964478416,lng:105.78202247538536,description:"Ta nh B3 - Khu ging ng",descriptionEn:"Building B3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"B4",name:"Building B4",nameVi:"B4",type:"building",lat:21.036848509166973,lng:105.78278135131,description:"Ta nh B4 - Khu ging ng",descriptionEn:"Building B4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C1",name:"Building C1",nameVi:"C1",type:"building",lat:21.039312040918517,lng:105.7816554858685,description:"Ta nh C1 - Khu ging ng",descriptionEn:"Building C1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C1T",name:"Building C1T",nameVi:"C1T",type:"building",lat:21.03837975944799,lng:105.78335962961887,description:"Ta nh C1T - Khu ging ng",descriptionEn:"Building C1T - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C2",name:"Building C2",nameVi:"C2",type:"building",lat:21.038700468933712,lng:105.7816178053169,description:"Ta nh C2 - Khu ging ng",descriptionEn:"Building C2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C3",name:"Building C3",nameVi:"C3",type:"building",lat:21.03897939011371,lng:105.78201374266945,description:"Ta nh C3 - Khu ging ng",descriptionEn:"Building C3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C4",name:"Building C4",nameVi:"C4",type:"building",lat:21.038673854494604,lng:105.78220222457082,description:"Ta nh C4 - Khu ging ng",descriptionEn:"Building C4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C5",name:"Building C5",nameVi:"C5",type:"building",lat:21.039211779923747,lng:105.78223646566244,description:"Ta nh C5 - Khu ging ng",descriptionEn:"Building C5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"C6",name:"Building C6",nameVi:"C6",type:"building",lat:21.038969210374205,lng:105.7813646272462,description:"Ta nh C6 - Khu ging ng",descriptionEn:"Building C6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"D1",name:"Nguyen Van Dao Auditorium",nameVi:"Hi trng Nguyn Vn o",type:"building",lat:21.03745096834652,lng:105.78142828118075,description:"Hi trng Nguyn Vn o - Hi trng ln dnh cho s kin quan trng",descriptionEn:"Nguyen Van Dao Auditorium - Main auditorium for important events",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Hi trng","S kin"],tagsEn:["Auditorium","Events"]},{id:"D2",name:"VNU Administration Building D2",nameVi:"Nh iu hnh HQG D2",type:"building",lat:21.03766686313898,lng:105.78162505532134,description:"Nh iu hnh HQG - Ta nh hnh chnh",descriptionEn:"VNU Administration Building - Administrative office building",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["iu hnh","Hnh chnh"],tagsEn:["Administration","Office"]},{id:"E1",name:"Building E1",nameVi:"E1",type:"building",lat:21.037898547008368,lng:105.78265983816675,description:"Ta nh E1 - Khu ging ng",descriptionEn:"Building E1 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E2",name:"Building E2",nameVi:"E2",type:"building",lat:21.038138125326725,lng:105.78250452675343,description:"Ta nh E2 - Khu ging ng",descriptionEn:"Building E2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E3",name:"Building E3",nameVi:"E3",type:"building",lat:21.038251539453896,lng:105.78267346560932,description:"Ta nh E3 - Khu ging ng",descriptionEn:"Building E3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E4",name:"Building E4",nameVi:"E4",type:"building",lat:21.038066515983516,lng:105.7828634652073,description:"Ta nh E4 - Khu ging ng",descriptionEn:"Building E4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"E5",name:"Building E5",nameVi:"E5",type:"building",lat:21.03840666563933,lng:105.7827621403332,description:"Ta nh E5 - Khu ging ng v vn phng cc khoa",descriptionEn:"Building E5 - Lecture halls and faculty offices",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng","Vn phng"],tagsEn:["Lecture Hall","Office"]},{id:"G2",name:"Building G2",nameVi:"G2",type:"building",lat:21.038066718818,lng:105.7833562104258,description:"Ta nh G2 - Khu ging ng",descriptionEn:"Building G2 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G3",name:"Building G3",nameVi:"G3",type:"building",lat:21.038096961578148,lng:105.78199566240357,description:"Ta nh G3 - Khu ging ng",descriptionEn:"Building G3 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G4",name:"Building G4",nameVi:"G4",type:"building",lat:21.037036202500104,lng:105.7823262311631,description:"Ta nh G4 - Khu ging ng",descriptionEn:"Building G4 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G5",name:"Building G5",nameVi:"G5",type:"building",lat:21.037865450192925,lng:105.7814600713798,description:"Ta nh G5 - Khu ging ng",descriptionEn:"Building G5 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G6",name:"Building G6",nameVi:"G6",type:"building",lat:21.037614060236706,lng:105.78116710074528,description:"Ta nh G6 - Khu ging ng",descriptionEn:"Building G6 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G7",name:"Building G7",nameVi:"G7",type:"building",lat:21.038435221135757,lng:105.78144892714266,description:"Ta nh G7 - Khu ging ng",descriptionEn:"Building G7 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"G8",name:"Building G8",nameVi:"G8",type:"building",lat:21.038258438326096,lng:105.78144555504053,description:"Ta nh G8 - Khu ging ng",descriptionEn:"Building G8 - Lecture hall area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Ging ng"],tagsEn:["Lecture Hall"]},{id:"14A",name:"Dormitory 14A",nameVi:"14A",type:"building",lat:21.04066869104366,lng:105.78216346177845,description:"K tc x 14A - Khu nh  sinh vin",descriptionEn:"Dormitory 14A - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14B",name:"Dormitory 14B",nameVi:"14B",type:"building",lat:21.040332429257745,lng:105.78213949275664,description:"K tc x 14B - Khu nh  sinh vin",descriptionEn:"Dormitory 14B - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14C",name:"Dormitory 14C",nameVi:"14C",type:"building",lat:21.04074140951343,lng:105.78145868466765,description:"K tc x 14C - Khu nh  sinh vin",descriptionEn:"Dormitory 14C - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"14D",name:"Dormitory 14D",nameVi:"14D",type:"building",lat:21.040696062046877,lng:105.7830743587856,description:"K tc x 14D - Khu nh  sinh vin",descriptionEn:"Dormitory 14D - Student housing area",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1522708323590-d24dbb6b0267?w=800",tags:["K tc x","Sinh vin"],tagsEn:["Dormitory","Student"]},{id:"Y1",name:"Health Center Y1",nameVi:"Y1",type:"building",lat:21.040337761272482,lng:105.78160682814034,description:"Ta nh Y1 - Trm Y t phc v sinh vin v cn b",descriptionEn:"Building Y1 - Health center serving students and staff",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=800",tags:["Y t","Sc khe"],tagsEn:["Medical","Health"]},{id:"SANTHECHAT",name:"Sports Field",nameVi:"Sn gio dc th cht",type:"building",lat:21.039932683929663,lng:105.78187391466429,description:"Sn gio dc th cht - Khu vc th thao ngoi tri",descriptionEn:"Sports Field - Outdoor sports area for physical education",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1574629810360-7efbbe195018?w=800",tags:["Th thao","Sn bng"],tagsEn:["Sports","Field"]},{id:"SUNWAH",name:"Sunwah Innovation Center",nameVi:"Sunwah",type:"building",lat:21.0373549,lng:105.782269,description:"Ta nh Sunwah - Trung tm i mi Sng to v Khi nghip",descriptionEn:"Sunwah Building - Innovation and Startup Center",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1486406146926-c627a92ad1ab?w=800",tags:["i mi","Sng to","Startup"],tagsEn:["Innovation","Creative","Startup"]},{id:"MB",name:"MB Bank ATM",nameVi:"MB Bank",type:"building",lat:21.038383769994525,lng:105.78252247352702,description:"Cy ATM MB Bank trong khun vin trng",descriptionEn:"MB Bank ATM located within campus",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1556742049-0cfed4f6a45d?w=800",tags:["ATM","Ngn hng"],tagsEn:["ATM","Bank"]},{id:"HO",name:"Campus Lake",nameVi:"H",type:"building",lat:21.039027854415934,lng:105.78167624551548,description:"H nc trong khun vin trng - Khu vc th gin",descriptionEn:"Campus lake - Relaxation area with scenic views",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",tags:["H","Th gin","Cnh quan"],tagsEn:["Lake","Relaxation","Landscape"]},{id:"CONG1",name:"Xuan Thuy Main Gate",nameVi:"Cng Xun Thy",type:"building",lat:21.036791579174974,lng:105.7820570664141,description:"Cng chnh vo trng t ng Xun Thy",descriptionEn:"Main entrance gate from Xuan Thuy Street",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"CONG2",name:"Pham Van Dong Gate",nameVi:"Cng PV",type:"building",lat:21.03964484205782,lng:105.78116818655224,description:"Cng ph vo trng t ng Phm Vn ng",descriptionEn:"Secondary entrance from Pham Van Dong Street",address:"Phm Vn ng, Cu Giy, H Ni",addressEn:"Pham Van Dong, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"CONGP",name:"Side Gate",nameVi:"Cng Ph",type:"building",lat:21.040888033109084,lng:105.78267112400499,description:"Cng ph - Li vo ph",descriptionEn:"Side Gate - Secondary entrance",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Cng","Li vo"],tagsEn:["Gate","Entrance"]},{id:"BAOVEPV",name:"Security Post 2",nameVi:"Bo v 2",type:"building",lat:21.03938956724801,lng:105.78121276017191,description:"Trm bo v cng Phm Vn ng",descriptionEn:"Security post at Pham Van Dong Gate",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Bo v","An ninh"],tagsEn:["Security","Safety"]},{id:"BAOVEXT",name:"Security Post 1",nameVi:"Bo v 1",type:"building",lat:21.03686313635906,lng:105.78225545781584,description:"Trm bo v cng Xun Thy",descriptionEn:"Security post at Xuan Thuy Gate",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["Bo v","An ninh"],tagsEn:["Security","Safety"]},{id:"P_14a",name:"Parking 14A",nameVi:"Nh xe 14a",type:"building",lat:21.040230778034413,lng:105.7825580783724,description:"Nh xe khu 14A - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14A - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_14b",name:"Parking 14B",nameVi:"Nh xe 14b",type:"building",lat:21.039751005110787,lng:105.78129100352783,description:"Nh xe khu 14B - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14B - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_14c",name:"Parking 14C",nameVi:"Nh xe 14c",type:"building",lat:21.040858639860403,lng:105.78277779365209,description:"Nh xe khu 14C - Dnh cho sinh vin k tc x",descriptionEn:"Parking 14C - For dormitory students",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_C",name:"Parking Zone C",nameVi:"Nh xe khu C",type:"building",lat:21.039486239165825,lng:105.7817145800708,description:"Nh xe khu C - Dnh cho sinh vin v ging vin",descriptionEn:"Parking Zone C - For students and faculty",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_E",name:"Parking Zone E",nameVi:"Nh xe khu E",type:"building",lat:21.037745684639646,lng:105.78264380795207,description:"Nh xe khu E - Dnh cho sinh vin v ging vin",descriptionEn:"Parking Zone E - For students and faculty",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1558618666-fcd25c85cd64?w=800",tags:["Nh xe"," xe"],tagsEn:["Parking","Bike Parking"]},{id:"P_Car",name:"Car Parking Lot",nameVi:"Bi  xe  t",type:"building",lat:21.03726473275222,lng:105.78174321293005,description:"Bi  xe  t - Dnh cho ging vin v khch",descriptionEn:"Car Parking Lot - For faculty and visitors",address:"144 Xun Thy, Cu Giy, H Ni",addressEn:"144 Xuan Thuy, Cau Giay, Hanoi",image:"https://images.unsplash.com/photo-1506521781263-d8422e82f27a?w=800",tags:[" xe"," t"],tagsEn:["Parking","Car"]},{id:"C1",name:"Building C1",nameVi:"Nh C1",type:"lecture_hall",lat:21.006998,lng:105.843146,description:"Nh C1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"C2",name:"Building C2",nameVi:"Nh C2",type:"lecture_hall",lat:21.00648,lng:105.842316,description:"Nh C2 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C3",name:"Building C3",nameVi:"Nh C3",type:"lecture_hall",lat:21.006554,lng:105.84401,description:"Nh C3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"C4",name:"Building C4",nameVi:"Nh C4",type:"lecture_hall",lat:21.006179,lng:105.844041,description:"Nh C4 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"C5",name:"Building C5",nameVi:"Nh C5",type:"lecture_hall",lat:21.005763,lng:105.844036,description:"Nh C5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C6",name:"Building C6",nameVi:"Nh C6",type:"lecture_hall",lat:21.006173,lng:105.845011,description:"Nh C6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"C7",name:"Building C7",nameVi:"Nh C7",type:"lecture_hall",lat:21.005766,lng:105.844968,description:"Nh C7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"C8",name:"Building C8",nameVi:"Nh C8",type:"lecture_hall",lat:21.00529,lng:105.844926,description:"Nh C8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"C9",name:"Building C9",nameVi:"Nh C9",type:"lecture_hall",lat:21.005835,lng:105.842323,description:"Nh C9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"C10",name:"Building C10",nameVi:"Nh C10",type:"lecture_hall",lat:21.005441,lng:105.844081,description:"Nh C10 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D1",name:"Building D1",nameVi:"Nh D1",type:"lecture_hall",lat:21.004879,lng:105.843412,description:"Nh D1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D2",name:"Building D2",nameVi:"Nh D2",type:"lecture_hall",lat:21.004719,lng:105.842118,description:"Nh D2 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"D3",name:"Building D3",nameVi:"Nh D3",type:"lecture_hall",lat:21.00475,lng:105.844982,description:"Nh D3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"D4",name:"Building D4",nameVi:"Nh D4",type:"lecture_hall",lat:21.004182,lng:105.842085,description:"Nh D4 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D5",name:"Building D5",nameVi:"Nh D5",type:"lecture_hall",lat:21.004334,lng:105.844972,description:"Nh D5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D6",name:"Building D6",nameVi:"Nh D6",type:"lecture_hall",lat:21.004323,lng:105.842682,description:"Nh D6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"D7",name:"Building D7",nameVi:"Nh D7",type:"lecture_hall",lat:21.004072,lng:105.844899,description:"Nh D7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"D8",name:"Building D8",nameVi:"Nh D8",type:"lecture_hall",lat:21.003964,lng:105.842679,description:"Nh D8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"D9",name:"Building D9",nameVi:"Nh D9",type:"lecture_hall",lat:21.003806,lng:105.844114,description:"Nh D9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"D3_5",name:"Building D3-5",nameVi:"Nh D3-5",type:"lecture_hall",lat:21.004583,lng:105.845289,description:"Nh D3-5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B1",name:"Building B1",nameVi:"Nh B1",type:"lecture_hall",lat:21.004447,lng:105.846614,description:"Nh B1 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B3",name:"Building B3",nameVi:"Nh B3",type:"lecture_hall",lat:21.005613,lng:105.847615,description:"Nh B3 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"B5",name:"Building B5",nameVi:"Nh B5",type:"lecture_hall",lat:21.006424,lng:105.846885,description:"Nh B5 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"B5b",name:"Building B5b",nameVi:"Nh B5b",type:"lecture_hall",lat:21.006584,lng:105.846902,description:"Nh B5b - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B6",name:"Building B6",nameVi:"Nh B6",type:"lecture_hall",lat:21.006475,lng:105.846137,description:"Nh B6 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B7",name:"Building B7",nameVi:"Nh B7",type:"lecture_hall",lat:21.006044,lng:105.846114,description:"Nh B7 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"B7bis",name:"Building B7bis",nameVi:"Nh B7bis",type:"lecture_hall",lat:21.005663,lng:105.846131,description:"Nh B7bis - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1497366216548-37526070297c?w=800",tags:["HUST","Ging ng"]},{id:"B8",name:"Building B8",nameVi:"Nh B8",type:"lecture_hall",lat:21.005223,lng:105.846116,description:"Nh B8 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1523050854058-8df90110c9f1?w=800",tags:["HUST","Ging ng"]},{id:"B9",name:"Building B9",nameVi:"Nh B9",type:"lecture_hall",lat:21.006216,lng:105.847031,description:"Nh B9 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Ging ng"]},{id:"B13",name:"Building B13",nameVi:"Nh B13",type:"lecture_hall",lat:21.006686,lng:105.84762,description:"Nh B13 - i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1541339907198-e08756dedf3f?w=800",tags:["HUST","Ging ng"]},{id:"HO_TIEN",name:"Tien Lake",nameVi:"H Tin",type:"checkin",lat:21.004088,lng:105.843347,description:"H Tin - Khu vc cnh quan v th gin",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1506905925346-21bda4d32df4?w=800",tags:["HUST","H","Checkin"]},{id:"THU_VIEN",name:"Ta Quang Buu Library",nameVi:"Th vin T Quang Bu",type:"building",lat:21.004454,lng:105.844135,description:"Th vin T Quang Bu - Th vin ln nht Bch Khoa",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1507842217121-9e9f1929c5f7?w=800",tags:["HUST","Th vin","Hc tp"]},{id:"KTX_B10",name:"Dormitory B10",nameVi:"KTX B10",type:"housing",lat:21.005268,lng:105.847516,description:"K tc x B10 dnh cho sinh vin",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1555854877-bab0e564b8d5?w=800",tags:["HUST","KTX","Sinh vin"]},{id:"TRAM_XA",name:"Medical Station",nameVi:"Trm x",type:"building",lat:21.006605,lng:105.847562,description:"Trm y t trng i hc Bch Khoa H Ni",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1519494026892-80bbd2d6fd0d?w=800",tags:["HUST","Y t"]},{id:"A15",name:"Canteen A15",nameVi:"Nh n A15",type:"food",lat:21.004362,lng:105.847608,description:"Nh n sinh vin A15",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1552566626-52f8b828add9?w=800",tags:["HUST","n ung"]},{id:"NHA_KHACH",name:"HUST Guesthouse",nameVi:"Nh khch BK",type:"housing",lat:21.004091,lng:105.8479,description:"Nh khch i hc Bch Khoa",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800",tags:["HUST","Lu tr"]},{id:"A17",name:"Building A17",nameVi:"Nh A17",type:"building",lat:21.003959,lng:105.847633,description:"Ta nh A17 - Vin S phm k thut",address:"1 i C Vit, Hai B Trng, H Ni",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Vn phng"]},{id:"G_PARABOL",name:"Parabol Gate",nameVi:"Cng Parabol",type:"checkin",lat:21.005082,lng:105.841626,description:"Cng Parabol - Biu tng ca Bch Khoa",address:"ng Gii Phng",image:"https://images.unsplash.com/photo-1621644813589-9a22f365922c?w=800",tags:["HUST","Cng","Checkin"]},{id:"G_B8",name:"B8 Gate",nameVi:"Cng B8",type:"checkin",lat:21.004978,lng:105.845616,description:"Cng B8 ng Trn i Ngha",address:"ng Trn i Ngha",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Cng"]},{id:"G_BAC",name:"North Gate",nameVi:"Cng Bc",type:"checkin",lat:21.007411,lng:105.843047,description:"Cng Trn i Ngha (Cng Bc)",address:"ng Trn i Ngha",image:"https://images.unsplash.com/photo-1562774053-701939374585?w=800",tags:["HUST","Cng"]}],XA="https://thodia-backend-1067502227654.asia-southeast1.run.app",JW=t=>{if(["food","cafe","entertainment","lecture_hall","office","housing","job","building","checkin"].includes(t))return t;switch(t){case"service":case"shop":return"job";case"school":case"university":return"lecture_hall";default:return"building"}},QW=()=>{const{data:t=[],isLoading:e,refetch:r}=Xb({queryKey:["approved_stores"],queryFn:async()=>{try{const[l,u]=await Promise.all([fetch(`${XA}/api/stores/approved`),fetch(`${XA}/api/vouchers/active`)]),m=await l.json(),v=await u.json();if(!Array.isArray(m))return[];const b=new Map;return Array.isArray(v)&&v.forEach(a=>{b.has(a.store_id)||b.set(a.store_id,a)}),m.map(a=>{const k=b.get(a.id),M=a.is_premium===!0;return{id:`user-store-${a.id}`,name:a.name_en||a.name_vi,nameVi:a.name_vi,type:JW(a.category),category:a.category,lat:a.lat,lng:a.lng,description:a.description_vi||"",address:a.address_vi,image:a.image_url||"https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=800",isSponsored:M,is_premium:M,hasVoucher:!!k,voucherText:k?.title_vi||k?.code,reviews:[]}})}catch(l){return console.error("Li ti d liu bn :",l),[]}},staleTime:6e4});return{storesAsLocations:t,isLoading:e,refetch:r}},Yv=()=>localStorage.getItem("mapbox_token")||"pk.eyJ1IjoiYW5odGh1eTA0IiwiYSI6ImNta25kbnoweDBsYTkzZnNiMncxbnZscncifQ.3RK47LOR8WkYagYydkps1w",eq=t=>{localStorage.setItem("mapbox_token",t)},di=P.forwardRef(({className:t,type:e,...r},l)=>x.jsx("input",{type:e,className:ln("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:l,...r}));di.displayName="Input";const tq=({onSaved:t})=>{const[e,r]=P.useState(""),[l,u]=P.useState(null),{t:m}=ra(),v=()=>{const b=e.trim();if(!b){u(m("tokenEmptyError"));return}if(b.length<20){u(m("tokenTooShortError"));return}u(null),eq(b),t(b)};return x.jsxs("div",{className:"w-full max-w-md rounded-2xl border border-border bg-card p-5 shadow-lg",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("div",{className:"text-4xl mb-2",children:""}),x.jsx("p",{className:"font-semibold text-foreground",children:m("mapboxTokenRequired")}),x.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:m("mapboxTokenInstructions")})]}),x.jsxs("div",{className:"mt-4 space-y-3",children:[x.jsx(di,{value:e,onChange:b=>r(b.target.value),placeholder:m("tokenPlaceholder"),"aria-label":"Mapbox Access Token"}),l&&x.jsx("p",{className:"text-sm text-destructive",children:l}),x.jsx(_n,{onClick:v,className:"w-full",children:m("saveTokenAndLoad")}),x.jsx("p",{className:"text-xs text-muted-foreground text-center",children:m("tokenSavedInBrowser")})]})]})},$1="https://thodia-backend-1067502227654.asia-southeast1.run.app",nq=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},rq=({userLocation:t,onViewStore:e})=>{const{user:r}=Oo(),[l,u]=P.useState([]),[m,v]=P.useState(0),[b,a]=P.useState(!0),[k,M]=P.useState(new Set);P.useEffect(()=>{if(!t)return;(async()=>{try{const Z=await(await fetch(`${$1}/api/vouchers/active`)).json();if(!Array.isArray(Z))return;const Y=Z.map(ee=>({id:ee.id,code:ee.code,discount_value:ee.discount_value,discount_type:ee.discount_type,store:{id:ee.store_id,name_vi:ee.store_name,lat:ee.store_lat,lng:ee.store_lng,address_vi:ee.address_vi},distance:nq(t.lat,t.lng,ee.store_lat,ee.store_lng)})).filter(ee=>ee.distance<=10).sort((ee,ie)=>ee.distance-ie.distance);if(u(Y),r){const ie=await(await fetch(`${$1}/api/user-vouchers?userId=${r.uid}`)).json();if(Array.isArray(ie)){const pe=ie.map(we=>we.voucher_id||we.id);M(new Set(pe))}}}catch(H){console.error("Li ti voucher:",H)}})()},[t,r]),P.useEffect(()=>{if(l.length<=1)return;const K=setInterval(()=>{v(H=>(H+1)%l.length)},6e3);return()=>clearInterval(K)},[l]);const L=async(K,H)=>{if(K.stopPropagation(),!r){Ht.error("Bn cn ng nhp  lu m!");return}if(!k.has(H.id)){M(Z=>new Set(Z).add(H.id)),Ht.success(" lu m vo v!");try{if(!(await fetch(`${$1}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r.uid,voucherId:H.id})})).ok)throw new Error("Failed")}catch{M(Y=>{const ee=new Set(Y);return ee.delete(H.id),ee}),Ht.error("Li kt ni, vui lng th li")}}};if(!b||l.length===0)return null;const z=l[m],O=k.has(z.id);return x.jsx("div",{className:"fixed bottom-2 left-2 z-[40] w-[90%] md:w-80",children:x.jsx(Ta,{mode:"wait",children:x.jsxs(yr.div,{initial:{x:-50,opacity:0},animate:{x:0,opacity:1},exit:{x:-50,opacity:0},transition:{duration:.4},onClick:()=>e(z.store.lat,z.store.lng),className:"bg-white/95 backdrop-blur shadow-xl rounded-xl border border-gray-200 overflow-hidden relative cursor-pointer hover:shadow-2xl transition-all",children:[x.jsx("button",{onClick:K=>{K.stopPropagation(),a(!1)},className:"absolute top-1 right-1 p-1 text-gray-400 hover:text-gray-600 rounded-full z-10",children:x.jsx(ti,{className:"w-4 h-4"})}),x.jsxs("div",{className:"flex",children:[x.jsxs("div",{className:"w-16 bg-gradient-to-b from-primary to-blue-600 flex items-center justify-center text-white flex-col gap-1",children:[x.jsx(Yy,{className:"w-6 h-6"}),x.jsx("span",{className:"text-[10px] font-bold",children:"Voucher"})]}),x.jsxs("div",{className:"flex-1 p-3",children:[x.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase truncate mb-0.5",children:z.store.name_vi}),x.jsxs("div",{className:"flex items-baseline gap-1 mb-2",children:[x.jsxs("span",{className:"text-xl font-black text-primary",children:["-",z.discount_value,z.discount_type==="percent"?"%":"k"]}),x.jsxs("span",{className:"text-xs text-gray-400 font-mono",children:["#",z.code]})]}),x.jsxs("div",{className:"flex justify-between items-center mt-1",children:[x.jsxs("div",{className:"flex items-center text-[10px] text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:[x.jsx(Vi,{className:"w-3 h-3 mr-1"}),z.distance.toFixed(1),"km"]}),x.jsxs(_n,{size:"sm",variant:O?"outline":"default",className:`h-7 text-xs px-2 ${O?"text-green-600 border-green-200 bg-green-50":""}`,onClick:K=>L(K,z),children:[O?x.jsx(np,{className:"w-3 h-3 mr-1"}):x.jsx(NO,{className:"w-3 h-3 mr-1"}),O?" lu":"Lu"]})]})]})]}),x.jsx(yr.div,{initial:{width:"0%"},animate:{width:"100%"},transition:{duration:6,ease:"linear"},className:"h-1 bg-primary/50 absolute bottom-0 left-0"})]},m)})})},iq=({type:t,isSelected:e,isSponsored:r,hasVoucher:l})=>{let u=Vi,m="#64748B";switch(t){case"lecture_hall":u=Ib,m="#0EA5E9";break;case"office":u=Eb,m="#475569";break;case"cafe":u=kb,m="#D97706";break;case"entertainment":u=Ab,m="#DB2777";break;case"food":u=kv,m="#F97316";break;case"housing":u=Mb,m="#3B82F6";break;case"job":u=oh,m="#8B5CF6";break;case"building":u=Rm,m="#10B981";break;case"checkin":u=CM,m="#EC4899";break;default:u=Vi,m="#64748B"}const v=e?46:r?32:26,b=e?24:r?16:14,a=e?3:1.5;return x.jsxs("div",{className:"relative flex flex-col items-center justify-center transition-all duration-300 group cursor-pointer",style:{transform:e?"scale(1.15) translateY(-10px)":"scale(1)",zIndex:e?50:10},children:[x.jsx("div",{style:{width:v,height:v,backgroundColor:e?m:"white",border:`${a}px solid ${e?"white":m}`,borderRadius:"50%",display:"flex",alignItems:"center",justifyContent:"center",boxShadow:e?`0 10px 25px -5px ${m}90`:"0 2px 4px 0 rgba(0,0,0,0.15)"},children:x.jsx(u,{size:b,color:e?"white":m,strokeWidth:2.5})}),(e||r)&&x.jsx("div",{style:{width:0,height:0,borderLeft:`${e?6:4}px solid transparent`,borderRight:`${e?6:4}px solid transparent`,borderTop:`${e?8:6}px solid ${m}`,marginTop:-1,filter:"drop-shadow(0 1px 1px rgba(0,0,0,0.1))"}}),l&&x.jsx("div",{className:"absolute -top-1.5 -right-1.5 bg-yellow-400 border border-white rounded-full p-0.5 shadow-sm animate-bounce z-[60]",children:x.jsx(Vf,{size:e?10:8,fill:"white",className:"text-white"})})]})},sq=({selectedLocation:t,onSelectLocation:e,activeCategories:r,flyToLocation:l,routeInfo:u,routeOrigin:m,routeDestination:v,multiStopRoute:b,isMultiStopMode:a,onUserLocationUpdate:k})=>{const{language:M}=ra(),{storesAsLocations:L}=QW(),z=P.useRef(null),O=P.useRef(null),K=P.useRef([]),H=P.useRef(null),Z=P.useRef(null),Y=P.useRef(null),[ee,ie]=P.useState(!1),[pe,we]=P.useState(null),[ke,ze]=P.useState(!1),[Ge,tt]=P.useState(null),Pe="route-line",ot="route-arrows",ut="route-source";P.useEffect(()=>{const Lt=Yv();we(Lt),ze(!0)},[]);const gt=Lt=>{we(Lt)};P.useEffect(()=>{if(!z.current||O.current||!pe)return;zl.accessToken=pe,O.current=new zl.Map({container:z.current,style:"mapbox://styles/mapbox/streets-v12",center:[ZA.lng,ZA.lat],zoom:16,pitch:45,bearing:-17.6}),O.current.addControl(new zl.NavigationControl,"bottom-right");const Lt=new zl.GeolocateControl({positionOptions:{enableHighAccuracy:!0},trackUserLocation:!0,showUserHeading:!0});return O.current.addControl(Lt,"bottom-right"),Lt.on("geolocate",mt=>{const pt={lat:mt.coords.latitude,lng:mt.coords.longitude};tt(pt),k&&k(pt)}),O.current.on("load",()=>{ie(!0),Lt.trigger()}),O.current.on("click",mt=>{Y.current&&(Y.current.remove(),Y.current=null);const pt=O.current?.queryRenderedFeatures(mt.point,{layers:["poi-label"]});if(pt&&pt.length>0){const Ae=pt[0],xe=Ae.properties?.name||"a im cha c tn",We=Ae.geometry.coordinates.slice(),he=document.createElement("div");he.className="poi-highlight-marker",pm.createRoot(he).render(x.jsxs("div",{className:"relative -top-4 animate-bounce",children:[x.jsx(Vi,{size:46,className:"text-red-600 fill-white drop-shadow-2xl",strokeWidth:2.5}),x.jsx("div",{className:"absolute -bottom-1 left-1/2 -translate-x-1/2 w-4 h-2 bg-black/20 blur-[3px] rounded-full"})]}));const it=new zl.Marker({element:he,anchor:"bottom"}).setLngLat(We).addTo(O.current);Y.current=it,O.current?.flyTo({center:We,zoom:17,pitch:50,duration:1e3,offset:[0,150]});const vt={id:String(Ae.id),name:xe,nameVi:xe,address:"a im trn bn ",description:"a im tm thy t Mapbox",lat:We[1],lng:We[0],type:"checkin",category:"checkin",image:null,is_premium:!1};e(vt)}}),O.current.on("mouseenter","poi-label",()=>{O.current&&(O.current.getCanvas().style.cursor="pointer")}),O.current.on("mouseleave","poi-label",()=>{O.current&&(O.current.getCanvas().style.cursor="")}),()=>{O.current?.remove(),O.current=null}},[pe]),P.useEffect(()=>{if(!O.current||!ee||(K.current.forEach(({marker:Ae,root:xe})=>{xe.unmount(),Ae.remove()}),K.current=[],!!u||!!b))return;[...GT,...L].filter(Ae=>r.includes(Ae.type)).forEach(Ae=>{const xe=document.createElement("div");xe.className="custom-marker-container";const We=pm.createRoot(xe),he=t?.id===Ae.id;if(We.render(x.jsx(iq,{type:Ae.type,isSelected:he,isSponsored:Ae.isSponsored||!1,hasVoucher:Ae.hasVoucher})),Ae.type==="building"||he){const it=document.createElement("div"),vt=M==="en"&&Ae.name?Ae.name:Ae.nameVi;it.innerHTML=`<div class="px-2 py-1 bg-slate-900/90 text-white text-[10px] font-bold rounded shadow-lg backdrop-blur-sm mt-2 whitespace-nowrap transform -translate-x-1/2 left-1/2 relative">${vt}</div>`,xe.appendChild(it)}xe.addEventListener("click",it=>{it.stopPropagation(),e(Ae)});const Fe=new zl.Marker({element:xe,anchor:"bottom"}).setLngLat([Ae.lng,Ae.lat]).addTo(O.current);K.current.push({marker:Fe,root:We})})},[r,ee,t,e,M,L,u,b]),P.useEffect(()=>{!O.current||!l||O.current.flyTo({center:[l.lng,l.lat],zoom:18,pitch:60,duration:1500})},[l]),P.useEffect(()=>{if(!O.current||!ee)return;O.current.getLayer(ot)&&O.current.removeLayer(ot),O.current.getLayer(Pe)&&O.current.removeLayer(Pe),O.current.getSource(ut)&&O.current.removeSource(ut),H.current&&(H.current.remove(),H.current=null),Z.current&&(Z.current.remove(),Z.current=null);const Lt=a?b:u;if(!Lt?.geometry)return;if(O.current.addSource(ut,{type:"geojson",data:{type:"Feature",properties:{},geometry:Lt.geometry}}),O.current.addLayer({id:Pe,type:"line",source:ut,layout:{"line-join":"round","line-cap":"round"},paint:{"line-color":a?"#8b5cf6":"#3b82f6","line-width":6,"line-opacity":.8}}),O.current.addLayer({id:ot,type:"symbol",source:ut,layout:{"symbol-placement":"line","symbol-spacing":80,"icon-image":"arrow-right","icon-size":.6,"icon-allow-overlap":!0,"icon-ignore-placement":!0}}),!O.current.hasImage("arrow-right")){const pt='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5 12H19M19 12L12 5M19 12L12 19" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"/></svg>',Ae=new Image(24,24);Ae.onload=()=>{O.current&&!O.current.hasImage("arrow-right")&&O.current.addImage("arrow-right",Ae)},Ae.src="data:image/svg+xml;charset=utf-8,"+encodeURIComponent(pt)}if(m){const pt=document.createElement("div");pm.createRoot(pt).render(x.jsx("div",{className:"w-5 h-5 bg-blue-600 border-2 border-white rounded-full shadow-md animate-pulse"})),H.current=new zl.Marker({element:pt}).setLngLat(m).addTo(O.current)}if(!a&&v){const pt=document.createElement("div");pm.createRoot(pt).render(x.jsx("div",{className:"flex flex-col items-center pb-2",children:x.jsx(Vi,{size:32,className:"text-red-600 drop-shadow-md fill-red-600"})})),Z.current=new zl.Marker({element:pt,anchor:"bottom"}).setLngLat(v).addTo(O.current)}const mt=Lt.geometry.coordinates;if(mt&&mt.length>0){const pt=mt.reduce((Ae,xe)=>Ae.extend(xe),new zl.LngLatBounds(mt[0],mt[0]));O.current.fitBounds(pt,{padding:{top:150,bottom:300,left:50,right:50},duration:1e3})}},[u,b,a,m,v,ee]);const ht=(Lt,mt)=>{if(O.current){tempMarkerRef.current&&tempMarkerRef.current.remove(),O.current.flyTo({center:[mt,Lt],zoom:17,pitch:50,duration:1500});const pt=document.createElement("div");pm.createRoot(pt).render(x.jsx(Vi,{size:40,className:"text-red-500 fill-red-500 animate-bounce"})),tempMarkerRef.current=new zl.Marker({element:pt,anchor:"bottom"}).setLngLat([mt,Lt]).addTo(O.current)}};return ke?pe?x.jsxs("div",{className:"relative w-full h-full",children:[x.jsx("div",{ref:z,className:"w-full h-full"}),Ge&&x.jsx(rq,{userLocation:Ge,onViewStore:ht})]}):x.jsx("div",{className:"w-full h-full flex items-center justify-center p-4",children:x.jsx(tq,{onSaved:gt})}):x.jsx("div",{className:"w-full h-full flex items-center justify-center",children:x.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})})},oq="https://thodia-backend-1067502227654.asia-southeast1.run.app",ny=t=>t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").replace(//g,"d").replace(//g,"D"),G1=(t,e,r,l)=>{const m=(r-t)*(Math.PI/180),v=(l-e)*(Math.PI/180),b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*(Math.PI/180))*Math.cos(r*(Math.PI/180))*Math.sin(v/2)*Math.sin(v/2);return 6371*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},aq=({onLocationSelect:t,onFocus:e,onBlur:r,placeholder:l="Tm a im...",userLocation:u,resultContainerStyle:m})=>{const[v,b]=P.useState(""),[a,k]=P.useState([]),[M,L]=P.useState(!1),[z,O]=P.useState(!1),[K,H]=P.useState(!1),Z=P.useRef(null),Y=P.useRef(null),ee=P.useRef(null);P.useEffect(()=>{const ke=ze=>{Z.current&&!Z.current.contains(ze.target)&&(O(!1),r&&r())};return document.addEventListener("mousedown",ke),()=>document.removeEventListener("mousedown",ke)},[r]),P.useEffect(()=>{if(!v){k([]),H(!1);return}O(!0),L(!0),H(!1);const ke=setTimeout(async()=>{const ze=ny(v).toLowerCase().trim(),Ge=GT.filter(ot=>{const ut=ny(ot.name).toLowerCase(),gt=ny(ot.nameVi||"").toLowerCase();return ut.includes(ze)||gt.includes(ze)}).map(ot=>({id:`local-${ot.id}`,name:ot.nameVi||ot.name,address:ot.address||"i hc Bch Khoa HN",lat:ot.lat,lng:ot.lng,source:"local",type:ot.type,originalData:ot,distance:u?G1(u.lat,u.lng,ot.lat,ot.lng):0})),tt=Yv();ee.current&&ee.current.abort(),ee.current=new AbortController;const Pe=ee.current.signal;try{let ot=[],ut=[];try{const ht=await fetch(`${oq}/api/search/stores?q=${encodeURIComponent(v)}`,{signal:Pe});if(ht.ok){const Lt=await ht.json();Array.isArray(Lt)&&(ot=Lt.map(mt=>({id:`db-${mt.id}`,name:mt.name_vi,address:mt.address_vi,lat:mt.lat,lng:mt.lng,source:"database",type:mt.category,originalData:mt,distance:u?G1(u.lat,u.lng,mt.lat,mt.lng):0})))}}catch(ht){console.error("Li gi API search:",ht)}if(tt){const ht=u?`&proximity=${u.lng},${u.lat}`:"",Lt=`https://api.mapbox.com/geocoding/v5/mapbox.places/${encodeURIComponent(v)}.json?access_token=${tt}&country=vn&autocomplete=true&limit=10&language=vi&types=poi,address${ht}`,mt=await fetch(Lt,{signal:Pe});if(mt.ok){const pt=await mt.json();pt.features&&(ut=pt.features.map(Ae=>({id:Ae.id,name:Ae.text,address:Ae.place_name?.replace(Ae.text+", ","").replace(", Vietnam",""),lat:Ae.center[1],lng:Ae.center[0],source:"mapbox",type:"checkin",originalData:{id:Ae.id,name:Ae.text,nameVi:Ae.text,address:Ae.place_name,lat:Ae.center[1],lng:Ae.center[0],type:"checkin",isMapboxResult:!0},distance:u?G1(u.lat,u.lng,Ae.center[1],Ae.center[0]):0})))}}const gt=[...Ge,...ot,...ut];gt.sort((ht,Lt)=>{const mt=ny(ht.name).toLowerCase()===ze,pt=ny(Lt.name).toLowerCase()===ze;return mt&&!pt?-1:!mt&&pt?1:(ht.distance||0)-(Lt.distance||0)}),k(gt)}catch(ot){ot.name!=="AbortError"&&console.error("Li tm kim:",ot)}finally{Pe.aborted||L(!1)}},400);return()=>clearTimeout(ke)},[v,u]);const ie=ke=>{b(ke.name),k([]),O(!1),Y.current&&Y.current.blur(),t(ke.originalData)},pe=()=>{b(""),k([]),Y.current&&Y.current.focus()},we=ke=>ke===void 0?"":ke<1?`${(ke*1e3).toFixed(0)}m`:`${ke.toFixed(1)}km`;return x.jsxs("div",{ref:Z,className:"relative w-full pointer-events-auto z-[50]",children:[z&&x.jsx("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-[1px] z-[-1] md:hidden",onClick:()=>O(!1)}),x.jsxs("div",{className:"relative flex items-center bg-white rounded-full shadow-md border border-gray-200 h-12 overflow-hidden transition-all duration-200 focus-within:shadow-lg focus-within:border-blue-300",children:[x.jsx("div",{className:"pl-4 pr-2 text-gray-400",children:M?x.jsx(Fi,{className:"w-5 h-5 animate-spin text-blue-500"}):x.jsx(Cv,{className:"w-5 h-5"})}),x.jsx(di,{ref:Y,className:"border-none shadow-none focus-visible:ring-0 focus-visible:ring-offset-0 h-full bg-transparent text-base px-2 placeholder:text-gray-400 w-full",placeholder:l,value:v,onChange:ke=>b(ke.target.value),onFocus:()=>O(!0),style:{fontSize:"16px"}}),v&&x.jsx(_n,{variant:"ghost",size:"icon",className:"h-9 w-9 mr-1 hover:bg-gray-100 rounded-full active:scale-95 transition-transform",onMouseDown:ke=>{ke.preventDefault(),pe()},children:x.jsx(ti,{className:"h-5 w-5 text-gray-500"})})]}),z&&(a.length>0||M&&v||K)&&x.jsx("div",{className:`
            bg-white rounded-2xl shadow-2xl border border-gray-100 overflow-hidden 
            flex flex-col
            fixed top-[70px] left-2 right-2 max-h-[50vh]
            md:absolute md:top-full md:left-0 md:right-0 md:mt-2 md:max-h-[60vh]
            z-[100]
          `,children:x.jsxs("div",{className:"overflow-y-auto overscroll-contain",children:[K&&x.jsxs("div",{className:"p-3 bg-red-50 text-red-600 text-sm flex items-center gap-2 border-b border-red-100",children:[x.jsx(mO,{className:"w-4 h-4"}),x.jsx("span",{children:"Cha nhp Mapbox Token!"})]}),M&&a.length===0&&!K&&x.jsxs("div",{className:"p-4 text-center text-gray-400 text-sm flex items-center justify-center gap-2 py-8",children:[x.jsx(Fi,{className:"w-5 h-5 animate-spin"})," ang tm kim..."]}),x.jsx("div",{className:"py-1",children:a.map(ke=>x.jsxs("button",{onMouseDown:ze=>{ze.preventDefault(),ie(ke)},className:"w-full text-left px-4 py-3 hover:bg-blue-50 active:bg-blue-100 transition-colors flex items-start gap-3 border-b border-gray-50 last:border-0 group",children:[x.jsx("div",{className:`mt-0.5 w-8 h-8 rounded-full flex items-center justify-center flex-shrink-0 shadow-sm ${ke.source==="local"?"bg-blue-100 text-blue-600":ke.source==="database"?"bg-purple-100 text-purple-600":"bg-gray-100 text-gray-600"}`,children:ke.source==="local"||ke.source==="database"?x.jsx(Rm,{className:"w-4 h-4"}):x.jsx(Vi,{className:"w-4 h-4"})}),x.jsxs("div",{className:"min-w-0 flex-1",children:[x.jsxs("div",{className:"flex justify-between items-start gap-2",children:[x.jsx("h4",{className:"font-semibold text-gray-800 text-sm line-clamp-1 group-hover:text-blue-700",children:ke.name}),u&&x.jsxs("div",{className:"flex items-center text-[10px] text-blue-600 font-bold bg-blue-50 px-1.5 py-0.5 rounded-md flex-shrink-0 whitespace-nowrap",children:[x.jsx(Bx,{className:"w-3 h-3 mr-0.5"}),we(ke.distance)]})]}),x.jsxs("p",{className:"text-xs text-gray-500 line-clamp-1 mt-0.5 flex items-center gap-1.5",children:[ke.source==="local"&&x.jsx("span",{className:"bg-blue-100 text-blue-700 px-1 rounded-[3px] text-[9px] font-bold uppercase tracking-wider",children:"Trng"}),x.jsx("span",{className:"truncate",children:ke.address})]})]})]},`${ke.source}-${ke.id}`))})]})}),z&&!M&&v&&a.length===0&&!K&&x.jsx("div",{className:`
              bg-white rounded-xl shadow-lg p-4 text-center text-gray-500 text-sm 
              fixed top-[70px] left-2 right-2 
              md:absolute md:top-full md:left-0 md:right-0 md:mt-2
              z-[100]
            `,children:"Khng tm thy a im no ph hp."})]})},lq=({activeCategories:t,onToggleCategory:e})=>{const{t:r}=ra(),l=[{type:"lecture_hall",labelKey:"lecture_hall",icon:Ib},{type:"office",labelKey:"office",icon:Eb},{type:"food",labelKey:"food",icon:kv},{type:"cafe",labelKey:"cafe",icon:kb},{type:"entertainment",labelKey:"entertainment",icon:Ab},{type:"housing",labelKey:"housing",icon:Mb},{type:"job",labelKey:"job",icon:oh},{type:"building",labelKey:"building",icon:Rm}];return x.jsx("div",{className:"flex gap-1.5 overflow-x-auto pb-1 scrollbar-hide",children:l.map(({type:u,labelKey:m,icon:v})=>{const b=t.includes(u);return x.jsxs(yr.button,{onClick:()=>e(u),className:ln("flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium whitespace-nowrap transition-all",b?"bg-primary text-primary-foreground shadow-md":"bg-card/90 backdrop-blur-sm text-muted-foreground border border-border hover:bg-muted"),whileTap:{scale:.95},children:[x.jsx(v,{className:"w-3.5 h-3.5"}),x.jsx("span",{children:r(m)})]},u)})})},H1="https://thodia-backend-1067502227654.asia-southeast1.run.app",R3=()=>{const{user:t}=Oo(),e=Dv(),r=t?.uid,{data:l=[],isLoading:u}=Xb({queryKey:["favorites",r],queryFn:async()=>{if(!r)return[];try{const k=await fetch(`${H1}/api/favorites?userId=${r}`),M=await k.json();if(!k.ok)throw new Error("Failed to fetch favorites");return M.map(L=>({id:L.location_id,name:L.location_name_en||L.location_name,nameVi:L.location_name,type:L.location_type,lat:L.location_lat,lng:L.location_lng,address:"",description:"",image:"https://images.unsplash.com/photo-1554118811-1e0d58224f24?w=800",isSponsored:!1,hasVoucher:!1}))}catch(k){return console.error(k),[]}},enabled:!!r}),m=Bl({mutationFn:async k=>{if(!r)throw new Error("Vui lng ng nhp");const M=k.id.toString();if(!(await fetch(`${H1}/api/favorites`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r,locationId:M,name:k.nameVi||k.name,nameEn:k.name||null,lat:k.lat,lng:k.lng,type:k.type})})).ok)throw new Error("Li khi thm yu thch")},onSuccess:()=>{e.invalidateQueries({queryKey:["favorites"]}),Ht.success(" thm vo yu thch ")},onError:k=>Ht.error(k.message)}),v=Bl({mutationFn:async k=>{if(!r)throw new Error("Vui lng ng nhp");if(!(await fetch(`${H1}/api/favorites/${k}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:r})})).ok)throw new Error("Li khi xa yu thch")},onSuccess:()=>{e.invalidateQueries({queryKey:["favorites"]}),Ht.info(" xa khi yu thch")},onError:k=>Ht.error(k.message)}),b=k=>l.some(M=>M.id.toString()===k.toString()),a=k=>{b(k.id)?v.mutate(k.id):m.mutate(k)};return{favorites:l,isLoading:u,addFavorite:m.mutate,removeFavorite:v.mutate,isFavorite:b,toggleFavorite:a,isAdding:m.isPending}};var W1="focusScope.autoFocusOnMount",q1="focusScope.autoFocusOnUnmount",KA={bubbles:!1,cancelable:!0},cq="FocusScope",Jv=P.forwardRef((t,e)=>{const{loop:r=!1,trapped:l=!1,onMountAutoFocus:u,onUnmountAutoFocus:m,...v}=t,[b,a]=P.useState(null),k=Bi(u),M=Bi(m),L=P.useRef(null),z=ir(e,H=>a(H)),O=P.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;P.useEffect(()=>{if(l){let H=function(ie){if(O.paused||!b)return;const pe=ie.target;b.contains(pe)?L.current=pe:Yd(L.current,{select:!0})},Z=function(ie){if(O.paused||!b)return;const pe=ie.relatedTarget;pe!==null&&(b.contains(pe)||Yd(L.current,{select:!0}))},Y=function(ie){if(document.activeElement===document.body)for(const we of ie)we.removedNodes.length>0&&Yd(b)};document.addEventListener("focusin",H),document.addEventListener("focusout",Z);const ee=new MutationObserver(Y);return b&&ee.observe(b,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",H),document.removeEventListener("focusout",Z),ee.disconnect()}}},[l,b,O.paused]),P.useEffect(()=>{if(b){JA.add(O);const H=document.activeElement;if(!b.contains(H)){const Y=new CustomEvent(W1,KA);b.addEventListener(W1,k),b.dispatchEvent(Y),Y.defaultPrevented||(uq(mq(N3(b)),{select:!0}),document.activeElement===H&&Yd(b))}return()=>{b.removeEventListener(W1,k),setTimeout(()=>{const Y=new CustomEvent(q1,KA);b.addEventListener(q1,M),b.dispatchEvent(Y),Y.defaultPrevented||Yd(H??document.body,{select:!0}),b.removeEventListener(q1,M),JA.remove(O)},0)}}},[b,k,M,O]);const K=P.useCallback(H=>{if(!r&&!l||O.paused)return;const Z=H.key==="Tab"&&!H.altKey&&!H.ctrlKey&&!H.metaKey,Y=document.activeElement;if(Z&&Y){const ee=H.currentTarget,[ie,pe]=dq(ee);ie&&pe?!H.shiftKey&&Y===pe?(H.preventDefault(),r&&Yd(ie,{select:!0})):H.shiftKey&&Y===ie&&(H.preventDefault(),r&&Yd(pe,{select:!0})):Y===ee&&H.preventDefault()}},[r,l,O.paused]);return x.jsx(Mn.div,{tabIndex:-1,...v,ref:z,onKeyDown:K})});Jv.displayName=cq;function uq(t,{select:e=!1}={}){const r=document.activeElement;for(const l of t)if(Yd(l,{select:e}),document.activeElement!==r)return}function dq(t){const e=N3(t),r=YA(e,t),l=YA(e.reverse(),t);return[r,l]}function N3(t){const e=[],r=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:l=>{const u=l.tagName==="INPUT"&&l.type==="hidden";return l.disabled||l.hidden||u?NodeFilter.FILTER_SKIP:l.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;r.nextNode();)e.push(r.currentNode);return e}function YA(t,e){for(const r of t)if(!hq(r,{upTo:e}))return r}function hq(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function fq(t){return t instanceof HTMLInputElement&&"select"in t}function Yd(t,{select:e=!1}={}){if(t&&t.focus){const r=document.activeElement;t.focus({preventScroll:!0}),t!==r&&fq(t)&&e&&t.select()}}var JA=pq();function pq(){let t=[];return{add(e){const r=t[0];e!==r&&r?.pause(),t=QA(t,e),t.unshift(e)},remove(e){t=QA(t,e),t[0]?.resume()}}}function QA(t,e){const r=[...t],l=r.indexOf(e);return l!==-1&&r.splice(l,1),r}function mq(t){return t.filter(e=>e.tagName!=="A")}var Z1=0;function HT(){P.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??eI()),document.body.insertAdjacentElement("beforeend",t[1]??eI()),Z1++,()=>{Z1===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Z1--}},[])}function eI(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Fc=function(){return Fc=Object.assign||function(e){for(var r,l=1,u=arguments.length;l<u;l++){r=arguments[l];for(var m in r)Object.prototype.hasOwnProperty.call(r,m)&&(e[m]=r[m])}return e},Fc.apply(this,arguments)};function D3(t,e){var r={};for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&e.indexOf(l)<0&&(r[l]=t[l]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var u=0,l=Object.getOwnPropertySymbols(t);u<l.length;u++)e.indexOf(l[u])<0&&Object.prototype.propertyIsEnumerable.call(t,l[u])&&(r[l[u]]=t[l[u]]);return r}function gq(t,e,r){if(r||arguments.length===2)for(var l=0,u=e.length,m;l<u;l++)(m||!(l in e))&&(m||(m=Array.prototype.slice.call(e,0,l)),m[l]=e[l]);return t.concat(m||Array.prototype.slice.call(e))}var Lx="right-scroll-bar-position",jx="width-before-scroll-bar",yq="with-scroll-bars-hidden",_q="--removed-body-scroll-bar-size";function X1(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function xq(t,e){var r=P.useState(function(){return{value:t,callback:e,facade:{get current(){return r.value},set current(l){var u=r.value;u!==l&&(r.value=l,r.callback(l,u))}}}})[0];return r.callback=e,r.facade}var vq=typeof window<"u"?P.useLayoutEffect:P.useEffect,tI=new WeakMap;function wq(t,e){var r=xq(null,function(l){return t.forEach(function(u){return X1(u,l)})});return vq(function(){var l=tI.get(r);if(l){var u=new Set(l),m=new Set(t),v=r.current;u.forEach(function(b){m.has(b)||X1(b,null)}),m.forEach(function(b){u.has(b)||X1(b,v)})}tI.set(r,t)},[t]),r}function bq(t){return t}function Tq(t,e){e===void 0&&(e=bq);var r=[],l=!1,u={read:function(){if(l)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return r.length?r[r.length-1]:t},useMedium:function(m){var v=e(m,l);return r.push(v),function(){r=r.filter(function(b){return b!==v})}},assignSyncMedium:function(m){for(l=!0;r.length;){var v=r;r=[],v.forEach(m)}r={push:function(b){return m(b)},filter:function(){return r}}},assignMedium:function(m){l=!0;var v=[];if(r.length){var b=r;r=[],b.forEach(m),v=r}var a=function(){var M=v;v=[],M.forEach(m)},k=function(){return Promise.resolve().then(a)};k(),r={push:function(M){v.push(M),k()},filter:function(M){return v=v.filter(M),r}}}};return u}function Sq(t){t===void 0&&(t={});var e=Tq(null);return e.options=Fc({async:!0,ssr:!1},t),e}var L3=function(t){var e=t.sideCar,r=D3(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var l=e.read();if(!l)throw new Error("Sidecar medium not found");return P.createElement(l,Fc({},r))};L3.isSideCarExport=!0;function Eq(t,e){return t.useMedium(e),L3}var j3=Sq(),K1=function(){},Qv=P.forwardRef(function(t,e){var r=P.useRef(null),l=P.useState({onScrollCapture:K1,onWheelCapture:K1,onTouchMoveCapture:K1}),u=l[0],m=l[1],v=t.forwardProps,b=t.children,a=t.className,k=t.removeScrollBar,M=t.enabled,L=t.shards,z=t.sideCar,O=t.noRelative,K=t.noIsolation,H=t.inert,Z=t.allowPinchZoom,Y=t.as,ee=Y===void 0?"div":Y,ie=t.gapMode,pe=D3(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noRelative","noIsolation","inert","allowPinchZoom","as","gapMode"]),we=z,ke=wq([r,e]),ze=Fc(Fc({},pe),u);return P.createElement(P.Fragment,null,M&&P.createElement(we,{sideCar:j3,removeScrollBar:k,shards:L,noRelative:O,noIsolation:K,inert:H,setCallbacks:m,allowPinchZoom:!!Z,lockRef:r,gapMode:ie}),v?P.cloneElement(P.Children.only(b),Fc(Fc({},ze),{ref:ke})):P.createElement(ee,Fc({},ze,{className:a,ref:ke}),b))});Qv.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Qv.classNames={fullWidth:jx,zeroRight:Lx};var Cq=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function kq(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Cq();return e&&t.setAttribute("nonce",e),t}function Aq(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Iq(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Mq=function(){var t=0,e=null;return{add:function(r){t==0&&(e=kq())&&(Aq(e,r),Iq(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Pq=function(){var t=Mq();return function(e,r){P.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&r])}},O3=function(){var t=Pq(),e=function(r){var l=r.styles,u=r.dynamic;return t(l,u),null};return e},Rq={left:0,top:0,right:0,gap:0},Y1=function(t){return parseInt(t||"",10)||0},Nq=function(t){var e=window.getComputedStyle(document.body),r=e[t==="padding"?"paddingLeft":"marginLeft"],l=e[t==="padding"?"paddingTop":"marginTop"],u=e[t==="padding"?"paddingRight":"marginRight"];return[Y1(r),Y1(l),Y1(u)]},Dq=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Rq;var e=Nq(t),r=document.documentElement.clientWidth,l=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,l-r+e[2]-e[0])}},Lq=O3(),Pm="data-scroll-locked",jq=function(t,e,r,l){var u=t.left,m=t.top,v=t.right,b=t.gap;return r===void 0&&(r="margin"),`
  .`.concat(yq,` {
   overflow: hidden `).concat(l,`;
   padding-right: `).concat(b,"px ").concat(l,`;
  }
  body[`).concat(Pm,`] {
    overflow: hidden `).concat(l,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(l,";"),r==="margin"&&`
    padding-left: `.concat(u,`px;
    padding-top: `).concat(m,`px;
    padding-right: `).concat(v,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(b,"px ").concat(l,`;
    `),r==="padding"&&"padding-right: ".concat(b,"px ").concat(l,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Lx,` {
    right: `).concat(b,"px ").concat(l,`;
  }
  
  .`).concat(jx,` {
    margin-right: `).concat(b,"px ").concat(l,`;
  }
  
  .`).concat(Lx," .").concat(Lx,` {
    right: 0 `).concat(l,`;
  }
  
  .`).concat(jx," .").concat(jx,` {
    margin-right: 0 `).concat(l,`;
  }
  
  body[`).concat(Pm,`] {
    `).concat(_q,": ").concat(b,`px;
  }
`)},nI=function(){var t=parseInt(document.body.getAttribute(Pm)||"0",10);return isFinite(t)?t:0},Oq=function(){P.useEffect(function(){return document.body.setAttribute(Pm,(nI()+1).toString()),function(){var t=nI()-1;t<=0?document.body.removeAttribute(Pm):document.body.setAttribute(Pm,t.toString())}},[])},zq=function(t){var e=t.noRelative,r=t.noImportant,l=t.gapMode,u=l===void 0?"margin":l;Oq();var m=P.useMemo(function(){return Dq(u)},[u]);return P.createElement(Lq,{styles:jq(m,!e,u,r?"":"!important")})},ob=!1;if(typeof window<"u")try{var mx=Object.defineProperty({},"passive",{get:function(){return ob=!0,!0}});window.addEventListener("test",mx,mx),window.removeEventListener("test",mx,mx)}catch{ob=!1}var um=ob?{passive:!1}:!1,Bq=function(t){return t.tagName==="TEXTAREA"},z3=function(t,e){if(!(t instanceof Element))return!1;var r=window.getComputedStyle(t);return r[e]!=="hidden"&&!(r.overflowY===r.overflowX&&!Bq(t)&&r[e]==="visible")},Fq=function(t){return z3(t,"overflowY")},Vq=function(t){return z3(t,"overflowX")},rI=function(t,e){var r=e.ownerDocument,l=e;do{typeof ShadowRoot<"u"&&l instanceof ShadowRoot&&(l=l.host);var u=B3(t,l);if(u){var m=F3(t,l),v=m[1],b=m[2];if(v>b)return!0}l=l.parentNode}while(l&&l!==r.body);return!1},Uq=function(t){var e=t.scrollTop,r=t.scrollHeight,l=t.clientHeight;return[e,r,l]},$q=function(t){var e=t.scrollLeft,r=t.scrollWidth,l=t.clientWidth;return[e,r,l]},B3=function(t,e){return t==="v"?Fq(e):Vq(e)},F3=function(t,e){return t==="v"?Uq(e):$q(e)},Gq=function(t,e){return t==="h"&&e==="rtl"?-1:1},Hq=function(t,e,r,l,u){var m=Gq(t,window.getComputedStyle(e).direction),v=m*l,b=r.target,a=e.contains(b),k=!1,M=v>0,L=0,z=0;do{if(!b)break;var O=F3(t,b),K=O[0],H=O[1],Z=O[2],Y=H-Z-m*K;(K||Y)&&B3(t,b)&&(L+=Y,z+=K);var ee=b.parentNode;b=ee&&ee.nodeType===Node.DOCUMENT_FRAGMENT_NODE?ee.host:ee}while(!a&&b!==document.body||a&&(e.contains(b)||e===b));return(M&&Math.abs(L)<1||!M&&Math.abs(z)<1)&&(k=!0),k},gx=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},iI=function(t){return[t.deltaX,t.deltaY]},sI=function(t){return t&&"current"in t?t.current:t},Wq=function(t,e){return t[0]===e[0]&&t[1]===e[1]},qq=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},Zq=0,dm=[];function Xq(t){var e=P.useRef([]),r=P.useRef([0,0]),l=P.useRef(),u=P.useState(Zq++)[0],m=P.useState(O3)[0],v=P.useRef(t);P.useEffect(function(){v.current=t},[t]),P.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(u));var H=gq([t.lockRef.current],(t.shards||[]).map(sI),!0).filter(Boolean);return H.forEach(function(Z){return Z.classList.add("allow-interactivity-".concat(u))}),function(){document.body.classList.remove("block-interactivity-".concat(u)),H.forEach(function(Z){return Z.classList.remove("allow-interactivity-".concat(u))})}}},[t.inert,t.lockRef.current,t.shards]);var b=P.useCallback(function(H,Z){if("touches"in H&&H.touches.length===2||H.type==="wheel"&&H.ctrlKey)return!v.current.allowPinchZoom;var Y=gx(H),ee=r.current,ie="deltaX"in H?H.deltaX:ee[0]-Y[0],pe="deltaY"in H?H.deltaY:ee[1]-Y[1],we,ke=H.target,ze=Math.abs(ie)>Math.abs(pe)?"h":"v";if("touches"in H&&ze==="h"&&ke.type==="range")return!1;var Ge=window.getSelection(),tt=Ge&&Ge.anchorNode,Pe=tt?tt===ke||tt.contains(ke):!1;if(Pe)return!1;var ot=rI(ze,ke);if(!ot)return!0;if(ot?we=ze:(we=ze==="v"?"h":"v",ot=rI(ze,ke)),!ot)return!1;if(!l.current&&"changedTouches"in H&&(ie||pe)&&(l.current=we),!we)return!0;var ut=l.current||we;return Hq(ut,Z,H,ut==="h"?ie:pe)},[]),a=P.useCallback(function(H){var Z=H;if(!(!dm.length||dm[dm.length-1]!==m)){var Y="deltaY"in Z?iI(Z):gx(Z),ee=e.current.filter(function(we){return we.name===Z.type&&(we.target===Z.target||Z.target===we.shadowParent)&&Wq(we.delta,Y)})[0];if(ee&&ee.should){Z.cancelable&&Z.preventDefault();return}if(!ee){var ie=(v.current.shards||[]).map(sI).filter(Boolean).filter(function(we){return we.contains(Z.target)}),pe=ie.length>0?b(Z,ie[0]):!v.current.noIsolation;pe&&Z.cancelable&&Z.preventDefault()}}},[]),k=P.useCallback(function(H,Z,Y,ee){var ie={name:H,delta:Z,target:Y,should:ee,shadowParent:Kq(Y)};e.current.push(ie),setTimeout(function(){e.current=e.current.filter(function(pe){return pe!==ie})},1)},[]),M=P.useCallback(function(H){r.current=gx(H),l.current=void 0},[]),L=P.useCallback(function(H){k(H.type,iI(H),H.target,b(H,t.lockRef.current))},[]),z=P.useCallback(function(H){k(H.type,gx(H),H.target,b(H,t.lockRef.current))},[]);P.useEffect(function(){return dm.push(m),t.setCallbacks({onScrollCapture:L,onWheelCapture:L,onTouchMoveCapture:z}),document.addEventListener("wheel",a,um),document.addEventListener("touchmove",a,um),document.addEventListener("touchstart",M,um),function(){dm=dm.filter(function(H){return H!==m}),document.removeEventListener("wheel",a,um),document.removeEventListener("touchmove",a,um),document.removeEventListener("touchstart",M,um)}},[]);var O=t.removeScrollBar,K=t.inert;return P.createElement(P.Fragment,null,K?P.createElement(m,{styles:qq(u)}):null,O?P.createElement(zq,{noRelative:t.noRelative,gapMode:t.gapMode}):null)}function Kq(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const Yq=Eq(j3,Xq);var e0=P.forwardRef(function(t,e){return P.createElement(Qv,Fc({},t,{ref:e,sideCar:Yq}))});e0.classNames=Qv.classNames;var Jq=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},hm=new WeakMap,yx=new WeakMap,_x={},J1=0,V3=function(t){return t&&(t.host||V3(t.parentNode))},Qq=function(t,e){return e.map(function(r){if(t.contains(r))return r;var l=V3(r);return l&&t.contains(l)?l:(console.error("aria-hidden",r,"in not contained inside",t,". Doing nothing"),null)}).filter(function(r){return!!r})},eZ=function(t,e,r,l){var u=Qq(e,Array.isArray(t)?t:[t]);_x[r]||(_x[r]=new WeakMap);var m=_x[r],v=[],b=new Set,a=new Set(u),k=function(L){!L||b.has(L)||(b.add(L),k(L.parentNode))};u.forEach(k);var M=function(L){!L||a.has(L)||Array.prototype.forEach.call(L.children,function(z){if(b.has(z))M(z);else try{var O=z.getAttribute(l),K=O!==null&&O!=="false",H=(hm.get(z)||0)+1,Z=(m.get(z)||0)+1;hm.set(z,H),m.set(z,Z),v.push(z),H===1&&K&&yx.set(z,!0),Z===1&&z.setAttribute(r,"true"),K||z.setAttribute(l,"true")}catch(Y){console.error("aria-hidden: cannot operate on ",z,Y)}})};return M(e),b.clear(),J1++,function(){v.forEach(function(L){var z=hm.get(L)-1,O=m.get(L)-1;hm.set(L,z),m.set(L,O),z||(yx.has(L)||L.removeAttribute(l),yx.delete(L)),O||L.removeAttribute(r)}),J1--,J1||(hm=new WeakMap,hm=new WeakMap,yx=new WeakMap,_x={})}},WT=function(t,e,r){r===void 0&&(r="data-aria-hidden");var l=Array.from(Array.isArray(t)?t:[t]),u=Jq(t);return u?(l.push.apply(l,Array.from(u.querySelectorAll("[aria-live], script"))),eZ(l,u,r,"aria-hidden")):function(){return null}};function tZ(t){const e=nZ(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(iZ);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function nZ(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=oZ(u),b=sZ(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var rZ=Symbol("radix.slottable");function iZ(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===rZ}function sZ(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function oZ(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var t0="Dialog",[U3]=sl(t0),[aZ,ql]=U3(t0),$3=t=>{const{__scopeDialog:e,children:r,open:l,defaultOpen:u,onOpenChange:m,modal:v=!0}=t,b=P.useRef(null),a=P.useRef(null),[k,M]=hh({prop:l,defaultProp:u??!1,onChange:m,caller:t0});return x.jsx(aZ,{scope:e,triggerRef:b,contentRef:a,contentId:$c(),titleId:$c(),descriptionId:$c(),open:k,onOpenChange:M,onOpenToggle:P.useCallback(()=>M(L=>!L),[M]),modal:v,children:r})};$3.displayName=t0;var G3="DialogTrigger",H3=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(G3,r),m=ir(e,u.triggerRef);return x.jsx(Mn.button,{type:"button","aria-haspopup":"dialog","aria-expanded":u.open,"aria-controls":u.contentId,"data-state":XT(u.open),...l,ref:m,onClick:Xt(t.onClick,u.onOpenToggle)})});H3.displayName=G3;var qT="DialogPortal",[lZ,W3]=U3(qT,{forceMount:void 0}),q3=t=>{const{__scopeDialog:e,forceMount:r,children:l,container:u}=t,m=ql(qT,e);return x.jsx(lZ,{scope:e,forceMount:r,children:P.Children.map(l,v=>x.jsx(jo,{present:r||m.open,children:x.jsx(Zy,{asChild:!0,container:u,children:v})}))})};q3.displayName=qT;var cv="DialogOverlay",Z3=P.forwardRef((t,e)=>{const r=W3(cv,t.__scopeDialog),{forceMount:l=r.forceMount,...u}=t,m=ql(cv,t.__scopeDialog);return m.modal?x.jsx(jo,{present:l||m.open,children:x.jsx(uZ,{...u,ref:e})}):null});Z3.displayName=cv;var cZ=tZ("DialogOverlay.RemoveScroll"),uZ=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(cv,r);return x.jsx(e0,{as:cZ,allowPinchZoom:!0,shards:[u.contentRef],children:x.jsx(Mn.div,{"data-state":XT(u.open),...l,ref:e,style:{pointerEvents:"auto",...l.style}})})}),Jf="DialogContent",X3=P.forwardRef((t,e)=>{const r=W3(Jf,t.__scopeDialog),{forceMount:l=r.forceMount,...u}=t,m=ql(Jf,t.__scopeDialog);return x.jsx(jo,{present:l||m.open,children:m.modal?x.jsx(dZ,{...u,ref:e}):x.jsx(hZ,{...u,ref:e})})});X3.displayName=Jf;var dZ=P.forwardRef((t,e)=>{const r=ql(Jf,t.__scopeDialog),l=P.useRef(null),u=ir(e,r.contentRef,l);return P.useEffect(()=>{const m=l.current;if(m)return WT(m)},[]),x.jsx(K3,{...t,ref:u,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Xt(t.onCloseAutoFocus,m=>{m.preventDefault(),r.triggerRef.current?.focus()}),onPointerDownOutside:Xt(t.onPointerDownOutside,m=>{const v=m.detail.originalEvent,b=v.button===0&&v.ctrlKey===!0;(v.button===2||b)&&m.preventDefault()}),onFocusOutside:Xt(t.onFocusOutside,m=>m.preventDefault())})}),hZ=P.forwardRef((t,e)=>{const r=ql(Jf,t.__scopeDialog),l=P.useRef(!1),u=P.useRef(!1);return x.jsx(K3,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:m=>{t.onCloseAutoFocus?.(m),m.defaultPrevented||(l.current||r.triggerRef.current?.focus(),m.preventDefault()),l.current=!1,u.current=!1},onInteractOutside:m=>{t.onInteractOutside?.(m),m.defaultPrevented||(l.current=!0,m.detail.originalEvent.type==="pointerdown"&&(u.current=!0));const v=m.target;r.triggerRef.current?.contains(v)&&m.preventDefault(),m.detail.originalEvent.type==="focusin"&&u.current&&m.preventDefault()}})}),K3=P.forwardRef((t,e)=>{const{__scopeDialog:r,trapFocus:l,onOpenAutoFocus:u,onCloseAutoFocus:m,...v}=t,b=ql(Jf,r),a=P.useRef(null),k=ir(e,a);return HT(),x.jsxs(x.Fragment,{children:[x.jsx(Jv,{asChild:!0,loop:!0,trapped:l,onMountAutoFocus:u,onUnmountAutoFocus:m,children:x.jsx(Gm,{role:"dialog",id:b.contentId,"aria-describedby":b.descriptionId,"aria-labelledby":b.titleId,"data-state":XT(b.open),...v,ref:k,onDismiss:()=>b.onOpenChange(!1)})}),x.jsxs(x.Fragment,{children:[x.jsx(fZ,{titleId:b.titleId}),x.jsx(mZ,{contentRef:a,descriptionId:b.descriptionId})]})]})}),ZT="DialogTitle",Y3=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(ZT,r);return x.jsx(Mn.h2,{id:u.titleId,...l,ref:e})});Y3.displayName=ZT;var J3="DialogDescription",Q3=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(J3,r);return x.jsx(Mn.p,{id:u.descriptionId,...l,ref:e})});Q3.displayName=J3;var eD="DialogClose",tD=P.forwardRef((t,e)=>{const{__scopeDialog:r,...l}=t,u=ql(eD,r);return x.jsx(Mn.button,{type:"button",...l,ref:e,onClick:Xt(t.onClick,()=>u.onOpenChange(!1))})});tD.displayName=eD;function XT(t){return t?"open":"closed"}var nD="DialogTitleWarning",[QJ,rD]=pj(nD,{contentName:Jf,titleName:ZT,docsSlug:"dialog"}),fZ=({titleId:t})=>{const e=rD(nD),r=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return P.useEffect(()=>{t&&(document.getElementById(t)||console.error(r))},[r,t]),null},pZ="DialogDescriptionWarning",mZ=({contentRef:t,descriptionId:e})=>{const l=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${rD(pZ).contentName}}.`;return P.useEffect(()=>{const u=t.current?.getAttribute("aria-describedby");e&&u&&(document.getElementById(e)||console.warn(l))},[l,t,e]),null},iD=$3,gZ=H3,sD=q3,n0=Z3,r0=X3,i0=Y3,s0=Q3,oD=tD;const KT=iD,yZ=sD,aD=P.forwardRef(({className:t,...e},r)=>x.jsx(n0,{ref:r,className:ln("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e}));aD.displayName=n0.displayName;const o0=P.forwardRef(({className:t,children:e,...r},l)=>x.jsxs(yZ,{children:[x.jsx(aD,{}),x.jsxs(r0,{ref:l,className:ln("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[e,x.jsxs(oD,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-accent data-[state=open]:text-muted-foreground hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[x.jsx(ti,{className:"h-4 w-4"}),x.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));o0.displayName=r0.displayName;const YT=({className:t,...e})=>x.jsx("div",{className:ln("flex flex-col space-y-1.5 text-center sm:text-left",t),...e});YT.displayName="DialogHeader";const JT=({className:t,...e})=>x.jsx("div",{className:ln("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...e});JT.displayName="DialogFooter";const a0=P.forwardRef(({className:t,...e},r)=>x.jsx(i0,{ref:r,className:ln("text-lg font-semibold leading-none tracking-tight",t),...e}));a0.displayName=i0.displayName;const _Z=P.forwardRef(({className:t,...e},r)=>x.jsx(s0,{ref:r,className:ln("text-sm text-muted-foreground",t),...e}));_Z.displayName=s0.displayName;var Q1="rovingFocusGroup.onEntryFocus",xZ={bubbles:!1,cancelable:!0},d_="RovingFocusGroup",[ab,lD,vZ]=wv(d_),[wZ,l0]=sl(d_,[vZ]),[bZ,TZ]=wZ(d_),cD=P.forwardRef((t,e)=>x.jsx(ab.Provider,{scope:t.__scopeRovingFocusGroup,children:x.jsx(ab.Slot,{scope:t.__scopeRovingFocusGroup,children:x.jsx(SZ,{...t,ref:e})})}));cD.displayName=d_;var SZ=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,orientation:l,loop:u=!1,dir:m,currentTabStopId:v,defaultCurrentTabStopId:b,onCurrentTabStopIdChange:a,onEntryFocus:k,preventScrollOnEntryFocus:M=!1,...L}=t,z=P.useRef(null),O=ir(e,z),K=u_(m),[H,Z]=hh({prop:v,defaultProp:b??null,onChange:a,caller:d_}),[Y,ee]=P.useState(!1),ie=Bi(k),pe=lD(r),we=P.useRef(!1),[ke,ze]=P.useState(0);return P.useEffect(()=>{const Ge=z.current;if(Ge)return Ge.addEventListener(Q1,ie),()=>Ge.removeEventListener(Q1,ie)},[ie]),x.jsx(bZ,{scope:r,orientation:l,dir:K,loop:u,currentTabStopId:H,onItemFocus:P.useCallback(Ge=>Z(Ge),[Z]),onItemShiftTab:P.useCallback(()=>ee(!0),[]),onFocusableItemAdd:P.useCallback(()=>ze(Ge=>Ge+1),[]),onFocusableItemRemove:P.useCallback(()=>ze(Ge=>Ge-1),[]),children:x.jsx(Mn.div,{tabIndex:Y||ke===0?-1:0,"data-orientation":l,...L,ref:O,style:{outline:"none",...t.style},onMouseDown:Xt(t.onMouseDown,()=>{we.current=!0}),onFocus:Xt(t.onFocus,Ge=>{const tt=!we.current;if(Ge.target===Ge.currentTarget&&tt&&!Y){const Pe=new CustomEvent(Q1,xZ);if(Ge.currentTarget.dispatchEvent(Pe),!Pe.defaultPrevented){const ot=pe().filter(mt=>mt.focusable),ut=ot.find(mt=>mt.active),gt=ot.find(mt=>mt.id===H),Lt=[ut,gt,...ot].filter(Boolean).map(mt=>mt.ref.current);hD(Lt,M)}}we.current=!1}),onBlur:Xt(t.onBlur,()=>ee(!1))})})}),uD="RovingFocusGroupItem",dD=P.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:r,focusable:l=!0,active:u=!1,tabStopId:m,children:v,...b}=t,a=$c(),k=m||a,M=TZ(uD,r),L=M.currentTabStopId===k,z=lD(r),{onFocusableItemAdd:O,onFocusableItemRemove:K,currentTabStopId:H}=M;return P.useEffect(()=>{if(l)return O(),()=>K()},[l,O,K]),x.jsx(ab.ItemSlot,{scope:r,id:k,focusable:l,active:u,children:x.jsx(Mn.span,{tabIndex:L?0:-1,"data-orientation":M.orientation,...b,ref:e,onMouseDown:Xt(t.onMouseDown,Z=>{l?M.onItemFocus(k):Z.preventDefault()}),onFocus:Xt(t.onFocus,()=>M.onItemFocus(k)),onKeyDown:Xt(t.onKeyDown,Z=>{if(Z.key==="Tab"&&Z.shiftKey){M.onItemShiftTab();return}if(Z.target!==Z.currentTarget)return;const Y=kZ(Z,M.orientation,M.dir);if(Y!==void 0){if(Z.metaKey||Z.ctrlKey||Z.altKey||Z.shiftKey)return;Z.preventDefault();let ie=z().filter(pe=>pe.focusable).map(pe=>pe.ref.current);if(Y==="last")ie.reverse();else if(Y==="prev"||Y==="next"){Y==="prev"&&ie.reverse();const pe=ie.indexOf(Z.currentTarget);ie=M.loop?AZ(ie,pe+1):ie.slice(pe+1)}setTimeout(()=>hD(ie))}}),children:typeof v=="function"?v({isCurrentTabStop:L,hasTabStop:H!=null}):v})})});dD.displayName=uD;var EZ={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function CZ(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function kZ(t,e,r){const l=CZ(t.key,r);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(l))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(l)))return EZ[l]}function hD(t,e=!1){const r=document.activeElement;for(const l of t)if(l===r||(l.focus({preventScroll:e}),document.activeElement!==r))return}function AZ(t,e){return t.map((r,l)=>t[(e+l)%t.length])}var fD=cD,pD=dD,c0="Tabs",[IZ]=sl(c0,[l0]),mD=l0(),[MZ,QT]=IZ(c0),gD=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,onValueChange:u,defaultValue:m,orientation:v="horizontal",dir:b,activationMode:a="automatic",...k}=t,M=u_(b),[L,z]=hh({prop:l,onChange:u,defaultProp:m??"",caller:c0});return x.jsx(MZ,{scope:r,baseId:$c(),value:L,onValueChange:z,orientation:v,dir:M,activationMode:a,children:x.jsx(Mn.div,{dir:M,"data-orientation":v,...k,ref:e})})});gD.displayName=c0;var yD="TabsList",_D=P.forwardRef((t,e)=>{const{__scopeTabs:r,loop:l=!0,...u}=t,m=QT(yD,r),v=mD(r);return x.jsx(fD,{asChild:!0,...v,orientation:m.orientation,dir:m.dir,loop:l,children:x.jsx(Mn.div,{role:"tablist","aria-orientation":m.orientation,...u,ref:e})})});_D.displayName=yD;var xD="TabsTrigger",vD=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,disabled:u=!1,...m}=t,v=QT(xD,r),b=mD(r),a=TD(v.baseId,l),k=SD(v.baseId,l),M=l===v.value;return x.jsx(pD,{asChild:!0,...b,focusable:!u,active:M,children:x.jsx(Mn.button,{type:"button",role:"tab","aria-selected":M,"aria-controls":k,"data-state":M?"active":"inactive","data-disabled":u?"":void 0,disabled:u,id:a,...m,ref:e,onMouseDown:Xt(t.onMouseDown,L=>{!u&&L.button===0&&L.ctrlKey===!1?v.onValueChange(l):L.preventDefault()}),onKeyDown:Xt(t.onKeyDown,L=>{[" ","Enter"].includes(L.key)&&v.onValueChange(l)}),onFocus:Xt(t.onFocus,()=>{const L=v.activationMode!=="manual";!M&&!u&&L&&v.onValueChange(l)})})})});vD.displayName=xD;var wD="TabsContent",bD=P.forwardRef((t,e)=>{const{__scopeTabs:r,value:l,forceMount:u,children:m,...v}=t,b=QT(wD,r),a=TD(b.baseId,l),k=SD(b.baseId,l),M=l===b.value,L=P.useRef(M);return P.useEffect(()=>{const z=requestAnimationFrame(()=>L.current=!1);return()=>cancelAnimationFrame(z)},[]),x.jsx(jo,{present:u||M,children:({present:z})=>x.jsx(Mn.div,{"data-state":M?"active":"inactive","data-orientation":b.orientation,role:"tabpanel","aria-labelledby":a,hidden:!z,id:k,tabIndex:0,...v,ref:e,style:{...t.style,animationDuration:L.current?"0s":void 0},children:z&&m})})});bD.displayName=wD;function TD(t,e){return`${t}-trigger-${e}`}function SD(t,e){return`${t}-content-${e}`}var PZ=gD,ED=_D,CD=vD,kD=bD;const uv=PZ,Vy=P.forwardRef(({className:t,...e},r)=>x.jsx(ED,{ref:r,className:ln("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...e}));Vy.displayName=ED.displayName;const qs=P.forwardRef(({className:t,...e},r)=>x.jsx(CD,{ref:r,className:ln("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",t),...e}));qs.displayName=CD.displayName;const Sa=P.forwardRef(({className:t,...e},r)=>x.jsx(kD,{ref:r,className:ln("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...e}));Sa.displayName=kD.displayName;const gh=P.forwardRef(({className:t,...e},r)=>x.jsx("textarea",{className:ln("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...e}));gh.displayName="Textarea";function RZ(t,e=[]){let r=[];function l(m,v){const b=P.createContext(v);b.displayName=m+"Context";const a=r.length;r=[...r,v];const k=L=>{const{scope:z,children:O,...K}=L,H=z?.[t]?.[a]||b,Z=P.useMemo(()=>K,Object.values(K));return x.jsx(H.Provider,{value:Z,children:O})};k.displayName=m+"Provider";function M(L,z){const O=z?.[t]?.[a]||b,K=P.useContext(O);if(K)return K;if(v!==void 0)return v;throw new Error(`\`${L}\` must be used within \`${m}\``)}return[k,M]}const u=()=>{const m=r.map(v=>P.createContext(v));return function(b){const a=b?.[t]||m;return P.useMemo(()=>({[`__scope${t}`]:{...b,[t]:a}}),[b,a])}};return u.scopeName=t,[l,NZ(u,...e)]}function NZ(...t){const e=t[0];if(t.length===1)return e;const r=()=>{const l=t.map(u=>({useScope:u(),scopeName:u.scopeName}));return function(m){const v=l.reduce((b,{useScope:a,scopeName:k})=>{const L=a(m)[`__scope${k}`];return{...b,...L}},{});return P.useMemo(()=>({[`__scope${e.scopeName}`]:v}),[v])}};return r.scopeName=e.scopeName,r}var DZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],eS=DZ.reduce((t,e)=>{const r=BT(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{}),ew={exports:{}},tw={};var oI;function LZ(){if(oI)return tw;oI=1;var t=xv();function e(L,z){return L===z&&(L!==0||1/L===1/z)||L!==L&&z!==z}var r=typeof Object.is=="function"?Object.is:e,l=t.useState,u=t.useEffect,m=t.useLayoutEffect,v=t.useDebugValue;function b(L,z){var O=z(),K=l({inst:{value:O,getSnapshot:z}}),H=K[0].inst,Z=K[1];return m(function(){H.value=O,H.getSnapshot=z,a(H)&&Z({inst:H})},[L,O,z]),u(function(){return a(H)&&Z({inst:H}),L(function(){a(H)&&Z({inst:H})})},[L]),v(O),O}function a(L){var z=L.getSnapshot;L=L.value;try{var O=z();return!r(L,O)}catch{return!0}}function k(L,z){return z()}var M=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?k:b;return tw.useSyncExternalStore=t.useSyncExternalStore!==void 0?t.useSyncExternalStore:M,tw}var aI;function jZ(){return aI||(aI=1,ew.exports=LZ()),ew.exports}var OZ=jZ();function zZ(){return OZ.useSyncExternalStore(BZ,()=>!0,()=>!1)}function BZ(){return()=>{}}var tS="Avatar",[FZ]=RZ(tS),[VZ,AD]=FZ(tS),ID=P.forwardRef((t,e)=>{const{__scopeAvatar:r,...l}=t,[u,m]=P.useState("idle");return x.jsx(VZ,{scope:r,imageLoadingStatus:u,onImageLoadingStatusChange:m,children:x.jsx(eS.span,{...l,ref:e})})});ID.displayName=tS;var MD="AvatarImage",PD=P.forwardRef((t,e)=>{const{__scopeAvatar:r,src:l,onLoadingStatusChange:u=()=>{},...m}=t,v=AD(MD,r),b=UZ(l,m),a=Bi(k=>{u(k),v.onImageLoadingStatusChange(k)});return Hi(()=>{b!=="idle"&&a(b)},[b,a]),b==="loaded"?x.jsx(eS.img,{...m,ref:e,src:l}):null});PD.displayName=MD;var RD="AvatarFallback",ND=P.forwardRef((t,e)=>{const{__scopeAvatar:r,delayMs:l,...u}=t,m=AD(RD,r),[v,b]=P.useState(l===void 0);return P.useEffect(()=>{if(l!==void 0){const a=window.setTimeout(()=>b(!0),l);return()=>window.clearTimeout(a)}},[l]),v&&m.imageLoadingStatus!=="loaded"?x.jsx(eS.span,{...u,ref:e}):null});ND.displayName=RD;function lI(t,e){return t?e?(t.src!==e&&(t.src=e),t.complete&&t.naturalWidth>0?"loaded":"loading"):"error":"idle"}function UZ(t,{referrerPolicy:e,crossOrigin:r}){const l=zZ(),u=P.useRef(null),m=l?(u.current||(u.current=new window.Image),u.current):null,[v,b]=P.useState(()=>lI(m,t));return Hi(()=>{b(lI(m,t))},[m,t]),Hi(()=>{const a=L=>()=>{b(L)};if(!m)return;const k=a("loaded"),M=a("error");return m.addEventListener("load",k),m.addEventListener("error",M),e&&(m.referrerPolicy=e),typeof r=="string"&&(m.crossOrigin=r),()=>{m.removeEventListener("load",k),m.removeEventListener("error",M)}},[m,r,e]),v}var DD=ID,LD=PD,jD=ND;const nS=P.forwardRef(({className:t,...e},r)=>x.jsx(DD,{ref:r,className:ln("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...e}));nS.displayName=DD.displayName;const OD=P.forwardRef(({className:t,...e},r)=>x.jsx(LD,{ref:r,className:ln("aspect-square h-full w-full",t),...e}));OD.displayName=LD.displayName;const rS=P.forwardRef(({className:t,...e},r)=>x.jsx(jD,{ref:r,className:ln("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...e}));rS.displayName=jD.displayName;const cI="https://thodia-backend-1067502227654.asia-southeast1.run.app",$Z=({storeId:t})=>{const{user:e}=Oo(),[r,l]=P.useState([]),[u,m]=P.useState(5),[v,b]=P.useState(""),[a,k]=P.useState(!1),M=async()=>{if(!t)return;const O=String(t);try{const H=await(await fetch(`${cI}/api/reviews/list/${O}`)).json();Array.isArray(H)&&l(H)}catch(K){console.error("Li ti review:",K)}};P.useEffect(()=>{M()},[t]);const L=async()=>{if(!e){Ht.error("Vui lng ng nhp  nh gi!");return}if(!v.trim()){Ht.error("Vui lng nhp ni dung nh gi.");return}k(!0);try{const O=String(t);if(!(await fetch(`${cI}/api/reviews`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:O,userId:e.uid,rating:u,comment:v})})).ok)throw new Error("Failed");Ht.success("Cm n nh gi ca bn!"),window.dispatchEvent(new CustomEvent("review_updated",{detail:O})),b(""),m(5),M()}catch(O){console.error(O),Ht.error("Khng gi c nh gi")}finally{k(!1)}},z=r.length>0?(r.reduce((O,K)=>O+K.rating,0)/r.length).toFixed(1):"0.0";return x.jsxs("div",{className:"space-y-6",children:[x.jsxs("div",{className:"bg-orange-50 p-4 rounded-xl flex items-center gap-4 border border-orange-100",children:[x.jsxs("div",{className:"text-center",children:[x.jsx("h3",{className:"text-3xl font-black text-orange-600",children:z}),x.jsx("div",{className:"flex gap-0.5 justify-center my-1",children:[1,2,3,4,5].map(O=>x.jsx(Vf,{className:`w-3 h-3 ${O<=Number(z)?"fill-orange-500 text-orange-500":"text-gray-300"}`},O))}),x.jsxs("p",{className:"text-xs text-gray-500",children:[r.length," nh gi"]})]}),x.jsx("div",{className:"flex-1 h-full w-[1px] bg-orange-200 mx-2"}),x.jsx("div",{className:"flex-1 text-sm text-gray-600 italic",children:'"Hy  li nh gi  gip cng ng tm c nhng a im tt nht nh!"'})]}),e?x.jsxs("div",{className:"bg-white border rounded-xl p-4 shadow-sm",children:[x.jsxs("h4",{className:"font-bold text-gray-800 mb-2 flex items-center gap-2",children:[x.jsx(Cy,{className:"w-4 h-4"})," Vit nh gi ca bn"]}),x.jsxs("div",{className:"flex gap-1 mb-3",children:[[1,2,3,4,5].map(O=>x.jsx("button",{onClick:()=>m(O),className:"transition-transform hover:scale-110 focus:outline-none",children:x.jsx(Vf,{className:`w-6 h-6 ${O<=u?"fill-yellow-400 text-yellow-400":"text-gray-300"}`})},O)),x.jsx("span",{className:"ml-2 text-sm font-medium text-gray-500 pt-1",children:u===5?"Tuyt vi":u===4?"Hi lng":u===3?"Bnh thng":"T"})]}),x.jsx(gh,{placeholder:"Chia s tri nghim ca bn v a im ny...",value:v,onChange:O=>b(O.target.value),className:"min-h-[80px] mb-3 bg-gray-50"}),x.jsx("div",{className:"flex justify-end",children:x.jsxs(_n,{size:"sm",onClick:L,disabled:a,className:"bg-orange-500 hover:bg-orange-600 text-white",children:[a?x.jsx(Fi,{className:"w-4 h-4 animate-spin mr-2"}):x.jsx(DO,{className:"w-4 h-4 mr-2"}),a?"ang gi...":"Gi nh gi"]})})]}):x.jsx("div",{className:"text-center p-4 bg-gray-100 rounded-xl text-sm text-gray-500",children:"Vui lng ng nhp  vit nh gi."}),x.jsx("div",{className:"space-y-4",children:r.length===0?x.jsx("p",{className:"text-center text-gray-400 py-4",children:"Cha c nh gi no."}):r.map(O=>x.jsxs("div",{className:"border-b pb-4 last:border-0",children:[x.jsxs("div",{className:"flex justify-between items-start mb-1",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(nS,{className:"w-8 h-8",children:x.jsx(rS,{className:"bg-blue-100 text-blue-600 text-xs",children:"U"})}),x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold text-gray-900",children:"Ngi dng n danh"}),x.jsx("div",{className:"flex gap-0.5",children:[1,2,3,4,5].map(K=>x.jsx(Vf,{className:`w-3 h-3 ${K<=O.rating?"fill-yellow-400 text-yellow-400":"text-gray-200"}`},K))})]})]}),x.jsx("span",{className:"text-[10px] text-gray-400",children:new Date(O.created_at).toLocaleDateString("vi-VN")})]}),x.jsx("p",{className:"text-sm text-gray-600 pl-10 mt-1",children:O.comment})]},O.id))})]})};var GZ=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],HZ=GZ.reduce((t,e)=>{const r=BT(`Primitive.${e}`),l=P.forwardRef((u,m)=>{const{asChild:v,...b}=u,a=v?r:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),x.jsx(a,{...b,ref:m})});return l.displayName=`Primitive.${e}`,{...t,[e]:l}},{}),WZ="Label",zD=P.forwardRef((t,e)=>x.jsx(HZ.label,{...t,ref:e,onMouseDown:r=>{r.target.closest("button, input, select, textarea")||(t.onMouseDown?.(r),!r.defaultPrevented&&r.detail>1&&r.preventDefault())}}));zD.displayName=WZ;var BD=zD;const qZ=Ky("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),ui=P.forwardRef(({className:t,...e},r)=>x.jsx(BD,{ref:r,className:ln(qZ(),t),...e}));ui.displayName=BD.displayName;function ZZ(t){const e=XZ(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(YZ);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function XZ(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=QZ(u),b=JZ(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var KZ=Symbol("radix.slottable");function YZ(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===KZ}function JZ(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function QZ(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}function FD(t){const e=P.useRef({value:t,previous:t});return P.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var eX=[" ","Enter","ArrowUp","ArrowDown"],tX=[" ","Enter"],Qf="Select",[u0,d0,nX]=wv(Qf),[tg]=sl(Qf,[nX,Zm]),h0=Zm(),[rX,Sh]=tg(Qf),[iX,sX]=tg(Qf),VD=t=>{const{__scopeSelect:e,children:r,open:l,defaultOpen:u,onOpenChange:m,value:v,defaultValue:b,onValueChange:a,dir:k,name:M,autoComplete:L,disabled:z,required:O,form:K}=t,H=h0(e),[Z,Y]=P.useState(null),[ee,ie]=P.useState(null),[pe,we]=P.useState(!1),ke=u_(k),[ze,Ge]=hh({prop:l,defaultProp:u??!1,onChange:m,caller:Qf}),[tt,Pe]=hh({prop:v,defaultProp:b,onChange:a,caller:Qf}),ot=P.useRef(null),ut=Z?K||!!Z.closest("form"):!0,[gt,ht]=P.useState(new Set),Lt=Array.from(gt).map(mt=>mt.props.value).join(";");return x.jsx(oP,{...H,children:x.jsxs(rX,{required:O,scope:e,trigger:Z,onTriggerChange:Y,valueNode:ee,onValueNodeChange:ie,valueNodeHasChildren:pe,onValueNodeHasChildrenChange:we,contentId:$c(),value:tt,onValueChange:Pe,open:ze,onOpenChange:Ge,dir:ke,triggerPointerDownPosRef:ot,disabled:z,children:[x.jsx(u0.Provider,{scope:e,children:x.jsx(iX,{scope:t.__scopeSelect,onNativeOptionAdd:P.useCallback(mt=>{ht(pt=>new Set(pt).add(mt))},[]),onNativeOptionRemove:P.useCallback(mt=>{ht(pt=>{const Ae=new Set(pt);return Ae.delete(mt),Ae})},[]),children:r})}),ut?x.jsxs(d4,{"aria-hidden":!0,required:O,tabIndex:-1,name:M,autoComplete:L,value:tt,onChange:mt=>Pe(mt.target.value),disabled:z,form:K,children:[tt===void 0?x.jsx("option",{value:""}):null,Array.from(gt)]},Lt):null]})})};VD.displayName=Qf;var UD="SelectTrigger",$D=P.forwardRef((t,e)=>{const{__scopeSelect:r,disabled:l=!1,...u}=t,m=h0(r),v=Sh(UD,r),b=v.disabled||l,a=ir(e,v.onTriggerChange),k=d0(r),M=P.useRef("touch"),[L,z,O]=f4(H=>{const Z=k().filter(ie=>!ie.disabled),Y=Z.find(ie=>ie.value===v.value),ee=p4(Z,H,Y);ee!==void 0&&v.onValueChange(ee.value)}),K=H=>{b||(v.onOpenChange(!0),O()),H&&(v.triggerPointerDownPosRef.current={x:Math.round(H.pageX),y:Math.round(H.pageY)})};return x.jsx(Fb,{asChild:!0,...m,children:x.jsx(Mn.button,{type:"button",role:"combobox","aria-controls":v.contentId,"aria-expanded":v.open,"aria-required":v.required,"aria-autocomplete":"none",dir:v.dir,"data-state":v.open?"open":"closed",disabled:b,"data-disabled":b?"":void 0,"data-placeholder":h4(v.value)?"":void 0,...u,ref:a,onClick:Xt(u.onClick,H=>{H.currentTarget.focus(),M.current!=="mouse"&&K(H)}),onPointerDown:Xt(u.onPointerDown,H=>{M.current=H.pointerType;const Z=H.target;Z.hasPointerCapture(H.pointerId)&&Z.releasePointerCapture(H.pointerId),H.button===0&&H.ctrlKey===!1&&H.pointerType==="mouse"&&(K(H),H.preventDefault())}),onKeyDown:Xt(u.onKeyDown,H=>{const Z=L.current!=="";!(H.ctrlKey||H.altKey||H.metaKey)&&H.key.length===1&&z(H.key),!(Z&&H.key===" ")&&eX.includes(H.key)&&(K(),H.preventDefault())})})})});$D.displayName=UD;var GD="SelectValue",HD=P.forwardRef((t,e)=>{const{__scopeSelect:r,className:l,style:u,children:m,placeholder:v="",...b}=t,a=Sh(GD,r),{onValueNodeHasChildrenChange:k}=a,M=m!==void 0,L=ir(e,a.onValueNodeChange);return Hi(()=>{k(M)},[k,M]),x.jsx(Mn.span,{...b,ref:L,style:{pointerEvents:"none"},children:h4(a.value)?x.jsx(x.Fragment,{children:v}):m})});HD.displayName=GD;var oX="SelectIcon",WD=P.forwardRef((t,e)=>{const{__scopeSelect:r,children:l,...u}=t;return x.jsx(Mn.span,{"aria-hidden":!0,...u,ref:e,children:l||""})});WD.displayName=oX;var aX="SelectPortal",qD=t=>x.jsx(Zy,{asChild:!0,...t});qD.displayName=aX;var ep="SelectContent",ZD=P.forwardRef((t,e)=>{const r=Sh(ep,t.__scopeSelect),[l,u]=P.useState();if(Hi(()=>{u(new DocumentFragment)},[]),!r.open){const m=l;return m?xh.createPortal(x.jsx(XD,{scope:t.__scopeSelect,children:x.jsx(u0.Slot,{scope:t.__scopeSelect,children:x.jsx("div",{children:t.children})})}),m):null}return x.jsx(KD,{...t,ref:e})});ZD.displayName=ep;var Vl=10,[XD,Eh]=tg(ep),lX="SelectContentImpl",cX=ZZ("SelectContent.RemoveScroll"),KD=P.forwardRef((t,e)=>{const{__scopeSelect:r,position:l="item-aligned",onCloseAutoFocus:u,onEscapeKeyDown:m,onPointerDownOutside:v,side:b,sideOffset:a,align:k,alignOffset:M,arrowPadding:L,collisionBoundary:z,collisionPadding:O,sticky:K,hideWhenDetached:H,avoidCollisions:Z,...Y}=t,ee=Sh(ep,r),[ie,pe]=P.useState(null),[we,ke]=P.useState(null),ze=ir(e,wt=>pe(wt)),[Ge,tt]=P.useState(null),[Pe,ot]=P.useState(null),ut=d0(r),[gt,ht]=P.useState(!1),Lt=P.useRef(!1);P.useEffect(()=>{if(ie)return WT(ie)},[ie]),HT();const mt=P.useCallback(wt=>{const[Kt,...Tn]=ut().map(tn=>tn.ref.current),[fn]=Tn.slice(-1),Cn=document.activeElement;for(const tn of wt)if(tn===Cn||(tn?.scrollIntoView({block:"nearest"}),tn===Kt&&we&&(we.scrollTop=0),tn===fn&&we&&(we.scrollTop=we.scrollHeight),tn?.focus(),document.activeElement!==Cn))return},[ut,we]),pt=P.useCallback(()=>mt([Ge,ie]),[mt,Ge,ie]);P.useEffect(()=>{gt&&pt()},[gt,pt]);const{onOpenChange:Ae,triggerPointerDownPosRef:xe}=ee;P.useEffect(()=>{if(ie){let wt={x:0,y:0};const Kt=fn=>{wt={x:Math.abs(Math.round(fn.pageX)-(xe.current?.x??0)),y:Math.abs(Math.round(fn.pageY)-(xe.current?.y??0))}},Tn=fn=>{wt.x<=10&&wt.y<=10?fn.preventDefault():ie.contains(fn.target)||Ae(!1),document.removeEventListener("pointermove",Kt),xe.current=null};return xe.current!==null&&(document.addEventListener("pointermove",Kt),document.addEventListener("pointerup",Tn,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Kt),document.removeEventListener("pointerup",Tn,{capture:!0})}}},[ie,Ae,xe]),P.useEffect(()=>{const wt=()=>Ae(!1);return window.addEventListener("blur",wt),window.addEventListener("resize",wt),()=>{window.removeEventListener("blur",wt),window.removeEventListener("resize",wt)}},[Ae]);const[We,he]=f4(wt=>{const Kt=ut().filter(Cn=>!Cn.disabled),Tn=Kt.find(Cn=>Cn.ref.current===document.activeElement),fn=p4(Kt,wt,Tn);fn&&setTimeout(()=>fn.ref.current.focus())}),Fe=P.useCallback((wt,Kt,Tn)=>{const fn=!Lt.current&&!Tn;(ee.value!==void 0&&ee.value===Kt||fn)&&(tt(wt),fn&&(Lt.current=!0))},[ee.value]),it=P.useCallback(()=>ie?.focus(),[ie]),vt=P.useCallback((wt,Kt,Tn)=>{const fn=!Lt.current&&!Tn;(ee.value!==void 0&&ee.value===Kt||fn)&&ot(wt)},[ee.value]),Wt=l==="popper"?lb:YD,rn=Wt===lb?{side:b,sideOffset:a,align:k,alignOffset:M,arrowPadding:L,collisionBoundary:z,collisionPadding:O,sticky:K,hideWhenDetached:H,avoidCollisions:Z}:{};return x.jsx(XD,{scope:r,content:ie,viewport:we,onViewportChange:ke,itemRefCallback:Fe,selectedItem:Ge,onItemLeave:it,itemTextRefCallback:vt,focusSelectedItem:pt,selectedItemText:Pe,position:l,isPositioned:gt,searchRef:We,children:x.jsx(e0,{as:cX,allowPinchZoom:!0,children:x.jsx(Jv,{asChild:!0,trapped:ee.open,onMountAutoFocus:wt=>{wt.preventDefault()},onUnmountAutoFocus:Xt(u,wt=>{ee.trigger?.focus({preventScroll:!0}),wt.preventDefault()}),children:x.jsx(Gm,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:m,onPointerDownOutside:v,onFocusOutside:wt=>wt.preventDefault(),onDismiss:()=>ee.onOpenChange(!1),children:x.jsx(Wt,{role:"listbox",id:ee.contentId,"data-state":ee.open?"open":"closed",dir:ee.dir,onContextMenu:wt=>wt.preventDefault(),...Y,...rn,onPlaced:()=>ht(!0),ref:ze,style:{display:"flex",flexDirection:"column",outline:"none",...Y.style},onKeyDown:Xt(Y.onKeyDown,wt=>{const Kt=wt.ctrlKey||wt.altKey||wt.metaKey;if(wt.key==="Tab"&&wt.preventDefault(),!Kt&&wt.key.length===1&&he(wt.key),["ArrowUp","ArrowDown","Home","End"].includes(wt.key)){let fn=ut().filter(Cn=>!Cn.disabled).map(Cn=>Cn.ref.current);if(["ArrowUp","End"].includes(wt.key)&&(fn=fn.slice().reverse()),["ArrowUp","ArrowDown"].includes(wt.key)){const Cn=wt.target,tn=fn.indexOf(Cn);fn=fn.slice(tn+1)}setTimeout(()=>mt(fn)),wt.preventDefault()}})})})})})})});KD.displayName=lX;var uX="SelectItemAlignedPosition",YD=P.forwardRef((t,e)=>{const{__scopeSelect:r,onPlaced:l,...u}=t,m=Sh(ep,r),v=Eh(ep,r),[b,a]=P.useState(null),[k,M]=P.useState(null),L=ir(e,ze=>M(ze)),z=d0(r),O=P.useRef(!1),K=P.useRef(!0),{viewport:H,selectedItem:Z,selectedItemText:Y,focusSelectedItem:ee}=v,ie=P.useCallback(()=>{if(m.trigger&&m.valueNode&&b&&k&&H&&Z&&Y){const ze=m.trigger.getBoundingClientRect(),Ge=k.getBoundingClientRect(),tt=m.valueNode.getBoundingClientRect(),Pe=Y.getBoundingClientRect();if(m.dir!=="rtl"){const Cn=Pe.left-Ge.left,tn=tt.left-Cn,mr=ze.left-tn,hr=ze.width+mr,_i=Math.max(hr,Ge.width),Xn=window.innerWidth-Vl,Er=sb(tn,[Vl,Math.max(Vl,Xn-_i)]);b.style.minWidth=hr+"px",b.style.left=Er+"px"}else{const Cn=Ge.right-Pe.right,tn=window.innerWidth-tt.right-Cn,mr=window.innerWidth-ze.right-tn,hr=ze.width+mr,_i=Math.max(hr,Ge.width),Xn=window.innerWidth-Vl,Er=sb(tn,[Vl,Math.max(Vl,Xn-_i)]);b.style.minWidth=hr+"px",b.style.right=Er+"px"}const ot=z(),ut=window.innerHeight-Vl*2,gt=H.scrollHeight,ht=window.getComputedStyle(k),Lt=parseInt(ht.borderTopWidth,10),mt=parseInt(ht.paddingTop,10),pt=parseInt(ht.borderBottomWidth,10),Ae=parseInt(ht.paddingBottom,10),xe=Lt+mt+gt+Ae+pt,We=Math.min(Z.offsetHeight*5,xe),he=window.getComputedStyle(H),Fe=parseInt(he.paddingTop,10),it=parseInt(he.paddingBottom,10),vt=ze.top+ze.height/2-Vl,Wt=ut-vt,rn=Z.offsetHeight/2,wt=Z.offsetTop+rn,Kt=Lt+mt+wt,Tn=xe-Kt;if(Kt<=vt){const Cn=ot.length>0&&Z===ot[ot.length-1].ref.current;b.style.bottom="0px";const tn=k.clientHeight-H.offsetTop-H.offsetHeight,mr=Math.max(Wt,rn+(Cn?it:0)+tn+pt),hr=Kt+mr;b.style.height=hr+"px"}else{const Cn=ot.length>0&&Z===ot[0].ref.current;b.style.top="0px";const mr=Math.max(vt,Lt+H.offsetTop+(Cn?Fe:0)+rn)+Tn;b.style.height=mr+"px",H.scrollTop=Kt-vt+H.offsetTop}b.style.margin=`${Vl}px 0`,b.style.minHeight=We+"px",b.style.maxHeight=ut+"px",l?.(),requestAnimationFrame(()=>O.current=!0)}},[z,m.trigger,m.valueNode,b,k,H,Z,Y,m.dir,l]);Hi(()=>ie(),[ie]);const[pe,we]=P.useState();Hi(()=>{k&&we(window.getComputedStyle(k).zIndex)},[k]);const ke=P.useCallback(ze=>{ze&&K.current===!0&&(ie(),ee?.(),K.current=!1)},[ie,ee]);return x.jsx(hX,{scope:r,contentWrapper:b,shouldExpandOnScrollRef:O,onScrollButtonChange:ke,children:x.jsx("div",{ref:a,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:pe},children:x.jsx(Mn.div,{...u,ref:L,style:{boxSizing:"border-box",maxHeight:"100%",...u.style}})})})});YD.displayName=uX;var dX="SelectPopperPosition",lb=P.forwardRef((t,e)=>{const{__scopeSelect:r,align:l="start",collisionPadding:u=Vl,...m}=t,v=h0(r);return x.jsx(Vb,{...v,...m,ref:e,align:l,collisionPadding:u,style:{boxSizing:"border-box",...m.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});lb.displayName=dX;var[hX,iS]=tg(ep,{}),cb="SelectViewport",JD=P.forwardRef((t,e)=>{const{__scopeSelect:r,nonce:l,...u}=t,m=Eh(cb,r),v=iS(cb,r),b=ir(e,m.onViewportChange),a=P.useRef(0);return x.jsxs(x.Fragment,{children:[x.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:l}),x.jsx(u0.Slot,{scope:r,children:x.jsx(Mn.div,{"data-radix-select-viewport":"",role:"presentation",...u,ref:b,style:{position:"relative",flex:1,overflow:"hidden auto",...u.style},onScroll:Xt(u.onScroll,k=>{const M=k.currentTarget,{contentWrapper:L,shouldExpandOnScrollRef:z}=v;if(z?.current&&L){const O=Math.abs(a.current-M.scrollTop);if(O>0){const K=window.innerHeight-Vl*2,H=parseFloat(L.style.minHeight),Z=parseFloat(L.style.height),Y=Math.max(H,Z);if(Y<K){const ee=Y+O,ie=Math.min(K,ee),pe=ee-ie;L.style.height=ie+"px",L.style.bottom==="0px"&&(M.scrollTop=pe>0?pe:0,L.style.justifyContent="flex-end")}}}a.current=M.scrollTop})})})]})});JD.displayName=cb;var QD="SelectGroup",[fX,pX]=tg(QD),mX=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=$c();return x.jsx(fX,{scope:r,id:u,children:x.jsx(Mn.div,{role:"group","aria-labelledby":u,...l,ref:e})})});mX.displayName=QD;var e4="SelectLabel",t4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=pX(e4,r);return x.jsx(Mn.div,{id:u.id,...l,ref:e})});t4.displayName=e4;var dv="SelectItem",[gX,n4]=tg(dv),r4=P.forwardRef((t,e)=>{const{__scopeSelect:r,value:l,disabled:u=!1,textValue:m,...v}=t,b=Sh(dv,r),a=Eh(dv,r),k=b.value===l,[M,L]=P.useState(m??""),[z,O]=P.useState(!1),K=ir(e,ee=>a.itemRefCallback?.(ee,l,u)),H=$c(),Z=P.useRef("touch"),Y=()=>{u||(b.onValueChange(l),b.onOpenChange(!1))};if(l==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return x.jsx(gX,{scope:r,value:l,disabled:u,textId:H,isSelected:k,onItemTextChange:P.useCallback(ee=>{L(ie=>ie||(ee?.textContent??"").trim())},[]),children:x.jsx(u0.ItemSlot,{scope:r,value:l,disabled:u,textValue:M,children:x.jsx(Mn.div,{role:"option","aria-labelledby":H,"data-highlighted":z?"":void 0,"aria-selected":k&&z,"data-state":k?"checked":"unchecked","aria-disabled":u||void 0,"data-disabled":u?"":void 0,tabIndex:u?void 0:-1,...v,ref:K,onFocus:Xt(v.onFocus,()=>O(!0)),onBlur:Xt(v.onBlur,()=>O(!1)),onClick:Xt(v.onClick,()=>{Z.current!=="mouse"&&Y()}),onPointerUp:Xt(v.onPointerUp,()=>{Z.current==="mouse"&&Y()}),onPointerDown:Xt(v.onPointerDown,ee=>{Z.current=ee.pointerType}),onPointerMove:Xt(v.onPointerMove,ee=>{Z.current=ee.pointerType,u?a.onItemLeave?.():Z.current==="mouse"&&ee.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Xt(v.onPointerLeave,ee=>{ee.currentTarget===document.activeElement&&a.onItemLeave?.()}),onKeyDown:Xt(v.onKeyDown,ee=>{a.searchRef?.current!==""&&ee.key===" "||(tX.includes(ee.key)&&Y(),ee.key===" "&&ee.preventDefault())})})})})});r4.displayName=dv;var ly="SelectItemText",i4=P.forwardRef((t,e)=>{const{__scopeSelect:r,className:l,style:u,...m}=t,v=Sh(ly,r),b=Eh(ly,r),a=n4(ly,r),k=sX(ly,r),[M,L]=P.useState(null),z=ir(e,Y=>L(Y),a.onItemTextChange,Y=>b.itemTextRefCallback?.(Y,a.value,a.disabled)),O=M?.textContent,K=P.useMemo(()=>x.jsx("option",{value:a.value,disabled:a.disabled,children:O},a.value),[a.disabled,a.value,O]),{onNativeOptionAdd:H,onNativeOptionRemove:Z}=k;return Hi(()=>(H(K),()=>Z(K)),[H,Z,K]),x.jsxs(x.Fragment,{children:[x.jsx(Mn.span,{id:a.textId,...m,ref:z}),a.isSelected&&v.valueNode&&!v.valueNodeHasChildren?xh.createPortal(m.children,v.valueNode):null]})});i4.displayName=ly;var s4="SelectItemIndicator",o4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t;return n4(s4,r).isSelected?x.jsx(Mn.span,{"aria-hidden":!0,...l,ref:e}):null});o4.displayName=s4;var ub="SelectScrollUpButton",a4=P.forwardRef((t,e)=>{const r=Eh(ub,t.__scopeSelect),l=iS(ub,t.__scopeSelect),[u,m]=P.useState(!1),v=ir(e,l.onScrollButtonChange);return Hi(()=>{if(r.viewport&&r.isPositioned){let b=function(){const k=a.scrollTop>0;m(k)};const a=r.viewport;return b(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[r.viewport,r.isPositioned]),u?x.jsx(c4,{...t,ref:v,onAutoScroll:()=>{const{viewport:b,selectedItem:a}=r;b&&a&&(b.scrollTop=b.scrollTop-a.offsetHeight)}}):null});a4.displayName=ub;var db="SelectScrollDownButton",l4=P.forwardRef((t,e)=>{const r=Eh(db,t.__scopeSelect),l=iS(db,t.__scopeSelect),[u,m]=P.useState(!1),v=ir(e,l.onScrollButtonChange);return Hi(()=>{if(r.viewport&&r.isPositioned){let b=function(){const k=a.scrollHeight-a.clientHeight,M=Math.ceil(a.scrollTop)<k;m(M)};const a=r.viewport;return b(),a.addEventListener("scroll",b),()=>a.removeEventListener("scroll",b)}},[r.viewport,r.isPositioned]),u?x.jsx(c4,{...t,ref:v,onAutoScroll:()=>{const{viewport:b,selectedItem:a}=r;b&&a&&(b.scrollTop=b.scrollTop+a.offsetHeight)}}):null});l4.displayName=db;var c4=P.forwardRef((t,e)=>{const{__scopeSelect:r,onAutoScroll:l,...u}=t,m=Eh("SelectScrollButton",r),v=P.useRef(null),b=d0(r),a=P.useCallback(()=>{v.current!==null&&(window.clearInterval(v.current),v.current=null)},[]);return P.useEffect(()=>()=>a(),[a]),Hi(()=>{b().find(M=>M.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[b]),x.jsx(Mn.div,{"aria-hidden":!0,...u,ref:e,style:{flexShrink:0,...u.style},onPointerDown:Xt(u.onPointerDown,()=>{v.current===null&&(v.current=window.setInterval(l,50))}),onPointerMove:Xt(u.onPointerMove,()=>{m.onItemLeave?.(),v.current===null&&(v.current=window.setInterval(l,50))}),onPointerLeave:Xt(u.onPointerLeave,()=>{a()})})}),yX="SelectSeparator",u4=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t;return x.jsx(Mn.div,{"aria-hidden":!0,...l,ref:e})});u4.displayName=yX;var hb="SelectArrow",_X=P.forwardRef((t,e)=>{const{__scopeSelect:r,...l}=t,u=h0(r),m=Sh(hb,r),v=Eh(hb,r);return m.open&&v.position==="popper"?x.jsx(Ub,{...u,...l,ref:e}):null});_X.displayName=hb;var xX="SelectBubbleInput",d4=P.forwardRef(({__scopeSelect:t,value:e,...r},l)=>{const u=P.useRef(null),m=ir(l,u),v=FD(e);return P.useEffect(()=>{const b=u.current;if(!b)return;const a=window.HTMLSelectElement.prototype,M=Object.getOwnPropertyDescriptor(a,"value").set;if(v!==e&&M){const L=new Event("change",{bubbles:!0});M.call(b,e),b.dispatchEvent(L)}},[v,e]),x.jsx(Mn.select,{...r,style:{...ZI,...r.style},ref:m,defaultValue:e})});d4.displayName=xX;function h4(t){return t===""||t===void 0}function f4(t){const e=Bi(t),r=P.useRef(""),l=P.useRef(0),u=P.useCallback(v=>{const b=r.current+v;e(b),(function a(k){r.current=k,window.clearTimeout(l.current),k!==""&&(l.current=window.setTimeout(()=>a(""),1e3))})(b)},[e]),m=P.useCallback(()=>{r.current="",window.clearTimeout(l.current)},[]);return P.useEffect(()=>()=>window.clearTimeout(l.current),[]),[r,u,m]}function p4(t,e,r){const u=e.length>1&&Array.from(e).every(k=>k===e[0])?e[0]:e,m=r?t.indexOf(r):-1;let v=vX(t,Math.max(m,0));u.length===1&&(v=v.filter(k=>k!==r));const a=v.find(k=>k.textValue.toLowerCase().startsWith(u.toLowerCase()));return a!==r?a:void 0}function vX(t,e){return t.map((r,l)=>t[(e+l)%t.length])}var wX=VD,m4=$D,bX=HD,TX=WD,SX=qD,g4=ZD,EX=JD,y4=t4,_4=r4,CX=i4,kX=o4,x4=a4,v4=l4,w4=u4;const b4=wX,T4=bX,sS=P.forwardRef(({className:t,children:e,...r},l)=>x.jsxs(m4,{ref:l,className:ln("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[e,x.jsx(TX,{asChild:!0,children:x.jsx(Hf,{className:"h-4 w-4 opacity-50"})})]}));sS.displayName=m4.displayName;const S4=P.forwardRef(({className:t,...e},r)=>x.jsx(x4,{ref:r,className:ln("flex cursor-default items-center justify-center py-1",t),...e,children:x.jsx(Nm,{className:"h-4 w-4"})}));S4.displayName=x4.displayName;const E4=P.forwardRef(({className:t,...e},r)=>x.jsx(v4,{ref:r,className:ln("flex cursor-default items-center justify-center py-1",t),...e,children:x.jsx(Hf,{className:"h-4 w-4"})}));E4.displayName=v4.displayName;const oS=P.forwardRef(({className:t,children:e,position:r="popper",...l},u)=>x.jsx(SX,{children:x.jsxs(g4,{ref:u,className:ln("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...l,children:[x.jsx(S4,{}),x.jsx(EX,{className:ln("p-1",r==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),x.jsx(E4,{})]})}));oS.displayName=g4.displayName;const AX=P.forwardRef(({className:t,...e},r)=>x.jsx(y4,{ref:r,className:ln("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));AX.displayName=y4.displayName;const Qa=P.forwardRef(({className:t,children:e,...r},l)=>x.jsxs(_4,{ref:l,className:ln("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(kX,{children:x.jsx(np,{className:"h-4 w-4"})})}),x.jsx(CX,{children:e})]}));Qa.displayName=_4.displayName;const IX=P.forwardRef(({className:t,...e},r)=>x.jsx(w4,{ref:r,className:ln("-mx-1 my-1 h-px bg-muted",t),...e}));IX.displayName=w4.displayName;const MX="modulepreload",PX=function(t){return"/"+t},uI={},RX=function(e,r,l){let u=Promise.resolve();if(r&&r.length>0){let k=function(M){return Promise.all(M.map(L=>Promise.resolve(L).then(z=>({status:"fulfilled",value:z}),z=>({status:"rejected",reason:z}))))};var v=k;document.getElementsByTagName("link");const b=document.querySelector("meta[property=csp-nonce]"),a=b?.nonce||b?.getAttribute("nonce");u=k(r.map(M=>{if(M=PX(M),M in uI)return;uI[M]=!0;const L=M.endsWith(".css"),z=L?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${M}"]${z}`))return;const O=document.createElement("link");if(O.rel=L?"stylesheet":MX,L||(O.as="script"),O.crossOrigin="",O.href=M,a&&O.setAttribute("nonce",a),document.head.appendChild(O),L)return new Promise((K,H)=>{O.addEventListener("load",K),O.addEventListener("error",()=>H(new Error(`Unable to preload CSS for ${M}`)))})}))}function m(b){const a=new Event("vite:preloadError",{cancelable:!0});if(a.payload=b,window.dispatchEvent(a),!a.defaultPrevented)throw b}return u.then(b=>{for(const a of b||[])a.status==="rejected"&&m(a.reason);return e().catch(m)})},NX=P.createContext(null);function DX(t,e){const r=Array.isArray(t)?t[0]:t?t.x:0,l=Array.isArray(t)?t[1]:t?t.y:0,u=Array.isArray(e)?e[0]:e?e.x:0,m=Array.isArray(e)?e[1]:e?e.y:0;return r===u&&l===m}function Uu(t,e){if(t===e)return!0;if(!t||!e)return!1;if(Array.isArray(t)){if(!Array.isArray(e)||t.length!==e.length)return!1;for(let r=0;r<t.length;r++)if(!Uu(t[r],e[r]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof t=="object"&&typeof e=="object"){const r=Object.keys(t),l=Object.keys(e);if(r.length!==l.length)return!1;for(const u of r)if(!e.hasOwnProperty(u)||!Uu(t[u],e[u]))return!1;return!0}return!1}function LX(t){const e=t.clone();return e.pixelsToGLUnits=t.pixelsToGLUnits,e}function dI(t,e){if(!t.getProjection)return;const r=t.getProjection(),l=e.getProjection();Uu(r,l)||e.setProjection(r)}function hI(t){return{longitude:t.center.lng,latitude:t.center.lat,zoom:t.zoom,pitch:t.pitch,bearing:t.bearing,padding:t.padding}}function fI(t,e){const r=e.viewState||e;let l=!1;if("longitude"in r&&"latitude"in r){const u=t.center;t.center=new u.constructor(r.longitude,r.latitude),l=l||u!==t.center}if("zoom"in r){const u=t.zoom;t.zoom=r.zoom,l=l||u!==t.zoom}if("bearing"in r){const u=t.bearing;t.bearing=r.bearing,l=l||u!==t.bearing}if("pitch"in r){const u=t.pitch;t.pitch=r.pitch,l=l||u!==t.pitch}return r.padding&&!t.isPaddingEqual(r.padding)&&(l=!0,t.padding=r.padding),l}const jX=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function pI(t){if(!t)return null;if(typeof t=="string"||("toJS"in t&&(t=t.toJS()),!t.layers))return t;const e={};for(const l of t.layers)e[l.id]=l;const r=t.layers.map(l=>{let u=null;"interactive"in l&&(u=Object.assign({},l),delete u.interactive);const m=e[l.ref];if(m){u=u||Object.assign({},l),delete u.ref;for(const v of jX)v in m&&(u[v]=m[v])}return u||l});return{...t,layers:r}}var mI={};const gI={version:8,sources:{},layers:[]},yI={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},nw={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},_I={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},OX=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],zX=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Bm{constructor(e,r,l){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=u=>{const m=this.props[_I[u.type]];m?m(u):u.type==="error"&&console.error(u.error)},this._onPointerEvent=u=>{(u.type==="mousemove"||u.type==="mouseout")&&this._updateHover(u);const m=this.props[yI[u.type]];m&&(this.props.interactiveLayerIds&&u.type!=="mouseover"&&u.type!=="mouseout"&&(u.features=this._hoveredFeatures||this._queryRenderedFeatures(u.point)),m(u),delete u.features)},this._onCameraEvent=u=>{if(!this._internalUpdate){const m=this.props[nw[u.type]];m&&m(u)}u.type in this._deferredEvents&&(this._deferredEvents[u.type]=!1)},this._MapClass=e,this.props=r,this._initialize(l)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const r=this.props;this.props=e;const l=this._updateSettings(e,r);l&&this._createShadowTransform(this._map);const u=this._updateSize(e),m=this._updateViewState(e,!0);this._updateStyle(e,r),this._updateStyleComponents(e,r),this._updateHandlers(e,r),(l||u||m&&!this._map.isMoving())&&this.redraw()}static reuse(e,r){const l=Bm.savedMaps.pop();if(!l)return null;const u=l.map,m=u.getContainer();for(r.className=m.className;m.childNodes.length>0;)r.appendChild(m.childNodes[0]);u._container=r;const v=u._resizeObserver;v&&(v.disconnect(),v.observe(r)),l.setProps({...e,styleDiffing:!1}),u.resize();const{initialViewState:b}=e;return b&&(b.bounds?u.fitBounds(b.bounds,{...b.fitBoundsOptions,duration:0}):l._updateViewState(b,!1)),u.isStyleLoaded()?u.fire("load"):u.once("styledata",()=>u.fire("load")),u._update(),l}_initialize(e){const{props:r}=this,{mapStyle:l=gI}=r,u={...r,...r.initialViewState,accessToken:r.mapboxAccessToken||BX()||null,container:e,style:pI(l)},m=u.initialViewState||u.viewState||u;if(Object.assign(u,{center:[m.longitude||0,m.latitude||0],zoom:m.zoom||0,pitch:m.pitch||0,bearing:m.bearing||0}),r.gl){const M=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=M,r.gl)}const v=new this._MapClass(u);m.padding&&v.setPadding(m.padding),r.cursor&&(v.getCanvas().style.cursor=r.cursor),this._createShadowTransform(v);const b=v._render;v._render=M=>{this._inRender=!0,b.call(v,M),this._inRender=!1};const a=v._renderTaskQueue.run;v._renderTaskQueue.run=M=>{a.call(v._renderTaskQueue,M),this._onBeforeRepaint()},v.on("render",()=>this._onAfterRepaint());const k=v.fire;v.fire=this._fireEvent.bind(this,k),v.on("resize",()=>{this._renderTransform.resize(v.transform.width,v.transform.height)}),v.on("styledata",()=>{this._updateStyleComponents(this.props,{}),dI(v.transform,this._renderTransform)}),v.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const M in yI)v.on(M,this._onPointerEvent);for(const M in nw)v.on(M,this._onCameraEvent);for(const M in _I)v.on(M,this._onEvent);this._map=v}recycle(){const r=this.map.getContainer().querySelector("[mapboxgl-children]");r?.remove(),Bm.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const r=LX(e.transform);e.painter.transform=r,this._renderTransform=r}_updateSize(e){const{viewState:r}=e;if(r){const l=this._map;if(r.width!==l.transform.width||r.height!==l.transform.height)return l.resize(),!0}return!1}_updateViewState(e,r){if(this._internalUpdate)return!1;const l=this._map,u=this._renderTransform,{zoom:m,pitch:v,bearing:b}=u,a=l.isMoving();a&&(u.cameraElevationReference="sea");const k=fI(u,{...hI(l.transform),...e});if(a&&(u.cameraElevationReference="ground"),k&&r){const M=this._deferredEvents;M.move=!0,M.zoom||(M.zoom=m!==u.zoom),M.rotate||(M.rotate=b!==u.bearing),M.pitch||(M.pitch=v!==u.pitch)}return a||fI(l.transform,e),k}_updateSettings(e,r){const l=this._map;let u=!1;for(const m of OX)if(m in e&&!Uu(e[m],r[m])){u=!0;const v=l[`set${m[0].toUpperCase()}${m.slice(1)}`];v?.call(l,e[m])}return u}_updateStyle(e,r){if(e.cursor!==r.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==r.mapStyle){const{mapStyle:l=gI,styleDiffing:u=!0}=e,m={diff:u};return"localIdeographFontFamily"in e&&(m.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(pI(l),m),!0}return!1}_updateStyleComponents(e,r){const l=this._map;let u=!1;return l.isStyleLoaded()&&("light"in e&&l.setLight&&!Uu(e.light,r.light)&&(u=!0,l.setLight(e.light)),"fog"in e&&l.setFog&&!Uu(e.fog,r.fog)&&(u=!0,l.setFog(e.fog)),"terrain"in e&&l.setTerrain&&!Uu(e.terrain,r.terrain)&&(!e.terrain||l.getSource(e.terrain.source))&&(u=!0,l.setTerrain(e.terrain))),u}_updateHandlers(e,r){var l,u;const m=this._map;let v=!1;for(const b of zX){const a=(l=e[b])!==null&&l!==void 0?l:!0,k=(u=r[b])!==null&&u!==void 0?u:!0;Uu(a,k)||(v=!0,a?m[b].enable(a):m[b].disable())}return v}_queryRenderedFeatures(e){const r=this._map,l=r.transform,{interactiveLayerIds:u=[]}=this.props;try{return r.transform=this._renderTransform,r.queryRenderedFeatures(e,{layers:u.filter(r.getLayer.bind(r))})}catch{return[]}finally{r.transform=l}}_updateHover(e){var r;const{props:l}=this;if(l.interactiveLayerIds&&(l.onMouseMove||l.onMouseEnter||l.onMouseLeave)){const m=e.type,v=((r=this._hoveredFeatures)===null||r===void 0?void 0:r.length)>0,b=this._queryRenderedFeatures(e.point),a=b.length>0;!a&&v&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=b,a&&!v&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=m}else this._hoveredFeatures=null}_fireEvent(e,r,l){const u=this._map,m=u.transform,v=typeof r=="string"?r:r.type;return v==="move"&&this._updateViewState(this.props,!1),v in nw&&(typeof r=="object"&&(r.viewState=hI(m)),this._map.isMoving())?(u.transform=this._renderTransform,e.call(u,r,l),u.transform=m,u):(e.call(u,r,l),u)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const l in this._deferredEvents)this._deferredEvents[l]&&e.fire(l);this._internalUpdate=!1;const r=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{dI(this._renderTransform,r),e.transform=r}}}Bm.savedMaps=[];function BX(){let t=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);t=e&&e[1]}try{t=t||mI.MapboxAccessToken}catch{}try{t=t||mI.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return t}const FX=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function VX(t){if(!t)return null;const e=t.map,r={getMap:()=>e,getCenter:()=>t.transform.center,getZoom:()=>t.transform.zoom,getBearing:()=>t.transform.bearing,getPitch:()=>t.transform.pitch,getPadding:()=>t.transform.padding,getBounds:()=>t.transform.getBounds(),project:l=>{const u=e.transform;e.transform=t.transform;const m=e.project(l);return e.transform=u,m},unproject:l=>{const u=e.transform;e.transform=t.transform;const m=e.unproject(l);return e.transform=u,m},queryTerrainElevation:(l,u)=>{const m=e.transform;e.transform=t.transform;const v=e.queryTerrainElevation(l,u);return e.transform=m,v},queryRenderedFeatures:(l,u)=>{const m=e.transform;e.transform=t.transform;const v=e.queryRenderedFeatures(l,u);return e.transform=m,v}};for(const l of UX(e))!(l in r)&&!FX.includes(l)&&(r[l]=e[l].bind(e));return r}function UX(t){const e=new Set;let r=t;for(;r;){for(const l of Object.getOwnPropertyNames(r))l[0]!=="_"&&typeof t[l]=="function"&&l!=="fire"&&l!=="setEventedParent"&&e.add(l);r=Object.getPrototypeOf(r)}return Array.from(e)}const $X=typeof document<"u"?P.useLayoutEffect:P.useEffect,GX=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function HX(t,e){for(const l of GX)l in e&&(t[l]=e[l]);const{RTLTextPlugin:r="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;r&&t.getRTLTextPluginStatus&&t.getRTLTextPluginStatus()==="unavailable"&&t.setRTLTextPlugin(r,l=>{l&&console.error(l)},!0)}const f0=P.createContext(null);function WX(t,e,r){const l=P.useContext(NX),[u,m]=P.useState(null),v=P.useRef(),{current:b}=P.useRef({mapLib:null,map:null});P.useEffect(()=>{const M=t.mapLib;let L=!0,z;return Promise.resolve(M||r).then(O=>{if(!L)return;if(!O)throw new Error("Invalid mapLib");const K="Map"in O?O:O.default;if(!K.Map)throw new Error("Invalid mapLib");if(HX(K,t),!K.supported||K.supported(t))t.reuseMaps&&(z=Bm.reuse(t,v.current)),z||(z=new Bm(K.Map,t,v.current)),b.map=VX(z),b.mapLib=K,m(z),l?.onMapMount(b.map,t.id);else throw new Error("Map is not supported by this browser")}).catch(O=>{const{onError:K}=t;K?K({type:"error",target:null,originalEvent:null,error:O}):console.error(O)}),()=>{L=!1,z&&(l?.onMapUnmount(t.id),t.reuseMaps?z.recycle():z.destroy())}},[]),$X(()=>{u&&u.setProps(t)}),P.useImperativeHandle(e,()=>b.map,[u]);const a=P.useMemo(()=>({position:"relative",width:"100%",height:"100%",...t.style}),[t.style]),k={height:"100%"};return P.createElement("div",{id:t.id,ref:v,style:a},u&&P.createElement(f0.Provider,{value:b},P.createElement("div",{"mapboxgl-children":"",style:k},t.children)))}const qX=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function ap(t,e){if(!t||!e)return;const r=t.style;for(const l in e){const u=e[l];Number.isFinite(u)&&!qX.test(l)?r[l]=`${u}px`:r[l]=u}}function ZX(t,e){const{map:r,mapLib:l}=P.useContext(f0),u=P.useRef({props:t});u.current.props=t;const m=P.useMemo(()=>{let H=!1;P.Children.forEach(t.children,ee=>{ee&&(H=!0)});const Z={...t,element:H?document.createElement("div"):null},Y=new l.Marker(Z);return Y.setLngLat([t.longitude,t.latitude]),Y.getElement().addEventListener("click",ee=>{var ie,pe;(pe=(ie=u.current.props).onClick)===null||pe===void 0||pe.call(ie,{type:"click",target:Y,originalEvent:ee})}),Y.on("dragstart",ee=>{var ie,pe;const we=ee;we.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDragStart)===null||pe===void 0||pe.call(ie,we)}),Y.on("drag",ee=>{var ie,pe;const we=ee;we.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDrag)===null||pe===void 0||pe.call(ie,we)}),Y.on("dragend",ee=>{var ie,pe;const we=ee;we.lngLat=m.getLngLat(),(pe=(ie=u.current.props).onDragEnd)===null||pe===void 0||pe.call(ie,we)}),Y},[]);P.useEffect(()=>(m.addTo(r.getMap()),()=>{m.remove()}),[]);const{longitude:v,latitude:b,offset:a,style:k,draggable:M=!1,popup:L=null,rotation:z=0,rotationAlignment:O="auto",pitchAlignment:K="auto"}=t;return P.useEffect(()=>{ap(m.getElement(),k)},[k]),P.useImperativeHandle(e,()=>m,[]),(m.getLngLat().lng!==v||m.getLngLat().lat!==b)&&m.setLngLat([v,b]),a&&!DX(m.getOffset(),a)&&m.setOffset(a),m.isDraggable()!==M&&m.setDraggable(M),m.getRotation()!==z&&m.setRotation(z),m.getRotationAlignment()!==O&&m.setRotationAlignment(O),m.getPitchAlignment()!==K&&m.setPitchAlignment(K),m.getPopup()!==L&&m.setPopup(L),xh.createPortal(t.children,m.getElement())}const XX=P.memo(P.forwardRef(ZX));function xI(t){return new Set(t?t.trim().split(/\s+/):[])}function KX(t,e){const{map:r,mapLib:l}=P.useContext(f0),u=P.useMemo(()=>document.createElement("div"),[]),m=P.useRef({props:t});m.current.props=t;const v=P.useMemo(()=>{const b={...t},a=new l.Popup(b);return a.setLngLat([t.longitude,t.latitude]),a.once("open",k=>{var M,L;(L=(M=m.current.props).onOpen)===null||L===void 0||L.call(M,k)}),a},[]);if(P.useEffect(()=>{const b=a=>{var k,M;(M=(k=m.current.props).onClose)===null||M===void 0||M.call(k,a)};return v.on("close",b),v.setDOMContent(u).addTo(r.getMap()),()=>{v.off("close",b),v.isOpen()&&v.remove()}},[]),P.useEffect(()=>{ap(v.getElement(),t.style)},[t.style]),P.useImperativeHandle(e,()=>v,[]),v.isOpen()&&((v.getLngLat().lng!==t.longitude||v.getLngLat().lat!==t.latitude)&&v.setLngLat([t.longitude,t.latitude]),t.offset&&!Uu(v.options.offset,t.offset)&&v.setOffset(t.offset),(v.options.anchor!==t.anchor||v.options.maxWidth!==t.maxWidth)&&(v.options.anchor=t.anchor,v.setMaxWidth(t.maxWidth)),v.options.className!==t.className)){const b=xI(v.options.className),a=xI(t.className);for(const k of b)a.has(k)||v.removeClassName(k);for(const k of a)b.has(k)||v.addClassName(k);v.options.className=t.className}return xh.createPortal(t.children,u)}P.memo(P.forwardRef(KX));function h_(t,e,r,l){const u=P.useContext(f0),m=P.useMemo(()=>t(u),[]);return P.useEffect(()=>{const v=e,b=null,a=typeof e=="function"?e:null,{map:k}=u;return k.hasControl(m)||(k.addControl(m,v?.position),b&&b(u)),()=>{a&&a(u),k.hasControl(m)&&k.removeControl(m)}},[]),m}function YX(t){const e=h_(({mapLib:r})=>new r.AttributionControl(t),{position:t.position});return P.useEffect(()=>{ap(e._container,t.style)},[t.style]),null}P.memo(YX);function JX(t){const e=h_(({mapLib:r})=>new r.FullscreenControl({container:t.containerId&&document.getElementById(t.containerId)}),{position:t.position});return P.useEffect(()=>{ap(e._controlContainer,t.style)},[t.style]),null}P.memo(JX);function QX(t,e){const r=P.useRef({props:t}),l=h_(({mapLib:u})=>{const m=new u.GeolocateControl(t),v=m._setupUI;return m._setupUI=b=>{m._container.hasChildNodes()||v(b)},m.on("geolocate",b=>{var a,k;(k=(a=r.current.props).onGeolocate)===null||k===void 0||k.call(a,b)}),m.on("error",b=>{var a,k;(k=(a=r.current.props).onError)===null||k===void 0||k.call(a,b)}),m.on("outofmaxbounds",b=>{var a,k;(k=(a=r.current.props).onOutOfMaxBounds)===null||k===void 0||k.call(a,b)}),m.on("trackuserlocationstart",b=>{var a,k;(k=(a=r.current.props).onTrackUserLocationStart)===null||k===void 0||k.call(a,b)}),m.on("trackuserlocationend",b=>{var a,k;(k=(a=r.current.props).onTrackUserLocationEnd)===null||k===void 0||k.call(a,b)}),m},{position:t.position});return r.current.props=t,P.useImperativeHandle(e,()=>l,[]),P.useEffect(()=>{ap(l._container,t.style)},[t.style]),null}P.memo(P.forwardRef(QX));function eK(t){const e=h_(({mapLib:r})=>new r.NavigationControl(t),{position:t.position});return P.useEffect(()=>{ap(e._container,t.style)},[t.style]),null}const tK=P.memo(eK);function nK(t){const e=h_(({mapLib:m})=>new m.ScaleControl(t),{position:t.position}),r=P.useRef(t),l=r.current;r.current=t;const{style:u}=t;return t.maxWidth!==void 0&&t.maxWidth!==l.maxWidth&&(e.options.maxWidth=t.maxWidth),t.unit!==void 0&&t.unit!==l.unit&&e.setUnit(t.unit),P.useEffect(()=>{ap(e._container,u)},[u]),null}P.memo(nK);const rK=RX(()=>Promise.resolve().then(()=>YW),void 0),iK=P.forwardRef(function(e,r){return WX(e,r,rK)}),sK=XX,oK=tK,aK=void 0,lK=({isOpen:t,onClose:e,onConfirm:r,initialLat:l,initialLng:u})=>{const m=P.useRef(null),v=P.useRef(null),[b,a]=P.useState({latitude:l||21.0285,longitude:u||105.8542,zoom:15}),[k,M]=P.useState({lat:l||21.0285,lng:u||105.8542}),[L,z]=P.useState(""),[O,K]=P.useState([]),[H,Z]=P.useState(!1),[Y,ee]=P.useState(!1);P.useEffect(()=>{if(t){const Pe=l||21.0285,ot=u||105.8542;M({lat:Pe,lng:ot}),a(ut=>({...ut,latitude:Pe,longitude:ot})),l&&u?Ge(Pe,ot):z(""),K([]),setTimeout(()=>m.current?.resize(),200)}},[t,l,u]);const ie=(Pe,ot)=>{m.current?.flyTo({center:[ot,Pe],zoom:16,duration:1500,essential:!0})},pe=Pe=>{const ot=Pe.target.value;z(ot),v.current&&clearTimeout(v.current),ot.length>2?(Z(!0),v.current=setTimeout(async()=>{try{const gt=await(await fetch(`https://nominatim.openstreetmap.org/search?format=json&q=${encodeURIComponent(ot)}&countrycodes=vn&limit=5&addressdetails=1`)).json();K(gt)}catch(ut){console.error(ut)}finally{Z(!1)}},500)):(K([]),Z(!1))},we=Pe=>{const ot=parseFloat(Pe.lat),ut=parseFloat(Pe.lon);M({lat:ot,lng:ut}),ie(ot,ut),z(Pe.display_name),K([])},ke=Pe=>{const{lng:ot,lat:ut}=Pe.lngLat;M({lat:ut,lng:ot})},ze=async Pe=>{const{lng:ot,lat:ut}=Pe.lngLat;M({lat:ut,lng:ot}),await Ge(ut,ot)},Ge=async(Pe,ot)=>{ee(!0);try{const gt=await(await fetch(`https://nominatim.openstreetmap.org/reverse?format=json&lat=${Pe}&lon=${ot}&zoom=18&addressdetails=1`)).json();gt&&gt.display_name&&z(gt.display_name)}catch(ut){console.error("Li ly a ch:",ut)}finally{ee(!1)}},tt=()=>{r(k.lat,k.lng,L),e()};return x.jsx(KT,{open:t,onOpenChange:e,children:x.jsxs(o0,{className:"max-w-2xl h-[85vh] flex flex-col p-0 gap-0 z-[110]",children:[x.jsx(YT,{className:"p-4 border-b",children:x.jsx(a0,{children:"Chn v tr"})}),x.jsxs("div",{className:"flex-1 relative w-full h-full bg-gray-100",children:[x.jsxs("div",{className:"absolute top-4 left-4 right-14 z-20 flex flex-col gap-1",children:[x.jsxs("div",{className:"flex shadow-xl rounded-lg overflow-hidden bg-white ring-1 ring-gray-200",children:[x.jsx(di,{value:L,onChange:pe,placeholder:"Tm kim a ch...",className:"h-11 bg-white border-0 rounded-none focus-visible:ring-0 pl-4 text-base"}),x.jsx("div",{className:"flex items-center justify-center px-3 bg-white text-gray-400",children:H||Y?x.jsx(Fi,{className:"w-5 h-5 animate-spin text-primary"}):L?x.jsx("button",{onClick:()=>{z(""),K([])},children:x.jsx(ti,{className:"w-5 h-5 hover:text-red-500"})}):x.jsx(Cv,{className:"w-5 h-5"})})]}),O.length>0&&x.jsx("div",{className:"bg-white rounded-lg shadow-2xl border overflow-hidden max-h-60 overflow-y-auto mt-1 animate-in fade-in slide-in-from-top-2",children:O.map((Pe,ot)=>x.jsxs("div",{onClick:()=>we(Pe),className:"p-3 text-sm hover:bg-blue-50 cursor-pointer border-b last:border-0 flex items-start gap-3 transition-colors",children:[x.jsx("div",{className:"bg-gray-100 p-1.5 rounded-full flex-shrink-0 mt-0.5",children:x.jsx(Vi,{className:"w-4 h-4 text-red-500"})}),x.jsxs("div",{className:"flex flex-col",children:[x.jsx("span",{className:"font-medium text-gray-900 line-clamp-1",children:Pe.name||Pe.display_name.split(",")[0]}),x.jsx("span",{className:"text-xs text-gray-500 line-clamp-2",children:Pe.display_name})]})]},ot))})]}),x.jsxs(iK,{ref:m,...b,onMove:Pe=>a(Pe.viewState),mapStyle:"mapbox://styles/mapbox/streets-v12",mapboxAccessToken:aK,className:"w-full h-full",style:{width:"100%",height:"100%"},children:[x.jsx(oK,{position:"bottom-right"}),x.jsx(sK,{latitude:k.lat,longitude:k.lng,anchor:"bottom",draggable:!0,onDrag:ke,onDragEnd:ze,children:x.jsxs("div",{className:"relative flex flex-col items-center group cursor-grab active:cursor-grabbing hover:scale-110 transition-transform",children:[x.jsx("div",{className:"absolute -top-8 bg-black/80 text-white text-[10px] px-2 py-1 rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none",children:"Ko ti"}),x.jsx(Vi,{className:"w-12 h-12 text-red-600 drop-shadow-2xl fill-white"}),x.jsx("div",{className:"w-3 h-1 bg-black/30 rounded-full blur-[2px]"})]})})]}),x.jsx("div",{className:"absolute bottom-6 left-1/2 -translate-x-1/2 bg-white/90 backdrop-blur px-4 py-2 rounded-full shadow-lg border text-xs font-medium text-gray-600 pointer-events-none flex items-center gap-2",children:Y?x.jsxs(x.Fragment,{children:[x.jsx(Fi,{className:"w-3 h-3 animate-spin"})," ang ly a ch..."]}):"Ko th ghim   cp nht a ch"})]}),x.jsxs(JT,{className:"p-4 border-t bg-white",children:[x.jsx(_n,{variant:"ghost",onClick:e,children:"Hy"}),x.jsxs(_n,{onClick:tt,className:"gap-2 bg-blue-600 hover:bg-blue-700 text-white shadow-lg",children:[x.jsx(Vi,{className:"w-4 h-4"})," Xc nhn v tr ny"]})]})]})})},rw="https://thodia-backend-1067502227654.asia-southeast1.run.app",C4=({isOpen:t,onClose:e,onSubmit:r,initialData:l,isSubmitting:u,customStoreId:m,onUpgradeClick:v})=>{const{user:b}=Oo(),M=l?.is_premium===!0||!!m,[L,z]=P.useState({name_vi:"",address_vi:"",phone:"",description_vi:"",category:"cafe",image_url:"",lat:21.0285,lng:105.8542}),[O,K]=P.useState(null),[H,Z]=P.useState(""),[Y,ee]=P.useState([]),[ie,pe]=P.useState([]),[we,ke]=P.useState([]),[ze,Ge]=P.useState(!1),[tt,Pe]=P.useState(!1);P.useEffect(()=>{if(t)if(l){z({name_vi:l.name_vi||l.nameVi||"",address_vi:l.address_vi||l.address||"",phone:l.phone||"",description_vi:l.description_vi||l.description||"",category:l.category||l.type||"cafe",image_url:l.image_url||l.image||"",lat:l.lat||21.0285,lng:l.lng||105.8542}),Z(l.image_url||l.image||""),K(null);const Ae=m||l.id;Ae&&M&&ot(Ae)}else z({name_vi:"",address_vi:"",phone:"",description_vi:"",category:"cafe",image_url:"",lat:21.0285,lng:105.8542}),Z(""),K(null),ee([]),pe([]),ke([])},[t,l,m,M]);const ot=Ae=>{const xe=String(Ae).replace("user-store-","");fetch(`${rw}/api/stores/${xe}/gallery`).then(We=>We.json()).then(We=>{Array.isArray(We)&&ke(We)}).catch(console.error)},ut=(Ae,xe,We)=>{z(he=>({...he,lat:Ae,lng:xe,address_vi:We||he.address_vi})),Ht.success(" cp nht v tr!")},gt=Ae=>{const xe=Ae.target.files?.[0];xe&&(K(xe),Z(URL.createObjectURL(xe)))},ht=Ae=>{const xe=Ae.target.files;if(xe){const We=Array.from(xe);if(we.length+Y.length+We.length>10){Ht.error("Ti a 10 nh trong th vin.");return}ee(it=>[...it,...We]);const Fe=We.map(it=>URL.createObjectURL(it));pe(it=>[...it,...Fe])}},Lt=async Ae=>{if(confirm("Bn c chc mun xa nh ny khng?"))try{if(!(await fetch(`${rw}/api/gallery/${Ae}`,{method:"DELETE"})).ok)throw new Error("Li xa nh");ke(We=>We.filter(he=>he.id!==Ae)),Ht.success(" xa nh!")}catch(xe){console.error(xe),Ht.error("Khng th xa nh lc ny.")}},mt=Ae=>{ee(xe=>xe.filter((We,he)=>he!==Ae)),pe(xe=>(URL.revokeObjectURL(xe[Ae]),xe.filter((We,he)=>he!==Ae)))},pt=async Ae=>{Ae.preventDefault(),Pe(!0);try{const xe=m||l?.id,We=new FormData;if(We.append("userId",b?.uid||""),xe&&We.append("id",String(xe).replace("user-store-","")),We.append("name_vi",L.name_vi),We.append("address_vi",L.address_vi),We.append("phone",L.phone),We.append("category",L.category),We.append("lat",String(L.lat)),We.append("lng",String(L.lng)),We.append("image_url",L.image_url),M&&We.append("description_vi",L.description_vi),m?We.append("is_premium","true"):We.append("is_premium",l?.is_premium?"true":"false"),O&&We.append("avatar",O),M&&Y.length>0&&Y.forEach(Fe=>{We.append("gallery",Fe)}),!(await fetch(`${rw}/api/stores/save`,{method:"POST",body:We})).ok)throw new Error("Li lu d liu");Ht.success(m?" cp nht a im!":" lu ca hng!"),r&&await r(L),e()}catch(xe){console.error(xe),Ht.error("C li xy ra: "+xe.message)}finally{Pe(!1)}};return x.jsxs(x.Fragment,{children:[x.jsx(KT,{open:t,onOpenChange:e,children:x.jsxs(o0,{className:"max-w-3xl max-h-[90vh] overflow-y-auto bg-white p-0 gap-0 rounded-xl z-[100]",children:[x.jsxs(YT,{className:"p-6 border-b sticky top-0 bg-white z-20 flex flex-row items-center justify-between",children:[x.jsx(a0,{className:"text-xl font-bold",children:m?"Chnh sa a im (Admin)":l?"Chnh sa ca hng":"Thm ca hng mi"}),M?x.jsxs("span",{className:"flex items-center gap-1 text-xs font-bold bg-yellow-100 text-yellow-700 px-2 py-1 rounded-full border border-yellow-200 shadow-sm animate-pulse",children:[x.jsx(nl,{className:"w-3 h-3 fill-yellow-500 text-yellow-500"})," PREMIUM STORE"]}):x.jsx("span",{className:"text-xs font-bold bg-gray-100 text-gray-500 px-2 py-1 rounded-full border border-gray-200",children:"Gi Min Ph"})]}),x.jsxs("form",{onSubmit:pt,className:"p-6 space-y-6",children:[x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-6",children:[x.jsxs("div",{className:"md:col-span-4 space-y-3",children:[x.jsxs(ui,{className:"font-semibold",children:["nh i din ",x.jsx("span",{className:"text-green-600 text-xs font-normal",children:"(Min ph)"})]}),x.jsxs("div",{className:"aspect-square w-full rounded-2xl border-2 border-dashed border-gray-300 bg-gray-50 flex flex-col items-center justify-center cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-all relative overflow-hidden group",onClick:()=>document.getElementById("avatar-input")?.click(),children:[H?x.jsxs(x.Fragment,{children:[x.jsx("img",{src:H,className:"w-full h-full object-cover"}),x.jsxs("div",{className:"absolute inset-0 bg-black/40 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:[x.jsx(vO,{className:"text-white w-8 h-8"}),x.jsx("span",{className:"text-white text-xs font-medium absolute bottom-4",children:"i nh"})]})]}):x.jsxs(x.Fragment,{children:[x.jsx(uC,{className:"w-10 h-10 text-gray-400 mb-2"}),x.jsx("span",{className:"text-sm text-gray-500 font-medium",children:"Ti nh ln"})]}),x.jsx("input",{id:"avatar-input",type:"file",accept:"image/*",onChange:gt,className:"hidden"})]})]}),x.jsxs("div",{className:"md:col-span-8 space-y-4",children:[x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{className:"space-y-2",children:[x.jsxs(ui,{children:["Tn a im ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{required:!0,value:L.name_vi,onChange:Ae=>z({...L,name_vi:Ae.target.value})})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsxs(ui,{children:["Danh mc ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsxs(b4,{value:L.category,onValueChange:Ae=>z({...L,category:Ae}),children:[x.jsx(sS,{className:"bg-white",children:x.jsx(T4,{placeholder:"Chn danh mc"})}),x.jsxs(oS,{className:"max-h-[300px] bg-white z-[200]",children:[x.jsx(Qa,{value:"food",children:"Qun n"}),x.jsx(Qa,{value:"cafe",children:"Caf"}),x.jsx(Qa,{value:"entertainment",children:"Vui chi"}),x.jsx(Qa,{value:"lecture_hall",children:"Ging ng"}),x.jsx(Qa,{value:"office",children:"Vn phng"}),x.jsx(Qa,{value:"housing",children:"Nh tr"}),x.jsx(Qa,{value:"job",children:"Vic lm"}),x.jsx(Qa,{value:"building",children:"Ta nh"}),x.jsx(Qa,{value:"checkin",children:"Check-in"})]})]})]})]}),x.jsxs("div",{className:"space-y-2",children:[x.jsx(ui,{children:"Lin h & V tr"}),x.jsxs("div",{className:"flex gap-2",children:[x.jsx("div",{className:"flex-1",children:x.jsx(di,{value:L.phone,onChange:Ae=>z({...L,phone:Ae.target.value}),placeholder:"S in thoi..."})}),x.jsxs(_n,{type:"button",className:"bg-blue-600 text-white min-w-[140px] gap-2",onClick:()=>Ge(!0),children:[x.jsx(Vi,{className:"w-4 h-4"})," ",L.lat?"Sa v tr":"Chn v tr"]})]}),x.jsxs("div",{className:"bg-gray-50 border rounded-md p-2 text-sm flex items-start gap-2",children:[x.jsx(Vi,{className:L.lat?"w-4 h-4 text-green-600 mt-0.5":"w-4 h-4 text-gray-400 mt-0.5"}),x.jsx("span",{className:"font-medium text-gray-800 flex-1",children:L.address_vi||"Cha chn v tr"})]})]}),x.jsxs("div",{className:"space-y-2 relative",children:[x.jsxs(ui,{className:"flex items-center gap-2 font-semibold",children:["M t / Gii thiu",!M&&x.jsx(Ey,{className:"w-3.5 h-3.5 text-yellow-600"})]}),x.jsxs("div",{className:"relative",children:[x.jsx(gh,{rows:3,value:L.description_vi,onChange:Ae=>z({...L,description_vi:Ae.target.value}),disabled:!M,placeholder:M?"Nhp m t...":"Nng cp VIP  vit m t chi tit, gii thiu v qun...",className:M?"":"bg-gray-100 text-gray-400 resize-none blur-[1px]"}),!M&&x.jsx("div",{className:"absolute inset-0 flex items-center justify-center z-10",children:x.jsxs(_n,{type:"button",size:"sm",onClick:v,className:"bg-gradient-to-r from-yellow-400 to-orange-500 text-white hover:from-yellow-500 hover:to-orange-600 shadow-md transform hover:scale-105 transition-all",children:[x.jsx(nl,{className:"w-4 h-4 mr-1"})," M kha M t"]})})]})]})]}),x.jsxs("div",{className:"col-span-full space-y-3 pt-4 border-t relative",children:[x.jsxs("div",{className:"flex justify-between items-center",children:[x.jsxs(ui,{className:"text-base font-semibold flex items-center gap-2",children:["Th vin nh VIP",!M&&x.jsx(Ey,{className:"w-4 h-4 text-gray-400"})]}),M?x.jsxs(x.Fragment,{children:[x.jsxs(_n,{type:"button",variant:"outline",size:"sm",onClick:()=>document.getElementById("gallery-input")?.click(),disabled:we.length+Y.length>=10,children:[x.jsx(uC,{className:"w-4 h-4 mr-2"})," Thm nh"]}),x.jsx("input",{id:"gallery-input",type:"file",multiple:!0,accept:"image/*",onChange:ht,className:"hidden"})]}):x.jsx("span",{className:"text-xs text-red-500 font-medium bg-red-50 px-2 py-1 rounded",children:"Tnh nng VIP"})]}),x.jsxs("div",{className:`flex gap-4 overflow-x-auto pb-4 pt-2 scrollbar-thin scrollbar-thumb-gray-200 ${M?"":"opacity-40 pointer-events-none select-none filter blur-[2px]"}`,children:[!M&&[1,2,3,4].map(Ae=>x.jsx("div",{className:"w-24 h-24 flex-shrink-0 rounded-lg bg-gray-200 animate-pulse"},Ae)),M&&we.map(Ae=>x.jsxs("div",{className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden border group",children:[x.jsx("img",{src:Ae.image_url,className:"w-full h-full object-cover transition-transform group-hover:scale-110"}),x.jsx("button",{type:"button",onClick:()=>Lt(Ae.id),className:"absolute top-1 right-1 bg-red-500/80 hover:bg-red-600 text-white p-1 rounded-full opacity-0 group-hover:opacity-100 transition-opacity shadow-sm z-10",title:"Xa nh ny",children:x.jsx(ti,{size:12,strokeWidth:3})})]},Ae.id)),M&&ie.map((Ae,xe)=>x.jsxs("div",{className:"relative w-24 h-24 flex-shrink-0 rounded-lg overflow-hidden border group",children:[x.jsx("img",{src:Ae,className:"w-full h-full object-cover"}),x.jsx("button",{type:"button",onClick:()=>mt(xe),className:"absolute top-1 right-1 bg-gray-500/80 hover:bg-gray-600 text-white p-1 rounded-full shadow-sm z-10",title:"B nh ny",children:x.jsx(ti,{size:12,strokeWidth:3})})]},xe))]}),!M&&x.jsx("div",{className:"absolute inset-0 z-10 flex flex-col items-center justify-center bg-white/60 backdrop-blur-sm rounded-xl border border-dashed border-gray-300",children:x.jsxs("div",{className:"bg-white p-5 rounded-2xl shadow-xl flex flex-col items-center border border-yellow-100 max-w-xs text-center",children:[x.jsx("div",{className:"bg-yellow-100 p-3 rounded-full mb-3",children:x.jsx(nl,{className:"w-6 h-6 text-yellow-600 fill-yellow-600"})}),x.jsx("h3",{className:"font-bold text-gray-900 text-sm mb-1",children:"Th vin nh VIP"}),x.jsx("p",{className:"text-xs text-gray-500 mb-4",children:"ng ti 10 nh Menu & Khng gian  thu ht khch hng gp 3 ln!"}),x.jsx(_n,{type:"button",size:"sm",onClick:v,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full font-bold shadow-lg shadow-yellow-200",children:"Nng cp ngay"})]})})]})]}),x.jsxs(JT,{className:"pt-4 border-t sticky bottom-0 bg-white z-20",children:[x.jsx(_n,{type:"button",variant:"ghost",onClick:e,children:"Hy"}),x.jsxs(_n,{type:"submit",disabled:tt||u,className:"bg-blue-600 hover:bg-blue-700 text-white font-semibold shadow-md",children:[(tt||u)&&x.jsx(Fi,{className:"w-4 h-4 mr-2 animate-spin"}),"Lu thng tin"]})]})]})]})}),x.jsx(lK,{isOpen:ze,onClose:()=>Ge(!1),onConfirm:ut,initialLat:L.lat,initialLng:L.lng})]})},Nf="https://thodia-backend-1067502227654.asia-southeast1.run.app",aS=({isOpen:t,onClose:e,location:r,onNavigate:l})=>{if(!r)return null;const{user:u}=Oo(),[m,v]=P.useState("info"),[b,a]=P.useState(r),[k,M]=P.useState([]),[L,z]=P.useState([]),[O,K]=P.useState([]),[H,Z]=P.useState(new Set),[Y,ee]=P.useState(0),[ie,pe]=P.useState(0),[we,ke]=P.useState(!0),[ze,Ge]=P.useState(!1),tt=String(r.id).replace("user-store-",""),ot=b?.user_id===u?.uid||u?.email==="admin@gmail.com";P.useEffect(()=>{t&&r&&ut()},[t,r.id,u]);const ut=async()=>{ke(!0);try{const it=await(await fetch(`${Nf}/api/stores/${tt}/public`)).json()||r;a(it);const[vt,Wt,rn,wt]=await Promise.all([fetch(`${Nf}/api/stores/${tt}/menu`),fetch(`${Nf}/api/stores/${tt}/gallery`),fetch(`${Nf}/api/store-vouchers/${tt}`),fetch(`${Nf}/api/reviews/list/${tt}`)]),Kt=await vt.json(),Tn=await Wt.json(),fn=await rn.json(),Cn=await wt.json();if(Array.isArray(Kt)&&z(Kt),Array.isArray(Tn)&&K(Tn),console.log("Vouchers fetched:",fn),Array.isArray(fn)&&M(fn),Array.isArray(Cn)&&Cn.length>0){const mr=Cn.reduce((hr,_i)=>hr+_i.rating,0)/Cn.length;ee(Number(mr.toFixed(1))),pe(Cn.length)}else ee(0),pe(0);if(u){const mr=await(await fetch(`${Nf}/api/user-vouchers?userId=${u.uid}`)).json();if(Array.isArray(mr)){const hr=new Set(mr.map(_i=>_i.voucher_id||_i.id));Z(hr)}}}catch(he){console.error("Li ti d liu chi tit:",he)}finally{ke(!1)}},gt=async()=>{await ut()},ht=async he=>{if(!u){Ht.error("Vui lng ng nhp  lu voucher!");return}if(!H.has(he.id)){Z(Fe=>new Set(Fe).add(he.id)),Ht.success(" lu voucher vo v!");try{if(!(await fetch(`${Nf}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u.uid,voucherId:he.id})})).ok)throw new Error("Failed")}catch{Z(it=>{const vt=new Set(it);return vt.delete(he.id),vt}),Ht.error("Khng th lu voucher lc ny")}}},Lt=b.image_url||b.image||"https://images.unsplash.com/photo-1554118811-1e0d58224f24",mt=b.name_vi||b.nameVi||b.name||"a im cha c tn",pt=b.address_vi||b.address||"ang cp nht a ch",Ae=b.phone||r.phone||"Cha cp nht",xe=b.open_hours_vi||"08:00 - 22:00",We=b.description_vi||b.description;return x.jsxs(x.Fragment,{children:[x.jsx(KT,{open:t,onOpenChange:e,children:x.jsxs(o0,{className:"max-w-2xl h-[90vh] p-0 bg-white gap-0 border-none rounded-2xl overflow-hidden z-[100] flex flex-col focus:outline-none",children:[x.jsx(a0,{className:"sr-only",children:mt}),we?x.jsx("div",{className:"flex-1 flex items-center justify-center",children:x.jsx(Fi,{className:"w-8 h-8 animate-spin text-primary"})}):x.jsxs(x.Fragment,{children:[x.jsxs("div",{className:"relative h-48 bg-gray-200 flex-shrink-0",children:[x.jsx("img",{src:Lt,className:"w-full h-full object-cover",alt:mt,onError:he=>{he.currentTarget.src="https://placehold.co/600x400?text=No+Image"}}),x.jsx("button",{onClick:e,className:"absolute top-4 right-4 bg-black/50 p-1.5 rounded-full text-white hover:bg-black/70 transition-colors z-10",children:x.jsx(ti,{className:"w-5 h-5"})}),ot&&x.jsxs(_n,{size:"sm",className:"absolute bottom-4 right-4 bg-white/90 text-black hover:bg-white shadow-md border backdrop-blur-sm",onClick:()=>Ge(!0),children:[x.jsx(PO,{className:"w-3.5 h-3.5 mr-2"})," Chnh sa"]})]}),x.jsxs("div",{className:"pt-4 px-6 pb-2 flex-shrink-0",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-tight",children:mt}),x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-1",children:[x.jsx(Vf,{className:`w-4 h-4 ${Y>0?"fill-yellow-500 text-yellow-500":"text-gray-300"}`}),x.jsx("span",{className:"font-bold text-gray-900",children:Y>0?Y:"Cha c nh gi"}),ie>0&&x.jsxs("span",{children:["(",ie,")"]}),x.jsx("span",{className:"capitalize px-2 py-0.5 bg-gray-100 rounded-full text-xs",children:b.category||b.type||"a im"})]}),x.jsxs("div",{className:"flex flex-wrap items-center gap-x-4 gap-y-2 mt-3",children:[x.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[x.jsx(Cb,{className:"w-4 h-4 text-green-600"})," ",x.jsx("span",{children:xe})]}),x.jsxs("div",{className:"flex items-center gap-1.5 text-sm text-gray-600",children:[x.jsx(Ev,{className:"w-4 h-4 text-blue-600"})," ",x.jsx("span",{children:Ae})]})]}),x.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-500 mt-2",children:[x.jsx(Vi,{className:"w-4 h-4 flex-shrink-0 text-red-500"}),x.jsx("span",{className:"truncate",children:pt})]})]}),x.jsxs(uv,{defaultValue:"info",className:"flex-1 flex flex-col min-h-0",value:m,onValueChange:v,children:[x.jsx("div",{className:"px-6 border-b flex-shrink-0 bg-white sticky top-0 z-10",children:x.jsxs(Vy,{className:"w-full justify-start bg-transparent h-12 p-0 gap-6 overflow-x-auto no-scrollbar",children:[x.jsx(qs,{value:"info",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:"Thng tin"}),x.jsxs(qs,{value:"menu",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Thc n (",L.length,")"]}),x.jsxs(qs,{value:"vouchers",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["Voucher (",k.length,")"]}),x.jsxs(qs,{value:"gallery",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh (",O.length,")"]}),x.jsxs(qs,{value:"reviews",className:"data-[state=active]:border-b-2 data-[state=active]:border-primary data-[state=active]:text-primary rounded-none h-full px-0 bg-transparent font-medium",children:["nh gi (",ie,")"]})]})}),x.jsxs("div",{className:"flex-1 overflow-y-auto bg-gray-50 p-4 scroll-smooth",children:[x.jsx(Sa,{value:"info",className:"m-0 focus:outline-none",children:x.jsxs("div",{className:"bg-white p-5 rounded-xl shadow-sm border space-y-3",children:[x.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2",children:[x.jsx(bM,{className:"w-4 h-4 text-blue-500"})," Gii thiu"]}),x.jsx("p",{className:"text-sm text-gray-600 leading-relaxed whitespace-pre-wrap",children:We||"Cha c m t chi tit v a im ny."})]})}),x.jsx(Sa,{value:"menu",className:"space-y-4 m-0 focus:outline-none",children:L.length===0?x.jsxs("div",{className:"text-center py-12 text-gray-400",children:[x.jsx(kv,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),x.jsx("p",{children:"Cha cp nht thc n."})]}):x.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:L.map(he=>x.jsxs("div",{className:"bg-white p-2 rounded-xl border flex gap-3 hover:shadow-md transition-shadow",children:[x.jsx("div",{className:"w-20 h-20 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0",children:x.jsx("img",{src:he.image_url||"https://placehold.co/100x100",className:"w-full h-full object-cover",alt:he.name,onError:Fe=>{Fe.currentTarget.src="https://placehold.co/100x100?text=Food"}})}),x.jsxs("div",{className:"flex-1 py-1 flex flex-col justify-between",children:[x.jsx("h4",{className:"font-bold text-gray-900 text-sm line-clamp-2",children:he.name_vi||he.name}),x.jsxs("span",{className:"font-bold text-primary block",children:[he.price?new Intl.NumberFormat("vi-VN").format(Number(he.price)):0,""]})]})]},he.id))})}),x.jsx(Sa,{value:"vouchers",className:"space-y-3 m-0 focus:outline-none",children:k.length===0?x.jsxs("div",{className:"text-center py-12 text-gray-400",children:[x.jsx(Yy,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),x.jsx("p",{children:"Khng c m gim gi no."})]}):k.map(he=>{const Fe=H.has(he.id),it=he.title_vi||he.title||"M gim gi",vt=he.discount_value||he.discount||he.discount_amount||0,Wt=he.discount_type||he.type||"amount",rn=he.code||"CODE";return x.jsx("div",{className:"bg-white rounded-xl border border-dashed border-orange-200 p-4 shadow-sm relative group hover:border-orange-400 transition-colors",children:x.jsxs("div",{className:"flex gap-4 items-center",children:[x.jsxs("div",{className:"w-16 h-16 bg-orange-50 rounded-lg flex flex-col items-center justify-center border border-orange-100 text-orange-600 flex-shrink-0",children:[x.jsx("span",{className:"text-xl font-black",children:new Intl.NumberFormat("vi-VN").format(Number(vt))}),x.jsx("span",{className:"text-xs font-bold uppercase",children:Wt==="percent"?"%":"k"})]}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("h4",{className:"font-bold text-gray-900 truncate",children:it}),x.jsxs("p",{className:"text-xs text-gray-500 mt-1 flex items-center gap-1",children:["M: ",x.jsx("span",{className:"font-mono bg-gray-100 px-1.5 py-0.5 rounded text-gray-700 font-bold",children:rn})]})]}),x.jsx(_n,{onClick:()=>ht(he),disabled:Fe,size:"sm",className:`shrink-0 ${Fe?"bg-green-100 text-green-700 hover:bg-green-200":"bg-orange-500 text-white hover:bg-orange-600"}`,children:Fe?x.jsxs(x.Fragment,{children:[x.jsx(np,{className:"w-4 h-4 mr-1"}),"  lu"]}):"Lu m"})]})},he.id)})}),x.jsx(Sa,{value:"gallery",className:"m-0 focus:outline-none",children:O.length===0?x.jsxs("div",{className:"text-center py-12 text-gray-400",children:[x.jsx(wM,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),x.jsx("p",{children:"Cha c hnh nh no khc."})]}):x.jsx("div",{className:"grid grid-cols-3 gap-2",children:O.map(he=>x.jsx("div",{className:"aspect-square rounded-xl overflow-hidden border bg-gray-100 cursor-pointer hover:opacity-90",children:x.jsx("img",{src:he.image_url,className:"w-full h-full object-cover",alt:""})},he.id))})}),x.jsx(Sa,{value:"reviews",className:"m-0 focus:outline-none",children:x.jsx($Z,{storeId:tt})})]})]})]})]})}),ze&&x.jsx(C4,{isOpen:ze,onClose:()=>Ge(!1),onSubmit:gt,initialData:b,customStoreId:tt})]})},xx="https://thodia-backend-1067502227654.asia-southeast1.run.app",cK={food:"m thc",cafe:"Caf",entertainment:"Vui chi",lecture_hall:"Ging ng",office:"Vn phng",housing:"Nh tr",job:"Vic lm",building:"Ta nh",checkin:"Check-in"},uK=({location:t,onClose:e,onNavigate:r,onOpenDetail:l,onClaim:u})=>{const{language:m}=ra(),{user:v}=Oo(),{isFavorite:b,toggleFavorite:a}=R3(),k=b(t.id),M=t.is_premium,L=String(t.id),O=!(L.startsWith("user-store-")||/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(L)),K=L.replace("user-store-",""),[H,Z]=P.useState({rating:0,count:0}),[Y,ee]=P.useState(!1);P.useEffect(()=>{const xe=async(he=!1)=>{if(!he&&t.reviews&&t.reviews.length>0){const Fe=t.reviews.reduce((it,vt)=>it+vt.rating,0);Z({rating:Number((Fe/t.reviews.length).toFixed(1)),count:t.reviews.length});return}if(!(O&&!he)){ee(!0);try{const it=await(await fetch(`${xx}/api/reviews/${K}`)).json();if(Array.isArray(it)&&it.length>0){const vt=it.reduce((Wt,rn)=>Wt+rn.rating,0);Z({rating:Number((vt/it.length).toFixed(1)),count:it.length})}else!he&&t.rating?Z({rating:t.rating,count:t.reviews?.length||0}):Z({rating:0,count:0})}catch(Fe){console.error("Li ti rating:",Fe)}finally{ee(!1)}}};xe();const We=he=>{String(he.detail)===String(K)&&xe(!0)};return window.addEventListener("review_updated",We),()=>window.removeEventListener("review_updated",We)},[t.id,K,O]);const[ie,pe]=P.useState([]),[we,ke]=P.useState(new Set),[ze,Ge]=P.useState(!1),[tt,Pe]=P.useState(!1),[ot,ut]=P.useState(!1);P.useEffect(()=>{(async()=>{if(O){pe([]);return}Ge(!0);try{const he=await(await fetch(`${xx}/api/store-vouchers/${K}`)).json();if(Array.isArray(he)&&he.length>0){if(pe(he),v){const it=await(await fetch(`${xx}/api/user-vouchers?userId=${v.uid}`)).json();if(Array.isArray(it)){const vt=new Set(it.map(Wt=>Wt.voucher_id||Wt.id));ke(vt)}}}else pe([])}catch(We){console.error("Li ti voucher:",We)}finally{Ge(!1)}})()},[t.id,K,v,O]);const gt=async xe=>{if(!v){Ht.error("Vui lng ng nhp  lu u i!");return}if(!we.has(xe.id)){ke(We=>new Set(We).add(xe.id)),Ht.success(" lu u i vo v!");try{if(!(await fetch(`${xx}/api/vouchers/save`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:v.uid,voucherId:xe.id})})).ok)throw new Error("Failed")}catch{ke(he=>{const Fe=new Set(he);return Fe.delete(xe.id),Fe}),Ht.error("Li khi lu, vui lng th li.")}}},ht=()=>{ut(!0),setTimeout(()=>{r(t),ut(!1)},500)},Lt=()=>{l?l(t):Pe(!0)},mt=m==="en"&&t.name?t.name:t.nameVi,pt=m==="en"&&t.descriptionEn?t.descriptionEn:t.description,Ae=cK[t.category||t.type]||"a im";return x.jsxs(x.Fragment,{children:[x.jsxs(yr.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},transition:{type:"spring",damping:25,stiffness:300},className:"fixed bottom-0 left-0 right-0 bg-white rounded-t-3xl shadow-2xl z-[60] max-h-[85vh] overflow-y-auto md:max-w-md md:left-auto md:right-4 md:bottom-4 md:rounded-3xl border border-gray-100 scrollbar-hide",onClick:xe=>xe.stopPropagation(),children:[x.jsxs("div",{className:"relative h-48 w-full bg-gray-200 cursor-pointer group",onClick:Lt,children:[x.jsx("img",{src:t.image||"https://images.unsplash.com/photo-1554118811-1e0d58224f24",alt:mt,className:"w-full h-full object-cover transition-transform duration-500 group-hover:scale-105",loading:"eager",onError:xe=>{xe.currentTarget.src="https://placehold.co/600x400?text=No+Image"}}),x.jsx("button",{onClick:xe=>{xe.stopPropagation(),e()},className:"absolute top-4 right-4 w-8 h-8 bg-black/40 hover:bg-black/60 rounded-full flex items-center justify-center text-white backdrop-blur-md transition-colors z-10",children:x.jsx(ti,{className:"w-5 h-5"})}),x.jsxs("div",{className:"absolute bottom-4 left-4 flex gap-2 z-10",children:[x.jsx("div",{className:"px-3 py-1 bg-white/90 backdrop-blur-sm text-xs font-bold rounded-full uppercase tracking-wider text-gray-800 shadow-sm border border-white/50",children:Ae}),M&&x.jsxs("div",{className:"px-2 py-1 bg-gradient-to-r from-yellow-300 to-yellow-500 text-yellow-900 text-xs font-bold rounded-full flex items-center gap-1 shadow-sm border border-white/50 animate-pulse",children:[x.jsx(nl,{className:"w-3 h-3 fill-yellow-900"}),"VIP"]})]}),x.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/20 to-transparent pointer-events-none"})]}),x.jsxs("div",{className:"p-6 pb-24 md:pb-6 relative",children:[x.jsxs("div",{className:"flex justify-between items-start mb-2 gap-3",children:[x.jsx("h2",{className:"text-2xl font-bold text-gray-900 leading-tight flex-1 line-clamp-2",onClick:Lt,children:mt}),x.jsxs("div",{className:"flex flex-col items-end gap-2 shrink-0",children:[Y?x.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded-lg border border-gray-100",children:[x.jsx(Fi,{className:"w-3 h-3 animate-spin text-gray-400"}),x.jsx("span",{className:"text-[10px] text-gray-400",children:"Loading..."})]}):Number(H.rating)>0?x.jsxs("div",{className:"flex items-center gap-1 bg-yellow-50 px-2 py-1 rounded-lg border border-yellow-100",children:[x.jsx(Vf,{className:"w-4 h-4 text-yellow-500 fill-yellow-500"}),x.jsx("span",{className:"font-bold text-sm text-yellow-700",children:H.rating}),x.jsxs("span",{className:"text-[10px] text-gray-400",children:["(",H.count,")"]})]}):x.jsx("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded-lg border border-gray-100",children:x.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"Cha c nh gi"})}),x.jsx("button",{onClick:xe=>{xe.stopPropagation(),a(t)},className:"p-2 rounded-full hover:bg-red-50 active:scale-95 transition-all group",children:x.jsx(Ff,{className:`w-5 h-5 transition-colors ${k?"fill-red-500 text-red-500":"text-gray-400 group-hover:text-red-400"}`})})]})]}),x.jsxs("div",{className:"flex items-start gap-2 text-gray-600 mb-6",children:[x.jsx(Vi,{className:"w-4 h-4 mt-1 flex-shrink-0 text-primary"}),x.jsx("p",{className:"text-sm font-medium",children:t.address||"ang cp nht a ch..."})]}),x.jsx("div",{className:"mb-6",children:x.jsxs(_n,{className:"w-full h-12 text-base font-bold bg-primary hover:bg-primary/90 text-white shadow-lg shadow-primary/20 rounded-xl transition-transform active:scale-[0.98]",onClick:ht,disabled:ot,children:[ot?x.jsx(Fi,{className:"w-5 h-5 animate-spin mr-2"}):x.jsx(Bx,{className:"w-5 h-5 mr-2"}),ot?"ang tm ng...":"Ch ng n y"]})}),O&&x.jsxs("div",{className:"mb-6 p-4 bg-blue-50 border border-blue-100 rounded-2xl flex flex-col gap-3",children:[x.jsxs("div",{className:"flex items-start gap-3",children:[x.jsx("div",{className:"p-2 bg-white rounded-full text-blue-600 shadow-sm",children:x.jsx(nl,{size:16})}),x.jsxs("div",{children:[x.jsx("p",{className:"text-sm font-bold text-blue-900",children:"Bn l ch a im ny?"}),x.jsx("p",{className:"text-xs text-blue-600 mt-0.5",children:"Xc minh ngay  qun l thng tin, hnh nh v to u i."})]})]}),x.jsx(_n,{variant:"outline",className:"w-full bg-white text-blue-600 border-blue-200 hover:bg-blue-600 hover:text-white h-10 text-xs font-bold rounded-xl transition-all",onClick:()=>u?.(t),children:"Xc nhn ch s hu"})]}),ze?x.jsx("div",{className:"h-20 bg-gray-50 rounded-xl mb-6 flex items-center justify-center border border-dashed border-gray-200",children:x.jsx(Fi,{className:"w-4 h-4 animate-spin text-gray-300"})}):ie.length>0&&x.jsxs("div",{className:"mb-6 space-y-3",children:[x.jsxs("h3",{className:"font-bold text-gray-800 flex items-center gap-2 text-sm uppercase tracking-wide",children:[x.jsx(Yy,{className:"w-4 h-4 text-orange-500"})," u i ang c (",ie.length,")"]}),ie.slice(0,2).map(xe=>{const We=we.has(xe.id);return x.jsxs("div",{className:"group relative border border-orange-100 bg-gradient-to-r from-orange-50 to-white rounded-xl p-3 flex items-center justify-between shadow-sm hover:shadow-md transition-all",children:[x.jsxs("div",{className:"flex items-center gap-3 overflow-hidden",children:[x.jsxs("div",{className:"w-12 h-12 bg-white text-orange-600 rounded-lg flex items-center justify-center font-bold text-sm flex-col shadow-sm border border-orange-100 shrink-0",children:[x.jsx("span",{children:xe.discount_value}),x.jsx("span",{className:"text-[10px] leading-none",children:xe.discount_type==="percent"?"%":"k"})]}),x.jsxs("div",{className:"min-w-0",children:[x.jsx("p",{className:"font-bold text-sm text-gray-900 truncate pr-2",children:xe.title_vi}),x.jsxs("p",{className:"text-[10px] text-gray-500 font-mono bg-white inline-block px-1 rounded border border-gray-100",children:["Code: ",xe.code]})]})]}),x.jsx(_n,{size:"sm",variant:We?"ghost":"default",className:`h-8 px-3 text-xs rounded-lg font-bold shrink-0 transition-all ${We?"text-green-600 bg-green-50 hover:bg-green-100 hover:text-green-700":"bg-orange-500 hover:bg-orange-600 text-white shadow-orange-200 shadow-md"}`,onClick:()=>gt(xe),disabled:We,children:We?" lu":"Lu"})]},xe.id)})]}),x.jsxs("div",{className:"space-y-4 pt-4 border-t border-gray-100",children:[x.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[x.jsx(Cb,{className:"w-4 h-4 text-gray-400"}),x.jsx("span",{children:"08:00 - 22:00 (M ca)"})]}),t.phone&&x.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[x.jsx(Ev,{className:"w-4 h-4 text-gray-400"}),x.jsx("a",{href:`tel:${t.phone}`,className:"hover:text-primary transition-colors",children:t.phone})]})]}),pt&&x.jsx("div",{className:"mt-4 pt-4 border-t border-gray-100",children:x.jsx("p",{className:"text-sm text-gray-600 leading-relaxed line-clamp-3",children:pt})}),x.jsx("div",{className:"absolute bottom-0 left-0 right-0 p-4 bg-white/90 backdrop-blur-md border-t border-gray-100 rounded-b-3xl md:rounded-b-3xl z-20",children:x.jsxs(_n,{variant:"secondary",className:"w-full h-12 font-bold text-gray-800 bg-gray-100 hover:bg-gray-200 border-none shadow-sm flex items-center justify-center gap-2 rounded-xl",onClick:Lt,children:[M?"Xem Menu & nh ca hng":"Xem chi tit y ",x.jsx(Sb,{className:"w-4 h-4"})]})})]})]}),x.jsx(aS,{isOpen:tt,onClose:()=>Pe(!1),location:t})]})},dK=()=>{const[t,e]=P.useState({origin:null,destination:null,route:null,isLoading:!1,error:null,transportMode:"walking",routePreference:"shortest"}),r=P.useCallback(v=>{e(b=>({...b,transportMode:v}))},[]),l=P.useCallback(v=>{e(b=>({...b,routePreference:v}))},[]),u=P.useCallback(async(v,b,a="walking",k="shortest")=>{e(M=>({...M,origin:v,destination:b,transportMode:a,routePreference:k,isLoading:!0,error:null}));try{const M=Yv(),z=await fetch(`https://api.mapbox.com/directions/v5/mapbox/${a==="walking"?"walking":a==="cycling"?"cycling":"driving"}/${v[0]},${v[1]};${b[0]},${b[1]}?geometries=geojson&steps=true&overview=full&alternatives=true&access_token=${M}`);if(!z.ok)throw new Error("Failed to fetch directions");const O=await z.json();if(O.routes&&O.routes.length>0){const H=[...O.routes].sort((Y,ee)=>k==="shortest"?Y.distance-ee.distance:Y.duration-ee.duration)[0],Z=[];H.legs&&H.legs.length>0&&H.legs.forEach(Y=>{Y.steps&&Y.steps.forEach(ee=>{Z.push({instruction:ee.maneuver?.instruction||"",distance:ee.distance,duration:ee.duration,maneuver:{type:ee.maneuver?.type||"",modifier:ee.maneuver?.modifier}})})}),e(Y=>({...Y,route:{distance:H.distance,duration:H.duration,geometry:H.geometry,steps:Z},isLoading:!1}))}else throw new Error("No route found")}catch(M){e(L=>({...L,error:M instanceof Error?M.message:"Unknown error",isLoading:!1}))}},[]),m=P.useCallback(()=>{e(v=>({origin:null,destination:null,route:null,isLoading:!1,error:null,transportMode:v.transportMode,routePreference:v.routePreference}))},[]);return{...t,getDirections:u,clearDirections:m,setTransportMode:r,setRoutePreference:l}},vx=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(1)} km`,hK=(t,e)=>{if(e==="en")return t;let r=t;const l=[[/Turn left/gi,"R tri"],[/Turn right/gi,"R phi"],[/Turn slight left/gi,"R nh sang tri"],[/Turn slight right/gi,"R nh sang phi"],[/Turn sharp left/gi,"R gp sang tri"],[/Turn sharp right/gi,"R gp sang phi"],[/Slight left/gi,"R nh sang tri"],[/Slight right/gi,"R nh sang phi"],[/Sharp left/gi,"R gp sang tri"],[/Sharp right/gi,"R gp sang phi"],[/Continue straight/gi,"Tip tc i thng"],[/Continue on/gi,"Tip tc theo"],[/Continue/gi,"Tip tc"],[/Go straight/gi,"i thng"],[/Head (north|south|east|west)/gi,"i v hng $1"],[/north/gi,"bc"],[/south/gi,"nam"],[/east/gi,"ng"],[/west/gi,"ty"],[/northeast/gi,"ng bc"],[/northwest/gi,"ty bc"],[/southeast/gi,"ng nam"],[/southwest/gi,"ty nam"],[/You have arrived at your destination/gi,"Bn  n im ch"],[/You have arrived/gi,"Bn  n ni"],[/Arrive at/gi,"n"],[/Your destination is on the left/gi,"im n  bn tri"],[/Your destination is on the right/gi,"im n  bn phi"],[/destination/gi,"im n"],[/Make a U-turn/gi,"Quay u"],[/U-turn/gi,"Quay u"],[/Enter the roundabout/gi,"i vo vng xuyn"],[/Exit the roundabout/gi,"Ra khi vng xuyn"],[/roundabout/gi,"vng xuyn"],[/Take the exit/gi,"i theo li ra"],[/Merge/gi,"Nhp ln"],[/Fork left/gi,"R tri ti ng ba"],[/Fork right/gi,"R phi ti ng ba"],[/Keep left/gi,"i bn tri"],[/Keep right/gi,"i bn phi"],[/for (\d+) meters/gi,"trong $1 mt"],[/for (\d+) m/gi,"trong $1 mt"],[/for (\d+\.?\d*) kilometers/gi,"trong $1 km"],[/for (\d+\.?\d*) km/gi,"trong $1 km"],[/onto/gi,"vo"],[/on the left/gi," bn tri"],[/on the right/gi," bn phi"],[/on your left/gi,"bn tri bn"],[/on your right/gi,"bn phi bn"],[/at the end of the road/gi," cui ng"],[/at the intersection/gi,"ti ng t"]];for(const[u,m]of l)r=r.replace(u,m);return r},vI=(t,e)=>{switch(t){case"turn":return e==="left"||e==="slight left"||e==="sharp left"?x.jsx(h1,{className:"w-4 h-4"}):e==="right"||e==="slight right"||e==="sharp right"?x.jsx(f1,{className:"w-4 h-4"}):x.jsx(cC,{className:"w-4 h-4"});case"depart":return x.jsx(Vi,{className:"w-4 h-4"});case"arrive":return x.jsx(CO,{className:"w-4 h-4"});case"merge":case"on ramp":case"off ramp":return e?.includes("left")?x.jsx(Sv,{className:"w-4 h-4"}):x.jsx(Sb,{className:"w-4 h-4"});case"fork":return e?.includes("left")?x.jsx(h1,{className:"w-4 h-4"}):x.jsx(f1,{className:"w-4 h-4"});case"end of road":return e?.includes("left")?x.jsx(h1,{className:"w-4 h-4"}):x.jsx(f1,{className:"w-4 h-4"});default:return x.jsx(cC,{className:"w-4 h-4"})}},fK=({routeInfo:t,destinationName:e,isLoading:r,transportMode:l,routePreference:u,currentStepIndex:m=0,distanceToNextStep:v=0,isTracking:b=!1,userAccuracy:a,onClose:k,onChangeTransportMode:M,onChangeRoutePreference:L,onAddStop:z})=>{const{t:O,language:K}=ra(),[H,Z]=P.useState(!1),[Y,ee]=P.useState(!1),ie=ze=>hK(ze,K)||O("continueStright"),pe=ze=>{const Ge=Math.round(ze/60);return Ge>=60?`${Math.floor(Ge/60)}g ${Ge%60}p`:`${Ge} pht`},we=t.steps[m],ke=[{mode:"walking",icon:vM,labelKey:"walking"},{mode:"cycling",icon:yM,labelKey:"cycling"},{mode:"driving",icon:_M,labelKey:"driving"}];return Y?x.jsx(yr.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:x.jsxs("button",{onClick:()=>ee(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-card/95 backdrop-blur-sm rounded-full shadow-lg border border-border",children:[x.jsx(Bx,{className:"w-4 h-4 text-primary"}),x.jsx("span",{className:"text-xs font-medium text-foreground truncate flex-1 text-left",children:e}),x.jsx("span",{className:"text-xs font-bold text-primary",children:vx(t.distance)}),x.jsx("span",{className:"text-xs text-muted-foreground",children:pe(t.duration)}),x.jsx(Hf,{className:"w-3.5 h-3.5 text-muted-foreground"})]})}):x.jsx(yr.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:x.jsxs("div",{className:"bg-card/95 backdrop-blur-sm rounded-xl shadow-lg border border-border p-2",children:[x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(Bx,{className:"w-4 h-4 text-primary flex-shrink-0"}),x.jsx("span",{className:"text-xs font-medium text-foreground truncate flex-1",children:e}),x.jsx("div",{className:"flex bg-muted/50 rounded-md p-0.5",children:ke.map(({mode:ze,icon:Ge})=>x.jsx("button",{onClick:()=>M(ze),className:ln("p-1 rounded transition-all",l===ze?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"),children:x.jsx(Ge,{className:"w-3 h-3"})},ze))}),x.jsx("span",{className:"text-xs font-bold text-primary",children:vx(t.distance)}),x.jsx("span",{className:"text-xs text-muted-foreground",children:pe(t.duration)}),z&&x.jsx("button",{onClick:z,className:"p-1 hover:bg-blue-100 text-blue-600 rounded transition-colors",title:"Thm im dng",children:x.jsx(_m,{className:"w-3.5 h-3.5"})}),t.steps?.length>0&&x.jsx("button",{onClick:()=>Z(!H),className:"p-1 hover:bg-muted rounded",children:H?x.jsx(Nm,{className:"w-3.5 h-3.5 text-muted-foreground"}):x.jsx(Hf,{className:"w-3.5 h-3.5 text-muted-foreground"})}),x.jsx("button",{onClick:()=>ee(!0),className:"p-1 hover:bg-muted rounded",children:x.jsx(Nm,{className:"w-3.5 h-3.5 text-muted-foreground"})}),x.jsx("button",{onClick:k,className:"p-1 hover:bg-destructive/20 rounded",children:x.jsx(ti,{className:"w-3.5 h-3.5 text-muted-foreground"})})]}),r&&x.jsx("div",{className:"flex items-center justify-center py-2",children:x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})}),b&&we&&x.jsxs("div",{className:"mt-2 p-2 bg-primary/10 rounded-lg flex items-center gap-2",children:[x.jsx("div",{className:"w-5 h-5 bg-primary rounded-full flex items-center justify-center flex-shrink-0 text-primary-foreground",children:vI(we.maneuver.type,we.maneuver.modifier)}),x.jsx("p",{className:"text-xs text-foreground flex-1 truncate",children:ie(we.instruction)}),v>0&&x.jsx("span",{className:"text-xs text-primary font-medium",children:vx(v)})]}),x.jsx(Ta,{children:H&&t.steps&&x.jsx(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.2},children:x.jsx(Kv,{className:"max-h-40 mt-2 border-t border-border pt-2",children:x.jsx("div",{className:"space-y-1",children:t.steps.map((ze,Ge)=>{const tt=b&&Ge===m,Pe=b&&Ge<m;return x.jsxs("div",{className:ln("flex items-center gap-2 p-1.5 rounded-lg text-xs",tt?"bg-primary/20":Pe?"opacity-50":"bg-muted/30"),children:[x.jsx("div",{className:ln("w-5 h-5 rounded-full flex items-center justify-center flex-shrink-0 text-[10px]",tt||Ge===0?"bg-primary text-primary-foreground":Ge===t.steps.length-1?"bg-destructive text-destructive-foreground":"bg-muted text-muted-foreground"),children:Pe?"":vI(ze.maneuver.type,ze.maneuver.modifier)}),x.jsx("span",{className:"flex-1 truncate text-foreground",children:ie(ze.instruction)}),x.jsx("span",{className:"text-muted-foreground",children:vx(ze.distance)})]},Ge)})})})})})]})})},pK=()=>{const[t,e]=P.useState({origin:null,waypoints:[],route:null,isLoading:!1,error:null,transportMode:"walking"}),r=P.useCallback(k=>{e(M=>({...M,transportMode:k}))},[]),l=P.useCallback(k=>{e(M=>({...M,waypoints:[...M.waypoints,k]}))},[]),u=P.useCallback(k=>{e(M=>({...M,waypoints:M.waypoints.filter((L,z)=>z!==k)}))},[]),m=P.useCallback(k=>{e(M=>({...M,waypoints:k}))},[]),v=P.useCallback(()=>{e(k=>({...k,waypoints:[],route:null}))},[]),b=P.useCallback(async(k,M,L="walking")=>{if(M.length!==0){e(z=>({...z,origin:k,waypoints:M,transportMode:L,isLoading:!0,error:null}));try{const z=Yv(),O=L==="walking"?"walking":L==="cycling"?"cycling":"driving",K=[k,...M],H=K.map(ee=>`${ee.coordinates[0]},${ee.coordinates[1]}`).join(";"),Z=await fetch(`https://api.mapbox.com/directions/v5/mapbox/${O}/${H}?geometries=geojson&steps=true&overview=full&access_token=${z}`);if(!Z.ok)throw new Error("Failed to fetch directions");const Y=await Z.json();if(Y.routes&&Y.routes.length>0){const ee=Y.routes[0],ie=ee.legs.map((pe,we)=>{const ke=pe.steps?.map(ze=>({instruction:ze.maneuver?.instruction||"",distance:ze.distance,duration:ze.duration,maneuver:{type:ze.maneuver?.type||"",modifier:ze.maneuver?.modifier}}))||[];return{distance:pe.distance,duration:pe.duration,steps:ke,originName:we===0?k.name:M[we-1].name,destinationName:M[we].name}});e(pe=>({...pe,route:{totalDistance:ee.distance,totalDuration:ee.duration,geometry:ee.geometry,legs:ie,waypoints:K},isLoading:!1}))}else throw new Error("No route found")}catch(z){e(O=>({...O,error:z instanceof Error?z.message:"Unknown error",isLoading:!1}))}}},[]),a=P.useCallback(()=>{e({origin:null,waypoints:[],route:null,isLoading:!1,error:null,transportMode:t.transportMode})},[t.transportMode]);return{...t,addWaypoint:l,removeWaypoint:u,reorderWaypoints:m,clearWaypoints:v,getMultiStopDirections:b,clearRoute:a,setTransportMode:r}},iw=t=>t<1e3?`${Math.round(t)} m`:`${(t/1e3).toFixed(1)} km`,wI=(t,e="vi")=>{const r=Math.round(t/60),l=e==="vi"?"pht":"min",u=e==="vi"?"gi":"hr";if(r<60)return`${r} ${l}`;const m=Math.floor(r/60),v=r%60;return`${m} ${u} ${v} ${l}`},mK=({routeInfo:t,waypoints:e,isLoading:r,transportMode:l,onClose:u,onChangeTransportMode:m,onRemoveWaypoint:v,onReorderWaypoints:b,onAddStop:a,isAddingStop:k})=>{const{t:M,language:L}=ra(),[z,O]=P.useState(null),[K,H]=P.useState(!1),[Z,Y]=P.useState(!1),ee=t?.waypoints.slice(1)||[],ie=[{mode:"walking",icon:vM,labelKey:"walking"},{mode:"cycling",icon:yM,labelKey:"cycling"},{mode:"driving",icon:_M,labelKey:"driving"}];return Z?x.jsx(yr.div,{initial:{y:-50,opacity:0},animate:{y:0,opacity:1},exit:{y:-50,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:x.jsxs("button",{onClick:()=>Y(!1),className:"w-full flex items-center gap-2 px-3 py-2 bg-card/95 backdrop-blur-sm rounded-full shadow-lg border border-border",children:[x.jsx(dC,{className:"w-4 h-4 text-purple-500"}),x.jsxs("span",{className:"text-xs font-medium text-foreground",children:[e.length," ",L==="vi"?"im":"stops"]}),t&&x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"text-xs font-bold text-purple-600",children:iw(t.totalDistance)}),x.jsx("span",{className:"text-xs text-muted-foreground",children:wI(t.totalDuration,L)})]}),x.jsx(Hf,{className:"w-3.5 h-3.5 text-muted-foreground ml-auto"})]})}):x.jsx(yr.div,{initial:{y:-100,opacity:0},animate:{y:0,opacity:1},exit:{y:-100,opacity:0},className:"absolute top-16 left-3 right-3 z-30",children:x.jsxs("div",{className:"bg-card/95 backdrop-blur-sm rounded-xl shadow-lg border border-border p-2",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx(dC,{className:"w-4 h-4 text-purple-500 flex-shrink-0"}),x.jsxs("span",{className:"text-xs font-medium text-foreground",children:[e.length," ",L==="vi"?"im":"stops"]}),x.jsx("div",{className:"flex bg-muted/50 rounded-md p-0.5",children:ie.map(({mode:pe,icon:we})=>x.jsx("button",{onClick:()=>m(pe),className:ln("p-1 rounded transition-all",l===pe?"bg-primary text-primary-foreground":"text-muted-foreground hover:text-foreground"),children:x.jsx(we,{className:"w-3 h-3"})},pe))}),t&&x.jsxs(x.Fragment,{children:[x.jsx("span",{className:"text-xs font-bold text-purple-600",children:iw(t.totalDistance)}),x.jsx("span",{className:"text-xs text-muted-foreground",children:wI(t.totalDuration,L)})]}),x.jsxs("div",{className:"ml-auto flex items-center gap-1",children:[x.jsx("button",{onClick:()=>Y(!0),className:"p-1 hover:bg-muted rounded",children:x.jsx(Nm,{className:"w-3.5 h-3.5 text-muted-foreground"})}),x.jsx("button",{onClick:u,className:"p-1 hover:bg-destructive/20 rounded",children:x.jsx(ti,{className:"w-3.5 h-3.5 text-muted-foreground"})})]})]}),x.jsx(Kv,{className:"max-h-28 mb-2",children:x.jsxs("div",{className:"space-y-1",children:[t?.waypoints[0]&&x.jsxs("div",{className:"flex items-center gap-1.5 p-1 bg-muted/30 rounded-lg",children:[x.jsx("div",{className:"w-5 h-5 rounded-full bg-green-500 flex items-center justify-center text-white text-[10px]",children:""}),x.jsx("span",{className:"text-[10px] text-foreground truncate flex-1",children:t.waypoints[0].name})]}),ee.length>0&&x.jsx(cW,{axis:"y",values:ee,onReorder:b,className:"space-y-1",children:ee.map((pe,we)=>{const ke=we===ee.length-1;return x.jsx(_W,{value:pe,onDragStart:()=>H(!0),onDragEnd:()=>H(!1),className:"cursor-grab active:cursor-grabbing",whileDrag:{scale:1.02,zIndex:50},children:x.jsxs("div",{className:ln("flex items-center gap-1.5 p-1 rounded-lg",K?"bg-muted":"bg-muted/30"),children:[x.jsx(AO,{className:"w-3 h-3 text-muted-foreground flex-shrink-0"}),x.jsx("div",{className:ln("w-5 h-5 rounded-full flex items-center justify-center text-[10px] font-bold text-white",ke?"bg-destructive":"bg-primary"),children:ke?"":we+1}),x.jsx("span",{className:"text-[10px] text-foreground truncate flex-1",children:pe.name}),t?.legs[we]&&x.jsx("span",{className:"text-[10px] text-muted-foreground",children:iw(t.legs[we].distance)}),x.jsx("button",{onClick:ze=>{ze.stopPropagation(),v(we)},className:"w-4 h-4 hover:bg-destructive/20 rounded flex items-center justify-center",children:x.jsx(ah,{className:"w-2.5 h-2.5 text-destructive"})})]})},pe.name+we)})})]})}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsxs(_n,{onClick:a,variant:"outline",size:"sm",className:"h-6 text-[10px] border-dashed flex-1",disabled:k,children:[x.jsx(_m,{className:"w-3 h-3 mr-1"}),k?L==="vi"?"Chn...":"Select...":L==="vi"?"Thm im":"Add stop"]}),r&&x.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-primary"})]})]})})};var Sr;(function(t){t.assertEqual=u=>{};function e(u){}t.assertIs=e;function r(u){throw new Error}t.assertNever=r,t.arrayToEnum=u=>{const m={};for(const v of u)m[v]=v;return m},t.getValidEnumValues=u=>{const m=t.objectKeys(u).filter(b=>typeof u[u[b]]!="number"),v={};for(const b of m)v[b]=u[b];return t.objectValues(v)},t.objectValues=u=>t.objectKeys(u).map(function(m){return u[m]}),t.objectKeys=typeof Object.keys=="function"?u=>Object.keys(u):u=>{const m=[];for(const v in u)Object.prototype.hasOwnProperty.call(u,v)&&m.push(v);return m},t.find=(u,m)=>{for(const v of u)if(m(v))return v},t.isInteger=typeof Number.isInteger=="function"?u=>Number.isInteger(u):u=>typeof u=="number"&&Number.isFinite(u)&&Math.floor(u)===u;function l(u,m=" | "){return u.map(v=>typeof v=="string"?`'${v}'`:v).join(m)}t.joinValues=l,t.jsonStringifyReplacer=(u,m)=>typeof m=="bigint"?m.toString():m})(Sr||(Sr={}));var bI;(function(t){t.mergeShapes=(e,r)=>({...e,...r})})(bI||(bI={}));const xn=Sr.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Jd=t=>{switch(typeof t){case"undefined":return xn.undefined;case"string":return xn.string;case"number":return Number.isNaN(t)?xn.nan:xn.number;case"boolean":return xn.boolean;case"function":return xn.function;case"bigint":return xn.bigint;case"symbol":return xn.symbol;case"object":return Array.isArray(t)?xn.array:t===null?xn.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?xn.promise:typeof Map<"u"&&t instanceof Map?xn.map:typeof Set<"u"&&t instanceof Set?xn.set:typeof Date<"u"&&t instanceof Date?xn.date:xn.object;default:return xn.unknown}},Gt=Sr.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Qu extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=l=>{this.issues=[...this.issues,l]},this.addIssues=(l=[])=>{this.issues=[...this.issues,...l]};const r=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,r):this.__proto__=r,this.name="ZodError",this.issues=e}format(e){const r=e||function(m){return m.message},l={_errors:[]},u=m=>{for(const v of m.issues)if(v.code==="invalid_union")v.unionErrors.map(u);else if(v.code==="invalid_return_type")u(v.returnTypeError);else if(v.code==="invalid_arguments")u(v.argumentsError);else if(v.path.length===0)l._errors.push(r(v));else{let b=l,a=0;for(;a<v.path.length;){const k=v.path[a];a===v.path.length-1?(b[k]=b[k]||{_errors:[]},b[k]._errors.push(r(v))):b[k]=b[k]||{_errors:[]},b=b[k],a++}}};return u(this),l}static assert(e){if(!(e instanceof Qu))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Sr.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=r=>r.message){const r={},l=[];for(const u of this.issues)if(u.path.length>0){const m=u.path[0];r[m]=r[m]||[],r[m].push(e(u))}else l.push(e(u));return{formErrors:l,fieldErrors:r}}get formErrors(){return this.flatten()}}Qu.create=t=>new Qu(t);const fb=(t,e)=>{let r;switch(t.code){case Gt.invalid_type:t.received===xn.undefined?r="Required":r=`Expected ${t.expected}, received ${t.received}`;break;case Gt.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,Sr.jsonStringifyReplacer)}`;break;case Gt.unrecognized_keys:r=`Unrecognized key(s) in object: ${Sr.joinValues(t.keys,", ")}`;break;case Gt.invalid_union:r="Invalid input";break;case Gt.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${Sr.joinValues(t.options)}`;break;case Gt.invalid_enum_value:r=`Invalid enum value. Expected ${Sr.joinValues(t.options)}, received '${t.received}'`;break;case Gt.invalid_arguments:r="Invalid function arguments";break;case Gt.invalid_return_type:r="Invalid function return type";break;case Gt.invalid_date:r="Invalid date";break;case Gt.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:Sr.assertNever(t.validation):t.validation!=="regex"?r=`Invalid ${t.validation}`:r="Invalid";break;case Gt.too_small:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="bigint"?r=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:r="Invalid input";break;case Gt.too_big:t.type==="array"?r=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?r=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?r=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?r=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?r=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:r="Invalid input";break;case Gt.custom:r="Invalid input";break;case Gt.invalid_intersection_types:r="Intersection results could not be merged";break;case Gt.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case Gt.not_finite:r="Number must be finite";break;default:r=e.defaultError,Sr.assertNever(t)}return{message:r}};let gK=fb;function yK(){return gK}const _K=t=>{const{data:e,path:r,errorMaps:l,issueData:u}=t,m=[...r,...u.path||[]],v={...u,path:m};if(u.message!==void 0)return{...u,path:m,message:u.message};let b="";const a=l.filter(k=>!!k).slice().reverse();for(const k of a)b=k(v,{data:e,defaultError:b}).message;return{...u,path:m,message:b}};function on(t,e){const r=yK(),l=_K({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===fb?void 0:fb].filter(u=>!!u)});t.common.issues.push(l)}class Ca{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,r){const l=[];for(const u of r){if(u.status==="aborted")return qn;u.status==="dirty"&&e.dirty(),l.push(u.value)}return{status:e.value,value:l}}static async mergeObjectAsync(e,r){const l=[];for(const u of r){const m=await u.key,v=await u.value;l.push({key:m,value:v})}return Ca.mergeObjectSync(e,l)}static mergeObjectSync(e,r){const l={};for(const u of r){const{key:m,value:v}=u;if(m.status==="aborted"||v.status==="aborted")return qn;m.status==="dirty"&&e.dirty(),v.status==="dirty"&&e.dirty(),m.value!=="__proto__"&&(typeof v.value<"u"||u.alwaysSet)&&(l[m.value]=v.value)}return{status:e.value,value:l}}}const qn=Object.freeze({status:"aborted"}),cy=t=>({status:"dirty",value:t}),al=t=>({status:"valid",value:t}),TI=t=>t.status==="aborted",SI=t=>t.status==="dirty",Fm=t=>t.status==="valid",hv=t=>typeof Promise<"u"&&t instanceof Promise;var bn;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(bn||(bn={}));class yh{constructor(e,r,l,u){this._cachedPath=[],this.parent=e,this.data=r,this._path=l,this._key=u}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const EI=(t,e)=>{if(Fm(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const r=new Qu(t.common.issues);return this._error=r,this._error}}};function dr(t){if(!t)return{};const{errorMap:e,invalid_type_error:r,required_error:l,description:u}=t;if(e&&(r||l))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:u}:{errorMap:(v,b)=>{const{message:a}=t;return v.code==="invalid_enum_value"?{message:a??b.defaultError}:typeof b.data>"u"?{message:a??l??b.defaultError}:v.code!=="invalid_type"?{message:b.defaultError}:{message:a??r??b.defaultError}},description:u}}class vr{get description(){return this._def.description}_getType(e){return Jd(e.data)}_getOrReturnCtx(e,r){return r||{common:e.parent.common,data:e.data,parsedType:Jd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ca,ctx:{common:e.parent.common,data:e.data,parsedType:Jd(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const r=this._parse(e);if(hv(r))throw new Error("Synchronous parse encountered promise.");return r}_parseAsync(e){const r=this._parse(e);return Promise.resolve(r)}parse(e,r){const l=this.safeParse(e,r);if(l.success)return l.data;throw l.error}safeParse(e,r){const l={common:{issues:[],async:r?.async??!1,contextualErrorMap:r?.errorMap},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)},u=this._parseSync({data:e,path:l.path,parent:l});return EI(l,u)}"~validate"(e){const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)};if(!this["~standard"].async)try{const l=this._parseSync({data:e,path:[],parent:r});return Fm(l)?{value:l.value}:{issues:r.common.issues}}catch(l){l?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then(l=>Fm(l)?{value:l.value}:{issues:r.common.issues})}async parseAsync(e,r){const l=await this.safeParseAsync(e,r);if(l.success)return l.data;throw l.error}async safeParseAsync(e,r){const l={common:{issues:[],contextualErrorMap:r?.errorMap,async:!0},path:r?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Jd(e)},u=this._parse({data:e,path:l.path,parent:l}),m=await(hv(u)?u:Promise.resolve(u));return EI(l,m)}refine(e,r){const l=u=>typeof r=="string"||typeof r>"u"?{message:r}:typeof r=="function"?r(u):r;return this._refinement((u,m)=>{const v=e(u),b=()=>m.addIssue({code:Gt.custom,...l(u)});return typeof Promise<"u"&&v instanceof Promise?v.then(a=>a?!0:(b(),!1)):v?!0:(b(),!1)})}refinement(e,r){return this._refinement((l,u)=>e(l)?!0:(u.addIssue(typeof r=="function"?r(l,u):r),!1))}_refinement(e){return new Um({schema:this,typeName:Zn.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:r=>this["~validate"](r)}}optional(){return dh.create(this,this._def)}nullable(){return $m.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zc.create(this)}promise(){return gv.create(this,this._def)}or(e){return pv.create([this,e],this._def)}and(e){return mv.create(this,e,this._def)}transform(e){return new Um({...dr(this._def),schema:this,typeName:Zn.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const r=typeof e=="function"?e:()=>e;return new mb({...dr(this._def),innerType:this,defaultValue:r,typeName:Zn.ZodDefault})}brand(){return new VK({typeName:Zn.ZodBranded,type:this,...dr(this._def)})}catch(e){const r=typeof e=="function"?e:()=>e;return new gb({...dr(this._def),innerType:this,catchValue:r,typeName:Zn.ZodCatch})}describe(e){const r=this.constructor;return new r({...this._def,description:e})}pipe(e){return lS.create(this,e)}readonly(){return yb.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const xK=/^c[^\s-]{8,}$/i,vK=/^[0-9a-z]+$/,wK=/^[0-9A-HJKMNP-TV-Z]{26}$/i,bK=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,TK=/^[a-z0-9_-]{21}$/i,SK=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,EK=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,CK=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,kK="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let sw;const AK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,IK=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,MK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,PK=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,RK=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,NK=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,k4="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",DK=new RegExp(`^${k4}$`);function A4(t){let e="[0-5]\\d";t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`);const r=t.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${r}`}function LK(t){return new RegExp(`^${A4(t)}$`)}function jK(t){let e=`${k4}T${A4(t)}`;const r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${r.join("|")})`,new RegExp(`^${e}$`)}function OK(t,e){return!!((e==="v4"||!e)&&AK.test(t)||(e==="v6"||!e)&&MK.test(t))}function zK(t,e){if(!SK.test(t))return!1;try{const[r]=t.split(".");if(!r)return!1;const l=r.replace(/-/g,"+").replace(/_/g,"/").padEnd(r.length+(4-r.length%4)%4,"="),u=JSON.parse(atob(l));return!(typeof u!="object"||u===null||"typ"in u&&u?.typ!=="JWT"||!u.alg||e&&u.alg!==e)}catch{return!1}}function BK(t,e){return!!((e==="v4"||!e)&&IK.test(t)||(e==="v6"||!e)&&PK.test(t))}class sh extends vr{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==xn.string){const m=this._getOrReturnCtx(e);return on(m,{code:Gt.invalid_type,expected:xn.string,received:m.parsedType}),qn}const l=new Ca;let u;for(const m of this._def.checks)if(m.kind==="min")e.data.length<m.value&&(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.too_small,minimum:m.value,type:"string",inclusive:!0,exact:!1,message:m.message}),l.dirty());else if(m.kind==="max")e.data.length>m.value&&(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.too_big,maximum:m.value,type:"string",inclusive:!0,exact:!1,message:m.message}),l.dirty());else if(m.kind==="length"){const v=e.data.length>m.value,b=e.data.length<m.value;(v||b)&&(u=this._getOrReturnCtx(e,u),v?on(u,{code:Gt.too_big,maximum:m.value,type:"string",inclusive:!0,exact:!0,message:m.message}):b&&on(u,{code:Gt.too_small,minimum:m.value,type:"string",inclusive:!0,exact:!0,message:m.message}),l.dirty())}else if(m.kind==="email")CK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"email",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="emoji")sw||(sw=new RegExp(kK,"u")),sw.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"emoji",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="uuid")bK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"uuid",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="nanoid")TK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"nanoid",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="cuid")xK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"cuid",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="cuid2")vK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"cuid2",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="ulid")wK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"ulid",code:Gt.invalid_string,message:m.message}),l.dirty());else if(m.kind==="url")try{new URL(e.data)}catch{u=this._getOrReturnCtx(e,u),on(u,{validation:"url",code:Gt.invalid_string,message:m.message}),l.dirty()}else m.kind==="regex"?(m.regex.lastIndex=0,m.regex.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"regex",code:Gt.invalid_string,message:m.message}),l.dirty())):m.kind==="trim"?e.data=e.data.trim():m.kind==="includes"?e.data.includes(m.value,m.position)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:{includes:m.value,position:m.position},message:m.message}),l.dirty()):m.kind==="toLowerCase"?e.data=e.data.toLowerCase():m.kind==="toUpperCase"?e.data=e.data.toUpperCase():m.kind==="startsWith"?e.data.startsWith(m.value)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:{startsWith:m.value},message:m.message}),l.dirty()):m.kind==="endsWith"?e.data.endsWith(m.value)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:{endsWith:m.value},message:m.message}),l.dirty()):m.kind==="datetime"?jK(m).test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:"datetime",message:m.message}),l.dirty()):m.kind==="date"?DK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:"date",message:m.message}),l.dirty()):m.kind==="time"?LK(m).test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.invalid_string,validation:"time",message:m.message}),l.dirty()):m.kind==="duration"?EK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"duration",code:Gt.invalid_string,message:m.message}),l.dirty()):m.kind==="ip"?OK(e.data,m.version)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"ip",code:Gt.invalid_string,message:m.message}),l.dirty()):m.kind==="jwt"?zK(e.data,m.alg)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"jwt",code:Gt.invalid_string,message:m.message}),l.dirty()):m.kind==="cidr"?BK(e.data,m.version)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"cidr",code:Gt.invalid_string,message:m.message}),l.dirty()):m.kind==="base64"?RK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"base64",code:Gt.invalid_string,message:m.message}),l.dirty()):m.kind==="base64url"?NK.test(e.data)||(u=this._getOrReturnCtx(e,u),on(u,{validation:"base64url",code:Gt.invalid_string,message:m.message}),l.dirty()):Sr.assertNever(m);return{status:l.value,value:e.data}}_regex(e,r,l){return this.refinement(u=>e.test(u),{validation:r,code:Gt.invalid_string,...bn.errToObj(l)})}_addCheck(e){return new sh({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...bn.errToObj(e)})}url(e){return this._addCheck({kind:"url",...bn.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...bn.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...bn.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...bn.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...bn.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...bn.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...bn.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...bn.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...bn.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...bn.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...bn.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...bn.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...bn.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...bn.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...bn.errToObj(e)})}regex(e,r){return this._addCheck({kind:"regex",regex:e,...bn.errToObj(r)})}includes(e,r){return this._addCheck({kind:"includes",value:e,position:r?.position,...bn.errToObj(r?.message)})}startsWith(e,r){return this._addCheck({kind:"startsWith",value:e,...bn.errToObj(r)})}endsWith(e,r){return this._addCheck({kind:"endsWith",value:e,...bn.errToObj(r)})}min(e,r){return this._addCheck({kind:"min",value:e,...bn.errToObj(r)})}max(e,r){return this._addCheck({kind:"max",value:e,...bn.errToObj(r)})}length(e,r){return this._addCheck({kind:"length",value:e,...bn.errToObj(r)})}nonempty(e){return this.min(1,bn.errToObj(e))}trim(){return new sh({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new sh({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new sh({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxLength(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}sh.create=t=>new sh({checks:[],typeName:Zn.ZodString,coerce:t?.coerce??!1,...dr(t)});function FK(t,e){const r=(t.toString().split(".")[1]||"").length,l=(e.toString().split(".")[1]||"").length,u=r>l?r:l,m=Number.parseInt(t.toFixed(u).replace(".","")),v=Number.parseInt(e.toFixed(u).replace(".",""));return m%v/10**u}class Uy extends vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==xn.number){const m=this._getOrReturnCtx(e);return on(m,{code:Gt.invalid_type,expected:xn.number,received:m.parsedType}),qn}let l;const u=new Ca;for(const m of this._def.checks)m.kind==="int"?Sr.isInteger(e.data)||(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.invalid_type,expected:"integer",received:"float",message:m.message}),u.dirty()):m.kind==="min"?(m.inclusive?e.data<m.value:e.data<=m.value)&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.too_small,minimum:m.value,type:"number",inclusive:m.inclusive,exact:!1,message:m.message}),u.dirty()):m.kind==="max"?(m.inclusive?e.data>m.value:e.data>=m.value)&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.too_big,maximum:m.value,type:"number",inclusive:m.inclusive,exact:!1,message:m.message}),u.dirty()):m.kind==="multipleOf"?FK(e.data,m.value)!==0&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.not_multiple_of,multipleOf:m.value,message:m.message}),u.dirty()):m.kind==="finite"?Number.isFinite(e.data)||(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.not_finite,message:m.message}),u.dirty()):Sr.assertNever(m);return{status:u.value,value:e.data}}gte(e,r){return this.setLimit("min",e,!0,bn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,bn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,bn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,bn.toString(r))}setLimit(e,r,l,u){return new Uy({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:l,message:bn.toString(u)}]})}_addCheck(e){return new Uy({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:bn.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:bn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:bn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:bn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:bn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:bn.toString(r)})}finite(e){return this._addCheck({kind:"finite",message:bn.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:bn.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:bn.toString(e)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Sr.isInteger(e.value))}get isFinite(){let e=null,r=null;for(const l of this._def.checks){if(l.kind==="finite"||l.kind==="int"||l.kind==="multipleOf")return!0;l.kind==="min"?(r===null||l.value>r)&&(r=l.value):l.kind==="max"&&(e===null||l.value<e)&&(e=l.value)}return Number.isFinite(r)&&Number.isFinite(e)}}Uy.create=t=>new Uy({checks:[],typeName:Zn.ZodNumber,coerce:t?.coerce||!1,...dr(t)});class $y extends vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==xn.bigint)return this._getInvalidInput(e);let l;const u=new Ca;for(const m of this._def.checks)m.kind==="min"?(m.inclusive?e.data<m.value:e.data<=m.value)&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.too_small,type:"bigint",minimum:m.value,inclusive:m.inclusive,message:m.message}),u.dirty()):m.kind==="max"?(m.inclusive?e.data>m.value:e.data>=m.value)&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.too_big,type:"bigint",maximum:m.value,inclusive:m.inclusive,message:m.message}),u.dirty()):m.kind==="multipleOf"?e.data%m.value!==BigInt(0)&&(l=this._getOrReturnCtx(e,l),on(l,{code:Gt.not_multiple_of,multipleOf:m.value,message:m.message}),u.dirty()):Sr.assertNever(m);return{status:u.value,value:e.data}}_getInvalidInput(e){const r=this._getOrReturnCtx(e);return on(r,{code:Gt.invalid_type,expected:xn.bigint,received:r.parsedType}),qn}gte(e,r){return this.setLimit("min",e,!0,bn.toString(r))}gt(e,r){return this.setLimit("min",e,!1,bn.toString(r))}lte(e,r){return this.setLimit("max",e,!0,bn.toString(r))}lt(e,r){return this.setLimit("max",e,!1,bn.toString(r))}setLimit(e,r,l,u){return new $y({...this._def,checks:[...this._def.checks,{kind:e,value:r,inclusive:l,message:bn.toString(u)}]})}_addCheck(e){return new $y({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:bn.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:bn.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:bn.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:bn.toString(e)})}multipleOf(e,r){return this._addCheck({kind:"multipleOf",value:e,message:bn.toString(r)})}get minValue(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e}get maxValue(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e}}$y.create=t=>new $y({checks:[],typeName:Zn.ZodBigInt,coerce:t?.coerce??!1,...dr(t)});class CI extends vr{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==xn.boolean){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.boolean,received:l.parsedType}),qn}return al(e.data)}}CI.create=t=>new CI({typeName:Zn.ZodBoolean,coerce:t?.coerce||!1,...dr(t)});class fv extends vr{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==xn.date){const m=this._getOrReturnCtx(e);return on(m,{code:Gt.invalid_type,expected:xn.date,received:m.parsedType}),qn}if(Number.isNaN(e.data.getTime())){const m=this._getOrReturnCtx(e);return on(m,{code:Gt.invalid_date}),qn}const l=new Ca;let u;for(const m of this._def.checks)m.kind==="min"?e.data.getTime()<m.value&&(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.too_small,message:m.message,inclusive:!0,exact:!1,minimum:m.value,type:"date"}),l.dirty()):m.kind==="max"?e.data.getTime()>m.value&&(u=this._getOrReturnCtx(e,u),on(u,{code:Gt.too_big,message:m.message,inclusive:!0,exact:!1,maximum:m.value,type:"date"}),l.dirty()):Sr.assertNever(m);return{status:l.value,value:new Date(e.data.getTime())}}_addCheck(e){return new fv({...this._def,checks:[...this._def.checks,e]})}min(e,r){return this._addCheck({kind:"min",value:e.getTime(),message:bn.toString(r)})}max(e,r){return this._addCheck({kind:"max",value:e.getTime(),message:bn.toString(r)})}get minDate(){let e=null;for(const r of this._def.checks)r.kind==="min"&&(e===null||r.value>e)&&(e=r.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const r of this._def.checks)r.kind==="max"&&(e===null||r.value<e)&&(e=r.value);return e!=null?new Date(e):null}}fv.create=t=>new fv({checks:[],coerce:t?.coerce||!1,typeName:Zn.ZodDate,...dr(t)});class kI extends vr{_parse(e){if(this._getType(e)!==xn.symbol){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.symbol,received:l.parsedType}),qn}return al(e.data)}}kI.create=t=>new kI({typeName:Zn.ZodSymbol,...dr(t)});class AI extends vr{_parse(e){if(this._getType(e)!==xn.undefined){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.undefined,received:l.parsedType}),qn}return al(e.data)}}AI.create=t=>new AI({typeName:Zn.ZodUndefined,...dr(t)});class II extends vr{_parse(e){if(this._getType(e)!==xn.null){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.null,received:l.parsedType}),qn}return al(e.data)}}II.create=t=>new II({typeName:Zn.ZodNull,...dr(t)});class MI extends vr{constructor(){super(...arguments),this._any=!0}_parse(e){return al(e.data)}}MI.create=t=>new MI({typeName:Zn.ZodAny,...dr(t)});class PI extends vr{constructor(){super(...arguments),this._unknown=!0}_parse(e){return al(e.data)}}PI.create=t=>new PI({typeName:Zn.ZodUnknown,...dr(t)});class _h extends vr{_parse(e){const r=this._getOrReturnCtx(e);return on(r,{code:Gt.invalid_type,expected:xn.never,received:r.parsedType}),qn}}_h.create=t=>new _h({typeName:Zn.ZodNever,...dr(t)});class RI extends vr{_parse(e){if(this._getType(e)!==xn.undefined){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.void,received:l.parsedType}),qn}return al(e.data)}}RI.create=t=>new RI({typeName:Zn.ZodVoid,...dr(t)});class Zc extends vr{_parse(e){const{ctx:r,status:l}=this._processInputParams(e),u=this._def;if(r.parsedType!==xn.array)return on(r,{code:Gt.invalid_type,expected:xn.array,received:r.parsedType}),qn;if(u.exactLength!==null){const v=r.data.length>u.exactLength.value,b=r.data.length<u.exactLength.value;(v||b)&&(on(r,{code:v?Gt.too_big:Gt.too_small,minimum:b?u.exactLength.value:void 0,maximum:v?u.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:u.exactLength.message}),l.dirty())}if(u.minLength!==null&&r.data.length<u.minLength.value&&(on(r,{code:Gt.too_small,minimum:u.minLength.value,type:"array",inclusive:!0,exact:!1,message:u.minLength.message}),l.dirty()),u.maxLength!==null&&r.data.length>u.maxLength.value&&(on(r,{code:Gt.too_big,maximum:u.maxLength.value,type:"array",inclusive:!0,exact:!1,message:u.maxLength.message}),l.dirty()),r.common.async)return Promise.all([...r.data].map((v,b)=>u.type._parseAsync(new yh(r,v,r.path,b)))).then(v=>Ca.mergeArray(l,v));const m=[...r.data].map((v,b)=>u.type._parseSync(new yh(r,v,r.path,b)));return Ca.mergeArray(l,m)}get element(){return this._def.type}min(e,r){return new Zc({...this._def,minLength:{value:e,message:bn.toString(r)}})}max(e,r){return new Zc({...this._def,maxLength:{value:e,message:bn.toString(r)}})}length(e,r){return new Zc({...this._def,exactLength:{value:e,message:bn.toString(r)}})}nonempty(e){return this.min(1,e)}}Zc.create=(t,e)=>new Zc({type:t,minLength:null,maxLength:null,exactLength:null,typeName:Zn.ZodArray,...dr(e)});function mm(t){if(t instanceof ms){const e={};for(const r in t.shape){const l=t.shape[r];e[r]=dh.create(mm(l))}return new ms({...t._def,shape:()=>e})}else return t instanceof Zc?new Zc({...t._def,type:mm(t.element)}):t instanceof dh?dh.create(mm(t.unwrap())):t instanceof $m?$m.create(mm(t.unwrap())):t instanceof tp?tp.create(t.items.map(e=>mm(e))):t}class ms extends vr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),r=Sr.objectKeys(e);return this._cached={shape:e,keys:r},this._cached}_parse(e){if(this._getType(e)!==xn.object){const k=this._getOrReturnCtx(e);return on(k,{code:Gt.invalid_type,expected:xn.object,received:k.parsedType}),qn}const{status:l,ctx:u}=this._processInputParams(e),{shape:m,keys:v}=this._getCached(),b=[];if(!(this._def.catchall instanceof _h&&this._def.unknownKeys==="strip"))for(const k in u.data)v.includes(k)||b.push(k);const a=[];for(const k of v){const M=m[k],L=u.data[k];a.push({key:{status:"valid",value:k},value:M._parse(new yh(u,L,u.path,k)),alwaysSet:k in u.data})}if(this._def.catchall instanceof _h){const k=this._def.unknownKeys;if(k==="passthrough")for(const M of b)a.push({key:{status:"valid",value:M},value:{status:"valid",value:u.data[M]}});else if(k==="strict")b.length>0&&(on(u,{code:Gt.unrecognized_keys,keys:b}),l.dirty());else if(k!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const k=this._def.catchall;for(const M of b){const L=u.data[M];a.push({key:{status:"valid",value:M},value:k._parse(new yh(u,L,u.path,M)),alwaysSet:M in u.data})}}return u.common.async?Promise.resolve().then(async()=>{const k=[];for(const M of a){const L=await M.key,z=await M.value;k.push({key:L,value:z,alwaysSet:M.alwaysSet})}return k}).then(k=>Ca.mergeObjectSync(l,k)):Ca.mergeObjectSync(l,a)}get shape(){return this._def.shape()}strict(e){return bn.errToObj,new ms({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(r,l)=>{const u=this._def.errorMap?.(r,l).message??l.defaultError;return r.code==="unrecognized_keys"?{message:bn.errToObj(e).message??u}:{message:u}}}:{}})}strip(){return new ms({...this._def,unknownKeys:"strip"})}passthrough(){return new ms({...this._def,unknownKeys:"passthrough"})}extend(e){return new ms({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new ms({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Zn.ZodObject})}setKey(e,r){return this.augment({[e]:r})}catchall(e){return new ms({...this._def,catchall:e})}pick(e){const r={};for(const l of Sr.objectKeys(e))e[l]&&this.shape[l]&&(r[l]=this.shape[l]);return new ms({...this._def,shape:()=>r})}omit(e){const r={};for(const l of Sr.objectKeys(this.shape))e[l]||(r[l]=this.shape[l]);return new ms({...this._def,shape:()=>r})}deepPartial(){return mm(this)}partial(e){const r={};for(const l of Sr.objectKeys(this.shape)){const u=this.shape[l];e&&!e[l]?r[l]=u:r[l]=u.optional()}return new ms({...this._def,shape:()=>r})}required(e){const r={};for(const l of Sr.objectKeys(this.shape))if(e&&!e[l])r[l]=this.shape[l];else{let m=this.shape[l];for(;m instanceof dh;)m=m._def.innerType;r[l]=m}return new ms({...this._def,shape:()=>r})}keyof(){return I4(Sr.objectKeys(this.shape))}}ms.create=(t,e)=>new ms({shape:()=>t,unknownKeys:"strip",catchall:_h.create(),typeName:Zn.ZodObject,...dr(e)});ms.strictCreate=(t,e)=>new ms({shape:()=>t,unknownKeys:"strict",catchall:_h.create(),typeName:Zn.ZodObject,...dr(e)});ms.lazycreate=(t,e)=>new ms({shape:t,unknownKeys:"strip",catchall:_h.create(),typeName:Zn.ZodObject,...dr(e)});class pv extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l=this._def.options;function u(m){for(const b of m)if(b.result.status==="valid")return b.result;for(const b of m)if(b.result.status==="dirty")return r.common.issues.push(...b.ctx.common.issues),b.result;const v=m.map(b=>new Qu(b.ctx.common.issues));return on(r,{code:Gt.invalid_union,unionErrors:v}),qn}if(r.common.async)return Promise.all(l.map(async m=>{const v={...r,common:{...r.common,issues:[]},parent:null};return{result:await m._parseAsync({data:r.data,path:r.path,parent:v}),ctx:v}})).then(u);{let m;const v=[];for(const a of l){const k={...r,common:{...r.common,issues:[]},parent:null},M=a._parseSync({data:r.data,path:r.path,parent:k});if(M.status==="valid")return M;M.status==="dirty"&&!m&&(m={result:M,ctx:k}),k.common.issues.length&&v.push(k.common.issues)}if(m)return r.common.issues.push(...m.ctx.common.issues),m.result;const b=v.map(a=>new Qu(a));return on(r,{code:Gt.invalid_union,unionErrors:b}),qn}}get options(){return this._def.options}}pv.create=(t,e)=>new pv({options:t,typeName:Zn.ZodUnion,...dr(e)});function pb(t,e){const r=Jd(t),l=Jd(e);if(t===e)return{valid:!0,data:t};if(r===xn.object&&l===xn.object){const u=Sr.objectKeys(e),m=Sr.objectKeys(t).filter(b=>u.indexOf(b)!==-1),v={...t,...e};for(const b of m){const a=pb(t[b],e[b]);if(!a.valid)return{valid:!1};v[b]=a.data}return{valid:!0,data:v}}else if(r===xn.array&&l===xn.array){if(t.length!==e.length)return{valid:!1};const u=[];for(let m=0;m<t.length;m++){const v=t[m],b=e[m],a=pb(v,b);if(!a.valid)return{valid:!1};u.push(a.data)}return{valid:!0,data:u}}else return r===xn.date&&l===xn.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class mv extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e),u=(m,v)=>{if(TI(m)||TI(v))return qn;const b=pb(m.value,v.value);return b.valid?((SI(m)||SI(v))&&r.dirty(),{status:r.value,value:b.data}):(on(l,{code:Gt.invalid_intersection_types}),qn)};return l.common.async?Promise.all([this._def.left._parseAsync({data:l.data,path:l.path,parent:l}),this._def.right._parseAsync({data:l.data,path:l.path,parent:l})]).then(([m,v])=>u(m,v)):u(this._def.left._parseSync({data:l.data,path:l.path,parent:l}),this._def.right._parseSync({data:l.data,path:l.path,parent:l}))}}mv.create=(t,e,r)=>new mv({left:t,right:e,typeName:Zn.ZodIntersection,...dr(r)});class tp extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.array)return on(l,{code:Gt.invalid_type,expected:xn.array,received:l.parsedType}),qn;if(l.data.length<this._def.items.length)return on(l,{code:Gt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),qn;!this._def.rest&&l.data.length>this._def.items.length&&(on(l,{code:Gt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),r.dirty());const m=[...l.data].map((v,b)=>{const a=this._def.items[b]||this._def.rest;return a?a._parse(new yh(l,v,l.path,b)):null}).filter(v=>!!v);return l.common.async?Promise.all(m).then(v=>Ca.mergeArray(r,v)):Ca.mergeArray(r,m)}get items(){return this._def.items}rest(e){return new tp({...this._def,rest:e})}}tp.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new tp({items:t,typeName:Zn.ZodTuple,rest:null,...dr(e)})};class NI extends vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.map)return on(l,{code:Gt.invalid_type,expected:xn.map,received:l.parsedType}),qn;const u=this._def.keyType,m=this._def.valueType,v=[...l.data.entries()].map(([b,a],k)=>({key:u._parse(new yh(l,b,l.path,[k,"key"])),value:m._parse(new yh(l,a,l.path,[k,"value"]))}));if(l.common.async){const b=new Map;return Promise.resolve().then(async()=>{for(const a of v){const k=await a.key,M=await a.value;if(k.status==="aborted"||M.status==="aborted")return qn;(k.status==="dirty"||M.status==="dirty")&&r.dirty(),b.set(k.value,M.value)}return{status:r.value,value:b}})}else{const b=new Map;for(const a of v){const k=a.key,M=a.value;if(k.status==="aborted"||M.status==="aborted")return qn;(k.status==="dirty"||M.status==="dirty")&&r.dirty(),b.set(k.value,M.value)}return{status:r.value,value:b}}}}NI.create=(t,e,r)=>new NI({valueType:e,keyType:t,typeName:Zn.ZodMap,...dr(r)});class Gy extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.parsedType!==xn.set)return on(l,{code:Gt.invalid_type,expected:xn.set,received:l.parsedType}),qn;const u=this._def;u.minSize!==null&&l.data.size<u.minSize.value&&(on(l,{code:Gt.too_small,minimum:u.minSize.value,type:"set",inclusive:!0,exact:!1,message:u.minSize.message}),r.dirty()),u.maxSize!==null&&l.data.size>u.maxSize.value&&(on(l,{code:Gt.too_big,maximum:u.maxSize.value,type:"set",inclusive:!0,exact:!1,message:u.maxSize.message}),r.dirty());const m=this._def.valueType;function v(a){const k=new Set;for(const M of a){if(M.status==="aborted")return qn;M.status==="dirty"&&r.dirty(),k.add(M.value)}return{status:r.value,value:k}}const b=[...l.data.values()].map((a,k)=>m._parse(new yh(l,a,l.path,k)));return l.common.async?Promise.all(b).then(a=>v(a)):v(b)}min(e,r){return new Gy({...this._def,minSize:{value:e,message:bn.toString(r)}})}max(e,r){return new Gy({...this._def,maxSize:{value:e,message:bn.toString(r)}})}size(e,r){return this.min(e,r).max(e,r)}nonempty(e){return this.min(1,e)}}Gy.create=(t,e)=>new Gy({valueType:t,minSize:null,maxSize:null,typeName:Zn.ZodSet,...dr(e)});class DI extends vr{get schema(){return this._def.getter()}_parse(e){const{ctx:r}=this._processInputParams(e);return this._def.getter()._parse({data:r.data,path:r.path,parent:r})}}DI.create=(t,e)=>new DI({getter:t,typeName:Zn.ZodLazy,...dr(e)});class LI extends vr{_parse(e){if(e.data!==this._def.value){const r=this._getOrReturnCtx(e);return on(r,{received:r.data,code:Gt.invalid_literal,expected:this._def.value}),qn}return{status:"valid",value:e.data}}get value(){return this._def.value}}LI.create=(t,e)=>new LI({value:t,typeName:Zn.ZodLiteral,...dr(e)});function I4(t,e){return new Vm({values:t,typeName:Zn.ZodEnum,...dr(e)})}class Vm extends vr{_parse(e){if(typeof e.data!="string"){const r=this._getOrReturnCtx(e),l=this._def.values;return on(r,{expected:Sr.joinValues(l),received:r.parsedType,code:Gt.invalid_type}),qn}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const r=this._getOrReturnCtx(e),l=this._def.values;return on(r,{received:r.data,code:Gt.invalid_enum_value,options:l}),qn}return al(e.data)}get options(){return this._def.values}get enum(){const e={};for(const r of this._def.values)e[r]=r;return e}get Values(){const e={};for(const r of this._def.values)e[r]=r;return e}get Enum(){const e={};for(const r of this._def.values)e[r]=r;return e}extract(e,r=this._def){return Vm.create(e,{...this._def,...r})}exclude(e,r=this._def){return Vm.create(this.options.filter(l=>!e.includes(l)),{...this._def,...r})}}Vm.create=I4;class jI extends vr{_parse(e){const r=Sr.getValidEnumValues(this._def.values),l=this._getOrReturnCtx(e);if(l.parsedType!==xn.string&&l.parsedType!==xn.number){const u=Sr.objectValues(r);return on(l,{expected:Sr.joinValues(u),received:l.parsedType,code:Gt.invalid_type}),qn}if(this._cache||(this._cache=new Set(Sr.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const u=Sr.objectValues(r);return on(l,{received:l.data,code:Gt.invalid_enum_value,options:u}),qn}return al(e.data)}get enum(){return this._def.values}}jI.create=(t,e)=>new jI({values:t,typeName:Zn.ZodNativeEnum,...dr(e)});class gv extends vr{unwrap(){return this._def.type}_parse(e){const{ctx:r}=this._processInputParams(e);if(r.parsedType!==xn.promise&&r.common.async===!1)return on(r,{code:Gt.invalid_type,expected:xn.promise,received:r.parsedType}),qn;const l=r.parsedType===xn.promise?r.data:Promise.resolve(r.data);return al(l.then(u=>this._def.type.parseAsync(u,{path:r.path,errorMap:r.common.contextualErrorMap})))}}gv.create=(t,e)=>new gv({type:t,typeName:Zn.ZodPromise,...dr(e)});class Um extends vr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Zn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:r,ctx:l}=this._processInputParams(e),u=this._def.effect||null,m={addIssue:v=>{on(l,v),v.fatal?r.abort():r.dirty()},get path(){return l.path}};if(m.addIssue=m.addIssue.bind(m),u.type==="preprocess"){const v=u.transform(l.data,m);if(l.common.async)return Promise.resolve(v).then(async b=>{if(r.value==="aborted")return qn;const a=await this._def.schema._parseAsync({data:b,path:l.path,parent:l});return a.status==="aborted"?qn:a.status==="dirty"||r.value==="dirty"?cy(a.value):a});{if(r.value==="aborted")return qn;const b=this._def.schema._parseSync({data:v,path:l.path,parent:l});return b.status==="aborted"?qn:b.status==="dirty"||r.value==="dirty"?cy(b.value):b}}if(u.type==="refinement"){const v=b=>{const a=u.refinement(b,m);if(l.common.async)return Promise.resolve(a);if(a instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return b};if(l.common.async===!1){const b=this._def.schema._parseSync({data:l.data,path:l.path,parent:l});return b.status==="aborted"?qn:(b.status==="dirty"&&r.dirty(),v(b.value),{status:r.value,value:b.value})}else return this._def.schema._parseAsync({data:l.data,path:l.path,parent:l}).then(b=>b.status==="aborted"?qn:(b.status==="dirty"&&r.dirty(),v(b.value).then(()=>({status:r.value,value:b.value}))))}if(u.type==="transform")if(l.common.async===!1){const v=this._def.schema._parseSync({data:l.data,path:l.path,parent:l});if(!Fm(v))return qn;const b=u.transform(v.value,m);if(b instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:r.value,value:b}}else return this._def.schema._parseAsync({data:l.data,path:l.path,parent:l}).then(v=>Fm(v)?Promise.resolve(u.transform(v.value,m)).then(b=>({status:r.value,value:b})):qn);Sr.assertNever(u)}}Um.create=(t,e,r)=>new Um({schema:t,typeName:Zn.ZodEffects,effect:e,...dr(r)});Um.createWithPreprocess=(t,e,r)=>new Um({schema:e,effect:{type:"preprocess",transform:t},typeName:Zn.ZodEffects,...dr(r)});class dh extends vr{_parse(e){return this._getType(e)===xn.undefined?al(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}dh.create=(t,e)=>new dh({innerType:t,typeName:Zn.ZodOptional,...dr(e)});class $m extends vr{_parse(e){return this._getType(e)===xn.null?al(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}$m.create=(t,e)=>new $m({innerType:t,typeName:Zn.ZodNullable,...dr(e)});class mb extends vr{_parse(e){const{ctx:r}=this._processInputParams(e);let l=r.data;return r.parsedType===xn.undefined&&(l=this._def.defaultValue()),this._def.innerType._parse({data:l,path:r.path,parent:r})}removeDefault(){return this._def.innerType}}mb.create=(t,e)=>new mb({innerType:t,typeName:Zn.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...dr(e)});class gb extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l={...r,common:{...r.common,issues:[]}},u=this._def.innerType._parse({data:l.data,path:l.path,parent:{...l}});return hv(u)?u.then(m=>({status:"valid",value:m.status==="valid"?m.value:this._def.catchValue({get error(){return new Qu(l.common.issues)},input:l.data})})):{status:"valid",value:u.status==="valid"?u.value:this._def.catchValue({get error(){return new Qu(l.common.issues)},input:l.data})}}removeCatch(){return this._def.innerType}}gb.create=(t,e)=>new gb({innerType:t,typeName:Zn.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...dr(e)});class OI extends vr{_parse(e){if(this._getType(e)!==xn.nan){const l=this._getOrReturnCtx(e);return on(l,{code:Gt.invalid_type,expected:xn.nan,received:l.parsedType}),qn}return{status:"valid",value:e.data}}}OI.create=t=>new OI({typeName:Zn.ZodNaN,...dr(t)});class VK extends vr{_parse(e){const{ctx:r}=this._processInputParams(e),l=r.data;return this._def.type._parse({data:l,path:r.path,parent:r})}unwrap(){return this._def.type}}class lS extends vr{_parse(e){const{status:r,ctx:l}=this._processInputParams(e);if(l.common.async)return(async()=>{const m=await this._def.in._parseAsync({data:l.data,path:l.path,parent:l});return m.status==="aborted"?qn:m.status==="dirty"?(r.dirty(),cy(m.value)):this._def.out._parseAsync({data:m.value,path:l.path,parent:l})})();{const u=this._def.in._parseSync({data:l.data,path:l.path,parent:l});return u.status==="aborted"?qn:u.status==="dirty"?(r.dirty(),{status:"dirty",value:u.value}):this._def.out._parseSync({data:u.value,path:l.path,parent:l})}}static create(e,r){return new lS({in:e,out:r,typeName:Zn.ZodPipeline})}}class yb extends vr{_parse(e){const r=this._def.innerType._parse(e),l=u=>(Fm(u)&&(u.value=Object.freeze(u.value)),u);return hv(r)?r.then(u=>l(u)):l(r)}unwrap(){return this._def.innerType}}yb.create=(t,e)=>new yb({innerType:t,typeName:Zn.ZodReadonly,...dr(e)});var Zn;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(Zn||(Zn={}));const M4=sh.create;_h.create;Zc.create;pv.create;mv.create;tp.create;Vm.create;gv.create;dh.create;$m.create;const UK=M4().email("Email khng hp l"),$K=M4().min(6,"Mt khu phi c t nht 6 k t"),GK=({isOpen:t,onClose:e})=>{const[r,l]=P.useState("login"),[u,m]=P.useState(""),[v,b]=P.useState(""),[a,k]=P.useState(""),[M,L]=P.useState(!1),{signIn:z,signUp:O}=Oo(),{language:K}=ra(),H=ip(),Z=async ie=>{ie.preventDefault(),k("");const pe=UK.safeParse(u);if(!pe.success){k(pe.error.errors[0].message);return}const we=$K.safeParse(v);if(!we.success){k(we.error.errors[0].message);return}L(!0);try{let ke;if(r==="login"?ke=await z(u,v):ke=await O(u,v),console.log("Kt qu Auth:",ke),ke&&ke.error){const ze=ke.error.message||JSON.stringify(ke.error);ze.includes("Invalid login credentials")||ze.includes("auth/invalid-credential")?k(K==="vi"?"Sai email hoc mt khu":"Invalid email or password"):ze.includes("User already registered")||ze.includes("auth/email-already-in-use")?k(K==="vi"?"Email ny  c ng k":"Email already registered"):k(ze)}else console.log("ng nhp/ng k thnh cng!"),e(),m(""),b(""),k(""),u==="admin@gmail.com"&&H("/admin")}catch(ke){console.error("Li Exception:",ke);let ze="C li xy ra, vui lng th li.";ke.code==="auth/invalid-credential"&&(ze="Sai email hoc mt khu."),ke.code==="auth/email-already-in-use"&&(ze="Email ny  c s dng."),k(ze)}finally{L(!1)}},ee={vi:{login:"ng nhp",signup:"ng k",email:"Email",password:"Mt khu",noAccount:"Cha c ti khon?",hasAccount:" c ti khon?",signupNow:"ng k ngay",loginNow:"ng nhp",welcome:"Cho mng bn",createAccount:"To ti khon",saveFavorites:"Lu a im yu thch trn mi thit b"},en:{login:"Login",signup:"Sign up",email:"Email",password:"Password",noAccount:"Don't have an account?",hasAccount:"Already have an account?",signupNow:"Sign up now",loginNow:"Login",welcome:"Welcome back",createAccount:"Create account",saveFavorites:"Save favorite locations across all devices"}}[K];return t?x.jsx(Ta,{children:x.jsx(yr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/60 backdrop-blur-sm p-4",onClick:e,children:x.jsxs(yr.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"w-full max-w-md bg-background rounded-3xl shadow-2xl overflow-hidden",onClick:ie=>ie.stopPropagation(),children:[x.jsxs("div",{className:"relative p-6 pb-4 bg-gradient-to-br from-primary to-primary/80",children:[x.jsx("button",{onClick:e,className:"absolute top-4 right-4 w-8 h-8 flex items-center justify-center rounded-full bg-white/20 hover:bg-white/30 transition-colors",children:x.jsx(ti,{className:"w-4 h-4 text-white"})}),x.jsx("div",{className:"flex items-center gap-3 mb-2",children:x.jsx("div",{className:"w-12 h-12 rounded-2xl bg-white/20 flex items-center justify-center",children:x.jsx(Cy,{className:"w-6 h-6 text-white"})})}),x.jsx("h2",{className:"text-2xl font-bold text-white",children:r==="login"?ee.welcome:ee.createAccount}),x.jsx("p",{className:"text-white/80 text-sm mt-1",children:ee.saveFavorites})]}),x.jsxs("form",{onSubmit:Z,className:"p-6 space-y-4",children:[x.jsxs("div",{className:"space-y-3",children:[x.jsxs("div",{className:"relative",children:[x.jsx(TM,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),x.jsx(di,{type:"email",placeholder:ee.email,value:u,onChange:ie=>m(ie.target.value),className:"pl-12 h-14 rounded-2xl border-2 text-base",required:!0})]}),x.jsxs("div",{className:"relative",children:[x.jsx(Ey,{className:"absolute left-4 top-1/2 -translate-y-1/2 w-5 h-5 text-muted-foreground"}),x.jsx(di,{type:"password",placeholder:ee.password,value:v,onChange:ie=>b(ie.target.value),className:"pl-12 h-14 rounded-2xl border-2 text-base",required:!0})]})]}),a&&x.jsx(yr.p,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-destructive text-sm text-center",children:a}),x.jsx(_n,{type:"submit",disabled:M,className:"w-full h-14 text-base font-semibold rounded-2xl",children:M?x.jsx(Fi,{className:"w-5 h-5 animate-spin"}):r==="login"?ee.login:ee.signup}),x.jsxs("p",{className:"text-center text-sm text-muted-foreground",children:[r==="login"?ee.noAccount:ee.hasAccount," ",x.jsx("button",{type:"button",onClick:()=>{l(r==="login"?"signup":"login"),k("")},className:"text-primary font-semibold hover:underline",children:r==="login"?ee.signupNow:ee.loginNow})]})]})]})})}):null},wx="https://thodia-backend-1067502227654.asia-southeast1.run.app",HK=({isOpen:t,onClose:e,onSelectLocation:r,onNavigate:l,onLoginClick:u})=>{const{user:m}=Oo(),[v,b]=P.useState([]),[a,k]=P.useState([]),[M,L]=P.useState(!0),z=async()=>{if(m){L(!0);try{const ee=await(await fetch(`${wx}/api/favorites?userId=${m.uid}`)).json();if(Array.isArray(ee)){const we=ee.map(ke=>({id:ke.location_id,name:ke.location_name_en||ke.location_name,nameVi:ke.location_name,lat:ke.location_lat,lng:ke.location_lng,type:ke.location_type||"checkin",address:"a im  lu",description:"",image:""}));b(we)}const pe=await(await fetch(`${wx}/api/user-vouchers?userId=${m.uid}`)).json();if(Array.isArray(pe)){const we=pe.map(ke=>({id:ke.saved_id,voucher:{id:ke.id,code:ke.code,title_vi:ke.title_vi,discount_value:ke.discount_value,discount_type:ke.discount_type,store:{id:ke.store_id,name_vi:ke.store_name,lat:ke.lat,lng:ke.lng,address_vi:ke.address_vi,image_url:ke.image_url}}}));k(we)}}catch(Y){console.error(" Li ti d liu:",Y),Ht.error("Khng th ti danh sch yu thch")}finally{L(!1)}}};P.useEffect(()=>{t&&z()},[m,t]);const O=async(Y,ee)=>{Y.stopPropagation(),b(ie=>ie.filter(pe=>pe.id!==ee));try{await fetch(`${wx}/api/favorites/${ee}`,{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:m?.uid})}),Ht.success(" xa khi yu thch")}catch{Ht.error("Li khi xa, vui lng th li"),z()}},K=async(Y,ee)=>{Y.stopPropagation();const ie=[...a];k(pe=>pe.filter(we=>we.id!==ee));try{if(!(await fetch(`${wx}/api/user-vouchers/${ee}`,{method:"DELETE"})).ok)throw new Error("Failed");Ht.success(" xa voucher")}catch{k(ie),Ht.error("Khng xa c voucher")}},H=Y=>{l?l(Y):r&&r(Y),e()},Z=Y=>{const ee=Y.voucher.store,ie={id:ee.id,nameVi:ee.name_vi,name:ee.name_vi,lat:ee.lat,lng:ee.lng,type:"food",address:ee.address_vi,description:`u i: Gim ${Y.voucher.discount_value}${Y.voucher.discount_type==="percent"?"%":"k"} - Code: ${Y.voucher.code}`,image:ee.image_url||"https://placehold.co/600x400?text=Store"};H(ie),Ht.info(`ang dn ng n: ${ee.name_vi}`)};return t?x.jsxs("div",{className:"fixed inset-y-0 left-0 z-[60] w-full md:w-[400px] bg-white shadow-2xl transform transition-transform duration-300 ease-in-out flex flex-col border-r",children:[x.jsxs("div",{className:"flex items-center justify-between p-4 border-b bg-gray-50/80 backdrop-blur-sm sticky top-0 z-10",children:[x.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2 text-gray-800",children:[x.jsx(Ff,{className:"w-5 h-5 text-red-500 fill-red-500"}),"Kho lu tr"]}),x.jsx(_n,{variant:"ghost",size:"icon",onClick:e,className:"rounded-full hover:bg-gray-200",children:x.jsx(ti,{className:"w-5 h-5"})})]}),x.jsx("div",{className:"flex-1 overflow-hidden bg-white",children:m?x.jsxs(uv,{defaultValue:"locations",className:"w-full h-full flex flex-col",children:[x.jsx("div",{className:"px-4 pt-4 pb-2",children:x.jsxs(Vy,{className:"grid w-full grid-cols-2 bg-gray-100/80 p-1 rounded-xl",children:[x.jsx(qs,{value:"locations",className:"rounded-lg text-sm font-medium data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"a im"}),x.jsxs(qs,{value:"vouchers",className:"rounded-lg text-sm font-medium data-[state=active]:bg-white data-[state=active]:shadow-sm",children:["Voucher ",x.jsx("span",{className:"ml-1.5 text-xs bg-primary/10 text-primary px-1.5 py-0.5 rounded-full",children:a.length})]})]})}),x.jsx(Sa,{value:"locations",className:"flex-1 overflow-y-auto px-4 pb-4 pt-2 space-y-3",children:M?x.jsx("div",{className:"flex justify-center py-8",children:x.jsx(Fi,{className:"w-6 h-6 animate-spin text-primary"})}):v.length===0?x.jsxs("div",{className:"text-center py-10 space-y-3",children:[x.jsx(Vi,{className:"w-10 h-10 text-gray-200 mx-auto"}),x.jsx("p",{className:"text-gray-400 text-sm",children:"Bn cha lu a im no."})]}):v.map(Y=>x.jsxs("div",{className:"flex items-center gap-3 p-3 bg-white border border-gray-100 rounded-xl hover:border-primary/50 hover:shadow-md cursor-pointer transition-all group",onClick:()=>H(Y),children:[x.jsx("div",{className:"bg-red-50 p-2.5 rounded-full text-red-500 flex-shrink-0 group-hover:scale-105 transition-transform",children:x.jsx(Ff,{className:"w-5 h-5 fill-current"})}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("h4",{className:"font-bold text-sm truncate text-gray-900",children:Y.nameVi}),x.jsx("p",{className:"text-xs text-gray-500 truncate",children:Y.address||"a im trn bn "})]}),x.jsx(_n,{variant:"ghost",size:"icon",className:"h-8 w-8 text-gray-300 hover:text-red-600 hover:bg-red-50 rounded-full",onClick:ee=>O(ee,Y.id),children:x.jsx(ah,{className:"w-4 h-4"})})]},Y.id))}),x.jsx(Sa,{value:"vouchers",className:"flex-1 overflow-y-auto px-4 pb-4 pt-2 space-y-3",children:M?x.jsx("div",{className:"flex justify-center py-8",children:x.jsx(Fi,{className:"w-6 h-6 animate-spin text-primary"})}):a.length===0?x.jsxs("div",{className:"text-center py-10 space-y-3",children:[x.jsx(Yy,{className:"w-10 h-10 text-gray-200 mx-auto"}),x.jsx("p",{className:"text-gray-400 text-sm",children:"V voucher trng."})]}):a.map(Y=>x.jsxs("div",{className:"relative bg-white border border-dashed border-primary/30 rounded-xl overflow-hidden shadow-sm hover:shadow-md hover:border-primary transition-all group cursor-pointer",onClick:()=>Z(Y),children:[x.jsxs("div",{className:"flex items-stretch h-24",children:[x.jsxs("div",{className:"bg-primary/5 w-24 flex flex-col items-center justify-center p-2 border-r border-dashed border-primary/30 shrink-0",children:[x.jsxs("span",{className:"text-2xl font-black text-primary leading-none",children:[Y.voucher.discount_value,x.jsx("span",{className:"text-sm font-bold",children:Y.voucher.discount_type==="percent"?"%":"k"})]}),x.jsx("span",{className:"text-[10px] text-primary/70 font-bold uppercase mt-1 text-center",children:"Gim gi"})]}),x.jsxs("div",{className:"flex-1 p-3 min-w-0 flex flex-col justify-between",children:[x.jsxs("div",{children:[x.jsx("h4",{className:"font-bold text-sm truncate text-gray-900",title:Y.voucher.store.name_vi,children:Y.voucher.store.name_vi}),x.jsx("p",{className:"text-[10px] text-gray-500 line-clamp-1 mt-0.5",children:Y.voucher.title_vi})]}),x.jsxs("div",{className:"flex items-center justify-between mt-2",children:[x.jsx("code",{className:"bg-gray-50 border px-1.5 py-0.5 rounded text-[11px] font-mono font-bold text-gray-600",children:Y.voucher.code}),x.jsxs("span",{className:"text-xs text-primary font-bold flex items-center group-hover:underline",children:["Dng ngay ",x.jsx(bO,{className:"w-3 h-3 ml-1"})]})]})]})]}),x.jsx("button",{onClick:ee=>K(ee,Y.id),className:"absolute top-1 right-1 p-1.5 text-gray-400/50 hover:text-red-500 hover:bg-red-50 rounded-full transition-all z-10",title:"Xa voucher",children:x.jsx(ah,{className:"w-3.5 h-3.5"})})]},Y.id))})]}):x.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-center space-y-4 p-6",children:[x.jsx("div",{className:"w-16 h-16 bg-gray-100 rounded-full flex items-center justify-center",children:x.jsx(Ff,{className:"w-8 h-8 text-gray-400"})}),x.jsxs("div",{children:[x.jsx("h3",{className:"font-bold text-gray-900",children:"Cha ng nhp"}),x.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"ng nhp  ng b a im v voucher ca bn."})]}),x.jsx(_n,{onClick:u,className:"rounded-xl font-bold",children:"ng nhp ngay"})]})})]}):null},Bc="https://thodia-backend-1067502227654.asia-southeast1.run.app",cS=()=>{const{user:t}=Oo(),e=Dv(),{data:r=[],isLoading:l,refetch:u}=Xb({queryKey:["user_stores",t?.uid],queryFn:async()=>{if(!t)return[];try{const ee=await(await fetch(`${Bc}/api/user-stores?userId=${t.uid}`)).json();return Array.isArray(ee)?ee:[]}catch(Y){return console.error(Y),[]}},enabled:!!t}),m=Bl({mutationFn:async Y=>null,onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Ht.success(" gi yu cu to ca hng!")}}),v=Bl({mutationFn:async({id:Y,data:ee})=>null,onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Ht.success(" cp nht ca hng!")}}),b=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/stores/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>{e.invalidateQueries({queryKey:["user_stores"]}),Ht.success(" xa ca hng!")},onError:Y=>Ht.error("Li xa: "+Y.message)}),a=async Y=>{try{const ie=await(await fetch(`${Bc}/api/stores/${Y}/menu`)).json();return Array.isArray(ie)?ie:[]}catch{return[]}},k=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/menu-items`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" thm mn mi"),onError:Y=>Ht.error("Li thm mn: "+Y.message)}),M=Bl({mutationFn:async({id:Y,data:ee})=>{if(!(await fetch(`${Bc}/api/menu-items/${Y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" cp nht mn"),onError:Y=>Ht.error("Li cp nht: "+Y.message)}),L=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/menu-items/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" xa mn n")}),z=async Y=>{try{const ie=await(await fetch(`${Bc}/api/stores/${Y}/vouchers-all`)).json();return Array.isArray(ie)?ie:[]}catch{return[]}},O=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/vouchers/active`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(Y)})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" to voucher"),onError:Y=>Ht.error("Li to voucher: "+Y.message)}),K=Bl({mutationFn:async({id:Y,data:ee})=>{if(!(await fetch(`${Bc}/api/vouchers/${Y}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" cp nht voucher"),onError:Y=>Ht.error("Li cp nht: "+Y.message)}),H=Bl({mutationFn:async Y=>{if(!(await fetch(`${Bc}/api/vouchers/${Y}`,{method:"DELETE"})).ok)throw new Error("Failed")},onSuccess:()=>Ht.success(" xa voucher")}),Z=async(Y,ee="common")=>URL.createObjectURL(Y);return{stores:r,isLoading:l,fetchStores:u,createStore:m.mutateAsync,updateStore:async(Y,ee)=>await v.mutateAsync({id:Y,data:ee}),deleteStore:b.mutateAsync,fetchMenuItems:a,createMenuItem:k.mutateAsync,updateMenuItem:async(Y,ee)=>await M.mutateAsync({id:Y,data:ee}),deleteMenuItem:L.mutateAsync,fetchVouchers:z,createVoucher:O.mutateAsync,updateVoucher:async(Y,ee)=>await K.mutateAsync({id:Y,data:ee}),deleteVoucher:H.mutateAsync,uploadImage:Z}};var p0="Switch",[WK]=sl(p0),[qK,ZK]=WK(p0),P4=P.forwardRef((t,e)=>{const{__scopeSwitch:r,name:l,checked:u,defaultChecked:m,required:v,disabled:b,value:a="on",onCheckedChange:k,form:M,...L}=t,[z,O]=P.useState(null),K=ir(e,ie=>O(ie)),H=P.useRef(!1),Z=z?M||!!z.closest("form"):!0,[Y,ee]=hh({prop:u,defaultProp:m??!1,onChange:k,caller:p0});return x.jsxs(qK,{scope:r,checked:Y,disabled:b,children:[x.jsx(Mn.button,{type:"button",role:"switch","aria-checked":Y,"aria-required":v,"data-state":L4(Y),"data-disabled":b?"":void 0,disabled:b,value:a,...L,ref:K,onClick:Xt(t.onClick,ie=>{ee(pe=>!pe),Z&&(H.current=ie.isPropagationStopped(),H.current||ie.stopPropagation())})}),Z&&x.jsx(D4,{control:z,bubbles:!H.current,name:l,value:a,checked:Y,required:v,disabled:b,form:M,style:{transform:"translateX(-100%)"}})]})});P4.displayName=p0;var R4="SwitchThumb",N4=P.forwardRef((t,e)=>{const{__scopeSwitch:r,...l}=t,u=ZK(R4,r);return x.jsx(Mn.span,{"data-state":L4(u.checked),"data-disabled":u.disabled?"":void 0,...l,ref:e})});N4.displayName=R4;var XK="SwitchBubbleInput",D4=P.forwardRef(({__scopeSwitch:t,control:e,checked:r,bubbles:l=!0,...u},m)=>{const v=P.useRef(null),b=ir(v,m),a=FD(r),k=KM(e);return P.useEffect(()=>{const M=v.current;if(!M)return;const L=window.HTMLInputElement.prototype,O=Object.getOwnPropertyDescriptor(L,"checked").set;if(a!==r&&O){const K=new Event("click",{bubbles:l});O.call(M,r),M.dispatchEvent(K)}},[a,r,l]),x.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:r,...u,tabIndex:-1,ref:b,style:{...u.style,...k,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});D4.displayName=XK;function L4(t){return t?"checked":"unchecked"}var j4=P4,KK=N4;const uS=P.forwardRef(({className:t,...e},r)=>x.jsx(j4,{className:ln("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50",t),...e,ref:r,children:x.jsx(KK,{className:ln("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})}));uS.displayName=j4.displayName;const YK=({storeId:t,item:e,onClose:r,onSuccess:l})=>{const{language:u}=ra(),{createMenuItem:m,updateMenuItem:v,uploadImage:b}=cS(),a=P.useRef(null),[k,M]=P.useState(!1),[L,z]=P.useState(e?.image_url||null),[O,K]=P.useState(null),[H,Z]=P.useState({name_vi:e?.name_vi||"",name_en:e?.name_en||"",description_vi:e?.description_vi||"",description_en:e?.description_en||"",price:e?.price||0,is_available:e?.is_available??!0,sort_order:e?.sort_order||0}),Y=ie=>{const pe=ie.target.files?.[0];if(pe){K(pe);const we=new FileReader;we.onloadend=()=>{z(we.result)},we.readAsDataURL(pe)}},ee=async ie=>{ie.preventDefault(),M(!0);try{let pe=e?.image_url||null;if(O){const ke=await b(O,"menu");ke&&(pe=ke)}const we={store_id:t,...H,image_url:pe};e?await v(e.id,we):await m(we),l(),r()}catch(pe){console.error("Error saving menu item:",pe)}finally{M(!1)}};return x.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"bg-muted/50 rounded-xl p-4 mb-4",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsx("h4",{className:"font-semibold",children:e?u==="vi"?"Chnh sa mn":"Edit Item":u==="vi"?"Thm mn mi":"Add New Item"}),x.jsx("button",{onClick:r,className:"p-1 hover:bg-muted rounded-full",children:x.jsx(ti,{className:"w-4 h-4"})})]}),x.jsxs("form",{onSubmit:ee,className:"space-y-3",children:[x.jsx("div",{onClick:()=>a.current?.click(),className:"border-2 border-dashed rounded-lg p-3 text-center cursor-pointer hover:border-primary transition-colors",children:L?x.jsx("img",{src:L,alt:"Preview",className:"w-20 h-20 object-cover rounded-lg mx-auto"}):x.jsxs("div",{className:"py-2 text-muted-foreground",children:[x.jsx(wM,{className:"w-8 h-8 mx-auto mb-1 opacity-50"}),x.jsx("p",{className:"text-xs",children:u==="vi"?"Thm nh":"Add image"})]})}),x.jsx("input",{ref:a,type:"file",accept:"image/*",onChange:Y,className:"hidden"}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Tn mn (VI) *"}),x.jsx(di,{value:H.name_vi,onChange:ie=>Z(pe=>({...pe,name_vi:ie.target.value})),placeholder:"Tn mn",required:!0,className:"h-9"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Name (EN)"}),x.jsx(di,{value:H.name_en,onChange:ie=>Z(pe=>({...pe,name_en:ie.target.value})),placeholder:"Item name",className:"h-9"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"M t (VI)"}),x.jsx(gh,{value:H.description_vi,onChange:ie=>Z(pe=>({...pe,description_vi:ie.target.value})),placeholder:"M t",rows:2,className:"text-sm"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Description (EN)"}),x.jsx(gh,{value:H.description_en,onChange:ie=>Z(pe=>({...pe,description_en:ie.target.value})),placeholder:"Description",rows:2,className:"text-sm"})]})]}),x.jsxs("div",{className:"flex gap-3 items-end",children:[x.jsxs("div",{className:"flex-1",children:[x.jsxs(ui,{className:"text-xs flex items-center gap-1",children:[x.jsx(wO,{className:"w-3 h-3"})," ",u==="vi"?"Gi (VN)":"Price (VND)"]}),x.jsx(di,{type:"number",value:H.price,onChange:ie=>Z(pe=>({...pe,price:parseInt(ie.target.value)||0})),className:"h-9"})]}),x.jsxs("div",{className:"flex items-center gap-2 pb-2",children:[x.jsx(uS,{checked:H.is_available,onCheckedChange:ie=>Z(pe=>({...pe,is_available:ie}))}),x.jsx(ui,{className:"text-xs",children:u==="vi"?"Cn hng":"Available"})]})]}),x.jsxs("div",{className:"flex gap-2 pt-2",children:[x.jsx(_n,{type:"button",variant:"ghost",onClick:r,size:"sm",className:"flex-1",children:u==="vi"?"Hy":"Cancel"}),x.jsx(_n,{type:"submit",disabled:k,size:"sm",className:"flex-1",children:k?"...":e?u==="vi"?"Cp nht":"Update":u==="vi"?"Thm":"Add"})]})]})]})},JK=({storeId:t,voucher:e,onClose:r,onSuccess:l})=>{const{language:u}=ra(),{createVoucher:m,updateVoucher:v}=cS(),[b,a]=P.useState(!1),[k,M]=P.useState({code:e?.code||"",title_vi:e?.title_vi||"",title_en:e?.title_en||"",description_vi:e?.description_vi||"",description_en:e?.description_en||"",discount_type:e?.discount_type||"percent",discount_value:e?.discount_value||10,min_order:e?.min_order||0,max_uses:e?.max_uses||null,is_active:e?.is_active??!0,start_date:e?.start_date?new Date(e.start_date).toISOString().split("T")[0]:"",end_date:e?.end_date?new Date(e.end_date).toISOString().split("T")[0]:""}),L=async z=>{z.preventDefault(),a(!0);try{const O={store_id:t,code:k.code.toUpperCase(),title_vi:k.title_vi,title_en:k.title_en||null,description_vi:k.description_vi||null,description_en:k.description_en||null,discount_type:k.discount_type,discount_value:k.discount_value,min_order:k.min_order||null,max_uses:k.max_uses||null,is_active:k.is_active,start_date:k.start_date?new Date(k.start_date).toISOString():null,end_date:k.end_date?new Date(k.end_date).toISOString():null};e?await v(e.id,O):await m(O),l(),r()}catch(O){console.error("Error saving voucher:",O)}finally{a(!1)}};return x.jsxs(yr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"bg-muted/50 rounded-xl p-4 mb-4",children:[x.jsxs("div",{className:"flex items-center justify-between mb-4",children:[x.jsxs("h4",{className:"font-semibold flex items-center gap-2",children:[x.jsx(EM,{className:"w-4 h-4 text-accent"}),e?u==="vi"?"Chnh sa voucher":"Edit Voucher":u==="vi"?"To voucher mi":"Create New Voucher"]}),x.jsx("button",{onClick:r,className:"p-1 hover:bg-muted rounded-full",children:x.jsx(ti,{className:"w-4 h-4"})})]}),x.jsxs("form",{onSubmit:L,className:"space-y-3",children:[x.jsxs("div",{children:[x.jsxs(ui,{className:"text-xs",children:[u==="vi"?"M voucher":"Voucher Code"," *"]}),x.jsx(di,{value:k.code,onChange:z=>M(O=>({...O,code:z.target.value.toUpperCase()})),placeholder:"GIAM20",required:!0,className:"h-9 uppercase"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Tiu  (VI) *"}),x.jsx(di,{value:k.title_vi,onChange:z=>M(O=>({...O,title_vi:z.target.value})),placeholder:"Gim 20%",required:!0,className:"h-9"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Title (EN)"}),x.jsx(di,{value:k.title_en,onChange:z=>M(O=>({...O,title_en:z.target.value})),placeholder:"20% off",className:"h-9"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"M t (VI)"}),x.jsx(gh,{value:k.description_vi,onChange:z=>M(O=>({...O,description_vi:z.target.value})),placeholder:"p dng cho n t 50k",rows:2,className:"text-sm"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:"Description (EN)"}),x.jsx(gh,{value:k.description_en,onChange:z=>M(O=>({...O,description_en:z.target.value})),placeholder:"Valid for orders over 50k",rows:2,className:"text-sm"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:u==="vi"?"Loi gim gi":"Discount Type"}),x.jsxs(b4,{value:k.discount_type,onValueChange:z=>M(O=>({...O,discount_type:z})),children:[x.jsx(sS,{className:"h-9",children:x.jsx(T4,{})}),x.jsxs(oS,{children:[x.jsx(Qa,{value:"percent",children:x.jsxs("span",{className:"flex items-center gap-1",children:[x.jsx(RO,{className:"w-3 h-3"})," ",u==="vi"?"Phn trm":"Percentage"]})}),x.jsx(Qa,{value:"fixed",children:u==="vi"?"C nh (VN)":"Fixed (VND)"})]})]})]}),x.jsxs("div",{children:[x.jsxs(ui,{className:"text-xs",children:[u==="vi"?"Gi tr":"Value"," ",k.discount_type==="percent"?"(%)":"(VN)"]}),x.jsx(di,{type:"number",value:k.discount_value,onChange:z=>M(O=>({...O,discount_value:parseInt(z.target.value)||0})),className:"h-9"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:u==="vi"?"n ti thiu (VN)":"Min Order (VND)"}),x.jsx(di,{type:"number",value:k.min_order,onChange:z=>M(O=>({...O,min_order:parseInt(z.target.value)||0})),className:"h-9"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:u==="vi"?"S ln s dng ti a":"Max Uses"}),x.jsx(di,{type:"number",value:k.max_uses||"",onChange:z=>M(O=>({...O,max_uses:z.target.value?parseInt(z.target.value):null})),placeholder:u==="vi"?"Khng gii hn":"Unlimited",className:"h-9"})]})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:u==="vi"?"Ngy bt u":"Start Date"}),x.jsx(di,{type:"date",value:k.start_date,onChange:z=>M(O=>({...O,start_date:z.target.value})),className:"h-9"})]}),x.jsxs("div",{children:[x.jsx(ui,{className:"text-xs",children:u==="vi"?"Ngy kt thc":"End Date"}),x.jsx(di,{type:"date",value:k.end_date,onChange:z=>M(O=>({...O,end_date:z.target.value})),className:"h-9"})]})]}),x.jsxs("div",{className:"flex items-center gap-2",children:[x.jsx(uS,{checked:k.is_active,onCheckedChange:z=>M(O=>({...O,is_active:z}))}),x.jsx(ui,{className:"text-sm",children:u==="vi"?"Kch hot voucher":"Activate voucher"})]}),x.jsxs("div",{className:"flex gap-2 pt-2",children:[x.jsx(_n,{type:"button",variant:"ghost",onClick:r,size:"sm",className:"flex-1",children:u==="vi"?"Hy":"Cancel"}),x.jsx(_n,{type:"submit",disabled:b,size:"sm",className:"flex-1",children:b?"...":e?u==="vi"?"Cp nht":"Update":u==="vi"?"To":"Create"})]})]})]})},fm="https://thodia-backend-1067502227654.asia-southeast1.run.app",QK={pending:"bg-yellow-500/20 text-yellow-600",approved:"bg-green-500/20 text-green-600",rejected:"bg-red-500/20 text-red-600"},eY={pending:{vi:"Ch duyt",en:"Pending"},approved:{vi:" duyt",en:"Approved"},rejected:{vi:"T chi",en:"Rejected"}},tY=({isOpen:t,onClose:e,onLoginClick:r})=>{const{language:l}=ra(),{user:u}=Oo(),{stores:m,isLoading:v,fetchStores:b}=cS(),[a,k]=P.useState(!1),[M,L]=P.useState(null),[z,O]=P.useState(null),[K,H]=P.useState("menu"),[Z,Y]=P.useState([]),[ee,ie]=P.useState([]),[pe,we]=P.useState(!1),[ke,ze]=P.useState(!1),[Ge,tt]=P.useState(null),[Pe,ot]=P.useState(null),[ut,gt]=P.useState(!1);P.useEffect(()=>{z&&ht(z)},[z]);const ht=async he=>{try{const[Fe,it]=await Promise.all([fetch(`${fm}/api/stores/${he}/menu`),fetch(`${fm}/api/store-vouchers/${he}`)]),vt=await Fe.json(),Wt=await it.json();Y(Array.isArray(vt)?vt:[]),ie(Array.isArray(Wt)?Wt:[])}catch(Fe){console.error(Fe)}},Lt=async()=>{try{await b()}catch(he){console.error(he)}k(!1),L(null)},mt=async he=>{if(confirm(l==="vi"?"Bn c chc mun xa ca hng ny?":"Are you sure?"))try{await fetch(`${fm}/api/stores/${he}`,{method:"DELETE"}),b()}catch{alert("Li khi xa ca hng")}},pt=async he=>{if(confirm(l==="vi"?"Xa mn ny?":"Delete this item?"))try{await fetch(`${fm}/api/menu-items/${he}`,{method:"DELETE"}),z&&ht(z)}catch{alert("Li xa mn")}},Ae=async he=>{if(confirm(l==="vi"?"Xa voucher ny?":"Delete this voucher?"))try{await fetch(`${fm}/api/vouchers/${he}`,{method:"DELETE"}),z&&ht(z)}catch{alert("Li xa voucher")}},xe=async he=>{gt(!0);try{const Fe=await fetch(`${fm}/api/payment/create-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:u?.uid,storeId:he,type:"vip",amount:1e5,description:`Nng cp VIP Store ${he}`,returnUrl:window.location.href,cancelUrl:window.location.href})}),it=await Fe.json();if(!Fe.ok)throw new Error(it.error);if(it&&it.checkoutUrl)window.location.href=it.checkoutUrl;else throw new Error("Khng ly c link thanh ton")}catch(Fe){alert("Li: "+Fe.message)}finally{gt(!1)}},We=he=>new Intl.NumberFormat("vi-VN").format(he)+"";return t?x.jsxs(x.Fragment,{children:[x.jsx(yr.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-transparent pointer-events-none",onClick:e}),x.jsxs(yr.div,{initial:{x:"100%"},animate:{x:0},exit:{x:"100%"},transition:{type:"spring",damping:30,stiffness:300},className:"fixed right-0 top-0 bottom-0 w-full max-w-md bg-background z-50 shadow-2xl flex flex-col bg-white",children:[x.jsxs("div",{className:"flex items-center justify-between p-4 border-b",children:[x.jsxs("h2",{className:"text-lg font-semibold flex items-center gap-2",children:[x.jsx(Vc,{className:"w-5 h-5 text-primary"}),l==="vi"?"Ca hng ca ti":"My Stores"]}),x.jsx("button",{onClick:e,className:"p-2 hover:bg-gray-100 rounded-full transition-colors",children:x.jsx(ti,{className:"w-5 h-5"})})]}),x.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-gray-50/50",children:u?v?x.jsx("div",{className:"text-center py-12",children:x.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-primary border-t-transparent rounded-full mx-auto"})}):m.length===0?x.jsxs("div",{className:"text-center py-12",children:[x.jsx(Vc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),x.jsx("p",{className:"text-muted-foreground mb-4",children:l==="vi"?"Bn cha c ca hng no":"You don't have any stores yet"}),x.jsxs(_n,{onClick:()=>k(!0),children:[x.jsx(_m,{className:"w-4 h-4 mr-2"}),l==="vi"?"Thm ca hng":"Add Store"]})]}):x.jsxs("div",{className:"space-y-4",children:[m.map(he=>{const Fe=he.is_premium===!0;return x.jsxs("div",{className:"border bg-white rounded-xl overflow-hidden shadow-sm relative",children:[Fe&&x.jsxs("div",{className:"absolute top-0 right-0 bg-yellow-400 text-yellow-900 text-[10px] font-bold px-2 py-0.5 rounded-bl-lg z-10 flex items-center gap-1",children:[x.jsx(nl,{className:"w-3 h-3 fill-yellow-900"})," VIP"]}),x.jsxs("div",{className:"p-4",children:[x.jsxs("div",{className:"flex gap-3",children:[x.jsx("div",{className:"w-16 h-16 flex-shrink-0",children:he.image_url?x.jsx("img",{src:he.image_url,alt:he.name_vi,className:"w-full h-full rounded-lg object-cover border",onError:it=>{it.currentTarget.src="https://placehold.co/100x100?text=No+Img"}}):x.jsx("div",{className:"w-full h-full rounded-lg bg-gray-100 flex items-center justify-center border",children:x.jsx(Vc,{className:"w-6 h-6 text-gray-400"})})}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("div",{className:"flex items-start justify-between gap-2",children:x.jsx("h3",{className:"font-semibold truncate text-gray-900 pr-8",children:l==="en"&&he.name_en?he.name_en:he.name_vi})}),x.jsx("div",{className:"flex items-center gap-2 mt-1",children:x.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${QK[he.status]}`,children:eY[he.status]?.[l]||he.status})}),x.jsxs("div",{className:"flex items-center gap-2 text-xs text-gray-500 mt-1",children:[x.jsx(Vi,{className:"w-3 h-3 flex-shrink-0"}),x.jsx("span",{className:"truncate",children:l==="en"&&he.address_en?he.address_en:he.address_vi})]})]})]}),x.jsxs("div",{className:"flex items-center gap-2 mt-4 pt-3 border-t",children:[x.jsxs(_n,{variant:"outline",size:"sm",onClick:()=>{L(he),k(!0)},className:"flex-1 h-8 text-xs",children:[x.jsx(p1,{className:"w-3 h-3 mr-1"}),l==="vi"?"Sa":"Edit"]}),x.jsx(_n,{variant:"outline",size:"sm",onClick:()=>mt(he.id),className:"h-8 w-8 p-0 text-red-500 hover:text-red-600 hover:bg-red-50 border-red-200",children:x.jsx(ah,{className:"w-3 h-3"})}),x.jsx(_n,{variant:"ghost",size:"sm",onClick:()=>O(z===he.id?null:he.id),className:"h-8 w-8 p-0",children:z===he.id?x.jsx(Nm,{className:"w-4 h-4"}):x.jsx(Hf,{className:"w-4 h-4"})})]})]}),x.jsx(Ta,{children:z===he.id&&x.jsxs(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"border-t bg-gray-50",children:[x.jsxs("div",{className:"flex border-b bg-white",children:[x.jsxs("button",{onClick:()=>H("menu"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${K==="menu"?"border-b-2 border-primary text-primary":"text-gray-500 hover:text-gray-800"}`,children:[x.jsx(zO,{className:"w-4 h-4"}),"Menu (",Z.length,")"]}),x.jsxs("button",{onClick:()=>H("voucher"),className:`flex-1 py-3 text-sm font-medium flex items-center justify-center gap-2 transition-colors ${K==="voucher"?"border-b-2 border-primary text-primary":"text-gray-500 hover:text-gray-800"}`,children:[x.jsx(EM,{className:"w-4 h-4"}),"Voucher (",ee.length,")"]})]}),x.jsx("div",{className:"p-4",children:K==="menu"?x.jsxs(x.Fragment,{children:[x.jsx(Ta,{children:pe&&x.jsx(YK,{storeId:he.id,item:Ge,onClose:()=>{we(!1),tt(null)},onSuccess:()=>ht(he.id)})}),!pe&&(Fe?x.jsxs(_n,{variant:"outline",size:"sm",onClick:()=>we(!0),className:"w-full mb-3 bg-white border-dashed border-2 hover:border-primary hover:text-primary",children:[x.jsx(_m,{className:"w-4 h-4 mr-1"}),l==="vi"?"Thm mn mi":"Add Item"]}):x.jsxs("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[x.jsx(Ey,{className:"w-5 h-5 mx-auto text-yellow-600 mb-1"}),x.jsx("p",{className:"text-xs font-medium text-yellow-800 mb-2",children:"Tnh nng Menu ch dnh cho VIP"}),x.jsxs(_n,{size:"sm",onClick:()=>xe(he.id),disabled:ut,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full",children:[ut?x.jsx(Fi,{className:"w-3 h-3 animate-spin"}):x.jsx(nl,{className:"w-3 h-3 mr-1"}),"Nng cp ngay (100.000)"]})]})),x.jsx("div",{className:"space-y-2",children:Z.map(it=>x.jsxs("div",{className:"flex items-center gap-3 p-2 bg-white rounded-lg border shadow-sm",children:[x.jsx("img",{src:it.image_url||"https://placehold.co/100x100?text=Food",alt:it.name_vi,className:"w-12 h-12 rounded-lg object-cover bg-gray-100",onError:vt=>{vt.currentTarget.src="https://placehold.co/100x100?text=Food"}}),x.jsxs("div",{className:"flex-1 min-w-0",children:[x.jsx("p",{className:"font-medium text-sm truncate text-gray-900",children:l==="en"&&it.name_en?it.name_en:it.name_vi||it.name||"Tn mn"}),x.jsx("p",{className:"text-xs text-primary font-bold",children:We(Number(it.price))})]}),x.jsxs("div",{className:"flex gap-1",children:[x.jsx("button",{onClick:()=>{tt(it),we(!0)},className:"p-1.5 hover:bg-gray-100 rounded text-gray-600",children:x.jsx(p1,{className:"w-3 h-3"})}),x.jsx("button",{onClick:()=>pt(it.id),className:"p-1.5 hover:bg-red-50 rounded text-red-500",children:x.jsx(ah,{className:"w-3 h-3"})})]})]},it.id))})]}):x.jsxs(x.Fragment,{children:[x.jsx(Ta,{children:ke&&x.jsx(JK,{storeId:he.id,voucher:Pe,onClose:()=>{ze(!1),ot(null)},onSuccess:()=>ht(he.id)})}),!ke&&(Fe?x.jsxs(_n,{variant:"outline",size:"sm",onClick:()=>ze(!0),className:"w-full mb-3 bg-white border-dashed border-2 hover:border-primary hover:text-primary",children:[x.jsx(_m,{className:"w-4 h-4 mr-1"}),l==="vi"?"To voucher mi":"Create Voucher"]}):x.jsxs("div",{className:"mb-3 p-3 bg-yellow-50 border border-yellow-200 rounded-lg text-center",children:[x.jsx(Ey,{className:"w-5 h-5 mx-auto text-yellow-600 mb-1"}),x.jsx("p",{className:"text-xs font-medium text-yellow-800 mb-2",children:"Tnh nng Voucher ch dnh cho VIP"}),x.jsxs(_n,{size:"sm",onClick:()=>xe(he.id),disabled:ut,className:"bg-yellow-500 hover:bg-yellow-600 text-white w-full",children:[ut?x.jsx(Fi,{className:"w-3 h-3 animate-spin"}):x.jsx(nl,{className:"w-3 h-3 mr-1"}),"Nng cp ngay (100.000)"]})]})),x.jsx("div",{className:"space-y-2",children:ee.map(it=>{const vt=it.title_vi||it.title||"Voucher",Wt=it.discount_value||it.discount||it.discount_amount||0,rn=it.discount_type||"amount";return x.jsx("div",{className:"p-3 bg-white rounded-lg border border-dashed border-primary/30",children:x.jsxs("div",{className:"flex items-start justify-between gap-2",children:[x.jsxs("div",{children:[x.jsx("div",{className:"flex items-center gap-2",children:x.jsx("span",{className:"font-mono text-xs font-bold bg-primary/10 text-primary px-2 py-0.5 rounded",children:it.code})}),x.jsx("p",{className:"text-sm font-medium mt-1 text-gray-900",children:vt}),x.jsxs("p",{className:"text-xs text-gray-500",children:["Gim: ",rn==="percent"?`${Wt}%`:We(Wt)]})]}),x.jsxs("div",{className:"flex gap-1",children:[x.jsx("button",{onClick:()=>{ot(it),ze(!0)},className:"p-1.5 hover:bg-gray-100 rounded text-gray-600",children:x.jsx(p1,{className:"w-3 h-3"})}),x.jsx("button",{onClick:()=>Ae(it.id),className:"p-1.5 hover:bg-red-50 rounded text-red-500",children:x.jsx(ah,{className:"w-3 h-3"})})]})]})},it.id)})})]})})]})})]},he.id)}),x.jsxs(_n,{onClick:()=>k(!0),className:"w-full shadow-lg",children:[x.jsx(_m,{className:"w-4 h-4 mr-2"}),l==="vi"?"Thm ca hng mi":"Add New Store"]})]}):x.jsxs("div",{className:"text-center py-12",children:[x.jsx(Vc,{className:"w-16 h-16 mx-auto text-gray-300 mb-4"}),x.jsx("p",{className:"text-muted-foreground mb-4",children:l==="vi"?"ng nhp  qun l ca hng":"Login to manage your stores"}),x.jsx(_n,{onClick:r,children:l==="vi"?"ng nhp":"Login"})]})})]}),x.jsx(C4,{isOpen:a,onClose:()=>{k(!1),L(null)},initialData:M,onSubmit:Lt,isSubmitting:v,onUpgradeClick:()=>{M?xe(M.id):alert("Vui lng lu ca hng trc khi nng cp!")}})]}):null};function nY(t){const e=rY(t),r=P.forwardRef((l,u)=>{const{children:m,...v}=l,b=P.Children.toArray(m),a=b.find(sY);if(a){const k=a.props.children,M=b.map(L=>L===a?P.Children.count(k)>1?P.Children.only(null):P.isValidElement(k)?k.props.children:null:L);return x.jsx(e,{...v,ref:u,children:P.isValidElement(k)?P.cloneElement(k,void 0,M):null})}return x.jsx(e,{...v,ref:u,children:m})});return r.displayName=`${t}.Slot`,r}function rY(t){const e=P.forwardRef((r,l)=>{const{children:u,...m}=r;if(P.isValidElement(u)){const v=aY(u),b=oY(m,u.props);return u.type!==P.Fragment&&(b.ref=l?ed(l,v):v),P.cloneElement(u,b)}return P.Children.count(u)>1?P.Children.only(null):null});return e.displayName=`${t}.SlotClone`,e}var iY=Symbol("radix.slottable");function sY(t){return P.isValidElement(t)&&typeof t.type=="function"&&"__radixId"in t.type&&t.type.__radixId===iY}function oY(t,e){const r={...e};for(const l in e){const u=t[l],m=e[l];/^on[A-Z]/.test(l)?u&&m?r[l]=(...b)=>{const a=m(...b);return u(...b),a}:u&&(r[l]=u):l==="style"?r[l]={...u,...m}:l==="className"&&(r[l]=[u,m].filter(Boolean).join(" "))}return{...t,...r}}function aY(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning;return r?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,r=e&&"isReactWarning"in e&&e.isReactWarning,r?t.props.ref:t.props.ref||t.ref)}var _b=["Enter"," "],lY=["ArrowDown","PageUp","Home"],O4=["ArrowUp","PageDown","End"],cY=[...lY,...O4],uY={ltr:[..._b,"ArrowRight"],rtl:[..._b,"ArrowLeft"]},dY={ltr:["ArrowLeft"],rtl:["ArrowRight"]},f_="Menu",[Hy,hY,fY]=wv(f_),[lp,z4]=sl(f_,[fY,Zm,l0]),m0=Zm(),B4=l0(),[pY,cp]=lp(f_),[mY,p_]=lp(f_),F4=t=>{const{__scopeMenu:e,open:r=!1,children:l,dir:u,onOpenChange:m,modal:v=!0}=t,b=m0(e),[a,k]=P.useState(null),M=P.useRef(!1),L=Bi(m),z=u_(u);return P.useEffect(()=>{const O=()=>{M.current=!0,document.addEventListener("pointerdown",K,{capture:!0,once:!0}),document.addEventListener("pointermove",K,{capture:!0,once:!0})},K=()=>M.current=!1;return document.addEventListener("keydown",O,{capture:!0}),()=>{document.removeEventListener("keydown",O,{capture:!0}),document.removeEventListener("pointerdown",K,{capture:!0}),document.removeEventListener("pointermove",K,{capture:!0})}},[]),x.jsx(oP,{...b,children:x.jsx(pY,{scope:e,open:r,onOpenChange:L,content:a,onContentChange:k,children:x.jsx(mY,{scope:e,onClose:P.useCallback(()=>L(!1),[L]),isUsingKeyboardRef:M,dir:z,modal:v,children:l})})})};F4.displayName=f_;var gY="MenuAnchor",dS=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t,u=m0(r);return x.jsx(Fb,{...u,...l,ref:e})});dS.displayName=gY;var hS="MenuPortal",[yY,V4]=lp(hS,{forceMount:void 0}),U4=t=>{const{__scopeMenu:e,forceMount:r,children:l,container:u}=t,m=cp(hS,e);return x.jsx(yY,{scope:e,forceMount:r,children:x.jsx(jo,{present:r||m.open,children:x.jsx(Zy,{asChild:!0,container:u,children:l})})})};U4.displayName=hS;var il="MenuContent",[_Y,fS]=lp(il),$4=P.forwardRef((t,e)=>{const r=V4(il,t.__scopeMenu),{forceMount:l=r.forceMount,...u}=t,m=cp(il,t.__scopeMenu),v=p_(il,t.__scopeMenu);return x.jsx(Hy.Provider,{scope:t.__scopeMenu,children:x.jsx(jo,{present:l||m.open,children:x.jsx(Hy.Slot,{scope:t.__scopeMenu,children:v.modal?x.jsx(xY,{...u,ref:e}):x.jsx(vY,{...u,ref:e})})})})}),xY=P.forwardRef((t,e)=>{const r=cp(il,t.__scopeMenu),l=P.useRef(null),u=ir(e,l);return P.useEffect(()=>{const m=l.current;if(m)return WT(m)},[]),x.jsx(pS,{...t,ref:u,trapFocus:r.open,disableOutsidePointerEvents:r.open,disableOutsideScroll:!0,onFocusOutside:Xt(t.onFocusOutside,m=>m.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>r.onOpenChange(!1)})}),vY=P.forwardRef((t,e)=>{const r=cp(il,t.__scopeMenu);return x.jsx(pS,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>r.onOpenChange(!1)})}),wY=nY("MenuContent.ScrollLock"),pS=P.forwardRef((t,e)=>{const{__scopeMenu:r,loop:l=!1,trapFocus:u,onOpenAutoFocus:m,onCloseAutoFocus:v,disableOutsidePointerEvents:b,onEntryFocus:a,onEscapeKeyDown:k,onPointerDownOutside:M,onFocusOutside:L,onInteractOutside:z,onDismiss:O,disableOutsideScroll:K,...H}=t,Z=cp(il,r),Y=p_(il,r),ee=m0(r),ie=B4(r),pe=hY(r),[we,ke]=P.useState(null),ze=P.useRef(null),Ge=ir(e,ze,Z.onContentChange),tt=P.useRef(0),Pe=P.useRef(""),ot=P.useRef(0),ut=P.useRef(null),gt=P.useRef("right"),ht=P.useRef(0),Lt=K?e0:P.Fragment,mt=K?{as:wY,allowPinchZoom:!0}:void 0,pt=xe=>{const We=Pe.current+xe,he=pe().filter(wt=>!wt.disabled),Fe=document.activeElement,it=he.find(wt=>wt.ref.current===Fe)?.textValue,vt=he.map(wt=>wt.textValue),Wt=NY(vt,We,it),rn=he.find(wt=>wt.textValue===Wt)?.ref.current;(function wt(Kt){Pe.current=Kt,window.clearTimeout(tt.current),Kt!==""&&(tt.current=window.setTimeout(()=>wt(""),1e3))})(We),rn&&setTimeout(()=>rn.focus())};P.useEffect(()=>()=>window.clearTimeout(tt.current),[]),HT();const Ae=P.useCallback(xe=>gt.current===ut.current?.side&&LY(xe,ut.current?.area),[]);return x.jsx(_Y,{scope:r,searchRef:Pe,onItemEnter:P.useCallback(xe=>{Ae(xe)&&xe.preventDefault()},[Ae]),onItemLeave:P.useCallback(xe=>{Ae(xe)||(ze.current?.focus(),ke(null))},[Ae]),onTriggerLeave:P.useCallback(xe=>{Ae(xe)&&xe.preventDefault()},[Ae]),pointerGraceTimerRef:ot,onPointerGraceIntentChange:P.useCallback(xe=>{ut.current=xe},[]),children:x.jsx(Lt,{...mt,children:x.jsx(Jv,{asChild:!0,trapped:u,onMountAutoFocus:Xt(m,xe=>{xe.preventDefault(),ze.current?.focus({preventScroll:!0})}),onUnmountAutoFocus:v,children:x.jsx(Gm,{asChild:!0,disableOutsidePointerEvents:b,onEscapeKeyDown:k,onPointerDownOutside:M,onFocusOutside:L,onInteractOutside:z,onDismiss:O,children:x.jsx(fD,{asChild:!0,...ie,dir:Y.dir,orientation:"vertical",loop:l,currentTabStopId:we,onCurrentTabStopIdChange:ke,onEntryFocus:Xt(a,xe=>{Y.isUsingKeyboardRef.current||xe.preventDefault()}),preventScrollOnEntryFocus:!0,children:x.jsx(Vb,{role:"menu","aria-orientation":"vertical","data-state":sL(Z.open),"data-radix-menu-content":"",dir:Y.dir,...ee,...H,ref:Ge,style:{outline:"none",...H.style},onKeyDown:Xt(H.onKeyDown,xe=>{const he=xe.target.closest("[data-radix-menu-content]")===xe.currentTarget,Fe=xe.ctrlKey||xe.altKey||xe.metaKey,it=xe.key.length===1;he&&(xe.key==="Tab"&&xe.preventDefault(),!Fe&&it&&pt(xe.key));const vt=ze.current;if(xe.target!==vt||!cY.includes(xe.key))return;xe.preventDefault();const rn=pe().filter(wt=>!wt.disabled).map(wt=>wt.ref.current);O4.includes(xe.key)&&rn.reverse(),PY(rn)}),onBlur:Xt(t.onBlur,xe=>{xe.currentTarget.contains(xe.target)||(window.clearTimeout(tt.current),Pe.current="")}),onPointerMove:Xt(t.onPointerMove,Wy(xe=>{const We=xe.target,he=ht.current!==xe.clientX;if(xe.currentTarget.contains(We)&&he){const Fe=xe.clientX>ht.current?"right":"left";gt.current=Fe,ht.current=xe.clientX}}))})})})})})})});$4.displayName=il;var bY="MenuGroup",mS=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return x.jsx(Mn.div,{role:"group",...l,ref:e})});mS.displayName=bY;var TY="MenuLabel",G4=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return x.jsx(Mn.div,{...l,ref:e})});G4.displayName=TY;var yv="MenuItem",zI="menu.itemSelect",g0=P.forwardRef((t,e)=>{const{disabled:r=!1,onSelect:l,...u}=t,m=P.useRef(null),v=p_(yv,t.__scopeMenu),b=fS(yv,t.__scopeMenu),a=ir(e,m),k=P.useRef(!1),M=()=>{const L=m.current;if(!r&&L){const z=new CustomEvent(zI,{bubbles:!0,cancelable:!0});L.addEventListener(zI,O=>l?.(O),{once:!0}),vb(L,z),z.defaultPrevented?k.current=!1:v.onClose()}};return x.jsx(H4,{...u,ref:a,disabled:r,onClick:Xt(t.onClick,M),onPointerDown:L=>{t.onPointerDown?.(L),k.current=!0},onPointerUp:Xt(t.onPointerUp,L=>{k.current||L.currentTarget?.click()}),onKeyDown:Xt(t.onKeyDown,L=>{const z=b.searchRef.current!=="";r||z&&L.key===" "||_b.includes(L.key)&&(L.currentTarget.click(),L.preventDefault())})})});g0.displayName=yv;var H4=P.forwardRef((t,e)=>{const{__scopeMenu:r,disabled:l=!1,textValue:u,...m}=t,v=fS(yv,r),b=B4(r),a=P.useRef(null),k=ir(e,a),[M,L]=P.useState(!1),[z,O]=P.useState("");return P.useEffect(()=>{const K=a.current;K&&O((K.textContent??"").trim())},[m.children]),x.jsx(Hy.ItemSlot,{scope:r,disabled:l,textValue:u??z,children:x.jsx(pD,{asChild:!0,...b,focusable:!l,children:x.jsx(Mn.div,{role:"menuitem","data-highlighted":M?"":void 0,"aria-disabled":l||void 0,"data-disabled":l?"":void 0,...m,ref:k,onPointerMove:Xt(t.onPointerMove,Wy(K=>{l?v.onItemLeave(K):(v.onItemEnter(K),K.defaultPrevented||K.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Xt(t.onPointerLeave,Wy(K=>v.onItemLeave(K))),onFocus:Xt(t.onFocus,()=>L(!0)),onBlur:Xt(t.onBlur,()=>L(!1))})})})}),SY="MenuCheckboxItem",W4=P.forwardRef((t,e)=>{const{checked:r=!1,onCheckedChange:l,...u}=t;return x.jsx(Y4,{scope:t.__scopeMenu,checked:r,children:x.jsx(g0,{role:"menuitemcheckbox","aria-checked":_v(r)?"mixed":r,...u,ref:e,"data-state":yS(r),onSelect:Xt(u.onSelect,()=>l?.(_v(r)?!0:!r),{checkForDefaultPrevented:!1})})})});W4.displayName=SY;var q4="MenuRadioGroup",[EY,CY]=lp(q4,{value:void 0,onValueChange:()=>{}}),Z4=P.forwardRef((t,e)=>{const{value:r,onValueChange:l,...u}=t,m=Bi(l);return x.jsx(EY,{scope:t.__scopeMenu,value:r,onValueChange:m,children:x.jsx(mS,{...u,ref:e})})});Z4.displayName=q4;var X4="MenuRadioItem",K4=P.forwardRef((t,e)=>{const{value:r,...l}=t,u=CY(X4,t.__scopeMenu),m=r===u.value;return x.jsx(Y4,{scope:t.__scopeMenu,checked:m,children:x.jsx(g0,{role:"menuitemradio","aria-checked":m,...l,ref:e,"data-state":yS(m),onSelect:Xt(l.onSelect,()=>u.onValueChange?.(r),{checkForDefaultPrevented:!1})})})});K4.displayName=X4;var gS="MenuItemIndicator",[Y4,kY]=lp(gS,{checked:!1}),J4=P.forwardRef((t,e)=>{const{__scopeMenu:r,forceMount:l,...u}=t,m=kY(gS,r);return x.jsx(jo,{present:l||_v(m.checked)||m.checked===!0,children:x.jsx(Mn.span,{...u,ref:e,"data-state":yS(m.checked)})})});J4.displayName=gS;var AY="MenuSeparator",Q4=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t;return x.jsx(Mn.div,{role:"separator","aria-orientation":"horizontal",...l,ref:e})});Q4.displayName=AY;var IY="MenuArrow",eL=P.forwardRef((t,e)=>{const{__scopeMenu:r,...l}=t,u=m0(r);return x.jsx(Ub,{...u,...l,ref:e})});eL.displayName=IY;var MY="MenuSub",[eQ,tL]=lp(MY),uy="MenuSubTrigger",nL=P.forwardRef((t,e)=>{const r=cp(uy,t.__scopeMenu),l=p_(uy,t.__scopeMenu),u=tL(uy,t.__scopeMenu),m=fS(uy,t.__scopeMenu),v=P.useRef(null),{pointerGraceTimerRef:b,onPointerGraceIntentChange:a}=m,k={__scopeMenu:t.__scopeMenu},M=P.useCallback(()=>{v.current&&window.clearTimeout(v.current),v.current=null},[]);return P.useEffect(()=>M,[M]),P.useEffect(()=>{const L=b.current;return()=>{window.clearTimeout(L),a(null)}},[b,a]),x.jsx(dS,{asChild:!0,...k,children:x.jsx(H4,{id:u.triggerId,"aria-haspopup":"menu","aria-expanded":r.open,"aria-controls":u.contentId,"data-state":sL(r.open),...t,ref:ed(e,u.onTriggerChange),onClick:L=>{t.onClick?.(L),!(t.disabled||L.defaultPrevented)&&(L.currentTarget.focus(),r.open||r.onOpenChange(!0))},onPointerMove:Xt(t.onPointerMove,Wy(L=>{m.onItemEnter(L),!L.defaultPrevented&&!t.disabled&&!r.open&&!v.current&&(m.onPointerGraceIntentChange(null),v.current=window.setTimeout(()=>{r.onOpenChange(!0),M()},100))})),onPointerLeave:Xt(t.onPointerLeave,Wy(L=>{M();const z=r.content?.getBoundingClientRect();if(z){const O=r.content?.dataset.side,K=O==="right",H=K?-5:5,Z=z[K?"left":"right"],Y=z[K?"right":"left"];m.onPointerGraceIntentChange({area:[{x:L.clientX+H,y:L.clientY},{x:Z,y:z.top},{x:Y,y:z.top},{x:Y,y:z.bottom},{x:Z,y:z.bottom}],side:O}),window.clearTimeout(b.current),b.current=window.setTimeout(()=>m.onPointerGraceIntentChange(null),300)}else{if(m.onTriggerLeave(L),L.defaultPrevented)return;m.onPointerGraceIntentChange(null)}})),onKeyDown:Xt(t.onKeyDown,L=>{const z=m.searchRef.current!=="";t.disabled||z&&L.key===" "||uY[l.dir].includes(L.key)&&(r.onOpenChange(!0),r.content?.focus(),L.preventDefault())})})})});nL.displayName=uy;var rL="MenuSubContent",iL=P.forwardRef((t,e)=>{const r=V4(il,t.__scopeMenu),{forceMount:l=r.forceMount,...u}=t,m=cp(il,t.__scopeMenu),v=p_(il,t.__scopeMenu),b=tL(rL,t.__scopeMenu),a=P.useRef(null),k=ir(e,a);return x.jsx(Hy.Provider,{scope:t.__scopeMenu,children:x.jsx(jo,{present:l||m.open,children:x.jsx(Hy.Slot,{scope:t.__scopeMenu,children:x.jsx(pS,{id:b.contentId,"aria-labelledby":b.triggerId,...u,ref:k,align:"start",side:v.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:M=>{v.isUsingKeyboardRef.current&&a.current?.focus(),M.preventDefault()},onCloseAutoFocus:M=>M.preventDefault(),onFocusOutside:Xt(t.onFocusOutside,M=>{M.target!==b.trigger&&m.onOpenChange(!1)}),onEscapeKeyDown:Xt(t.onEscapeKeyDown,M=>{v.onClose(),M.preventDefault()}),onKeyDown:Xt(t.onKeyDown,M=>{const L=M.currentTarget.contains(M.target),z=dY[v.dir].includes(M.key);L&&z&&(m.onOpenChange(!1),b.trigger?.focus(),M.preventDefault())})})})})})});iL.displayName=rL;function sL(t){return t?"open":"closed"}function _v(t){return t==="indeterminate"}function yS(t){return _v(t)?"indeterminate":t?"checked":"unchecked"}function PY(t){const e=document.activeElement;for(const r of t)if(r===e||(r.focus(),document.activeElement!==e))return}function RY(t,e){return t.map((r,l)=>t[(e+l)%t.length])}function NY(t,e,r){const u=e.length>1&&Array.from(e).every(k=>k===e[0])?e[0]:e,m=r?t.indexOf(r):-1;let v=RY(t,Math.max(m,0));u.length===1&&(v=v.filter(k=>k!==r));const a=v.find(k=>k.toLowerCase().startsWith(u.toLowerCase()));return a!==r?a:void 0}function DY(t,e){const{x:r,y:l}=t;let u=!1;for(let m=0,v=e.length-1;m<e.length;v=m++){const b=e[m],a=e[v],k=b.x,M=b.y,L=a.x,z=a.y;M>l!=z>l&&r<(L-k)*(l-M)/(z-M)+k&&(u=!u)}return u}function LY(t,e){if(!e)return!1;const r={x:t.clientX,y:t.clientY};return DY(r,e)}function Wy(t){return e=>e.pointerType==="mouse"?t(e):void 0}var jY=F4,OY=dS,zY=U4,BY=$4,FY=mS,VY=G4,UY=g0,$Y=W4,GY=Z4,HY=K4,WY=J4,qY=Q4,ZY=eL,XY=nL,KY=iL,y0="DropdownMenu",[YY]=sl(y0,[z4]),zo=z4(),[JY,oL]=YY(y0),aL=t=>{const{__scopeDropdownMenu:e,children:r,dir:l,open:u,defaultOpen:m,onOpenChange:v,modal:b=!0}=t,a=zo(e),k=P.useRef(null),[M,L]=hh({prop:u,defaultProp:m??!1,onChange:v,caller:y0});return x.jsx(JY,{scope:e,triggerId:$c(),triggerRef:k,contentId:$c(),open:M,onOpenChange:L,onOpenToggle:P.useCallback(()=>L(z=>!z),[L]),modal:b,children:x.jsx(jY,{...a,open:M,onOpenChange:L,dir:l,modal:b,children:r})})};aL.displayName=y0;var lL="DropdownMenuTrigger",cL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,disabled:l=!1,...u}=t,m=oL(lL,r),v=zo(r);return x.jsx(OY,{asChild:!0,...v,children:x.jsx(Mn.button,{type:"button",id:m.triggerId,"aria-haspopup":"menu","aria-expanded":m.open,"aria-controls":m.open?m.contentId:void 0,"data-state":m.open?"open":"closed","data-disabled":l?"":void 0,disabled:l,...u,ref:ed(e,m.triggerRef),onPointerDown:Xt(t.onPointerDown,b=>{!l&&b.button===0&&b.ctrlKey===!1&&(m.onOpenToggle(),m.open||b.preventDefault())}),onKeyDown:Xt(t.onKeyDown,b=>{l||(["Enter"," "].includes(b.key)&&m.onOpenToggle(),b.key==="ArrowDown"&&m.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(b.key)&&b.preventDefault())})})})});cL.displayName=lL;var QY="DropdownMenuPortal",uL=t=>{const{__scopeDropdownMenu:e,...r}=t,l=zo(e);return x.jsx(zY,{...l,...r})};uL.displayName=QY;var dL="DropdownMenuContent",hL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=oL(dL,r),m=zo(r),v=P.useRef(!1);return x.jsx(BY,{id:u.contentId,"aria-labelledby":u.triggerId,...m,...l,ref:e,onCloseAutoFocus:Xt(t.onCloseAutoFocus,b=>{v.current||u.triggerRef.current?.focus(),v.current=!1,b.preventDefault()}),onInteractOutside:Xt(t.onInteractOutside,b=>{const a=b.detail.originalEvent,k=a.button===0&&a.ctrlKey===!0,M=a.button===2||k;(!u.modal||M)&&(v.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});hL.displayName=dL;var eJ="DropdownMenuGroup",tJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(FY,{...u,...l,ref:e})});tJ.displayName=eJ;var nJ="DropdownMenuLabel",fL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(VY,{...u,...l,ref:e})});fL.displayName=nJ;var rJ="DropdownMenuItem",pL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(UY,{...u,...l,ref:e})});pL.displayName=rJ;var iJ="DropdownMenuCheckboxItem",mL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx($Y,{...u,...l,ref:e})});mL.displayName=iJ;var sJ="DropdownMenuRadioGroup",oJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(GY,{...u,...l,ref:e})});oJ.displayName=sJ;var aJ="DropdownMenuRadioItem",gL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(HY,{...u,...l,ref:e})});gL.displayName=aJ;var lJ="DropdownMenuItemIndicator",yL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(WY,{...u,...l,ref:e})});yL.displayName=lJ;var cJ="DropdownMenuSeparator",_L=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(qY,{...u,...l,ref:e})});_L.displayName=cJ;var uJ="DropdownMenuArrow",dJ=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(ZY,{...u,...l,ref:e})});dJ.displayName=uJ;var hJ="DropdownMenuSubTrigger",xL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(XY,{...u,...l,ref:e})});xL.displayName=hJ;var fJ="DropdownMenuSubContent",vL=P.forwardRef((t,e)=>{const{__scopeDropdownMenu:r,...l}=t,u=zo(r);return x.jsx(KY,{...u,...l,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});vL.displayName=fJ;var pJ=aL,mJ=cL,gJ=uL,wL=hL,bL=fL,TL=pL,SL=mL,EL=gL,CL=yL,kL=_L,AL=xL,IL=vL;const yJ=pJ,_J=mJ,xJ=P.forwardRef(({className:t,inset:e,children:r,...l},u)=>x.jsxs(AL,{ref:u,className:ln("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[state=open]:bg-accent focus:bg-accent",e&&"pl-8",t),...l,children:[r,x.jsx(xM,{className:"ml-auto h-4 w-4"})]}));xJ.displayName=AL.displayName;const vJ=P.forwardRef(({className:t,...e},r)=>x.jsx(IL,{ref:r,className:ln("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...e}));vJ.displayName=IL.displayName;const ML=P.forwardRef(({className:t,sideOffset:e=4,...r},l)=>x.jsx(gJ,{children:x.jsx(wL,{ref:l,sideOffset:e,className:ln("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}));ML.displayName=wL.displayName;const dy=P.forwardRef(({className:t,inset:e,...r},l)=>x.jsx(TL,{ref:l,className:ln("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",e&&"pl-8",t),...r}));dy.displayName=TL.displayName;const wJ=P.forwardRef(({className:t,children:e,checked:r,...l},u)=>x.jsxs(SL,{ref:u,className:ln("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),checked:r,...l,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(CL,{children:x.jsx(np,{className:"h-4 w-4"})})}),e]}));wJ.displayName=SL.displayName;const bJ=P.forwardRef(({className:t,children:e,...r},l)=>x.jsxs(EL,{ref:l,className:ln("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors data-[disabled]:pointer-events-none data-[disabled]:opacity-50 focus:bg-accent focus:text-accent-foreground",t),...r,children:[x.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:x.jsx(CL,{children:x.jsx(xO,{className:"h-2 w-2 fill-current"})})}),e]}));bJ.displayName=EL.displayName;const PL=P.forwardRef(({className:t,inset:e,...r},l)=>x.jsx(bL,{ref:l,className:ln("px-2 py-1.5 text-sm font-semibold",e&&"pl-8",t),...r}));PL.displayName=bL.displayName;const Ox=P.forwardRef(({className:t,...e},r)=>x.jsx(kL,{ref:r,className:ln("-mx-1 my-1 h-px bg-muted",t),...e}));Ox.displayName=kL.displayName;const BI="https://thodia-backend-1067502227654.asia-southeast1.run.app",TJ=({onLoginClick:t,onFavoritesClick:e,onStoresClick:r})=>{const{user:l,signOut:u}=Oo(),{language:m}=ra(),v=ip(),[b,a]=P.useState(!1),[k,M]=P.useState([]),[L,z]=P.useState(!1),[O,K]=P.useState(null);P.useEffect(()=>{l&&(async()=>{try{const ze=await(await fetch(`${BI}/api/user-stores?userId=${l.uid}`)).json();Array.isArray(ze)&&M(ze)}catch(ke){console.error("Li ly danh sch ca hng:",ke)}})()},[l]);const H=(we,ke)=>{if(!k||k.length===0){alert("Bn cha c ca hng no! Hy to ca hng trc.");return}k.length===1?Z(k[0].id,we,ke):(K({type:we,packageType:ke}),z(!0))},Z=async(we,ke,ze)=>{a(!0),z(!1);try{const Ge=await fetch(`${BI}/api/payment/create-checkout`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({storeId:we,userId:l?.uid,type:ke,packageType:ze,returnUrl:window.location.href,cancelUrl:window.location.href})}),tt=await Ge.json();if(!Ge.ok)throw new Error(tt.error||"Li to thanh ton");if(tt&&tt.checkoutUrl)window.location.href=tt.checkoutUrl;else throw new Error("Khng ly c link thanh ton")}catch(Ge){console.error(Ge),alert("Li: "+(Ge.message||"C li xy ra"))}finally{a(!1)}},Y=async()=>{try{await u()}catch(we){console.warn("Li ng xut:",we)}finally{localStorage.clear(),window.location.reload()}};if(!l)return x.jsxs(x.Fragment,{children:[x.jsx(_n,{variant:"outline",size:"icon",onClick:t,className:"md:hidden w-10 h-10 rounded-full border-gray-200 bg-white shadow-sm active:scale-95 transition-all text-gray-700 hover:text-green-600 hover:border-green-600",children:x.jsx(_O,{className:"w-6 h-6"})}),x.jsxs(_n,{onClick:t,variant:"default",className:"hidden md:flex gap-2 shadow-lg rounded-xl font-semibold bg-white text-black hover:bg-gray-100 border border-gray-200",children:[x.jsx(Cy,{className:"w-4 h-4"}),m==="vi"?"ng nhp":"Login"]})]});const ee=l.email,ie=ee?ee[0].toUpperCase():"U",pe=l.photoURL;return x.jsxs(x.Fragment,{children:[x.jsxs(yJ,{children:[x.jsx(_J,{asChild:!0,children:x.jsx(_n,{variant:"secondary",className:"relative w-10 h-10 rounded-full p-0 overflow-hidden shadow-lg border-2 border-white cursor-pointer hover:ring-2 hover:ring-green-500 transition-all",children:x.jsxs(nS,{className:"h-full w-full",children:[x.jsx(OD,{src:pe||void 0}),x.jsx(rS,{className:"bg-green-600 text-white font-bold",children:ie})]})})}),x.jsxs(ML,{align:"end",className:"w-64 rounded-xl p-2 mt-2 bg-white shadow-xl border border-gray-100 z-[200]",children:[x.jsx(PL,{children:x.jsxs("div",{className:"flex flex-col space-y-1",children:[x.jsx("p",{className:"text-sm font-medium leading-none",children:m==="vi"?"Ti khon":"Account"}),x.jsx("p",{className:"text-xs leading-none text-muted-foreground truncate font-normal text-gray-500",children:ee})]})}),x.jsx(Ox,{className:"my-1 bg-gray-100"}),x.jsxs("div",{className:"bg-gray-50 rounded-lg p-2 mb-2 border border-gray-100",children:[x.jsx("p",{className:"text-[10px] uppercase text-gray-500 font-bold mb-2 pl-1",children:m==="vi"?"Nng cp ca hng":"Upgrade Store"}),x.jsxs("button",{disabled:b,onClick:()=>H("vip"),className:"w-full flex items-center gap-2 text-xs font-semibold text-yellow-700 bg-yellow-100 hover:bg-yellow-200 p-2 rounded mb-2 transition-colors",children:[b?x.jsx(Fi,{className:"w-3 h-3 animate-spin"}):x.jsx(nl,{className:"w-3 h-3 fill-yellow-600"}),"VIP"]}),x.jsxs("div",{className:"grid grid-cols-2 gap-1",children:[x.jsxs("button",{disabled:b,onClick:()=>H("ad","week"),className:"flex flex-col items-center justify-center gap-1 text-[10px] font-medium text-blue-700 bg-blue-50 hover:bg-blue-100 p-1.5 rounded transition-colors",children:[b?x.jsx(Fi,{className:"w-3 h-3 animate-spin"}):x.jsx(zx,{className:"w-3 h-3"}),"QC Tun"]}),x.jsxs("button",{disabled:b,onClick:()=>H("ad","month"),className:"flex flex-col items-center justify-center gap-1 text-[10px] font-medium text-indigo-700 bg-indigo-50 hover:bg-indigo-100 p-1.5 rounded transition-colors",children:[b?x.jsx(Fi,{className:"w-3 h-3 animate-spin"}):x.jsx(zx,{className:"w-3 h-3"}),"QC Thng"]})]})]}),ee==="admin@gmail.com"&&x.jsxs(x.Fragment,{children:[x.jsxs(dy,{onClick:()=>v("/admin"),className:"cursor-pointer font-bold text-blue-600 bg-blue-50 focus:bg-blue-100 rounded-lg p-2 mb-1",children:[x.jsx(jO,{className:"mr-2 h-4 w-4"}),x.jsx("span",{children:"Admin Dashboard"})]}),x.jsx(Ox,{className:"my-1 bg-gray-100"})]}),x.jsxs(dy,{onClick:e,className:"cursor-pointer rounded-lg hover:bg-gray-50 p-2",children:[x.jsx(Ff,{className:"mr-2 h-4 w-4 text-red-500"}),x.jsx("span",{children:m==="vi"?"a im yu thch":"Favorite Locations"})]}),x.jsxs(dy,{onClick:r,className:"cursor-pointer rounded-lg hover:bg-gray-50 p-2",children:[x.jsx(Vc,{className:"mr-2 h-4 w-4 text-orange-500"}),x.jsx("span",{children:m==="vi"?"Ca hng ca ti":"My Stores"})]}),x.jsx(Ox,{className:"my-1 bg-gray-100"}),x.jsxs(dy,{onClick:Y,className:"cursor-pointer text-red-600 focus:text-red-600 focus:bg-red-50 rounded-lg p-2",children:[x.jsx(dw,{className:"mr-2 h-4 w-4"}),x.jsx("span",{children:m==="vi"?"ng xut":"Log out"})]})]})]}),L&&x.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black/50 backdrop-blur-sm p-4",children:x.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-sm overflow-hidden animate-in fade-in zoom-in duration-200",children:[x.jsxs("div",{className:"p-4 border-b flex justify-between items-center bg-gray-50",children:[x.jsx("h3",{className:"font-bold text-gray-800",children:"Chn ca hng  nng cp"}),x.jsx("button",{onClick:()=>z(!1),className:"p-1 hover:bg-gray-200 rounded-full",children:x.jsx(ti,{className:"w-5 h-5 text-gray-500"})})]}),x.jsx("div",{className:"p-4 max-h-[60vh] overflow-y-auto space-y-2",children:k.map(we=>x.jsxs("button",{onClick:()=>O&&Z(we.id,O.type,O.packageType),className:"w-full text-left p-3 rounded-xl border hover:border-blue-500 hover:bg-blue-50 transition-all group relative",children:[x.jsx("div",{className:"font-bold text-gray-900 group-hover:text-blue-700",children:we.name_vi}),x.jsx("div",{className:"text-xs text-gray-500 truncate",children:we.address_vi}),we.is_premium&&O?.type==="vip"&&x.jsx("span",{className:"absolute top-3 right-3 text-[10px] bg-yellow-100 text-yellow-700 px-2 py-0.5 rounded-full font-bold",children:" VIP"})]},we.id))})]})})]})},SJ=({compact:t=!1})=>{const{language:e,setLanguage:r}=ra(),l=[{code:"vi",label:"VI",labelFull:"Ting Vit",flag:""},{code:"en",label:"EN",labelFull:"English",flag:""}];return t?x.jsx("div",{className:"flex items-center bg-card/90 backdrop-blur-sm rounded-full shadow-md border border-border overflow-hidden",children:l.map(({code:u,flag:m})=>x.jsxs(yr.button,{onClick:()=>r(u),className:ln("relative flex items-center justify-center w-8 h-8 text-sm transition-colors duration-200",e===u?"text-primary-foreground":"text-muted-foreground hover:text-foreground"),whileTap:{scale:.9},children:[e===u&&x.jsx(yr.div,{layoutId:"language-active-bg-compact",className:"absolute inset-0.5 bg-primary rounded-full",initial:!1,transition:{type:"spring",stiffness:400,damping:30}}),x.jsx(yr.span,{className:"relative z-10 text-base",animate:{scale:e===u?1.1:.9},children:m})]},u))}):x.jsx("div",{className:"flex items-center bg-card rounded-2xl shadow-lg border-2 border-border overflow-hidden",children:l.map(({code:u,label:m,labelFull:v,flag:b})=>x.jsxs(yr.button,{onClick:()=>r(u),className:ln("relative flex items-center gap-2 px-4 py-2.5 text-sm font-semibold transition-colors duration-200",e===u?"text-primary-foreground":"text-muted-foreground hover:text-foreground"),title:v,whileTap:{scale:.95},children:[e===u&&x.jsx(yr.div,{layoutId:"language-active-bg",className:"absolute inset-0 bg-primary",initial:!1,transition:{type:"spring",stiffness:400,damping:30}}),x.jsx(yr.span,{className:"relative z-10 text-lg",animate:{scale:e===u?1.1:1,rotate:e===u?[0,-10,10,0]:0},transition:{duration:.3},children:b}),x.jsx("span",{className:"relative z-10 font-bold",children:m})]},u))})},EJ="https://thodia-backend-1067502227654.asia-southeast1.run.app",CJ=({isOpen:t,onClose:e,data:r})=>{const{user:l}=Oo(),[u,m]=P.useState(!1),[v,b]=P.useState({phone:"",email:"",role:"Ch s hu",message:""}),[a,k]=P.useState([]),[M,L]=P.useState([]);if(P.useEffect(()=>{t&&(b({phone:"",role:"Ch s hu",message:"",email:l?.email||""}),k([]),L([]))},[t,l]),P.useEffect(()=>{const H=a.map(Z=>URL.createObjectURL(Z));return L(H),()=>{H.forEach(Z=>URL.revokeObjectURL(Z))}},[a]),!t||!r)return null;const z=H=>{if(H.target.files){const Z=Array.from(H.target.files);if(a.length+Z.length>5){Ht.error("Ti a 5 nh");return}k(Y=>[...Y,...Z])}},O=H=>{k(Z=>Z.filter((Y,ee)=>ee!==H))},K=async H=>{if(H.preventDefault(),a.length===0)return Ht.error("Cn t nht 1 nh bng chng");if(!l)return Ht.error("Vui lng ng nhp");m(!0);try{const Z=new FormData;Z.append("userId",l.uid),Z.append("storeId",String(r.mapboxId)),Z.append("storeName",r.name),Z.append("storeAddress",r.address||""),Z.append("lat",String(r.lat)),Z.append("lng",String(r.lng)),Z.append("phone",v.phone),Z.append("email",v.email),Z.append("role",v.role),Z.append("message",v.message),a.forEach(ie=>{Z.append("proofFiles",ie)});const Y=await fetch(`${EJ}/api/claims/submit`,{method:"POST",body:Z}),ee=await Y.json();if(!Y.ok)throw new Error(ee.error||"Gi tht bi");Ht.success(" gi xc minh thnh cng!"),e()}catch(Z){console.error(Z),Ht.error(Z.message||"Li kt ni")}finally{m(!1)}};return x.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm animate-in fade-in duration-200",children:x.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-lg overflow-hidden flex flex-col max-h-[90vh]",children:[x.jsxs("div",{className:"px-6 py-4 border-b bg-gray-50 flex justify-between items-center shrink-0",children:[x.jsx("h3",{className:"font-bold text-lg",children:"Xc nhn ch s hu"}),x.jsx("button",{onClick:e,children:x.jsx(ti,{size:20})})]}),x.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-5",children:[x.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-medium",children:"Vai tr *"}),x.jsxs("select",{className:"w-full mt-1 p-2 border rounded",value:v.role,onChange:H=>b({...v,role:H.target.value}),children:[x.jsx("option",{children:"Ch s hu"}),x.jsx("option",{children:"Qun l"})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-medium",children:"ST *"}),x.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:v.phone,onChange:H=>b({...v,phone:H.target.value}),required:!0})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-medium",children:"Email *"}),x.jsx("input",{className:"w-full mt-1 p-2 border rounded",value:v.email,onChange:H=>b({...v,email:H.target.value}),required:!0})]}),x.jsxs("div",{children:[x.jsx("label",{className:"block text-sm font-medium mb-2",children:"nh bng chng *"}),x.jsxs("div",{className:"grid grid-cols-4 gap-3",children:[M.map((H,Z)=>x.jsxs("div",{className:"relative aspect-square rounded border overflow-hidden",children:[x.jsx("img",{src:H,className:"w-full h-full object-cover",alt:"preview"}),x.jsx("button",{type:"button",onClick:()=>O(Z),className:"absolute top-0 right-0 bg-red-500 text-white p-1",children:x.jsx(ti,{size:12})})]},Z)),a.length<5&&x.jsxs("label",{className:"border-2 border-dashed rounded flex items-center justify-center cursor-pointer aspect-square hover:bg-gray-50",children:[x.jsx("input",{type:"file",accept:"image/*",multiple:!0,onChange:z,className:"hidden"}),x.jsx(OO,{size:20,className:"text-gray-400"})]})]})]}),x.jsxs("div",{children:[x.jsx("label",{className:"text-sm font-medium",children:"Li nhn"}),x.jsx("textarea",{className:"w-full mt-1 p-2 border rounded",rows:3,value:v.message,onChange:H=>b({...v,message:H.target.value})})]})]}),x.jsxs("div",{className:"p-4 border-t bg-gray-50 flex gap-3",children:[x.jsx("button",{onClick:e,className:"flex-1 p-2 border rounded bg-white",children:"Hy"}),x.jsx("button",{onClick:K,disabled:u,className:"flex-1 p-2 bg-blue-600 text-white rounded flex justify-center items-center gap-2",children:u?x.jsx(Fi,{className:"animate-spin"}):"Gi xc minh"})]})]})})},kJ=iD,AJ=gZ,IJ=sD,RL=P.forwardRef(({className:t,...e},r)=>x.jsx(n0,{className:ln("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...e,ref:r}));RL.displayName=n0.displayName;const MJ=Ky("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),NL=P.forwardRef(({side:t="right",className:e,children:r,...l},u)=>x.jsxs(IJ,{children:[x.jsx(RL,{}),x.jsxs(r0,{ref:u,className:ln(MJ({side:t}),e),...l,children:[r,x.jsxs(oD,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity data-[state=open]:bg-secondary hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none",children:[x.jsx(ti,{className:"h-4 w-4"}),x.jsx("span",{className:"sr-only",children:"Close"})]})]})]}));NL.displayName=r0.displayName;const DL=({className:t,...e})=>x.jsx("div",{className:ln("flex flex-col space-y-2 text-center sm:text-left",t),...e});DL.displayName="SheetHeader";const LL=P.forwardRef(({className:t,...e},r)=>x.jsx(i0,{ref:r,className:ln("text-lg font-semibold text-foreground",t),...e}));LL.displayName=i0.displayName;const PJ=P.forwardRef(({className:t,...e},r)=>x.jsx(s0,{ref:r,className:ln("text-sm text-muted-foreground",t),...e}));PJ.displayName=s0.displayName;const RJ=({children:t})=>{const e=ip(),r=[{icon:x.jsx(SM,{className:"w-5 h-5 text-blue-500"}),label:"Bn ",desc:"Trang ch tm kim",path:"/"},{icon:x.jsx(oh,{className:"w-5 h-5 text-green-600"}),label:"Vic lm",desc:"Tm vic & Tuyn dng Free",path:"/jobs"},{icon:x.jsx(bM,{className:"w-5 h-5 text-gray-500"}),label:"Gii thiu",desc:"V ThodiaUni",path:"/about"}];return x.jsxs(kJ,{children:[x.jsx(AJ,{asChild:!0,children:t}),x.jsxs(NL,{side:"left",className:"w-[300px] sm:w-[350px] p-0 flex flex-col h-full",children:[x.jsx(DL,{className:"p-6 bg-gradient-to-br from-green-50 to-white border-b",children:x.jsxs(LL,{className:"flex items-center gap-3",children:[x.jsx("img",{src:"/logo.png",className:"w-12 h-12 rounded-xl object-contain bg-white shadow-sm border"}),x.jsxs("div",{className:"text-left",children:[x.jsx("div",{className:"text-green-700 font-black text-xl tracking-tight",children:"ThodiaUni"}),x.jsx("div",{className:"text-xs text-gray-500 font-medium",children:"Menu chnh"})]})]})}),x.jsx("div",{className:"flex-1 overflow-y-auto py-4 px-3 space-y-1",children:r.map((l,u)=>x.jsxs(_n,{variant:"ghost",className:"w-full justify-between h-auto py-3 px-3 hover:bg-green-50 rounded-xl group",onClick:()=>e(l.path),children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx("div",{className:"w-10 h-10 rounded-full bg-gray-50 flex items-center justify-center group-hover:bg-white group-hover:shadow-sm transition-all",children:l.icon}),x.jsxs("div",{className:"text-left",children:[x.jsx("div",{className:"font-bold text-gray-800 text-sm",children:l.label}),x.jsx("div",{className:"text-[10px] text-gray-500 font-normal",children:l.desc})]})]}),x.jsx(xM,{className:"w-4 h-4 text-gray-300 group-hover:text-green-600"})]},u))}),x.jsxs("div",{className:"p-4 bg-gray-50 mt-auto border-t",children:[x.jsxs("div",{className:"bg-white p-4 rounded-xl border border-blue-100 shadow-sm",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[x.jsx(Vc,{className:"w-4 h-4 text-blue-600"}),x.jsx("h4",{className:"text-blue-700 font-bold text-sm",children:"Dnh cho Ch Shop"})]}),x.jsxs("p",{className:"text-xs text-gray-600 mb-3 leading-relaxed",children:["ng tin tuyn dng nhn vin hon ton ",x.jsx("strong",{children:"Min ph"})," ngay trn ThodiaUni."]}),x.jsx(_n,{size:"sm",className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-bold text-xs h-8",onClick:()=>e("/jobs"),children:"ng tin ngay"})]}),x.jsx("div",{className:"text-center mt-4 text-[10px] text-gray-400",children:"Ver 1.0.2  Made with "})]})]})]})},NJ=(t,e,r,l)=>{const m=(r-t)*Math.PI/180,v=(l-e)*Math.PI/180,b=Math.sin(m/2)*Math.sin(m/2)+Math.cos(t*Math.PI/180)*Math.cos(r*Math.PI/180)*Math.sin(v/2)*Math.sin(v/2);return 6371e3*(2*Math.atan2(Math.sqrt(b),Math.sqrt(1-b)))},DJ=(t,e)=>{let r=1/0,l=0;for(let u=0;u<e.length;u++){const m=e[u],v=NJ(t[1],t[0],m[1],m[0]);v<r&&(r=v,l=u)}return{distance:r,segmentIndex:l}},LJ=({steps:t,routeGeometry:e,isNavigating:r,userLocation:l,onOffRoute:u})=>{const[m,v]=P.useState({currentStepIndex:0,distanceToNextStep:0,isOffRoute:!1,isTracking:!1}),b=50,a=P.useCallback((k,M)=>{const{distance:L,segmentIndex:z}=DJ(k,M),O=L>b;let K=0,H=0;for(let Y=0;Y<t.length;Y++){K+=t[Y].distance;const ee=z/M.length,ie=K/t.reduce((pe,we)=>pe+we.distance,0);if(ee<=ie){H=Y;break}H=Y}let Z=0;if(H<t.length){let Y=0;for(let ke=0;ke<H;ke++)Y+=t[ke].distance;const ee=t[H]?.distance||0,ie=z/M.length,pe=t.reduce((ke,ze)=>ke+ze.distance,0),we=ie*pe;Z=Math.max(0,Y+ee-we)}return{currentStepIndex:H,distanceToNextStep:Z,isOffRoute:O}},[t,b]);return P.useEffect(()=>{if(!r||!l||!e){v(L=>({...L,isTracking:!1}));return}const k=[l.lng,l.lat],M=a(k,e.coordinates);v(L=>{const z={...L,isTracking:!0,...M};return M.isOffRoute&&!L.isOffRoute&&u&&u(),z})},[r,l?.lat,l?.lng,e,t,u]),m},FI=()=>{const{t,language:e}=ra(),{id:r}=Q6(),l=ip(),[u,m]=P.useState(null),v=P.useRef(null),[b,a]=P.useState(null),[k,M]=P.useState(null),[L,z]=P.useState(null),[O,K]=P.useState(null),[H,Z]=P.useState(["building","food","housing","job","lecture_hall","office","cafe","entertainment","checkin"]),[Y,ee]=P.useState(!1),[ie,pe]=P.useState(!1),[we,ke]=P.useState(!1),[ze,Ge]=P.useState(!1),[tt,Pe]=P.useState(null),[ot,ut]=P.useState(null),[gt,ht]=P.useState(""),[Lt,mt]=P.useState(!1),[pt,Ae]=P.useState(!1),[xe,We]=P.useState(!1),[he,Fe]=P.useState(!1),[it,vt]=P.useState(!1),[Wt,rn]=P.useState(null),{favorites:wt}=R3(),{route:Kt,isLoading:Tn,getDirections:fn,clearDirections:Cn,transportMode:tn,setTransportMode:mr,routePreference:hr,setRoutePreference:_i,origin:Xn,destination:Er}=dK(),{route:Xs,waypoints:xi,isLoading:Zr,transportMode:ni,addWaypoint:rs,removeWaypoint:Wi,reorderWaypoints:Ms,getMultiStopDirections:_s,clearRoute:Vr,setTransportMode:is}=pK();P.useEffect(()=>{if(!r){M(null),document.title="ThodiaUni - Bn  i hc";return}const ue=GT.find(Se=>String(Se.id)===r);if(ue){M(ue),K(ue),document.title=`${e==="en"?ue.name:ue.nameVi} | ThodiaUni`;return}if(k&&String(k.id)===r){const Se=e==="en"&&k.name?k.name:k.nameVi;document.title=`${Se} | ThodiaUni`}},[r,e]),P.useEffect(()=>{if(!navigator.geolocation)return;const ue=navigator.geolocation.watchPosition(Se=>{const be={lat:Se.coords.latitude,lng:Se.coords.longitude};m(be),v.current=be},Se=>console.warn("Li GPS:",Se),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0});return()=>navigator.geolocation.clearWatch(ue)},[]);const vi=P.useCallback(ue=>{a(ue)},[]),Ps=P.useCallback(()=>{a(null)},[]),qi=P.useCallback(()=>{Ge(!0),ee(!0),Ht.info(e==="vi"?"Hy chn im n tip theo":"Select the next stop")},[e]),ki=P.useCallback((ue,Se)=>{if(ze||we){const be={coordinates:[ue.lng,ue.lat],name:e==="en"&&ue.name?ue.name:ue.nameVi,location:ue};let Oe=[...xi];if(Oe.length===0&&ot){const je={coordinates:ot,name:gt||"im dng 1"};Oe.push(je),rs(je)}if(Oe.push(be),rs(be),Ge(!1),ee(!1),ie&&(pe(!1),Cn()),ke(!0),v.current){const Be={coordinates:[v.current.lng,v.current.lat],name:e==="vi"?"V tr ca bn":"Your location"};_s(Be,Oe,ni)}return}M(ue),K(ue),Se&&z(Se),l(`/place/${ue.id}`)},[ze,we,ie,rs,xi,e,_s,ni,ot,gt,Cn,l]),yo=P.useCallback(ue=>{rn({mapboxId:String(ue.id),name:ue.nameVi||ue.name||"a im",address:ue.address,lat:ue.lat,lng:ue.lng}),vt(!0)},[]),Ks=P.useCallback(()=>{l("/"),z(null)},[l]),Ai=P.useCallback((ue,Se="walking")=>{l("/"),z(null),ke(!1),Vr();const be=[ue.lng,ue.lat];if(ut(be),v.current){const Oe=[v.current.lng,v.current.lat];Pe(Oe),fn(Oe,be,Se),pe(!0)}else Ht.info(e==="vi"?"ang ly v tr...":"Locating..."),navigator.geolocation.getCurrentPosition(Oe=>{const Be=[Oe.coords.longitude,Oe.coords.latitude];Pe(Be),fn(Be,be,Se),pe(!0)})},[fn,e,Vr,l]),ss=P.useCallback(ue=>{const Se=e==="en"&&ue.name?ue.name:ue.nameVi;ht(Se),Ai(ue)},[Ai,e]),ri=P.useCallback(()=>{Cn(),Pe(null),ut(null),pe(!1),ke(!1),Vr()},[Cn,Vr]),Rs=P.useCallback(ue=>{Z(Se=>Se.includes(ue)?Se.filter(be=>be!==ue):[...Se,ue])},[]),{currentStepIndex:Ys,distanceToNextStep:_o,isTracking:Te}=LJ({steps:Kt?.steps||[],routeGeometry:Kt?.geometry||null,isNavigating:ie,userLocation:u,onOffRoute:()=>{if(v.current&&Er){Ht.warning(t("offRouteWarning"));const ue=[v.current.lng,v.current.lat];Pe(ue),fn(ue,Er,tn,hr)}}}),ne=P.useCallback(()=>{Ge(!0),Ht.info(e==="vi"?"Chn im dng tip theo trn bn ":"Select next stop on the map")},[e]),re=P.useCallback(ue=>{Fe(!0)},[]);return x.jsxs("div",{className:"relative h-screen w-full overflow-hidden bg-background",children:[x.jsx("div",{className:"absolute inset-0",children:x.jsx(sq,{selectedLocation:k,onSelectLocation:ki,activeCategories:H,flyToLocation:O,routeInfo:Kt,routeOrigin:tt,routeDestination:ot,onClearRoute:ri,multiStopRoute:Xs,isMultiStopMode:we})}),x.jsx("div",{className:"absolute inset-x-0 top-0 h-40 bg-gradient-to-b from-background/80 via-background/40 to-transparent pointer-events-none"}),x.jsx("div",{className:"absolute top-0 left-0 right-0 safe-top z-[50]",children:x.jsxs("div",{className:"px-3 pt-3",children:[x.jsxs(yr.div,{className:"flex items-center gap-2 mb-2",initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{delay:.1},children:[x.jsx(RJ,{children:x.jsxs("div",{className:"flex flex-col items-center justify-center cursor-pointer mr-2 group",children:[x.jsx("div",{className:"w-12 h-12 bg-white rounded-xl shadow-lg flex items-center justify-center overflow-hidden border-2 border-green-700 group-hover:scale-105 transition-transform z-10",children:x.jsx("img",{src:"/logo.png",alt:"ThodiaUni Logo",className:"w-full h-full object-cover"})}),x.jsx("span",{className:"text-[9px] font-black text-white bg-green-700 px-2 py-[1px] rounded-sm -mt-2 z-20 shadow-sm tracking-wider border border-white uppercase",children:"Menu"})]})}),x.jsx("div",{className:"flex-1 min-w-0",children:x.jsx(aq,{onLocationSelect:ki,userLocation:u,onFocus:()=>ee(!0),onBlur:()=>ee(!1)})}),x.jsxs("button",{onClick:()=>Ae(!0),className:"relative w-9 h-9 rounded-xl bg-muted flex items-center justify-center hover:bg-muted/80 transition-colors shadow-sm",children:[x.jsx(Ff,{className:"w-5 h-5 text-muted-foreground"}),wt.length>0&&x.jsx("span",{className:"absolute -top-1 -right-1 w-5 h-5 bg-red-500 text-white text-xs font-bold rounded-full flex items-center justify-center",children:wt.length>9?"9+":wt.length})]}),x.jsx(TJ,{onLoginClick:()=>mt(!0),onFavoritesClick:()=>Ae(!0),onStoresClick:()=>We(!0)}),x.jsx(SJ,{compact:!0})]}),x.jsx(Ta,{children:!Y&&!ie&&!we&&x.jsx(yr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},transition:{delay:.2},className:"ml-2",children:x.jsx(lq,{activeCategories:H,onToggleCategory:Rs})})})]})}),x.jsx(Ta,{children:we&&x.jsx(mK,{routeInfo:Xs,waypoints:xi,isLoading:Zr,transportMode:ni,onClose:ri,onChangeTransportMode:ue=>{if(is(ue),v.current){const Se={coordinates:[v.current.lng,v.current.lat],name:"Your location"};_s(Se,xi,ue)}},onRemoveWaypoint:ue=>{Wi(ue);const Se=xi.filter((be,Oe)=>Oe!==ue);if(Se.length===0)ri();else if(v.current){const be={coordinates:[v.current.lng,v.current.lat],name:"Your location"};_s(be,Se,ni)}},onReorderWaypoints:Ms,onAddStop:ne,isAddingStop:ze})}),x.jsx(Ta,{children:ie&&Kt&&!we&&x.jsx(fK,{routeInfo:Kt,destinationName:gt,isLoading:Tn,transportMode:tn,routePreference:hr,currentStepIndex:Ys,distanceToNextStep:_o,isTracking:Te,userAccuracy:null,onClose:ri,onChangeTransportMode:ue=>{mr(ue),Xn&&Er&&fn(Xn,Er,ue,hr)},onChangeRoutePreference:ue=>{_i(ue),Xn&&Er&&fn(Xn,Er,tn,ue)},onAddStop:qi})}),x.jsx(Ta,{children:k&&!we&&x.jsx(uK,{location:k,department:L,onClose:Ks,onNavigate:ss,onOpenDetail:vi,onLoginClick:()=>mt(!0),onPromoteClick:re,onClaim:yo})}),x.jsx(Ta,{children:b&&x.jsx(aS,{location:b,isOpen:!!b,onClose:Ps,onNavigate:()=>ss(b)})}),x.jsx(CJ,{isOpen:it,onClose:()=>vt(!1),data:Wt}),x.jsx(GK,{isOpen:Lt,onClose:()=>mt(!1)}),x.jsx(HK,{isOpen:pt,onClose:()=>Ae(!1),onSelectLocation:ki,onNavigate:ss,onLoginClick:()=>{Ae(!1),mt(!0)}}),x.jsx(tY,{isOpen:xe,onClose:()=>We(!1),onLoginClick:()=>{We(!1),mt(!0)}}),!ie&&x.jsx(ZW,{onSelectLocation:ki,userLocation:u})]})},bx="https://thodia-backend-1067502227654.asia-southeast1.run.app",jJ=()=>{const{user:t}=Oo(),[e,r]=P.useState([]),[l,u]=P.useState(!0),[m,v]=P.useState(!1),[b,a]=P.useState("pending"),k=P.useCallback(async()=>{if(!t)return v(!1),!1;try{const H=(await(await fetch(`${bx}/api/admin/check?userId=${t.uid}`)).json()).isAdmin===!0;return v(H),H}catch(O){return console.error("Li kim tra admin:",O),v(!1),!1}},[t]),M=P.useCallback(async()=>{if(!t){r([]),u(!1);return}try{const K=await(await fetch(`${bx}/api/admin/stores?status=${b}`)).json();if(Array.isArray(K))r(K);else throw new Error("Invalid data format")}catch(O){console.error("Li ti danh sch ca hng:",O),Ht.error("Khng th ti danh sch ca hng")}finally{u(!1)}},[t,b]);return P.useEffect(()=>{(async()=>await k()?await M():u(!1))()},[k,M]),{stores:e,isLoading:l,isAdmin:m,filter:b,setFilter:a,fetchStores:M,updateStoreStatus:async(O,K)=>{try{if(!(await fetch(`${bx}/api/admin/stores/${O}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:K})})).ok)throw new Error("Failed to update");r(Z=>Z.map(Y=>Y.id===O?{...Y,status:K}:Y)),b==="pending"&&r(Z=>Z.filter(Y=>Y.id!==O)),Ht.success(K==="approved"?" duyt xong!":" t chi!")}catch(H){console.error("Li Update:",H),Ht.error("Li kt ni server")}},deleteStore:async O=>{try{if(!(await fetch(`${bx}/api/stores/${O}`,{method:"DELETE"})).ok)throw new Error("Failed to delete");return r(H=>H.filter(Z=>Z.id!==O)),Ht.success(" xa ca hng!"),!0}catch(K){return console.error("Error deleting store:",K),Ht.error("Khng th xa ca hng"),!1}}}},OJ=Ky("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function qy({className:t,variant:e,...r}){return x.jsx("div",{className:ln(OJ({variant:e}),t),...r})}const gm=P.forwardRef(({className:t,...e},r)=>x.jsx("div",{ref:r,className:ln("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));gm.displayName="Card";const hy=P.forwardRef(({className:t,...e},r)=>x.jsx("div",{ref:r,className:ln("flex flex-col space-y-1.5 p-6",t),...e}));hy.displayName="CardHeader";const fy=P.forwardRef(({className:t,...e},r)=>x.jsx("h3",{ref:r,className:ln("text-2xl font-semibold leading-none tracking-tight",t),...e}));fy.displayName="CardTitle";const py=P.forwardRef(({className:t,...e},r)=>x.jsx("p",{ref:r,className:ln("text-sm text-muted-foreground",t),...e}));py.displayName="CardDescription";const ym=P.forwardRef(({className:t,...e},r)=>x.jsx("div",{ref:r,className:ln("p-6 pt-0",t),...e}));ym.displayName="CardContent";const zJ=P.forwardRef(({className:t,...e},r)=>x.jsx("div",{ref:r,className:ln("flex items-center p-6 pt-0",t),...e}));zJ.displayName="CardFooter";const ow="https://thodia-backend-1067502227654.asia-southeast1.run.app",BJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),[u,m]=P.useState(null),v=async()=>{l(!0);try{const M=await(await fetch(`${ow}/api/admin/claims`)).json();Array.isArray(M)?e(M):Ht.error("Li d liu t server")}catch(k){console.error(k),Ht.error("Khng ti c danh sch yu cu")}finally{l(!1)}};P.useEffect(()=>{v()},[]);const b=async k=>{let M=`Xc nhn duyt quyn s hu cho "${k.mapbox_name}"?`;if(k.existingStore&&(M=` CNH BO QUAN TRNG!

a im ny ang thuc s hu ca: ${k.existingStore.owner_email}

Bn c chc chn mun CHUYN QUYN S HU sang cho: ${k.profiles?.email}?`),!!confirm(M))try{if(Ht.loading("ang x l..."),!(await fetch(`${ow}/api/admin/claims/approve`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:k.id,mapboxId:k.mapbox_id,userId:k.user_id,mapboxName:k.mapbox_name,mapboxAddress:k.mapbox_address,lat:k.lat,lng:k.lng,role:k.role,phone:k.phone,proofImageUrl:k.proof_image_url})})).ok)throw new Error("Server error");Ht.dismiss(),Ht.success("Duyt thnh cng!"),v()}catch(L){Ht.dismiss(),Ht.error("Li khi duyt: "+L.message)}},a=async k=>{if(confirm("T chi yu cu ny?"))try{if(!(await fetch(`${ow}/api/admin/claims/reject`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({claimId:k})})).ok)throw new Error("Failed");Ht.success(" t chi."),v()}catch{Ht.error("Li khi t chi")}};return r?x.jsx("div",{className:"p-12 flex justify-center",children:x.jsx(Fi,{className:"animate-spin text-blue-600 w-8 h-8"})}):x.jsxs("div",{className:"space-y-8",children:[x.jsx("div",{className:"flex items-center justify-between",children:x.jsxs("h2",{className:"text-xl font-bold text-gray-800 flex items-center gap-2",children:[x.jsx(fO,{className:"text-blue-600"}),"Duyt xc minh ch s hu (",t.length,")"]})}),t.length===0?x.jsx("div",{className:"p-12 text-center bg-gray-50 rounded-xl border border-dashed text-gray-400",children:"Hin khng c yu cu no ang ch x l."}):x.jsx("div",{className:"grid gap-8",children:t.map(k=>x.jsxs("div",{className:"bg-white border rounded-xl shadow-sm overflow-hidden",children:[x.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-b flex justify-between items-start",children:[x.jsxs("div",{children:[x.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[x.jsx(Vi,{className:"text-blue-600 w-5 h-5"})," ",k.mapbox_name]}),x.jsx("p",{className:"text-sm text-gray-500 ml-7",children:k.mapbox_address})]}),x.jsx(qy,{className:"bg-yellow-100 text-yellow-800 hover:bg-yellow-100 border-yellow-200",children:"Pending"})]}),x.jsxs("div",{className:"p-6",children:[x.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6",children:[x.jsxs("div",{className:`flex-1 p-4 rounded-lg border-2 ${k.existingStore?"bg-orange-50 border-orange-200":"bg-gray-50 border-dashed border-gray-200"}`,children:[x.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-3 text-gray-500",children:k.existingStore?" CH S HU HIN TI":"TNH TRNG: CHA C CH"}),k.existingStore?x.jsxs("div",{className:"space-y-2",children:[x.jsxs("div",{className:"flex items-center gap-2 text-gray-800 font-bold",children:[x.jsx(Cy,{size:16})," ",k.existingStore.owner_email]}),x.jsxs("div",{className:"text-sm text-gray-600 pl-6",children:["Tn qun: ",k.existingStore.name_vi]}),k.existingStore.is_verified&&x.jsx(qy,{className:"bg-green-100 text-green-700 border-green-200 ml-6",children:" xc minh"})]}):x.jsxs("div",{className:"flex items-center gap-2 text-gray-400 py-2",children:[x.jsx(Vc,{size:20})," y l a im mi"]})]}),x.jsx("div",{className:"flex items-center justify-center",children:x.jsx("div",{className:"bg-blue-50 p-2 rounded-full text-blue-400",children:x.jsx(Sb,{size:24})})}),x.jsxs("div",{className:"flex-1 p-4 rounded-lg border-2 border-blue-200 bg-blue-50/30",children:[x.jsx("p",{className:"text-xs font-bold uppercase tracking-wider mb-3 text-blue-600",children:"NGI YU CU (CH MI)"}),x.jsxs("div",{className:"space-y-2 text-sm",children:[x.jsxs("div",{className:"flex items-center gap-2 font-bold text-gray-900",children:[x.jsx(Cy,{size:16,className:"text-blue-500"})," ",k.profiles?.email||"Unknown User"]}),x.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1 pl-6 mt-2",children:[x.jsxs("div",{className:"text-gray-600",children:[x.jsx("span",{className:"font-semibold",children:"Vai tr:"})," ",k.role]}),x.jsxs("div",{className:"text-gray-600",children:[x.jsx("span",{className:"font-semibold",children:"ST:"})," ",k.phone||"---"]}),x.jsxs("div",{className:"text-gray-600 col-span-2",children:[x.jsx("span",{className:"font-semibold",children:"Email LH:"})," ",k.email||"---"]})]}),x.jsxs("div",{className:"mt-3 bg-white p-2.5 rounded border border-blue-100 text-gray-600 italic text-xs",children:['"Li nhn: ',k.message||"Khng c",'"']})]})]})]}),x.jsxs("div",{className:"border-t pt-4",children:[x.jsxs("p",{className:"text-xs font-bold text-gray-500 uppercase mb-3",children:["NH BNG CHNG (",k.proof_images?.length||(k.proof_image_url?1:0),")"]}),x.jsxs("div",{className:"flex gap-3 overflow-x-auto pb-2",children:[k.proof_images&&k.proof_images.length>0?k.proof_images.map((M,L)=>x.jsxs("div",{className:"w-24 h-24 flex-shrink-0 border rounded-lg overflow-hidden cursor-pointer hover:ring-2 ring-blue-500 relative bg-gray-100 group",onClick:()=>m(M),children:[x.jsx("img",{src:M,className:"w-full h-full object-cover",loading:"lazy",onError:z=>z.currentTarget.style.display="none"}),x.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-gray-300",children:x.jsx(IO,{size:20})}),x.jsx("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors flex items-center justify-center",children:x.jsx(MO,{className:"text-white opacity-0 group-hover:opacity-100 w-5 h-5 drop-shadow-md"})})]},L)):k.proof_image_url&&x.jsx("div",{className:"w-24 h-24 flex-shrink-0 border rounded-lg overflow-hidden cursor-pointer bg-gray-100",onClick:()=>m(k.proof_image_url),children:x.jsx("img",{src:k.proof_image_url,className:"w-full h-full object-cover"})}),!k.proof_images?.length&&!k.proof_image_url&&x.jsx("span",{className:"text-sm text-red-400 italic bg-red-50 px-3 py-1 rounded",children:"Ngi dng khng ti ln nh no."})]})]})]}),x.jsxs("div",{className:"bg-gray-50 px-6 py-4 border-t flex justify-end gap-3",children:[x.jsxs(_n,{variant:"outline",onClick:()=>a(k.id),className:"text-red-600 border-red-200 hover:bg-red-50",children:[x.jsx(ti,{className:"w-4 h-4 mr-2"})," T chi"]}),x.jsxs(_n,{onClick:()=>b(k),className:"bg-green-600 hover:bg-green-700 text-white shadow-sm min-w-[140px]",children:[x.jsx(np,{className:"w-4 h-4 mr-2"}),k.existingStore?"Chuyn quyn s hu":"Duyt & To mi"]})]})]},k.id))}),u&&x.jsx("div",{className:"fixed inset-0 z-[9999] bg-black/95 flex items-center justify-center p-4 animate-in fade-in duration-200",onClick:()=>m(null),children:x.jsxs("div",{className:"relative max-w-5xl w-full max-h-screen flex items-center justify-center p-2",children:[x.jsx("img",{src:u,alt:"Full Proof",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl border border-gray-700"}),x.jsx("button",{onClick:()=>m(null),className:"absolute top-4 right-4 bg-white/20 hover:bg-white/40 text-white p-2 rounded-full backdrop-blur-sm transition-all",children:x.jsx(ti,{size:32})})]})})]})},Gf="https://thodia-backend-1067502227654.asia-southeast1.run.app",FJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),u=async()=>{l(!0);try{const b=await(await fetch(`${Gf}/api/admin/ads`)).json();Array.isArray(b)&&e(b)}catch(v){console.error(v),Ht.error("Li ti qung co")}finally{l(!1)}};P.useEffect(()=>{u()},[]);const m=async v=>{if(confirm("Hy qung co ny?"))try{await fetch(`${Gf}/api/admin/ads/cancel/${v}`,{method:"PUT"}),Ht.success(" hy qung co"),e(b=>b.filter(a=>a.id!==v))}catch{Ht.error("Li khi hy")}};return x.jsxs("div",{className:"space-y-4",children:[r?x.jsx("div",{className:"flex justify-center p-8",children:x.jsx("div",{className:"animate-spin w-6 h-6 border-2 border-blue-600 rounded-full border-t-transparent"})}):t.length===0?x.jsx("div",{className:"text-gray-500 text-center py-12 bg-gray-50 rounded-xl border border-dashed",children:"Hin khng c ca hng no chy qung co."}):null,x.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:t.map(v=>{const b=new Date(v.ad_expiry),a=new Date,k=Math.ceil((b.getTime()-a.getTime())/(1e3*60*60*24)),M=k<0;return x.jsxs("div",{className:"bg-white border rounded-xl overflow-hidden shadow-sm flex flex-col hover:shadow-md transition-shadow",children:[x.jsxs("div",{className:"h-32 bg-gray-100 relative group",children:[x.jsx("img",{src:v.image_url,className:"w-full h-full object-cover",onError:L=>L.currentTarget.src="https://placehold.co/400x200"}),x.jsxs("div",{className:"absolute top-2 right-2 bg-gradient-to-r from-pink-500 to-red-500 text-white text-[10px] font-bold px-2 py-1 rounded shadow-md flex items-center gap-1",children:[x.jsx(zx,{size:12})," ang chy"]})]}),x.jsxs("div",{className:"p-4 flex-1 flex flex-col",children:[x.jsx("h4",{className:"font-bold text-gray-800 text-lg mb-1 line-clamp-1",children:v.name_vi}),x.jsxs("p",{className:"text-xs text-gray-500 mb-4 truncate flex items-center gap-1",children:[x.jsx(kM,{size:12})," ",v.user_email]}),x.jsxs("div",{className:"mt-auto space-y-3",children:[x.jsxs("div",{className:"flex items-center justify-between text-sm bg-blue-50 p-2 rounded text-blue-800 border border-blue-100",children:[x.jsxs("span",{className:"flex items-center gap-1 text-xs",children:[x.jsx(pO,{className:"w-3 h-3"})," Ht hn:"]}),x.jsx("span",{className:"font-bold",children:b.toLocaleDateString("vi-VN")})]}),x.jsx("div",{className:`text-center text-xs font-bold ${M?"text-red-500":"text-green-600"}`,children:M?" ht hn":`Cn li ${k} ngy`}),x.jsxs(_n,{variant:"outline",className:"w-full text-red-600 border-red-200 hover:bg-red-50 h-8 text-xs",onClick:()=>m(v.id),children:[x.jsx(ti,{className:"w-3 h-3 mr-2"})," Dng Qung Co"]})]})]})]},v.id)})})]})},VJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0),u=async()=>{l(!0);try{const a=await(await fetch(`${Gf}/api/admin/jobs`)).json();Array.isArray(a)&&e(a)}catch{Ht.error("Li ti tin tuyn dng")}finally{l(!1)}};P.useEffect(()=>{u()},[]);const m=async b=>{if(confirm("Xa tin ny?"))try{await fetch(`${Gf}/api/admin/jobs/${b}`,{method:"DELETE"}),e(a=>a.filter(k=>k.id!==b)),Ht.success(" xa")}catch{Ht.error("Li xa")}},v=async(b,a)=>{try{await fetch(`${Gf}/api/admin/jobs/${b}/status`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})}),e(k=>k.map(M=>M.id===b?{...M,status:a}:M)),Ht.success(` cp nht: ${a}`)}catch{Ht.error("Li cp nht")}};return x.jsxs("div",{className:"space-y-4",children:[t.length===0&&x.jsx("p",{className:"text-gray-500 text-center py-8",children:"Cha c tin tuyn dng no."}),t.map(b=>x.jsxs("div",{className:"bg-white p-4 rounded-lg border flex flex-col md:flex-row justify-between gap-4 shadow-sm hover:shadow-md transition-shadow",children:[x.jsxs("div",{className:"flex-1",children:[x.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x.jsx("h4",{className:"font-bold text-gray-800 text-lg",children:b.title}),x.jsx(qy,{className:b.status==="approved"?"bg-green-100 text-green-700":b.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700",children:b.status==="approved"?" duyt":b.status==="rejected"?"T chi":"Ch duyt"})]}),x.jsxs("p",{className:"text-sm font-semibold text-gray-700",children:[b.shop_name," ",x.jsx("span",{className:"text-gray-400",children:"|"})," ",b.salary]}),x.jsx("p",{className:"text-xs text-gray-500 mt-1 line-clamp-1",children:b.description}),x.jsxs("p",{className:"text-[10px] text-gray-400 mt-2",children:["Ngy ng: ",new Date(b.created_at).toLocaleDateString("vi-VN")]})]}),x.jsxs("div",{className:"flex items-center gap-2 border-t md:border-t-0 md:border-l pt-3 md:pt-0 md:pl-4",children:[b.status==="pending"&&x.jsxs(x.Fragment,{children:[x.jsxs(_n,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>v(b.id,"approved"),children:[x.jsx(np,{className:"w-4 h-4 mr-1"})," Duyt"]}),x.jsxs(_n,{size:"sm",variant:"outline",className:"border-red-200 text-red-600 hover:bg-red-50",onClick:()=>v(b.id,"rejected"),children:[x.jsx(ti,{className:"w-4 h-4 mr-1"})," B"]})]}),x.jsx(_n,{size:"icon",variant:"ghost",className:"text-red-500 hover:bg-red-50",onClick:()=>m(b.id),children:x.jsx(ah,{className:"w-4 h-4"})})]})]},b.id))]})},UJ=()=>{const[t,e]=P.useState([]),[r,l]=P.useState(!0);P.useEffect(()=>{(async()=>{l(!0);try{const b=await(await fetch(`${Gf}/api/admin/users`)).json();Array.isArray(b)&&e(b)}catch{console.error("Li ti users")}finally{l(!1)}})()},[]);const u=async m=>{if(confirm("Cnh bo: Xa user s mt ht d liu lin quan!"))try{await fetch(`${Gf}/api/admin/users/${m}`,{method:"DELETE"}),e(v=>v.filter(b=>b.id!==m)),Ht.success(" xa h s")}catch{Ht.error("Li xa user")}};return r?x.jsx("div",{className:"p-8 text-center text-gray-500",children:"ang ti danh sch ngi dng..."}):x.jsx("div",{className:"bg-white rounded-lg border overflow-hidden shadow-sm",children:x.jsx("div",{className:"overflow-x-auto",children:x.jsxs("table",{className:"w-full text-sm text-left",children:[x.jsx("thead",{className:"bg-gray-50 border-b",children:x.jsxs("tr",{children:[x.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"User / Email"}),x.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"Trng thi"}),x.jsx("th",{className:"p-4 text-gray-600 font-bold",children:"Ngy tham gia"}),x.jsx("th",{className:"p-4 text-right text-gray-600 font-bold",children:"Hnh ng"})]})}),x.jsx("tbody",{className:"divide-y",children:t.map(m=>x.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[x.jsxs("td",{className:"p-4",children:[x.jsxs("div",{className:"font-bold text-gray-900 flex items-center gap-2",children:[m.email,m.isVip&&x.jsxs("span",{className:"bg-yellow-100 text-yellow-700 text-[10px] px-1.5 py-0.5 rounded border border-yellow-200 flex items-center gap-1 shadow-sm",children:[x.jsx(nl,{className:"w-3 h-3 fill-yellow-600"})," VIP"]})]}),x.jsx("div",{className:"text-xs text-gray-500",children:m.username||"Cha t tn"}),x.jsx("div",{className:"text-[10px] text-gray-400 font-mono mt-0.5",children:m.id})]}),x.jsx("td",{className:"p-4",children:x.jsx(qy,{variant:"outline",className:m.isVip?"border-yellow-500 text-yellow-700 bg-yellow-50":"text-gray-500",children:m.isVip?"Premium User":"Thnh vin"})}),x.jsx("td",{className:"p-4 text-gray-500",children:new Date(m.created_at).toLocaleDateString("vi-VN")}),x.jsx("td",{className:"p-4 text-right",children:x.jsx(_n,{size:"sm",variant:"ghost",className:"text-red-600 hover:bg-red-50 hover:text-red-700",onClick:()=>u(m.id),children:x.jsx(ah,{className:"w-4 h-4"})})})]},m.id))})]})})})},$J=()=>{const{stores:t,isLoading:e,isAdmin:r,setFilter:l,updateStoreStatus:u,deleteStore:m}=jJ(),{signOut:v}=Oo(),b=ip(),[a,k]=P.useState(null),[M,L]=P.useState(!1);P.useEffect(()=>{!e&&!r&&b("/")},[r,e,b]);const z=async H=>await u(H,"approved"),O=async H=>await u(H,"rejected"),K=H=>{k(H),L(!0)};return e?x.jsx("div",{className:"flex items-center justify-center min-h-screen",children:x.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-green-600 border-t-transparent rounded-full"})}):r?x.jsx("div",{className:"min-h-screen bg-gray-50 p-4 md:p-8 font-sans text-gray-900",children:x.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[x.jsxs("div",{className:"flex justify-between items-center bg-white p-6 rounded-xl shadow-sm border",children:[x.jsxs("div",{className:"flex items-center gap-4",children:[x.jsx(_n,{variant:"ghost",size:"icon",onClick:()=>b("/"),children:x.jsx(Sv,{className:"w-5 h-5"})}),x.jsxs("div",{children:[x.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Admin Dashboard"}),x.jsx("p",{className:"text-muted-foreground text-sm",children:"H thng qun l ThodiaUni"})]})]}),x.jsxs(_n,{variant:"destructive",onClick:()=>v(),className:"shadow-red-200 shadow-lg",children:[x.jsx(dw,{className:"w-4 h-4 mr-2"}),"ng xut"]})]}),x.jsxs(uv,{defaultValue:"stores",className:"w-full",children:[x.jsxs(Vy,{className:"grid w-full grid-cols-5 mb-8 h-12 bg-white border shadow-sm rounded-lg p-1",children:[x.jsxs(qs,{value:"stores",className:"text-sm font-medium data-[state=active]:bg-green-50 data-[state=active]:text-green-700",children:[x.jsx(Vc,{className:"w-4 h-4 mr-2"})," Ca hng"]}),x.jsxs(qs,{value:"ads",className:"text-sm font-medium data-[state=active]:bg-pink-50 data-[state=active]:text-pink-700",children:[x.jsx(zx,{className:"w-4 h-4 mr-2"})," Qung co"]}),x.jsxs(qs,{value:"jobs",className:"text-sm font-medium data-[state=active]:bg-blue-50 data-[state=active]:text-blue-700",children:[x.jsx(oh,{className:"w-4 h-4 mr-2"})," Tuyn dng"]}),x.jsxs(qs,{value:"users",className:"text-sm font-medium data-[state=active]:bg-purple-50 data-[state=active]:text-purple-700",children:[x.jsx(kM,{className:"w-4 h-4 mr-2"})," Ngi dng"]}),x.jsxs(qs,{value:"claims",className:"text-sm font-medium data-[state=active]:bg-orange-50 data-[state=active]:text-orange-700",children:[x.jsx(LO,{className:"w-4 h-4 mr-2"})," Xc minh"]})]}),x.jsx(Sa,{value:"stores",children:x.jsxs(gm,{className:"border-none shadow-md",children:[x.jsxs(hy,{children:[x.jsx(fy,{children:"Danh sch ca hng"}),x.jsxs(py,{children:["Hin c ",t.length," ca hng trong h thng."]})]}),x.jsx(ym,{children:x.jsxs(uv,{defaultValue:"pending",className:"w-full",onValueChange:H=>l(H),children:[x.jsxs(Vy,{className:"mb-6 bg-gray-100 w-full justify-start overflow-x-auto",children:[x.jsx(qs,{value:"pending",children:"Ch duyt"}),x.jsx(qs,{value:"approved",children:" duyt"}),x.jsx(qs,{value:"rejected",children:"T chi"}),x.jsx(qs,{value:"all",children:"Tt c"})]}),x.jsx("div",{className:"grid gap-4",children:t.length===0?x.jsx("p",{className:"text-center py-12 text-muted-foreground",children:"Khng c d liu"}):t.map(H=>x.jsxs("div",{className:"flex flex-col md:flex-row gap-4 bg-white border rounded-xl p-4 hover:shadow-md transition-all",children:[x.jsxs("div",{className:"w-full md:w-32 h-32 bg-gray-100 rounded-lg overflow-hidden flex-shrink-0 relative",children:[x.jsx("img",{src:H.image_url||"https://placehold.co/400x400?text=Store",className:"w-full h-full object-cover",onError:Z=>{Z.currentTarget.src="https://placehold.co/400x400?text=No+Image"}}),H.is_premium&&x.jsxs("span",{className:"absolute top-2 right-2 bg-yellow-400 text-yellow-900 text-[10px] font-bold px-1.5 rounded flex items-center gap-1 shadow-sm",children:[x.jsx(nl,{className:"w-3 h-3 fill-current"})," VIP"]})]}),x.jsxs("div",{className:"flex-1 space-y-2",children:[x.jsxs("div",{className:"flex justify-between items-start",children:[x.jsx("h3",{className:"font-bold text-lg text-gray-800",children:H.name_vi}),x.jsx(qy,{className:H.status==="approved"?"bg-green-100 text-green-700":H.status==="rejected"?"bg-red-100 text-red-700":"bg-yellow-100 text-yellow-700",children:H.status==="approved"?"Hot ng":H.status==="rejected"?" kha":"Ch duyt"})]}),x.jsxs("p",{className:"text-sm text-gray-600 flex gap-2",children:[x.jsx(Vi,{className:"w-4 h-4 text-gray-400"})," ",H.address_vi]}),x.jsxs("p",{className:"text-xs text-gray-400",children:["Owner: ",H.user_email]})]}),x.jsxs("div",{className:"flex flex-col gap-2 justify-center border-t md:border-t-0 md:border-l pt-4 md:pt-0 md:pl-4 min-w-[140px]",children:[x.jsxs(_n,{variant:"outline",size:"sm",onClick:()=>K(H),children:[x.jsx(TO,{className:"w-4 h-4 mr-2"})," Chi tit"]}),H.status==="pending"&&x.jsxs(x.Fragment,{children:[x.jsxs(_n,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:()=>z(H.id),children:[x.jsx(np,{className:"w-4 h-4 mr-2"})," Duyt"]}),x.jsxs(_n,{size:"sm",variant:"destructive",onClick:()=>O(H.id),children:[x.jsx(ti,{className:"w-4 h-4 mr-2"})," T chi"]})]}),H.status!=="pending"&&x.jsxs(_n,{size:"sm",variant:"ghost",onClick:()=>m(H.id),className:"text-red-600 hover:bg-red-50",children:[x.jsx(dw,{className:"w-4 h-4 mr-2"})," Xa"]})]})]},H.id))})]})})]})}),x.jsx(Sa,{value:"ads",children:x.jsxs(gm,{className:"border-none shadow-md",children:[x.jsxs(hy,{children:[x.jsx(fy,{children:"Qung co ang chy"}),x.jsx(py,{children:"Qun l cc chin dch qung co ca ca hng."})]}),x.jsx(ym,{children:x.jsx(FJ,{})})]})}),x.jsx(Sa,{value:"jobs",children:x.jsxs(gm,{className:"border-none shadow-md",children:[x.jsxs(hy,{children:[x.jsx(fy,{children:"Tin tuyn dng"}),x.jsx(py,{children:"Duyt v qun l cc bi ng tm vic lm."})]}),x.jsx(ym,{children:x.jsx(VJ,{})})]})}),x.jsx(Sa,{value:"users",children:x.jsxs(gm,{className:"border-none shadow-md",children:[x.jsxs(hy,{children:[x.jsx(fy,{children:"Danh sch ngi dng"}),x.jsx(py,{children:"Qun l ti khon trong h thng."})]}),x.jsx(ym,{children:x.jsx(UJ,{})})]})}),x.jsx(Sa,{value:"claims",children:x.jsx(gm,{className:"border-none shadow-md",children:x.jsx(ym,{className:"pt-6",children:x.jsx(BJ,{})})})})]}),x.jsx(aS,{isOpen:M,onClose:()=>L(!1),location:a})]})}):null},GJ=()=>{const t=zv();return P.useEffect(()=>{console.error("404 Error: User attempted to access non-existent route:",t.pathname)},[t.pathname]),x.jsx("div",{className:"flex min-h-screen items-center justify-center bg-muted",children:x.jsxs("div",{className:"text-center",children:[x.jsx("h1",{className:"mb-4 text-4xl font-bold",children:"404"}),x.jsx("p",{className:"mb-4 text-xl text-muted-foreground",children:"Oops! Page not found"}),x.jsx("a",{href:"/",className:"text-primary underline hover:text-primary/90",children:"Return to Home"})]})})},VI="https://thodia-backend-1067502227654.asia-southeast1.run.app",HJ=()=>{const t=ip(),{user:e}=Oo(),[r,l]=P.useState(!1),[u,m]=P.useState("Tt c"),[v,b]=P.useState(null),[a,k]=P.useState([]),[M,L]=P.useState(!0),[z,O]=P.useState(!1);P.useEffect(()=>{(async()=>{L(!0);try{const ee=await(await fetch(`${VI}/api/jobs/approved`)).json();Array.isArray(ee)?k(ee):Ht.error("Li d liu t server")}catch(Y){console.error("Li ly tin:",Y),Ht.error("Khng ti c danh sch vic lm.")}finally{L(!1)}})()},[]);const K=async Z=>{if(Z.preventDefault(),!e){Ht.error("Vui lng ng nhp  ng tin!");return}O(!0);const Y=new FormData(Z.target),ee={title:Y.get("title"),shop_name:Y.get("shopName"),address:Y.get("address"),phone:Y.get("phone"),salary:Y.get("salary"),type:Y.get("type"),description:Y.get("description"),user_id:e.uid};try{if(!(await fetch(`${VI}/api/jobs`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(ee)})).ok)throw new Error("Failed to post job");Ht.success("ng tin thnh cng! Tin ca bn ang ch Admin duyt."),l(!1)}catch{Ht.error("Li ng tin, vui lng th li.")}finally{O(!1)}},H=Z=>{b(v===Z?null:Z)};return x.jsxs("div",{className:"min-h-screen bg-gray-50 pb-24 font-sans text-gray-800",children:[x.jsxs("div",{className:"bg-white sticky top-0 z-40 border-b shadow-sm",children:[x.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[x.jsxs("div",{className:"flex items-center gap-3",children:[x.jsx(_n,{variant:"ghost",size:"icon",onClick:()=>t("/"),className:"-ml-2 hover:bg-gray-100 rounded-full",children:x.jsx(Sv,{className:"w-5 h-5 text-gray-600"})}),x.jsxs("div",{children:[x.jsx("h1",{className:"font-bold text-lg text-gray-800 leading-none",children:"Vic lm"}),x.jsx("span",{className:"text-[10px] text-gray-500 font-medium",children:"C hi cho sinh vin"})]})]}),x.jsxs(_n,{onClick:()=>{e?l(!0):Ht.error("Bn cn ng nhp  ng tin")},className:"bg-green-600 hover:bg-green-700 text-white gap-1.5 h-9 px-4 text-xs font-bold rounded-full shadow-lg shadow-green-200 active:scale-95 transition-all",children:[x.jsx(yO,{className:"w-4 h-4"}),"ng tin Free"]})]}),x.jsxs("div",{className:"px-4 pb-3 space-y-3",children:[x.jsxs("div",{className:"relative group",children:[x.jsx(Cv,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-400 group-focus-within:text-green-600 transition-colors"}),x.jsx(di,{placeholder:"Tm vic (phc v, pha ch...)",className:"pl-9 bg-gray-100 border-transparent h-10 text-sm focus-visible:ring-1 focus-visible:ring-green-500 transition-all"})]}),x.jsx("div",{className:"flex gap-2 overflow-x-auto pb-1 no-scrollbar",style:{scrollbarWidth:"none"},children:["Tt c","Part-time","Full-time","Ca ti","Gn trng"].map(Z=>x.jsx("button",{onClick:()=>m(Z),className:`px-3 py-1.5 rounded-full text-xs font-bold whitespace-nowrap transition-all border ${u===Z?"bg-green-600 text-white border-green-600 shadow-sm":"bg-white text-gray-600 border-gray-200 hover:border-green-400"}`,children:Z},Z))})]})]}),x.jsxs("div",{className:"p-4 space-y-3",children:[M?x.jsxs("div",{className:"flex flex-col items-center justify-center py-10 text-gray-400 gap-2",children:[x.jsx(Fi,{className:"w-6 h-6 animate-spin text-green-600"}),x.jsx("span",{className:"text-xs",children:"ang ti tin tuyn dng..."})]}):a.length===0?x.jsxs("div",{className:"text-center py-10 text-gray-400 text-sm bg-white rounded-xl border border-dashed",children:["Cha c tin tuyn dng no c duyt.",x.jsx("br",{}),"Hy l ngi u tin ng tin!"]}):a.map(Z=>x.jsxs(yr.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-white rounded-xl border border-gray-100 shadow-sm overflow-hidden",children:[x.jsxs("div",{className:"p-4 cursor-pointer",onClick:()=>H(Z.id),children:[x.jsxs("div",{className:"flex justify-between items-start mb-2",children:[x.jsx("h3",{className:"font-bold text-gray-900 text-base line-clamp-1",children:Z.title}),x.jsx("span",{className:"text-green-700 font-extrabold text-sm bg-green-50 px-2 py-0.5 rounded ml-2 whitespace-nowrap",children:Z.salary})]}),x.jsxs("div",{className:"flex flex-col gap-1 mb-3",children:[x.jsxs("div",{className:"flex items-center gap-1.5 text-gray-700 text-sm font-semibold",children:[x.jsx(Rm,{className:"w-3.5 h-3.5 text-blue-500"}),Z.shop_name]}),x.jsxs("div",{className:"flex items-center gap-1.5 text-gray-500 text-xs",children:[x.jsx(Vi,{className:"w-3.5 h-3.5 text-gray-400"}),Z.address]})]}),x.jsxs("div",{className:"flex flex-wrap gap-2 text-xs text-gray-500",children:[x.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded border border-gray-100",children:[x.jsx(Cb,{className:"w-3 h-3 text-orange-500"}),new Date(Z.created_at).toLocaleDateString("vi-VN")]}),x.jsxs("div",{className:"flex items-center gap-1 bg-gray-50 px-2 py-1 rounded border border-gray-100",children:[x.jsx(oh,{className:"w-3 h-3 text-purple-500"}),Z.type]})]})]}),x.jsx(Ta,{children:v===Z.id&&x.jsxs(yr.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"bg-gray-50 border-t border-gray-100 px-4 pb-4 pt-2",children:[x.jsxs("div",{className:"mb-4",children:[x.jsxs("h4",{className:"text-xs font-bold text-gray-500 uppercase mb-1 flex items-center gap-1",children:[x.jsx(EO,{className:"w-3 h-3"})," M t cng vic"]}),x.jsx("p",{className:"text-sm text-gray-700 leading-relaxed bg-white p-2 rounded border border-gray-200 whitespace-pre-line",children:Z.description})]}),x.jsx("div",{className:"flex gap-3",children:x.jsxs("a",{href:`tel:${Z.phone}`,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold py-2.5 rounded-lg flex items-center justify-center gap-2 transition-colors shadow-sm",children:[x.jsx(Ev,{className:"w-4 h-4"}),"Gi in (",Z.phone,")"]})})]})}),v!==Z.id&&x.jsx("div",{onClick:()=>H(Z.id),className:"bg-gray-50 py-1.5 text-center text-[10px] text-gray-500 font-medium border-t border-gray-100 hover:bg-gray-100 cursor-pointer transition-colors",children:" Xem chi tit & Lin h"})]},Z.id)),x.jsx("div",{className:"h-10 text-center text-xs text-gray-400",children:"Ht danh sch"})]}),r&&x.jsxs("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4",children:[x.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm transition-opacity",onClick:()=>l(!1)}),x.jsxs(yr.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},className:"bg-white rounded-2xl w-full max-w-lg shadow-2xl relative z-10 flex flex-col max-h-[85vh]",children:[x.jsxs("div",{className:"bg-green-600 p-4 rounded-t-2xl text-white flex justify-between items-center sticky top-0 z-20",children:[x.jsxs("div",{children:[x.jsxs("h2",{className:"text-lg font-bold flex items-center gap-2",children:[x.jsx(oh,{className:"w-5 h-5"}),"ng tin tuyn dng"]}),x.jsx("p",{className:"text-xs text-green-100 opacity-90",children:"Tip cn hng nghn sinh vin quanh y"})]}),x.jsx("button",{onClick:()=>l(!1),className:"p-1.5 bg-white/20 rounded-full hover:bg-white/30 transition-colors",children:x.jsx(ti,{className:"w-5 h-5 text-white"})})]}),x.jsx("div",{className:"flex-1 overflow-y-auto p-5 space-y-6",children:x.jsxs("form",{id:"post-job-form",onSubmit:K,className:"space-y-6",children:[x.jsxs("div",{className:"space-y-3",children:[x.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase flex items-center gap-2 border-b pb-1",children:[x.jsx(Rm,{className:"w-4 h-4 text-green-600"}),"Thng tin ca hng"]}),x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["Tn ca hng/qun ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{name:"shopName",placeholder:"VD: Tr sa Gong Cha",required:!0,className:"bg-gray-50"})]}),x.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["S in thoi lin h ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{name:"phone",placeholder:"09xxxx...",required:!0,className:"bg-gray-50",type:"tel"})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["a ch c th ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{name:"address",placeholder:"S nh, ng...",required:!0,className:"bg-gray-50"})]})]})]}),x.jsxs("div",{className:"space-y-3",children:[x.jsxs("h3",{className:"text-sm font-bold text-gray-800 uppercase flex items-center gap-2 border-b pb-1",children:[x.jsx(oh,{className:"w-4 h-4 text-green-600"}),"Chi tit cng vic"]}),x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["V tr cn tuyn ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{name:"title",placeholder:"VD: Nhn vin phc v ca ti",required:!0,className:"bg-gray-50 font-medium"})]}),x.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["Mc lng ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(di,{name:"salary",placeholder:"VD: 25k/h",required:!0,className:"bg-gray-50"})]}),x.jsxs("div",{children:[x.jsx("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:"Hnh thc"}),x.jsxs("select",{name:"type",className:"w-full h-10 border rounded-md px-2 text-sm bg-gray-50 outline-none focus:ring-1 focus:ring-green-500 border-input",children:[x.jsx("option",{value:"Part-time",children:"Part-time"}),x.jsx("option",{value:"Full-time",children:"Full-time"}),x.jsx("option",{value:"Freelance",children:"Freelance"})]})]})]}),x.jsxs("div",{children:[x.jsxs("label",{className:"text-xs font-semibold text-gray-600 mb-1 block",children:["M t cng vic & Yu cu ",x.jsx("span",{className:"text-red-500",children:"*"})]}),x.jsx(gh,{name:"description",className:"bg-gray-50 min-h-[100px] text-sm leading-relaxed",placeholder:`- Thi gian lm vic...
- Yu cu...`,required:!0})]})]})]})}),x.jsxs("div",{className:"p-4 border-t bg-gray-50 rounded-b-2xl flex gap-3 sticky bottom-0 z-20",children:[x.jsx(_n,{type:"button",variant:"outline",className:"flex-1 border-gray-300",onClick:()=>l(!1),children:"Hy b"}),x.jsxs(_n,{type:"submit",form:"post-job-form",disabled:z,className:"flex-1 bg-green-600 hover:bg-green-700 text-white font-bold shadow-lg shadow-green-200",children:[z?x.jsx(Fi,{className:"w-4 h-4 mr-2 animate-spin"}):x.jsx(gO,{className:"w-4 h-4 mr-2"}),"ng tin ngay"]})]})]})]})]})},WJ=new c6,qJ=()=>{const t=zv();return P.useEffect(()=>{window.gtag&&window.gtag("config","G-ZCMPN5RBRS",{page_path:t.pathname+t.search})},[t]),null},ZJ=()=>x.jsx(u6,{client:WJ,children:x.jsx(xV,{children:x.jsx(zF,{children:x.jsxs(b2,{children:[x.jsx(vz,{}),x.jsx(Jz,{}),x.jsxs(_V,{children:[x.jsx(qJ,{}),x.jsxs(mV,{children:[x.jsx(Df,{path:"/",element:x.jsx(FI,{})}),x.jsx(Df,{path:"/place/:id",element:x.jsx(FI,{})}),x.jsx(Df,{path:"/about",element:x.jsx(IW,{})}),x.jsx(Df,{path:"/admin",element:x.jsx($J,{})}),x.jsx(Df,{path:"*",element:x.jsx(GJ,{})}),x.jsx(Df,{path:"/jobs",element:x.jsx(HJ,{})})]})]})]})})})});pm.createRoot(document.getElementById("root")).render(x.jsx(ZJ,{}));
